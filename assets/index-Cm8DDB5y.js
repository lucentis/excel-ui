(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();function ry(r){const e=Object.create(null);for(const t of r.split(","))e[t]=1;return t=>t in e}const xr={},jl=[],Ps=()=>{},L2=()=>!1,up=r=>r.charCodeAt(0)===111&&r.charCodeAt(1)===110&&(r.charCodeAt(2)>122||r.charCodeAt(2)<97),ny=r=>r.startsWith("onUpdate:"),Tn=Object.assign,iy=(r,e)=>{const t=r.indexOf(e);t>-1&&r.splice(t,1)},Z3=Object.prototype.hasOwnProperty,dr=(r,e)=>Z3.call(r,e),xt=Array.isArray,$l=r=>cp(r)==="[object Map]",D2=r=>cp(r)==="[object Set]",St=r=>typeof r=="function",Fr=r=>typeof r=="string",ko=r=>typeof r=="symbol",Rr=r=>r!==null&&typeof r=="object",B2=r=>(Rr(r)||St(r))&&St(r.then)&&St(r.catch),U2=Object.prototype.toString,cp=r=>U2.call(r),Q3=r=>cp(r).slice(8,-1),V2=r=>cp(r)==="[object Object]",hp=r=>Fr(r)&&r!=="NaN"&&r[0]!=="-"&&""+parseInt(r,10)===r,Xu=ry(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),dp=r=>{const e=Object.create(null);return(t=>e[t]||(e[t]=r(t)))},J3=/-\w/g,Wn=dp(r=>r.replace(J3,e=>e.slice(1).toUpperCase())),e4=/\B([A-Z])/g,ya=dp(r=>r.replace(e4,"-$1").toLowerCase()),fp=dp(r=>r.charAt(0).toUpperCase()+r.slice(1)),ad=dp(r=>r?`on${fp(r)}`:""),oa=(r,e)=>!Object.is(r,e),ld=(r,...e)=>{for(let t=0;t<r.length;t++)r[t](...e)},j2=(r,e,t,n=!1)=>{Object.defineProperty(r,e,{configurable:!0,enumerable:!1,writable:n,value:t})},sy=r=>{const e=parseFloat(r);return isNaN(e)?r:e};let vb;const pp=()=>vb||(vb=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function qs(r){if(xt(r)){const e={};for(let t=0;t<r.length;t++){const n=r[t],i=Fr(n)?i4(n):qs(n);if(i)for(const s in i)e[s]=i[s]}return e}else if(Fr(r)||Rr(r))return r}const t4=/;(?![^(]*\))/g,r4=/:([^]+)/,n4=/\/\*[^]*?\*\//g;function i4(r){const e={};return r.replace(n4,"").split(t4).forEach(t=>{if(t){const n=t.split(r4);n.length>1&&(e[n[0].trim()]=n[1].trim())}}),e}function mt(r){let e="";if(Fr(r))e=r;else if(xt(r))for(let t=0;t<r.length;t++){const n=mt(r[t]);n&&(e+=n+" ")}else if(Rr(r))for(const t in r)r[t]&&(e+=t+" ");return e.trim()}function en(r){if(!r)return null;let{class:e,style:t}=r;return e&&!Fr(e)&&(r.class=mt(e)),t&&(r.style=qs(t)),r}const s4="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",o4=ry(s4);function $2(r){return!!r||r===""}const z2=r=>!!(r&&r.__v_isRef===!0),ot=r=>Fr(r)?r:r==null?"":xt(r)||Rr(r)&&(r.toString===U2||!St(r.toString))?z2(r)?ot(r.value):JSON.stringify(r,H2,2):String(r),H2=(r,e)=>z2(e)?H2(r,e.value):$l(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((t,[n,i],s)=>(t[pm(n,s)+" =>"]=i,t),{})}:D2(e)?{[`Set(${e.size})`]:[...e.values()].map(t=>pm(t))}:ko(e)?pm(e):Rr(e)&&!xt(e)&&!V2(e)?String(e):e,pm=(r,e="")=>{var t;return ko(r)?`Symbol(${(t=r.description)!=null?t:e})`:r};let Ln;class W2{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Ln,!e&&Ln&&(this.index=(Ln.scopes||(Ln.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].pause();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].resume();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].resume()}}run(e){if(this._active){const t=Ln;try{return Ln=this,e()}finally{Ln=t}}}on(){++this._on===1&&(this.prevScope=Ln,Ln=this)}off(){this._on>0&&--this._on===0&&(Ln=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let t,n;for(t=0,n=this.effects.length;t<n;t++)this.effects[t].stop();for(this.effects.length=0,t=0,n=this.cleanups.length;t<n;t++)this.cleanups[t]();if(this.cleanups.length=0,this.scopes){for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0}}}function G2(r){return new W2(r)}function oy(){return Ln}function q2(r,e=!1){Ln&&Ln.cleanups.push(r)}let Tr;const mm=new WeakSet;class Y2{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Ln&&Ln.active&&Ln.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,mm.has(this)&&(mm.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||K2(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,bb(this),Z2(this);const e=Tr,t=os;Tr=this,os=!0;try{return this.fn()}finally{Q2(this),Tr=e,os=t,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)uy(e);this.deps=this.depsTail=void 0,bb(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?mm.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){fg(this)&&this.run()}get dirty(){return fg(this)}}let X2=0,Ku,Zu;function K2(r,e=!1){if(r.flags|=8,e){r.next=Zu,Zu=r;return}r.next=Ku,Ku=r}function ay(){X2++}function ly(){if(--X2>0)return;if(Zu){let e=Zu;for(Zu=void 0;e;){const t=e.next;e.next=void 0,e.flags&=-9,e=t}}let r;for(;Ku;){let e=Ku;for(Ku=void 0;e;){const t=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(n){r||(r=n)}e=t}}if(r)throw r}function Z2(r){for(let e=r.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function Q2(r){let e,t=r.depsTail,n=t;for(;n;){const i=n.prevDep;n.version===-1?(n===t&&(t=i),uy(n),a4(n)):e=n,n.dep.activeLink=n.prevActiveLink,n.prevActiveLink=void 0,n=i}r.deps=e,r.depsTail=t}function fg(r){for(let e=r.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(J2(e.dep.computed)||e.dep.version!==e.version))return!0;return!!r._dirty}function J2(r){if(r.flags&4&&!(r.flags&16)||(r.flags&=-17,r.globalVersion===bc)||(r.globalVersion=bc,!r.isSSR&&r.flags&128&&(!r.deps&&!r._dirty||!fg(r))))return;r.flags|=2;const e=r.dep,t=Tr,n=os;Tr=r,os=!0;try{Z2(r);const i=r.fn(r._value);(e.version===0||oa(i,r._value))&&(r.flags|=128,r._value=i,e.version++)}catch(i){throw e.version++,i}finally{Tr=t,os=n,Q2(r),r.flags&=-3}}function uy(r,e=!1){const{dep:t,prevSub:n,nextSub:i}=r;if(n&&(n.nextSub=i,r.prevSub=void 0),i&&(i.prevSub=n,r.nextSub=void 0),t.subs===r&&(t.subs=n,!n&&t.computed)){t.computed.flags&=-5;for(let s=t.computed.deps;s;s=s.nextDep)uy(s,!0)}!e&&!--t.sc&&t.map&&t.map.delete(t.key)}function a4(r){const{prevDep:e,nextDep:t}=r;e&&(e.nextDep=t,r.prevDep=void 0),t&&(t.prevDep=e,r.nextDep=void 0)}let os=!0;const ex=[];function xo(){ex.push(os),os=!1}function Eo(){const r=ex.pop();os=r===void 0?!0:r}function bb(r){const{cleanup:e}=r;if(r.cleanup=void 0,e){const t=Tr;Tr=void 0;try{e()}finally{Tr=t}}}let bc=0;class l4{constructor(e,t){this.sub=e,this.dep=t,this.version=t.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class mp{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!Tr||!os||Tr===this.computed)return;let t=this.activeLink;if(t===void 0||t.sub!==Tr)t=this.activeLink=new l4(Tr,this),Tr.deps?(t.prevDep=Tr.depsTail,Tr.depsTail.nextDep=t,Tr.depsTail=t):Tr.deps=Tr.depsTail=t,tx(t);else if(t.version===-1&&(t.version=this.version,t.nextDep)){const n=t.nextDep;n.prevDep=t.prevDep,t.prevDep&&(t.prevDep.nextDep=n),t.prevDep=Tr.depsTail,t.nextDep=void 0,Tr.depsTail.nextDep=t,Tr.depsTail=t,Tr.deps===t&&(Tr.deps=n)}return t}trigger(e){this.version++,bc++,this.notify(e)}notify(e){ay();try{for(let t=this.subs;t;t=t.prevSub)t.sub.notify()&&t.sub.dep.notify()}finally{ly()}}}function tx(r){if(r.dep.sc++,r.sub.flags&4){const e=r.dep.computed;if(e&&!r.dep.subs){e.flags|=20;for(let n=e.deps;n;n=n.nextDep)tx(n)}const t=r.dep.subs;t!==r&&(r.prevSub=t,t&&(t.nextSub=r)),r.dep.subs=r}}const Gd=new WeakMap,$a=Symbol(""),pg=Symbol(""),wc=Symbol("");function Vn(r,e,t){if(os&&Tr){let n=Gd.get(r);n||Gd.set(r,n=new Map);let i=n.get(t);i||(n.set(t,i=new mp),i.map=n,i.key=t),i.track()}}function ho(r,e,t,n,i,s){const o=Gd.get(r);if(!o){bc++;return}const a=l=>{l&&l.trigger()};if(ay(),e==="clear")o.forEach(a);else{const l=xt(r),u=l&&hp(t);if(l&&t==="length"){const c=Number(n);o.forEach((d,h)=>{(h==="length"||h===wc||!ko(h)&&h>=c)&&a(d)})}else switch((t!==void 0||o.has(void 0))&&a(o.get(t)),u&&a(o.get(wc)),e){case"add":l?u&&a(o.get("length")):(a(o.get($a)),$l(r)&&a(o.get(pg)));break;case"delete":l||(a(o.get($a)),$l(r)&&a(o.get(pg)));break;case"set":$l(r)&&a(o.get($a));break}}ly()}function u4(r,e){const t=Gd.get(r);return t&&t.get(e)}function wl(r){const e=$t(r);return e===r?e:(Vn(e,"iterate",wc),Ei(r)?e:e.map(cs))}function gp(r){return Vn(r=$t(r),"iterate",wc),r}function Go(r,e){return So(r)?nu(za(r)?cs(e):e):cs(e)}const c4={__proto__:null,[Symbol.iterator](){return gm(this,Symbol.iterator,r=>Go(this,r))},concat(...r){return wl(this).concat(...r.map(e=>xt(e)?wl(e):e))},entries(){return gm(this,"entries",r=>(r[1]=Go(this,r[1]),r))},every(r,e){return ro(this,"every",r,e,void 0,arguments)},filter(r,e){return ro(this,"filter",r,e,t=>t.map(n=>Go(this,n)),arguments)},find(r,e){return ro(this,"find",r,e,t=>Go(this,t),arguments)},findIndex(r,e){return ro(this,"findIndex",r,e,void 0,arguments)},findLast(r,e){return ro(this,"findLast",r,e,t=>Go(this,t),arguments)},findLastIndex(r,e){return ro(this,"findLastIndex",r,e,void 0,arguments)},forEach(r,e){return ro(this,"forEach",r,e,void 0,arguments)},includes(...r){return ym(this,"includes",r)},indexOf(...r){return ym(this,"indexOf",r)},join(r){return wl(this).join(r)},lastIndexOf(...r){return ym(this,"lastIndexOf",r)},map(r,e){return ro(this,"map",r,e,void 0,arguments)},pop(){return Tu(this,"pop")},push(...r){return Tu(this,"push",r)},reduce(r,...e){return wb(this,"reduce",r,e)},reduceRight(r,...e){return wb(this,"reduceRight",r,e)},shift(){return Tu(this,"shift")},some(r,e){return ro(this,"some",r,e,void 0,arguments)},splice(...r){return Tu(this,"splice",r)},toReversed(){return wl(this).toReversed()},toSorted(r){return wl(this).toSorted(r)},toSpliced(...r){return wl(this).toSpliced(...r)},unshift(...r){return Tu(this,"unshift",r)},values(){return gm(this,"values",r=>Go(this,r))}};function gm(r,e,t){const n=gp(r),i=n[e]();return n!==r&&!Ei(r)&&(i._next=i.next,i.next=()=>{const s=i._next();return s.done||(s.value=t(s.value)),s}),i}const h4=Array.prototype;function ro(r,e,t,n,i,s){const o=gp(r),a=o!==r&&!Ei(r),l=o[e];if(l!==h4[e]){const d=l.apply(r,s);return a?cs(d):d}let u=t;o!==r&&(a?u=function(d,h){return t.call(this,Go(r,d),h,r)}:t.length>2&&(u=function(d,h){return t.call(this,d,h,r)}));const c=l.call(o,u,n);return a&&i?i(c):c}function wb(r,e,t,n){const i=gp(r);let s=t;return i!==r&&(Ei(r)?t.length>3&&(s=function(o,a,l){return t.call(this,o,a,l,r)}):s=function(o,a,l){return t.call(this,o,Go(r,a),l,r)}),i[e](s,...n)}function ym(r,e,t){const n=$t(r);Vn(n,"iterate",wc);const i=n[e](...t);return(i===-1||i===!1)&&bp(t[0])?(t[0]=$t(t[0]),n[e](...t)):i}function Tu(r,e,t=[]){xo(),ay();const n=$t(r)[e].apply(r,t);return ly(),Eo(),n}const d4=ry("__proto__,__v_isRef,__isVue"),rx=new Set(Object.getOwnPropertyNames(Symbol).filter(r=>r!=="arguments"&&r!=="caller").map(r=>Symbol[r]).filter(ko));function f4(r){ko(r)||(r=String(r));const e=$t(this);return Vn(e,"has",r),e.hasOwnProperty(r)}class nx{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,n){if(t==="__v_skip")return e.__v_skip;const i=this._isReadonly,s=this._isShallow;if(t==="__v_isReactive")return!i;if(t==="__v_isReadonly")return i;if(t==="__v_isShallow")return s;if(t==="__v_raw")return n===(i?s?ux:lx:s?ax:ox).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(n)?e:void 0;const o=xt(e);if(!i){let l;if(o&&(l=c4[t]))return l;if(t==="hasOwnProperty")return f4}const a=Reflect.get(e,t,Cr(e)?e:n);if((ko(t)?rx.has(t):d4(t))||(i||Vn(e,"get",t),s))return a;if(Cr(a)){const l=o&&hp(t)?a:a.value;return i&&Rr(l)?qd(l):l}return Rr(a)?i?qd(a):Vs(a):a}}class ix extends nx{constructor(e=!1){super(!1,e)}set(e,t,n,i){let s=e[t];const o=xt(e)&&hp(t);if(!this._isShallow){const u=So(s);if(!Ei(n)&&!So(n)&&(s=$t(s),n=$t(n)),!o&&Cr(s)&&!Cr(n))return u||(s.value=n),!0}const a=o?Number(t)<e.length:dr(e,t),l=Reflect.set(e,t,n,Cr(e)?e:i);return e===$t(i)&&(a?oa(n,s)&&ho(e,"set",t,n):ho(e,"add",t,n)),l}deleteProperty(e,t){const n=dr(e,t);e[t];const i=Reflect.deleteProperty(e,t);return i&&n&&ho(e,"delete",t,void 0),i}has(e,t){const n=Reflect.has(e,t);return(!ko(t)||!rx.has(t))&&Vn(e,"has",t),n}ownKeys(e){return Vn(e,"iterate",xt(e)?"length":$a),Reflect.ownKeys(e)}}class sx extends nx{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}}const p4=new ix,m4=new sx,g4=new ix(!0),y4=new sx(!0),mg=r=>r,_h=r=>Reflect.getPrototypeOf(r);function v4(r,e,t){return function(...n){const i=this.__v_raw,s=$t(i),o=$l(s),a=r==="entries"||r===Symbol.iterator&&o,l=r==="keys"&&o,u=i[r](...n),c=t?mg:e?nu:cs;return!e&&Vn(s,"iterate",l?pg:$a),Tn(Object.create(u),{next(){const{value:d,done:h}=u.next();return h?{value:d,done:h}:{value:a?[c(d[0]),c(d[1])]:c(d),done:h}}})}}function xh(r){return function(...e){return r==="delete"?!1:r==="clear"?void 0:this}}function b4(r,e){const t={get(i){const s=this.__v_raw,o=$t(s),a=$t(i);r||(oa(i,a)&&Vn(o,"get",i),Vn(o,"get",a));const{has:l}=_h(o),u=e?mg:r?nu:cs;if(l.call(o,i))return u(s.get(i));if(l.call(o,a))return u(s.get(a));s!==o&&s.get(i)},get size(){const i=this.__v_raw;return!r&&Vn($t(i),"iterate",$a),i.size},has(i){const s=this.__v_raw,o=$t(s),a=$t(i);return r||(oa(i,a)&&Vn(o,"has",i),Vn(o,"has",a)),i===a?s.has(i):s.has(i)||s.has(a)},forEach(i,s){const o=this,a=o.__v_raw,l=$t(a),u=e?mg:r?nu:cs;return!r&&Vn(l,"iterate",$a),a.forEach((c,d)=>i.call(s,u(c),u(d),o))}};return Tn(t,r?{add:xh("add"),set:xh("set"),delete:xh("delete"),clear:xh("clear")}:{add(i){!e&&!Ei(i)&&!So(i)&&(i=$t(i));const s=$t(this);return _h(s).has.call(s,i)||(s.add(i),ho(s,"add",i,i)),this},set(i,s){!e&&!Ei(s)&&!So(s)&&(s=$t(s));const o=$t(this),{has:a,get:l}=_h(o);let u=a.call(o,i);u||(i=$t(i),u=a.call(o,i));const c=l.call(o,i);return o.set(i,s),u?oa(s,c)&&ho(o,"set",i,s):ho(o,"add",i,s),this},delete(i){const s=$t(this),{has:o,get:a}=_h(s);let l=o.call(s,i);l||(i=$t(i),l=o.call(s,i)),a&&a.call(s,i);const u=s.delete(i);return l&&ho(s,"delete",i,void 0),u},clear(){const i=$t(this),s=i.size!==0,o=i.clear();return s&&ho(i,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(i=>{t[i]=v4(i,r,e)}),t}function yp(r,e){const t=b4(r,e);return(n,i,s)=>i==="__v_isReactive"?!r:i==="__v_isReadonly"?r:i==="__v_raw"?n:Reflect.get(dr(t,i)&&i in n?t:n,i,s)}const w4={get:yp(!1,!1)},_4={get:yp(!1,!0)},x4={get:yp(!0,!1)},E4={get:yp(!0,!0)},ox=new WeakMap,ax=new WeakMap,lx=new WeakMap,ux=new WeakMap;function S4(r){switch(r){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function T4(r){return r.__v_skip||!Object.isExtensible(r)?0:S4(Q3(r))}function Vs(r){return So(r)?r:vp(r,!1,p4,w4,ox)}function R4(r){return vp(r,!1,g4,_4,ax)}function qd(r){return vp(r,!0,m4,x4,lx)}function _l(r){return vp(r,!0,y4,E4,ux)}function vp(r,e,t,n,i){if(!Rr(r)||r.__v_raw&&!(e&&r.__v_isReactive))return r;const s=T4(r);if(s===0)return r;const o=i.get(r);if(o)return o;const a=new Proxy(r,s===2?n:t);return i.set(r,a),a}function za(r){return So(r)?za(r.__v_raw):!!(r&&r.__v_isReactive)}function So(r){return!!(r&&r.__v_isReadonly)}function Ei(r){return!!(r&&r.__v_isShallow)}function bp(r){return r?!!r.__v_raw:!1}function $t(r){const e=r&&r.__v_raw;return e?$t(e):r}function cx(r){return!dr(r,"__v_skip")&&Object.isExtensible(r)&&j2(r,"__v_skip",!0),r}const cs=r=>Rr(r)?Vs(r):r,nu=r=>Rr(r)?qd(r):r;function Cr(r){return r?r.__v_isRef===!0:!1}function Ce(r){return hx(r,!1)}function wp(r){return hx(r,!0)}function hx(r,e){return Cr(r)?r:new A4(r,e)}class A4{constructor(e,t){this.dep=new mp,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=t?e:$t(e),this._value=t?e:cs(e),this.__v_isShallow=t}get value(){return this.dep.track(),this._value}set value(e){const t=this._rawValue,n=this.__v_isShallow||Ei(e)||So(e);e=n?e:$t(e),oa(e,t)&&(this._rawValue=e,this._value=n?e:cs(e),this.dep.trigger())}}function q(r){return Cr(r)?r.value:r}function zn(r){return St(r)?r():q(r)}const C4={get:(r,e,t)=>e==="__v_raw"?r:q(Reflect.get(r,e,t)),set:(r,e,t,n)=>{const i=r[e];return Cr(i)&&!Cr(t)?(i.value=t,!0):Reflect.set(r,e,t,n)}};function dx(r){return za(r)?r:new Proxy(r,C4)}class N4{constructor(e){this.__v_isRef=!0,this._value=void 0;const t=this.dep=new mp,{get:n,set:i}=e(t.track.bind(t),t.trigger.bind(t));this._get=n,this._set=i}get value(){return this._value=this._get()}set value(e){this._set(e)}}function M4(r){return new N4(r)}function Rn(r){const e=xt(r)?new Array(r.length):{};for(const t in r)e[t]=fx(r,t);return e}class O4{constructor(e,t,n){this._object=e,this._key=t,this._defaultValue=n,this.__v_isRef=!0,this._value=void 0,this._raw=$t(e);let i=!0,s=e;if(!xt(e)||!hp(String(t)))do i=!bp(s)||Ei(s);while(i&&(s=s.__v_raw));this._shallow=i}get value(){let e=this._object[this._key];return this._shallow&&(e=q(e)),this._value=e===void 0?this._defaultValue:e}set value(e){if(this._shallow&&Cr(this._raw[this._key])){const t=this._object[this._key];if(Cr(t)){t.value=e;return}}this._object[this._key]=e}get dep(){return u4(this._raw,this._key)}}class I4{constructor(e){this._getter=e,this.__v_isRef=!0,this.__v_isReadonly=!0,this._value=void 0}get value(){return this._value=this._getter()}}function k4(r,e,t){return Cr(r)?r:St(r)?new I4(r):Rr(r)&&arguments.length>1?fx(r,e,t):Ce(r)}function fx(r,e,t){return new O4(r,e,t)}class P4{constructor(e,t,n){this.fn=e,this.setter=t,this._value=void 0,this.dep=new mp(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=bc-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!t,this.isSSR=n}notify(){if(this.flags|=16,!(this.flags&8)&&Tr!==this)return K2(this,!0),!0}get value(){const e=this.dep.track();return J2(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function F4(r,e,t=!1){let n,i;return St(r)?n=r:(n=r.get,i=r.set),new P4(n,i,t)}const Eh={},Yd=new WeakMap;let ka;function L4(r,e=!1,t=ka){if(t){let n=Yd.get(t);n||Yd.set(t,n=[]),n.push(r)}}function D4(r,e,t=xr){const{immediate:n,deep:i,once:s,scheduler:o,augmentJob:a,call:l}=t,u=E=>i?E:Ei(E)||i===!1||i===0?fo(E,1):fo(E);let c,d,h,f,m=!1,p=!1;if(Cr(r)?(d=()=>r.value,m=Ei(r)):za(r)?(d=()=>u(r),m=!0):xt(r)?(p=!0,m=r.some(E=>za(E)||Ei(E)),d=()=>r.map(E=>{if(Cr(E))return E.value;if(za(E))return u(E);if(St(E))return l?l(E,2):E()})):St(r)?e?d=l?()=>l(r,2):r:d=()=>{if(h){xo();try{h()}finally{Eo()}}const E=ka;ka=c;try{return l?l(r,3,[f]):r(f)}finally{ka=E}}:d=Ps,e&&i){const E=d,A=i===!0?1/0:i;d=()=>fo(E(),A)}const g=oy(),v=()=>{c.stop(),g&&g.active&&iy(g.effects,c)};if(s&&e){const E=e;e=(...A)=>{E(...A),v()}}let y=p?new Array(r.length).fill(Eh):Eh;const b=E=>{if(!(!(c.flags&1)||!c.dirty&&!E))if(e){const A=c.run();if(i||m||(p?A.some((M,L)=>oa(M,y[L])):oa(A,y))){h&&h();const M=ka;ka=c;try{const L=[A,y===Eh?void 0:p&&y[0]===Eh?[]:y,f];y=A,l?l(e,3,L):e(...L)}finally{ka=M}}}else c.run()};return a&&a(b),c=new Y2(d),c.scheduler=o?()=>o(b,!1):b,f=E=>L4(E,!1,c),h=c.onStop=()=>{const E=Yd.get(c);if(E){if(l)l(E,4);else for(const A of E)A();Yd.delete(c)}},e?n?b(!0):y=c.run():o?o(b.bind(null,!0),!0):c.run(),v.pause=c.pause.bind(c),v.resume=c.resume.bind(c),v.stop=v,v}function fo(r,e=1/0,t){if(e<=0||!Rr(r)||r.__v_skip||(t=t||new Map,(t.get(r)||0)>=e))return r;if(t.set(r,e),e--,Cr(r))fo(r.value,e,t);else if(xt(r))for(let n=0;n<r.length;n++)fo(r[n],e,t);else if(D2(r)||$l(r))r.forEach(n=>{fo(n,e,t)});else if(V2(r)){for(const n in r)fo(r[n],e,t);for(const n of Object.getOwnPropertySymbols(r))Object.prototype.propertyIsEnumerable.call(r,n)&&fo(r[n],e,t)}return r}function Yc(r,e,t,n){try{return n?r(...n):r()}catch(i){_p(i,e,t)}}function js(r,e,t,n){if(St(r)){const i=Yc(r,e,t,n);return i&&B2(i)&&i.catch(s=>{_p(s,e,t)}),i}if(xt(r)){const i=[];for(let s=0;s<r.length;s++)i.push(js(r[s],e,t,n));return i}}function _p(r,e,t,n=!0){const i=e?e.vnode:null,{errorHandler:s,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||xr;if(e){let a=e.parent;const l=e.proxy,u=`https://vuejs.org/error-reference/#runtime-${t}`;for(;a;){const c=a.ec;if(c){for(let d=0;d<c.length;d++)if(c[d](r,l,u)===!1)return}a=a.parent}if(s){xo(),Yc(s,null,10,[r,l,u]),Eo();return}}B4(r,t,i,n,o)}function B4(r,e,t,n=!0,i=!1){if(i)throw r;console.error(r)}const Kn=[];let Es=-1;const zl=[];let qo=null,Nl=0;const px=Promise.resolve();let Xd=null;function br(r){const e=Xd||px;return r?e.then(this?r.bind(this):r):e}function U4(r){let e=Es+1,t=Kn.length;for(;e<t;){const n=e+t>>>1,i=Kn[n],s=_c(i);s<r||s===r&&i.flags&2?e=n+1:t=n}return e}function cy(r){if(!(r.flags&1)){const e=_c(r),t=Kn[Kn.length-1];!t||!(r.flags&2)&&e>=_c(t)?Kn.push(r):Kn.splice(U4(e),0,r),r.flags|=1,mx()}}function mx(){Xd||(Xd=px.then(yx))}function V4(r){xt(r)?zl.push(...r):qo&&r.id===-1?qo.splice(Nl+1,0,r):r.flags&1||(zl.push(r),r.flags|=1),mx()}function _b(r,e,t=Es+1){for(;t<Kn.length;t++){const n=Kn[t];if(n&&n.flags&2){if(r&&n.id!==r.uid)continue;Kn.splice(t,1),t--,n.flags&4&&(n.flags&=-2),n(),n.flags&4||(n.flags&=-2)}}}function gx(r){if(zl.length){const e=[...new Set(zl)].sort((t,n)=>_c(t)-_c(n));if(zl.length=0,qo){qo.push(...e);return}for(qo=e,Nl=0;Nl<qo.length;Nl++){const t=qo[Nl];t.flags&4&&(t.flags&=-2),t.flags&8||t(),t.flags&=-2}qo=null,Nl=0}}const _c=r=>r.id==null?r.flags&2?-1:1/0:r.id;function yx(r){try{for(Es=0;Es<Kn.length;Es++){const e=Kn[Es];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),Yc(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;Es<Kn.length;Es++){const e=Kn[Es];e&&(e.flags&=-2)}Es=-1,Kn.length=0,gx(),Xd=null,(Kn.length||zl.length)&&yx()}}let xn=null,vx=null;function Kd(r){const e=xn;return xn=r,vx=r&&r.type.__scopeId||null,e}function de(r,e=xn,t){if(!e||r._n)return r;const n=(...i)=>{n._d&&Jd(-1);const s=Kd(e);let o;try{o=r(...i)}finally{Kd(s),n._d&&Jd(1)}return o};return n._n=!0,n._c=!0,n._d=!0,n}function j4(r,e){if(xn===null)return r;const t=Ap(xn),n=r.dirs||(r.dirs=[]);for(let i=0;i<e.length;i++){let[s,o,a,l=xr]=e[i];s&&(St(s)&&(s={mounted:s,updated:s}),s.deep&&fo(o),n.push({dir:s,instance:t,value:o,oldValue:void 0,arg:a,modifiers:l}))}return r}function Ra(r,e,t,n){const i=r.dirs,s=e&&e.dirs;for(let o=0;o<i.length;o++){const a=i[o];s&&(a.oldValue=s[o].value);let l=a.dir[n];l&&(xo(),js(l,t,8,[r.el,a,r,e]),Eo())}}function ts(r,e){if($n){let t=$n.provides;const n=$n.parent&&$n.parent.provides;n===t&&(t=$n.provides=Object.create(n)),t[r]=e}}function Ui(r,e,t=!1){const n=Ys();if(n||Wl){let i=Wl?Wl._context.provides:n?n.parent==null||n.ce?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:void 0;if(i&&r in i)return i[r];if(arguments.length>1)return t&&St(e)?e.call(n&&n.proxy):e}}const $4=Symbol.for("v-scx"),z4=()=>Ui($4);function An(r,e){return xp(r,null,e)}function bx(r,e){return xp(r,null,{flush:"post"})}function jt(r,e,t){return xp(r,e,t)}function xp(r,e,t=xr){const{immediate:n,deep:i,flush:s,once:o}=t,a=Tn({},t),l=e&&n||!e&&s!=="post";let u;if(Sc){if(s==="sync"){const f=z4();u=f.__watcherHandles||(f.__watcherHandles=[])}else if(!l){const f=()=>{};return f.stop=Ps,f.resume=Ps,f.pause=Ps,f}}const c=$n;a.call=(f,m,p)=>js(f,c,m,p);let d=!1;s==="post"?a.scheduler=f=>{Yn(f,c&&c.suspense)}:s!=="sync"&&(d=!0,a.scheduler=(f,m)=>{m?f():cy(f)}),a.augmentJob=f=>{e&&(f.flags|=4),d&&(f.flags|=2,c&&(f.id=c.uid,f.i=c))};const h=D4(r,e,a);return Sc&&(u?u.push(h):l&&h()),h}function H4(r,e,t){const n=this.proxy,i=Fr(r)?r.includes(".")?wx(n,r):()=>n[r]:r.bind(n,n);let s;St(e)?s=e:(s=e.handler,t=e);const o=Xc(this),a=xp(i,s.bind(n),t);return o(),a}function wx(r,e){const t=e.split(".");return()=>{let n=r;for(let i=0;i<t.length&&n;i++)n=n[t[i]];return n}}const _x=Symbol("_vte"),W4=r=>r.__isTeleport,Qu=r=>r&&(r.disabled||r.disabled===""),xb=r=>r&&(r.defer||r.defer===""),Eb=r=>typeof SVGElement<"u"&&r instanceof SVGElement,Sb=r=>typeof MathMLElement=="function"&&r instanceof MathMLElement,gg=(r,e)=>{const t=r&&r.to;return Fr(t)?e?e(t):null:t},xx={name:"Teleport",__isTeleport:!0,process(r,e,t,n,i,s,o,a,l,u){const{mc:c,pc:d,pbc:h,o:{insert:f,querySelector:m,createText:p,createComment:g}}=u,v=Qu(e.props);let{shapeFlag:y,children:b,dynamicChildren:E}=e;if(r==null){const A=e.el=p(""),M=e.anchor=p("");f(A,t,n),f(M,t,n);const L=(P,U)=>{y&16&&c(b,P,U,i,s,o,a,l)},k=()=>{const P=e.target=gg(e.props,m),U=Sx(P,e,p,f);P&&(o!=="svg"&&Eb(P)?o="svg":o!=="mathml"&&Sb(P)&&(o="mathml"),i&&i.isCE&&(i.ce._teleportTargets||(i.ce._teleportTargets=new Set)).add(P),v||(L(P,U),ud(e,!1)))};v&&(L(t,M),ud(e,!0)),xb(e.props)?(e.el.__isMounted=!1,Yn(()=>{k(),delete e.el.__isMounted},s)):k()}else{if(xb(e.props)&&r.el.__isMounted===!1){Yn(()=>{xx.process(r,e,t,n,i,s,o,a,l,u)},s);return}e.el=r.el,e.targetStart=r.targetStart;const A=e.anchor=r.anchor,M=e.target=r.target,L=e.targetAnchor=r.targetAnchor,k=Qu(r.props),P=k?t:M,U=k?A:L;if(o==="svg"||Eb(M)?o="svg":(o==="mathml"||Sb(M))&&(o="mathml"),E?(h(r.dynamicChildren,E,P,i,s,o,a),my(r,e,!0)):l||d(r,e,P,U,i,s,o,a,!1),v)k?e.props&&r.props&&e.props.to!==r.props.to&&(e.props.to=r.props.to):Sh(e,t,A,u,1);else if((e.props&&e.props.to)!==(r.props&&r.props.to)){const $=e.target=gg(e.props,m);$&&Sh(e,$,null,u,0)}else k&&Sh(e,M,L,u,1);ud(e,v)}},remove(r,e,t,{um:n,o:{remove:i}},s){const{shapeFlag:o,children:a,anchor:l,targetStart:u,targetAnchor:c,target:d,props:h}=r;if(d&&(i(u),i(c)),s&&i(l),o&16){const f=s||!Qu(h);for(let m=0;m<a.length;m++){const p=a[m];n(p,e,t,f,!!p.dynamicChildren)}}},move:Sh,hydrate:G4};function Sh(r,e,t,{o:{insert:n},m:i},s=2){s===0&&n(r.targetAnchor,e,t);const{el:o,anchor:a,shapeFlag:l,children:u,props:c}=r,d=s===2;if(d&&n(o,e,t),(!d||Qu(c))&&l&16)for(let h=0;h<u.length;h++)i(u[h],e,t,2);d&&n(a,e,t)}function G4(r,e,t,n,i,s,{o:{nextSibling:o,parentNode:a,querySelector:l,insert:u,createText:c}},d){function h(p,g,v,y){g.anchor=d(o(p),g,a(p),t,n,i,s),g.targetStart=v,g.targetAnchor=y}const f=e.target=gg(e.props,l),m=Qu(e.props);if(f){const p=f._lpa||f.firstChild;if(e.shapeFlag&16)if(m)h(r,e,p,p&&o(p));else{e.anchor=o(r);let g=p;for(;g;){if(g&&g.nodeType===8){if(g.data==="teleport start anchor")e.targetStart=g;else if(g.data==="teleport anchor"){e.targetAnchor=g,f._lpa=e.targetAnchor&&o(e.targetAnchor);break}}g=o(g)}e.targetAnchor||Sx(f,e,c,u),d(p&&o(p),e,f,t,n,i,s)}ud(e,m)}else m&&e.shapeFlag&16&&h(r,e,r,o(r));return e.anchor&&o(e.anchor)}const Ex=xx;function ud(r,e){const t=r.ctx;if(t&&t.ut){let n,i;for(e?(n=r.el,i=r.anchor):(n=r.targetStart,i=r.targetAnchor);n&&n!==i;)n.nodeType===1&&n.setAttribute("data-v-owner",t.uid),n=n.nextSibling;t.ut()}}function Sx(r,e,t,n){const i=e.targetStart=t(""),s=e.targetAnchor=t("");return i[_x]=s,r&&(n(i,r),n(s,r)),s}const q4=Symbol("_leaveCb");function hy(r,e){r.shapeFlag&6&&r.component?(r.transition=e,hy(r.component.subTree,e)):r.shapeFlag&128?(r.ssContent.transition=e.clone(r.ssContent),r.ssFallback.transition=e.clone(r.ssFallback)):r.transition=e}function _e(r,e){return St(r)?Tn({name:r.name},e,{setup:r}):r}function Y4(){const r=Ys();return r?(r.appContext.config.idPrefix||"v")+"-"+r.ids[0]+r.ids[1]++:""}function Tx(r){r.ids=[r.ids[0]+r.ids[2]+++"-",0,0]}const Zd=new WeakMap;function Ju(r,e,t,n,i=!1){if(xt(r)){r.forEach((m,p)=>Ju(m,e&&(xt(e)?e[p]:e),t,n,i));return}if(Hl(n)&&!i){n.shapeFlag&512&&n.type.__asyncResolved&&n.component.subTree.component&&Ju(r,e,t,n.component.subTree);return}const s=n.shapeFlag&4?Ap(n.component):n.el,o=i?null:s,{i:a,r:l}=r,u=e&&e.r,c=a.refs===xr?a.refs={}:a.refs,d=a.setupState,h=$t(d),f=d===xr?L2:m=>dr(h,m);if(u!=null&&u!==l){if(Tb(e),Fr(u))c[u]=null,f(u)&&(d[u]=null);else if(Cr(u)){u.value=null;const m=e;m.k&&(c[m.k]=null)}}if(St(l))Yc(l,a,12,[o,c]);else{const m=Fr(l),p=Cr(l);if(m||p){const g=()=>{if(r.f){const v=m?f(l)?d[l]:c[l]:l.value;if(i)xt(v)&&iy(v,s);else if(xt(v))v.includes(s)||v.push(s);else if(m)c[l]=[s],f(l)&&(d[l]=c[l]);else{const y=[s];l.value=y,r.k&&(c[r.k]=y)}}else m?(c[l]=o,f(l)&&(d[l]=o)):p&&(l.value=o,r.k&&(c[r.k]=o))};if(o){const v=()=>{g(),Zd.delete(r)};v.id=-1,Zd.set(r,v),Yn(v,t)}else Tb(r),g()}}}function Tb(r){const e=Zd.get(r);e&&(e.flags|=8,Zd.delete(r))}pp().requestIdleCallback;pp().cancelIdleCallback;const Hl=r=>!!r.type.__asyncLoader,Rx=r=>r.type.__isKeepAlive;function X4(r,e){Ax(r,"a",e)}function K4(r,e){Ax(r,"da",e)}function Ax(r,e,t=$n){const n=r.__wdc||(r.__wdc=()=>{let i=t;for(;i;){if(i.isDeactivated)return;i=i.parent}return r()});if(Ep(e,n,t),t){let i=t.parent;for(;i&&i.parent;)Rx(i.parent.vnode)&&Z4(n,e,t,i),i=i.parent}}function Z4(r,e,t,n){const i=Ep(e,r,n,!0);Nn(()=>{iy(n[e],i)},t)}function Ep(r,e,t=$n,n=!1){if(t){const i=t[r]||(t[r]=[]),s=e.__weh||(e.__weh=(...o)=>{xo();const a=Xc(t),l=js(e,t,r,o);return a(),Eo(),l});return n?i.unshift(s):i.push(s),s}}const Po=r=>(e,t=$n)=>{(!Sc||r==="sp")&&Ep(r,(...n)=>e(...n),t)},Q4=Po("bm"),Lr=Po("m"),J4=Po("bu"),e6=Po("u"),Sp=Po("bum"),Nn=Po("um"),t6=Po("sp"),r6=Po("rtg"),n6=Po("rtc");function i6(r,e=$n){Ep("ec",r,e)}const s6="components",Cx=Symbol.for("v-ndc");function dy(r){return Fr(r)?o6(s6,r,!1)||r:r||Cx}function o6(r,e,t=!0,n=!1){const i=xn||$n;if(i){const s=i.type;{const a=$6(s,!1);if(a&&(a===e||a===Wn(e)||a===fp(Wn(e))))return s}const o=Rb(i[r]||s[r],e)||Rb(i.appContext[r],e);return!o&&n?s:o}}function Rb(r,e){return r&&(r[e]||r[Wn(e)]||r[fp(Wn(e))])}function Er(r,e,t,n){let i;const s=t,o=xt(r);if(o||Fr(r)){const a=o&&za(r);let l=!1,u=!1;a&&(l=!Ei(r),u=So(r),r=gp(r)),i=new Array(r.length);for(let c=0,d=r.length;c<d;c++)i[c]=e(l?u?nu(cs(r[c])):cs(r[c]):r[c],c,void 0,s)}else if(typeof r=="number"){i=new Array(r);for(let a=0;a<r;a++)i[a]=e(a+1,a,void 0,s)}else if(Rr(r))if(r[Symbol.iterator])i=Array.from(r,(a,l)=>e(a,l,void 0,s));else{const a=Object.keys(r);i=new Array(a.length);for(let l=0,u=a.length;l<u;l++){const c=a[l];i[l]=e(r[c],c,l,s)}}else i=[];return i}function Re(r,e,t={},n,i){if(xn.ce||xn.parent&&Hl(xn.parent)&&xn.parent.ce){const u=Object.keys(t).length>0;return e!=="default"&&(t.name=e),he(),Ee(Tt,null,[ge("slot",t,n&&n())],u?-2:64)}let s=r[e];s&&s._c&&(s._d=!1),he();const o=s&&Nx(s(t)),a=t.key||o&&o.key,l=Ee(Tt,{key:(a&&!ko(a)?a:`_${e}`)+(!o&&n?"_fb":"")},o||(n?n():[]),o&&r._===1?64:-2);return l.scopeId&&(l.slotScopeIds=[l.scopeId+"-s"]),s&&s._c&&(s._d=!0),l}function Nx(r){return r.some(e=>Ec(e)?!(e.type===$s||e.type===Tt&&!Nx(e.children)):!0)?r:null}const yg=r=>r?Yx(r)?Ap(r):yg(r.parent):null,ec=Tn(Object.create(null),{$:r=>r,$el:r=>r.vnode.el,$data:r=>r.data,$props:r=>r.props,$attrs:r=>r.attrs,$slots:r=>r.slots,$refs:r=>r.refs,$parent:r=>yg(r.parent),$root:r=>yg(r.root),$host:r=>r.ce,$emit:r=>r.emit,$options:r=>Ix(r),$forceUpdate:r=>r.f||(r.f=()=>{cy(r.update)}),$nextTick:r=>r.n||(r.n=br.bind(r.proxy)),$watch:r=>H4.bind(r)}),vm=(r,e)=>r!==xr&&!r.__isScriptSetup&&dr(r,e),a6={get({_:r},e){if(e==="__v_skip")return!0;const{ctx:t,setupState:n,data:i,props:s,accessCache:o,type:a,appContext:l}=r;if(e[0]!=="$"){const h=o[e];if(h!==void 0)switch(h){case 1:return n[e];case 2:return i[e];case 4:return t[e];case 3:return s[e]}else{if(vm(n,e))return o[e]=1,n[e];if(i!==xr&&dr(i,e))return o[e]=2,i[e];if(dr(s,e))return o[e]=3,s[e];if(t!==xr&&dr(t,e))return o[e]=4,t[e];bg&&(o[e]=0)}}const u=ec[e];let c,d;if(u)return e==="$attrs"&&Vn(r.attrs,"get",""),u(r);if((c=a.__cssModules)&&(c=c[e]))return c;if(t!==xr&&dr(t,e))return o[e]=4,t[e];if(d=l.config.globalProperties,dr(d,e))return d[e]},set({_:r},e,t){const{data:n,setupState:i,ctx:s}=r;return vm(i,e)?(i[e]=t,!0):n!==xr&&dr(n,e)?(n[e]=t,!0):dr(r.props,e)||e[0]==="$"&&e.slice(1)in r?!1:(s[e]=t,!0)},has({_:{data:r,setupState:e,accessCache:t,ctx:n,appContext:i,props:s,type:o}},a){let l;return!!(t[a]||r!==xr&&a[0]!=="$"&&dr(r,a)||vm(e,a)||dr(s,a)||dr(n,a)||dr(ec,a)||dr(i.config.globalProperties,a)||(l=o.__cssModules)&&l[a])},defineProperty(r,e,t){return t.get!=null?r._.accessCache[e]=0:dr(t,"value")&&this.set(r,e,t.value,null),Reflect.defineProperty(r,e,t)}};function vg(r){return xt(r)?r.reduce((e,t)=>(e[t]=null,e),{}):r}function Mx(r,e){const t=vg(r);for(const n in e){if(n.startsWith("__skip"))continue;let i=t[n];i?xt(i)||St(i)?i=t[n]={type:i,default:e[n]}:i.default=e[n]:i===null&&(i=t[n]={default:e[n]}),i&&e[`__skip_${n}`]&&(i.skipFactory=!0)}return t}let bg=!0;function l6(r){const e=Ix(r),t=r.proxy,n=r.ctx;bg=!1,e.beforeCreate&&Ab(e.beforeCreate,r,"bc");const{data:i,computed:s,methods:o,watch:a,provide:l,inject:u,created:c,beforeMount:d,mounted:h,beforeUpdate:f,updated:m,activated:p,deactivated:g,beforeDestroy:v,beforeUnmount:y,destroyed:b,unmounted:E,render:A,renderTracked:M,renderTriggered:L,errorCaptured:k,serverPrefetch:P,expose:U,inheritAttrs:$,components:V,directives:R,filters:O}=e;if(u&&u6(u,n,null),o)for(const x in o){const _=o[x];St(_)&&(n[x]=_.bind(t))}if(i){const x=i.call(t,t);Rr(x)&&(r.data=Vs(x))}if(bg=!0,s)for(const x in s){const _=s[x],S=St(_)?_.bind(t,t):St(_.get)?_.get.bind(t,t):Ps,C=!St(_)&&St(_.set)?_.set.bind(t):Ps,F=Te({get:S,set:C});Object.defineProperty(n,x,{enumerable:!0,configurable:!0,get:()=>F.value,set:D=>F.value=D})}if(a)for(const x in a)Ox(a[x],n,t,x);if(l){const x=St(l)?l.call(t):l;Reflect.ownKeys(x).forEach(_=>{ts(_,x[_])})}c&&Ab(c,r,"c");function w(x,_){xt(_)?_.forEach(S=>x(S.bind(t))):_&&x(_.bind(t))}if(w(Q4,d),w(Lr,h),w(J4,f),w(e6,m),w(X4,p),w(K4,g),w(i6,k),w(n6,M),w(r6,L),w(Sp,y),w(Nn,E),w(t6,P),xt(U))if(U.length){const x=r.exposed||(r.exposed={});U.forEach(_=>{Object.defineProperty(x,_,{get:()=>t[_],set:S=>t[_]=S,enumerable:!0})})}else r.exposed||(r.exposed={});A&&r.render===Ps&&(r.render=A),$!=null&&(r.inheritAttrs=$),V&&(r.components=V),R&&(r.directives=R),P&&Tx(r)}function u6(r,e,t=Ps){xt(r)&&(r=wg(r));for(const n in r){const i=r[n];let s;Rr(i)?"default"in i?s=Ui(i.from||n,i.default,!0):s=Ui(i.from||n):s=Ui(i),Cr(s)?Object.defineProperty(e,n,{enumerable:!0,configurable:!0,get:()=>s.value,set:o=>s.value=o}):e[n]=s}}function Ab(r,e,t){js(xt(r)?r.map(n=>n.bind(e.proxy)):r.bind(e.proxy),e,t)}function Ox(r,e,t,n){let i=n.includes(".")?wx(t,n):()=>t[n];if(Fr(r)){const s=e[r];St(s)&&jt(i,s)}else if(St(r))jt(i,r.bind(t));else if(Rr(r))if(xt(r))r.forEach(s=>Ox(s,e,t,n));else{const s=St(r.handler)?r.handler.bind(t):e[r.handler];St(s)&&jt(i,s,r)}}function Ix(r){const e=r.type,{mixins:t,extends:n}=e,{mixins:i,optionsCache:s,config:{optionMergeStrategies:o}}=r.appContext,a=s.get(e);let l;return a?l=a:!i.length&&!t&&!n?l=e:(l={},i.length&&i.forEach(u=>Qd(l,u,o,!0)),Qd(l,e,o)),Rr(e)&&s.set(e,l),l}function Qd(r,e,t,n=!1){const{mixins:i,extends:s}=e;s&&Qd(r,s,t,!0),i&&i.forEach(o=>Qd(r,o,t,!0));for(const o in e)if(!(n&&o==="expose")){const a=c6[o]||t&&t[o];r[o]=a?a(r[o],e[o]):e[o]}return r}const c6={data:Cb,props:Nb,emits:Nb,methods:Lu,computed:Lu,beforeCreate:qn,created:qn,beforeMount:qn,mounted:qn,beforeUpdate:qn,updated:qn,beforeDestroy:qn,beforeUnmount:qn,destroyed:qn,unmounted:qn,activated:qn,deactivated:qn,errorCaptured:qn,serverPrefetch:qn,components:Lu,directives:Lu,watch:d6,provide:Cb,inject:h6};function Cb(r,e){return e?r?function(){return Tn(St(r)?r.call(this,this):r,St(e)?e.call(this,this):e)}:e:r}function h6(r,e){return Lu(wg(r),wg(e))}function wg(r){if(xt(r)){const e={};for(let t=0;t<r.length;t++)e[r[t]]=r[t];return e}return r}function qn(r,e){return r?[...new Set([].concat(r,e))]:e}function Lu(r,e){return r?Tn(Object.create(null),r,e):e}function Nb(r,e){return r?xt(r)&&xt(e)?[...new Set([...r,...e])]:Tn(Object.create(null),vg(r),vg(e??{})):e}function d6(r,e){if(!r)return e;if(!e)return r;const t=Tn(Object.create(null),r);for(const n in e)t[n]=qn(r[n],e[n]);return t}function kx(){return{app:null,config:{isNativeTag:L2,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let f6=0;function p6(r,e){return function(n,i=null){St(n)||(n=Tn({},n)),i!=null&&!Rr(i)&&(i=null);const s=kx(),o=new WeakSet,a=[];let l=!1;const u=s.app={_uid:f6++,_component:n,_props:i,_container:null,_context:s,_instance:null,version:H6,get config(){return s.config},set config(c){},use(c,...d){return o.has(c)||(c&&St(c.install)?(o.add(c),c.install(u,...d)):St(c)&&(o.add(c),c(u,...d))),u},mixin(c){return s.mixins.includes(c)||s.mixins.push(c),u},component(c,d){return d?(s.components[c]=d,u):s.components[c]},directive(c,d){return d?(s.directives[c]=d,u):s.directives[c]},mount(c,d,h){if(!l){const f=u._ceVNode||ge(n,i);return f.appContext=s,h===!0?h="svg":h===!1&&(h=void 0),r(f,c,h),l=!0,u._container=c,c.__vue_app__=u,Ap(f.component)}},onUnmount(c){a.push(c)},unmount(){l&&(js(a,u._instance,16),r(null,u._container),delete u._container.__vue_app__)},provide(c,d){return s.provides[c]=d,u},runWithContext(c){const d=Wl;Wl=u;try{return c()}finally{Wl=d}}};return u}}let Wl=null;const m6=(r,e)=>e==="modelValue"||e==="model-value"?r.modelModifiers:r[`${e}Modifiers`]||r[`${Wn(e)}Modifiers`]||r[`${ya(e)}Modifiers`];function g6(r,e,...t){if(r.isUnmounted)return;const n=r.vnode.props||xr;let i=t;const s=e.startsWith("update:"),o=s&&m6(n,e.slice(7));o&&(o.trim&&(i=t.map(c=>Fr(c)?c.trim():c)),o.number&&(i=t.map(sy)));let a,l=n[a=ad(e)]||n[a=ad(Wn(e))];!l&&s&&(l=n[a=ad(ya(e))]),l&&js(l,r,6,i);const u=n[a+"Once"];if(u){if(!r.emitted)r.emitted={};else if(r.emitted[a])return;r.emitted[a]=!0,js(u,r,6,i)}}const y6=new WeakMap;function Px(r,e,t=!1){const n=t?y6:e.emitsCache,i=n.get(r);if(i!==void 0)return i;const s=r.emits;let o={},a=!1;if(!St(r)){const l=u=>{const c=Px(u,e,!0);c&&(a=!0,Tn(o,c))};!t&&e.mixins.length&&e.mixins.forEach(l),r.extends&&l(r.extends),r.mixins&&r.mixins.forEach(l)}return!s&&!a?(Rr(r)&&n.set(r,null),null):(xt(s)?s.forEach(l=>o[l]=null):Tn(o,s),Rr(r)&&n.set(r,o),o)}function Tp(r,e){return!r||!up(e)?!1:(e=e.slice(2).replace(/Once$/,""),dr(r,e[0].toLowerCase()+e.slice(1))||dr(r,ya(e))||dr(r,e))}function Mb(r){const{type:e,vnode:t,proxy:n,withProxy:i,propsOptions:[s],slots:o,attrs:a,emit:l,render:u,renderCache:c,props:d,data:h,setupState:f,ctx:m,inheritAttrs:p}=r,g=Kd(r);let v,y;try{if(t.shapeFlag&4){const E=i||n,A=E;v=Rs(u.call(A,E,c,d,f,h,m)),y=a}else{const E=e;v=Rs(E.length>1?E(d,{attrs:a,slots:o,emit:l}):E(d,null)),y=e.props?a:v6(a)}}catch(E){tc.length=0,_p(E,r,1),v=ge($s)}let b=v;if(y&&p!==!1){const E=Object.keys(y),{shapeFlag:A}=b;E.length&&A&7&&(s&&E.some(ny)&&(y=b6(y,s)),b=Za(b,y,!1,!0))}return t.dirs&&(b=Za(b,null,!1,!0),b.dirs=b.dirs?b.dirs.concat(t.dirs):t.dirs),t.transition&&hy(b,t.transition),v=b,Kd(g),v}const v6=r=>{let e;for(const t in r)(t==="class"||t==="style"||up(t))&&((e||(e={}))[t]=r[t]);return e},b6=(r,e)=>{const t={};for(const n in r)(!ny(n)||!(n.slice(9)in e))&&(t[n]=r[n]);return t};function w6(r,e,t){const{props:n,children:i,component:s}=r,{props:o,children:a,patchFlag:l}=e,u=s.emitsOptions;if(e.dirs||e.transition)return!0;if(t&&l>=0){if(l&1024)return!0;if(l&16)return n?Ob(n,o,u):!!o;if(l&8){const c=e.dynamicProps;for(let d=0;d<c.length;d++){const h=c[d];if(o[h]!==n[h]&&!Tp(u,h))return!0}}}else return(i||a)&&(!a||!a.$stable)?!0:n===o?!1:n?o?Ob(n,o,u):!0:!!o;return!1}function Ob(r,e,t){const n=Object.keys(e);if(n.length!==Object.keys(r).length)return!0;for(let i=0;i<n.length;i++){const s=n[i];if(e[s]!==r[s]&&!Tp(t,s))return!0}return!1}function _6({vnode:r,parent:e},t){for(;e;){const n=e.subTree;if(n.suspense&&n.suspense.activeBranch===r&&(n.el=r.el),n===r)(r=e.vnode).el=t,e=e.parent;else break}}const Fx={},Lx=()=>Object.create(Fx),Dx=r=>Object.getPrototypeOf(r)===Fx;function x6(r,e,t,n=!1){const i={},s=Lx();r.propsDefaults=Object.create(null),Bx(r,e,i,s);for(const o in r.propsOptions[0])o in i||(i[o]=void 0);t?r.props=n?i:R4(i):r.type.props?r.props=i:r.props=s,r.attrs=s}function E6(r,e,t,n){const{props:i,attrs:s,vnode:{patchFlag:o}}=r,a=$t(i),[l]=r.propsOptions;let u=!1;if((n||o>0)&&!(o&16)){if(o&8){const c=r.vnode.dynamicProps;for(let d=0;d<c.length;d++){let h=c[d];if(Tp(r.emitsOptions,h))continue;const f=e[h];if(l)if(dr(s,h))f!==s[h]&&(s[h]=f,u=!0);else{const m=Wn(h);i[m]=_g(l,a,m,f,r,!1)}else f!==s[h]&&(s[h]=f,u=!0)}}}else{Bx(r,e,i,s)&&(u=!0);let c;for(const d in a)(!e||!dr(e,d)&&((c=ya(d))===d||!dr(e,c)))&&(l?t&&(t[d]!==void 0||t[c]!==void 0)&&(i[d]=_g(l,a,d,void 0,r,!0)):delete i[d]);if(s!==a)for(const d in s)(!e||!dr(e,d))&&(delete s[d],u=!0)}u&&ho(r.attrs,"set","")}function Bx(r,e,t,n){const[i,s]=r.propsOptions;let o=!1,a;if(e)for(let l in e){if(Xu(l))continue;const u=e[l];let c;i&&dr(i,c=Wn(l))?!s||!s.includes(c)?t[c]=u:(a||(a={}))[c]=u:Tp(r.emitsOptions,l)||(!(l in n)||u!==n[l])&&(n[l]=u,o=!0)}if(s){const l=$t(t),u=a||xr;for(let c=0;c<s.length;c++){const d=s[c];t[d]=_g(i,l,d,u[d],r,!dr(u,d))}}return o}function _g(r,e,t,n,i,s){const o=r[t];if(o!=null){const a=dr(o,"default");if(a&&n===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&St(l)){const{propsDefaults:u}=i;if(t in u)n=u[t];else{const c=Xc(i);n=u[t]=l.call(null,e),c()}}else n=l;i.ce&&i.ce._setProp(t,n)}o[0]&&(s&&!a?n=!1:o[1]&&(n===""||n===ya(t))&&(n=!0))}return n}const S6=new WeakMap;function Ux(r,e,t=!1){const n=t?S6:e.propsCache,i=n.get(r);if(i)return i;const s=r.props,o={},a=[];let l=!1;if(!St(r)){const c=d=>{l=!0;const[h,f]=Ux(d,e,!0);Tn(o,h),f&&a.push(...f)};!t&&e.mixins.length&&e.mixins.forEach(c),r.extends&&c(r.extends),r.mixins&&r.mixins.forEach(c)}if(!s&&!l)return Rr(r)&&n.set(r,jl),jl;if(xt(s))for(let c=0;c<s.length;c++){const d=Wn(s[c]);Ib(d)&&(o[d]=xr)}else if(s)for(const c in s){const d=Wn(c);if(Ib(d)){const h=s[c],f=o[d]=xt(h)||St(h)?{type:h}:Tn({},h),m=f.type;let p=!1,g=!0;if(xt(m))for(let v=0;v<m.length;++v){const y=m[v],b=St(y)&&y.name;if(b==="Boolean"){p=!0;break}else b==="String"&&(g=!1)}else p=St(m)&&m.name==="Boolean";f[0]=p,f[1]=g,(p||dr(f,"default"))&&a.push(d)}}const u=[o,a];return Rr(r)&&n.set(r,u),u}function Ib(r){return r[0]!=="$"&&!Xu(r)}const fy=r=>r==="_"||r==="_ctx"||r==="$stable",py=r=>xt(r)?r.map(Rs):[Rs(r)],T6=(r,e,t)=>{if(e._n)return e;const n=de((...i)=>py(e(...i)),t);return n._c=!1,n},Vx=(r,e,t)=>{const n=r._ctx;for(const i in r){if(fy(i))continue;const s=r[i];if(St(s))e[i]=T6(i,s,n);else if(s!=null){const o=py(s);e[i]=()=>o}}},jx=(r,e)=>{const t=py(e);r.slots.default=()=>t},$x=(r,e,t)=>{for(const n in e)(t||!fy(n))&&(r[n]=e[n])},R6=(r,e,t)=>{const n=r.slots=Lx();if(r.vnode.shapeFlag&32){const i=e._;i?($x(n,e,t),t&&j2(n,"_",i,!0)):Vx(e,n)}else e&&jx(r,e)},A6=(r,e,t)=>{const{vnode:n,slots:i}=r;let s=!0,o=xr;if(n.shapeFlag&32){const a=e._;a?t&&a===1?s=!1:$x(i,e,t):(s=!e.$stable,Vx(e,i)),o=e}else e&&(jx(r,e),o={default:1});if(s)for(const a in i)!fy(a)&&o[a]==null&&delete i[a]},Yn=I6;function C6(r){return N6(r)}function N6(r,e){const t=pp();t.__VUE__=!0;const{insert:n,remove:i,patchProp:s,createElement:o,createText:a,createComment:l,setText:u,setElementText:c,parentNode:d,nextSibling:h,setScopeId:f=Ps,insertStaticContent:m}=r,p=(W,Y,Z,se=null,re=null,K=null,ie=void 0,ne=null,le=!!Y.dynamicChildren)=>{if(W===Y)return;W&&!Ru(W,Y)&&(se=X(W),D(W,re,K,!0),W=null),Y.patchFlag===-2&&(le=!1,Y.dynamicChildren=null);const{type:ae,ref:fe,shapeFlag:pe}=Y;switch(ae){case Rp:g(W,Y,Z,se);break;case $s:v(W,Y,Z,se);break;case wm:W==null&&y(Y,Z,se,ie);break;case Tt:V(W,Y,Z,se,re,K,ie,ne,le);break;default:pe&1?A(W,Y,Z,se,re,K,ie,ne,le):pe&6?R(W,Y,Z,se,re,K,ie,ne,le):(pe&64||pe&128)&&ae.process(W,Y,Z,se,re,K,ie,ne,le,j)}fe!=null&&re?Ju(fe,W&&W.ref,K,Y||W,!Y):fe==null&&W&&W.ref!=null&&Ju(W.ref,null,K,W,!0)},g=(W,Y,Z,se)=>{if(W==null)n(Y.el=a(Y.children),Z,se);else{const re=Y.el=W.el;Y.children!==W.children&&u(re,Y.children)}},v=(W,Y,Z,se)=>{W==null?n(Y.el=l(Y.children||""),Z,se):Y.el=W.el},y=(W,Y,Z,se)=>{[W.el,W.anchor]=m(W.children,Y,Z,se,W.el,W.anchor)},b=({el:W,anchor:Y},Z,se)=>{let re;for(;W&&W!==Y;)re=h(W),n(W,Z,se),W=re;n(Y,Z,se)},E=({el:W,anchor:Y})=>{let Z;for(;W&&W!==Y;)Z=h(W),i(W),W=Z;i(Y)},A=(W,Y,Z,se,re,K,ie,ne,le)=>{if(Y.type==="svg"?ie="svg":Y.type==="math"&&(ie="mathml"),W==null)M(Y,Z,se,re,K,ie,ne,le);else{const ae=W.el&&W.el._isVueCE?W.el:null;try{ae&&ae._beginPatch(),P(W,Y,re,K,ie,ne,le)}finally{ae&&ae._endPatch()}}},M=(W,Y,Z,se,re,K,ie,ne)=>{let le,ae;const{props:fe,shapeFlag:pe,transition:ye,dirs:xe}=W;if(le=W.el=o(W.type,K,fe&&fe.is,fe),pe&8?c(le,W.children):pe&16&&k(W.children,le,null,se,re,bm(W,K),ie,ne),xe&&Ra(W,null,se,"created"),L(le,W,W.scopeId,ie,se),fe){for(const Oe in fe)Oe!=="value"&&!Xu(Oe)&&s(le,Oe,null,fe[Oe],K,se);"value"in fe&&s(le,"value",null,fe.value,K),(ae=fe.onVnodeBeforeMount)&&vs(ae,se,W)}xe&&Ra(W,null,se,"beforeMount");const Ne=M6(re,ye);Ne&&ye.beforeEnter(le),n(le,Y,Z),((ae=fe&&fe.onVnodeMounted)||Ne||xe)&&Yn(()=>{ae&&vs(ae,se,W),Ne&&ye.enter(le),xe&&Ra(W,null,se,"mounted")},re)},L=(W,Y,Z,se,re)=>{if(Z&&f(W,Z),se)for(let K=0;K<se.length;K++)f(W,se[K]);if(re){let K=re.subTree;if(Y===K||Wx(K.type)&&(K.ssContent===Y||K.ssFallback===Y)){const ie=re.vnode;L(W,ie,ie.scopeId,ie.slotScopeIds,re.parent)}}},k=(W,Y,Z,se,re,K,ie,ne,le=0)=>{for(let ae=le;ae<W.length;ae++){const fe=W[ae]=ne?Yo(W[ae]):Rs(W[ae]);p(null,fe,Y,Z,se,re,K,ie,ne)}},P=(W,Y,Z,se,re,K,ie)=>{const ne=Y.el=W.el;let{patchFlag:le,dynamicChildren:ae,dirs:fe}=Y;le|=W.patchFlag&16;const pe=W.props||xr,ye=Y.props||xr;let xe;if(Z&&Aa(Z,!1),(xe=ye.onVnodeBeforeUpdate)&&vs(xe,Z,Y,W),fe&&Ra(Y,W,Z,"beforeUpdate"),Z&&Aa(Z,!0),(pe.innerHTML&&ye.innerHTML==null||pe.textContent&&ye.textContent==null)&&c(ne,""),ae?U(W.dynamicChildren,ae,ne,Z,se,bm(Y,re),K):ie||_(W,Y,ne,null,Z,se,bm(Y,re),K,!1),le>0){if(le&16)$(ne,pe,ye,Z,re);else if(le&2&&pe.class!==ye.class&&s(ne,"class",null,ye.class,re),le&4&&s(ne,"style",pe.style,ye.style,re),le&8){const Ne=Y.dynamicProps;for(let Oe=0;Oe<Ne.length;Oe++){const Me=Ne[Oe],qe=pe[Me],We=ye[Me];(We!==qe||Me==="value")&&s(ne,Me,qe,We,re,Z)}}le&1&&W.children!==Y.children&&c(ne,Y.children)}else!ie&&ae==null&&$(ne,pe,ye,Z,re);((xe=ye.onVnodeUpdated)||fe)&&Yn(()=>{xe&&vs(xe,Z,Y,W),fe&&Ra(Y,W,Z,"updated")},se)},U=(W,Y,Z,se,re,K,ie)=>{for(let ne=0;ne<Y.length;ne++){const le=W[ne],ae=Y[ne],fe=le.el&&(le.type===Tt||!Ru(le,ae)||le.shapeFlag&198)?d(le.el):Z;p(le,ae,fe,null,se,re,K,ie,!0)}},$=(W,Y,Z,se,re)=>{if(Y!==Z){if(Y!==xr)for(const K in Y)!Xu(K)&&!(K in Z)&&s(W,K,Y[K],null,re,se);for(const K in Z){if(Xu(K))continue;const ie=Z[K],ne=Y[K];ie!==ne&&K!=="value"&&s(W,K,ne,ie,re,se)}"value"in Z&&s(W,"value",Y.value,Z.value,re)}},V=(W,Y,Z,se,re,K,ie,ne,le)=>{const ae=Y.el=W?W.el:a(""),fe=Y.anchor=W?W.anchor:a("");let{patchFlag:pe,dynamicChildren:ye,slotScopeIds:xe}=Y;xe&&(ne=ne?ne.concat(xe):xe),W==null?(n(ae,Z,se),n(fe,Z,se),k(Y.children||[],Z,fe,re,K,ie,ne,le)):pe>0&&pe&64&&ye&&W.dynamicChildren&&W.dynamicChildren.length===ye.length?(U(W.dynamicChildren,ye,Z,re,K,ie,ne),(Y.key!=null||re&&Y===re.subTree)&&my(W,Y,!0)):_(W,Y,Z,fe,re,K,ie,ne,le)},R=(W,Y,Z,se,re,K,ie,ne,le)=>{Y.slotScopeIds=ne,W==null?Y.shapeFlag&512?re.ctx.activate(Y,Z,se,ie,le):O(Y,Z,se,re,K,ie,le):T(W,Y,le)},O=(W,Y,Z,se,re,K,ie)=>{const ne=W.component=D6(W,se,re);if(Rx(W)&&(ne.ctx.renderer=j),B6(ne,!1,ie),ne.asyncDep){if(re&&re.registerDep(ne,w,ie),!W.el){const le=ne.subTree=ge($s);v(null,le,Y,Z),W.placeholder=le.el}}else w(ne,W,Y,Z,re,K,ie)},T=(W,Y,Z)=>{const se=Y.component=W.component;if(w6(W,Y,Z))if(se.asyncDep&&!se.asyncResolved){x(se,Y,Z);return}else se.next=Y,se.update();else Y.el=W.el,se.vnode=Y},w=(W,Y,Z,se,re,K,ie)=>{const ne=()=>{if(W.isMounted){let{next:pe,bu:ye,u:xe,parent:Ne,vnode:Oe}=W;{const Je=zx(W);if(Je){pe&&(pe.el=Oe.el,x(W,pe,ie)),Je.asyncDep.then(()=>{W.isUnmounted||ne()});return}}let Me=pe,qe;Aa(W,!1),pe?(pe.el=Oe.el,x(W,pe,ie)):pe=Oe,ye&&ld(ye),(qe=pe.props&&pe.props.onVnodeBeforeUpdate)&&vs(qe,Ne,pe,Oe),Aa(W,!0);const We=Mb(W),Ke=W.subTree;W.subTree=We,p(Ke,We,d(Ke.el),X(Ke),W,re,K),pe.el=We.el,Me===null&&_6(W,We.el),xe&&Yn(xe,re),(qe=pe.props&&pe.props.onVnodeUpdated)&&Yn(()=>vs(qe,Ne,pe,Oe),re)}else{let pe;const{el:ye,props:xe}=Y,{bm:Ne,m:Oe,parent:Me,root:qe,type:We}=W,Ke=Hl(Y);Aa(W,!1),Ne&&ld(Ne),!Ke&&(pe=xe&&xe.onVnodeBeforeMount)&&vs(pe,Me,Y),Aa(W,!0);{qe.ce&&qe.ce._def.shadowRoot!==!1&&qe.ce._injectChildStyle(We);const Je=W.subTree=Mb(W);p(null,Je,Z,se,W,re,K),Y.el=Je.el}if(Oe&&Yn(Oe,re),!Ke&&(pe=xe&&xe.onVnodeMounted)){const Je=Y;Yn(()=>vs(pe,Me,Je),re)}(Y.shapeFlag&256||Me&&Hl(Me.vnode)&&Me.vnode.shapeFlag&256)&&W.a&&Yn(W.a,re),W.isMounted=!0,Y=Z=se=null}};W.scope.on();const le=W.effect=new Y2(ne);W.scope.off();const ae=W.update=le.run.bind(le),fe=W.job=le.runIfDirty.bind(le);fe.i=W,fe.id=W.uid,le.scheduler=()=>cy(fe),Aa(W,!0),ae()},x=(W,Y,Z)=>{Y.component=W;const se=W.vnode.props;W.vnode=Y,W.next=null,E6(W,Y.props,se,Z),A6(W,Y.children,Z),xo(),_b(W),Eo()},_=(W,Y,Z,se,re,K,ie,ne,le=!1)=>{const ae=W&&W.children,fe=W?W.shapeFlag:0,pe=Y.children,{patchFlag:ye,shapeFlag:xe}=Y;if(ye>0){if(ye&128){C(ae,pe,Z,se,re,K,ie,ne,le);return}else if(ye&256){S(ae,pe,Z,se,re,K,ie,ne,le);return}}xe&8?(fe&16&&B(ae,re,K),pe!==ae&&c(Z,pe)):fe&16?xe&16?C(ae,pe,Z,se,re,K,ie,ne,le):B(ae,re,K,!0):(fe&8&&c(Z,""),xe&16&&k(pe,Z,se,re,K,ie,ne,le))},S=(W,Y,Z,se,re,K,ie,ne,le)=>{W=W||jl,Y=Y||jl;const ae=W.length,fe=Y.length,pe=Math.min(ae,fe);let ye;for(ye=0;ye<pe;ye++){const xe=Y[ye]=le?Yo(Y[ye]):Rs(Y[ye]);p(W[ye],xe,Z,null,re,K,ie,ne,le)}ae>fe?B(W,re,K,!0,!1,pe):k(Y,Z,se,re,K,ie,ne,le,pe)},C=(W,Y,Z,se,re,K,ie,ne,le)=>{let ae=0;const fe=Y.length;let pe=W.length-1,ye=fe-1;for(;ae<=pe&&ae<=ye;){const xe=W[ae],Ne=Y[ae]=le?Yo(Y[ae]):Rs(Y[ae]);if(Ru(xe,Ne))p(xe,Ne,Z,null,re,K,ie,ne,le);else break;ae++}for(;ae<=pe&&ae<=ye;){const xe=W[pe],Ne=Y[ye]=le?Yo(Y[ye]):Rs(Y[ye]);if(Ru(xe,Ne))p(xe,Ne,Z,null,re,K,ie,ne,le);else break;pe--,ye--}if(ae>pe){if(ae<=ye){const xe=ye+1,Ne=xe<fe?Y[xe].el:se;for(;ae<=ye;)p(null,Y[ae]=le?Yo(Y[ae]):Rs(Y[ae]),Z,Ne,re,K,ie,ne,le),ae++}}else if(ae>ye)for(;ae<=pe;)D(W[ae],re,K,!0),ae++;else{const xe=ae,Ne=ae,Oe=new Map;for(ae=Ne;ae<=ye;ae++){const Le=Y[ae]=le?Yo(Y[ae]):Rs(Y[ae]);Le.key!=null&&Oe.set(Le.key,ae)}let Me,qe=0;const We=ye-Ne+1;let Ke=!1,Je=0;const Ve=new Array(We);for(ae=0;ae<We;ae++)Ve[ae]=0;for(ae=xe;ae<=pe;ae++){const Le=W[ae];if(qe>=We){D(Le,re,K,!0);continue}let Ye;if(Le.key!=null)Ye=Oe.get(Le.key);else for(Me=Ne;Me<=ye;Me++)if(Ve[Me-Ne]===0&&Ru(Le,Y[Me])){Ye=Me;break}Ye===void 0?D(Le,re,K,!0):(Ve[Ye-Ne]=ae+1,Ye>=Je?Je=Ye:Ke=!0,p(Le,Y[Ye],Z,null,re,K,ie,ne,le),qe++)}const Pe=Ke?O6(Ve):jl;for(Me=Pe.length-1,ae=We-1;ae>=0;ae--){const Le=Ne+ae,Ye=Y[Le],Ze=Y[Le+1],Ft=Le+1<fe?Ze.el||Hx(Ze):se;Ve[ae]===0?p(null,Ye,Z,Ft,re,K,ie,ne,le):Ke&&(Me<0||ae!==Pe[Me]?F(Ye,Z,Ft,2):Me--)}}},F=(W,Y,Z,se,re=null)=>{const{el:K,type:ie,transition:ne,children:le,shapeFlag:ae}=W;if(ae&6){F(W.component.subTree,Y,Z,se);return}if(ae&128){W.suspense.move(Y,Z,se);return}if(ae&64){ie.move(W,Y,Z,j);return}if(ie===Tt){n(K,Y,Z);for(let pe=0;pe<le.length;pe++)F(le[pe],Y,Z,se);n(W.anchor,Y,Z);return}if(ie===wm){b(W,Y,Z);return}if(se!==2&&ae&1&&ne)if(se===0)ne.beforeEnter(K),n(K,Y,Z),Yn(()=>ne.enter(K),re);else{const{leave:pe,delayLeave:ye,afterLeave:xe}=ne,Ne=()=>{W.ctx.isUnmounted?i(K):n(K,Y,Z)},Oe=()=>{K._isLeaving&&K[q4](!0),pe(K,()=>{Ne(),xe&&xe()})};ye?ye(K,Ne,Oe):Oe()}else n(K,Y,Z)},D=(W,Y,Z,se=!1,re=!1)=>{const{type:K,props:ie,ref:ne,children:le,dynamicChildren:ae,shapeFlag:fe,patchFlag:pe,dirs:ye,cacheIndex:xe}=W;if(pe===-2&&(re=!1),ne!=null&&(xo(),Ju(ne,null,Z,W,!0),Eo()),xe!=null&&(Y.renderCache[xe]=void 0),fe&256){Y.ctx.deactivate(W);return}const Ne=fe&1&&ye,Oe=!Hl(W);let Me;if(Oe&&(Me=ie&&ie.onVnodeBeforeUnmount)&&vs(Me,Y,W),fe&6)ee(W.component,Z,se);else{if(fe&128){W.suspense.unmount(Z,se);return}Ne&&Ra(W,null,Y,"beforeUnmount"),fe&64?W.type.remove(W,Y,Z,j,se):ae&&!ae.hasOnce&&(K!==Tt||pe>0&&pe&64)?B(ae,Y,Z,!1,!0):(K===Tt&&pe&384||!re&&fe&16)&&B(le,Y,Z),se&&H(W)}(Oe&&(Me=ie&&ie.onVnodeUnmounted)||Ne)&&Yn(()=>{Me&&vs(Me,Y,W),Ne&&Ra(W,null,Y,"unmounted")},Z)},H=W=>{const{type:Y,el:Z,anchor:se,transition:re}=W;if(Y===Tt){G(Z,se);return}if(Y===wm){E(W);return}const K=()=>{i(Z),re&&!re.persisted&&re.afterLeave&&re.afterLeave()};if(W.shapeFlag&1&&re&&!re.persisted){const{leave:ie,delayLeave:ne}=re,le=()=>ie(Z,K);ne?ne(W.el,K,le):le()}else K()},G=(W,Y)=>{let Z;for(;W!==Y;)Z=h(W),i(W),W=Z;i(Y)},ee=(W,Y,Z)=>{const{bum:se,scope:re,job:K,subTree:ie,um:ne,m:le,a:ae}=W;kb(le),kb(ae),se&&ld(se),re.stop(),K&&(K.flags|=8,D(ie,W,Y,Z)),ne&&Yn(ne,Y),Yn(()=>{W.isUnmounted=!0},Y)},B=(W,Y,Z,se=!1,re=!1,K=0)=>{for(let ie=K;ie<W.length;ie++)D(W[ie],Y,Z,se,re)},X=W=>{if(W.shapeFlag&6)return X(W.component.subTree);if(W.shapeFlag&128)return W.suspense.next();const Y=h(W.anchor||W.el),Z=Y&&Y[_x];return Z?h(Z):Y};let I=!1;const N=(W,Y,Z)=>{let se;W==null?Y._vnode&&(D(Y._vnode,null,null,!0),se=Y._vnode.component):p(Y._vnode||null,W,Y,null,null,null,Z),Y._vnode=W,I||(I=!0,_b(se),gx(),I=!1)},j={p,um:D,m:F,r:H,mt:O,mc:k,pc:_,pbc:U,n:X,o:r};return{render:N,hydrate:void 0,createApp:p6(N)}}function bm({type:r,props:e},t){return t==="svg"&&r==="foreignObject"||t==="mathml"&&r==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:t}function Aa({effect:r,job:e},t){t?(r.flags|=32,e.flags|=4):(r.flags&=-33,e.flags&=-5)}function M6(r,e){return(!r||r&&!r.pendingBranch)&&e&&!e.persisted}function my(r,e,t=!1){const n=r.children,i=e.children;if(xt(n)&&xt(i))for(let s=0;s<n.length;s++){const o=n[s];let a=i[s];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=i[s]=Yo(i[s]),a.el=o.el),!t&&a.patchFlag!==-2&&my(o,a)),a.type===Rp&&(a.patchFlag!==-1?a.el=o.el:a.__elIndex=s+(r.type===Tt?1:0)),a.type===$s&&!a.el&&(a.el=o.el)}}function O6(r){const e=r.slice(),t=[0];let n,i,s,o,a;const l=r.length;for(n=0;n<l;n++){const u=r[n];if(u!==0){if(i=t[t.length-1],r[i]<u){e[n]=i,t.push(n);continue}for(s=0,o=t.length-1;s<o;)a=s+o>>1,r[t[a]]<u?s=a+1:o=a;u<r[t[s]]&&(s>0&&(e[n]=t[s-1]),t[s]=n)}}for(s=t.length,o=t[s-1];s-- >0;)t[s]=o,o=e[o];return t}function zx(r){const e=r.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:zx(e)}function kb(r){if(r)for(let e=0;e<r.length;e++)r[e].flags|=8}function Hx(r){if(r.placeholder)return r.placeholder;const e=r.component;return e?Hx(e.subTree):null}const Wx=r=>r.__isSuspense;function I6(r,e){e&&e.pendingBranch?xt(r)?e.effects.push(...r):e.effects.push(r):V4(r)}const Tt=Symbol.for("v-fgt"),Rp=Symbol.for("v-txt"),$s=Symbol.for("v-cmt"),wm=Symbol.for("v-stc"),tc=[];let _i=null;function he(r=!1){tc.push(_i=r?null:[])}function k6(){tc.pop(),_i=tc[tc.length-1]||null}let xc=1;function Jd(r,e=!1){xc+=r,r<0&&_i&&e&&(_i.hasOnce=!0)}function Gx(r){return r.dynamicChildren=xc>0?_i||jl:null,k6(),xc>0&&_i&&_i.push(r),r}function ke(r,e,t,n,i,s){return Gx(we(r,e,t,n,i,s,!0))}function Ee(r,e,t,n,i){return Gx(ge(r,e,t,n,i,!0))}function Ec(r){return r?r.__v_isVNode===!0:!1}function Ru(r,e){return r.type===e.type&&r.key===e.key}const qx=({key:r})=>r??null,cd=({ref:r,ref_key:e,ref_for:t})=>(typeof r=="number"&&(r=""+r),r!=null?Fr(r)||Cr(r)||St(r)?{i:xn,r,k:e,f:!!t}:r:null);function we(r,e=null,t=null,n=0,i=null,s=r===Tt?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:r,props:e,key:e&&qx(e),ref:e&&cd(e),scopeId:vx,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:n,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:xn};return a?(gy(l,t),s&128&&r.normalize(l)):t&&(l.shapeFlag|=Fr(t)?8:16),xc>0&&!o&&_i&&(l.patchFlag>0||s&6)&&l.patchFlag!==32&&_i.push(l),l}const ge=P6;function P6(r,e=null,t=null,n=0,i=null,s=!1){if((!r||r===Cx)&&(r=$s),Ec(r)){const a=Za(r,e,!0);return t&&gy(a,t),xc>0&&!s&&_i&&(a.shapeFlag&6?_i[_i.indexOf(r)]=a:_i.push(a)),a.patchFlag=-2,a}if(z6(r)&&(r=r.__vccOpts),e){e=un(e);let{class:a,style:l}=e;a&&!Fr(a)&&(e.class=mt(a)),Rr(l)&&(bp(l)&&!xt(l)&&(l=Tn({},l)),e.style=qs(l))}const o=Fr(r)?1:Wx(r)?128:W4(r)?64:Rr(r)?4:St(r)?2:0;return we(r,e,t,n,i,o,s,!0)}function un(r){return r?bp(r)||Dx(r)?Tn({},r):r:null}function Za(r,e,t=!1,n=!1){const{props:i,ref:s,patchFlag:o,children:a,transition:l}=r,u=e?et(i||{},e):i,c={__v_isVNode:!0,__v_skip:!0,type:r.type,props:u,key:u&&qx(u),ref:e&&e.ref?t&&s?xt(s)?s.concat(cd(e)):[s,cd(e)]:cd(e):s,scopeId:r.scopeId,slotScopeIds:r.slotScopeIds,children:a,target:r.target,targetStart:r.targetStart,targetAnchor:r.targetAnchor,staticCount:r.staticCount,shapeFlag:r.shapeFlag,patchFlag:e&&r.type!==Tt?o===-1?16:o|16:o,dynamicProps:r.dynamicProps,dynamicChildren:r.dynamicChildren,appContext:r.appContext,dirs:r.dirs,transition:l,component:r.component,suspense:r.suspense,ssContent:r.ssContent&&Za(r.ssContent),ssFallback:r.ssFallback&&Za(r.ssFallback),placeholder:r.placeholder,el:r.el,anchor:r.anchor,ctx:r.ctx,ce:r.ce};return l&&n&&hy(c,l.clone(c)),c}function ze(r=" ",e=0){return ge(Rp,null,r,e)}function zt(r="",e=!1){return e?(he(),Ee($s,null,r)):ge($s,null,r)}function Rs(r){return r==null||typeof r=="boolean"?ge($s):xt(r)?ge(Tt,null,r.slice()):Ec(r)?Yo(r):ge(Rp,null,String(r))}function Yo(r){return r.el===null&&r.patchFlag!==-1||r.memo?r:Za(r)}function gy(r,e){let t=0;const{shapeFlag:n}=r;if(e==null)e=null;else if(xt(e))t=16;else if(typeof e=="object")if(n&65){const i=e.default;i&&(i._c&&(i._d=!1),gy(r,i()),i._c&&(i._d=!0));return}else{t=32;const i=e._;!i&&!Dx(e)?e._ctx=xn:i===3&&xn&&(xn.slots._===1?e._=1:(e._=2,r.patchFlag|=1024))}else St(e)?(e={default:e,_ctx:xn},t=32):(e=String(e),n&64?(t=16,e=[ze(e)]):t=8);r.children=e,r.shapeFlag|=t}function et(...r){const e={};for(let t=0;t<r.length;t++){const n=r[t];for(const i in n)if(i==="class")e.class!==n.class&&(e.class=mt([e.class,n.class]));else if(i==="style")e.style=qs([e.style,n.style]);else if(up(i)){const s=e[i],o=n[i];o&&s!==o&&!(xt(s)&&s.includes(o))&&(e[i]=s?[].concat(s,o):o)}else i!==""&&(e[i]=n[i])}return e}function vs(r,e,t,n=null){js(r,e,7,[t,n])}const F6=kx();let L6=0;function D6(r,e,t){const n=r.type,i=(e?e.appContext:r.appContext)||F6,s={uid:L6++,vnode:r,type:n,parent:e,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new W2(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(i.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Ux(n,i),emitsOptions:Px(n,i),emit:null,emitted:null,propsDefaults:xr,inheritAttrs:n.inheritAttrs,ctx:xr,data:xr,props:xr,attrs:xr,slots:xr,refs:xr,setupState:xr,setupContext:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=e?e.root:s,s.emit=g6.bind(null,s),r.ce&&r.ce(s),s}let $n=null;const Ys=()=>$n||xn;let ef,xg;{const r=pp(),e=(t,n)=>{let i;return(i=r[t])||(i=r[t]=[]),i.push(n),s=>{i.length>1?i.forEach(o=>o(s)):i[0](s)}};ef=e("__VUE_INSTANCE_SETTERS__",t=>$n=t),xg=e("__VUE_SSR_SETTERS__",t=>Sc=t)}const Xc=r=>{const e=$n;return ef(r),r.scope.on(),()=>{r.scope.off(),ef(e)}},Pb=()=>{$n&&$n.scope.off(),ef(null)};function Yx(r){return r.vnode.shapeFlag&4}let Sc=!1;function B6(r,e=!1,t=!1){e&&xg(e);const{props:n,children:i}=r.vnode,s=Yx(r);x6(r,n,s,e),R6(r,i,t||e);const o=s?U6(r,e):void 0;return e&&xg(!1),o}function U6(r,e){const t=r.type;r.accessCache=Object.create(null),r.proxy=new Proxy(r.ctx,a6);const{setup:n}=t;if(n){xo();const i=r.setupContext=n.length>1?j6(r):null,s=Xc(r),o=Yc(n,r,0,[r.props,i]),a=B2(o);if(Eo(),s(),(a||r.sp)&&!Hl(r)&&Tx(r),a){if(o.then(Pb,Pb),e)return o.then(l=>{Fb(r,l)}).catch(l=>{_p(l,r,0)});r.asyncDep=o}else Fb(r,o)}else Xx(r)}function Fb(r,e,t){St(e)?r.type.__ssrInlineRender?r.ssrRender=e:r.render=e:Rr(e)&&(r.setupState=dx(e)),Xx(r)}function Xx(r,e,t){const n=r.type;r.render||(r.render=n.render||Ps);{const i=Xc(r);xo();try{l6(r)}finally{Eo(),i()}}}const V6={get(r,e){return Vn(r,"get",""),r[e]}};function j6(r){const e=t=>{r.exposed=t||{}};return{attrs:new Proxy(r.attrs,V6),slots:r.slots,emit:r.emit,expose:e}}function Ap(r){return r.exposed?r.exposeProxy||(r.exposeProxy=new Proxy(dx(cx(r.exposed)),{get(e,t){if(t in e)return e[t];if(t in ec)return ec[t](r)},has(e,t){return t in e||t in ec}})):r.proxy}function $6(r,e=!0){return St(r)?r.displayName||r.name:r.name||e&&r.__name}function z6(r){return St(r)&&"__vccOpts"in r}const Te=(r,e)=>F4(r,e,Sc);function Fs(r,e,t){try{Jd(-1);const n=arguments.length;return n===2?Rr(e)&&!xt(e)?Ec(e)?ge(r,null,[e]):ge(r,e):ge(r,null,e):(n>3?t=Array.prototype.slice.call(arguments,2):n===3&&Ec(t)&&(t=[t]),ge(r,e,t))}finally{Jd(1)}}const H6="3.5.27";let Eg;const Lb=typeof window<"u"&&window.trustedTypes;if(Lb)try{Eg=Lb.createPolicy("vue",{createHTML:r=>r})}catch{}const Kx=Eg?r=>Eg.createHTML(r):r=>r,W6="http://www.w3.org/2000/svg",G6="http://www.w3.org/1998/Math/MathML",ao=typeof document<"u"?document:null,Db=ao&&ao.createElement("template"),q6={insert:(r,e,t)=>{e.insertBefore(r,t||null)},remove:r=>{const e=r.parentNode;e&&e.removeChild(r)},createElement:(r,e,t,n)=>{const i=e==="svg"?ao.createElementNS(W6,r):e==="mathml"?ao.createElementNS(G6,r):t?ao.createElement(r,{is:t}):ao.createElement(r);return r==="select"&&n&&n.multiple!=null&&i.setAttribute("multiple",n.multiple),i},createText:r=>ao.createTextNode(r),createComment:r=>ao.createComment(r),setText:(r,e)=>{r.nodeValue=e},setElementText:(r,e)=>{r.textContent=e},parentNode:r=>r.parentNode,nextSibling:r=>r.nextSibling,querySelector:r=>ao.querySelector(r),setScopeId(r,e){r.setAttribute(e,"")},insertStaticContent(r,e,t,n,i,s){const o=t?t.previousSibling:e.lastChild;if(i&&(i===s||i.nextSibling))for(;e.insertBefore(i.cloneNode(!0),t),!(i===s||!(i=i.nextSibling)););else{Db.innerHTML=Kx(n==="svg"?`<svg>${r}</svg>`:n==="mathml"?`<math>${r}</math>`:r);const a=Db.content;if(n==="svg"||n==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,t)}return[o?o.nextSibling:e.firstChild,t?t.previousSibling:e.lastChild]}},Y6=Symbol("_vtc");function X6(r,e,t){const n=r[Y6];n&&(e=(e?[e,...n]:[...n]).join(" ")),e==null?r.removeAttribute("class"):t?r.setAttribute("class",e):r.className=e}const Bb=Symbol("_vod"),K6=Symbol("_vsh"),Z6=Symbol(""),Q6=/(?:^|;)\s*display\s*:/;function J6(r,e,t){const n=r.style,i=Fr(t);let s=!1;if(t&&!i){if(e)if(Fr(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();t[a]==null&&hd(n,a,"")}else for(const o in e)t[o]==null&&hd(n,o,"");for(const o in t)o==="display"&&(s=!0),hd(n,o,t[o])}else if(i){if(e!==t){const o=n[Z6];o&&(t+=";"+o),n.cssText=t,s=Q6.test(t)}}else e&&r.removeAttribute("style");Bb in r&&(r[Bb]=s?n.display:"",r[K6]&&(n.display="none"))}const Ub=/\s*!important$/;function hd(r,e,t){if(xt(t))t.forEach(n=>hd(r,e,n));else if(t==null&&(t=""),e.startsWith("--"))r.setProperty(e,t);else{const n=eN(r,e);Ub.test(t)?r.setProperty(ya(n),t.replace(Ub,""),"important"):r[n]=t}}const Vb=["Webkit","Moz","ms"],_m={};function eN(r,e){const t=_m[e];if(t)return t;let n=Wn(e);if(n!=="filter"&&n in r)return _m[e]=n;n=fp(n);for(let i=0;i<Vb.length;i++){const s=Vb[i]+n;if(s in r)return _m[e]=s}return e}const jb="http://www.w3.org/1999/xlink";function $b(r,e,t,n,i,s=o4(e)){n&&e.startsWith("xlink:")?t==null?r.removeAttributeNS(jb,e.slice(6,e.length)):r.setAttributeNS(jb,e,t):t==null||s&&!$2(t)?r.removeAttribute(e):r.setAttribute(e,s?"":ko(t)?String(t):t)}function zb(r,e,t,n,i){if(e==="innerHTML"||e==="textContent"){t!=null&&(r[e]=e==="innerHTML"?Kx(t):t);return}const s=r.tagName;if(e==="value"&&s!=="PROGRESS"&&!s.includes("-")){const a=s==="OPTION"?r.getAttribute("value")||"":r.value,l=t==null?r.type==="checkbox"?"on":"":String(t);(a!==l||!("_value"in r))&&(r.value=l),t==null&&r.removeAttribute(e),r._value=t;return}let o=!1;if(t===""||t==null){const a=typeof r[e];a==="boolean"?t=$2(t):t==null&&a==="string"?(t="",o=!0):a==="number"&&(t=0,o=!0)}try{r[e]=t}catch{}o&&r.removeAttribute(i||e)}function Ml(r,e,t,n){r.addEventListener(e,t,n)}function tN(r,e,t,n){r.removeEventListener(e,t,n)}const Hb=Symbol("_vei");function rN(r,e,t,n,i=null){const s=r[Hb]||(r[Hb]={}),o=s[e];if(n&&o)o.value=n;else{const[a,l]=nN(e);if(n){const u=s[e]=oN(n,i);Ml(r,a,u,l)}else o&&(tN(r,a,o,l),s[e]=void 0)}}const Wb=/(?:Once|Passive|Capture)$/;function nN(r){let e;if(Wb.test(r)){e={};let n;for(;n=r.match(Wb);)r=r.slice(0,r.length-n[0].length),e[n[0].toLowerCase()]=!0}return[r[2]===":"?r.slice(3):ya(r.slice(2)),e]}let xm=0;const iN=Promise.resolve(),sN=()=>xm||(iN.then(()=>xm=0),xm=Date.now());function oN(r,e){const t=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=t.attached)return;js(aN(n,t.value),e,5,[n])};return t.value=r,t.attached=sN(),t}function aN(r,e){if(xt(e)){const t=r.stopImmediatePropagation;return r.stopImmediatePropagation=()=>{t.call(r),r._stopped=!0},e.map(n=>i=>!i._stopped&&n&&n(i))}else return e}const Gb=r=>r.charCodeAt(0)===111&&r.charCodeAt(1)===110&&r.charCodeAt(2)>96&&r.charCodeAt(2)<123,lN=(r,e,t,n,i,s)=>{const o=i==="svg";e==="class"?X6(r,n,o):e==="style"?J6(r,t,n):up(e)?ny(e)||rN(r,e,t,n,s):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):uN(r,e,n,o))?(zb(r,e,n),!r.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&$b(r,e,n,o,s,e!=="value")):r._isVueCE&&(/[A-Z]/.test(e)||!Fr(n))?zb(r,Wn(e),n,s,e):(e==="true-value"?r._trueValue=n:e==="false-value"&&(r._falseValue=n),$b(r,e,n,o))};function uN(r,e,t,n){if(n)return!!(e==="innerHTML"||e==="textContent"||e in r&&Gb(e)&&St(t));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="sandbox"&&r.tagName==="IFRAME"||e==="form"||e==="list"&&r.tagName==="INPUT"||e==="type"&&r.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const i=r.tagName;if(i==="IMG"||i==="VIDEO"||i==="CANVAS"||i==="SOURCE")return!1}return Gb(e)&&Fr(t)?!1:e in r}const qb=r=>{const e=r.props["onUpdate:modelValue"]||!1;return xt(e)?t=>ld(e,t):e};function cN(r){r.target.composing=!0}function Yb(r){const e=r.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const Em=Symbol("_assign");function Xb(r,e,t){return e&&(r=r.trim()),t&&(r=sy(r)),r}const hN={created(r,{modifiers:{lazy:e,trim:t,number:n}},i){r[Em]=qb(i);const s=n||i.props&&i.props.type==="number";Ml(r,e?"change":"input",o=>{o.target.composing||r[Em](Xb(r.value,t,s))}),(t||s)&&Ml(r,"change",()=>{r.value=Xb(r.value,t,s)}),e||(Ml(r,"compositionstart",cN),Ml(r,"compositionend",Yb),Ml(r,"change",Yb))},mounted(r,{value:e}){r.value=e??""},beforeUpdate(r,{value:e,oldValue:t,modifiers:{lazy:n,trim:i,number:s}},o){if(r[Em]=qb(o),r.composing)return;const a=(s||r.type==="number")&&!/^0\d/.test(r.value)?sy(r.value):r.value,l=e??"";a!==l&&(document.activeElement===r&&r.type!=="range"&&(n&&e===t||i&&r.value.trim()===l)||(r.value=l))}},dN=["ctrl","shift","alt","meta"],fN={stop:r=>r.stopPropagation(),prevent:r=>r.preventDefault(),self:r=>r.target!==r.currentTarget,ctrl:r=>!r.ctrlKey,shift:r=>!r.shiftKey,alt:r=>!r.altKey,meta:r=>!r.metaKey,left:r=>"button"in r&&r.button!==0,middle:r=>"button"in r&&r.button!==1,right:r=>"button"in r&&r.button!==2,exact:(r,e)=>dN.some(t=>r[`${t}Key`]&&!e.includes(t))},as=(r,e)=>{const t=r._withMods||(r._withMods={}),n=e.join(".");return t[n]||(t[n]=((i,...s)=>{for(let o=0;o<e.length;o++){const a=fN[e[o]];if(a&&a(i,e))return}return r(i,...s)}))},pN={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},yy=(r,e)=>{const t=r._withKeys||(r._withKeys={}),n=e.join(".");return t[n]||(t[n]=(i=>{if(!("key"in i))return;const s=ya(i.key);if(e.some(o=>o===s||pN[o]===s))return r(i)}))},mN=Tn({patchProp:lN},q6);let Kb;function Zx(){return Kb||(Kb=C6(mN))}const gN=((...r)=>{Zx().render(...r)}),yN=((...r)=>{const e=Zx().createApp(...r),{mount:t}=e;return e.mount=n=>{const i=bN(n);if(!i)return;const s=e._component;!St(s)&&!s.render&&!s.template&&(s.template=i.innerHTML),i.nodeType===1&&(i.textContent="");const o=t(i,!1,vN(i));return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),o},e});function vN(r){if(r instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&r instanceof MathMLElement)return"mathml"}function bN(r){return Fr(r)?document.querySelector(r):r}class Qr{constructor(e){this.config=e}static create(e,t,n="bar"){return new Qr({columnIndex:e,labelColumnIndex:t,type:n,excludedRows:[],visible:!0})}static fromConfig(e){return new Qr({...e})}get columnIndex(){return this.config.columnIndex}get labelColumnIndex(){return this.config.labelColumnIndex}get type(){return this.config.type}get excludedRows(){return this.config.excludedRows}get visible(){return this.config.visible}get color(){return this.config.color}get title(){return this.config.title}withType(e){return new Qr({...this.config,type:e})}withLabelColumn(e){return new Qr({...this.config,labelColumnIndex:e})}withColor(e){return new Qr({...this.config,color:e})}withTitle(e){return new Qr({...this.config,title:e})}toggleVisibility(){return new Qr({...this.config,visible:!this.config.visible})}show(){return new Qr({...this.config,visible:!0})}hide(){return new Qr({...this.config,visible:!1})}toggleRowExclusion(e){const t=this.config.excludedRows.includes(e)?this.config.excludedRows.filter(n=>n!==e):[...this.config.excludedRows,e];return new Qr({...this.config,excludedRows:t})}excludeRow(e){return this.config.excludedRows.includes(e)?this:new Qr({...this.config,excludedRows:[...this.config.excludedRows,e]})}includeRow(e){return new Qr({...this.config,excludedRows:this.config.excludedRows.filter(t=>t!==e)})}clearExcludedRows(){return new Qr({...this.config,excludedRows:[]})}isRowExcluded(e){return this.config.excludedRows.includes(e)}hasExcludedRows(){return this.config.excludedRows.length>0}getExcludedRowCount(){return this.config.excludedRows.length}toConfig(){return{...this.config}}toJSON(){return this.toConfig()}}const Sm={colorTheme:"blue",size:"medium",iconPosition:"left",typography:{titleSize:"medium",valueSize:"large"},valueFormat:{type:"number"}};class yi{constructor(e){this.config=e}static create(e,t,n,i){return new yi({rowIndex:e,colIndex:t,value:n,label:i,style:Sm})}static fromConfig(e){return new yi({...e,style:e.style||Sm})}get rowIndex(){return this.config.rowIndex}get colIndex(){return this.config.colIndex}get value(){return this.config.value}get label(){return this.config.label}get unit(){return this.config.unit}get color(){return this.config.color}get icon(){return this.config.icon}get style(){return this.config.style||Sm}withLabel(e){return new yi({...this.config,label:e})}withUnit(e){return new yi({...this.config,unit:e})}withColor(e){return new yi({...this.config,color:e})}withIcon(e){return new yi({...this.config,icon:e})}withStyle(e){return new yi({...this.config,style:{...this.style,...e}})}withFullStyle(e){return new yi({...this.config,style:e})}isNumeric(){return typeof this.config.value.value=="number"}isEmpty(){return this.config.value.value===null||this.config.value.value===void 0||this.config.value.value===""}getValueType(){return this.isEmpty()?"empty":typeof this.config.value.value=="number"?"number":typeof this.config.value.value=="boolean"?"boolean":this.config.value.value instanceof Date?"date":"text"}formatValue(){if(this.isEmpty())return"-";const e=this.config.value.value,t=this.style.valueFormat.type,n=this.style.valueFormat.customUnit;if(typeof e=="number")switch(t){case"integer":return Math.round(e).toLocaleString("fr-FR");case"percentage":return`${e.toLocaleString("fr-FR",{maximumFractionDigits:1})}%`;case"currency":return`${e.toLocaleString("fr-FR",{maximumFractionDigits:2})} ${n||""}`;default:return e.toLocaleString("fr-FR",{maximumFractionDigits:2})}return e instanceof Date?e.toLocaleDateString("fr-FR"):typeof e=="boolean"?e?"Oui":"Non":String(this.config.value.result??this.config.value.value)}toConfig(){return{...this.config}}toJSON(){return this.toConfig()}}const Tm={colorTheme:"blue",titleSize:"xlarge",tableStyle:{showBorders:!0,roundedBorders:!0,alternatingRows:!0},chartPosition:"right"};class Nr{constructor(e){this.config=e}static create(e,t,n){return new Nr({title:e,header:t,data:n,charts:[],applyFiltersToCharts:!0,style:Tm})}static fromConfig(e){return new Nr({...e,style:e.style||Tm})}get title(){return this.config.title}get header(){return this.config.header}get data(){return this.config.data}get cardRecap(){return this.config.cardRecap?yi.fromConfig(this.config.cardRecap):void 0}get charts(){return(this.config.charts||[]).map(e=>Qr.fromConfig(e))}get searchText(){return this.config.searchText}get sortConfig(){return this.config.sortConfig}get applyFiltersToCharts(){return this.config.applyFiltersToCharts??!0}get style(){return this.config.style||Tm}withTitle(e){return new Nr({...this.config,title:e})}withSearchText(e){return new Nr({...this.config,searchText:e})}withSort(e,t){return new Nr({...this.config,sortConfig:{columnIndex:e,direction:t}})}withApplyFiltersToCharts(e){return new Nr({...this.config,applyFiltersToCharts:e})}withStyle(e){return new Nr({...this.config,style:{...this.style,...e}})}withFullStyle(e){return new Nr({...this.config,style:e})}clearSearch(){return new Nr({...this.config,searchText:void 0})}setCardRecap(e){return new Nr({...this.config,cardRecap:e.toConfig()})}clearCardRecap(){return new Nr({...this.config,cardRecap:void 0})}addChart(e){const t=[...this.config.charts||[],e.toConfig()];return new Nr({...this.config,charts:t})}updateChart(e,t){const n=(this.config.charts||[]).map(i=>i.columnIndex===e?t(Qr.fromConfig(i)).toConfig():i);return new Nr({...this.config,charts:n})}removeChart(e){const t=(this.config.charts||[]).filter(n=>n.columnIndex!==e);return new Nr({...this.config,charts:t})}toggleChart(e){if(this.config.charts?.find(s=>s.columnIndex===e))return this.updateChart(e,s=>s.toggleVisibility());const n=this.findLabelColumn(),i=Qr.create(e,n);return this.addChart(i)}clearSort(){return new Nr({...this.config,sortConfig:void 0})}toggleSort(e){return this.config.sortConfig?.columnIndex===e?this.config.sortConfig.direction==="asc"?this.withSort(e,"desc"):this.clearSort():this.withSort(e,"asc")}getMetadata(){return{columnCount:this.config.header.length,rowCount:this.config.data.length,chartCount:this.config.charts?.length||0,visibleChartCount:this.config.charts?.filter(e=>e.visible).length||0,hasCardRecap:!!this.config.cardRecap,hasActiveSearch:!!this.config.searchText,isEmpty:this.config.data.length===0,hasActiveSort:!!this.config.sortConfig}}getColumnInfo(e){const t=String(this.config.header[e]?.value||`Col ${e+1}`),n=this.config.data.map(a=>a[e]),i=n.every(a=>typeof a?.value=="number"||a?.value==null),s=n.every(a=>a?.value==null||a?.value==="");let o="mixed";return s?o="empty":i?o="number":n.every(a=>typeof a?.value=="string"||a?.value==null)?o="text":n.every(a=>a?.value instanceof Date||a?.value==null)?o="date":n.every(a=>typeof a?.value=="boolean"||a?.value==null)&&(o="boolean"),{index:e,label:t,type:o,isNumeric:i,isEmpty:s}}getAllColumnInfo(){return this.config.header.map((e,t)=>this.getColumnInfo(t))}getNumericColumns(){return this.getAllColumnInfo().filter(e=>e.isNumeric&&!e.isEmpty)}getTextColumns(){return this.getAllColumnInfo().filter(e=>e.type==="text"&&!e.isEmpty)}findLabelColumn(){const e=this.getTextColumns();return e.length>0?e[0].index:0}hasChart(e){return this.config.charts?.some(t=>t.columnIndex===e)||!1}getChart(e){const t=this.config.charts?.find(n=>n.columnIndex===e);return t?Qr.fromConfig(t):void 0}getVisibleCharts(){return this.charts.filter(e=>e.visible)}getFilteredData(){if(!this.config.searchText)return this.config.data;const e=this.config.searchText.toLowerCase();return this.config.data.filter(t=>t.some(n=>n.value==null?!1:String(n.value).toLowerCase().includes(e)))}toConfig(){return{...this.config}}toJSON(){return this.toConfig()}}var $r;(function(r){r.RELATIVE="RELATIVE",r.ABSOLUTE="ABSOLUTE"})($r||($r={}));class Xn{constructor(e,t,n){this.type=e,this.col=t,this.sheet=n}static absolute(e,t){return new Xn($r.ABSOLUTE,e,t)}static relative(e,t){return new Xn($r.RELATIVE,e,t)}static compareByAbsoluteAddress(e){return(t,n)=>t.toSimpleColumnAddress(e).col-n.toSimpleColumnAddress(e).col}isColumnAbsolute(){return this.type===$r.ABSOLUTE}isColumnRelative(){return this.type===$r.RELATIVE}isAbsolute(){return this.type===$r.ABSOLUTE&&this.sheet!==void 0}moved(e,t,n){const i=this.sheet===void 0?void 0:e;return new Xn(this.type,this.col+t,i)}shiftedByColumns(e){return new Xn(this.type,this.col+e,this.sheet)}toSimpleColumnAddress(e){const t=ls(this,e);let n=this.col;return this.isColumnRelative()&&(n=e.col+this.col),AS(t,n)}shiftRelativeDimensions(e,t){const n=this.isColumnRelative()?this.col+e:this.col;return new Xn(this.type,n,this.sheet)}shiftAbsoluteDimensions(e,t){const n=this.isColumnAbsolute()?this.col+e:this.col;return new Xn(this.type,n,this.sheet)}withSheet(e){return new Xn(this.type,this.col,e)}isInvalid(e){return this.toSimpleColumnAddress(e).col<0}hash(e){const t=e&&this.sheet!==void 0?`#${this.sheet}`:"";switch(this.type){case $r.RELATIVE:return`${t}#COLR${this.col}`;case $r.ABSOLUTE:return`${t}#COLA${this.col}`}}unparse(e){const t=this.toSimpleColumnAddress(e);if(Z8(t))return;const n=Np(t.col);return`${this.type===$r.ABSOLUTE?"$":""}${n}`}exceedsSheetSizeLimits(e){return this.col>=e}}class Bn{constructor(e,t,n){this.type=e,this.row=t,this.sheet=n}static absolute(e,t){return new Bn($r.ABSOLUTE,e,t)}static relative(e,t){return new Bn($r.RELATIVE,e,t)}static compareByAbsoluteAddress(e){return(t,n)=>t.toSimpleRowAddress(e).row-n.toSimpleRowAddress(e).row}isRowAbsolute(){return this.type===$r.ABSOLUTE}isRowRelative(){return this.type===$r.RELATIVE}isAbsolute(){return this.type===$r.ABSOLUTE&&this.sheet!==void 0}moved(e,t,n){const i=this.sheet===void 0?void 0:e;return new Bn(this.type,this.row+n,i)}shiftedByRows(e){return new Bn(this.type,this.row+e,this.sheet)}toSimpleRowAddress(e){const t=ls(this,e);let n=this.row;return this.isRowRelative()&&(n=e.row+this.row),RS(t,n)}shiftRelativeDimensions(e,t){const n=this.isRowRelative()?this.row+t:this.row;return new Bn(this.type,n,this.sheet)}shiftAbsoluteDimensions(e,t){const n=this.isRowAbsolute()?this.row+t:this.row;return new Bn(this.type,n,this.sheet)}withSheet(e){return new Bn(this.type,this.row,e)}isInvalid(e){return this.toSimpleRowAddress(e).row<0}hash(e){const t=e&&this.sheet!==void 0?`#${this.sheet}`:"";switch(this.type){case $r.RELATIVE:return`${t}#ROWR${this.row}`;case $r.ABSOLUTE:return`${t}#ROWA${this.row}`}}unparse(e){const t=this.toSimpleRowAddress(e);return K8(t)?void 0:`${this.type===$r.ABSOLUTE?"$":""}${t.row+1}`}exceedsSheetSizeLimits(e){return this.row>=e}}var hr;(function(r){r.CELL_REFERENCE_RELATIVE="CELL_REFERENCE",r.CELL_REFERENCE_ABSOLUTE="CELL_REFERENCE_ABSOLUTE",r.CELL_REFERENCE_ABSOLUTE_COL="CELL_REFERENCE_ABSOLUTE_COL",r.CELL_REFERENCE_ABSOLUTE_ROW="CELL_REFERENCE_ABSOLUTE_ROW"})(hr||(hr={}));class vr{constructor(e,t,n,i){this.col=e,this.row=t,this.type=n,this.sheet=i}static fromColAndRow(e,t,n){return(e.isColumnAbsolute()&&t.isRowAbsolute()?vr.absolute.bind(this):e.isColumnAbsolute()?vr.absoluteCol.bind(this):t.isRowAbsolute()?vr.absoluteRow.bind(this):vr.relative.bind(this))(e.col,t.row,n)}static relative(e,t,n){return new vr(e,t,hr.CELL_REFERENCE_RELATIVE,n)}static absolute(e,t,n){return new vr(e,t,hr.CELL_REFERENCE_ABSOLUTE,n)}static absoluteCol(e,t,n){return new vr(e,t,hr.CELL_REFERENCE_ABSOLUTE_COL,n)}static absoluteRow(e,t,n){return new vr(e,t,hr.CELL_REFERENCE_ABSOLUTE_ROW,n)}toSimpleCellAddress(e){const t=ls(this,e);return this.type===hr.CELL_REFERENCE_ABSOLUTE?$e(t,this.col,this.row):this.type===hr.CELL_REFERENCE_ABSOLUTE_ROW?$e(t,e.col+this.col,this.row):this.type===hr.CELL_REFERENCE_ABSOLUTE_COL?$e(t,this.col,e.row+this.row):$e(t,e.col+this.col,e.row+this.row)}toColumnAddress(){const e=this.isColumnRelative()?$r.RELATIVE:$r.ABSOLUTE;return new Xn(e,this.col,this.sheet)}toRowAddress(){const e=this.isRowRelative()?$r.RELATIVE:$r.ABSOLUTE;return new Bn(e,this.row,this.sheet)}toSimpleColumnAddress(e){const t=ls(this,e);let n=this.col;return this.isColumnRelative()&&(n+=e.col),AS(t,n)}toSimpleRowAddress(e){const t=ls(this,e);let n=this.row;return this.isRowRelative()&&(n+=e.row),RS(t,n)}isRowAbsolute(){return this.type===hr.CELL_REFERENCE_ABSOLUTE||this.type===hr.CELL_REFERENCE_ABSOLUTE_ROW}isColumnAbsolute(){return this.type===hr.CELL_REFERENCE_ABSOLUTE||this.type===hr.CELL_REFERENCE_ABSOLUTE_COL}isColumnRelative(){return this.type===hr.CELL_REFERENCE_RELATIVE||this.type===hr.CELL_REFERENCE_ABSOLUTE_ROW}isRowRelative(){return this.type===hr.CELL_REFERENCE_RELATIVE||this.type===hr.CELL_REFERENCE_ABSOLUTE_COL}isAbsolute(){return this.type===hr.CELL_REFERENCE_ABSOLUTE&&this.sheet!==void 0}shiftedByRows(e){return new vr(this.col,this.row+e,this.type,this.sheet)}shiftedByColumns(e){return new vr(this.col+e,this.row,this.type,this.sheet)}moved(e,t,n){const i=this.sheet===void 0?void 0:e;return new vr(this.col+t,this.row+n,this.type,i)}withSheet(e){return new vr(this.col,this.row,this.type,e)}isInvalid(e){return ii(this.toSimpleCellAddress(e))}shiftRelativeDimensions(e,t){const n=this.isColumnAbsolute()?this.col:this.col+e,i=this.isRowAbsolute()?this.row:this.row+t;return new vr(n,i,this.type,this.sheet)}shiftAbsoluteDimensions(e,t){const n=this.isColumnRelative()?this.col:this.col+e,i=this.isRowRelative()?this.row:this.row+t;return new vr(n,i,this.type,this.sheet)}hash(e){const t=e&&this.sheet!==void 0?`#${this.sheet}`:"";switch(this.type){case hr.CELL_REFERENCE_RELATIVE:return`${t}#${this.row}R${this.col}`;case hr.CELL_REFERENCE_ABSOLUTE:return`${t}#${this.row}A${this.col}`;case hr.CELL_REFERENCE_ABSOLUTE_COL:return`${t}#${this.row}AC${this.col}`;case hr.CELL_REFERENCE_ABSOLUTE_ROW:return`${t}#${this.row}AR${this.col}`}}unparse(e){const t=this.toSimpleCellAddress(e);if(ii(t))return;const n=Np(t.col),i=this.type===hr.CELL_REFERENCE_ABSOLUTE||this.type===hr.CELL_REFERENCE_ABSOLUTE_ROW?"$":"";return`${this.type===hr.CELL_REFERENCE_ABSOLUTE||this.type===hr.CELL_REFERENCE_ABSOLUTE_COL?"$":""}${n}${i}${t.row+1}`}exceedsSheetSizeLimits(e,t){return this.row>=t||this.col>=e}}const Kc=":",Zn="$",wN="\\s+",_N="[ \\t\\n\\r]+",Cp="A-Za-z-",vy=`${Cp}0-9_.`,Qx=`[${Cp}0-9_]+`,xN="'(((?!').|'')*)'",gu=`(${Qx}|${xN})!`,Jx=`(${gu})?\\${Zn}?[A-Za-z]+\\${Zn}?[0-9]+`,Zb=`(${gu})?\\${Zn}?[A-Za-z]+`,Qb=`(${gu})?\\${Zn}?[0-9]+`,eE="[rR][0-9]*[cC][0-9]*",EN=`(${Jx})[^${vy}]`,tE=`[${Cp}_][${vy}]*`,SN=["0","1","2","3","4","5","6","7","8","9"],rE=[...Array.from(Array(26)).map((r,e)=>e+65),...Array.from(Array(26)).map((r,e)=>e+97),...Array.from(Array(496)).map((r,e)=>e+192)].map(r=>String.fromCharCode(r));const nE=new RegExp(`^(${gu})?(\\${Zn}?)([A-Za-z]+)(\\${Zn}?)([0-9]+)$`),TN=new RegExp(`^(${gu})?(\\${Zn}?)([A-Za-z]+)$`),RN=new RegExp(`^(${gu})?(\\${Zn}?)([0-9]+)$`),AN=new RegExp(`^${Qx}$`),Ol=(r,e,t)=>{const n=nE.exec(r);if(!n)return;const i=by(n[6]),s=Number(n[8])-1,o=Mp(n),a=Op(o,t);if(a!==null)return n[5]===Zn&&n[7]===Zn?vr.absolute(i,s,a):n[5]===Zn?vr.absoluteCol(i,s-e.row,a):n[7]===Zn?vr.absoluteRow(i-e.col,s,a):vr.relative(i-e.col,s-e.row,a)},tf=(r,e,t)=>{const n=TN.exec(r);if(!n)return;const i=by(n[6]),s=Mp(n),o=Op(s,t);if(o!==null)return n[5]===Zn?Xn.absolute(i,o):Xn.relative(i-e.col,o)},rf=(r,e,t)=>{const n=RN.exec(r);if(!n)return;const i=Number(n[6])-1,s=Mp(n),o=Op(s,t);if(o!==null)return n[5]===Zn?Bn.absolute(i,o):Bn.relative(i-e.row,o)},Sg=(r,e,t)=>{const n=nE.exec(e);if(!n)return;const i=by(n[6]),s=Number(n[8])-1,o=Mp(n),a=Op(o,r);return a===null?void 0:$e(a===void 0?t:a,i,s)},CN=(r,e,t)=>{const n=e.split(Kc);if(n.length!==2)return;const[i,s]=n,o=Sg(r,i,t);if(o===void 0)return;const a=Sg(r,s,o.sheet);if(a!==void 0&&o.sheet===a.sheet)return Vg(o,a)},nf=(r,e,t)=>{const n=Np(e.col),i=iE(e.sheet,r);if(i!==void 0)return t!==e.sheet?`${i}!${n}${e.row+1}`:`${n}${e.row+1}`},NN=(r,e,t)=>{const n=nf(r,e.start,t),i=nf(r,e.end,e.start.sheet);if(!(n===void 0||i===void 0))return`${n}${Kc}${i}`};function by(r){return r.length===1?r.toUpperCase().charCodeAt(0)-65:r.split("").reduce((e,t)=>e*26+(t.toUpperCase().charCodeAt(0)-64),0)-1}function Np(r){let e="";for(;r>=0;)e=String.fromCharCode(r%26+97)+e,r=Math.floor(r/26)-1;return e.toUpperCase()}function iE(r,e){let t=e(r);if(t!==void 0)return AN.test(t)?t:(t=t.replace(/'/g,"''"),`'${t}'`)}function Mp(r){var e;const t=(e=r[3])!==null&&e!==void 0?e:r[2];return t?t.replace(/''/g,"'"):null}function Op(r,e){if(!r)return;const t=e(r);return t===void 0?null:t}function wr(r){return r&&r.length===0}function Fo(r){return r==null?[]:Object.keys(r)}function jn(r){for(var e=[],t=Object.keys(r),n=0;n<t.length;n++)e.push(r[t[n]]);return e}function MN(r,e){for(var t=[],n=Fo(r),i=0;i<n.length;i++){var s=n[i];t.push(e.call(null,r[s],s))}return t}function Xe(r,e){for(var t=[],n=0;n<r.length;n++)t.push(e.call(null,r[n],n));return t}function ci(r){for(var e=[],t=0;t<r.length;t++){var n=r[t];Array.isArray(n)?e=e.concat(ci(n)):e.push(n)}return e}function $i(r){return wr(r)?void 0:r[0]}function sE(r){var e=r&&r.length;return e?r[e-1]:void 0}function ut(r,e){if(Array.isArray(r))for(var t=0;t<r.length;t++)e.call(null,r[t],t);else if(_y(r))for(var n=Fo(r),t=0;t<n.length;t++){var i=n[t],s=r[i];e.call(null,s,i)}else throw Error("non exhaustive match")}function zs(r){return typeof r=="string"}function zi(r){return r===void 0}function va(r){return r instanceof Function}function wn(r,e){return e===void 0&&(e=1),r.slice(e,r.length)}function Tc(r,e){return e===void 0&&(e=1),r.slice(0,r.length-e)}function ps(r,e){var t=[];if(Array.isArray(r))for(var n=0;n<r.length;n++){var i=r[n];e.call(null,i)&&t.push(i)}return t}function Qa(r,e){return ps(r,function(t){return!e(t)})}function qi(r,e){for(var t=Object.keys(r),n={},i=0;i<t.length;i++){var s=t[i],o=r[s];e(o)&&(n[s]=o)}return n}function lt(r,e){return _y(r)?r.hasOwnProperty(e):!1}function ln(r,e){return iu(r,function(t){return t===e})!==void 0}function hi(r){for(var e=[],t=0;t<r.length;t++)e.push(r[t]);return e}function Zc(r){var e={};for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e}function iu(r,e){for(var t=0;t<r.length;t++){var n=r[t];if(e.call(null,n))return n}}function ON(r,e){for(var t=[],n=0;n<r.length;n++){var i=r[n];e.call(null,i)&&t.push(i)}return t}function Cn(r,e,t){for(var n=Array.isArray(r),i=n?r:jn(r),s=n?[]:Fo(r),o=t,a=0;a<i.length;a++)o=e.call(null,o,i[a],n?a:s[a]);return o}function Qc(r){return Qa(r,function(e){return e==null})}function wy(r,e){e===void 0&&(e=function(n){return n});var t=[];return Cn(r,function(n,i){var s=e(i);return ln(t,s)?n:(t.push(s),n.concat(i))},[])}function is(r){return Array.isArray(r)}function To(r){return r instanceof RegExp}function _y(r){return r instanceof Object}function Vi(r,e){for(var t=0;t<r.length;t++)if(!e(r[t],t))return!1;return!0}function Ip(r,e){return Qa(r,function(t){return ln(e,t)})}function oE(r,e){for(var t=0;t<r.length;t++)if(e(r[t]))return!0;return!1}function IN(r,e){for(var t=0;t<r.length;t++)if(r[t]===e)return t;return-1}function ms(r){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];for(var n=0;n<e.length;n++)for(var i=e[n],s=Fo(i),o=0;o<s.length;o++){var a=s[o];r[a]=i[a]}return r}function kN(r){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];for(var n=0;n<e.length;n++){var i=e[n];if(!zi(i))for(var s=Fo(i),o=0;o<s.length;o++){var a=s[o];lt(r,a)||(r[a]=i[a])}}return r}function kp(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return kN.apply(null,[{}].concat(r))}function aE(r,e){var t={};return ut(r,function(n){var i=e(n),s=t[i];s?s.push(n):t[i]=[n]}),t}function Jb(r,e){for(var t=Zc(r),n=Fo(e),i=0;i<n.length;i++){var s=n[i],o=e[s];t[s]=o}return t}function dn(){}function e1(r){return r}function PN(r){for(var e=[],t=0;t<r.length;t++){var n=r[t];e.push(n!==void 0?n:void 0)}return e}function Tg(r){console&&console.error&&console.error("Error: "+r)}function xy(r){console&&console.warn&&console.warn("Warning: "+r)}function t1(){return typeof Map=="function"}function FN(r,e){e.forEach(function(t){var n=t.prototype;Object.getOwnPropertyNames(n).forEach(function(i){if(i!=="constructor"){var s=Object.getOwnPropertyDescriptor(n,i);s&&(s.get||s.set)?Object.defineProperty(r.prototype,i,s):r.prototype[i]=t.prototype[i]}})})}function lE(r){function e(){}e.prototype=r;var t=new e;function n(){return typeof t.bar}return n(),n(),r}function sf(r){return r[r.length-1]}function uE(r){var e=new Date().getTime(),t=r(),n=new Date().getTime(),i=n-e;return{time:i,value:t}}var Wt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function cE(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var dd={exports:{}},LN=dd.exports,r1;function DN(){return r1||(r1=1,(function(r){(function(e,t){r.exports?r.exports=t():e.regexpToAst=t()})(typeof self<"u"?self:LN,function(){function e(){}e.prototype.saveState=function(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}},e.prototype.restoreState=function(p){this.idx=p.idx,this.input=p.input,this.groupIdx=p.groupIdx},e.prototype.pattern=function(p){this.idx=0,this.input=p,this.groupIdx=0,this.consumeChar("/");var g=this.disjunction();this.consumeChar("/");for(var v={type:"Flags",global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};this.isRegExpFlag();)switch(this.popChar()){case"g":a(v,"global");break;case"i":a(v,"ignoreCase");break;case"m":a(v,"multiLine");break;case"u":a(v,"unicode");break;case"y":a(v,"sticky");break}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:v,value:g}},e.prototype.disjunction=function(){var p=[];for(p.push(this.alternative());this.peekChar()==="|";)this.consumeChar("|"),p.push(this.alternative());return{type:"Disjunction",value:p}},e.prototype.alternative=function(){for(var p=[];this.isTerm();)p.push(this.term());return{type:"Alternative",value:p}},e.prototype.term=function(){return this.isAssertion()?this.assertion():this.atom()},e.prototype.assertion=function(){switch(this.popChar()){case"^":return{type:"StartAnchor"};case"$":return{type:"EndAnchor"};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary"};case"B":return{type:"NonWordBoundary"}}throw Error("Invalid Assertion Escape");case"(":this.consumeChar("?");var p;switch(this.popChar()){case"=":p="Lookahead";break;case"!":p="NegativeLookahead";break}l(p);var g=this.disjunction();return this.consumeChar(")"),{type:p,value:g}}u()},e.prototype.quantifier=function(p){var g;switch(this.popChar()){case"*":g={atLeast:0,atMost:1/0};break;case"+":g={atLeast:1,atMost:1/0};break;case"?":g={atLeast:0,atMost:1};break;case"{":var v=this.integerIncludingZero();switch(this.popChar()){case"}":g={atLeast:v,atMost:v};break;case",":var y;this.isDigit()?(y=this.integerIncludingZero(),g={atLeast:v,atMost:y}):g={atLeast:v,atMost:1/0},this.consumeChar("}");break}if(p===!0&&g===void 0)return;l(g);break}if(!(p===!0&&g===void 0))return l(g),this.peekChar(0)==="?"?(this.consumeChar("?"),g.greedy=!1):g.greedy=!0,g.type="Quantifier",g},e.prototype.atom=function(){var p;switch(this.peekChar()){case".":p=this.dotAll();break;case"\\":p=this.atomEscape();break;case"[":p=this.characterClass();break;case"(":p=this.group();break}return p===void 0&&this.isPatternCharacter()&&(p=this.patternCharacter()),l(p),this.isQuantifier()&&(p.quantifier=this.quantifier()),p},e.prototype.dotAll=function(){return this.consumeChar("."),{type:"Set",complement:!0,value:[s(`
`),s("\r"),s("\u2028"),s("\u2029")]}},e.prototype.atomEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.decimalEscapeAtom=function(){var p=this.positiveInteger();return{type:"GroupBackReference",value:p}},e.prototype.characterClassEscape=function(){var p,g=!1;switch(this.popChar()){case"d":p=d;break;case"D":p=d,g=!0;break;case"s":p=f;break;case"S":p=f,g=!0;break;case"w":p=h;break;case"W":p=h,g=!0;break}return l(p),{type:"Set",value:p,complement:g}},e.prototype.controlEscapeAtom=function(){var p;switch(this.popChar()){case"f":p=s("\f");break;case"n":p=s(`
`);break;case"r":p=s("\r");break;case"t":p=s("	");break;case"v":p=s("\v");break}return l(p),{type:"Character",value:p}},e.prototype.controlLetterEscapeAtom=function(){this.consumeChar("c");var p=this.popChar();if(/[a-zA-Z]/.test(p)===!1)throw Error("Invalid ");var g=p.toUpperCase().charCodeAt(0)-64;return{type:"Character",value:g}},e.prototype.nulCharacterAtom=function(){return this.consumeChar("0"),{type:"Character",value:s("\0")}},e.prototype.hexEscapeSequenceAtom=function(){return this.consumeChar("x"),this.parseHexDigits(2)},e.prototype.regExpUnicodeEscapeSequenceAtom=function(){return this.consumeChar("u"),this.parseHexDigits(4)},e.prototype.identityEscapeAtom=function(){var p=this.popChar();return{type:"Character",value:s(p)}},e.prototype.classPatternCharacterAtom=function(){switch(this.peekChar()){case`
`:case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:var p=this.popChar();return{type:"Character",value:s(p)}}},e.prototype.characterClass=function(){var p=[],g=!1;for(this.consumeChar("["),this.peekChar(0)==="^"&&(this.consumeChar("^"),g=!0);this.isClassAtom();){var v=this.classAtom(),y=v.type==="Character";if(y&&this.isRangeDash()){this.consumeChar("-");var b=this.classAtom(),E=b.type==="Character";if(E){if(b.value<v.value)throw Error("Range out of order in character class");p.push({from:v.value,to:b.value})}else o(v.value,p),p.push(s("-")),o(b.value,p)}else o(v.value,p)}return this.consumeChar("]"),{type:"Set",complement:g,value:p}},e.prototype.classAtom=function(){switch(this.peekChar()){case"]":case`
`:case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}},e.prototype.classEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:s("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.group=function(){var p=!0;this.consumeChar("("),this.peekChar(0)==="?"?(this.consumeChar("?"),this.consumeChar(":"),p=!1):this.groupIdx++;var g=this.disjunction();this.consumeChar(")");var v={type:"Group",capturing:p,value:g};return p&&(v.idx=this.groupIdx),v},e.prototype.positiveInteger=function(){var p=this.popChar();if(i.test(p)===!1)throw Error("Expecting a positive integer");for(;n.test(this.peekChar(0));)p+=this.popChar();return parseInt(p,10)},e.prototype.integerIncludingZero=function(){var p=this.popChar();if(n.test(p)===!1)throw Error("Expecting an integer");for(;n.test(this.peekChar(0));)p+=this.popChar();return parseInt(p,10)},e.prototype.patternCharacter=function(){var p=this.popChar();switch(p){case`
`:case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:s(p)}}},e.prototype.isRegExpFlag=function(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}},e.prototype.isRangeDash=function(){return this.peekChar()==="-"&&this.isClassAtom(1)},e.prototype.isDigit=function(){return n.test(this.peekChar(0))},e.prototype.isClassAtom=function(p){switch(p===void 0&&(p=0),this.peekChar(p)){case"]":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.isTerm=function(){return this.isAtom()||this.isAssertion()},e.prototype.isAtom=function(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}},e.prototype.isAssertion=function(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return this.peekChar(1)==="?"&&(this.peekChar(2)==="="||this.peekChar(2)==="!");default:return!1}},e.prototype.isQuantifier=function(){var p=this.saveState();try{return this.quantifier(!0)!==void 0}catch{return!1}finally{this.restoreState(p)}},e.prototype.isPatternCharacter=function(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.parseHexDigits=function(p){for(var g="",v=0;v<p;v++){var y=this.popChar();if(t.test(y)===!1)throw Error("Expecting a HexDecimal digits");g+=y}var b=parseInt(g,16);return{type:"Character",value:b}},e.prototype.peekChar=function(p){return p===void 0&&(p=0),this.input[this.idx+p]},e.prototype.popChar=function(){var p=this.peekChar(0);return this.consumeChar(),p},e.prototype.consumeChar=function(p){if(p!==void 0&&this.input[this.idx]!==p)throw Error("Expected: '"+p+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++};var t=/[0-9a-fA-F]/,n=/[0-9]/,i=/[1-9]/;function s(p){return p.charCodeAt(0)}function o(p,g){p.length!==void 0?p.forEach(function(v){g.push(v)}):g.push(p)}function a(p,g){if(p[g]===!0)throw"duplicate flag "+g;p[g]=!0}function l(p){if(p===void 0)throw Error("Internal Error - Should never get here!")}function u(){throw Error("Internal Error - Should never get here!")}var c,d=[];for(c=s("0");c<=s("9");c++)d.push(c);var h=[s("_")].concat(d);for(c=s("a");c<=s("z");c++)h.push(c);for(c=s("A");c<=s("Z");c++)h.push(c);var f=[s(" "),s("\f"),s(`
`),s("\r"),s("	"),s("\v"),s("	"),s(""),s(""),s(""),s(""),s(""),s(""),s(""),s(""),s(""),s(""),s(""),s(""),s(""),s("\u2028"),s("\u2029"),s(""),s(""),s(""),s("\uFEFF")];function m(){}return m.prototype.visitChildren=function(p){for(var g in p){var v=p[g];p.hasOwnProperty(g)&&(v.type!==void 0?this.visit(v):Array.isArray(v)&&v.forEach(function(y){this.visit(y)},this))}},m.prototype.visit=function(p){switch(p.type){case"Pattern":this.visitPattern(p);break;case"Flags":this.visitFlags(p);break;case"Disjunction":this.visitDisjunction(p);break;case"Alternative":this.visitAlternative(p);break;case"StartAnchor":this.visitStartAnchor(p);break;case"EndAnchor":this.visitEndAnchor(p);break;case"WordBoundary":this.visitWordBoundary(p);break;case"NonWordBoundary":this.visitNonWordBoundary(p);break;case"Lookahead":this.visitLookahead(p);break;case"NegativeLookahead":this.visitNegativeLookahead(p);break;case"Character":this.visitCharacter(p);break;case"Set":this.visitSet(p);break;case"Group":this.visitGroup(p);break;case"GroupBackReference":this.visitGroupBackReference(p);break;case"Quantifier":this.visitQuantifier(p);break}this.visitChildren(p)},m.prototype.visitPattern=function(p){},m.prototype.visitFlags=function(p){},m.prototype.visitDisjunction=function(p){},m.prototype.visitAlternative=function(p){},m.prototype.visitStartAnchor=function(p){},m.prototype.visitEndAnchor=function(p){},m.prototype.visitWordBoundary=function(p){},m.prototype.visitNonWordBoundary=function(p){},m.prototype.visitLookahead=function(p){},m.prototype.visitNegativeLookahead=function(p){},m.prototype.visitCharacter=function(p){},m.prototype.visitSet=function(p){},m.prototype.visitGroup=function(p){},m.prototype.visitGroupBackReference=function(p){},m.prototype.visitQuantifier=function(p){},{RegExpParser:e,BaseRegExpVisitor:m,VERSION:"0.4.0"}})})(dd)),dd.exports}var Jc=DN(),fd={},BN=new Jc.RegExpParser;function Pp(r){var e=r.toString();if(fd.hasOwnProperty(e))return fd[e];var t=BN.pattern(e);return fd[e]=t,t}function UN(){fd={}}var VN=(function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}})(),hE="Complement Sets are not supported for first char optimization",of=`Unable to use "first char" lexer optimizations:
`;function jN(r,e){e===void 0&&(e=!1);try{var t=Pp(r),n=Rg(t.value,{},t.flags.ignoreCase);return n}catch(s){if(s.message===hE)e&&xy(""+of+("	Unable to optimize: < "+r.toString()+` >
`)+`	Complement Sets cannot be automatically optimized.
	This will disable the lexer's first char optimizations.
	See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.`);else{var i="";e&&(i=`
	This will disable the lexer's first char optimizations.
	See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details.`),Tg(of+`
`+("	Failed parsing: < "+r.toString()+` >
`)+("	Using the regexp-to-ast library version: "+Jc.VERSION+`
`)+"	Please open an issue at: https://github.com/bd82/regexp-to-ast/issues"+i)}}return[]}function Rg(r,e,t){switch(r.type){case"Disjunction":for(var n=0;n<r.value.length;n++)Rg(r.value[n],e,t);break;case"Alternative":for(var i=r.value,n=0;n<i.length;n++){var s=i[n];switch(s.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}var o=s;switch(o.type){case"Character":Th(o.value,e,t);break;case"Set":if(o.complement===!0)throw Error(hE);ut(o.value,function(u){if(typeof u=="number")Th(u,e,t);else{var c=u;if(t===!0)for(var d=c.from;d<=c.to;d++)Th(d,e,t);else{for(var d=c.from;d<=c.to&&d<Du;d++)Th(d,e,t);if(c.to>=Du)for(var h=c.from>=Du?c.from:Du,f=c.to,m=da(h),p=da(f),g=m;g<=p;g++)e[g]=g}}});break;case"Group":Rg(o.value,e,t);break;default:throw Error("Non Exhaustive Match")}var a=o.quantifier!==void 0&&o.quantifier.atLeast===0;if(o.type==="Group"&&Ag(o)===!1||o.type!=="Group"&&a===!1)break}break;default:throw Error("non exhaustive match!")}return jn(e)}function Th(r,e,t){var n=da(r);e[n]=n,t===!0&&$N(r,e)}function $N(r,e){var t=String.fromCharCode(r),n=t.toUpperCase();if(n!==t){var i=da(n.charCodeAt(0));e[i]=i}else{var s=t.toLowerCase();if(s!==t){var i=da(s.charCodeAt(0));e[i]=i}}}function n1(r,e){return iu(r.value,function(t){if(typeof t=="number")return ln(e,t);var n=t;return iu(e,function(i){return n.from<=i&&i<=n.to})!==void 0})}function Ag(r){return r.quantifier&&r.quantifier.atLeast===0?!0:r.value?is(r.value)?Vi(r.value,Ag):Ag(r.value):!1}var zN=(function(r){VN(e,r);function e(t){var n=r.call(this)||this;return n.targetCharCodes=t,n.found=!1,n}return e.prototype.visitChildren=function(t){if(this.found!==!0){switch(t.type){case"Lookahead":this.visitLookahead(t);return;case"NegativeLookahead":this.visitNegativeLookahead(t);return}r.prototype.visitChildren.call(this,t)}},e.prototype.visitCharacter=function(t){ln(this.targetCharCodes,t.value)&&(this.found=!0)},e.prototype.visitSet=function(t){t.complement?n1(t,this.targetCharCodes)===void 0&&(this.found=!0):n1(t,this.targetCharCodes)!==void 0&&(this.found=!0)},e})(Jc.BaseRegExpVisitor);function Ey(r,e){if(e instanceof RegExp){var t=Pp(e),n=new zN(r);return n.visit(t),n.found}else return iu(e,function(i){return ln(r,i.charCodeAt(0))})!==void 0}var dE=(function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}})(),Hs="PATTERN",Ua="defaultMode",Rh="modes",fE=typeof new RegExp("(?:)").sticky=="boolean";function HN(r,e){e=kp(e,{useSticky:fE,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r",`
`],tracer:function(y,b){return b()}});var t=e.tracer;t("initCharCodeToOptimizedIndexMap",function(){f5()});var n;t("Reject Lexer.NA",function(){n=Qa(r,function(y){return y[Hs]===li.NA})});var i=!1,s;t("Transform Patterns",function(){i=!1,s=Xe(n,function(y){var b=y[Hs];if(To(b)){var E=b.source;return E.length===1&&E!=="^"&&E!=="$"&&E!=="."?E:E.length===2&&E[0]==="\\"&&!ln(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],E[1])?E[1]:e.useSticky?s1(b):i1(b)}else{if(va(b))return i=!0,{exec:b};if(lt(b,"exec"))return i=!0,b;if(typeof b=="string"){if(b.length===1)return b;var A=b.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),M=new RegExp(A);return e.useSticky?s1(M):i1(M)}else throw Error("non exhaustive match")}})});var o,a,l,u,c;t("misc mapping",function(){o=Xe(n,function(y){return y.tokenTypeIdx}),a=Xe(n,function(y){var b=y.GROUP;if(b!==li.SKIPPED){if(zs(b))return b;if(zi(b))return!1;throw Error("non exhaustive match")}}),l=Xe(n,function(y){var b=y.LONGER_ALT;if(b){var E=IN(n,b);return E}}),u=Xe(n,function(y){return y.PUSH_MODE}),c=Xe(n,function(y){return lt(y,"POP_MODE")})});var d;t("Line Terminator Handling",function(){var y=gE(e.lineTerminatorCharacters);d=Xe(n,function(b){return!1}),e.positionTracking!=="onlyOffset"&&(d=Xe(n,function(b){if(lt(b,"LINE_BREAKS"))return b.LINE_BREAKS;if(mE(b,y)===!1)return Ey(y,b.PATTERN)}))});var h,f,m,p;t("Misc Mapping #2",function(){h=Xe(n,pE),f=Xe(s,c5),m=Cn(n,function(y,b){var E=b.GROUP;return zs(E)&&E!==li.SKIPPED&&(y[E]=[]),y},{}),p=Xe(s,function(y,b){return{pattern:s[b],longerAlt:l[b],canLineTerminator:d[b],isCustom:h[b],short:f[b],group:a[b],push:u[b],pop:c[b],tokenTypeIdx:o[b],tokenType:n[b]}})});var g=!0,v=[];return e.safeMode||t("First Char Optimization",function(){v=Cn(n,function(y,b,E){if(typeof b.PATTERN=="string"){var A=b.PATTERN.charCodeAt(0),M=da(A);Rm(y,M,p[E])}else if(is(b.START_CHARS_HINT)){var L;ut(b.START_CHARS_HINT,function(P){var U=typeof P=="string"?P.charCodeAt(0):P,$=da(U);L!==$&&(L=$,Rm(y,$,p[E]))})}else if(To(b.PATTERN))if(b.PATTERN.unicode)g=!1,e.ensureOptimizations&&Tg(""+of+("	Unable to analyze < "+b.PATTERN.toString()+` > pattern.
`)+`	The regexp unicode flag is not currently supported by the regexp-to-ast library.
	This will disable the lexer's first char optimizations.
	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE`);else{var k=jN(b.PATTERN,e.ensureOptimizations);wr(k)&&(g=!1),ut(k,function(P){Rm(y,P,p[E])})}else e.ensureOptimizations&&Tg(""+of+("	TokenType: <"+b.name+`> is using a custom token pattern without providing <start_chars_hint> parameter.
`)+`	This will disable the lexer's first char optimizations.
	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE`),g=!1;return y},[])}),t("ArrayPacking",function(){v=PN(v)}),{emptyGroups:m,patternIdxToConfig:p,charCodeToPatternIdxToConfig:v,hasCustom:i,canBeOptimized:g}}function WN(r,e){var t=[],n=qN(r);t=t.concat(n.errors);var i=YN(n.valid),s=i.valid;return t=t.concat(i.errors),t=t.concat(GN(s)),t=t.concat(r5(s)),t=t.concat(n5(s,e)),t=t.concat(i5(s)),t}function GN(r){var e=[],t=ps(r,function(n){return To(n[Hs])});return e=e.concat(KN(t)),e=e.concat(JN(t)),e=e.concat(e5(t)),e=e.concat(t5(t)),e=e.concat(ZN(t)),e}function qN(r){var e=ps(r,function(i){return!lt(i,Hs)}),t=Xe(e,function(i){return{message:"Token Type: ->"+i.name+"<- missing static 'PATTERN' property",type:Xr.MISSING_PATTERN,tokenTypes:[i]}}),n=Ip(r,e);return{errors:t,valid:n}}function YN(r){var e=ps(r,function(i){var s=i[Hs];return!To(s)&&!va(s)&&!lt(s,"exec")&&!zs(s)}),t=Xe(e,function(i){return{message:"Token Type: ->"+i.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:Xr.INVALID_PATTERN,tokenTypes:[i]}}),n=Ip(r,e);return{errors:t,valid:n}}var XN=/[^\\][\$]/;function KN(r){var e=(function(i){dE(s,i);function s(){var o=i!==null&&i.apply(this,arguments)||this;return o.found=!1,o}return s.prototype.visitEndAnchor=function(o){this.found=!0},s})(Jc.BaseRegExpVisitor),t=ps(r,function(i){var s=i[Hs];try{var o=Pp(s),a=new e;return a.visit(o),a.found}catch{return XN.test(s.source)}}),n=Xe(t,function(i){return{message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+i.name+`<- static 'PATTERN' cannot contain end of input anchor '$'
	See sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:Xr.EOI_ANCHOR_FOUND,tokenTypes:[i]}});return n}function ZN(r){var e=ps(r,function(n){var i=n[Hs];return i.test("")}),t=Xe(e,function(n){return{message:"Token Type: ->"+n.name+"<- static 'PATTERN' must not match an empty string",type:Xr.EMPTY_MATCH_PATTERN,tokenTypes:[n]}});return t}var QN=/[^\\[][\^]|^\^/;function JN(r){var e=(function(i){dE(s,i);function s(){var o=i!==null&&i.apply(this,arguments)||this;return o.found=!1,o}return s.prototype.visitStartAnchor=function(o){this.found=!0},s})(Jc.BaseRegExpVisitor),t=ps(r,function(i){var s=i[Hs];try{var o=Pp(s),a=new e;return a.visit(o),a.found}catch{return QN.test(s.source)}}),n=Xe(t,function(i){return{message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+i.name+`<- static 'PATTERN' cannot contain start of input anchor '^'
	See https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:Xr.SOI_ANCHOR_FOUND,tokenTypes:[i]}});return n}function e5(r){var e=ps(r,function(n){var i=n[Hs];return i instanceof RegExp&&(i.multiline||i.global)}),t=Xe(e,function(n){return{message:"Token Type: ->"+n.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:Xr.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[n]}});return t}function t5(r){var e=[],t=Xe(r,function(s){return Cn(r,function(o,a){return s.PATTERN.source===a.PATTERN.source&&!ln(e,a)&&a.PATTERN!==li.NA&&(e.push(a),o.push(a)),o},[])});t=Qc(t);var n=ps(t,function(s){return s.length>1}),i=Xe(n,function(s){var o=Xe(s,function(l){return l.name}),a=$i(s).PATTERN;return{message:"The same RegExp pattern ->"+a+"<-"+("has been used in all of the following Token Types: "+o.join(", ")+" <-"),type:Xr.DUPLICATE_PATTERNS_FOUND,tokenTypes:s}});return i}function r5(r){var e=ps(r,function(n){if(!lt(n,"GROUP"))return!1;var i=n.GROUP;return i!==li.SKIPPED&&i!==li.NA&&!zs(i)}),t=Xe(e,function(n){return{message:"Token Type: ->"+n.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:Xr.INVALID_GROUP_TYPE_FOUND,tokenTypes:[n]}});return t}function n5(r,e){var t=ps(r,function(i){return i.PUSH_MODE!==void 0&&!ln(e,i.PUSH_MODE)}),n=Xe(t,function(i){var s="Token Type: ->"+i.name+"<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->"+i.PUSH_MODE+"<-which does not exist";return{message:s,type:Xr.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[i]}});return n}function i5(r){var e=[],t=Cn(r,function(n,i,s){var o=i.PATTERN;return o===li.NA||(zs(o)?n.push({str:o,idx:s,tokenType:i}):To(o)&&o5(o)&&n.push({str:o.source,idx:s,tokenType:i})),n},[]);return ut(r,function(n,i){ut(t,function(s){var o=s.str,a=s.idx,l=s.tokenType;if(i<a&&s5(o,n.PATTERN)){var u="Token: ->"+l.name+`<- can never be matched.
`+("Because it appears AFTER the Token Type ->"+n.name+"<-")+`in the lexer's definition.
See https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNREACHABLE`;e.push({message:u,type:Xr.UNREACHABLE_PATTERN,tokenTypes:[n,l]})}})}),e}function s5(r,e){if(To(e)){var t=e.exec(r);return t!==null&&t.index===0}else{if(va(e))return e(r,0,[],{});if(lt(e,"exec"))return e.exec(r,0,[],{});if(typeof e=="string")return e===r;throw Error("non exhaustive match")}}function o5(r){var e=[".","\\","[","]","|","^","$","(",")","?","*","+","{"];return iu(e,function(t){return r.source.indexOf(t)!==-1})===void 0}function i1(r){var e=r.ignoreCase?"i":"";return new RegExp("^(?:"+r.source+")",e)}function s1(r){var e=r.ignoreCase?"iy":"y";return new RegExp(""+r.source,e)}function a5(r,e,t){var n=[];return lt(r,Ua)||n.push({message:"A MultiMode Lexer cannot be initialized without a <"+Ua+`> property in its definition
`,type:Xr.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),lt(r,Rh)||n.push({message:"A MultiMode Lexer cannot be initialized without a <"+Rh+`> property in its definition
`,type:Xr.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),lt(r,Rh)&&lt(r,Ua)&&!lt(r.modes,r.defaultMode)&&n.push({message:"A MultiMode Lexer cannot be initialized with a "+Ua+": <"+r.defaultMode+`>which does not exist
`,type:Xr.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),lt(r,Rh)&&ut(r.modes,function(i,s){ut(i,function(o,a){zi(o)&&n.push({message:"A Lexer cannot be initialized using an undefined Token Type. Mode:"+("<"+s+"> at index: <"+a+`>
`),type:Xr.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED})})}),n}function l5(r,e,t){var n=[],i=!1,s=Qc(ci(MN(r.modes,function(l){return l}))),o=Qa(s,function(l){return l[Hs]===li.NA}),a=gE(t);return e&&ut(o,function(l){var u=mE(l,a);if(u!==!1){var c=d5(l,u),d={message:c,type:u.issue,tokenType:l};n.push(d)}else lt(l,"LINE_BREAKS")?l.LINE_BREAKS===!0&&(i=!0):Ey(a,l.PATTERN)&&(i=!0)}),e&&!i&&n.push({message:`Warning: No LINE_BREAKS Found.
	This Lexer has been defined to track line and column information,
	But none of the Token Types can be identified as matching a line terminator.
	See https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#LINE_BREAKS 
	for details.`,type:Xr.NO_LINE_BREAKS_FLAGS}),n}function u5(r){var e={},t=Fo(r);return ut(t,function(n){var i=r[n];if(is(i))e[n]=[];else throw Error("non exhaustive match")}),e}function pE(r){var e=r.PATTERN;if(To(e))return!1;if(va(e))return!0;if(lt(e,"exec"))return!0;if(zs(e))return!1;throw Error("non exhaustive match")}function c5(r){return zs(r)&&r.length===1?r.charCodeAt(0):!1}var h5={test:function(r){for(var e=r.length,t=this.lastIndex;t<e;t++){var n=r.charCodeAt(t);if(n===10)return this.lastIndex=t+1,!0;if(n===13)return r.charCodeAt(t+1)===10?this.lastIndex=t+2:this.lastIndex=t+1,!0}return!1},lastIndex:0};function mE(r,e){if(lt(r,"LINE_BREAKS"))return!1;if(To(r.PATTERN)){try{Ey(e,r.PATTERN)}catch(t){return{issue:Xr.IDENTIFY_TERMINATOR,errMsg:t.message}}return!1}else{if(zs(r.PATTERN))return!1;if(pE(r))return{issue:Xr.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}}function d5(r,e){if(e.issue===Xr.IDENTIFY_TERMINATOR)return`Warning: unable to identify line terminator usage in pattern.
`+("	The problem is in the <"+r.name+`> Token Type
`)+("	 Root cause: "+e.errMsg+`.
`)+"	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR";if(e.issue===Xr.CUSTOM_LINE_BREAK)return`Warning: A Custom Token Pattern should specify the <line_breaks> option.
`+("	The problem is in the <"+r.name+`> Token Type
`)+"	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK";throw Error("non exhaustive match")}function gE(r){var e=Xe(r,function(t){return zs(t)&&t.length>0?t.charCodeAt(0):t});return e}function Rm(r,e,t){r[e]===void 0?r[e]=[t]:r[e].push(t)}var Du=256;function da(r){return r<Du?r:pd[r]}var pd=[];function f5(){if(wr(pd)){pd=new Array(65536);for(var r=0;r<65536;r++)pd[r]=r>255?255+~~(r/255):r}}function Fp(r,e){var t=r.tokenTypeIdx;return t===e.tokenTypeIdx?!0:e.isParent===!0&&e.categoryMatchesMap[t]===!0}function af(r,e){return r.tokenTypeIdx===e.tokenTypeIdx}var o1=1,yE={};function eh(r){var e=p5(r);m5(e),y5(e),g5(e),ut(e,function(t){t.isParent=t.categoryMatches.length>0})}function p5(r){for(var e=hi(r),t=r,n=!0;n;){t=Qc(ci(Xe(t,function(s){return s.CATEGORIES})));var i=Ip(t,e);e=e.concat(i),wr(i)?n=!1:t=i}return e}function m5(r){ut(r,function(e){bE(e)||(yE[o1]=e,e.tokenTypeIdx=o1++),a1(e)&&!is(e.CATEGORIES)&&(e.CATEGORIES=[e.CATEGORIES]),a1(e)||(e.CATEGORIES=[]),v5(e)||(e.categoryMatches=[]),b5(e)||(e.categoryMatchesMap={})})}function g5(r){ut(r,function(e){e.categoryMatches=[],ut(e.categoryMatchesMap,function(t,n){e.categoryMatches.push(yE[n].tokenTypeIdx)})})}function y5(r){ut(r,function(e){vE([],e)})}function vE(r,e){ut(r,function(t){e.categoryMatchesMap[t.tokenTypeIdx]=!0}),ut(e.CATEGORIES,function(t){var n=r.concat(e);ln(n,t)||vE(n,t)})}function bE(r){return lt(r,"tokenTypeIdx")}function a1(r){return lt(r,"CATEGORIES")}function v5(r){return lt(r,"categoryMatches")}function b5(r){return lt(r,"categoryMatchesMap")}function w5(r){return lt(r,"tokenTypeIdx")}var _5={buildUnableToPopLexerModeMessage:function(r){return"Unable to pop Lexer Mode after encountering Token ->"+r.image+"<- The Mode Stack is empty"},buildUnexpectedCharactersMessage:function(r,e,t,n,i){return"unexpected character: ->"+r.charAt(e)+"<- at offset: "+e+","+(" skipped "+t+" characters.")}},Xr;(function(r){r[r.MISSING_PATTERN=0]="MISSING_PATTERN",r[r.INVALID_PATTERN=1]="INVALID_PATTERN",r[r.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",r[r.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",r[r.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",r[r.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",r[r.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",r[r.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",r[r.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",r[r.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",r[r.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",r[r.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",r[r.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",r[r.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",r[r.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",r[r.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",r[r.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK"})(Xr||(Xr={}));var Bu={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:[`
`,"\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:_5,traceInitPerf:!1,skipValidations:!1};Object.freeze(Bu);var li=(function(){function r(e,t){var n=this;if(t===void 0&&(t=Bu),this.lexerDefinition=e,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.config=void 0,this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},typeof t=="boolean")throw Error(`The second argument to the Lexer constructor is now an ILexerConfig Object.
a boolean 2nd argument is no longer supported`);this.config=Jb(Bu,t);var i=this.config.traceInitPerf;i===!0?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):typeof i=="number"&&(this.traceInitMaxIdent=i,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",function(){var s,o=!0;n.TRACE_INIT("Lexer Config handling",function(){if(n.config.lineTerminatorsPattern===Bu.lineTerminatorsPattern)n.config.lineTerminatorsPattern=h5;else if(n.config.lineTerminatorCharacters===Bu.lineTerminatorCharacters)throw Error(`Error: Missing <lineTerminatorCharacters> property on the Lexer config.
	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS`);if(t.safeMode&&t.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');n.trackStartLines=/full|onlyStart/i.test(n.config.positionTracking),n.trackEndLines=/full/i.test(n.config.positionTracking),is(e)?(s={modes:{}},s.modes[Ua]=hi(e),s[Ua]=Ua):(o=!1,s=Zc(e))}),n.config.skipValidations===!1&&(n.TRACE_INIT("performRuntimeChecks",function(){n.lexerDefinitionErrors=n.lexerDefinitionErrors.concat(a5(s,n.trackStartLines,n.config.lineTerminatorCharacters))}),n.TRACE_INIT("performWarningRuntimeChecks",function(){n.lexerDefinitionWarning=n.lexerDefinitionWarning.concat(l5(s,n.trackStartLines,n.config.lineTerminatorCharacters))})),s.modes=s.modes?s.modes:{},ut(s.modes,function(c,d){s.modes[d]=Qa(c,function(h){return zi(h)})});var a=Fo(s.modes);if(ut(s.modes,function(c,d){n.TRACE_INIT("Mode: <"+d+"> processing",function(){if(n.modes.push(d),n.config.skipValidations===!1&&n.TRACE_INIT("validatePatterns",function(){n.lexerDefinitionErrors=n.lexerDefinitionErrors.concat(WN(c,a))}),wr(n.lexerDefinitionErrors)){eh(c);var h;n.TRACE_INIT("analyzeTokenTypes",function(){h=HN(c,{lineTerminatorCharacters:n.config.lineTerminatorCharacters,positionTracking:t.positionTracking,ensureOptimizations:t.ensureOptimizations,safeMode:t.safeMode,tracer:n.TRACE_INIT.bind(n)})}),n.patternIdxToConfig[d]=h.patternIdxToConfig,n.charCodeToPatternIdxToConfig[d]=h.charCodeToPatternIdxToConfig,n.emptyGroups=Jb(n.emptyGroups,h.emptyGroups),n.hasCustom=h.hasCustom||n.hasCustom,n.canModeBeOptimized[d]=h.canBeOptimized}})}),n.defaultMode=s.defaultMode,!wr(n.lexerDefinitionErrors)&&!n.config.deferDefinitionErrorsHandling){var l=Xe(n.lexerDefinitionErrors,function(c){return c.message}),u=l.join(`-----------------------
`);throw new Error(`Errors detected in definition of Lexer:
`+u)}ut(n.lexerDefinitionWarning,function(c){xy(c.message)}),n.TRACE_INIT("Choosing sub-methods implementations",function(){if(fE?(n.chopInput=e1,n.match=n.matchWithTest):(n.updateLastIndex=dn,n.match=n.matchWithExec),o&&(n.handleModes=dn),n.trackStartLines===!1&&(n.computeNewColumn=e1),n.trackEndLines===!1&&(n.updateTokenEndLineColumnLocation=dn),/full/i.test(n.config.positionTracking))n.createTokenInstance=n.createFullToken;else if(/onlyStart/i.test(n.config.positionTracking))n.createTokenInstance=n.createStartOnlyToken;else if(/onlyOffset/i.test(n.config.positionTracking))n.createTokenInstance=n.createOffsetOnlyToken;else throw Error('Invalid <positionTracking> config option: "'+n.config.positionTracking+'"');n.hasCustom?(n.addToken=n.addTokenUsingPush,n.handlePayload=n.handlePayloadWithCustom):(n.addToken=n.addTokenUsingMemberAccess,n.handlePayload=n.handlePayloadNoCustom)}),n.TRACE_INIT("Failed Optimization Warnings",function(){var c=Cn(n.canModeBeOptimized,function(d,h,f){return h===!1&&d.push(f),d},[]);if(t.ensureOptimizations&&!wr(c))throw Error("Lexer Modes: < "+c.join(", ")+` > cannot be optimized.
	 Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.
	 Or inspect the console log for details on how to resolve these issues.`)}),n.TRACE_INIT("clearRegExpParserCache",function(){UN()}),n.TRACE_INIT("toFastProperties",function(){lE(n)})})}return r.prototype.tokenize=function(e,t){if(t===void 0&&(t=this.defaultMode),!wr(this.lexerDefinitionErrors)){var n=Xe(this.lexerDefinitionErrors,function(o){return o.message}),i=n.join(`-----------------------
`);throw new Error(`Unable to Tokenize because Errors detected in definition of Lexer:
`+i)}var s=this.tokenizeInternal(e,t);return s},r.prototype.tokenizeInternal=function(e,t){var n=this,i,s,o,a,l,u,c,d,h,f,m,p,g,v,y=e,b=y.length,E=0,A=0,M=this.hasCustom?0:Math.floor(e.length/10),L=new Array(M),k=[],P=this.trackStartLines?1:void 0,U=this.trackStartLines?1:void 0,$=u5(this.emptyGroups),V=this.trackStartLines,R=this.config.lineTerminatorsPattern,O=0,T=[],w=[],x=[],_=[];Object.freeze(_);var S=void 0;function C(){return T}function F(le){var ae=da(le),fe=w[ae];return fe===void 0?_:fe}var D=function(le){if(x.length===1&&le.tokenType.PUSH_MODE===void 0){var ae=n.config.errorMessageProvider.buildUnableToPopLexerModeMessage(le);k.push({offset:le.startOffset,line:le.startLine!==void 0?le.startLine:void 0,column:le.startColumn!==void 0?le.startColumn:void 0,length:le.image.length,message:ae})}else{x.pop();var fe=sE(x);T=n.patternIdxToConfig[fe],w=n.charCodeToPatternIdxToConfig[fe],O=T.length;var pe=n.canModeBeOptimized[fe]&&n.config.safeMode===!1;w&&pe?S=F:S=C}};function H(le){x.push(le),w=this.charCodeToPatternIdxToConfig[le],T=this.patternIdxToConfig[le],O=T.length,O=T.length;var ae=this.canModeBeOptimized[le]&&this.config.safeMode===!1;w&&ae?S=F:S=C}H.call(this,t);for(var G;E<b;){l=null;var ee=y.charCodeAt(E),B=S(ee),X=B.length;for(i=0;i<X;i++){G=B[i];var I=G.pattern;u=null;var N=G.short;if(N!==!1?ee===N&&(l=I):G.isCustom===!0?(v=I.exec(y,E,L,$),v!==null?(l=v[0],v.payload!==void 0&&(u=v.payload)):l=null):(this.updateLastIndex(I,E),l=this.match(I,e,E)),l!==null){if(a=G.longerAlt,a!==void 0){var j=T[a],Q=j.pattern;c=null,j.isCustom===!0?(v=Q.exec(y,E,L,$),v!==null?(o=v[0],v.payload!==void 0&&(c=v.payload)):o=null):(this.updateLastIndex(Q,E),o=this.match(Q,e,E)),o&&o.length>l.length&&(l=o,u=c,G=j)}break}}if(l!==null){if(d=l.length,h=G.group,h!==void 0&&(f=G.tokenTypeIdx,m=this.createTokenInstance(l,E,f,G.tokenType,P,U,d),this.handlePayload(m,u),h===!1?A=this.addToken(L,A,m):$[h].push(m)),e=this.chopInput(e,d),E=E+d,U=this.computeNewColumn(U,d),V===!0&&G.canLineTerminator===!0){var W=0,Y=void 0,Z=void 0;R.lastIndex=0;do Y=R.test(l),Y===!0&&(Z=R.lastIndex-1,W++);while(Y===!0);W!==0&&(P=P+W,U=d-Z,this.updateTokenEndLineColumnLocation(m,h,Z,W,P,U,d))}this.handleModes(G,D,H,m)}else{for(var se=E,re=P,K=U,ie=!1;!ie&&E<b;)for(y.charCodeAt(E),e=this.chopInput(e,1),E++,s=0;s<O;s++){var ne=T[s],I=ne.pattern,N=ne.short;if(N!==!1?y.charCodeAt(E)===N&&(ie=!0):ne.isCustom===!0?ie=I.exec(y,E,L,$)!==null:(this.updateLastIndex(I,E),ie=I.exec(e)!==null),ie===!0)break}p=E-se,g=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(y,se,p,re,K),k.push({offset:se,line:re,column:K,length:p,message:g})}}return this.hasCustom||(L.length=A),{tokens:L,groups:$,errors:k}},r.prototype.handleModes=function(e,t,n,i){if(e.pop===!0){var s=e.push;t(i),s!==void 0&&n.call(this,s)}else e.push!==void 0&&n.call(this,e.push)},r.prototype.chopInput=function(e,t){return e.substring(t)},r.prototype.updateLastIndex=function(e,t){e.lastIndex=t},r.prototype.updateTokenEndLineColumnLocation=function(e,t,n,i,s,o,a){var l,u;t!==void 0&&(l=n===a-1,u=l?-1:0,i===1&&l===!0||(e.endLine=s+u,e.endColumn=o-1+-u))},r.prototype.computeNewColumn=function(e,t){return e+t},r.prototype.createTokenInstance=function(){return null},r.prototype.createOffsetOnlyToken=function(e,t,n,i){return{image:e,startOffset:t,tokenTypeIdx:n,tokenType:i}},r.prototype.createStartOnlyToken=function(e,t,n,i,s,o){return{image:e,startOffset:t,startLine:s,startColumn:o,tokenTypeIdx:n,tokenType:i}},r.prototype.createFullToken=function(e,t,n,i,s,o,a){return{image:e,startOffset:t,endOffset:t+a-1,startLine:s,endLine:s,startColumn:o,endColumn:o+a-1,tokenTypeIdx:n,tokenType:i}},r.prototype.addToken=function(e,t,n){return 666},r.prototype.addTokenUsingPush=function(e,t,n){return e.push(n),t},r.prototype.addTokenUsingMemberAccess=function(e,t,n){return e[t]=n,t++,t},r.prototype.handlePayload=function(e,t){},r.prototype.handlePayloadNoCustom=function(e,t){},r.prototype.handlePayloadWithCustom=function(e,t){t!==null&&(e.payload=t)},r.prototype.match=function(e,t,n){return null},r.prototype.matchWithTest=function(e,t,n){var i=e.test(t);return i===!0?t.substring(n,e.lastIndex):null},r.prototype.matchWithExec=function(e,t){var n=e.exec(t);return n!==null?n[0]:n},r.prototype.TRACE_INIT=function(e,t){if(this.traceInitPerf===!0){this.traceInitIndent++;var n=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(n+"--> <"+e+">");var i=uE(t),s=i.time,o=i.value,a=s>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&a(n+"<-- <"+e+"> time: "+s+"ms"),this.traceInitIndent--,o}else return t()},r.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",r.NA=/NOT_APPLICABLE/,r})();function Gl(r){return wE(r)?r.LABEL:r.name}function wE(r){return zs(r.LABEL)&&r.LABEL!==""}var x5="parent",l1="categories",u1="label",c1="group",h1="push_mode",d1="pop_mode",f1="longer_alt",p1="line_breaks",m1="start_chars_hint";function Gt(r){return E5(r)}function E5(r){var e=r.pattern,t={};if(t.name=r.name,zi(e)||(t.PATTERN=e),lt(r,x5))throw`The parent property is no longer supported.
See: https://github.com/SAP/chevrotain/issues/564#issuecomment-349062346 for details.`;return lt(r,l1)&&(t.CATEGORIES=r[l1]),eh([t]),lt(r,u1)&&(t.LABEL=r[u1]),lt(r,c1)&&(t.GROUP=r[c1]),lt(r,d1)&&(t.POP_MODE=r[d1]),lt(r,h1)&&(t.PUSH_MODE=r[h1]),lt(r,f1)&&(t.LONGER_ALT=r[f1]),lt(r,p1)&&(t.LINE_BREAKS=r[p1]),lt(r,m1)&&(t.START_CHARS_HINT=r[m1]),t}var Ja=Gt({name:"EOF",pattern:li.NA});eh([Ja]);function Sy(r,e,t,n,i,s,o,a){return{image:e,startOffset:t,endOffset:n,startLine:i,endLine:s,startColumn:o,endColumn:a,tokenTypeIdx:r.tokenTypeIdx,tokenType:r}}function gr(r,e){return Fp(r,e)}var Lo=(function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}})(),Xs=(function(){function r(e){this.definition=e}return r.prototype.accept=function(e){e.visit(this),ut(this.definition,function(t){t.accept(e)})},r})(),Ai=(function(r){Lo(e,r);function e(t){var n=r.call(this,[])||this;return n.idx=1,ms(n,qi(t,function(i){return i!==void 0})),n}return Object.defineProperty(e.prototype,"definition",{get:function(){return this.referencedRule!==void 0?this.referencedRule.definition:[]},set:function(t){},enumerable:!0,configurable:!0}),e.prototype.accept=function(t){t.visit(this)},e})(Xs),yu=(function(r){Lo(e,r);function e(t){var n=r.call(this,t.definition)||this;return n.orgText="",ms(n,qi(t,function(i){return i!==void 0})),n}return e})(Xs),di=(function(r){Lo(e,r);function e(t){var n=r.call(this,t.definition)||this;return n.ignoreAmbiguities=!1,ms(n,qi(t,function(i){return i!==void 0})),n}return e})(Xs),Sn=(function(r){Lo(e,r);function e(t){var n=r.call(this,t.definition)||this;return n.idx=1,ms(n,qi(t,function(i){return i!==void 0})),n}return e})(Xs),Hi=(function(r){Lo(e,r);function e(t){var n=r.call(this,t.definition)||this;return n.idx=1,ms(n,qi(t,function(i){return i!==void 0})),n}return e})(Xs),Wi=(function(r){Lo(e,r);function e(t){var n=r.call(this,t.definition)||this;return n.idx=1,ms(n,qi(t,function(i){return i!==void 0})),n}return e})(Xs),Yr=(function(r){Lo(e,r);function e(t){var n=r.call(this,t.definition)||this;return n.idx=1,ms(n,qi(t,function(i){return i!==void 0})),n}return e})(Xs),Ci=(function(r){Lo(e,r);function e(t){var n=r.call(this,t.definition)||this;return n.idx=1,ms(n,qi(t,function(i){return i!==void 0})),n}return e})(Xs),Ni=(function(r){Lo(e,r);function e(t){var n=r.call(this,t.definition)||this;return n.idx=1,n.ignoreAmbiguities=!1,n.hasPredicates=!1,ms(n,qi(t,function(i){return i!==void 0})),n}return e})(Xs),Pr=(function(){function r(e){this.idx=1,ms(this,qi(e,function(t){return t!==void 0}))}return r.prototype.accept=function(e){e.visit(this)},r})();function S5(r){return Xe(r,md)}function md(r){function e(i){return Xe(i,md)}if(r instanceof Ai)return{type:"NonTerminal",name:r.nonTerminalName,idx:r.idx};if(r instanceof di)return{type:"Flat",definition:e(r.definition)};if(r instanceof Sn)return{type:"Option",idx:r.idx,definition:e(r.definition)};if(r instanceof Hi)return{type:"RepetitionMandatory",name:r.name,idx:r.idx,definition:e(r.definition)};if(r instanceof Wi)return{type:"RepetitionMandatoryWithSeparator",name:r.name,idx:r.idx,separator:md(new Pr({terminalType:r.separator})),definition:e(r.definition)};if(r instanceof Ci)return{type:"RepetitionWithSeparator",name:r.name,idx:r.idx,separator:md(new Pr({terminalType:r.separator})),definition:e(r.definition)};if(r instanceof Yr)return{type:"Repetition",name:r.name,idx:r.idx,definition:e(r.definition)};if(r instanceof Ni)return{type:"Alternation",name:r.name,idx:r.idx,definition:e(r.definition)};if(r instanceof Pr){var t={type:"Terminal",name:r.terminalType.name,label:Gl(r.terminalType),idx:r.idx},n=r.terminalType.PATTERN;return r.terminalType.PATTERN&&(t.pattern=To(n)?n.source:n),t}else{if(r instanceof yu)return{type:"Rule",name:r.name,orgText:r.orgText,definition:e(r.definition)};throw Error("non exhaustive match")}}var Lp=(function(){function r(){}return r.prototype.walk=function(e,t){var n=this;t===void 0&&(t=[]),ut(e.definition,function(i,s){var o=wn(e.definition,s+1);if(i instanceof Ai)n.walkProdRef(i,o,t);else if(i instanceof Pr)n.walkTerminal(i,o,t);else if(i instanceof di)n.walkFlat(i,o,t);else if(i instanceof Sn)n.walkOption(i,o,t);else if(i instanceof Hi)n.walkAtLeastOne(i,o,t);else if(i instanceof Wi)n.walkAtLeastOneSep(i,o,t);else if(i instanceof Ci)n.walkManySep(i,o,t);else if(i instanceof Yr)n.walkMany(i,o,t);else if(i instanceof Ni)n.walkOr(i,o,t);else throw Error("non exhaustive match")})},r.prototype.walkTerminal=function(e,t,n){},r.prototype.walkProdRef=function(e,t,n){},r.prototype.walkFlat=function(e,t,n){var i=t.concat(n);this.walk(e,i)},r.prototype.walkOption=function(e,t,n){var i=t.concat(n);this.walk(e,i)},r.prototype.walkAtLeastOne=function(e,t,n){var i=[new Sn({definition:e.definition})].concat(t,n);this.walk(e,i)},r.prototype.walkAtLeastOneSep=function(e,t,n){var i=g1(e,t,n);this.walk(e,i)},r.prototype.walkMany=function(e,t,n){var i=[new Sn({definition:e.definition})].concat(t,n);this.walk(e,i)},r.prototype.walkManySep=function(e,t,n){var i=g1(e,t,n);this.walk(e,i)},r.prototype.walkOr=function(e,t,n){var i=this,s=t.concat(n);ut(e.definition,function(o){var a=new di({definition:[o]});i.walk(a,s)})},r})();function g1(r,e,t){var n=[new Sn({definition:[new Pr({terminalType:r.separator})].concat(r.definition)})],i=n.concat(e,t);return i}var ol=(function(){function r(){}return r.prototype.visit=function(e){var t=e;switch(t.constructor){case Ai:return this.visitNonTerminal(t);case di:return this.visitFlat(t);case Sn:return this.visitOption(t);case Hi:return this.visitRepetitionMandatory(t);case Wi:return this.visitRepetitionMandatoryWithSeparator(t);case Ci:return this.visitRepetitionWithSeparator(t);case Yr:return this.visitRepetition(t);case Ni:return this.visitAlternation(t);case Pr:return this.visitTerminal(t);case yu:return this.visitRule(t);default:throw Error("non exhaustive match")}},r.prototype.visitNonTerminal=function(e){},r.prototype.visitFlat=function(e){},r.prototype.visitOption=function(e){},r.prototype.visitRepetition=function(e){},r.prototype.visitRepetitionMandatory=function(e){},r.prototype.visitRepetitionMandatoryWithSeparator=function(e){},r.prototype.visitRepetitionWithSeparator=function(e){},r.prototype.visitAlternation=function(e){},r.prototype.visitTerminal=function(e){},r.prototype.visitRule=function(e){},r})(),T5=(function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}})();function R5(r){return r instanceof di||r instanceof Sn||r instanceof Yr||r instanceof Hi||r instanceof Wi||r instanceof Ci||r instanceof Pr||r instanceof yu}function lf(r,e){e===void 0&&(e=[]);var t=r instanceof Sn||r instanceof Yr||r instanceof Ci;return t?!0:r instanceof Ni?oE(r.definition,function(n){return lf(n,e)}):r instanceof Ai&&ln(e,r)?!1:r instanceof Xs?(r instanceof Ai&&e.push(r),Vi(r.definition,function(n){return lf(n,e)})):!1}function A5(r){return r instanceof Ni}function Qi(r){if(r instanceof Ai)return"SUBRULE";if(r instanceof Sn)return"OPTION";if(r instanceof Ni)return"OR";if(r instanceof Hi)return"AT_LEAST_ONE";if(r instanceof Wi)return"AT_LEAST_ONE_SEP";if(r instanceof Ci)return"MANY_SEP";if(r instanceof Yr)return"MANY";if(r instanceof Pr)return"CONSUME";throw Error("non exhaustive match")}var C5=(function(r){T5(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.separator="-",t.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]},t}return e.prototype.reset=function(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}},e.prototype.visitTerminal=function(t){var n=t.terminalType.name+this.separator+"Terminal";lt(this.dslMethods,n)||(this.dslMethods[n]=[]),this.dslMethods[n].push(t)},e.prototype.visitNonTerminal=function(t){var n=t.nonTerminalName+this.separator+"Terminal";lt(this.dslMethods,n)||(this.dslMethods[n]=[]),this.dslMethods[n].push(t)},e.prototype.visitOption=function(t){this.dslMethods.option.push(t)},e.prototype.visitRepetitionWithSeparator=function(t){this.dslMethods.repetitionWithSeparator.push(t)},e.prototype.visitRepetitionMandatory=function(t){this.dslMethods.repetitionMandatory.push(t)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.dslMethods.repetitionMandatoryWithSeparator.push(t)},e.prototype.visitRepetition=function(t){this.dslMethods.repetition.push(t)},e.prototype.visitAlternation=function(t){this.dslMethods.alternation.push(t)},e})(ol),Ah=new C5;function N5(r){Ah.reset(),r.accept(Ah);var e=Ah.dslMethods;return Ah.reset(),e}function th(r){if(r instanceof Ai)return th(r.referencedRule);if(r instanceof Pr)return I5(r);if(R5(r))return M5(r);if(A5(r))return O5(r);throw Error("non exhaustive match")}function M5(r){for(var e=[],t=r.definition,n=0,i=t.length>n,s,o=!0;i&&o;)s=t[n],o=lf(s),e=e.concat(th(s)),n=n+1,i=t.length>n;return wy(e)}function O5(r){var e=Xe(r.definition,function(t){return th(t)});return wy(ci(e))}function I5(r){return[r.terminalType]}var _E="_~IN~_",k5=(function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}})(),P5=(function(r){k5(e,r);function e(t){var n=r.call(this)||this;return n.topProd=t,n.follows={},n}return e.prototype.startWalking=function(){return this.walk(this.topProd),this.follows},e.prototype.walkTerminal=function(t,n,i){},e.prototype.walkProdRef=function(t,n,i){var s=L5(t.referencedRule,t.idx)+this.topProd.name,o=n.concat(i),a=new di({definition:o}),l=th(a);this.follows[s]=l},e})(Lp);function F5(r){var e={};return ut(r,function(t){var n=new P5(t).startWalking();ms(e,n)}),e}function L5(r,e){return r.name+e+_E}var D5=4,ba=8,B5=8,ql=1<<ba,uf=2<<ba,rc=3<<ba,nc=4<<ba,ic=5<<ba,Dl=6<<ba;function sc(r,e,t){return t|e|r}var U5=32-B5;function xE(r,e,t,n){var i=n+1<<U5;return sc(r,e,t)|i}var V5=(function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}})();function y1(r,e){isNaN(r.startOffset)===!0?(r.startOffset=e.startOffset,r.endOffset=e.endOffset):r.endOffset<e.endOffset&&(r.endOffset=e.endOffset)}function v1(r,e){isNaN(r.startOffset)===!0?(r.startOffset=e.startOffset,r.startColumn=e.startColumn,r.startLine=e.startLine,r.endOffset=e.endOffset,r.endColumn=e.endColumn,r.endLine=e.endLine):r.endOffset<e.endOffset&&(r.endOffset=e.endOffset,r.endColumn=e.endColumn,r.endLine=e.endLine)}function j5(r,e,t){r.children[t]===void 0?r.children[t]=[e]:r.children[t].push(e)}function b1(r,e,t){r.children[e]===void 0?r.children[e]=[t]:r.children[e].push(t)}var Ty=(function(r){V5(e,r);function e(t){var n=r.call(this)||this;return n.result=[],n.ruleIdx=t,n}return e.prototype.collectNamedDSLMethod=function(t,n,i){if(!zi(t.name)){var s=void 0;if(t instanceof Sn||t instanceof Yr||t instanceof Hi||t instanceof Ni)s=new n({definition:t.definition,idx:t.idx});else if(t instanceof Wi||t instanceof Ci)s=new n({definition:t.definition,idx:t.idx,separator:t.separator});else throw Error("non exhaustive match");var o=[s],a=sc(this.ruleIdx,i,t.idx);this.result.push({def:o,key:a,name:t.name,orgProd:t})}},e.prototype.visitOption=function(t){this.collectNamedDSLMethod(t,Sn,uf)},e.prototype.visitRepetition=function(t){this.collectNamedDSLMethod(t,Yr,rc)},e.prototype.visitRepetitionMandatory=function(t){this.collectNamedDSLMethod(t,Hi,nc)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.collectNamedDSLMethod(t,Wi,Dl)},e.prototype.visitRepetitionWithSeparator=function(t){this.collectNamedDSLMethod(t,Ci,ic)},e.prototype.visitAlternation=function(t){var n=this;this.collectNamedDSLMethod(t,Ni,ql);var i=t.definition.length>1;ut(t.definition,function(s,o){if(!zi(s.name)){var a=s.definition;i?a=[new Sn({definition:s.definition})]:a=s.definition;var l=xE(n.ruleIdx,ql,t.idx,o);n.result.push({def:a,key:l,name:s.name,orgProd:s})}})},e})(ol);function $5(r,e){var t={allRuleNames:[]};return ut(r,function(n){var i=e[n.name];t.allRuleNames.push(n.name);var s=new Ty(i);n.accept(s),ut(s.result,function(o){o.def,o.key;var a=o.name;t.allRuleNames.push(n.name+a)})}),t}var al=(function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}})(),z5=(function(r){al(e,r);function e(t,n){var i=r.call(this)||this;return i.topProd=t,i.path=n,i.possibleTokTypes=[],i.nextProductionName="",i.nextProductionOccurrence=0,i.found=!1,i.isAtEndOfPath=!1,i}return e.prototype.startWalking=function(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=hi(this.path.ruleStack).reverse(),this.occurrenceStack=hi(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes},e.prototype.walk=function(t,n){n===void 0&&(n=[]),this.found||r.prototype.walk.call(this,t,n)},e.prototype.walkProdRef=function(t,n,i){if(t.referencedRule.name===this.nextProductionName&&t.idx===this.nextProductionOccurrence){var s=n.concat(i);this.updateExpectedNext(),this.walk(t.referencedRule,s)}},e.prototype.updateExpectedNext=function(){wr(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())},e})(Lp),H5=(function(r){al(e,r);function e(t,n){var i=r.call(this,t,n)||this;return i.path=n,i.nextTerminalName="",i.nextTerminalOccurrence=0,i.nextTerminalName=i.path.lastTok.name,i.nextTerminalOccurrence=i.path.lastTokOccurrence,i}return e.prototype.walkTerminal=function(t,n,i){if(this.isAtEndOfPath&&t.terminalType.name===this.nextTerminalName&&t.idx===this.nextTerminalOccurrence&&!this.found){var s=n.concat(i),o=new di({definition:s});this.possibleTokTypes=th(o),this.found=!0}},e})(z5),Dp=(function(r){al(e,r);function e(t,n){var i=r.call(this)||this;return i.topRule=t,i.occurrence=n,i.result={token:void 0,occurrence:void 0,isEndOfRule:void 0},i}return e.prototype.startWalking=function(){return this.walk(this.topRule),this.result},e})(Lp),W5=(function(r){al(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.walkMany=function(t,n,i){if(t.idx===this.occurrence){var s=$i(n.concat(i));this.result.isEndOfRule=s===void 0,s instanceof Pr&&(this.result.token=s.terminalType,this.result.occurrence=s.idx)}else r.prototype.walkMany.call(this,t,n,i)},e})(Dp),w1=(function(r){al(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.walkManySep=function(t,n,i){if(t.idx===this.occurrence){var s=$i(n.concat(i));this.result.isEndOfRule=s===void 0,s instanceof Pr&&(this.result.token=s.terminalType,this.result.occurrence=s.idx)}else r.prototype.walkManySep.call(this,t,n,i)},e})(Dp),G5=(function(r){al(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.walkAtLeastOne=function(t,n,i){if(t.idx===this.occurrence){var s=$i(n.concat(i));this.result.isEndOfRule=s===void 0,s instanceof Pr&&(this.result.token=s.terminalType,this.result.occurrence=s.idx)}else r.prototype.walkAtLeastOne.call(this,t,n,i)},e})(Dp),_1=(function(r){al(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.walkAtLeastOneSep=function(t,n,i){if(t.idx===this.occurrence){var s=$i(n.concat(i));this.result.isEndOfRule=s===void 0,s instanceof Pr&&(this.result.token=s.terminalType,this.result.occurrence=s.idx)}else r.prototype.walkAtLeastOneSep.call(this,t,n,i)},e})(Dp);function Cg(r,e,t){t===void 0&&(t=[]),t=hi(t);var n=[],i=0;function s(u){return u.concat(wn(r,i+1))}function o(u){var c=Cg(s(u),e,t);return n.concat(c)}for(;t.length<e&&i<r.length;){var a=r[i];if(a instanceof di)return o(a.definition);if(a instanceof Ai)return o(a.definition);if(a instanceof Sn)n=o(a.definition);else if(a instanceof Hi){var l=a.definition.concat([new Yr({definition:a.definition})]);return o(l)}else if(a instanceof Wi){var l=[new di({definition:a.definition}),new Yr({definition:[new Pr({terminalType:a.separator})].concat(a.definition)})];return o(l)}else if(a instanceof Ci){var l=a.definition.concat([new Yr({definition:[new Pr({terminalType:a.separator})].concat(a.definition)})]);n=o(l)}else if(a instanceof Yr){var l=a.definition.concat([new Yr({definition:a.definition})]);n=o(l)}else{if(a instanceof Ni)return ut(a.definition,function(u){n=o(u.definition)}),n;if(a instanceof Pr)t.push(a.terminalType);else throw Error("non exhaustive match")}i++}return n.push({partialPath:t,suffixDef:wn(r,i)}),n}function EE(r,e,t,n){var i="EXIT_NONE_TERMINAL",s=[i],o="EXIT_ALTERNATIVE",a=!1,l=e.length,u=l-n-1,c=[],d=[];for(d.push({idx:-1,def:r,ruleStack:[],occurrenceStack:[]});!wr(d);){var h=d.pop();if(h===o){a&&sE(d).idx<=u&&d.pop();continue}var f=h.def,m=h.idx,p=h.ruleStack,g=h.occurrenceStack;if(!wr(f)){var v=f[0];if(v===i){var y={idx:m,def:wn(f),ruleStack:Tc(p),occurrenceStack:Tc(g)};d.push(y)}else if(v instanceof Pr)if(m<l-1){var b=m+1,E=e[b];if(t(E,v.terminalType)){var y={idx:b,def:wn(f),ruleStack:p,occurrenceStack:g};d.push(y)}}else if(m===l-1)c.push({nextTokenType:v.terminalType,nextTokenOccurrence:v.idx,ruleStack:p,occurrenceStack:g}),a=!0;else throw Error("non exhaustive match");else if(v instanceof Ai){var A=hi(p);A.push(v.nonTerminalName);var M=hi(g);M.push(v.idx);var y={idx:m,def:v.definition.concat(s,wn(f)),ruleStack:A,occurrenceStack:M};d.push(y)}else if(v instanceof Sn){var L={idx:m,def:wn(f),ruleStack:p,occurrenceStack:g};d.push(L),d.push(o);var k={idx:m,def:v.definition.concat(wn(f)),ruleStack:p,occurrenceStack:g};d.push(k)}else if(v instanceof Hi){var P=new Yr({definition:v.definition,idx:v.idx}),U=v.definition.concat([P],wn(f)),y={idx:m,def:U,ruleStack:p,occurrenceStack:g};d.push(y)}else if(v instanceof Wi){var $=new Pr({terminalType:v.separator}),P=new Yr({definition:[$].concat(v.definition),idx:v.idx}),U=v.definition.concat([P],wn(f)),y={idx:m,def:U,ruleStack:p,occurrenceStack:g};d.push(y)}else if(v instanceof Ci){var L={idx:m,def:wn(f),ruleStack:p,occurrenceStack:g};d.push(L),d.push(o);var $=new Pr({terminalType:v.separator}),V=new Yr({definition:[$].concat(v.definition),idx:v.idx}),U=v.definition.concat([V],wn(f)),k={idx:m,def:U,ruleStack:p,occurrenceStack:g};d.push(k)}else if(v instanceof Yr){var L={idx:m,def:wn(f),ruleStack:p,occurrenceStack:g};d.push(L),d.push(o);var V=new Yr({definition:v.definition,idx:v.idx}),U=v.definition.concat([V],wn(f)),k={idx:m,def:U,ruleStack:p,occurrenceStack:g};d.push(k)}else if(v instanceof Ni)for(var R=v.definition.length-1;R>=0;R--){var O=v.definition[R],T={idx:m,def:O.definition.concat(wn(f)),ruleStack:p,occurrenceStack:g};d.push(T),d.push(o)}else if(v instanceof di)d.push({idx:m,def:v.definition.concat(wn(f)),ruleStack:p,occurrenceStack:g});else if(v instanceof yu)d.push(q5(v,m,p,g));else throw Error("non exhaustive match")}}return c}function q5(r,e,t,n){var i=hi(t);i.push(r.name);var s=hi(n);return s.push(1),{idx:e,def:r.definition,ruleStack:i,occurrenceStack:s}}var SE=(function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}})(),Sr;(function(r){r[r.OPTION=0]="OPTION",r[r.REPETITION=1]="REPETITION",r[r.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",r[r.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",r[r.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",r[r.ALTERNATION=5]="ALTERNATION"})(Sr||(Sr={}));function Y5(r){if(r instanceof Sn)return Sr.OPTION;if(r instanceof Yr)return Sr.REPETITION;if(r instanceof Hi)return Sr.REPETITION_MANDATORY;if(r instanceof Wi)return Sr.REPETITION_MANDATORY_WITH_SEPARATOR;if(r instanceof Ci)return Sr.REPETITION_WITH_SEPARATOR;if(r instanceof Ni)return Sr.ALTERNATION;throw Error("non exhaustive match")}function X5(r,e,t,n,i,s){var o=Ry(r,e,t),a=AE(o)?af:Fp;return s(o,n,a,i)}function K5(r,e,t,n,i,s){var o=Ay(r,e,i,t),a=AE(o)?af:Fp;return s(o[0],a,n)}function Z5(r,e,t,n){var i=r.length,s=Vi(r,function(l){return Vi(l,function(u){return u.length===1})});if(e)return function(l){for(var u=Xe(l,function(b){return b.GATE}),c=0;c<i;c++){var d=r[c],h=d.length,f=u[c];if(!(f!==void 0&&f.call(this)===!1))e:for(var m=0;m<h;m++){for(var p=d[m],g=p.length,v=0;v<g;v++){var y=this.LA(v+1);if(t(y,p[v])===!1)continue e}return c}}};if(s&&!n){var o=Xe(r,function(l){return ci(l)}),a=Cn(o,function(l,u,c){return ut(u,function(d){lt(l,d.tokenTypeIdx)||(l[d.tokenTypeIdx]=c),ut(d.categoryMatches,function(h){lt(l,h)||(l[h]=c)})}),l},[]);return function(){var l=this.LA(1);return a[l.tokenTypeIdx]}}else return function(){for(var l=0;l<i;l++){var u=r[l],c=u.length;e:for(var d=0;d<c;d++){for(var h=u[d],f=h.length,m=0;m<f;m++){var p=this.LA(m+1);if(t(p,h[m])===!1)continue e}return l}}}}function Q5(r,e,t){var n=Vi(r,function(u){return u.length===1}),i=r.length;if(n&&!t){var s=ci(r);if(s.length===1&&wr(s[0].categoryMatches)){var o=s[0],a=o.tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===a}}else{var l=Cn(s,function(u,c,d){return u[c.tokenTypeIdx]=!0,ut(c.categoryMatches,function(h){u[h]=!0}),u},[]);return function(){var u=this.LA(1);return l[u.tokenTypeIdx]===!0}}}else return function(){e:for(var u=0;u<i;u++){for(var c=r[u],d=c.length,h=0;h<d;h++){var f=this.LA(h+1);if(e(f,c[h])===!1)continue e}return!0}return!1}}var J5=(function(r){SE(e,r);function e(t,n,i){var s=r.call(this)||this;return s.topProd=t,s.targetOccurrence=n,s.targetProdType=i,s}return e.prototype.startWalking=function(){return this.walk(this.topProd),this.restDef},e.prototype.checkIsTarget=function(t,n,i,s){return t.idx===this.targetOccurrence&&this.targetProdType===n?(this.restDef=i.concat(s),!0):!1},e.prototype.walkOption=function(t,n,i){this.checkIsTarget(t,Sr.OPTION,n,i)||r.prototype.walkOption.call(this,t,n,i)},e.prototype.walkAtLeastOne=function(t,n,i){this.checkIsTarget(t,Sr.REPETITION_MANDATORY,n,i)||r.prototype.walkOption.call(this,t,n,i)},e.prototype.walkAtLeastOneSep=function(t,n,i){this.checkIsTarget(t,Sr.REPETITION_MANDATORY_WITH_SEPARATOR,n,i)||r.prototype.walkOption.call(this,t,n,i)},e.prototype.walkMany=function(t,n,i){this.checkIsTarget(t,Sr.REPETITION,n,i)||r.prototype.walkOption.call(this,t,n,i)},e.prototype.walkManySep=function(t,n,i){this.checkIsTarget(t,Sr.REPETITION_WITH_SEPARATOR,n,i)||r.prototype.walkOption.call(this,t,n,i)},e})(Lp),TE=(function(r){SE(e,r);function e(t,n,i){var s=r.call(this)||this;return s.targetOccurrence=t,s.targetProdType=n,s.targetRef=i,s.result=[],s}return e.prototype.checkIsTarget=function(t,n){t.idx===this.targetOccurrence&&this.targetProdType===n&&(this.targetRef===void 0||t===this.targetRef)&&(this.result=t.definition)},e.prototype.visitOption=function(t){this.checkIsTarget(t,Sr.OPTION)},e.prototype.visitRepetition=function(t){this.checkIsTarget(t,Sr.REPETITION)},e.prototype.visitRepetitionMandatory=function(t){this.checkIsTarget(t,Sr.REPETITION_MANDATORY)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.checkIsTarget(t,Sr.REPETITION_MANDATORY_WITH_SEPARATOR)},e.prototype.visitRepetitionWithSeparator=function(t){this.checkIsTarget(t,Sr.REPETITION_WITH_SEPARATOR)},e.prototype.visitAlternation=function(t){this.checkIsTarget(t,Sr.ALTERNATION)},e})(ol);function x1(r){for(var e=new Array(r),t=0;t<r;t++)e[t]=[];return e}function Am(r){for(var e=[""],t=0;t<r.length;t++){for(var n=r[t],i=[],s=0;s<e.length;s++){var o=e[s];i.push(o+"_"+n.tokenTypeIdx);for(var a=0;a<n.categoryMatches.length;a++){var l="_"+n.categoryMatches[a];i.push(o+l)}}e=i}return e}function eM(r,e,t){for(var n=0;n<r.length;n++)if(n!==t)for(var i=r[n],s=0;s<e.length;s++){var o=e[s];if(i[o]===!0)return!1}return!0}function RE(r,e){for(var t=Xe(r,function(c){return Cg([c],1)}),n=x1(t.length),i=Xe(t,function(c){var d={};return ut(c,function(h){var f=Am(h.partialPath);ut(f,function(m){d[m]=!0})}),d}),s=t,o=1;o<=e;o++){var a=s;s=x1(a.length);for(var l=function(c){for(var d=a[c],h=0;h<d.length;h++){var f=d[h].partialPath,m=d[h].suffixDef,p=Am(f),g=eM(i,p,c);if(g||wr(m)||f.length===e){var v=n[c];if(Ng(v,f)===!1){v.push(f);for(var y=0;y<p.length;y++){var b=p[y];i[c][b]=!0}}}else{var E=Cg(m,o+1,f);s[c]=s[c].concat(E),ut(E,function(A){var M=Am(A.partialPath);ut(M,function(L){i[c][L]=!0})})}}},u=0;u<a.length;u++)l(u)}return n}function Ry(r,e,t,n){var i=new TE(r,Sr.ALTERNATION,n);return e.accept(i),RE(i.result,t)}function Ay(r,e,t,n){var i=new TE(r,t);e.accept(i);var s=i.result,o=new J5(e,r,t),a=o.startWalking(),l=new di({definition:s}),u=new di({definition:a});return RE([l,u],n)}function Ng(r,e){e:for(var t=0;t<r.length;t++){var n=r[t];if(n.length===e.length){for(var i=0;i<n.length;i++){var s=e[i],o=n[i],a=s===o||o.categoryMatchesMap[s.tokenTypeIdx]!==void 0;if(a===!1)continue e}return!0}}return!1}function tM(r,e){return r.length<e.length&&Vi(r,function(t,n){var i=e[n];return t===i||i.categoryMatchesMap[t.tokenTypeIdx]})}function AE(r){return Vi(r,function(e){return Vi(e,function(t){return Vi(t,function(n){return wr(n.categoryMatches)})})})}var Cy=(function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}})();function rM(r,e,t,n,i,s){var o=Xe(r,function(y){return iM(y,i)}),a=Xe(r,function(y){return ME(y,y,i)}),l=[],u=[],c=[];Vi(a,wr)&&(l=Xe(r,function(y){return dM(y,i)}),u=Xe(r,function(y){return fM(y,e,n,i)}),c=gM(r,e,i));var d=bM(r,t,i),h=Xe(t,function(y){return uM(y,i)}),f=nM(r,i),m=wM(r,i),p=Xe(r,function(y){return mM(y,i)}),g=Xe(r,function(y){return aM(y,i)}),v=Xe(r,function(y){return cM(y,r,s,i)});return ci(o.concat(h,f,m,c,a,l,u,d,p,g,v))}function nM(r,e){var t=[];return ut(r,function(n){var i=new Ty("");n.accept(i);var s=Xe(i.result,function(o){return o.orgProd});t.push(Xe(s,function(o){return lM(n,o,e)}))}),ci(t)}function iM(r,e){var t=new oM;r.accept(t);var n=t.allProductions,i=aE(n,sM),s=qi(i,function(a){return a.length>1}),o=Xe(jn(s),function(a){var l=$i(a),u=e.buildDuplicateFoundError(r,a),c=Qi(l),d={message:u,type:gn.DUPLICATE_PRODUCTIONS,ruleName:r.name,dslName:c,occurrence:l.idx},h=CE(l);return h&&(d.parameter=h),d});return o}function sM(r){return Qi(r)+"_#_"+r.idx+"_#_"+CE(r)}function CE(r){return r instanceof Pr?r.terminalType.name:r instanceof Ai?r.nonTerminalName:""}var oM=(function(r){Cy(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.allProductions=[],t}return e.prototype.visitNonTerminal=function(t){this.allProductions.push(t)},e.prototype.visitOption=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatory=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetition=function(t){this.allProductions.push(t)},e.prototype.visitAlternation=function(t){this.allProductions.push(t)},e.prototype.visitTerminal=function(t){this.allProductions.push(t)},e})(ol),el=/^[a-zA-Z_]\w*$/,NE=new RegExp(el.source.replace("^","^\\$"));function aM(r,e){var t=[],n=r.name;return n.match(el)||t.push({message:e.buildInvalidRuleNameError({topLevelRule:r,expectedPattern:el}),type:gn.INVALID_RULE_NAME,ruleName:n}),t}function lM(r,e,t){var n=[],i;return e.name.match(NE)||(i=t.buildInvalidNestedRuleNameError(r,e),n.push({message:i,type:gn.INVALID_NESTED_RULE_NAME,ruleName:r.name})),n}function uM(r,e){var t=[],n=r.name;return n.match(el)||t.push({message:e.buildTokenNameError({tokenType:r,expectedPattern:el}),type:gn.INVALID_TOKEN_NAME}),t}function cM(r,e,t,n){var i=[],s=Cn(e,function(a,l){return l.name===r.name?a+1:a},0);if(s>1){var o=n.buildDuplicateRuleNameError({topLevelRule:r,grammarName:t});i.push({message:o,type:gn.DUPLICATE_RULE_NAME,ruleName:r.name})}return i}function hM(r,e,t){var n=[],i;return ln(e,r)||(i="Invalid rule override, rule: ->"+r+"<- cannot be overridden in the grammar: ->"+t+"<-as it is not defined in any of the super grammars ",n.push({message:i,type:gn.INVALID_RULE_OVERRIDE,ruleName:r})),n}function ME(r,e,t,n){n===void 0&&(n=[]);var i=[],s=gd(e.definition);if(wr(s))return[];var o=r.name,a=ln(s,r);a&&i.push({message:t.buildLeftRecursionError({topLevelRule:r,leftRecursionPath:n}),type:gn.LEFT_RECURSION,ruleName:o});var l=Ip(s,n.concat([r])),u=Xe(l,function(c){var d=hi(n);return d.push(c),ME(r,c,t,d)});return i.concat(ci(u))}function gd(r){var e=[];if(wr(r))return e;var t=$i(r);if(t instanceof Ai)e.push(t.referencedRule);else if(t instanceof di||t instanceof Sn||t instanceof Hi||t instanceof Wi||t instanceof Ci||t instanceof Yr)e=e.concat(gd(t.definition));else if(t instanceof Ni)e=ci(Xe(t.definition,function(o){return gd(o.definition)}));else if(!(t instanceof Pr))throw Error("non exhaustive match");var n=lf(t),i=r.length>1;if(n&&i){var s=wn(r);return e.concat(gd(s))}else return e}var Ny=(function(r){Cy(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.alternations=[],t}return e.prototype.visitAlternation=function(t){this.alternations.push(t)},e})(ol);function dM(r,e){var t=new Ny;r.accept(t);var n=t.alternations,i=Cn(n,function(s,o){var a=Tc(o.definition),l=Xe(a,function(u,c){var d=EE([u],[],null,1);return wr(d)?{message:e.buildEmptyAlternationError({topLevelRule:r,alternation:o,emptyChoiceIdx:c}),type:gn.NONE_LAST_EMPTY_ALT,ruleName:r.name,occurrence:o.idx,alternative:c+1}:null});return s.concat(Qc(l))},[]);return i}function fM(r,e,t,n){var i=new Ny;r.accept(i);var s=i.alternations,o=t[r.name];o&&(s=Qa(s,function(l){return o[Qi(l)+(l.idx===0?"":l.idx)]})),s=Qa(s,function(l){return l.ignoreAmbiguities===!0});var a=Cn(s,function(l,u){var c=u.idx,d=u.maxLookahead||e,h=Ry(c,r,d,u),f=yM(h,u,r,n),m=vM(h,u,r,n);return l.concat(f,m)},[]);return a}var pM=(function(r){Cy(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.allProductions=[],t}return e.prototype.visitRepetitionWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatory=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetition=function(t){this.allProductions.push(t)},e})(ol);function mM(r,e){var t=new Ny;r.accept(t);var n=t.alternations,i=Cn(n,function(s,o){return o.definition.length>255&&s.push({message:e.buildTooManyAlternativesError({topLevelRule:r,alternation:o}),type:gn.TOO_MANY_ALTS,ruleName:r.name,occurrence:o.idx}),s},[]);return i}function gM(r,e,t){var n=[];return ut(r,function(i){var s=new pM;i.accept(s);var o=s.allProductions;ut(o,function(a){var l=Y5(a),u=a.maxLookahead||e,c=a.idx,d=Ay(c,i,l,u),h=d[0];if(wr(ci(h))){var f=t.buildEmptyRepetitionError({topLevelRule:i,repetition:a});n.push({message:f,type:gn.NO_NON_EMPTY_LOOKAHEAD,ruleName:i.name})}})}),n}function yM(r,e,t,n){var i=[],s=Cn(r,function(a,l,u){return e.definition[u].ignoreAmbiguities===!0||ut(l,function(c){var d=[u];ut(r,function(h,f){u!==f&&Ng(h,c)&&e.definition[f].ignoreAmbiguities!==!0&&d.push(f)}),d.length>1&&!Ng(i,c)&&(i.push(c),a.push({alts:d,path:c}))}),a},[]),o=Xe(s,function(a){var l=Xe(a.alts,function(c){return c+1}),u=n.buildAlternationAmbiguityError({topLevelRule:t,alternation:e,ambiguityIndices:l,prefixPath:a.path});return{message:u,type:gn.AMBIGUOUS_ALTS,ruleName:t.name,occurrence:e.idx,alternatives:[a.alts]}});return o}function vM(r,e,t,n){var i=[],s=Cn(r,function(o,a,l){var u=Xe(a,function(c){return{idx:l,path:c}});return o.concat(u)},[]);return ut(s,function(o){var a=e.definition[o.idx];if(a.ignoreAmbiguities!==!0){var l=o.idx,u=o.path,c=ON(s,function(h){return e.definition[h.idx].ignoreAmbiguities!==!0&&h.idx<l&&tM(h.path,u)}),d=Xe(c,function(h){var f=[h.idx+1,l+1],m=e.idx===0?"":e.idx,p=n.buildAlternationPrefixAmbiguityError({topLevelRule:t,alternation:e,ambiguityIndices:f,prefixPath:h.path});return{message:p,type:gn.AMBIGUOUS_PREFIX_ALTS,ruleName:t.name,occurrence:m,alternatives:f}});i=i.concat(d)}}),i}function bM(r,e,t){var n=[],i=Xe(e,function(s){return s.name});return ut(r,function(s){var o=s.name;if(ln(i,o)){var a=t.buildNamespaceConflictError(s);n.push({message:a,type:gn.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:o})}}),n}function wM(r,e){var t=[];return ut(r,function(n){var i=new Ty("");n.accept(i);var s=aE(i.result,function(a){return a.name}),o=qi(s,function(a){return a.length>1});ut(jn(o),function(a){var l=Xe(a,function(c){return c.orgProd}),u=e.buildDuplicateNestedRuleNameError(n,l);t.push({message:u,type:gn.DUPLICATE_NESTED_NAME,ruleName:n.name})})}),t}var OE={buildMismatchTokenMessage:function(r){var e=r.expected,t=r.actual;r.previous,r.ruleName;var n=wE(e),i=n?"--> "+Gl(e)+" <--":"token of type --> "+e.name+" <--",s="Expecting "+i+" but found --> '"+t.image+"' <--";return s},buildNotAllInputParsedMessage:function(r){var e=r.firstRedundant;return r.ruleName,"Redundant input, expecting EOF but found: "+e.image},buildNoViableAltMessage:function(r){var e=r.expectedPathsPerAlt,t=r.actual;r.previous;var n=r.customUserDescription;r.ruleName;var i="Expecting: ",s=$i(t).image,o=`
but found: '`+s+"'";if(n)return i+n+o;var a=Cn(e,function(d,h){return d.concat(h)},[]),l=Xe(a,function(d){return"["+Xe(d,function(h){return Gl(h)}).join(", ")+"]"}),u=Xe(l,function(d,h){return"  "+(h+1)+". "+d}),c=`one of these possible Token sequences:
`+u.join(`
`);return i+c+o},buildEarlyExitMessage:function(r){var e=r.expectedIterationPaths,t=r.actual,n=r.customUserDescription;r.ruleName;var i="Expecting: ",s=$i(t).image,o=`
but found: '`+s+"'";if(n)return i+n+o;var a=Xe(e,function(u){return"["+Xe(u,function(c){return Gl(c)}).join(",")+"]"}),l=`expecting at least one iteration which starts with one of these possible Token sequences::
  `+("<"+a.join(" ,")+">");return i+l+o}};Object.freeze(OE);var _M={buildRuleNotFoundError:function(r,e){var t="Invalid grammar, reference to a rule which is not defined: ->"+e.nonTerminalName+`<-
inside top level rule: ->`+r.name+"<-";return t}},My={buildDuplicateFoundError:function(r,e){function t(c){return c instanceof Pr?c.terminalType.name:c instanceof Ai?c.nonTerminalName:""}var n=r.name,i=$i(e),s=i.idx,o=Qi(i),a=t(i),l=s>0,u="->"+o+(l?s:"")+"<- "+(a?"with argument: ->"+a+"<-":"")+`
                  appears more than once (`+e.length+" times) in the top level rule: ->"+n+`<-.                  
                  For further details see: https://sap.github.io/chevrotain/docs/FAQ.html#NUMERICAL_SUFFIXES 
                  `;return u=u.replace(/[ \t]+/g," "),u=u.replace(/\s\s+/g,`
`),u},buildInvalidNestedRuleNameError:function(r,e){var t="Invalid nested rule name: ->"+e.name+"<- inside rule: ->"+r.name+`<-
`+("it must match the pattern: ->"+NE.toString()+`<-.
`)+"Note that this means a nested rule name must start with the '$'(dollar) sign.";return t},buildDuplicateNestedRuleNameError:function(r,e){var t=$i(e).name,n="Duplicate nested rule name: ->"+t+"<- inside rule: ->"+r.name+`<-
A nested name must be unique in the scope of a top level grammar rule.`;return n},buildNamespaceConflictError:function(r){var e=`Namespace conflict found in grammar.
`+("The grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <"+r.name+`>.
`)+`To resolve this make sure each Terminal and Non-Terminal names are unique
This is easy to accomplish by using the convention that Terminal names start with an uppercase letter
and Non-Terminal names start with a lower case letter.`;return e},buildAlternationPrefixAmbiguityError:function(r){var e=Xe(r.prefixPath,function(i){return Gl(i)}).join(", "),t=r.alternation.idx===0?"":r.alternation.idx,n="Ambiguous alternatives: <"+r.ambiguityIndices.join(" ,")+`> due to common lookahead prefix
`+("in <OR"+t+"> inside <"+r.topLevelRule.name+`> Rule,
`)+("<"+e+`> may appears as a prefix path in all these alternatives.
`)+`See: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX
For Further details.`;return n},buildAlternationAmbiguityError:function(r){var e=Xe(r.prefixPath,function(i){return Gl(i)}).join(", "),t=r.alternation.idx===0?"":r.alternation.idx,n="Ambiguous Alternatives Detected: <"+r.ambiguityIndices.join(" ,")+"> in <OR"+t+">"+(" inside <"+r.topLevelRule.name+`> Rule,
`)+("<"+e+`> may appears as a prefix path in all these alternatives.
`);return n=n+`See: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES
For Further details.`,n},buildEmptyRepetitionError:function(r){var e=Qi(r.repetition);r.repetition.idx!==0&&(e+=r.repetition.idx);var t="The repetition <"+e+"> within Rule <"+r.topLevelRule.name+`> can never consume any tokens.
This could lead to an infinite loop.`;return t},buildTokenNameError:function(r){var e=r.tokenType.name,t="Invalid Grammar Token name: ->"+e+"<- it must match the pattern: ->"+r.expectedPattern.toString()+"<-";return t},buildEmptyAlternationError:function(r){var e="Ambiguous empty alternative: <"+(r.emptyChoiceIdx+1)+">"+(" in <OR"+r.alternation.idx+"> inside <"+r.topLevelRule.name+`> Rule.
`)+"Only the last alternative may be an empty alternative.";return e},buildTooManyAlternativesError:function(r){var e=`An Alternation cannot have more than 256 alternatives:
`+("<OR"+r.alternation.idx+"> inside <"+r.topLevelRule.name+`> Rule.
 has `+(r.alternation.definition.length+1)+" alternatives.");return e},buildLeftRecursionError:function(r){var e=r.topLevelRule.name,t=Xe(r.leftRecursionPath,function(s){return s.name}),n=e+" --> "+t.concat([e]).join(" --> "),i=`Left Recursion found in grammar.
`+("rule: <"+e+`> can be invoked from itself (directly or indirectly)
`)+(`without consuming any Tokens. The grammar path that causes this is: 
 `+n+`
`)+` To fix this refactor your grammar to remove the left recursion.
see: https://en.wikipedia.org/wiki/LL_parser#Left_Factoring.`;return i},buildInvalidRuleNameError:function(r){var e=r.topLevelRule.name,t=r.expectedPattern.toString(),n="Invalid grammar rule name: ->"+e+"<- it must match the pattern: ->"+t+"<-";return n},buildDuplicateRuleNameError:function(r){var e;r.topLevelRule instanceof yu?e=r.topLevelRule.name:e=r.topLevelRule;var t="Duplicate definition, rule: ->"+e+"<- is already defined in the grammar: ->"+r.grammarName+"<-";return t}},xM=(function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}})();function EM(r,e){var t=new SM(r,e);return t.resolveRefs(),t.errors}var SM=(function(r){xM(e,r);function e(t,n){var i=r.call(this)||this;return i.nameToTopRule=t,i.errMsgProvider=n,i.errors=[],i}return e.prototype.resolveRefs=function(){var t=this;ut(jn(this.nameToTopRule),function(n){t.currTopLevel=n,n.accept(t)})},e.prototype.visitNonTerminal=function(t){var n=this.nameToTopRule[t.nonTerminalName];if(n)t.referencedRule=n;else{var i=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,t);this.errors.push({message:i,type:gn.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:t.nonTerminalName})}},e})(ol);function TM(r){r=kp(r,{errMsgProvider:_M});var e={};return ut(r.rules,function(t){e[t.name]=t}),EM(e,r.errMsgProvider)}function RM(r){return r=kp(r,{errMsgProvider:My,ignoredIssues:{}}),rM(r.rules,r.maxLookahead,r.tokenTypes,r.ignoredIssues,r.errMsgProvider,r.grammarName)}var IE="MismatchedTokenException",kE="NoViableAltException",PE="EarlyExitException",FE="NotAllInputParsedException",LE=[IE,kE,PE,FE];Object.freeze(LE);function cf(r){return ln(LE,r.name)}function Oy(r,e,t){this.name=IE,this.message=r,this.token=e,this.previousToken=t,this.resyncedTokens=[]}Oy.prototype=Error.prototype;function DE(r,e,t){this.name=kE,this.message=r,this.token=e,this.previousToken=t,this.resyncedTokens=[]}DE.prototype=Error.prototype;function BE(r,e){this.name=FE,this.message=r,this.token=e,this.resyncedTokens=[]}BE.prototype=Error.prototype;function UE(r,e,t){this.name=PE,this.message=r,this.token=e,this.previousToken=t,this.resyncedTokens=[]}UE.prototype=Error.prototype;var Cm={},VE="InRuleRecoveryException";function jE(r){this.name=VE,this.message=r}jE.prototype=Error.prototype;var AM=(function(){function r(){}return r.prototype.initRecoverable=function(e){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=lt(e,"recoveryEnabled")?e.recoveryEnabled:ri.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=CM)},r.prototype.getTokenToInsert=function(e){var t=Sy(e,"",NaN,NaN,NaN,NaN,NaN,NaN);return t.isInsertedInRecovery=!0,t},r.prototype.canTokenTypeBeInsertedInRecovery=function(e){return!0},r.prototype.tryInRepetitionRecovery=function(e,t,n,i){for(var s=this,o=this.findReSyncTokenType(),a=this.exportLexerState(),l=[],u=!1,c=this.LA(1),d=this.LA(1),h=function(){var f=s.LA(0),m=s.errorMessageProvider.buildMismatchTokenMessage({expected:i,actual:c,previous:f,ruleName:s.getCurrRuleFullName()}),p=new Oy(m,c,s.LA(0));p.resyncedTokens=Tc(l),s.SAVE_ERROR(p)};!u;)if(this.tokenMatcher(d,i)){h();return}else if(n.call(this)){h(),e.apply(this,t);return}else this.tokenMatcher(d,o)?u=!0:(d=this.SKIP_TOKEN(),this.addToResyncTokens(d,l));this.importLexerState(a)},r.prototype.shouldInRepetitionRecoveryBeTried=function(e,t,n){return!(n===!1||e===void 0||t===void 0||this.tokenMatcher(this.LA(1),e)||this.isBackTracking()||this.canPerformInRuleRecovery(e,this.getFollowsForInRuleRecovery(e,t)))},r.prototype.getFollowsForInRuleRecovery=function(e,t){var n=this.getCurrentGrammarPath(e,t),i=this.getNextPossibleTokenTypes(n);return i},r.prototype.tryInRuleRecovery=function(e,t){if(this.canRecoverWithSingleTokenInsertion(e,t)){var n=this.getTokenToInsert(e);return n}if(this.canRecoverWithSingleTokenDeletion(e)){var i=this.SKIP_TOKEN();return this.consumeToken(),i}throw new jE("sad sad panda")},r.prototype.canPerformInRuleRecovery=function(e,t){return this.canRecoverWithSingleTokenInsertion(e,t)||this.canRecoverWithSingleTokenDeletion(e)},r.prototype.canRecoverWithSingleTokenInsertion=function(e,t){var n=this;if(!this.canTokenTypeBeInsertedInRecovery(e)||wr(t))return!1;var i=this.LA(1),s=iu(t,function(o){return n.tokenMatcher(i,o)})!==void 0;return s},r.prototype.canRecoverWithSingleTokenDeletion=function(e){var t=this.tokenMatcher(this.LA(2),e);return t},r.prototype.isInCurrentRuleReSyncSet=function(e){var t=this.getCurrFollowKey(),n=this.getFollowSetFromFollowKey(t);return ln(n,e)},r.prototype.findReSyncTokenType=function(){for(var e=this.flattenFollowSet(),t=this.LA(1),n=2;;){var i=t.tokenType;if(ln(e,i))return i;t=this.LA(n),n++}},r.prototype.getCurrFollowKey=function(){if(this.RULE_STACK.length===1)return Cm;var e=this.getLastExplicitRuleShortName(),t=this.getLastExplicitRuleOccurrenceIndex(),n=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(e),idxInCallingRule:t,inRule:this.shortRuleNameToFullName(n)}},r.prototype.buildFullFollowKeyStack=function(){var e=this,t=this.RULE_STACK,n=this.RULE_OCCURRENCE_STACK;return wr(this.LAST_EXPLICIT_RULE_STACK)||(t=Xe(this.LAST_EXPLICIT_RULE_STACK,function(i){return e.RULE_STACK[i]}),n=Xe(this.LAST_EXPLICIT_RULE_STACK,function(i){return e.RULE_OCCURRENCE_STACK[i]})),Xe(t,function(i,s){return s===0?Cm:{ruleName:e.shortRuleNameToFullName(i),idxInCallingRule:n[s],inRule:e.shortRuleNameToFullName(t[s-1])}})},r.prototype.flattenFollowSet=function(){var e=this,t=Xe(this.buildFullFollowKeyStack(),function(n){return e.getFollowSetFromFollowKey(n)});return ci(t)},r.prototype.getFollowSetFromFollowKey=function(e){if(e===Cm)return[Ja];var t=e.ruleName+e.idxInCallingRule+_E+e.inRule;return this.resyncFollows[t]},r.prototype.addToResyncTokens=function(e,t){return this.tokenMatcher(e,Ja)||t.push(e),t},r.prototype.reSyncTo=function(e){for(var t=[],n=this.LA(1);this.tokenMatcher(n,e)===!1;)n=this.SKIP_TOKEN(),this.addToResyncTokens(n,t);return Tc(t)},r.prototype.attemptInRepetitionRecovery=function(e,t,n,i,s,o,a){},r.prototype.getCurrentGrammarPath=function(e,t){var n=this.getHumanReadableRuleStack(),i=hi(this.RULE_OCCURRENCE_STACK),s={ruleStack:n,occurrenceStack:i,lastTok:e,lastTokOccurrence:t};return s},r.prototype.getHumanReadableRuleStack=function(){var e=this;return wr(this.LAST_EXPLICIT_RULE_STACK)?Xe(this.RULE_STACK,function(t){return e.shortRuleNameToFullName(t)}):Xe(this.LAST_EXPLICIT_RULE_STACK,function(t){return e.shortRuleNameToFullName(e.RULE_STACK[t])})},r})();function CM(r,e,t,n,i,s,o){var a=this.getKeyForAutomaticLookahead(n,i),l=this.firstAfterRepMap[a];if(l===void 0){var u=this.getCurrRuleFullName(),c=this.getGAstProductions()[u],d=new s(c,i);l=d.startWalking(),this.firstAfterRepMap[a]=l}var h=l.token,f=l.occurrence,m=l.isEndOfRule;this.RULE_STACK.length===1&&m&&h===void 0&&(h=Ja,f=1),this.shouldInRepetitionRecoveryBeTried(h,f,o)&&this.tryInRepetitionRecovery(r,e,t,h)}var NM=(function(){function r(){}return r.prototype.initLooksAhead=function(e){this.dynamicTokensEnabled=lt(e,"dynamicTokensEnabled")?e.dynamicTokensEnabled:ri.dynamicTokensEnabled,this.maxLookahead=lt(e,"maxLookahead")?e.maxLookahead:ri.maxLookahead,this.lookAheadFuncsCache=t1()?new Map:[],t1()?(this.getLaFuncFromCache=this.getLaFuncFromMap,this.setLaFuncCache=this.setLaFuncCacheUsingMap):(this.getLaFuncFromCache=this.getLaFuncFromObj,this.setLaFuncCache=this.setLaFuncUsingObj)},r.prototype.preComputeLookaheadFunctions=function(e){var t=this;ut(e,function(n){t.TRACE_INIT(n.name+" Rule Lookahead",function(){var i=N5(n),s=i.alternation,o=i.repetition,a=i.option,l=i.repetitionMandatory,u=i.repetitionMandatoryWithSeparator,c=i.repetitionWithSeparator;ut(s,function(d){var h=d.idx===0?"":d.idx;t.TRACE_INIT(""+Qi(d)+h,function(){var f=X5(d.idx,n,d.maxLookahead||t.maxLookahead,d.hasPredicates,t.dynamicTokensEnabled,t.lookAheadBuilderForAlternatives),m=sc(t.fullRuleNameToShort[n.name],ql,d.idx);t.setLaFuncCache(m,f)})}),ut(o,function(d){t.computeLookaheadFunc(n,d.idx,rc,Sr.REPETITION,d.maxLookahead,Qi(d))}),ut(a,function(d){t.computeLookaheadFunc(n,d.idx,uf,Sr.OPTION,d.maxLookahead,Qi(d))}),ut(l,function(d){t.computeLookaheadFunc(n,d.idx,nc,Sr.REPETITION_MANDATORY,d.maxLookahead,Qi(d))}),ut(u,function(d){t.computeLookaheadFunc(n,d.idx,Dl,Sr.REPETITION_MANDATORY_WITH_SEPARATOR,d.maxLookahead,Qi(d))}),ut(c,function(d){t.computeLookaheadFunc(n,d.idx,ic,Sr.REPETITION_WITH_SEPARATOR,d.maxLookahead,Qi(d))})})})},r.prototype.computeLookaheadFunc=function(e,t,n,i,s,o){var a=this;this.TRACE_INIT(""+o+(t===0?"":t),function(){var l=K5(t,e,s||a.maxLookahead,a.dynamicTokensEnabled,i,a.lookAheadBuilderForOptional),u=sc(a.fullRuleNameToShort[e.name],n,t);a.setLaFuncCache(u,l)})},r.prototype.lookAheadBuilderForOptional=function(e,t,n){return Q5(e,t,n)},r.prototype.lookAheadBuilderForAlternatives=function(e,t,n,i){return Z5(e,t,n,i)},r.prototype.getKeyForAutomaticLookahead=function(e,t){var n=this.getLastExplicitRuleShortName();return sc(n,e,t)},r.prototype.getLaFuncFromCache=function(e){},r.prototype.getLaFuncFromMap=function(e){return this.lookAheadFuncsCache.get(e)},r.prototype.getLaFuncFromObj=function(e){return this.lookAheadFuncsCache[e]},r.prototype.setLaFuncCache=function(e,t){},r.prototype.setLaFuncCacheUsingMap=function(e,t){this.lookAheadFuncsCache.set(e,t)},r.prototype.setLaFuncUsingObj=function(e,t){this.lookAheadFuncsCache[e]=t},r})();function MM(r){return Bp(r.constructor)}var OM=/^\s*function\s*(\S*)\s*\(/,E1="name";function Bp(r){var e=r.name;if(e)return e;var t=r.toString().match(OM)[1];return t}function $E(r,e){var t=Object.getOwnPropertyDescriptor(r,E1);return zi(t)||t.configurable?(Object.defineProperty(r,E1,{enumerable:!1,configurable:!0,writable:!1,value:e}),!0):!1}function IM(r,e){for(var t=Fo(r),n=t.length,i=0;i<n;i++)for(var s=t[i],o=r[s],a=o.length,l=0;l<a;l++){var u=o[l];u.tokenTypeIdx===void 0&&(u.fullName!==void 0?this[u.fullName](u.children,e):this[u.name](u.children,e))}}function kM(r,e){var t=function(){};$E(t,r+"BaseSemantics");var n={visit:function(i,s){if(is(i)&&(i=i[0]),!zi(i))return i.fullName!==void 0?this[i.fullName](i.children,s):this[i.name](i.children,s)},validateVisitor:function(){var i=FM(this,e);if(!wr(i)){var s=Xe(i,function(o){return o.msg});throw Error("Errors Detected in CST Visitor <"+Bp(this.constructor)+`>:
	`+(""+s.join(`

`).replace(/\n/g,`
	`)))}}};return t.prototype=n,t.prototype.constructor=t,t._RULE_NAMES=e,t}function PM(r,e,t){var n=function(){};$E(n,r+"BaseSemanticsWithDefaults");var i=Object.create(t.prototype);return ut(e,function(s){i[s]=IM}),n.prototype=i,n.prototype.constructor=n,n}var hf;(function(r){r[r.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",r[r.MISSING_METHOD=1]="MISSING_METHOD"})(hf||(hf={}));function FM(r,e){var t=LM(r,e),n=BM(r,e);return t.concat(n)}function LM(r,e){var t=Xe(e,function(n){if(!va(r[n]))return{msg:"Missing visitor method: <"+n+"> on "+Bp(r.constructor)+" CST Visitor.",type:hf.MISSING_METHOD,methodName:n}});return Qc(t)}var DM=["constructor","visit","validateVisitor"];function BM(r,e){var t=[];for(var n in r)el.test(n)&&va(r[n])&&!ln(DM,n)&&!ln(e,n)&&t.push({msg:"Redundant visitor method: <"+n+"> on "+Bp(r.constructor)+` CST Visitor
There is no Grammar Rule corresponding to this method's name.
`+("For utility methods on visitor classes use methods names that do not match /"+el.source+"/."),type:hf.REDUNDANT_METHOD,methodName:n});return t}var UM=(function(){function r(){}return r.prototype.initTreeBuilder=function(e){if(this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.outputCst=lt(e,"outputCst")?e.outputCst:ri.outputCst,this.nodeLocationTracking=lt(e,"nodeLocationTracking")?e.nodeLocationTracking:ri.nodeLocationTracking,!this.outputCst)this.cstInvocationStateUpdate=dn,this.cstFinallyStateUpdate=dn,this.cstPostTerminal=dn,this.cstPostNonTerminal=dn,this.cstPostRule=dn,this.getLastExplicitRuleShortName=this.getLastExplicitRuleShortNameNoCst,this.getPreviousExplicitRuleShortName=this.getPreviousExplicitRuleShortNameNoCst,this.getLastExplicitRuleOccurrenceIndex=this.getLastExplicitRuleOccurrenceIndexNoCst,this.manyInternal=this.manyInternalNoCst,this.orInternal=this.orInternalNoCst,this.optionInternal=this.optionInternalNoCst,this.atLeastOneInternal=this.atLeastOneInternalNoCst,this.manySepFirstInternal=this.manySepFirstInternalNoCst,this.atLeastOneSepFirstInternal=this.atLeastOneSepFirstInternalNoCst;else if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=v1,this.setNodeLocationFromNode=v1,this.cstPostRule=dn,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=dn,this.setNodeLocationFromNode=dn,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=y1,this.setNodeLocationFromNode=y1,this.cstPostRule=dn,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=dn,this.setNodeLocationFromNode=dn,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else if(/none/i.test(this.nodeLocationTracking))this.setNodeLocationFromToken=dn,this.setNodeLocationFromNode=dn,this.cstPostRule=dn,this.setInitialNodeLocation=dn;else throw Error('Invalid <nodeLocationTracking> config option: "'+e.nodeLocationTracking+'"')},r.prototype.setInitialNodeLocationOnlyOffsetRecovery=function(e){e.location={startOffset:NaN,endOffset:NaN}},r.prototype.setInitialNodeLocationOnlyOffsetRegular=function(e){e.location={startOffset:this.LA(1).startOffset,endOffset:NaN}},r.prototype.setInitialNodeLocationFullRecovery=function(e){e.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}},r.prototype.setInitialNodeLocationFullRegular=function(e){var t=this.LA(1);e.location={startOffset:t.startOffset,startLine:t.startLine,startColumn:t.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}},r.prototype.cstNestedInvocationStateUpdate=function(e,t){var n={name:e,fullName:this.shortRuleNameToFull[this.getLastExplicitRuleShortName()]+e,children:{}};this.setInitialNodeLocation(n),this.CST_STACK.push(n)},r.prototype.cstInvocationStateUpdate=function(e,t){this.LAST_EXPLICIT_RULE_STACK.push(this.RULE_STACK.length-1);var n={name:e,children:{}};this.setInitialNodeLocation(n),this.CST_STACK.push(n)},r.prototype.cstFinallyStateUpdate=function(){this.LAST_EXPLICIT_RULE_STACK.pop(),this.CST_STACK.pop()},r.prototype.cstNestedFinallyStateUpdate=function(){var e=this.CST_STACK.pop();this.cstPostRule(e)},r.prototype.cstPostRuleFull=function(e){var t=this.LA(0),n=e.location;n.startOffset<=t.startOffset?(n.endOffset=t.endOffset,n.endLine=t.endLine,n.endColumn=t.endColumn):(n.startOffset=NaN,n.startLine=NaN,n.startColumn=NaN)},r.prototype.cstPostRuleOnlyOffset=function(e){var t=this.LA(0),n=e.location;n.startOffset<=t.startOffset?n.endOffset=t.endOffset:n.startOffset=NaN},r.prototype.cstPostTerminal=function(e,t){var n=this.CST_STACK[this.CST_STACK.length-1];j5(n,t,e),this.setNodeLocationFromToken(n.location,t)},r.prototype.cstPostNonTerminal=function(e,t){if(this.isBackTracking()!==!0){var n=this.CST_STACK[this.CST_STACK.length-1];b1(n,t,e),this.setNodeLocationFromNode(n.location,e.location)}},r.prototype.getBaseCstVisitorConstructor=function(){if(zi(this.baseCstVisitorConstructor)){var e=kM(this.className,this.allRuleNames);return this.baseCstVisitorConstructor=e,e}return this.baseCstVisitorConstructor},r.prototype.getBaseCstVisitorConstructorWithDefaults=function(){if(zi(this.baseCstVisitorWithDefaultsConstructor)){var e=PM(this.className,this.allRuleNames,this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=e,e}return this.baseCstVisitorWithDefaultsConstructor},r.prototype.nestedRuleBeforeClause=function(e,t){var n;if(e.NAME!==void 0)return n=e.NAME,this.nestedRuleInvocationStateUpdate(n,t),n},r.prototype.nestedAltBeforeClause=function(e,t,n,i){var s=this.getLastExplicitRuleShortName(),o=xE(s,n,t,i),a;if(e.NAME!==void 0)return a=e.NAME,this.nestedRuleInvocationStateUpdate(a,o),{shortName:o,nestedName:a}},r.prototype.nestedRuleFinallyClause=function(e,t){var n=this.CST_STACK,i=n[n.length-1];this.nestedRuleFinallyStateUpdate();var s=n[n.length-1];b1(s,t,i),this.setNodeLocationFromNode(s.location,i.location)},r.prototype.getLastExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_STACK[e]},r.prototype.getLastExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-1]},r.prototype.getPreviousExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-2];return this.RULE_STACK[e]},r.prototype.getPreviousExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-2]},r.prototype.getLastExplicitRuleOccurrenceIndex=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_OCCURRENCE_STACK[e]},r.prototype.getLastExplicitRuleOccurrenceIndexNoCst=function(){var e=this.RULE_OCCURRENCE_STACK;return e[e.length-1]},r.prototype.nestedRuleInvocationStateUpdate=function(e,t){this.RULE_OCCURRENCE_STACK.push(1),this.RULE_STACK.push(t),this.cstNestedInvocationStateUpdate(e,t)},r.prototype.nestedRuleFinallyStateUpdate=function(){this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstNestedFinallyStateUpdate()},r})(),VM=(function(){function r(){}return r.prototype.initLexerAdapter=function(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1},Object.defineProperty(r.prototype,"input",{get:function(){return this.tokVector},set:function(e){if(this.selfAnalysisDone!==!0)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=e,this.tokVectorLength=e.length},enumerable:!0,configurable:!0}),r.prototype.SKIP_TOKEN=function(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):ff},r.prototype.LA=function(e){var t=this.currIdx+e;return t<0||this.tokVectorLength<=t?ff:this.tokVector[t]},r.prototype.consumeToken=function(){this.currIdx++},r.prototype.exportLexerState=function(){return this.currIdx},r.prototype.importLexerState=function(e){this.currIdx=e},r.prototype.resetLexerState=function(){this.currIdx=-1},r.prototype.moveToTerminatedState=function(){this.currIdx=this.tokVector.length-1},r.prototype.getLexerPosition=function(){return this.exportLexerState()},r})(),jM=(function(){function r(){}return r.prototype.ACTION=function(e){return e.call(this)},r.prototype.consume=function(e,t,n){return this.consumeInternal(t,e,n)},r.prototype.subrule=function(e,t,n){return this.subruleInternal(t,e,n)},r.prototype.option=function(e,t){return this.optionInternal(t,e)},r.prototype.or=function(e,t){return this.orInternal(t,e)},r.prototype.many=function(e,t){return this.manyInternal(e,t)},r.prototype.atLeastOne=function(e,t){return this.atLeastOneInternal(e,t)},r.prototype.CONSUME=function(e,t){return this.consumeInternal(e,0,t)},r.prototype.CONSUME1=function(e,t){return this.consumeInternal(e,1,t)},r.prototype.CONSUME2=function(e,t){return this.consumeInternal(e,2,t)},r.prototype.CONSUME3=function(e,t){return this.consumeInternal(e,3,t)},r.prototype.CONSUME4=function(e,t){return this.consumeInternal(e,4,t)},r.prototype.CONSUME5=function(e,t){return this.consumeInternal(e,5,t)},r.prototype.CONSUME6=function(e,t){return this.consumeInternal(e,6,t)},r.prototype.CONSUME7=function(e,t){return this.consumeInternal(e,7,t)},r.prototype.CONSUME8=function(e,t){return this.consumeInternal(e,8,t)},r.prototype.CONSUME9=function(e,t){return this.consumeInternal(e,9,t)},r.prototype.SUBRULE=function(e,t){return this.subruleInternal(e,0,t)},r.prototype.SUBRULE1=function(e,t){return this.subruleInternal(e,1,t)},r.prototype.SUBRULE2=function(e,t){return this.subruleInternal(e,2,t)},r.prototype.SUBRULE3=function(e,t){return this.subruleInternal(e,3,t)},r.prototype.SUBRULE4=function(e,t){return this.subruleInternal(e,4,t)},r.prototype.SUBRULE5=function(e,t){return this.subruleInternal(e,5,t)},r.prototype.SUBRULE6=function(e,t){return this.subruleInternal(e,6,t)},r.prototype.SUBRULE7=function(e,t){return this.subruleInternal(e,7,t)},r.prototype.SUBRULE8=function(e,t){return this.subruleInternal(e,8,t)},r.prototype.SUBRULE9=function(e,t){return this.subruleInternal(e,9,t)},r.prototype.OPTION=function(e){return this.optionInternal(e,0)},r.prototype.OPTION1=function(e){return this.optionInternal(e,1)},r.prototype.OPTION2=function(e){return this.optionInternal(e,2)},r.prototype.OPTION3=function(e){return this.optionInternal(e,3)},r.prototype.OPTION4=function(e){return this.optionInternal(e,4)},r.prototype.OPTION5=function(e){return this.optionInternal(e,5)},r.prototype.OPTION6=function(e){return this.optionInternal(e,6)},r.prototype.OPTION7=function(e){return this.optionInternal(e,7)},r.prototype.OPTION8=function(e){return this.optionInternal(e,8)},r.prototype.OPTION9=function(e){return this.optionInternal(e,9)},r.prototype.OR=function(e){return this.orInternal(e,0)},r.prototype.OR1=function(e){return this.orInternal(e,1)},r.prototype.OR2=function(e){return this.orInternal(e,2)},r.prototype.OR3=function(e){return this.orInternal(e,3)},r.prototype.OR4=function(e){return this.orInternal(e,4)},r.prototype.OR5=function(e){return this.orInternal(e,5)},r.prototype.OR6=function(e){return this.orInternal(e,6)},r.prototype.OR7=function(e){return this.orInternal(e,7)},r.prototype.OR8=function(e){return this.orInternal(e,8)},r.prototype.OR9=function(e){return this.orInternal(e,9)},r.prototype.MANY=function(e){this.manyInternal(0,e)},r.prototype.MANY1=function(e){this.manyInternal(1,e)},r.prototype.MANY2=function(e){this.manyInternal(2,e)},r.prototype.MANY3=function(e){this.manyInternal(3,e)},r.prototype.MANY4=function(e){this.manyInternal(4,e)},r.prototype.MANY5=function(e){this.manyInternal(5,e)},r.prototype.MANY6=function(e){this.manyInternal(6,e)},r.prototype.MANY7=function(e){this.manyInternal(7,e)},r.prototype.MANY8=function(e){this.manyInternal(8,e)},r.prototype.MANY9=function(e){this.manyInternal(9,e)},r.prototype.MANY_SEP=function(e){this.manySepFirstInternal(0,e)},r.prototype.MANY_SEP1=function(e){this.manySepFirstInternal(1,e)},r.prototype.MANY_SEP2=function(e){this.manySepFirstInternal(2,e)},r.prototype.MANY_SEP3=function(e){this.manySepFirstInternal(3,e)},r.prototype.MANY_SEP4=function(e){this.manySepFirstInternal(4,e)},r.prototype.MANY_SEP5=function(e){this.manySepFirstInternal(5,e)},r.prototype.MANY_SEP6=function(e){this.manySepFirstInternal(6,e)},r.prototype.MANY_SEP7=function(e){this.manySepFirstInternal(7,e)},r.prototype.MANY_SEP8=function(e){this.manySepFirstInternal(8,e)},r.prototype.MANY_SEP9=function(e){this.manySepFirstInternal(9,e)},r.prototype.AT_LEAST_ONE=function(e){this.atLeastOneInternal(0,e)},r.prototype.AT_LEAST_ONE1=function(e){return this.atLeastOneInternal(1,e)},r.prototype.AT_LEAST_ONE2=function(e){this.atLeastOneInternal(2,e)},r.prototype.AT_LEAST_ONE3=function(e){this.atLeastOneInternal(3,e)},r.prototype.AT_LEAST_ONE4=function(e){this.atLeastOneInternal(4,e)},r.prototype.AT_LEAST_ONE5=function(e){this.atLeastOneInternal(5,e)},r.prototype.AT_LEAST_ONE6=function(e){this.atLeastOneInternal(6,e)},r.prototype.AT_LEAST_ONE7=function(e){this.atLeastOneInternal(7,e)},r.prototype.AT_LEAST_ONE8=function(e){this.atLeastOneInternal(8,e)},r.prototype.AT_LEAST_ONE9=function(e){this.atLeastOneInternal(9,e)},r.prototype.AT_LEAST_ONE_SEP=function(e){this.atLeastOneSepFirstInternal(0,e)},r.prototype.AT_LEAST_ONE_SEP1=function(e){this.atLeastOneSepFirstInternal(1,e)},r.prototype.AT_LEAST_ONE_SEP2=function(e){this.atLeastOneSepFirstInternal(2,e)},r.prototype.AT_LEAST_ONE_SEP3=function(e){this.atLeastOneSepFirstInternal(3,e)},r.prototype.AT_LEAST_ONE_SEP4=function(e){this.atLeastOneSepFirstInternal(4,e)},r.prototype.AT_LEAST_ONE_SEP5=function(e){this.atLeastOneSepFirstInternal(5,e)},r.prototype.AT_LEAST_ONE_SEP6=function(e){this.atLeastOneSepFirstInternal(6,e)},r.prototype.AT_LEAST_ONE_SEP7=function(e){this.atLeastOneSepFirstInternal(7,e)},r.prototype.AT_LEAST_ONE_SEP8=function(e){this.atLeastOneSepFirstInternal(8,e)},r.prototype.AT_LEAST_ONE_SEP9=function(e){this.atLeastOneSepFirstInternal(9,e)},r.prototype.RULE=function(e,t,n){if(n===void 0&&(n=pf),ln(this.definedRulesNames,e)){var i=My.buildDuplicateRuleNameError({topLevelRule:e,grammarName:this.className}),s={message:i,type:gn.DUPLICATE_RULE_NAME,ruleName:e};this.definitionErrors.push(s)}this.definedRulesNames.push(e);var o=this.defineRule(e,t,n);return this[e]=o,o},r.prototype.OVERRIDE_RULE=function(e,t,n){n===void 0&&(n=pf);var i=[];i=i.concat(hM(e,this.definedRulesNames,this.className)),this.definitionErrors.push.apply(this.definitionErrors,i);var s=this.defineRule(e,t,n);return this[e]=s,s},r.prototype.BACKTRACK=function(e,t){return function(){this.isBackTrackingStack.push(1);var n=this.saveRecogState();try{return e.apply(this,t),!0}catch(i){if(cf(i))return!1;throw i}finally{this.reloadRecogState(n),this.isBackTrackingStack.pop()}}},r.prototype.getGAstProductions=function(){return this.gastProductionsCache},r.prototype.getSerializedGastProductions=function(){return S5(jn(this.gastProductionsCache))},r})(),$M=(function(){function r(){}return r.prototype.initRecognizerEngine=function(e,t){if(this.className=MM(this),this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=af,this.definedRulesNames=[],this.tokensMap={},this.allRuleNames=[],this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},lt(t,"serializedGrammar"))throw Error(`The Parser's configuration can no longer contain a <serializedGrammar> property.
	See: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_6-0-0
	For Further details.`);if(is(e)){if(wr(e))throw Error(`A Token Vocabulary cannot be empty.
	Note that the first argument for the parser constructor
	is no longer a Token vector (since v4.0).`);if(typeof e[0].startOffset=="number")throw Error(`The Parser constructor no longer accepts a token vector as the first argument.
	See: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_4-0-0
	For Further details.`)}if(is(e))this.tokensMap=Cn(e,function(o,a){return o[a.name]=a,o},{});else if(lt(e,"modes")&&Vi(ci(jn(e.modes)),w5)){var n=ci(jn(e.modes)),i=wy(n);this.tokensMap=Cn(i,function(o,a){return o[a.name]=a,o},{})}else if(_y(e))this.tokensMap=Zc(e);else throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap.EOF=Ja;var s=Vi(jn(e),function(o){return wr(o.categoryMatches)});this.tokenMatcher=s?af:Fp,eh(jn(this.tokensMap))},r.prototype.defineRule=function(e,t,n){if(this.selfAnalysisDone)throw Error("Grammar rule <"+e+`> may not be defined after the 'performSelfAnalysis' method has been called'
Make sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.`);var i=lt(n,"resyncEnabled")?n.resyncEnabled:pf.resyncEnabled,s=lt(n,"recoveryValueFunc")?n.recoveryValueFunc:pf.recoveryValueFunc,o=this.ruleShortNameIdx<<D5+ba;this.ruleShortNameIdx++,this.shortRuleNameToFull[o]=e,this.fullRuleNameToShort[e]=o;function a(c){try{if(this.outputCst===!0){t.apply(this,c);var d=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(d),d}else return t.apply(this,c)}catch(h){return this.invokeRuleCatch(h,i,s)}finally{this.ruleFinallyStateUpdate()}}var l;l=function(c,d){return c===void 0&&(c=0),this.ruleInvocationStateUpdate(o,e,c),a.call(this,d)};var u="ruleName";return l[u]=e,l.originalGrammarAction=t,l},r.prototype.invokeRuleCatch=function(e,t,n){var i=this.RULE_STACK.length===1,s=t&&!this.isBackTracking()&&this.recoveryEnabled;if(cf(e)){var o=e;if(s){var a=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(a))if(o.resyncedTokens=this.reSyncTo(a),this.outputCst){var l=this.CST_STACK[this.CST_STACK.length-1];return l.recoveredNode=!0,l}else return n();else{if(this.outputCst){var l=this.CST_STACK[this.CST_STACK.length-1];l.recoveredNode=!0,o.partialCstResult=l}throw o}}else{if(i)return this.moveToTerminatedState(),n();throw o}}else throw e},r.prototype.optionInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(uf,t),i=this.nestedRuleBeforeClause(e,n);try{return this.optionInternalLogic(e,t,n)}finally{i!==void 0&&this.nestedRuleFinallyClause(n,i)}},r.prototype.optionInternalNoCst=function(e,t){var n=this.getKeyForAutomaticLookahead(uf,t);return this.optionInternalLogic(e,t,n)},r.prototype.optionInternalLogic=function(e,t,n){var i=this,s=this.getLaFuncFromCache(n),o,a;if(e.DEF!==void 0){if(o=e.DEF,a=e.GATE,a!==void 0){var l=s;s=function(){return a.call(i)&&l.call(i)}}}else o=e;if(s.call(this)===!0)return o.call(this)},r.prototype.atLeastOneInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(nc,e),i=this.nestedRuleBeforeClause(t,n);try{return this.atLeastOneInternalLogic(e,t,n)}finally{i!==void 0&&this.nestedRuleFinallyClause(n,i)}},r.prototype.atLeastOneInternalNoCst=function(e,t){var n=this.getKeyForAutomaticLookahead(nc,e);this.atLeastOneInternalLogic(e,t,n)},r.prototype.atLeastOneInternalLogic=function(e,t,n){var i=this,s=this.getLaFuncFromCache(n),o,a;if(t.DEF!==void 0){if(o=t.DEF,a=t.GATE,a!==void 0){var l=s;s=function(){return a.call(i)&&l.call(i)}}}else o=t;if(s.call(this)===!0)for(var u=this.doSingleRepetition(o);s.call(this)===!0&&u===!0;)u=this.doSingleRepetition(o);else throw this.raiseEarlyExitException(e,Sr.REPETITION_MANDATORY,t.ERR_MSG);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[e,t],s,nc,e,G5)},r.prototype.atLeastOneSepFirstInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(Dl,e),i=this.nestedRuleBeforeClause(t,n);try{this.atLeastOneSepFirstInternalLogic(e,t,n)}finally{i!==void 0&&this.nestedRuleFinallyClause(n,i)}},r.prototype.atLeastOneSepFirstInternalNoCst=function(e,t){var n=this.getKeyForAutomaticLookahead(Dl,e);this.atLeastOneSepFirstInternalLogic(e,t,n)},r.prototype.atLeastOneSepFirstInternalLogic=function(e,t,n){var i=this,s=t.DEF,o=t.SEP,a=this.getLaFuncFromCache(n);if(a.call(this)===!0){s.call(this);for(var l=function(){return i.tokenMatcher(i.LA(1),o)};this.tokenMatcher(this.LA(1),o)===!0;)this.CONSUME(o),s.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,o,l,s,_1],l,Dl,e,_1)}else throw this.raiseEarlyExitException(e,Sr.REPETITION_MANDATORY_WITH_SEPARATOR,t.ERR_MSG)},r.prototype.manyInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(rc,e),i=this.nestedRuleBeforeClause(t,n);try{return this.manyInternalLogic(e,t,n)}finally{i!==void 0&&this.nestedRuleFinallyClause(n,i)}},r.prototype.manyInternalNoCst=function(e,t){var n=this.getKeyForAutomaticLookahead(rc,e);return this.manyInternalLogic(e,t,n)},r.prototype.manyInternalLogic=function(e,t,n){var i=this,s=this.getLaFuncFromCache(n),o,a;if(t.DEF!==void 0){if(o=t.DEF,a=t.GATE,a!==void 0){var l=s;s=function(){return a.call(i)&&l.call(i)}}}else o=t;for(var u=!0;s.call(this)===!0&&u===!0;)u=this.doSingleRepetition(o);this.attemptInRepetitionRecovery(this.manyInternal,[e,t],s,rc,e,W5,u)},r.prototype.manySepFirstInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(ic,e),i=this.nestedRuleBeforeClause(t,n);try{this.manySepFirstInternalLogic(e,t,n)}finally{i!==void 0&&this.nestedRuleFinallyClause(n,i)}},r.prototype.manySepFirstInternalNoCst=function(e,t){var n=this.getKeyForAutomaticLookahead(ic,e);this.manySepFirstInternalLogic(e,t,n)},r.prototype.manySepFirstInternalLogic=function(e,t,n){var i=this,s=t.DEF,o=t.SEP,a=this.getLaFuncFromCache(n);if(a.call(this)===!0){s.call(this);for(var l=function(){return i.tokenMatcher(i.LA(1),o)};this.tokenMatcher(this.LA(1),o)===!0;)this.CONSUME(o),s.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,o,l,s,w1],l,ic,e,w1)}},r.prototype.repetitionSepSecondInternal=function(e,t,n,i,s){for(;n();)this.CONSUME(t),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,t,n,i,s],n,Dl,e,s)},r.prototype.doSingleRepetition=function(e){var t=this.getLexerPosition();e.call(this);var n=this.getLexerPosition();return n>t},r.prototype.orInternalNoCst=function(e,t){var n=is(e)?e:e.DEF,i=this.getKeyForAutomaticLookahead(ql,t),s=this.getLaFuncFromCache(i),o=s.call(this,n);if(o!==void 0){var a=n[o];return a.ALT.call(this)}this.raiseNoAltException(t,e.ERR_MSG)},r.prototype.orInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(ql,t),i=this.nestedRuleBeforeClause(e,n);try{var s=is(e)?e:e.DEF,o=this.getLaFuncFromCache(n),a=o.call(this,s);if(a!==void 0){var l=s[a],u=this.nestedAltBeforeClause(l,t,ql,a);try{return l.ALT.call(this)}finally{u!==void 0&&this.nestedRuleFinallyClause(u.shortName,u.nestedName)}}this.raiseNoAltException(t,e.ERR_MSG)}finally{i!==void 0&&this.nestedRuleFinallyClause(n,i)}},r.prototype.ruleFinallyStateUpdate=function(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),this.RULE_STACK.length===0&&this.isAtEndOfInput()===!1){var e=this.LA(1),t=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:e,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new BE(t,e))}},r.prototype.subruleInternal=function(e,t,n){var i;try{var s=n!==void 0?n.ARGS:void 0;return i=e.call(this,t,s),this.cstPostNonTerminal(i,n!==void 0&&n.LABEL!==void 0?n.LABEL:e.ruleName),i}catch(o){this.subruleInternalError(o,n,e.ruleName)}},r.prototype.subruleInternalError=function(e,t,n){throw cf(e)&&e.partialCstResult!==void 0&&(this.cstPostNonTerminal(e.partialCstResult,t!==void 0&&t.LABEL!==void 0?t.LABEL:n),delete e.partialCstResult),e},r.prototype.consumeInternal=function(e,t,n){var i;try{var s=this.LA(1);this.tokenMatcher(s,e)===!0?(this.consumeToken(),i=s):this.consumeInternalError(e,s,n)}catch(o){i=this.consumeInternalRecovery(e,t,o)}return this.cstPostTerminal(n!==void 0&&n.LABEL!==void 0?n.LABEL:e.name,i),i},r.prototype.consumeInternalError=function(e,t,n){var i,s=this.LA(0);throw n!==void 0&&n.ERR_MSG?i=n.ERR_MSG:i=this.errorMessageProvider.buildMismatchTokenMessage({expected:e,actual:t,previous:s,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new Oy(i,t,s))},r.prototype.consumeInternalRecovery=function(e,t,n){if(this.recoveryEnabled&&n.name==="MismatchedTokenException"&&!this.isBackTracking()){var i=this.getFollowsForInRuleRecovery(e,t);try{return this.tryInRuleRecovery(e,i)}catch(s){throw s.name===VE?n:s}}else throw n},r.prototype.saveRecogState=function(){var e=this.errors,t=hi(this.RULE_STACK);return{errors:e,lexerState:this.exportLexerState(),RULE_STACK:t,CST_STACK:this.CST_STACK,LAST_EXPLICIT_RULE_STACK:this.LAST_EXPLICIT_RULE_STACK}},r.prototype.reloadRecogState=function(e){this.errors=e.errors,this.importLexerState(e.lexerState),this.RULE_STACK=e.RULE_STACK},r.prototype.ruleInvocationStateUpdate=function(e,t,n){this.RULE_OCCURRENCE_STACK.push(n),this.RULE_STACK.push(e),this.cstInvocationStateUpdate(t,e)},r.prototype.isBackTracking=function(){return this.isBackTrackingStack.length!==0},r.prototype.getCurrRuleFullName=function(){var e=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[e]},r.prototype.shortRuleNameToFullName=function(e){return this.shortRuleNameToFull[e]},r.prototype.isAtEndOfInput=function(){return this.tokenMatcher(this.LA(1),Ja)},r.prototype.reset=function(){this.resetLexerState(),this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]},r})(),zM=(function(){function r(){}return r.prototype.initErrorHandler=function(e){this._errors=[],this.errorMessageProvider=kp(e.errorMessageProvider,ri.errorMessageProvider)},r.prototype.SAVE_ERROR=function(e){if(cf(e))return e.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:hi(this.RULE_OCCURRENCE_STACK)},this._errors.push(e),e;throw Error("Trying to save an Error which is not a RecognitionException")},Object.defineProperty(r.prototype,"errors",{get:function(){return hi(this._errors)},set:function(e){this._errors=e},enumerable:!0,configurable:!0}),r.prototype.raiseEarlyExitException=function(e,t,n){for(var i=this.getCurrRuleFullName(),s=this.getGAstProductions()[i],o=Ay(e,s,t,this.maxLookahead),a=o[0],l=[],u=1;u<=this.maxLookahead;u++)l.push(this.LA(u));var c=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:a,actual:l,previous:this.LA(0),customUserDescription:n,ruleName:i});throw this.SAVE_ERROR(new UE(c,this.LA(1),this.LA(0)))},r.prototype.raiseNoAltException=function(e,t){for(var n=this.getCurrRuleFullName(),i=this.getGAstProductions()[n],s=Ry(e,i,this.maxLookahead),o=[],a=1;a<=this.maxLookahead;a++)o.push(this.LA(a));var l=this.LA(0),u=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:s,actual:o,previous:l,customUserDescription:t,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new DE(u,this.LA(1),l))},r})(),HM=(function(){function r(){}return r.prototype.initContentAssist=function(){},r.prototype.computeContentAssist=function(e,t){var n=this.gastProductionsCache[e];if(zi(n))throw Error("Rule ->"+e+"<- does not exist in this grammar.");return EE([n],t,this.tokenMatcher,this.maxLookahead)},r.prototype.getNextPossibleTokenTypes=function(e){var t=$i(e.ruleStack),n=this.getGAstProductions(),i=n[t],s=new H5(i,e).startWalking();return s},r})(),Up={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(Up);var S1=!0,T1=Math.pow(2,ba)-1,zE=Gt({name:"RECORDING_PHASE_TOKEN",pattern:li.NA});eh([zE]);var HE=Sy(zE,`This IToken indicates the Parser is in Recording Phase
	See: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details`,-1,-1,-1,-1,-1,-1);Object.freeze(HE);var WM={name:`This CSTNode indicates the Parser is in Recording Phase
	See: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details`,children:{}},GM=(function(){function r(){}return r.prototype.initGastRecorder=function(e){this.recordingProdStack=[],this.RECORDING_PHASE=!1},r.prototype.enableRecording=function(){var e=this;this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",function(){for(var t=function(i){var s=i>0?i:"";e["CONSUME"+s]=function(o,a){return this.consumeInternalRecord(o,i,a)},e["SUBRULE"+s]=function(o,a){return this.subruleInternalRecord(o,i,a)},e["OPTION"+s]=function(o){return this.optionInternalRecord(o,i)},e["OR"+s]=function(o){return this.orInternalRecord(o,i)},e["MANY"+s]=function(o){this.manyInternalRecord(i,o)},e["MANY_SEP"+s]=function(o){this.manySepFirstInternalRecord(i,o)},e["AT_LEAST_ONE"+s]=function(o){this.atLeastOneInternalRecord(i,o)},e["AT_LEAST_ONE_SEP"+s]=function(o){this.atLeastOneSepFirstInternalRecord(i,o)}},n=0;n<10;n++)t(n);e.consume=function(i,s,o){return this.consumeInternalRecord(s,i,o)},e.subrule=function(i,s,o){return this.subruleInternalRecord(s,i,o)},e.option=function(i,s){return this.optionInternalRecord(s,i)},e.or=function(i,s){return this.orInternalRecord(s,i)},e.many=function(i,s){this.manyInternalRecord(i,s)},e.atLeastOne=function(i,s){this.atLeastOneInternalRecord(i,s)},e.ACTION=e.ACTION_RECORD,e.BACKTRACK=e.BACKTRACK_RECORD,e.LA=e.LA_RECORD})},r.prototype.disableRecording=function(){var e=this;this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",function(){for(var t=0;t<10;t++){var n=t>0?t:"";delete e["CONSUME"+n],delete e["SUBRULE"+n],delete e["OPTION"+n],delete e["OR"+n],delete e["MANY"+n],delete e["MANY_SEP"+n],delete e["AT_LEAST_ONE"+n],delete e["AT_LEAST_ONE_SEP"+n]}delete e.consume,delete e.subrule,delete e.option,delete e.or,delete e.many,delete e.atLeastOne,delete e.ACTION,delete e.BACKTRACK,delete e.LA})},r.prototype.ACTION_RECORD=function(e){},r.prototype.BACKTRACK_RECORD=function(e,t){return function(){return!0}},r.prototype.LA_RECORD=function(e){return ff},r.prototype.topLevelRuleRecord=function(e,t){try{var n=new yu({definition:[],name:e});return n.name=e,this.recordingProdStack.push(n),t.call(this),this.recordingProdStack.pop(),n}catch(i){if(i.KNOWN_RECORDER_ERROR!==!0)try{i.message=i.message+`
	 This error was thrown during the "grammar recording phase" For more info see:
	https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording`}catch{throw i}throw i}},r.prototype.optionInternalRecord=function(e,t){return Au.call(this,Sn,e,t)},r.prototype.atLeastOneInternalRecord=function(e,t){Au.call(this,Hi,t,e)},r.prototype.atLeastOneSepFirstInternalRecord=function(e,t){Au.call(this,Wi,t,e,S1)},r.prototype.manyInternalRecord=function(e,t){Au.call(this,Yr,t,e)},r.prototype.manySepFirstInternalRecord=function(e,t){Au.call(this,Ci,t,e,S1)},r.prototype.orInternalRecord=function(e,t){return qM.call(this,e,t)},r.prototype.subruleInternalRecord=function(e,t,n){if(df(t),!e||lt(e,"ruleName")===!1){var i=new Error("<SUBRULE"+R1(t)+"> argument is invalid"+(" expecting a Parser method reference but got: <"+JSON.stringify(e)+">")+(`
 inside top level rule: <`+this.recordingProdStack[0].name+">"));throw i.KNOWN_RECORDER_ERROR=!0,i}var s=sf(this.recordingProdStack),o=e.ruleName,a=new Ai({idx:t,nonTerminalName:o,referencedRule:void 0});return s.definition.push(a),this.outputCst?WM:Up},r.prototype.consumeInternalRecord=function(e,t,n){if(df(t),!bE(e)){var i=new Error("<CONSUME"+R1(t)+"> argument is invalid"+(" expecting a TokenType reference but got: <"+JSON.stringify(e)+">")+(`
 inside top level rule: <`+this.recordingProdStack[0].name+">"));throw i.KNOWN_RECORDER_ERROR=!0,i}var s=sf(this.recordingProdStack),o=new Pr({idx:t,terminalType:e});return s.definition.push(o),HE},r})();function Au(r,e,t,n){n===void 0&&(n=!1),df(t);var i=sf(this.recordingProdStack),s=va(e)?e:e.DEF,o=new r({definition:[],idx:t});return lt(e,"NAME")&&(o.name=e.NAME),n&&(o.separator=e.SEP),lt(e,"MAX_LOOKAHEAD")&&(o.maxLookahead=e.MAX_LOOKAHEAD),this.recordingProdStack.push(o),s.call(this),i.definition.push(o),this.recordingProdStack.pop(),Up}function qM(r,e){var t=this;df(e);var n=sf(this.recordingProdStack),i=is(r)===!1,s=i===!1?r:r.DEF,o=new Ni({definition:[],idx:e,ignoreAmbiguities:i&&r.IGNORE_AMBIGUITIES===!0});lt(r,"NAME")&&(o.name=r.NAME),lt(r,"MAX_LOOKAHEAD")&&(o.maxLookahead=r.MAX_LOOKAHEAD);var a=oE(s,function(l){return va(l.GATE)});return o.hasPredicates=a,n.definition.push(o),ut(s,function(l){var u=new di({definition:[]});o.definition.push(u),lt(l,"NAME")&&(u.name=l.NAME),lt(l,"IGNORE_AMBIGUITIES")?u.ignoreAmbiguities=l.IGNORE_AMBIGUITIES:lt(l,"GATE")&&(u.ignoreAmbiguities=!0),t.recordingProdStack.push(u),l.ALT.call(t),t.recordingProdStack.pop()}),Up}function R1(r){return r===0?"":""+r}function df(r){if(r<0||r>T1){var e=new Error("Invalid DSL Method idx value: <"+r+`>
	`+("Idx value must be a none negative value smaller than "+(T1+1)));throw e.KNOWN_RECORDER_ERROR=!0,e}}var YM=(function(){function r(){}return r.prototype.initPerformanceTracer=function(e){if(lt(e,"traceInitPerf")){var t=e.traceInitPerf,n=typeof t=="number";this.traceInitMaxIdent=n?t:1/0,this.traceInitPerf=n?t>0:t}else this.traceInitMaxIdent=0,this.traceInitPerf=ri.traceInitPerf;this.traceInitIndent=-1},r.prototype.TRACE_INIT=function(e,t){if(this.traceInitPerf===!0){this.traceInitIndent++;var n=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(n+"--> <"+e+">");var i=uE(t),s=i.time,o=i.value,a=s>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&a(n+"<-- <"+e+"> time: "+s+"ms"),this.traceInitIndent--,o}else return t()},r})(),WE=(function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}})(),ff=Sy(Ja,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(ff);var ri=Object.freeze({recoveryEnabled:!1,maxLookahead:4,ignoredIssues:{},dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:OE,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),pf=Object.freeze({recoveryValueFunc:function(){},resyncEnabled:!0}),gn;(function(r){r[r.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",r[r.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",r[r.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",r[r.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",r[r.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",r[r.LEFT_RECURSION=5]="LEFT_RECURSION",r[r.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",r[r.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",r[r.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",r[r.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",r[r.INVALID_NESTED_RULE_NAME=10]="INVALID_NESTED_RULE_NAME",r[r.DUPLICATE_NESTED_NAME=11]="DUPLICATE_NESTED_NAME",r[r.NO_NON_EMPTY_LOOKAHEAD=12]="NO_NON_EMPTY_LOOKAHEAD",r[r.AMBIGUOUS_PREFIX_ALTS=13]="AMBIGUOUS_PREFIX_ALTS",r[r.TOO_MANY_ALTS=14]="TOO_MANY_ALTS"})(gn||(gn={}));function XM(r){return r===void 0&&(r=void 0),function(){return r}}var Iy=(function(){function r(e,t){t===void 0&&(t=ri),this.ignoredIssues=ri.ignoredIssues,this.definitionErrors=[],this.selfAnalysisDone=!1;var n=this;n.initErrorHandler(t),n.initLexerAdapter(),n.initLooksAhead(t),n.initRecognizerEngine(e,t),n.initRecoverable(t),n.initTreeBuilder(t),n.initContentAssist(),n.initGastRecorder(t),n.initPerformanceTracer(t),lt(t,"ignoredIssues")&&t.ignoredIssues!==ri.ignoredIssues&&xy(`The <ignoredIssues> IParserConfig property is soft-deprecated and will be removed in future versions.
	Please use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.`),this.ignoredIssues=lt(t,"ignoredIssues")?t.ignoredIssues:ri.ignoredIssues,this.skipValidations=lt(t,"skipValidations")?t.skipValidations:ri.skipValidations}return r.performSelfAnalysis=function(e){e.performSelfAnalysis()},r.prototype.performSelfAnalysis=function(){var e=this;this.TRACE_INIT("performSelfAnalysis",function(){var t;e.selfAnalysisDone=!0;var n=e.className;e.TRACE_INIT("toFastProps",function(){lE(e)}),e.TRACE_INIT("Grammar Recording",function(){try{e.enableRecording(),ut(e.definedRulesNames,function(s){var o=e[s],a=o.originalGrammarAction,l=void 0;e.TRACE_INIT(s+" Rule",function(){l=e.topLevelRuleRecord(s,a)}),e.gastProductionsCache[s]=l})}finally{e.disableRecording()}});var i=[];if(e.TRACE_INIT("Grammar Resolving",function(){i=TM({rules:jn(e.gastProductionsCache)}),e.definitionErrors.push.apply(e.definitionErrors,i)}),e.TRACE_INIT("Grammar Validations",function(){if(wr(i)&&e.skipValidations===!1){var s=RM({rules:jn(e.gastProductionsCache),maxLookahead:e.maxLookahead,tokenTypes:jn(e.tokensMap),ignoredIssues:e.ignoredIssues,errMsgProvider:My,grammarName:n});e.definitionErrors.push.apply(e.definitionErrors,s)}}),wr(e.definitionErrors)&&(e.recoveryEnabled&&e.TRACE_INIT("computeAllProdsFollows",function(){var s=F5(jn(e.gastProductionsCache));e.resyncFollows=s}),e.TRACE_INIT("ComputeLookaheadFunctions",function(){e.preComputeLookaheadFunctions(jn(e.gastProductionsCache))})),e.TRACE_INIT("expandAllNestedRuleNames",function(){var s=$5(jn(e.gastProductionsCache),e.fullRuleNameToShort);e.allRuleNames=s.allRuleNames}),!r.DEFER_DEFINITION_ERRORS_HANDLING&&!wr(e.definitionErrors))throw t=Xe(e.definitionErrors,function(s){return s.message}),new Error(`Parser Definition Errors detected:
 `+t.join(`
-------------------------------
`))})},r.DEFER_DEFINITION_ERRORS_HANDLING=!1,r})();FN(Iy,[AM,NM,UM,VM,$M,jM,zM,HM,GM,YM]);(function(r){WE(e,r);function e(t,n){n===void 0&&(n=ri);var i=this,s=Zc(n);return s.outputCst=!0,i=r.call(this,t,s)||this,i}return e})(Iy);var KM=(function(r){WE(e,r);function e(t,n){n===void 0&&(n=ri);var i=this,s=Zc(n);return s.outputCst=!1,i=r.call(this,t,s)||this,i}return e})(Iy);const A1=(r,e)=>({type:r,message:e});var Vr;(function(r){r.LexingError="LexingError",r.ParserError="ParsingError",r.StaticOffsetError="StaticOffsetError",r.StaticOffsetOutOfRangeError="StaticOffsetOutOfRangeError",r.RangeOffsetNotAllowed="RangeOffsetNotAllowed",r.InvalidRangeSize="InvalidRangeSize"})(Vr||(Vr={}));var oe;(function(r){r.EMPTY="EMPTY",r.NUMBER="NUMBER",r.STRING="STRING",r.MINUS_UNARY_OP="MINUS_UNARY_OP",r.PLUS_UNARY_OP="PLUS_UNARY_OP",r.PERCENT_OP="PERCENT_OP",r.CONCATENATE_OP="CONCATENATE_OP",r.EQUALS_OP="EQUALS_OP",r.NOT_EQUAL_OP="NOT_EQUAL_OP",r.GREATER_THAN_OP="GREATER_THAN_OP",r.LESS_THAN_OP="LESS_THAN_OP",r.GREATER_THAN_OR_EQUAL_OP="GREATER_THAN_OR_EQUAL_OP",r.LESS_THAN_OR_EQUAL_OP="LESS_THAN_OR_EQUAL_OP",r.PLUS_OP="PLUS_OP",r.MINUS_OP="MINUS_OP",r.TIMES_OP="TIMES_OP",r.DIV_OP="DIV_OP",r.POWER_OP="POWER_OP",r.FUNCTION_CALL="FUNCTION_CALL",r.NAMED_EXPRESSION="NAMED_EXPRESSION",r.PARENTHESIS="PARENTHESES",r.CELL_REFERENCE="CELL_REFERENCE",r.CELL_RANGE="CELL_RANGE",r.COLUMN_RANGE="COLUMN_RANGE",r.ROW_RANGE="ROW_RANGE",r.ERROR="ERROR",r.ERROR_WITH_RAW_INPUT="ERROR_WITH_RAW_INPUT",r.ARRAY="ARRAY"})(oe||(oe={}));var wi;(function(r){r[r.RELATIVE=0]="RELATIVE",r[r.START_ABSOLUTE=1]="START_ABSOLUTE",r[r.BOTH_ABSOLUTE=2]="BOTH_ABSOLUTE"})(wi||(wi={}));const ZM=r=>({type:oe.EMPTY,leadingWhitespace:r?.image}),QM=(r,e)=>({type:oe.NUMBER,value:r,leadingWhitespace:e?.image}),JM=r=>{var e;return{type:oe.STRING,value:r.image.slice(1,-1),leadingWhitespace:(e=r.leadingWhitespace)===null||e===void 0?void 0:e.image}},C1=(r,e)=>({type:oe.CELL_REFERENCE,reference:r,leadingWhitespace:e?.image}),N1=(r,e,t,n)=>(ky(r,e,t),{type:oe.CELL_RANGE,start:r,end:e,sheetReferenceType:t,leadingWhitespace:n}),e8=(r,e,t,n)=>(ky(r,e,t),{type:oe.COLUMN_RANGE,start:r,end:e,sheetReferenceType:t,leadingWhitespace:n?.image}),t8=(r,e,t,n)=>(ky(r,e,t),{type:oe.ROW_RANGE,start:r,end:e,sheetReferenceType:t,leadingWhitespace:n?.image}),r8=(r,e,t)=>({type:oe.CONCATENATE_OP,left:r,right:e,leadingWhitespace:t?.image}),n8=(r,e,t)=>({type:oe.EQUALS_OP,left:r,right:e,leadingWhitespace:t?.image}),i8=(r,e,t)=>({type:oe.NOT_EQUAL_OP,left:r,right:e,leadingWhitespace:t?.image}),s8=(r,e,t)=>({type:oe.GREATER_THAN_OP,left:r,right:e,leadingWhitespace:t?.image}),o8=(r,e,t)=>({type:oe.LESS_THAN_OP,left:r,right:e,leadingWhitespace:t?.image}),a8=(r,e,t)=>({type:oe.GREATER_THAN_OR_EQUAL_OP,left:r,right:e,leadingWhitespace:t?.image}),l8=(r,e,t)=>({type:oe.LESS_THAN_OR_EQUAL_OP,left:r,right:e,leadingWhitespace:t?.image}),u8=(r,e,t)=>({type:oe.PLUS_OP,left:r,right:e,leadingWhitespace:t?.image}),c8=(r,e,t)=>({type:oe.MINUS_OP,left:r,right:e,leadingWhitespace:t?.image}),h8=(r,e,t)=>({type:oe.TIMES_OP,left:r,right:e,leadingWhitespace:t?.image}),d8=(r,e,t)=>({type:oe.DIV_OP,left:r,right:e,leadingWhitespace:t?.image}),f8=(r,e,t)=>({type:oe.POWER_OP,left:r,right:e,leadingWhitespace:t?.image}),p8=(r,e)=>({type:oe.MINUS_UNARY_OP,value:r,leadingWhitespace:e?.image}),m8=(r,e)=>({type:oe.PLUS_UNARY_OP,value:r,leadingWhitespace:e?.image}),g8=(r,e)=>({type:oe.PERCENT_OP,value:r,leadingWhitespace:e?.image}),y8=(r,e,t,n,i)=>({type:oe.FUNCTION_CALL,procedureName:r,args:e,leadingWhitespace:t?.image,internalWhitespace:n?.image,hyperlink:i}),M1=(r,e,t)=>({type:oe.ARRAY,args:r,leadingWhitespace:e?.image,internalWhitespace:t?.image}),v8=(r,e)=>({type:oe.NAMED_EXPRESSION,expressionName:r,leadingWhitespace:e?.image}),b8=(r,e,t)=>({type:oe.PARENTHESIS,expression:r,leadingWhitespace:e?.image,internalWhitespace:t?.image}),As=(r,e)=>({type:oe.ERROR,error:r,leadingWhitespace:e?.image}),xl=(r,e,t)=>({type:oe.ERROR_WITH_RAW_INPUT,error:e,rawInput:r,leadingWhitespace:t?.image}),Mg=()=>({type:oe.ERROR,error:J.parsingError()});function ky(r,e,t){if(r.sheet!==void 0&&e.sheet===void 0||r.sheet===void 0&&e.sheet!==void 0)throw new Error("Start address inconsistent with end address");if(r.sheet===void 0&&t!==wi.RELATIVE||r.sheet!==void 0&&t===wi.RELATIVE)throw new Error("Sheet address inconsistent with sheet reference type")}function Xt(r,e){return(e??"")+r}const GE={[oe.PLUS_OP]:"+",[oe.MINUS_OP]:"-",[oe.TIMES_OP]:"*",[oe.DIV_OP]:"/",[oe.CONCATENATE_OP]:"&",[oe.POWER_OP]:"^",[oe.EQUALS_OP]:"=",[oe.NOT_EQUAL_OP]:"<>",[oe.GREATER_THAN_OP]:">",[oe.GREATER_THAN_OR_EQUAL_OP]:">=",[oe.LESS_THAN_OP]:"<",[oe.LESS_THAN_OR_EQUAL_OP]:"<="};const w8=(r,e,t,n)=>({ast:r,relativeDependencies:e,hasVolatileFunction:t,hasStructuralChangeFunction:n});class _8{constructor(e){this.functionRegistry=e,this.cache=new Map}set(e,t){const n=jp(t,this.functionRegistry),i=w8(t,n,Xo(t,this.functionRegistry.isFunctionVolatile),Xo(t,this.functionRegistry.isFunctionDependentOnSheetStructureChange));return this.cache.set(e,i),i}get(e){return this.cache.get(e)}maybeSetAndThenGet(e,t){const n=this.cache.get(e);return n!==void 0?n.ast:(this.set(e,t),t)}}const Xo=(r,e)=>{switch(r.type){case oe.EMPTY:case oe.NUMBER:case oe.STRING:case oe.ERROR:case oe.ERROR_WITH_RAW_INPUT:case oe.CELL_REFERENCE:case oe.CELL_RANGE:case oe.COLUMN_RANGE:case oe.ROW_RANGE:case oe.NAMED_EXPRESSION:return!1;case oe.PERCENT_OP:case oe.PLUS_UNARY_OP:case oe.MINUS_UNARY_OP:return Xo(r.value,e);case oe.CONCATENATE_OP:case oe.EQUALS_OP:case oe.NOT_EQUAL_OP:case oe.LESS_THAN_OP:case oe.GREATER_THAN_OP:case oe.LESS_THAN_OR_EQUAL_OP:case oe.GREATER_THAN_OR_EQUAL_OP:case oe.MINUS_OP:case oe.PLUS_OP:case oe.TIMES_OP:case oe.DIV_OP:case oe.POWER_OP:return Xo(r.left,e)||Xo(r.right,e);case oe.PARENTHESIS:return Xo(r.expression,e);case oe.FUNCTION_CALL:return e(r.procedureName)?!0:r.args.some(t=>Xo(t,e));case oe.ARRAY:return r.args.some(t=>t.some(n=>Xo(n,e)))}};class ue{}ue.DistinctSigns="Distinct signs.";ue.WrongArgNumber="Wrong number of arguments.";ue.EmptyArg="Empty function argument.";ue.EmptyArray="Empty array not allowed.";ue.ArrayDimensions="Array dimensions are not compatible.";ue.NoSpaceForArrayResult="No space for array result.";ue.ValueSmall="Value too small.";ue.ValueLarge="Value too large.";ue.BadCriterion="Incorrect criterion.";ue.RangeManySheets="Range spans more than one sheet.";ue.CellRangeExpected="Cell range expected.";ue.WrongDimension="Wrong range dimension.";ue.ScalarExpected="Cell range not allowed.";ue.NumberCoercion="Value cannot be coerced to number.";ue.NumberExpected="Number argument expected.";ue.IntegerExpected="Value needs to be an integer.";ue.BadMode="Mode not recognized.";ue.DateBounds="Date outside of bounds.";ue.OutOfSheet="Resulting reference is out of the sheet.";ue.WrongType="Wrong type of argument.";ue.NaN="NaN or infinite value encountered.";ue.EqualLength="Ranges need to be of equal length.";ue.Negative="Value cannot be negative.";ue.NotBinary="String does not represent a binary number.";ue.NotOctal="String does not represent an octal number.";ue.NotHex="String does not represent a hexadecimal number.";ue.EndStartPeriod="End period needs to be at least start period.";ue.CellRefExpected="Cell reference expected.";ue.EmptyRange="Empty range not allowed.";ue.BadRef="Address is not correct.";ue.NumberRange="Number-only range expected.";ue.ValueNotFound="Value not found.";ue.ValueBaseLarge="Value in base too large.";ue.ValueBaseSmall="Value in base too small.";ue.ValueBaseLong="Value in base too long.";ue.NegativeLength="Length cannot be negative.";ue.PatternNotFound="Pattern not found.";ue.OneValue="Needs at least one value.";ue.TwoValues="Range needs to contain at least two elements.";ue.ThreeValues="Range needs to contain at least three elements.";ue.IndexBounds="Index out of bounds.";ue.IndexLarge="Index too large.";ue.Formula="Expected formula.";ue.NegativeCount="Count cannot be negative.";ue.ParseError="Parsing error.";ue.SheetRef="Sheet does not exist.";ue.PeriodLong="Period number cannot exceed life length.";ue.InvalidDate="Invalid date.";ue.BitshiftLong="Result of bitshift is too long.";ue.EmptyString="Empty-string argument not allowed.";ue.LengthBounds="Length out of bounds.";ue.NegativeTime="Time cannot be negative.";ue.NoDefault="No default option.";ue.NoConditionMet="None of the conditions were met.";ue.Selector="Selector cannot exceed the number of arguments.";ue.StartEndDate="Start date needs to be earlier than end date.";ue.IncorrectDateTime="String does not represent correct DateTime.";ue.CharacterCodeBounds="Character code out of bounds.";ue.NonZero="Argument cannot be 0.";ue.LessThanOne="Argument cannot be less than 1.";ue.WeekendString="Incorrect weekend bitmask string.";ue.InvalidRoman="Invalid roman numeral.";ue.WrongOrder="Wrong order of values.";ue.ComplexNumberExpected="Complex number expected.";ue.ShouldBeIorJ="Should be 'i' or 'j'.";ue.SizeMismatch="Array dimensions mismatched.";ue.FunctionName=r=>`Function name ${r} not recognized.`;ue.NamedExpressionName=r=>`Named expression ${r} not recognized.`;ue.LicenseKey=r=>`License key is ${r}.`;class x8{constructor(){this.POSSIBLE_START_CHARACTERS=[...rE,...SN,Zn,"'","_"],this.cellReferenceRegexp=new RegExp(EN,"y")}match(e,t){this.cellReferenceRegexp.lastIndex=t;const n=this.cellReferenceRegexp.exec(e+"@");return n==null||n[1]==null?null:(n[0]=n[1],n)}}class E8{constructor(){this.POSSIBLE_START_CHARACTERS=[...rE,"_"],this.namedExpressionRegexp=new RegExp(tE,"y"),this.r1c1CellRefRegexp=new RegExp(`^${eE}$`)}match(e,t){this.namedExpressionRegexp.lastIndex=t;const n=this.namedExpressionRegexp.exec(e);return n==null||n[0]==null||this.r1c1CellRefRegexp.test(n[0])?null:n}}const Rc=Gt({name:"AdditionOp",pattern:li.NA}),Og=Gt({name:"PlusOp",pattern:/\+/,categories:Rc}),Ig=Gt({name:"MinusOp",pattern:/-/,categories:Rc}),Vp=Gt({name:"MultiplicationOp",pattern:li.NA}),qE=Gt({name:"TimesOp",pattern:/\*/,categories:Vp}),YE=Gt({name:"DivOp",pattern:/\//,categories:Vp}),kg=Gt({name:"PowerOp",pattern:/\^/}),XE=Gt({name:"PercentOp",pattern:/%/}),wa=Gt({name:"BooleanOp",pattern:li.NA}),Pg=Gt({name:"EqualsOp",pattern:/=/,categories:wa}),KE=Gt({name:"NotEqualOp",pattern:/<>/,categories:wa}),ZE=Gt({name:"GreaterThanOp",pattern:/>/,categories:wa}),QE=Gt({name:"LessThanOp",pattern:/</,categories:wa}),JE=Gt({name:"GreaterThanOrEqualOp",pattern:/>=/,categories:wa}),eS=Gt({name:"LessThanOrEqualOp",pattern:/<=/,categories:wa}),tS=Gt({name:"ConcatenateOp",pattern:/&/}),Fg=Gt({name:"LParen",pattern:/\(/}),yd=Gt({name:"RParen",pattern:/\)/}),rS=Gt({name:"ArrayLParen",pattern:/{/}),nS=Gt({name:"ArrayRParen",pattern:/}/}),iS=Gt({name:"StringLiteral",pattern:/"([^"\\]*(\\.[^"\\]*)*)"/}),sS=Gt({name:"ErrorLiteral",pattern:/#[A-Za-z0-9\/]+[?!]?/}),Ac=Gt({name:"RangeSeparator",pattern:new RegExp(Kc)}),Py=Gt({name:"ColumnRange",pattern:new RegExp(`${Zb}${Kc}${Zb}`)}),Fy=Gt({name:"RowRange",pattern:new RegExp(`${Qb}${Kc}${Qb}`)}),Ly=Gt({name:"ProcedureName",pattern:new RegExp(`([${Cp}][${vy}]*)\\(`)}),Nm=new x8,ra=Gt({name:"CellReference",pattern:Nm.match.bind(Nm),start_chars_hint:Nm.POSSIBLE_START_CHARACTERS,line_breaks:!1}),Mm=new E8,oS=Gt({name:"NamedExpression",pattern:Mm.match.bind(Mm),start_chars_hint:Mm.POSSIBLE_START_CHARACTERS,line_breaks:!1}),S8=r=>{const e=r.translationPackage.getFunctionTranslation("OFFSET"),t=r.errorMapping,n=r.translationPackage.buildFunctionMapping(),i=new RegExp(r.ignoreWhiteSpace==="standard"?_N:wN),s=Gt({name:"WhiteSpace",pattern:i}),o=Gt({name:"ArrayRowSep",pattern:r.arrayRowSeparator}),a=Gt({name:"ArrayColSep",pattern:r.arrayColumnSeparator}),l=Gt({name:"NumberLiteral",pattern:new RegExp(`(([${r.decimalSeparator}]\\d+)|(\\d+([${r.decimalSeparator}]\\d*)?))(e[+-]?\\d+)?`)}),u=Gt({name:"OffsetProcedureName",pattern:new RegExp(e,"i")});let c,d;r.functionArgSeparator===r.arrayColumnSeparator?(c=a,d=[]):r.functionArgSeparator===r.arrayRowSeparator?(c=o,d=[]):(c=Gt({name:"ArgSeparator",pattern:r.functionArgSeparator}),d=[c]);const h=[s,Og,Ig,qE,YE,kg,Pg,KE,XE,JE,eS,ZE,QE,Fg,yd,rS,nS,u,Ly,Ac,...d,Py,Fy,l,iS,sS,tS,wa,Rc,Vp,ra,oS,o,a];return{ArgSeparator:c,NumberLiteral:l,OffsetProcedureName:u,ArrayRowSeparator:o,ArrayColSeparator:a,WhiteSpace:s,allTokens:h,errorMapping:t,functionMapping:n,decimalSeparator:r.decimalSeparator,maxColumns:r.maxColumns,maxRows:r.maxRows}};class Bl extends KM{constructor(e,t){super(e.allTokens,{outputCst:!1,maxLookahead:7}),this.resolveSheetReference=t,this.booleanExpressionOrEmpty=this.RULE("booleanExpressionOrEmpty",()=>this.OR([{ALT:()=>this.SUBRULE(this.booleanExpression)},{ALT:XM(ZM())}])),this.procedureExpression=this.RULE("procedureExpression",()=>{var n;const i=this.CONSUME(Ly),s=i.image.toUpperCase().slice(0,-1),o=(n=this.lexerConfig.functionMapping[s])!==null&&n!==void 0?n:s,a=[];let l=this.SUBRULE(this.booleanExpressionOrEmpty);this.MANY(()=>{var c;const d=this.CONSUME(this.lexerConfig.ArgSeparator);l.type===oe.EMPTY&&(l.leadingWhitespace=(c=d.leadingWhitespace)===null||c===void 0?void 0:c.image),a.push(l),l=this.SUBRULE2(this.booleanExpressionOrEmpty)}),a.push(l),a.length===1&&a[0].type===oe.EMPTY&&(a.length=0);const u=this.CONSUME(yd);return y8(o,a,i.leadingWhitespace,u.leadingWhitespace)}),this.namedExpressionExpression=this.RULE("namedExpressionExpression",()=>{const n=this.CONSUME(oS);return v8(n.image,n.leadingWhitespace)}),this.offsetProcedureExpression=this.RULE("offsetProcedureExpression",()=>{const n=[];return this.CONSUME(this.lexerConfig.OffsetProcedureName),this.CONSUME(Fg),this.MANY_SEP({SEP:this.lexerConfig.ArgSeparator,DEF:()=>{n.push(this.SUBRULE(this.booleanExpression))}}),this.CONSUME(yd),this.handleOffsetHeuristic(n)}),this.columnRangeExpression=this.RULE("columnRangeExpression",()=>{const n=this.CONSUME(Py),[i,s]=n.image.split(":"),o=this.ACTION(()=>tf(i,this.formulaAddress,this.resolveSheetReference)),a=this.ACTION(()=>tf(s,this.formulaAddress,this.resolveSheetReference));if(o===void 0||a===void 0)return As(new J(te.REF));if(o.exceedsSheetSizeLimits(this.lexerConfig.maxColumns)||a.exceedsSheetSizeLimits(this.lexerConfig.maxColumns))return xl(n.image,new J(te.NAME),n.leadingWhitespace);if(o.sheet===void 0&&a.sheet!==void 0)return this.parsingError(Vr.ParserError,"Malformed range expression");const{firstEnd:l,secondEnd:u,sheetRefType:c}=Bl.fixSheetIdsForRangeEnds(o,a);return e8(l,u,c,n.leadingWhitespace)}),this.rowRangeExpression=this.RULE("rowRangeExpression",()=>{const n=this.CONSUME(Fy),[i,s]=n.image.split(":"),o=this.ACTION(()=>rf(i,this.formulaAddress,this.resolveSheetReference)),a=this.ACTION(()=>rf(s,this.formulaAddress,this.resolveSheetReference));if(o===void 0||a===void 0)return As(new J(te.REF));if(o.exceedsSheetSizeLimits(this.lexerConfig.maxRows)||a.exceedsSheetSizeLimits(this.lexerConfig.maxRows))return xl(n.image,new J(te.NAME),n.leadingWhitespace);if(o.sheet===void 0&&a.sheet!==void 0)return this.parsingError(Vr.ParserError,"Malformed range expression");const{firstEnd:l,secondEnd:u,sheetRefType:c}=Bl.fixSheetIdsForRangeEnds(o,a);return t8(l,u,c,n.leadingWhitespace)}),this.cellReference=this.RULE("cellReference",()=>{const n=this.CONSUME(ra),i=this.ACTION(()=>Ol(n.image,this.formulaAddress,this.resolveSheetReference));return i===void 0?xl(n.image,new J(te.REF),n.leadingWhitespace):i.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)?xl(n.image,new J(te.NAME),n.leadingWhitespace):C1(i,n.leadingWhitespace)}),this.endRangeReference=this.RULE("endRangeReference",n=>{var i;const s=this.CONSUME(ra),o=this.ACTION(()=>Ol(n.image,this.formulaAddress,this.resolveSheetReference)),a=this.ACTION(()=>Ol(s.image,this.formulaAddress,this.resolveSheetReference));return o===void 0||a===void 0?this.ACTION(()=>xl(`${n.image}:${s.image}`,new J(te.REF),n.leadingWhitespace)):o.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)||a.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)?this.ACTION(()=>xl(`${n.image}:${s.image}`,new J(te.NAME),n.leadingWhitespace)):this.buildCellRange(o,a,(i=n.leadingWhitespace)===null||i===void 0?void 0:i.image)}),this.endOfRangeExpression=this.RULE("endOfRangeExpression",n=>this.OR([{ALT:()=>this.SUBRULE(this.endRangeReference,{ARGS:[n]})},{ALT:()=>{var i;const s=this.SUBRULE(this.offsetProcedureExpression),o=this.ACTION(()=>Ol(n.image,this.formulaAddress,this.resolveSheetReference));return o===void 0?As(new J(te.REF)):s.type===oe.CELL_REFERENCE?this.buildCellRange(o,s.reference,(i=n.leadingWhitespace)===null||i===void 0?void 0:i.image):this.parsingError(Vr.RangeOffsetNotAllowed,"Range offset not allowed here")}}])),this.cellRangeExpression=this.RULE("cellRangeExpression",()=>{const n=this.CONSUME(ra);return this.CONSUME2(Ac),this.SUBRULE(this.endOfRangeExpression,{ARGS:[n]})}),this.endRangeWithOffsetStartReference=this.RULE("endRangeWithOffsetStartReference",n=>{const i=this.CONSUME(ra),s=this.ACTION(()=>Ol(i.image,this.formulaAddress,this.resolveSheetReference));return s===void 0?this.ACTION(()=>As(new J(te.REF))):this.buildCellRange(n.reference,s,n.leadingWhitespace)}),this.endOfRangeWithOffsetStartExpression=this.RULE("endOfRangeWithOffsetStartExpression",n=>this.OR([{ALT:()=>this.SUBRULE(this.endRangeWithOffsetStartReference,{ARGS:[n]})},{ALT:()=>{const i=this.SUBRULE(this.offsetProcedureExpression);return i.type===oe.CELL_REFERENCE?this.buildCellRange(n.reference,i.reference,n.leadingWhitespace):this.parsingError(Vr.RangeOffsetNotAllowed,"Range offset not allowed here")}}])),this.offsetExpression=this.RULE("offsetExpression",()=>{const n=this.SUBRULE(this.offsetProcedureExpression);let i;return this.OPTION(()=>{this.CONSUME(Ac),n.type===oe.CELL_RANGE?i=this.parsingError(Vr.RangeOffsetNotAllowed,"Range offset not allowed here"):i=this.SUBRULE(this.endOfRangeWithOffsetStartExpression,{ARGS:[n]})}),i!==void 0?i:n}),this.insideArrayExpression=this.RULE("insideArrayExpression",()=>{const n=[[]];return n[n.length-1].push(this.SUBRULE(this.booleanExpression)),this.MANY(()=>{this.OR([{ALT:()=>{this.CONSUME(this.lexerConfig.ArrayColSeparator),n[n.length-1].push(this.SUBRULE2(this.booleanExpression))}},{ALT:()=>{this.CONSUME(this.lexerConfig.ArrayRowSeparator),n.push([]),n[n.length-1].push(this.SUBRULE3(this.booleanExpression))}}])}),M1(n)}),this.parenthesisExpression=this.RULE("parenthesisExpression",()=>{const n=this.CONSUME(Fg),i=this.SUBRULE(this.booleanExpression),s=this.CONSUME(yd);return b8(i,n.leadingWhitespace,s.leadingWhitespace)}),this.arrayExpression=this.RULE("arrayExpression",()=>this.OR([{ALT:()=>{const n=this.CONSUME(rS),i=this.SUBRULE(this.insideArrayExpression),s=this.CONSUME(nS);return M1(i.args,n.leadingWhitespace,s.leadingWhitespace)}},{ALT:()=>this.SUBRULE(this.parenthesisExpression)}])),this.numericStringToNumber=n=>{const i=n.replace(this.lexerConfig.decimalSeparator,".");return Number(i)},this.positiveAtomicExpression=this.RULE("positiveAtomicExpression",()=>{var n;return this.OR((n=this.atomicExpCache)!==null&&n!==void 0?n:this.atomicExpCache=[{ALT:()=>this.SUBRULE(this.arrayExpression)},{ALT:()=>this.SUBRULE(this.cellRangeExpression)},{ALT:()=>this.SUBRULE(this.columnRangeExpression)},{ALT:()=>this.SUBRULE(this.rowRangeExpression)},{ALT:()=>this.SUBRULE(this.offsetExpression)},{ALT:()=>this.SUBRULE(this.cellReference)},{ALT:()=>this.SUBRULE(this.procedureExpression)},{ALT:()=>this.SUBRULE(this.namedExpressionExpression)},{ALT:()=>{const i=this.CONSUME(this.lexerConfig.NumberLiteral);return QM(this.numericStringToNumber(i.image),i.leadingWhitespace)}},{ALT:()=>{const i=this.CONSUME(iS);return JM(i)}},{ALT:()=>{const i=this.CONSUME(sS),s=i.image.toUpperCase(),o=this.lexerConfig.errorMapping[s];return o?As(new J(o),i.leadingWhitespace):this.parsingError(Vr.ParserError,"Unknown error literal")}}])}),this.rightUnaryOpAtomicExpression=this.RULE("rightUnaryOpAtomicExpression",()=>{const n=this.SUBRULE(this.positiveAtomicExpression),i=this.OPTION(()=>this.CONSUME(XE));return i?g8(n,i.leadingWhitespace):n}),this.atomicExpression=this.RULE("atomicExpression",()=>this.OR([{ALT:()=>{const n=this.CONSUME(Rc),i=this.SUBRULE(this.atomicExpression);return gr(n,Og)?m8(i,n.leadingWhitespace):gr(n,Ig)?p8(i,n.leadingWhitespace):(this.customParsingError=A1(Vr.ParserError,"Mismatched token type"),this.customParsingError)}},{ALT:()=>this.SUBRULE2(this.rightUnaryOpAtomicExpression)}])),this.powerExpression=this.RULE("powerExpression",()=>{let n=this.SUBRULE(this.atomicExpression);return this.MANY(()=>{const i=this.CONSUME(kg),s=this.SUBRULE2(this.atomicExpression);gr(i,kg)?n=f8(n,s,i.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),n}),this.multiplicationExpression=this.RULE("multiplicationExpression",()=>{let n=this.SUBRULE(this.powerExpression);return this.MANY(()=>{const i=this.CONSUME(Vp),s=this.SUBRULE2(this.powerExpression);gr(i,qE)?n=h8(n,s,i.leadingWhitespace):gr(i,YE)?n=d8(n,s,i.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),n}),this.additionExpression=this.RULE("additionExpression",()=>{let n=this.SUBRULE(this.multiplicationExpression);return this.MANY(()=>{const i=this.CONSUME(Rc),s=this.SUBRULE2(this.multiplicationExpression);gr(i,Og)?n=u8(n,s,i.leadingWhitespace):gr(i,Ig)?n=c8(n,s,i.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),n}),this.concatenateExpression=this.RULE("concatenateExpression",()=>{let n=this.SUBRULE(this.additionExpression);return this.MANY(()=>{const i=this.CONSUME(tS),s=this.SUBRULE2(this.additionExpression);n=r8(n,s,i.leadingWhitespace)}),n}),this.booleanExpression=this.RULE("booleanExpression",()=>{let n=this.SUBRULE(this.concatenateExpression);return this.MANY(()=>{const i=this.CONSUME(wa),s=this.SUBRULE2(this.concatenateExpression);gr(i,Pg)?n=n8(n,s,i.leadingWhitespace):gr(i,KE)?n=i8(n,s,i.leadingWhitespace):gr(i,ZE)?n=s8(n,s,i.leadingWhitespace):gr(i,QE)?n=o8(n,s,i.leadingWhitespace):gr(i,JE)?n=a8(n,s,i.leadingWhitespace):gr(i,eS)?n=l8(n,s,i.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),n}),this.formula=this.RULE("formula",()=>(this.CONSUME(Pg),this.SUBRULE(this.booleanExpression))),this.lexerConfig=e,this.formulaAddress=$e(0,0,0),this.performSelfAnalysis()}parseFromTokens(e,t){this.input=e;let n=this.formulaWithContext(t),i=[];return this.customParsingError&&i.push(this.customParsingError),i=i.concat(this.errors.map(s=>({type:Vr.ParserError,message:s.message}))),i.length>0&&(n=Mg()),{ast:n,errors:i}}reset(){super.reset(),this.customParsingError=void 0}formulaWithContext(e){return this.formulaAddress=e,this.formula()}buildCellRange(e,t,n){if(e.sheet===void 0&&t.sheet!==void 0)return this.parsingError(Vr.ParserError,"Malformed range expression");const{firstEnd:i,secondEnd:s,sheetRefType:o}=Bl.fixSheetIdsForRangeEnds(e,t);return N1(i,s,o,n)}static fixSheetIdsForRangeEnds(e,t){const n=Bl.rangeSheetReferenceType(e.sheet,t.sheet),i=e.sheet!==void 0&&t.sheet===void 0?t.withSheet(e.sheet):t;return{firstEnd:e,secondEnd:i,sheetRefType:n}}handleOffsetHeuristic(e){var t;const n=e[0];if(n.type!==oe.CELL_REFERENCE)return this.parsingError(Vr.StaticOffsetError,"First argument to OFFSET is not a reference");const i=e[1];let s;if(i.type===oe.NUMBER&&Number.isInteger(i.value))s=i.value;else if(i.type===oe.PLUS_UNARY_OP&&i.value.type===oe.NUMBER&&Number.isInteger(i.value.value))s=i.value.value;else if(i.type===oe.MINUS_UNARY_OP&&i.value.type===oe.NUMBER&&Number.isInteger(i.value.value))s=-i.value.value;else return this.parsingError(Vr.StaticOffsetError,"Second argument to OFFSET is not a static number");const o=e[2];let a;if(o.type===oe.NUMBER&&Number.isInteger(o.value))a=o.value;else if(o.type===oe.PLUS_UNARY_OP&&o.value.type===oe.NUMBER&&Number.isInteger(o.value.value))a=o.value.value;else if(o.type===oe.MINUS_UNARY_OP&&o.value.type===oe.NUMBER&&Number.isInteger(o.value.value))a=-o.value.value;else return this.parsingError(Vr.StaticOffsetError,"Third argument to OFFSET is not a static number");const l=e[3];let u;if(l===void 0)u=1;else if(l.type===oe.NUMBER){if(u=l.value,u<1)return this.parsingError(Vr.StaticOffsetError,"Fourth argument to OFFSET is too small number");if(!Number.isInteger(u))return this.parsingError(Vr.StaticOffsetError,"Fourth argument to OFFSET is not integer")}else return this.parsingError(Vr.StaticOffsetError,"Fourth argument to OFFSET is not a static number");const c=e[4];let d;if(c===void 0)d=1;else if(c.type===oe.NUMBER){if(d=c.value,d<1)return this.parsingError(Vr.StaticOffsetError,"Fifth argument to OFFSET is too small number");if(!Number.isInteger(d))return this.parsingError(Vr.StaticOffsetError,"Fifth argument to OFFSET is not integer")}else return this.parsingError(Vr.StaticOffsetError,"Fifth argument to OFFSET is not a static number");const h=new vr(n.reference.col+a,n.reference.row+s,n.reference.type,(t=n.reference.sheet)!==null&&t!==void 0?t:void 0);let f=h.col,m=h.row;if((n.reference.type===hr.CELL_REFERENCE_RELATIVE||n.reference.type===hr.CELL_REFERENCE_ABSOLUTE_COL)&&(m=m+this.formulaAddress.row),(n.reference.type===hr.CELL_REFERENCE_RELATIVE||n.reference.type===hr.CELL_REFERENCE_ABSOLUTE_ROW)&&(f=f+this.formulaAddress.col),f<0||m<0)return As(new J(te.REF,ue.OutOfSheet));if(d===1&&u===1)return C1(h);{const p=new vr(h.col+d-1,h.row+u-1,h.type,h.sheet),g=n.reference.sheet==null?wi.RELATIVE:wi.BOTH_ABSOLUTE;return N1(h,p,g)}}parsingError(e,t){return this.customParsingError=A1(e,t),Mg()}static rangeSheetReferenceType(e,t){return e===void 0?wi.RELATIVE:t===void 0?wi.START_ABSOLUTE:wi.BOTH_ABSOLUTE}}class mf{constructor(e){this.lexerConfig=e,this.lexer=new li(e.allTokens,{ensureOptimizations:!0})}tokenizeFormula(e){const t=this.lexer.tokenize(e);let n=t.tokens;return n=this.trimTrailingWhitespaces(n),n=this.skipWhitespacesInsideRanges(n),n=this.skipWhitespacesBeforeArgSeparators(n),t.tokens=n,t}skipWhitespacesInsideRanges(e){return mf.filterTokensByNeighbors(e,(t,n,i)=>(gr(t,ra)||gr(t,Ac))&&gr(n,this.lexerConfig.WhiteSpace)&&(gr(i,ra)||gr(i,Ac)))}skipWhitespacesBeforeArgSeparators(e){return mf.filterTokensByNeighbors(e,(t,n,i)=>!gr(t,this.lexerConfig.ArgSeparator)&&gr(n,this.lexerConfig.WhiteSpace)&&gr(i,this.lexerConfig.ArgSeparator))}static filterTokensByNeighbors(e,t){if(e.length<3)return e;let n=0;const i=[e[n++]];for(;n<e.length-1;)t(e[n-1],e[n],e[n+1])||i.push(e[n]),++n;return i.push(e[n]),i}trimTrailingWhitespaces(e){return e.length>0&&gr(e[e.length-1],this.lexerConfig.WhiteSpace)&&e.pop(),e}}class aS{constructor(e,t,n){this.config=e,this.sheetMapping=t,this.namedExpressions=n}unparse(e,t){return"="+this.unparseAst(e,t)}unparseAst(e,t){var n,i;switch(e.type){case oe.EMPTY:return Xt("",e.leadingWhitespace);case oe.NUMBER:return Xt(lS(e.value,this.config.decimalSeparator),e.leadingWhitespace);case oe.STRING:return Xt('"'+e.value+'"',e.leadingWhitespace);case oe.FUNCTION_CALL:{const s=e.args.map(l=>l!==void 0?this.unparseAst(l,t):"").join(this.config.functionArgSeparator),a=(this.config.translationPackage.isFunctionTranslated(e.procedureName)?this.config.translationPackage.getFunctionTranslation(e.procedureName):e.procedureName)+"("+s+Xt(")",e.internalWhitespace);return Xt(a,e.leadingWhitespace)}case oe.NAMED_EXPRESSION:{const s=(n=this.namedExpressions.nearestNamedExpression(e.expressionName,t.sheet))===null||n===void 0?void 0:n.displayName;return Xt(s||e.expressionName,e.leadingWhitespace)}case oe.CELL_REFERENCE:{let s;return e.reference.sheet!==void 0?s=this.unparseSheetName(e.reference.sheet)+"!":s="",s+=(i=e.reference.unparse(t))!==null&&i!==void 0?i:this.config.translationPackage.getErrorTranslation(te.REF),Xt(s,e.leadingWhitespace)}case oe.COLUMN_RANGE:case oe.ROW_RANGE:case oe.CELL_RANGE:return Xt(this.formatRange(e,t),e.leadingWhitespace);case oe.PLUS_UNARY_OP:{const s=this.unparseAst(e.value,t);return Xt("+",e.leadingWhitespace)+s}case oe.MINUS_UNARY_OP:{const s=this.unparseAst(e.value,t);return Xt("-",e.leadingWhitespace)+s}case oe.PERCENT_OP:return this.unparseAst(e.value,t)+Xt("%",e.leadingWhitespace);case oe.ERROR:{const s=this.config.translationPackage.getErrorTranslation(e.error?e.error.type:te.ERROR);return Xt(s,e.leadingWhitespace)}case oe.ERROR_WITH_RAW_INPUT:return Xt(e.rawInput,e.leadingWhitespace);case oe.PARENTHESIS:{const o="("+this.unparseAst(e.expression,t)+Xt(")",e.internalWhitespace);return Xt(o,e.leadingWhitespace)}case oe.ARRAY:{const s="{"+e.args.map(o=>o.map(a=>this.unparseAst(a,t)).join(this.config.arrayColumnSeparator)).join(this.config.arrayRowSeparator)+Xt("}",e.internalWhitespace);return Xt(s,e.leadingWhitespace)}default:{const s=this.unparseAst(e.left,t),o=this.unparseAst(e.right,t);return s+Xt(GE[e.type],e.leadingWhitespace)+o}}}unparseSheetName(e){const t=iE(e,n=>this.sheetMapping.getSheetNameOrThrowError(n,{includePlaceholders:!0}));if(t===void 0)throw new Dn(e);return t}formatRange(e,t){let n="",i="";e.start.sheet!==void 0&&e.sheetReferenceType!==wi.RELATIVE&&(n=this.unparseSheetName(e.start.sheet)+"!"),e.end.sheet!==void 0&&e.sheetReferenceType===wi.BOTH_ABSOLUTE&&(i=this.unparseSheetName(e.end.sheet)+"!");const s=e.start.unparse(t),o=e.end.unparse(t);return s===void 0||o===void 0?this.config.translationPackage.getErrorTranslation(te.REF):`${n}${s}:${i}${o}`}}function lS(r,e){return r.toString().replace(".",e)}class oc{constructor(e,t,n){this.config=e,this.functionRegistry=t,this.resolveSheetReference=n,this.statsCacheUsed=0,this.lexerConfig=S8(e),this.lexer=new mf(this.lexerConfig),this.formulaParser=new Bl(this.lexerConfig,this.resolveSheetReference),this.cache=new _8(this.functionRegistry)}parse(e,t){this.formulaAddress=t;const n=this.tokenizeFormula(e);if(n.errors.length>0){const d=n.errors.map(h=>({type:Vr.LexingError,message:h.message}));return{ast:Mg(),errors:d,hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]}}const i=this.computeHashFromTokens(n.tokens,t);let s=this.cache.get(i);if(s!==void 0)++this.statsCacheUsed;else{const d=this.bindWhitespacesToTokens(n.tokens),h=this.formulaParser.parseFromTokens(d,t);if(h.errors.length>0)return Object.assign(Object.assign({},h),{hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]});s=this.cache.set(i,h.ast)}const{ast:o,hasVolatileFunction:a,hasStructuralChangeFunction:l}=s,u=this.convertReversedRangesToRegularRanges(o),c=jp(u,this.functionRegistry);return{ast:u,errors:[],hasVolatileFunction:a,hasStructuralChangeFunction:l,dependencies:c}}convertReversedRangesToRegularRanges(e){switch(e.type){case oe.EMPTY:case oe.NUMBER:case oe.STRING:case oe.ERROR:case oe.ERROR_WITH_RAW_INPUT:case oe.CELL_REFERENCE:case oe.NAMED_EXPRESSION:return e;case oe.CELL_RANGE:{const{start:t,end:n}=e,i=this.orderCellRangeEnds(t,n);return Object.assign(Object.assign({},e),{start:i.start,end:i.end})}case oe.COLUMN_RANGE:{const{start:t,end:n}=e,i=this.orderColumnRangeEnds(t,n);return Object.assign(Object.assign({},e),{start:i.start,end:i.end})}case oe.ROW_RANGE:{const{start:t,end:n}=e,i=this.orderRowRangeEnds(t,n);return Object.assign(Object.assign({},e),{start:i.start,end:i.end})}case oe.PERCENT_OP:case oe.PLUS_UNARY_OP:case oe.MINUS_UNARY_OP:{const t=this.convertReversedRangesToRegularRanges(e.value);return Object.assign(Object.assign({},e),{value:t})}case oe.CONCATENATE_OP:case oe.EQUALS_OP:case oe.NOT_EQUAL_OP:case oe.LESS_THAN_OP:case oe.GREATER_THAN_OP:case oe.LESS_THAN_OR_EQUAL_OP:case oe.GREATER_THAN_OR_EQUAL_OP:case oe.MINUS_OP:case oe.PLUS_OP:case oe.TIMES_OP:case oe.DIV_OP:case oe.POWER_OP:{const t=this.convertReversedRangesToRegularRanges(e.left),n=this.convertReversedRangesToRegularRanges(e.right);return Object.assign(Object.assign({},e),{left:t,right:n})}case oe.PARENTHESIS:{const t=this.convertReversedRangesToRegularRanges(e.expression);return Object.assign(Object.assign({},e),{expression:t})}case oe.FUNCTION_CALL:{const t=e.args.map(n=>this.convertReversedRangesToRegularRanges(n));return Object.assign(Object.assign({},e),{args:t})}case oe.ARRAY:{const t=e.args.map(n=>n.map(i=>this.convertReversedRangesToRegularRanges(i)));return Object.assign(Object.assign({},e),{args:t})}}}orderCellRangeEnds(e,t){const n=[e,t],[i,s]=n.map(c=>c.toColumnAddress()).sort(Xn.compareByAbsoluteAddress(this.formulaAddress)),[o,a]=n.map(c=>c.toRowAddress()).sort(Bn.compareByAbsoluteAddress(this.formulaAddress)),[l,u]=n.map(c=>c.sheet).sort(oc.compareSheetIds.bind(this));return{start:vr.fromColAndRow(i,o,l),end:vr.fromColAndRow(s,a,u)}}orderColumnRangeEnds(e,t){const n=[e,t],[i,s]=n.sort(Xn.compareByAbsoluteAddress(this.formulaAddress)),[o,a]=n.map(l=>l.sheet).sort(oc.compareSheetIds.bind(this));return{start:new Xn(i.type,i.col,o),end:new Xn(s.type,s.col,a)}}orderRowRangeEnds(e,t){const n=[e,t],[i,s]=n.sort(Bn.compareByAbsoluteAddress(this.formulaAddress)),[o,a]=n.map(l=>l.sheet).sort(oc.compareSheetIds.bind(this));return{start:new Bn(i.type,i.row,o),end:new Bn(s.type,s.row,a)}}static compareSheetIds(e,t){return e=e??1/0,t=t??1/0,e-t}fetchCachedResultForAst(e){const t=this.computeHashFromAst(e);return this.fetchCachedResult(t)}fetchCachedResult(e){const t=this.cache.get(e);if(t===void 0)throw new Error("There is no AST with such key in the cache");{const{ast:n,hasVolatileFunction:i,hasStructuralChangeFunction:s,relativeDependencies:o}=t;return{ast:n,errors:[],hasVolatileFunction:i,hasStructuralChangeFunction:s,dependencies:o}}}computeHashFromTokens(e,t){var n;let i="",s=0;for(;s<e.length;){const o=e[s];if(gr(o,ra)){const a=Ol(o.image,t,this.resolveSheetReference);a===void 0?i=i.concat(o.image):i=i.concat(a.hash(!0))}else if(gr(o,Ly)){const a=o.image.toUpperCase().slice(0,-1),l=(n=this.lexerConfig.functionMapping[a])!==null&&n!==void 0?n:a;i=i.concat(l,"(")}else if(gr(o,Py)){const[a,l]=o.image.split(":"),u=tf(a,t,this.resolveSheetReference),c=tf(l,t,this.resolveSheetReference);u===void 0||c===void 0?i=i.concat("!REF"):i=i.concat(u.hash(!0),":",c.hash(!0))}else if(gr(o,Fy)){const[a,l]=o.image.split(":"),u=rf(a,t,this.resolveSheetReference),c=rf(l,t,this.resolveSheetReference);u===void 0||c===void 0?i=i.concat("!REF"):i=i.concat(u.hash(!0),":",c.hash(!0))}else i=i.concat(o.image);s++}return i}rememberNewAst(e){const t=this.computeHashFromAst(e);return this.cache.maybeSetAndThenGet(t,e)}computeHashFromAst(e){return"="+this.computeHashOfAstNode(e)}computeHashOfAstNode(e){switch(e.type){case oe.EMPTY:return e.leadingWhitespace||"";case oe.NUMBER:return Xt(lS(e.value,this.config.decimalSeparator),e.leadingWhitespace);case oe.STRING:return Xt('"'+e.value+'"',e.leadingWhitespace);case oe.NAMED_EXPRESSION:return Xt(e.expressionName,e.leadingWhitespace);case oe.FUNCTION_CALL:{const t=e.args.map(i=>this.computeHashOfAstNode(i)).join(this.config.functionArgSeparator),n=e.procedureName+"("+t+Xt(")",e.internalWhitespace);return Xt(n,e.leadingWhitespace)}case oe.CELL_REFERENCE:return Xt(e.reference.hash(!0),e.leadingWhitespace);case oe.COLUMN_RANGE:case oe.ROW_RANGE:case oe.CELL_RANGE:{const t=e.start.hash(e.sheetReferenceType!==wi.RELATIVE),n=e.end.hash(e.sheetReferenceType===wi.BOTH_ABSOLUTE);return Xt(t+":"+n,e.leadingWhitespace)}case oe.MINUS_UNARY_OP:return Xt("-"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case oe.PLUS_UNARY_OP:return Xt("+"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case oe.PERCENT_OP:return this.computeHashOfAstNode(e.value)+Xt("%",e.leadingWhitespace);case oe.ERROR:{const t=this.config.translationPackage.getErrorTranslation(e.error?e.error.type:te.ERROR);return Xt(t,e.leadingWhitespace)}case oe.ERROR_WITH_RAW_INPUT:return Xt(e.rawInput,e.leadingWhitespace);case oe.ARRAY:{const t=e.args.map(n=>n.map(i=>this.computeHashOfAstNode(i)).join(",")).join(";");return Xt("{"+t+Xt("}",e.internalWhitespace),e.leadingWhitespace)}case oe.PARENTHESIS:{const n="("+this.computeHashOfAstNode(e.expression)+Xt(")",e.internalWhitespace);return Xt(n,e.leadingWhitespace)}default:return this.computeHashOfAstNode(e.left)+Xt(GE[e.type],e.leadingWhitespace)+this.computeHashOfAstNode(e.right)}}bindWhitespacesToTokens(e){const t=[],n=e[0];gr(n,this.lexerConfig.WhiteSpace)||t.push(n);for(let i=1;i<e.length;++i){const s=e[i];if(gr(s,this.lexerConfig.WhiteSpace))continue;const o=e[i-1];gr(o,this.lexerConfig.WhiteSpace)&&(s.leadingWhitespace=o),t.push(s)}return t}tokenizeFormula(e){return this.lexer.tokenizeFormula(e)}}const Il=(r,e,t,n)=>{switch(r.type){case oe.EMPTY:case oe.NUMBER:case oe.STRING:case oe.ERROR:return;case oe.NAMED_EXPRESSION:{n&&t.push(new mo(r.expressionName));return}case oe.CELL_REFERENCE:{n&&t.push(new uS(r.reference));return}case oe.CELL_RANGE:{n&&r.start.sheet===r.end.sheet&&t.push(new T8(r.start,r.end));return}case oe.COLUMN_RANGE:{n&&r.start.sheet===r.end.sheet&&t.push(new R8(r.start,r.end));return}case oe.ROW_RANGE:{n&&r.start.sheet===r.end.sheet&&t.push(new A8(r.start,r.end));return}case oe.PERCENT_OP:case oe.PLUS_UNARY_OP:case oe.MINUS_UNARY_OP:{Il(r.value,e,t,!0);return}case oe.CONCATENATE_OP:case oe.EQUALS_OP:case oe.NOT_EQUAL_OP:case oe.LESS_THAN_OP:case oe.GREATER_THAN_OP:case oe.LESS_THAN_OR_EQUAL_OP:case oe.GREATER_THAN_OR_EQUAL_OP:case oe.MINUS_OP:case oe.PLUS_OP:case oe.TIMES_OP:case oe.DIV_OP:case oe.POWER_OP:Il(r.left,e,t,!0),Il(r.right,e,t,!0);return;case oe.PARENTHESIS:Il(r.expression,e,t,n);return;case oe.FUNCTION_CALL:{const i=!e.doesFunctionNeedArgumentToBeComputed(r.procedureName);r.args.forEach(s=>Il(s,e,t,i));return}}},jp=(r,e)=>{const t=new Array;return Il(r,e,t,!0),t};class uS{constructor(e){this.dependency=e}absolutize(e){return this.dependency.toSimpleCellAddress(e)}}class T8{constructor(e,t){this.start=e,this.end=t}absolutize(e){return new it(this.start.toSimpleCellAddress(e),this.end.toSimpleCellAddress(e))}}class R8{constructor(e,t){this.start=e,this.end=t}absolutize(e){const t=this.start.toSimpleColumnAddress(e),n=this.end.toSimpleColumnAddress(e);return new bo(t.sheet,t.col,n.col)}}class A8{constructor(e,t){this.start=e,this.end=t}absolutize(e){const t=this.start.toSimpleRowAddress(e),n=this.end.toSimpleRowAddress(e);return new wo(t.sheet,t.row,n.row)}}class mo{constructor(e){this.name=e}absolutize(e){return this}}const Cs=(r,e)=>r.map(t=>t.absolutize(e)),C8=r=>r.filter(e=>e instanceof mo?!0:e instanceof it?!(ii(e.start)||ii(e.end)):!ii(e));const It=Symbol("Empty value");function He(r){return r instanceof Ks?r.val:r}class Ks{constructor(e,t){this.val=e,this.format=t}fromNumber(e){return new this.constructor(e)}}function Dy(r,e){if(typeof r=="number")return e;{const t=r.fromNumber(e);return t.format=r.format,t}}class By extends Ks{getDetailedType(){return Qe.NUMBER_DATE}}class Lg extends Ks{getDetailedType(){return Qe.NUMBER_CURRENCY}}class Uy extends Ks{getDetailedType(){return Qe.NUMBER_TIME}}class Vy extends Ks{getDetailedType(){return Qe.NUMBER_DATETIME}}class vd extends Ks{getDetailedType(){return Qe.NUMBER_PERCENT}}function Qt(r){return typeof r=="number"||r instanceof Ks}var Qe;(function(r){r.NUMBER_RAW="NUMBER_RAW",r.NUMBER_DATE="NUMBER_DATE",r.NUMBER_TIME="NUMBER_TIME",r.NUMBER_DATETIME="NUMBER_DATETIME",r.NUMBER_CURRENCY="NUMBER_CURRENCY",r.NUMBER_PERCENT="NUMBER_PERCENT"})(Qe||(Qe={}));function N8(r){return r instanceof Ks?r.getDetailedType():Qe.NUMBER_RAW}function M8(r){if(r instanceof Ks)return r.format}function gf(r){return r instanceof Ks?{type:r.getDetailedType(),format:r.format}:{type:Qe.NUMBER_RAW}}class Ge{constructor(e,t,n,i){this._data=e,this.range=t,this.dependencyGraph=n,this._hasOnlyNumbers=i,this.size=e===void 0?new Ct(t.effectiveWidth(n),t.effectiveHeight(n)):new Ct(e[0].length,e.length)}get data(){return this.ensureThatComputed(),this._data}static fromRange(e,t,n){return new Ge(e,t,n,!0)}static onlyNumbers(e){return new Ge(e,void 0,void 0,!0)}static onlyValues(e){return new Ge(e,void 0,void 0,void 0)}static onlyRange(e,t){return new Ge(void 0,e,t,void 0)}static fromScalar(e){return new Ge([[e]],void 0,void 0,void 0)}isAdHoc(){return this.range===void 0}width(){return this.size.width}height(){return this.size.height}valuesFromTopLeftCorner(){this.ensureThatComputed();const e=[];for(let t=0;t<this._data.length;t++)for(let n=0;n<this._data[0].length;n++)e.push(this._data[t][n]);return e}*effectiveAddressesFromData(e){for(let t=0;t<this.data.length;++t){const n=this.data[t];for(let i=0;i<n.length;++i)yield $e(e.sheet,e.col+i,e.row+t)}}*entriesFromTopLeftCorner(e){this.ensureThatComputed();for(let t=0;t<this.size.height;++t)for(let n=0;n<this.size.width;++n)yield[this._data[t][n],$e(e.sheet,e.col+n,e.row+t)]}*iterateValuesFromTopLeftCorner(){yield*this.valuesFromTopLeftCorner()}numberOfElements(){return this.size.width*this.size.height}hasOnlyNumbers(){if(this._hasOnlyNumbers===void 0){this._hasOnlyNumbers=!0;for(const e of this.data)for(const t of e)if(typeof t!="number")return this._hasOnlyNumbers=!1,!1}return this._hasOnlyNumbers}rawNumbers(){return this._data}rawData(){var e;return this.ensureThatComputed(),(e=this._data)!==null&&e!==void 0?e:[]}sameDimensionsAs(e){return this.width()===e.width()&&this.height()===e.height()}ensureThatComputed(){this._data===void 0&&(this._hasOnlyNumbers=!0,this._data=this.range.addressesArrayMap(this.dependencyGraph,e=>{const t=this.dependencyGraph.getCellValue(e);return t instanceof Ge?(this._hasOnlyNumbers=!1,new J(te.VALUE,ue.ScalarExpected)):(Qt(t)||(this._hasOnlyNumbers=!1),t)}))}}class aa{constructor(){this.changes=new Map}static empty(){return new aa}addAll(e){for(const t of e.changes.values())this.add(t.address,t);return this}addChange(e,t,n){this.addInterpreterValue(e,t,n)}exportChanges(e){let t=[];return this.changes.forEach(n=>{const i=e.exportChange(n);Array.isArray(i)?t=t.concat(i):t.push(i)}),t}getChanges(){return Array.from(this.changes.values())}isEmpty(){return this.changes.size===0}add(e,t){const n=t.value;if(n instanceof Ge)for(const i of n.effectiveAddressesFromData(e))this.changes.delete(ac(i));this.changes.set(ac(e),t)}addInterpreterValue(e,t,n){this.add(t,{address:t,value:e,oldValue:n})}}class yf{constructor(e,t,n,i){this.displayName=e,this.address=t,this.added=n,this.options=i}normalizeExpressionName(){return this.displayName.toLowerCase()}copy(){return new yf(this.displayName,this.address,this.added,this.options)}}class O8{constructor(){this.mapping=new Map}has(e){return this.mapping.has(this.normalizeExpressionName(e))}isNameAvailable(e){const t=this.normalizeExpressionName(e),n=this.mapping.get(t);return!(n&&n.added)}add(e){this.mapping.set(e.normalizeExpressionName(),e)}get(e){return this.mapping.get(this.normalizeExpressionName(e))}getExisting(e){const t=this.mapping.get(this.normalizeExpressionName(e));if(t&&t.added)return t}remove(e){const t=this.normalizeExpressionName(e),n=this.mapping.get(t);n&&(n.added=!1)}getAllNamedExpressions(){return Array.from(this.mapping.values()).filter(e=>e.added)}normalizeExpressionName(e){return e.toLowerCase()}}class O1{constructor(){this.mapping=new Map}add(e){this.mapping.set(this.normalizeExpressionName(e.displayName),e)}get(e){return this.mapping.get(this.normalizeExpressionName(e))}has(e){return this.mapping.has(this.normalizeExpressionName(e))}getAllNamedExpressions(){return Array.from(this.mapping.values()).filter(e=>e.added)}isNameAvailable(e){const t=this.normalizeExpressionName(e);return!this.mapping.has(t)}remove(e){const t=this.normalizeExpressionName(e);this.mapping.get(t)&&this.mapping.delete(t)}normalizeExpressionName(e){return e.toLowerCase()}}class Ro{constructor(){this.nextNamedExpressionRow=0,this.workbookStore=new O8,this.worksheetStores=new Map,this.addressCache=new Map}isNameAvailable(e,t){var n,i;return t===void 0?this.workbookStore.isNameAvailable(e):(i=(n=this.worksheetStore(t))===null||n===void 0?void 0:n.isNameAvailable(e))!==null&&i!==void 0?i:!0}namedExpressionInAddress(e){const t=this.addressCache.get(e);if(t&&t.added)return t}namedExpressionForScope(e,t){var n;return t===void 0?this.workbookStore.getExisting(e):(n=this.worksheetStore(t))===null||n===void 0?void 0:n.get(e)}nearestNamedExpression(e,t){var n,i;return(i=(n=this.worksheetStore(t))===null||n===void 0?void 0:n.get(e))!==null&&i!==void 0?i:this.workbookStore.getExisting(e)}isExpressionInScope(e,t){var n,i;return(i=(n=this.worksheetStore(t))===null||n===void 0?void 0:n.has(e))!==null&&i!==void 0?i:!1}isNameValid(e){const t=new RegExp(`^${Jx}$`),n=new RegExp(`^${eE}$`),i=new RegExp(`^${tE}$`);return t.test(e)||n.test(e)?!1:i.test(e)}addNamedExpression(e,t,n){const i=t===void 0?this.workbookStore:this.worksheetStoreOrCreate(t);let s=i.get(e);return s!==void 0?(s.added=!0,s.displayName=e,s.options=n):(s=new yf(e,this.nextAddress(),!0,n),i.add(s)),this.addressCache.set(s.address.row,s),s}restoreNamedExpression(e,t){const n=t===void 0?this.workbookStore:this.worksheetStoreOrCreate(t);return e.added=!0,n.add(e),this.addressCache.set(e.address.row,e),e}namedExpressionOrPlaceholder(e,t){var n;return(n=this.worksheetStoreOrCreate(t).get(e))!==null&&n!==void 0?n:this.workbookNamedExpressionOrPlaceholder(e)}workbookNamedExpressionOrPlaceholder(e){let t=this.workbookStore.get(e);return t===void 0&&(t=new yf(e,this.nextAddress(),!1),this.workbookStore.add(t)),t}remove(e,t){let n;t===void 0?n=this.workbookStore:n=this.worksheetStore(t);const i=n?.get(e);if(n===void 0||i===void 0||!i.added)throw Error("Named expression does not exist");n.remove(e),n instanceof O1&&n.mapping.size===0&&this.worksheetStores.delete(t),this.addressCache.delete(i.address.row)}getAllNamedExpressionsNamesInScope(e){return this.getAllNamedExpressions().filter(({scope:t})=>t===e).map(t=>t.expression.displayName)}getAllNamedExpressionsNames(){return this.getAllNamedExpressions().map(e=>e.expression.displayName)}getAllNamedExpressions(){const e=[];return this.workbookStore.getAllNamedExpressions().forEach(t=>{e.push({expression:t,scope:void 0})}),this.worksheetStores.forEach((t,n)=>{t.getAllNamedExpressions().forEach(i=>{e.push({expression:i,scope:n})})}),e}getAllNamedExpressionsForScope(e){var t,n;return e===void 0?this.workbookStore.getAllNamedExpressions():(n=(t=this.worksheetStores.get(e))===null||t===void 0?void 0:t.getAllNamedExpressions())!==null&&n!==void 0?n:[]}worksheetStoreOrCreate(e){let t=this.worksheetStores.get(e);return t||(t=new O1,this.worksheetStores.set(e,t)),t}worksheetStore(e){return this.worksheetStores.get(e)}nextAddress(){return $e(Ro.SHEET_FOR_WORKBOOK_EXPRESSIONS,0,this.nextNamedExpressionRow++)}}Ro.SHEET_FOR_WORKBOOK_EXPRESSIONS=-1;const Ko=r=>{switch(r.type){case oe.EMPTY:case oe.NUMBER:case oe.STRING:case oe.ERROR:case oe.ERROR_WITH_RAW_INPUT:return!1;case oe.CELL_REFERENCE:return!r.reference.isAbsolute();case oe.CELL_RANGE:case oe.COLUMN_RANGE:case oe.ROW_RANGE:return!r.start.isAbsolute();case oe.NAMED_EXPRESSION:return!1;case oe.PERCENT_OP:case oe.PLUS_UNARY_OP:case oe.MINUS_UNARY_OP:return Ko(r.value);case oe.CONCATENATE_OP:case oe.EQUALS_OP:case oe.NOT_EQUAL_OP:case oe.LESS_THAN_OP:case oe.GREATER_THAN_OP:case oe.LESS_THAN_OR_EQUAL_OP:case oe.GREATER_THAN_OR_EQUAL_OP:case oe.MINUS_OP:case oe.PLUS_OP:case oe.TIMES_OP:case oe.DIV_OP:case oe.POWER_OP:return Ko(r.left)||Ko(r.right);case oe.PARENTHESIS:return Ko(r.expression);case oe.FUNCTION_CALL:return r.args.some(e=>Ko(e));case oe.ARRAY:return r.args.some(e=>e.some(t=>Ko(t)))}};class si{constructor(e,t,n){if(this.sheet=e,this.rowStart=t,this.rowEnd=n,t<0)throw Error("Starting row cant be less than 0");if(n<t)throw Error("Row span cant end before start")}get numberOfRows(){return this.rowEnd-this.rowStart+1}get start(){return this.rowStart}get end(){return this.rowEnd}static fromNumberOfRows(e,t,n){return new si(e,t,t+n-1)}static fromRowStartAndEnd(e,t,n){return new si(e,t,n)}*rows(){for(let e=this.rowStart;e<=this.rowEnd;++e)yield e}intersect(e){if(this.sheet!==e.sheet)throw Error("Can't intersect spans from different sheets");const t=Math.max(this.rowStart,e.rowStart),n=Math.min(this.rowEnd,e.rowEnd);return t>n?null:new si(this.sheet,t,n)}firstRow(){return new si(this.sheet,this.rowStart,this.rowStart)}}class xi{constructor(e,t,n){if(this.sheet=e,this.columnStart=t,this.columnEnd=n,t<0)throw Error("Starting column cant be less than 0");if(n<t)throw Error("Column span cant end before start")}get numberOfColumns(){return this.columnEnd-this.columnStart+1}get start(){return this.columnStart}get end(){return this.columnEnd}static fromNumberOfColumns(e,t,n){return new xi(e,t,t+n-1)}static fromColumnStartAndEnd(e,t,n){return new xi(e,t,n)}*columns(){for(let e=this.columnStart;e<=this.columnEnd;++e)yield e}intersect(e){if(this.sheet!==e.sheet)throw Error("Can't intersect spans from different sheets");const t=Math.max(this.columnStart,e.columnStart),n=Math.min(this.columnEnd,e.columnEnd);return t>n?null:new xi(this.sheet,t,n)}firstColumn(){return new xi(this.sheet,this.columnStart,this.columnStart)}}var wt;(function(r){r.BUILD_ENGINE_TOTAL="BUILD_ENGINE_TOTAL",r.PARSER="PARSER",r.GRAPH_BUILD="GRAPH_BUILD",r.COLLECT_DEPENDENCIES="COLLECT_DEPENDENCIES",r.PROCESS_DEPENDENCIES="PROCESS_DEPENDENCIES",r.TOP_SORT="TOP_SORT",r.BUILD_COLUMN_INDEX="BUILD_COLUMN_INDEX",r.EVALUATION="EVALUATION",r.VLOOKUP="VLOOKUP",r.TRANSFORM_ASTS="TRANSFORM_ASTS",r.TRANSFORM_ASTS_POSTPONED="TRANSFORM_ASTS_POSTPONED",r.ADJUSTING_ADDRESS_MAPPING="ADJUSTING_ADDRESS_MAPPING",r.ADJUSTING_ARRAY_MAPPING="ADJUSTING_ARRAY_MAPPING",r.ADJUSTING_RANGES="ADJUSTING_RANGES",r.ADJUSTING_GRAPH="ADJUSTING_GRAPH",r.CRITERION_FUNCTION_FULL_CACHE_USED="CRITERION_FUNCTION_FULL_CACHE_USED",r.CRITERION_FUNCTION_PARTIAL_CACHE_USED="CRITERION_FUNCTION_PARTIAL_CACHE_USED"})(wt||(wt={}));class cS{constructor(){this.stats=new Map([[wt.CRITERION_FUNCTION_FULL_CACHE_USED,0],[wt.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0]]),this.startTimes=new Map}incrementCriterionFunctionFullCacheUsed(){var e;const t=((e=this.stats.get(wt.CRITERION_FUNCTION_FULL_CACHE_USED))!==null&&e!==void 0?e:0)+1;this.stats.set(wt.CRITERION_FUNCTION_FULL_CACHE_USED,t)}incrementCriterionFunctionPartialCacheUsed(){var e;const t=((e=this.stats.get(wt.CRITERION_FUNCTION_PARTIAL_CACHE_USED))!==null&&e!==void 0?e:0)+1;this.stats.set(wt.CRITERION_FUNCTION_PARTIAL_CACHE_USED,t)}reset(){this.stats.clear(),this.startTimes.clear(),this.stats.set(wt.CRITERION_FUNCTION_FULL_CACHE_USED,0),this.stats.set(wt.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0)}start(e){if(this.startTimes.get(e))throw Error(`Statistics ${e} already started`);this.startTimes.set(e,Date.now())}end(e){var t;const n=Date.now(),i=this.startTimes.get(e);if(i){let s=(t=this.stats.get(e))!==null&&t!==void 0?t:0;s+=n-i,this.stats.set(e,s),this.startTimes.delete(e)}else throw Error(`Statistics ${e} not started`)}measure(e,t){this.start(e);const n=t();return this.end(e),n}snapshot(){return new Map(this.stats)}}class I8 extends cS{incrementCriterionFunctionFullCacheUsed(){}incrementCriterionFunctionPartialCacheUsed(){}start(e){}end(e){}}class Dn extends Error{constructor(e){super(`There's no sheet with id = ${e}`)}}class hS extends Error{constructor(e){super(`There's no sheet with name '${e}'`)}}class ea extends Error{constructor(e){super(`Sheet with name ${e} already exists`)}}class Ha extends Error{constructor(){super("Sheet size limit exceeded")}}class bd extends Error{constructor(){super("This is not a formula")}}class dS extends Error{constructor(e){super(`Address (row = ${e.row}, col = ${e.col}) is invalid`)}}class Zr extends Error{constructor(e){super(`Invalid arguments, expected ${e}`)}}class Cc extends Error{constructor(e,t){super(`Sheets ${e} and ${t} are not equal.`)}}class fS extends Error{constructor(e){super(`Name of Named Expression '${e}' is already present`)}}class pS extends Error{constructor(e){super(`Name of Named Expression '${e}' is invalid`)}}class Nc extends Error{constructor(e){super(`Named Expression '${e}' does not exist`)}}class mS extends Error{constructor(){super("There is no operation to undo")}}class gS extends Error{constructor(){super("There is no operation to redo")}}class yS extends Error{constructor(){super("There is nothing to paste")}}function k8(r,e){switch(typeof e){case"function":case"symbol":return e.toString();case"bigint":return"BigInt("+e.toString()+")";default:return e instanceof RegExp?"RegExp("+e.toString()+")":e}}class vS extends Error{constructor(e){super(`Unable to parse value: ${JSON.stringify(e,k8,4)}`)}}class Zt extends Error{constructor(e,t){super(`Expected value of type: ${e} for config parameter: ${t}`)}}class P8 extends Error{constructor(e){super(`Config parameter ${e} cannot be empty.`)}}class bS extends Error{constructor(e,t){super(`Config parameter ${e} should be at least ${t}`)}}class wS extends Error{constructor(e,t){super(`Config parameter ${e} should be at most ${t}`)}}class _S extends Error{constructor(e,t){super(`Expected one of ${e} for config parameter: ${t}`)}}class xS extends Error{constructor(){super("Computations are suspended")}}class kl extends Error{constructor(e){super(`Translation for ${e} is missing in the translation package you're using.`)}}class ES extends Error{constructor(e){super(`Cannot register translation for function with id: ${e}`)}}class Dg extends Error{constructor(){super("Language not registered.")}}class SS extends Error{constructor(){super("Language already registered.")}}class su extends Error{static functionNotDeclaredInPlugin(e,t){return new su(`Function with id ${e} not declared in plugin ${t}`)}static functionMethodNotFound(e,t){return new su(`Function method ${e} not found in plugin ${t}`)}}class Wa extends Error{static cannotRegisterFunctionWithId(e){return new Wa(`Cannot register function with id ${e}`)}static cannotUnregisterFunctionWithId(e){return new Wa(`Cannot unregister function with id ${e}`)}static cannotUnregisterProtectedPlugin(){return new Wa("Cannot unregister protected plugin")}}class Ul extends Error{constructor(){super("Cannot perform this operation, source location has an array inside.")}}class vf extends Error{constructor(){super("Cannot perform this operation, target location has an array inside.")}}class jy extends Error{constructor(){super("Relative addresses not allowed in named expressions.")}}class F8 extends Error{constructor(e,t){super(`Alias id ${e} in plugin ${t} already defined as a function or alias.`)}}class L8{constructor(e){this.policy=e,this.mapping=new Map}getCell(e,t={}){const n=this.mapping.get(e.sheet);if(!n){if(t.throwIfSheetNotExists)throw new Dn(e.sheet);return}const i=n.getCell(e);if(!i&&t.throwIfCellNotExists)throw Error("Vertex for address missing in AddressMapping");return i}getCellOrThrow(e){const t=this.mapping.get(e.sheet);if(!t)throw new Dn(e.sheet);const n=t.getCell(e);if(!n)throw Error("Vertex for address missing in AddressMapping");return n}getStrategyForSheetOrThrow(e){const t=this.mapping.get(e);if(t===void 0)throw new Dn(e);return t}addSheetWithStrategy(e,t,n={throwIfSheetAlreadyExists:!0}){const i=this.mapping.get(e);if(i){if(n.throwIfSheetAlreadyExists)throw Error("Sheet already added");return i}return this.mapping.set(e,t),t}addSheetOrChangeStrategy(e,t){const n=this.createStrategyBasedOnBoundaries(t),i=this.mapping.get(e);return i?n instanceof Bg?i:(this.moveStrategyContent(i,n,e),this.mapping.set(e,n),n):(this.mapping.set(e,n),n)}moveStrategyContent(e,t,n){const i=e.getEntries(n);for(const[s,o]of i)t.setCell(s,o)}addSheetAndSetStrategyBasedOnBoundaries(e,t,n={throwIfSheetAlreadyExists:!0}){this.addSheetWithStrategy(e,this.createStrategyBasedOnBoundaries(t),n)}createStrategyBasedOnBoundaries(e){const{height:t,width:n,fill:i}=e,s=this.policy.call(i);return new s(n,t)}addSheetStrategyPlaceholderIfNotExists(e){this.mapping.has(e)||this.mapping.set(e,new Bg(0,0))}removeSheetIfExists(e){return this.mapping.delete(e)}getCellValue(e){const t=this.getCell(e);return t===void 0?It:t instanceof Wr?t.getArrayCellValue(e):t.getCellValue()}getRawValue(e){const t=this.getCell(e);return t instanceof la?t.getValues().rawValue:t instanceof Wr?t.getArrayCellRawValue(e):null}setCell(e,t){const n=this.mapping.get(e.sheet);if(!n)throw Error("Sheet not initialized");n.setCell(e,t)}moveCell(e,t){const n=this.mapping.get(e.sheet);if(!n)throw Error("Sheet not initialized.");if(this.has(t))throw new Error("Cannot move cell. Destination already occupied.");const i=n.getCell(e);if(i===void 0)throw new Error("Cannot move cell. No cell with such address.");this.setCell(t,i),this.removeCell(e)}removeCell(e){const t=this.mapping.get(e.sheet);if(!t)throw Error("Sheet not initialized");t.removeCell(e)}has(e){const t=this.mapping.get(e.sheet);return t===void 0?!1:t.has(e)}getSheetHeight(e){return this.getStrategyForSheetOrThrow(e).getHeight()}getSheetWidth(e){return this.getStrategyForSheetOrThrow(e).getWidth()}addRows(e,t,n){this.getStrategyForSheetOrThrow(e).addRows(t,n)}removeRows(e){this.getStrategyForSheetOrThrow(e.sheet).removeRows(e)}addColumns(e,t,n){this.getStrategyForSheetOrThrow(e).addColumns(t,n)}removeColumns(e){this.getStrategyForSheetOrThrow(e.sheet).removeColumns(e)}*verticesFromRowsSpan(e){yield*this.mapping.get(e.sheet).verticesFromRowsSpan(e)}*verticesFromColumnsSpan(e){yield*this.mapping.get(e.sheet).verticesFromColumnsSpan(e)}*entriesFromRowsSpan(e){yield*this.getStrategyForSheetOrThrow(e.sheet).entriesFromRowsSpan(e)}*entriesFromColumnsSpan(e){yield*this.getStrategyForSheetOrThrow(e.sheet).entriesFromColumnsSpan(e)}*entries(){for(const[e,t]of this.mapping.entries())yield*t.getEntries(e)}*sheetEntries(e){yield*this.getStrategyForSheetOrThrow(e).getEntries(e)}hasAnyEntries(e){return!this.sheetEntries(e).next().done}}class D8{constructor(){this.arrayMapping=new Map}getArray(e){const t=this.getArrayByCorner(e.start);if(t?.getRange().sameAs(e))return t}getArrayByCorner(e){return this.arrayMapping.get(ac(e))}setArray(e,t){this.arrayMapping.set(ac(e.start),t)}removeArray(e){typeof e=="string"?this.arrayMapping.delete(e):this.arrayMapping.delete(ac(e.start))}count(){return this.arrayMapping.size}*arraysInRows(e){for(const[t,n]of this.arrayMapping.entries())n.spansThroughSheetRows(e.sheet,e.rowStart,e.rowEnd)&&(yield[t,n])}*arraysInCols(e){for(const[t,n]of this.arrayMapping.entries())n.spansThroughSheetColumn(e.sheet,e.columnStart,e.columnEnd)&&(yield[t,n])}isFormulaArrayInRow(e,t){for(const n of this.arrayMapping.values())if(n.spansThroughSheetRows(e,t))return!0;return!1}isFormulaArrayInAllRows(e){let t=!0;for(const n of e.rows())this.isFormulaArrayInRow(e.sheet,n)||(t=!1);return t}isFormulaArrayInColumn(e,t){for(const n of this.arrayMapping.values())if(n.spansThroughSheetColumn(e,t))return!0;return!1}isFormulaArrayInAllColumns(e){let t=!0;for(const n of e.columns())this.isFormulaArrayInColumn(e.sheet,n)||(t=!1);return t}isFormulaArrayInRange(e){for(const t of this.arrayMapping.values())if(t.getRange().doesOverlap(e))return!0;return!1}isFormulaArrayAtAddress(e){for(const t of this.arrayMapping.values())if(t.getRange().addressInRange(e))return!0;return!1}moveArrayVerticesAfterRowByRows(e,t,n){this.updateArrayVerticesInSheet(e,(i,s)=>{const o=s.getRange();return t<=o.start.row?[o.shifted(0,n),s]:void 0})}moveArrayVerticesAfterColumnByColumns(e,t,n){this.updateArrayVerticesInSheet(e,(i,s)=>{const o=s.getRange();return t<=o.start.col?[o.shifted(n,0),s]:void 0})}updateArrayVerticesInSheet(e,t){const n=Array();for(const[i,s]of this.arrayMapping.entries()){if(s.sheet!==e)continue;const o=t(i,s);o!==void 0&&(this.removeArray(i),n.push(o))}n.forEach(([i,s])=>{this.setArray(i,s)})}}class Uu{constructor(e){this.size=e}width(){return this.size.width}height(){return this.size.height}get(e,t){throw Error("Array not computed yet.")}simpleRangeValue(){throw Error("Array not computed yet.")}}class ou{constructor(e){if(this.size=new Ct(e.length>0?e[0].length:0,e.length),this.array=e,this.size.width<=0||this.size.height<=0)throw Error("Incorrect array size")}static fromInterpreterValue(e){return e instanceof Ge?new ou(e.data):new ou([[e]])}simpleRangeValue(){return Ge.onlyValues(this.array)}addRows(e,t){this.array.splice(e,0,...this.nullArrays(t,this.width())),this.size.height+=t}addColumns(e,t){for(let n=0;n<this.height();n++)this.array[n].splice(e,0,...new Array(t).fill(It));this.size.width+=t}removeRows(e,t){if(this.outOfBound(0,e)||this.outOfBound(0,t))throw Error("Array index out of bound");const n=t-e+1;this.array.splice(e,n),this.size.height-=n}removeColumns(e,t){if(this.outOfBound(e,0)||this.outOfBound(t,0))throw Error("Array index out of bound");const n=t-e+1;for(const i of this.array)i.splice(e,n);this.size.width-=n}nullArrays(e,t){const n=[];for(let i=0;i<e;++i)n.push(new Array(t).fill(It));return n}get(e,t){if(this.outOfBound(e,t))throw Error("Array index out of bound");return this.array[t][e]}set(e,t,n){if(this.outOfBound(e,t))throw Error("Array index out of bound");this.array[t][e]=n}width(){return this.size.width}height(){return this.size.height}raw(){return this.array}resize(e){if(this.height()<e.height&&isFinite(e.height)&&this.addRows(this.height(),e.height-this.height()),this.height()>e.height||(this.width()<e.width&&isFinite(e.width)&&this.addColumns(this.width(),e.width-this.width()),this.width()>e.width))throw Error("Resizing to smaller array")}outOfBound(e,t){return e<0||t<0||t>this.size.height-1||e>this.size.width-1}}class Om{constructor(e,t){this.error=e,this.size=t}get(e,t){return this.error}width(){return this.size.width}height(){return this.size.height}simpleRangeValue(){return this.error}}class ni{constructor(e,t,n){this.formula=e,this.cellAddress=t,this.version=n}get width(){return 1}get height(){return 1}static fromAst(e,t,n,i){return n.isScalar()?new Ms(e,t,i):new Wr(e,t,n,i)}getFormula(e){return this.ensureRecentData(e),this.formula}ensureRecentData(e){if(this.version!=e.version()){const[t,n,i]=e.applyTransformations(this.formula,this.cellAddress,this.version);this.formula=t,this.cellAddress=n,this.version=i}}getAddress(e){return this.ensureRecentData(e),this.cellAddress}}class Wr extends ni{constructor(e,t,n,i=0){super(e,t,i),n.isRef?this.array=new Om(new J(te.REF,ue.NoSpaceForArrayResult),Ct.error()):this.array=new Uu(n)}get width(){return this.array.width()}get height(){return this.array.height()}get sheet(){return this.cellAddress.sheet}get leftCorner(){return this.cellAddress}setCellValue(e){if(e instanceof J)return this.setErrorValue(e),e;const t=ou.fromInterpreterValue(e);return t.resize(this.array.size),this.array=t,e}getCellValue(){if(this.array instanceof Uu)throw Error("Array not computed yet.");return this.array.simpleRangeValue()}valueOrUndef(){if(!(this.array instanceof Uu))return this.array.simpleRangeValue()}getArrayCellValue(e){const t=e.col-this.cellAddress.col,n=e.row-this.cellAddress.row;try{return this.array.get(t,n)}catch{return new J(te.REF)}}getArrayCellRawValue(e){const t=this.getArrayCellValue(e);if(!(t instanceof J||t===It))return He(t)}setArrayCellValue(e,t){const n=e.col-this.cellAddress.col,i=e.row-this.cellAddress.row;this.array instanceof ou&&this.array.set(n,i,t)}setNoSpace(){return this.array=new Om(new J(te.SPILL,ue.NoSpaceForArrayResult),Ct.error()),this.getCellValue()}getRange(){return it.spanFrom(this.cellAddress,this.width,this.height)}getRangeOrUndef(){return it.spanFromOrUndef(this.cellAddress,this.width,this.height)}setAddress(e){this.cellAddress=e}setFormula(e){this.formula=e}spansThroughSheetRows(e,t,n=t){return this.cellAddress.sheet===e&&this.cellAddress.row<=n&&t<this.cellAddress.row+this.height}spansThroughSheetColumn(e,t,n=t){return this.cellAddress.sheet===e&&this.cellAddress.col<=n&&t<this.cellAddress.col+this.width}isComputed(){return!(this.array instanceof Uu)}columnsFromArray(){return xi.fromNumberOfColumns(this.cellAddress.sheet,this.cellAddress.col,this.width)}rowsFromArray(){return si.fromNumberOfRows(this.cellAddress.sheet,this.cellAddress.row,this.height)}ensureRecentData(e){}isLeftCorner(e){return Oc(this.cellAddress,e)}setErrorValue(e){this.array=new Om(e,this.array.size)}}class Ms extends ni{constructor(e,t,n){super(e,t,n)}valueOrUndef(){return this.cachedCellValue}setCellValue(e){return this.cachedCellValue=e,this.cachedCellValue}getCellValue(){if(this.cachedCellValue!==void 0)return this.cachedCellValue;throw Error("Value of the formula cell is not computed.")}isComputed(){return this.cachedCellValue!==void 0}}class Fn{constructor(e){this.range=e,this.functionCache=new Map,this.criterionFunctionCache=new Map,this.dependentCacheRanges=new Set,this.bruteForce=!1}get start(){return this.range.start}get end(){return this.range.end}get sheet(){return this.range.start.sheet}getFunctionValue(e){return this.functionCache.get(e)}setFunctionValue(e,t){this.functionCache.set(e,t)}getCriterionFunctionValue(e,t){var n;return(n=this.getCriterionFunctionValues(e).get(t))===null||n===void 0?void 0:n[0]}getCriterionFunctionValues(e){var t;return(t=this.criterionFunctionCache.get(e))!==null&&t!==void 0?t:new Map}setCriterionFunctionValues(e,t){this.criterionFunctionCache.set(e,t)}addDependentCacheRange(e){e!==this&&this.dependentCacheRanges.add(e)}clearCache(){this.functionCache.clear(),this.criterionFunctionCache.clear(),this.dependentCacheRanges.forEach(e=>e.criterionFunctionCache.clear()),this.dependentCacheRanges.clear()}}const B8=(r,e,t,n,i)=>{if(e instanceof Fn){const a=e.range.intersectionWith(t);return a!==void 0?Array.from(a.addresses(i)):[]}let s,o;if(e instanceof ni)s=e.getFormula(n),o=e.getAddress(n);else return[];return jp(s,r).filter(a=>a instanceof uS).map(a=>a.dependency.toSimpleCellAddress(o)).filter(a=>t.addressInRange(a))};var lo;(function(r){r[r.ON_STACK=0]="ON_STACK",r[r.PROCESSED=1]="PROCESSED",r[r.POPPED=2]="POPPED"})(lo||(lo={}));class U8{constructor(e=[],t=[]){this.nodesSparseArray=e,this.edgesSparseArray=t,this.entranceTime=[],this.low=[],this.parent=[],this.inSCC=[],this.nodeStatus=[],this.order=[],this.sccNonSingletons=[],this.timeCounter=0}getTopSortedWithSccSubgraphFrom(e,t,n){const i=e.reverse();return i.forEach(s=>this.runDFS(s)),this.postprocess(i,n,t)}getAdjacentNodeIds(e){return this.edgesSparseArray[e].filter(t=>t!==void 0&&this.nodesSparseArray[t])}runDFS(e){if(this.nodeStatus[e]!==void 0)return;this.nodeStatus[e]=lo.ON_STACK;const t=[e],n=[];for(;t.length>0;){const i=t[t.length-1];switch(this.nodeStatus[i]){case lo.ON_STACK:{this.handleOnStack(i,n,t);break}case lo.PROCESSED:{this.handleProcessed(i,n,t);break}case lo.POPPED:{t.pop();break}}}}handleOnStack(e,t,n){this.entranceTime[e]=this.timeCounter,this.low[e]=this.timeCounter,this.timeCounter++,t.push(e),this.getAdjacentNodeIds(e).forEach(i=>{this.entranceTime[i]===void 0&&(n.push(i),this.parent[i]=e,this.nodeStatus[i]=lo.ON_STACK)}),this.nodeStatus[e]=lo.PROCESSED}handleProcessed(e,t,n){let i=this.entranceTime[e];if(this.getAdjacentNodeIds(e).forEach(s=>{this.inSCC[s]||(i=this.parent[s]===e?Math.min(i,this.low[s]):Math.min(i,this.entranceTime[s]))}),this.low[e]=i,i===this.entranceTime[e]){const s=[];do s.push(t[t.length-1]),t.pop();while(s[s.length-1]!==e);s.forEach(o=>{this.inSCC[o]=!0}),this.order.push(...s),s.length>1&&s.forEach(o=>{this.sccNonSingletons[o]=!0})}n.pop(),this.nodeStatus[e]=lo.POPPED}postprocess(e,t,n){const i=[];e.forEach(a=>{i[a]=!0});const s=[],o=[];return this.order.reverse(),this.order.forEach(a=>{const l=this.getAdjacentNodeIds(a);this.sccNonSingletons[a]||l.includes(a)?(o.push(this.nodesSparseArray[a]),t(this.nodesSparseArray[a]),l.forEach(u=>i[u]=!0)):(s.push(this.nodesSparseArray[a]),i[a]&&n(this.nodesSparseArray[a])&&l.forEach(u=>i[u]=!0))}),{sorted:s,cycled:o}}}class V8{constructor(e,t){this.rawValue=e,this.processFn=t,this.processedValue=null}getProcessedValue(){return this.processedValue===null&&(this.processedValue=this.processFn(this.rawValue)),this.processedValue}markAsModified(){this.processedValue=null}}class j8{constructor(e){this.dependencyQuery=e,this.nodesSparseArray=[],this.edgesSparseArray=[],this.nodesIds=new Map,this.dirtyAndVolatileNodeIds=new V8({dirty:[],volatile:[]},t=>this.processDirtyAndVolatileNodeIds(t)),this.infiniteRangeIds=new Set,this.changingWithStructureNodeIds=[],this.nextId=0}getNodes(){return this.nodesSparseArray.filter(e=>e!==void 0)}hasNode(e){return this.nodesIds.has(e)}existsEdge(e,t){const n=this.getNodeId(e),i=this.getNodeId(t);return n===void 0||i===void 0?!1:this.edgesSparseArray[n].includes(i)}adjacentNodes(e){const t=this.getNodeId(e);if(t===void 0)throw this.missingNodeError(e);return new Set(this.edgesSparseArray[t].filter(n=>n!==void 0).map(n=>this.nodesSparseArray[n]))}adjacentNodesCount(e){const t=this.getNodeId(e);if(t===void 0)throw this.missingNodeError(e);return this.fixEdgesArrayForNode(t).length}addNodeAndReturnId(e){const t=this.nodesIds.get(e);if(t!==void 0)return t;const n=this.nextId;return this.nextId++,this.nodesSparseArray[n]=e,this.edgesSparseArray[n]=[],this.nodesIds.set(e,n),n}addEdge(e,t){const n=this.getNodeIdIfNotNumber(e),i=this.getNodeIdIfNotNumber(t);if(n===void 0)throw this.missingNodeError(e);if(i===void 0)throw this.missingNodeError(t);this.edgesSparseArray[n].includes(i)||this.edgesSparseArray[n].push(i)}removeNode(e){const t=this.getNodeId(e);if(t===void 0)throw this.missingNodeError(e);this.edgesSparseArray[t].length>0&&(this.edgesSparseArray[t].forEach(i=>this.dirtyAndVolatileNodeIds.rawValue.dirty.push(i)),this.dirtyAndVolatileNodeIds.markAsModified());const n=this.removeDependencies(e);return delete this.nodesSparseArray[t],delete this.edgesSparseArray[t],this.infiniteRangeIds.delete(t),this.nodesIds.delete(e),n}removeEdge(e,t){const n=this.getNodeIdIfNotNumber(e),i=this.getNodeIdIfNotNumber(t);if(n===void 0)throw this.missingNodeError(e);if(i===void 0)throw this.missingNodeError(t);const s=this.edgesSparseArray[n].indexOf(i);if(s===-1)throw new Error("Edge does not exist");delete this.edgesSparseArray[n][s]}removeEdgeIfExists(e,t){const n=this.getNodeIdIfNotNumber(e),i=this.getNodeIdIfNotNumber(t);if(n===void 0||i===void 0)return;const s=this.edgesSparseArray[n].indexOf(i);s!==-1&&delete this.edgesSparseArray[n][s]}topSortWithScc(){return this.getTopSortedWithSccSubgraphFrom(this.getNodes(),()=>!0,()=>{})}getTopSortedWithSccSubgraphFrom(e,t,n){const i=new U8(this.nodesSparseArray,this.edgesSparseArray),s=e.map(o=>this.getNodeId(o)).filter(o=>o!==void 0);return i.getTopSortedWithSccSubgraphFrom(s,t,n)}markNodeAsVolatile(e){const t=this.getNodeId(e);t!==void 0&&(this.dirtyAndVolatileNodeIds.rawValue.volatile.push(t),this.dirtyAndVolatileNodeIds.markAsModified())}markNodeAsDirty(e){const t=this.getNodeId(e);t!==void 0&&(this.dirtyAndVolatileNodeIds.rawValue.dirty.push(t),this.dirtyAndVolatileNodeIds.markAsModified())}getDirtyAndVolatileNodes(){return this.dirtyAndVolatileNodeIds.getProcessedValue()}clearDirtyNodes(){this.dirtyAndVolatileNodeIds.rawValue.dirty=[],this.dirtyAndVolatileNodeIds.markAsModified()}markNodeAsChangingWithStructure(e){const t=this.getNodeId(e);t!==void 0&&this.changingWithStructureNodeIds.push(t)}markChangingWithStructureNodesAsDirty(){this.changingWithStructureNodeIds.length<=0||(this.dirtyAndVolatileNodeIds.rawValue.dirty=[...this.dirtyAndVolatileNodeIds.rawValue.dirty,...this.changingWithStructureNodeIds],this.dirtyAndVolatileNodeIds.markAsModified())}markNodeAsInfiniteRange(e){const t=this.getNodeIdIfNotNumber(e);t!==void 0&&this.infiniteRangeIds.add(t)}getInfiniteRanges(){return[...this.infiniteRangeIds].map(e=>({node:this.nodesSparseArray[e],id:e}))}getNodeId(e){return this.nodesIds.get(e)}getNodeIdIfNotNumber(e){return typeof e=="number"?e:this.nodesIds.get(e)}fixEdgesArrayForNode(e){const t=this.edgesSparseArray[e];return this.edgesSparseArray[e]=t.filter(n=>n!==void 0&&this.nodesSparseArray[n]),this.edgesSparseArray[e]}removeDependencies(e){const t=this.dependencyQuery(e);return t.forEach(([n,i])=>{this.removeEdgeIfExists(i,e)}),t}processDirtyAndVolatileNodeIds({dirty:e,volatile:t}){return[...new Set([...e,...t])].map(n=>this.nodesSparseArray[n]).filter(n=>n!==void 0)}missingNodeError(e){return new Error(`Unknown node ${JSON.stringify(e)}`)}}class La{constructor(){this.rangeMapping=new Map}getNumberOfRangesInSheet(e){var t,n;return(n=(t=this.rangeMapping.get(e))===null||t===void 0?void 0:t.size)!==null&&n!==void 0?n:0}addOrUpdateVertex(e){let t=this.rangeMapping.get(e.sheet);t===void 0&&(t=new Map,this.rangeMapping.set(e.sheet,t));const n=La.calculateRangeKey(e.start,e.end);t.set(n,e)}removeVertexIfExists(e){const t=e.sheet,n=this.rangeMapping.get(t);if(n===void 0)return;const i=La.calculateRangeKey(e.start,e.end);n.delete(i),n.size===0&&this.rangeMapping.delete(t)}getRangeVertex(e,t){const n=this.rangeMapping.get(e.sheet),i=La.calculateRangeKey(e,t);return n?.get(i)}getVertexOrThrow(e,t){const n=this.getRangeVertex(e,t);if(!n)throw Error("Range does not exist");return n}truncateRanges(e,t){const n=Array(),i=Array(),s=Array(),o=e.sheet;for(const[l,u]of this.entriesFromSheet(e.sheet)){const c=u.range;e.start<=t(u.range.end)&&(c.removeSpan(e),c.shouldBeRemoved()?(this.removeByKey(o,l),n.push(u)):i.push([l,u]),s.push(u))}const a=[];i.sort((l,u)=>La.compareBy(l[1],u[1],t));for(const[l,u]of i){const c=La.calculateRangeKey(u.range.start,u.range.end);if(c===l)continue;const d=this.getByKey(o,c);this.removeByKey(o,l),d!==void 0&&u!=d?a.push([d,u]):this.addOrUpdateVertex(u)}return{verticesToRemove:n,verticesToMerge:a,verticesWithChangedSize:s}}moveAllRangesInSheetAfterAddingRows(e,t,n){return this.updateVerticesFromSheet(e,(i,s)=>t<=s.start.row?(s.range.shiftByRows(n),{changedSize:!1,vertex:s}):t>s.start.row&&t<=s.end.row?(s.range.expandByRows(n),{changedSize:!0,vertex:s}):void 0)}moveAllRangesInSheetAfterAddingColumns(e,t,n){return this.updateVerticesFromSheet(e,(i,s)=>t<=s.start.col?(s.range.shiftByColumns(n),{changedSize:!1,vertex:s}):t>s.start.col&&t<=s.end.col?(s.range.expandByColumns(n),{changedSize:!0,vertex:s}):void 0)}moveRangesInsideSourceRange(e,t,n,i){this.updateVerticesFromSheet(e.sheet,(s,o)=>{if(e.containsRange(o.range))return o.range.shiftByColumns(t),o.range.shiftByRows(n),o.range.moveToSheet(i),{changedSize:!1,vertex:o}})}*rangesInSheet(e){const t=this.rangeMapping.get(e);t&&(yield*t.values())}*rangeVerticesContainedInRange(e){for(const t of this.rangesInSheet(e.sheet))e.containsRange(t.range)&&(yield t)}findSmallerRange(e){if(e.height()>1&&Number.isFinite(e.height())){const t=$e(e.end.sheet,e.end.col,e.end.row-1),n=this.getRangeVertex(e.start,t);if(n!==void 0){const i=it.fromSimpleCellAddresses($e(e.start.sheet,e.start.col,e.end.row),e.end);return{smallerRangeVertex:n,restRange:i}}}return{restRange:e}}static calculateRangeKey(e,t){return`${e.col},${e.row},${t.col},${t.row}`}static compareBy(e,t,n){const i=n(e.range.start),s=n(t.range.start);if(i===s){const o=n(e.range.end),a=n(t.range.end);return o-a}else return i-s}*entriesFromSheet(e){const t=this.rangeMapping.get(e);t&&(yield*t.entries())}removeByKey(e,t){const n=this.rangeMapping.get(e);if(!n)throw new Error(`Sheet ${e} not found`);n.delete(t)}getByKey(e,t){var n;return(n=this.rangeMapping.get(e))===null||n===void 0?void 0:n.get(t)}updateVerticesFromSheet(e,t){const n=Array();for(const[i,s]of this.entriesFromSheet(e)){const o=t(i,s);o!==void 0&&(this.removeByKey(e,i),n.push(o))}return n.forEach(i=>{this.addOrUpdateVertex(i.vertex)}),{verticesWithChangedSize:n.filter(i=>i.changedSize).map(i=>i.vertex)}}}class $8{constructor(e,t,n){this.functions=e,this.errors=t,this.ui=n,this._protectedTranslations={VERSION:"VERSION"},this.checkUI(),this.checkErrors(),this.checkFunctionTranslations(this.functions),Object.assign(this.functions,this._protectedTranslations)}extendFunctions(e){this.checkFunctionTranslations(e),Object.assign(this.functions,e)}buildFunctionMapping(){return Object.keys(this.functions).reduce((e,t)=>(e[this.functions[t]]=t,e),{})}buildErrorMapping(){return Object.keys(this.errors).reduce((e,t)=>(e[this.errors[t]]=t,e),{})}isFunctionTranslated(e){return this.functions[e]!==void 0}getFunctionTranslations(e){const t=[];for(const n of e)this.isFunctionTranslated(n)&&t.push(this.functions[n]);return t}getFunctionTranslation(e){const t=this.functions[e];if(t===void 0)throw new kl(`functions.${e}`);return t}getMaybeFunctionTranslation(e){return this.functions[e]}getErrorTranslation(e){if(e===te.LIC)return`#${te.LIC}!`;const t=this.errors[e];if(t===void 0)throw new kl(`errors.${e}`);return t}getUITranslation(e){const t=this.ui[e];if(t===void 0)throw new kl(`ui.${e}`);return t}checkUI(){for(const e of Object.values(Mc))if(!(e in this.ui))throw new kl(`ui.${e}`)}checkErrors(){for(const e of Object.values(te))if(!(e in this.errors)&&e!==te.LIC)throw new kl(`errors.${e}`)}checkFunctionTranslations(e){const t=new Set(Object.getOwnPropertyNames(e));for(const n of Object.getOwnPropertyNames(this._protectedTranslations))if(t.has(n))throw new ES(n)}}function z8(r){return new $8(Object.assign({},r.functions),Object.assign({},r.errors),Object.assign({},r.ui))}var Mc;(function(r){r.NEW_SHEET_PREFIX="NEW_SHEET_PREFIX"})(Mc||(Mc={}));let Ch=class{constructor(e,t,n=!1){this.id=e,this.displayName=t,this.isPlaceholder=n}get canonicalName(){return $p.canonicalizeSheetName(this.displayName)}};class $p{constructor(e){this.lastSheetId=-1,this.mappingFromCanonicalNameToId=new Map,this.allSheets=new Map,this.sheetNamePrefix=e.getUITranslation(Mc.NEW_SHEET_PREFIX)}static canonicalizeSheetName(e){return e.toLowerCase()}getSheetId(e,t={}){var n;return(n=this._getSheetByName(e,t))===null||n===void 0?void 0:n.id}getSheetIdOrThrowError(e){const t=this._getSheetByName(e,{});if(t===void 0)throw new hS(e);return t.id}getSheetName(e){var t;return(t=this._getSheet(e,{}))===null||t===void 0?void 0:t.displayName}getSheetNameOrThrowError(e,t={}){return this._getSheetOrThrowError(e,t).displayName}*iterateSheetNames(e={}){for(const t of this.allSheets.values())(e.includePlaceholders||!t.isPlaceholder)&&(yield t.displayName)}getSheetNames(e={}){return Array.from(this.iterateSheetNames(e))}numberOfSheets(e={}){return this.getSheetNames(e).length}hasSheetWithId(e,t={}){return this._getSheet(e,t)!==void 0}hasSheetWithName(e){return this._getSheetByName(e,{})!==void 0}addSheet(e=`${this.sheetNamePrefix}${this.lastSheetId+2}`){const t=this._getSheetByName(e,{includePlaceholders:!0});if(t){if(!t.isPlaceholder)throw new ea(e);return t.isPlaceholder=!1,t.id}this.lastSheetId++;const n=new Ch(this.lastSheetId,e);return this._storeSheetInMappings(n),n.id}addSheetWithId(e,t){const n=this._getSheetByName(t,{includePlaceholders:!0});if(n){if(n.id!==e)throw new ea(t);if(!n.isPlaceholder)throw new ea(t);n.isPlaceholder=!1;return}e>this.lastSheetId&&(this.lastSheetId=e);const i=new Ch(e,t);this._storeSheetInMappings(i)}addPlaceholderIfNotExists(e){const t=this._getSheetByName(e,{includePlaceholders:!0});if(t)return t.id;this.lastSheetId++;const n=new Ch(this.lastSheetId,e,!0);return this._storeSheetInMappings(n),n.id}addPlaceholderWithId(e,t){if(this._getSheetByName(t,{includePlaceholders:!0}))throw new ea(t);if(this.hasSheetWithId(e,{includePlaceholders:!0}))throw new Error(`Sheet with id ${e} already exists`);e>this.lastSheetId&&(this.lastSheetId=e);const i=new Ch(e,t,!0);this._storeSheetInMappings(i)}removeSheetIfExists(e,t={}){const n=this._getSheet(e,t);return n?(this.allSheets.delete(e),this.mappingFromCanonicalNameToId.delete(n.canonicalName),e===this.lastSheetId&&this.lastSheetId--,!0):!1}markSheetAsPlaceholder(e){const t=this._getSheetOrThrowError(e,{});t.isPlaceholder=!0}renameSheet(e,t){const n=this._getSheetOrThrowError(e,{}),i=n.displayName;if(i===t)return{previousDisplayName:void 0};const s=this._getSheetByName(t,{includePlaceholders:!0});let o;if(s!==void 0&&s.id!==n.id)if(s.isPlaceholder)this.mappingFromCanonicalNameToId.delete(s.canonicalName),this.allSheets.delete(s.id),s.id===this.lastSheetId&&this.lastSheetId--,o=s.id;else throw new ea(t);const a=n.canonicalName;return this.mappingFromCanonicalNameToId.delete(a),n.displayName=t,this._storeSheetInMappings(n),{previousDisplayName:i,mergedWithPlaceholderSheet:o}}_storeSheetInMappings(e){this.allSheets.set(e.id,e),this.mappingFromCanonicalNameToId.set(e.canonicalName,e.id)}_getSheet(e,t){const n=this.allSheets.get(e);if(n!==void 0)return t.includePlaceholders||!n.isPlaceholder?n:void 0}_getSheetByName(e,t){const n=this.mappingFromCanonicalNameToId.get($p.canonicalizeSheetName(e));if(n!==void 0)return this._getSheet(n,t)}_getSheetOrThrowError(e,t){const n=this._getSheet(e,t);if(n===void 0)throw new Dn(e);return n}}class H8{constructor(e,t){this.sheetMapping=e,this.addressMapping=t}ensureSheetRegistered(e){const t=this.sheetMapping.addPlaceholderIfNotExists(e);return this.addressMapping.addSheetStrategyPlaceholderIfNotExists(t),t}}function TS(r){if(!Array.isArray(r))throw new Zr("an array of arrays.");for(let e=0;e<r.length;e++)if(!Array.isArray(r[e]))throw new Zr("an array of arrays.")}function bf(r){let e=0,t=0,n=0;for(let s=0;s<r.length;s++){let o=0;for(let a=0;a<r[s].length;a++){const l=r[s][a];l!=null&&(o=a+1,++n)}e=Math.max(e,o),o>0&&(t=s+1)}const i=e*t;return{height:t,width:e,fill:i===0?0:n/i}}class $y{constructor(e,t,n,i,s,o,a,l){this.addressMapping=e,this.rangeMapping=t,this.sheetMapping=n,this.arrayMapping=i,this.stats=s,this.lazilyTransformingAstService=o,this.functionRegistry=a,this.namedExpressions=l,this.changes=aa.empty(),this.dependencyQueryAddresses=u=>{if(u instanceof Fn)return this.rangeDependencyQuery(u).map(([c,d])=>c);{const c=this.formulaDependencyQuery(u);if(c!==void 0){const[d,h]=c;return h.map(f=>f instanceof mo?this.namedExpressions.namedExpressionOrPlaceholder(f.name,d.sheet).address:kr(f)?f:Vg(f.start,f.end))}else return[]}},this.dependencyQueryVertices=u=>{if(u instanceof Fn)return this.rangeDependencyQuery(u);{const c=this.formulaDependencyQuery(u);if(c!==void 0){const[d,h]=c;return h.map(f=>{if(f instanceof it)return[f.start,this.rangeMapping.getVertexOrThrow(f.start,f.end)];if(f instanceof mo){const m=this.namedExpressions.namedExpressionOrPlaceholder(f.name,d.sheet);return[m.address,this.addressMapping.getCellOrThrow(m.address)]}else return[f,this.addressMapping.getCellOrThrow(f)]})}else return[]}},this.rangeDependencyQuery=u=>{const c=[],{smallerRangeVertex:d,restRange:h}=this.rangeMapping.findSmallerRange(u.range);let f;d!==void 0&&this.graph.adjacentNodes(d).has(u)?(f=h,c.push([new it(d.start,d.end),d])):f=u.range;for(const m of f.addresses(this)){const p=this.addressMapping.getCell(m);p!==void 0&&c.push([m,p])}return c},this.formulaDependencyQuery=u=>{let c,d;if(u instanceof ni)d=u.getAddress(this.lazilyTransformingAstService),c=u.getFormula(this.lazilyTransformingAstService);else return;const h=jp(c,this.functionRegistry);return[d,Cs(h,d)]},this.graph=new j8(this.dependencyQueryVertices),this.sheetReferenceRegistrar=new H8(n,e)}static buildEmpty(e,t,n,i,s){return new $y(new L8(t.chooseAddressMappingPolicy),new La,new $p(t.translationPackage),new D8,s,e,n,i)}setFormulaToCell(e,t,n,i,s,o){const a=ni.fromAst(t,e,i,this.lazilyTransformingAstService.version());return this.exchangeOrAddFormulaVertex(a),this.processCellDependencies(n,a),this.graph.markNodeAsDirty(a),s&&this.markAsVolatile(a),o&&this.markAsDependentOnStructureChange(a),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setParsingErrorToCell(e,t){const n=this.shrinkPossibleArrayAndGetCell(e);return this.exchangeOrAddGraphNode(n,t),this.addressMapping.setCell(e,t),this.graph.markNodeAsDirty(t),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setValueToCell(e,t){const n=this.shrinkPossibleArrayAndGetCell(e);if(n instanceof Wr&&this.arrayMapping.removeArray(n.getRange()),n instanceof la)n.getValues().rawValue!==t.rawValue&&(n.setValues(t),this.graph.markNodeAsDirty(n));else{const i=new la(t.parsedValue,t.rawValue);this.exchangeOrAddGraphNode(n,i),this.addressMapping.setCell(e,i),this.graph.markNodeAsDirty(i)}return this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setCellEmpty(e){const t=this.shrinkPossibleArrayAndGetCell(e);if(t===void 0)return aa.empty();if(this.graph.adjacentNodes(t).size>0){const n=new ta;this.exchangeGraphNode(t,n),this.graph.adjacentNodesCount(n)===0?(this.removeVertex(n),this.addressMapping.removeCell(e)):(this.graph.markNodeAsDirty(n),this.addressMapping.setCell(e,n))}else this.removeVertex(t),this.addressMapping.removeCell(e);return this.getAndClearContentChanges()}clearDirtyVertices(){this.graph.clearDirtyNodes()}verticesToRecompute(){return this.graph.getDirtyAndVolatileNodes()}processCellDependencies(e,t){const n=this.graph.getNodeId(t);if(n===void 0)throw new Error("End vertex not found");e.forEach(i=>{if(i instanceof it){const s=i;let o=this.getRange(s.start,s.end);o===void 0&&(o=new Fn(s),this.rangeMapping.addOrUpdateVertex(o)),this.graph.addNodeAndReturnId(o);const a=this.graph.getNodeId(o);if(a===void 0)throw new Error("Range vertex not found");s.isFinite()||this.graph.markNodeAsInfiniteRange(a);const{smallerRangeVertex:l,restRange:u}=this.rangeMapping.findSmallerRange(s);if(l!==void 0){if(this.graph.addEdge(l,a),o.bruteForce){o.bruteForce=!1;for(const d of s.addresses(this))this.graph.removeEdge(this.fetchCell(d),a)}}else o.bruteForce=!0;const c=this.arrayMapping.getArray(u);if(c!==void 0)this.graph.addEdge(c,a);else for(const d of u.addresses(this)){const{vertex:h,id:f}=this.fetchCellOrCreateEmpty(d);this.graph.addEdge(f??h,a)}this.graph.addEdge(a,n),s.isFinite()&&this.correctInfiniteRangesDependenciesByRangeVertex(o)}else if(i instanceof mo){const s=t.getAddress(this.lazilyTransformingAstService).sheet,{vertex:o,id:a}=this.fetchNamedExpressionVertex(i.name,s);this.graph.addEdge(a??o,n)}else{const{vertex:s,id:o}=this.fetchCellOrCreateEmpty(i);this.graph.addEdge(o??s,n)}})}fetchNamedExpressionVertex(e,t){const n=this.namedExpressions.namedExpressionOrPlaceholder(e,t);return this.fetchCellOrCreateEmpty(n.address)}exchangeNode(e,t){const n=this.fetchCellOrCreateEmpty(e).vertex,i=this.fetchCellOrCreateEmpty(t).vertex;this.addressMapping.removeCell(e),this.exchangeGraphNode(n,i)}fetchCellOrCreateEmpty(e){const t=this.addressMapping.getCell(e);if(t!==void 0)return{vertex:t,id:void 0};const n=new ta,i=this.graph.addNodeAndReturnId(n);return this.addressMapping.setCell(e,n),{vertex:n,id:i}}removeRows(e){this.stats.measure(wt.ADJUSTING_GRAPH,()=>{for(const[n,i]of this.addressMapping.entriesFromRowsSpan(e)){for(const s of this.graph.adjacentNodes(i))this.graph.markNodeAsDirty(s);if(i instanceof Wr)if(i.isLeftCorner(n))this.shrinkArrayToCorner(i),this.arrayMapping.removeArray(i.getRange());else continue;this.removeVertex(i)}}),this.stats.measure(wt.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeRows(e)});const t=this.stats.measure(wt.ADJUSTING_RANGES,()=>{const n=this.truncateRanges(e,i=>i.row);return this.getArrayVerticesRelatedToRanges(n)});return this.stats.measure(wt.ADJUSTING_ARRAY_MAPPING,()=>{this.fixArraysAfterRemovingRows(e.sheet,e.rowStart,e.numberOfRows)}),this.addStructuralNodesToChangeSet(),{affectedArrays:t,contentChanges:this.getAndClearContentChanges()}}addSheet(e){this.addressMapping.addSheetOrChangeStrategy(e,bf([])),this.stats.measure(wt.ADJUSTING_ADDRESS_MAPPING,()=>{this.markAllCellsAsDirtyInSheet(e)}),this.stats.measure(wt.ADJUSTING_RANGES,()=>{this.markAllRangesAsDirtyInSheet(e)})}removeSheet(e){this.clearSheet(e);const t=!this.addressMapping.hasAnyEntries(e),n=this.rangeMapping.getNumberOfRangesInSheet(e)===0;t&&n?(this.sheetMapping.removeSheetIfExists(e),this.addressMapping.removeSheetIfExists(e)):this.sheetMapping.markSheetAsPlaceholder(e)}mergeSheets(e,t){if(!this.isPlaceholder(t))throw new Error(`Cannot merge sheets: sheet ${t} is not a placeholder`);this.mergeRangeVertices(e,t),this.mergeCellVertices(e,t),this.addressMapping.removeSheetIfExists(t),this.addStructuralNodesToChangeSet()}clearSheet(e){const t=new Set;for(const[n,i]of this.addressMapping.sheetEntries(e))i instanceof Wr?t.add(i):this.setCellEmpty(n);for(const n of t.values())this.setArrayEmpty(n);this.addStructuralNodesToChangeSet()}removeColumns(e){this.stats.measure(wt.ADJUSTING_GRAPH,()=>{for(const[n,i]of this.addressMapping.entriesFromColumnsSpan(e)){for(const s of this.graph.adjacentNodes(i))this.graph.markNodeAsDirty(s);if(i instanceof Wr)if(i.isLeftCorner(n))this.shrinkArrayToCorner(i),this.arrayMapping.removeArray(i.getRange());else continue;this.removeVertex(i)}}),this.stats.measure(wt.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeColumns(e)});const t=this.stats.measure(wt.ADJUSTING_RANGES,()=>{const n=this.truncateRanges(e,i=>i.col);return this.getArrayVerticesRelatedToRanges(n)});return this.stats.measure(wt.ADJUSTING_ARRAY_MAPPING,()=>this.fixArraysAfterRemovingColumns(e.sheet,e.columnStart,e.numberOfColumns)),this.addStructuralNodesToChangeSet(),{affectedArrays:t,contentChanges:this.getAndClearContentChanges()}}addRows(e){this.stats.measure(wt.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.addRows(e.sheet,e.rowStart,e.numberOfRows)});const t=this.stats.measure(wt.ADJUSTING_RANGES,()=>{const n=this.rangeMapping.moveAllRangesInSheetAfterAddingRows(e.sheet,e.rowStart,e.numberOfRows);return this.fixRangesWhenAddingRows(e.sheet,e.rowStart,e.numberOfRows),this.getArrayVerticesRelatedToRanges(n.verticesWithChangedSize)});this.stats.measure(wt.ADJUSTING_ARRAY_MAPPING,()=>{this.fixArraysAfterAddingRow(e.sheet,e.rowStart,e.numberOfRows)});for(const n of this.addressMapping.verticesFromRowsSpan(e))this.graph.markNodeAsDirty(n);return this.addStructuralNodesToChangeSet(),{affectedArrays:t}}addColumns(e){this.stats.measure(wt.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.addColumns(e.sheet,e.columnStart,e.numberOfColumns)});const t=this.stats.measure(wt.ADJUSTING_RANGES,()=>{const n=this.rangeMapping.moveAllRangesInSheetAfterAddingColumns(e.sheet,e.columnStart,e.numberOfColumns);return this.fixRangesWhenAddingColumns(e.sheet,e.columnStart,e.numberOfColumns),this.getArrayVerticesRelatedToRanges(n.verticesWithChangedSize)});this.stats.measure(wt.ADJUSTING_ARRAY_MAPPING,()=>this.fixArraysAfterAddingColumn(e.sheet,e.columnStart,e.numberOfColumns));for(const n of this.addressMapping.verticesFromColumnsSpan(e))this.graph.markNodeAsDirty(n);return this.addStructuralNodesToChangeSet(),{affectedArrays:t,contentChanges:this.getAndClearContentChanges()}}isThereSpaceForArray(e){const t=e.getRangeOrUndef();if(t===void 0)return!1;for(const n of t.addresses(this)){const i=this.addressMapping.getCell(n);if(i!==void 0&&!(i instanceof ta)&&i!==e)return!1}return!0}moveCells(e,t,n,i){for(const s of e.addressesWithDirection(t,n,this)){const o=$e(i,s.col+t,s.row+n);let a=this.addressMapping.getCell(s);const l=this.addressMapping.getCell(o);if(this.addressMapping.removeCell(s),a!==void 0){this.graph.markNodeAsDirty(a),this.addressMapping.setCell(o,a);let u;for(const c of this.graph.adjacentNodes(a))c instanceof Fn&&!e.containsRange(c.range)&&(u=u??this.fetchCellOrCreateEmpty(s).vertex,this.graph.addEdge(u,c),this.graph.removeEdge(a,c));u&&(this.graph.markNodeAsDirty(u),this.addressMapping.setCell(s,u))}if(l!==void 0){a===void 0&&this.addressMapping.removeCell(o);for(const u of this.graph.adjacentNodes(l))a=a??this.fetchCellOrCreateEmpty(o).vertex,this.graph.addEdge(a,u),this.graph.markNodeAsDirty(a);this.removeVertex(l)}}for(const s of this.rangeMapping.rangeVerticesContainedInRange(e))for(const o of this.graph.adjacentNodes(s))if(o instanceof Fn&&!e.containsRange(o.range)){this.graph.removeEdge(s,o);for(const a of s.range.addresses(this)){const{vertex:l,id:u}=this.fetchCellOrCreateEmpty(a);this.graph.addEdge(u??l,o),this.addressMapping.setCell(a,l),this.graph.markNodeAsDirty(l)}}this.rangeMapping.moveRangesInsideSourceRange(e,t,n,i)}setArrayEmpty(e){const t=it.spanFrom(e.getAddress(this.lazilyTransformingAstService),e.width,e.height),n=this.graph.adjacentNodes(e);for(const i of t.addresses(this))this.addressMapping.removeCell(i);for(const i of n.values()){const s=B8(this.functionRegistry,i,e.getRange(),this.lazilyTransformingAstService,this);for(const o of s){const{vertex:a,id:l}=this.fetchCellOrCreateEmpty(o);this.graph.addEdge(l??a,i)}s.length>0&&this.graph.markNodeAsDirty(i)}this.removeVertex(e),this.arrayMapping.removeArray(e.getRange())}addVertex(e,t){this.graph.addNodeAndReturnId(t),this.addressMapping.setCell(e,t)}addArrayVertex(e,t){this.graph.addNodeAndReturnId(t),this.setAddressMappingForArrayVertex(t,e)}*arrayFormulaNodes(){for(const e of this.graph.getNodes())e instanceof Wr&&(yield e)}*entriesFromRowsSpan(e){yield*this.addressMapping.entriesFromRowsSpan(e)}*entriesFromColumnsSpan(e){yield*this.addressMapping.entriesFromColumnsSpan(e)}fetchCell(e){return this.addressMapping.getCellOrThrow(e)}getCell(e){return this.addressMapping.getCell(e,{throwIfSheetNotExists:!0})}getCellValue(e){return this.isPlaceholder(e.sheet)?new J(te.REF,ue.SheetRef):this.addressMapping.getCellValue(e)}getRawValue(e){return this.isPlaceholder(e.sheet)?null:this.addressMapping.getRawValue(e)}getScalarValue(e){if(this.isPlaceholder(e.sheet))return new J(te.REF,ue.SheetRef);const t=this.addressMapping.getCellValue(e);return t instanceof Ge?new J(te.VALUE,ue.ScalarExpected):t}existsEdge(e,t){return this.graph.existsEdge(e,t)}getSheetId(e){return this.sheetMapping.getSheetIdOrThrowError(e)}getSheetHeight(e){return this.addressMapping.getSheetHeight(e)}getSheetWidth(e){return this.addressMapping.getSheetWidth(e)}getArray(e){return this.arrayMapping.getArray(e)}getRange(e,t){return this.rangeMapping.getRangeVertex(e,t)}topSortWithScc(){return this.graph.topSortWithScc()}markAsVolatile(e){this.graph.markNodeAsVolatile(e)}markAsDependentOnStructureChange(e){this.graph.markNodeAsChangingWithStructure(e)}forceApplyPostponedTransformations(){for(const e of this.graph.getNodes())e instanceof Ms&&e.ensureRecentData(this.lazilyTransformingAstService)}*rawValuesFromRange(e){for(const t of e.addresses(this)){const n=this.getScalarValue(t);n!==It&&(yield[He(n),t])}}computeListOfValuesInRange(e){const t=[];for(const n of e.addresses(this)){const i=this.getScalarValue(n);t.push(i)}return t}shrinkArrayToCorner(e){this.cleanAddressMappingUnderArray(e);for(const t of this.adjacentArrayVertices(e)){let n;t instanceof ni?n=this.formulaDirectDependenciesToArray(t,e):n=this.rangeDirectDependenciesToArray(t,e);let i=!1;for(const[s,o]of n)e.isLeftCorner(s)&&(i=!0),this.graph.addEdge(o,t),this.graph.markNodeAsDirty(o);i||this.graph.removeEdge(e,t)}this.graph.markNodeAsDirty(e)}isArrayInternalCell(e){const t=this.getCell(e);return t instanceof Wr&&!t.isLeftCorner(e)}getAndClearContentChanges(){const e=this.changes;return this.changes=aa.empty(),e}getAdjacentNodesAddresses(e){const t=this.graph.adjacentNodes(e),n=[];return t.forEach(i=>{i instanceof Fn?n.push(Vg(i.start,i.end)):i instanceof ni&&n.push(i.getAddress(this.lazilyTransformingAstService))}),n}markAllCellsAsDirtyInSheet(e){const t=this.addressMapping.sheetEntries(e);for(const[,n]of t)this.graph.markNodeAsDirty(n)}markAllRangesAsDirtyInSheet(e){const t=this.rangeMapping.rangesInSheet(e);for(const n of t)this.graph.markNodeAsDirty(n)}mergeRangeVertices(e,t){const n=Array.from(this.rangeMapping.rangesInSheet(t));for(const i of n){if(!this.graph.hasNode(i))continue;const s=i.start,o=i.end;if(s.sheet!==t&&o.sheet!==t)continue;const a=$e(e,s.col,s.row),l=$e(e,o.col,o.row),u=this.rangeMapping.getRangeVertex(a,l);u?(this.rerouteDependents(i,u),this.removeVertexAndRerouteDependencies(i,u),this.rangeMapping.removeVertexIfExists(i),this.graph.markNodeAsDirty(u)):(this.rangeMapping.removeVertexIfExists(i),i.range.moveToSheet(e),this.rangeMapping.addOrUpdateVertex(i),this.graph.markNodeAsDirty(i))}}mergeCellVertices(e,t){const n=Array.from(this.addressMapping.sheetEntries(t));for(const[i,s]of n){const o=$e(e,i.col,i.row),a=this.getCell(o);a?(this.rerouteDependents(s,a),this.removeVertexAndCleanupDependencies(s),this.addressMapping.removeCell(i),this.graph.markNodeAsDirty(a)):(this.addressMapping.moveCell(i,o),this.graph.markNodeAsDirty(s))}}isPlaceholder(e){return e!==Ro.SHEET_FOR_WORKBOOK_EXPRESSIONS&&!this.sheetMapping.hasSheetWithId(e,{includePlaceholders:!1})}exchangeGraphNode(e,t){this.graph.addNodeAndReturnId(t);const n=this.graph.adjacentNodes(e);this.removeVertex(e),n.forEach(i=>{this.graph.hasNode(i)&&this.graph.addEdge(t,i)})}setArray(e,t){this.arrayMapping.setArray(e,t)}correctInfiniteRangesDependency(e){const t=this.graph.getInfiniteRanges().filter(({node:o})=>o.range.addressInRange(e));if(t.length<=0)return;const{vertex:n,id:i}=this.fetchCellOrCreateEmpty(e),s=i??this.graph.getNodeId(n);if(s===void 0)throw new Error("Vertex not found");t.forEach(({id:o})=>{this.graph.addEdge(s,o)})}exchangeOrAddGraphNode(e,t){e?this.exchangeGraphNode(e,t):this.graph.addNodeAndReturnId(t)}getArrayVerticesRelatedToRanges(e){const t=new Set;return e.forEach(n=>{this.graph.hasNode(n)&&this.graph.adjacentNodes(n).forEach(i=>{i instanceof Wr&&t.add(i)})}),t}correctInfiniteRangesDependenciesByRangeVertex(e){this.graph.getInfiniteRanges().forEach(({id:t,node:n})=>{const i=e.range.intersectionWith(n.range);i!==void 0&&i.addresses(this).forEach(s=>{const{vertex:o,id:a}=this.fetchCellOrCreateEmpty(s);this.graph.addEdge(a??o,t)})})}cleanAddressMappingUnderArray(e){const t=e.getRange();for(const n of t.addresses(this)){const i=e.getArrayCellValue(n);this.getCell(n)===e?e.isLeftCorner(n)?this.changes.addChange(new J(te.REF),n,i):(this.addressMapping.removeCell(n),this.changes.addChange(It,n,i)):this.changes.addChange(It,n,i)}}*formulaDirectDependenciesToArray(e,t){var n;const[,i]=(n=this.formulaDependencyQuery(e))!==null&&n!==void 0?n:[];if(i!==void 0){for(const s of i)if(!(s instanceof mo||s instanceof it)&&t.getRange().addressInRange(s)){const o=this.fetchCellOrCreateEmpty(s).vertex;yield[s,o]}}}*rangeDirectDependenciesToArray(e,t){const{restRange:n}=this.rangeMapping.findSmallerRange(e.range);for(const i of n.addresses(this))if(t.getRange().addressInRange(i)){const s=this.fetchCellOrCreateEmpty(i).vertex;yield[i,s]}}*adjacentArrayVertices(e){const t=this.graph.adjacentNodes(e);for(const n of t)(n instanceof ni||n instanceof Fn)&&(yield n)}addStructuralNodesToChangeSet(){this.graph.markChangingWithStructureNodesAsDirty()}fixRangesWhenAddingRows(e,t,n){const i=Array.from(this.rangeMapping.rangesInSheet(e));for(const s of i)if(s.range.includesRow(t+n))if(s.bruteForce){const o=s.range.rangeWithSameWidth(t,n);for(const a of o.addresses(this)){const{vertex:l,id:u}=this.fetchCellOrCreateEmpty(a);this.graph.addEdge(u??l,s)}}else{let o=s,a=this.rangeMapping.findSmallerRange(o.range);if(a.smallerRangeVertex!==void 0)continue;for(;a.smallerRangeVertex===void 0;){const l=new Fn(it.spanFrom(o.range.start,o.range.width(),o.range.height()-1));this.rangeMapping.addOrUpdateVertex(l),this.graph.addNodeAndReturnId(l);const u=new it($e(o.range.start.sheet,o.range.start.col,o.range.end.row),o.range.end);this.addAllFromRange(u,o),this.graph.addEdge(l,o),o=l,a=this.rangeMapping.findSmallerRange(o.range)}this.graph.addEdge(a.smallerRangeVertex,o),this.addAllFromRange(a.restRange,o),this.graph.removeEdge(a.smallerRangeVertex,s)}}addAllFromRange(e,t){for(const n of e.addresses(this)){const{vertex:i,id:s}=this.fetchCellOrCreateEmpty(n);this.graph.addEdge(s??i,t)}}fixRangesWhenAddingColumns(e,t,n){for(const i of this.rangeMapping.rangesInSheet(e))if(i.range.includesColumn(t+n)){let s;i.bruteForce?s=i.range.rangeWithSameHeight(t,n):s=it.spanFrom($e(e,t,i.range.end.row),n,1);for(const o of s.addresses(this)){const{vertex:a,id:l}=this.fetchCellOrCreateEmpty(o);this.graph.addEdge(l??a,i)}}}exchangeOrAddFormulaVertex(e){const t=e.getAddress(this.lazilyTransformingAstService),n=it.spanFrom(t,e.width,e.height),i=this.shrinkPossibleArrayAndGetCell(t);if(e instanceof Wr&&this.setArray(n,e),this.exchangeOrAddGraphNode(i,e),this.addressMapping.setCell(t,e),e instanceof Wr){if(!this.isThereSpaceForArray(e))return;for(const s of n.addresses(this)){if(e.isLeftCorner(s))continue;const o=this.getCell(s);this.exchangeOrAddGraphNode(o,e)}}for(const s of n.addresses(this))this.addressMapping.setCell(s,e)}setAddressMappingForArrayVertex(e,t){if(this.addressMapping.setCell(t,e),!(e instanceof Wr))return;const n=it.spanFromOrUndef(t,e.width,e.height);if(n!==void 0&&(this.setArray(n,e),!!this.isThereSpaceForArray(e)))for(const i of n.addresses(this))this.addressMapping.setCell(i,e)}truncateRanges(e,t){const{verticesToRemove:n,verticesToMerge:i,verticesWithChangedSize:s}=this.rangeMapping.truncateRanges(e,t);for(const[o,a]of i)this.rerouteDependents(a,o),this.removeVertexAndCleanupDependencies(a);for(const o of n)this.removeVertexAndCleanupDependencies(o);return s}fixArraysAfterAddingRow(e,t,n){if(this.arrayMapping.moveArrayVerticesAfterRowByRows(e,t,n),!(t<=0))for(const[,i]of this.arrayMapping.arraysInRows(si.fromRowStartAndEnd(e,t-1,t-1))){const s=i.getRange();for(let o=s.start.col;o<=s.end.col;++o)for(let a=t;a<=s.end.row;++a){const l=$e(e,o,a),u=$e(e,o,a+n),c=i.getArrayCellValue(l);this.addressMapping.moveCell(u,l),this.changes.addChange(It,u,c)}}}fixArraysAfterRemovingRows(e,t,n){if(this.arrayMapping.moveArrayVerticesAfterRowByRows(e,t,-n),!(t<=0))for(const[,i]of this.arrayMapping.arraysInRows(si.fromRowStartAndEnd(e,t-1,t-1)))if(this.isThereSpaceForArray(i))for(const s of i.getRange().addresses(this))this.addressMapping.setCell(s,i);else this.setNoSpaceIfArray(i)}fixArraysAfterAddingColumn(e,t,n){if(this.arrayMapping.moveArrayVerticesAfterColumnByColumns(e,t,n),!(t<=0))for(const[,i]of this.arrayMapping.arraysInCols(xi.fromColumnStartAndEnd(e,t-1,t-1))){const s=i.getRange();for(let o=s.start.row;o<=s.end.row;++o)for(let a=t;a<=s.end.col;++a){const l=$e(e,a,o),u=$e(e,a+n,o),c=i.getArrayCellValue(l);this.addressMapping.moveCell(u,l),this.changes.addChange(It,u,c)}}}fixArraysAfterRemovingColumns(e,t,n){if(this.arrayMapping.moveArrayVerticesAfterColumnByColumns(e,t,-n),!(t<=0))for(const[,i]of this.arrayMapping.arraysInCols(xi.fromColumnStartAndEnd(e,t-1,t-1)))if(this.isThereSpaceForArray(i))for(const s of i.getRange().addresses(this))this.addressMapping.setCell(s,i);else this.setNoSpaceIfArray(i)}shrinkPossibleArrayAndGetCell(e){const t=this.getCell(e);return t instanceof Wr?(this.setNoSpaceIfArray(t),this.getCell(e)):t}setNoSpaceIfArray(e){e instanceof Wr&&(this.shrinkArrayToCorner(e),e.setNoSpace())}removeVertex(e){this.removeVertexAndCleanupDependencies(e),e instanceof Fn&&this.rangeMapping.removeVertexIfExists(e)}rerouteDependents(e,t){const n=this.graph.adjacentNodes(e);this.graph.removeEdgeIfExists(t,e),n.forEach(i=>{this.graph.hasNode(i)&&this.graph.addEdge(t,i)})}removeVertexAndRerouteDependencies(e,t){const n=this.graph.removeNode(e);this.graph.removeEdgeIfExists(t,e),n.forEach(([i,s])=>{this.graph.hasNode(s)&&this.graph.addEdge(s,t)})}removeVertexAndCleanupDependencies(e){const t=new Set(this.graph.removeNode(e)),n=new Set;for(;t.size>0;){const i=t.values().next().value;t.delete(i);const[s,o]=i;this.graph.hasNode(o)&&this.graph.adjacentNodesCount(o)===0&&((o instanceof Fn||o instanceof ta)&&this.graph.removeNode(o).forEach(a=>t.add(a)),o instanceof Fn?(this.rangeMapping.removeVertexIfExists(o),n.add(o.sheet)):o instanceof ta&&kr(s)&&(this.addressMapping.removeCell(s),n.add(s.sheet)))}this.cleanupPlaceholderSheets(n)}cleanupPlaceholderSheets(e){for(const t of e)this.isPlaceholder(t)&&!this.addressMapping.hasAnyEntries(t)&&this.rangeMapping.getNumberOfRangesInSheet(t)===0&&(this.sheetMapping.removeSheetIfExists(t,{includePlaceholders:!0}),this.addressMapping.removeSheetIfExists(t))}}class ta{constructor(){}getCellValue(){return It}}class la{constructor(e,t){this.parsedValue=e,this.rawValue=t}getValues(){return{parsedValue:this.parsedValue,rawValue:this.rawValue}}setValues(e){this.parsedValue=e.parsedValue,this.rawValue=e.rawValue}getCellValue(){return this.parsedValue}}class Yl{constructor(e,t){this.errors=e,this.rawInput=t}getCellValue(){const e=this.errors.map(t=>t.message).find(t=>t);return J.parsingError(e)}getFormula(){return this.rawInput}}class W8{constructor(e,t){this.width=e,this.height=t,this.mapping=new Map}getCell(e){var t;return(t=this.mapping.get(e.col))===null||t===void 0?void 0:t.get(e.row)}setCell(e,t){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1);let n=this.mapping.get(e.col);n||(n=new Map,this.mapping.set(e.col,n)),n.set(e.row,t)}has(e){var t;return!!(!((t=this.mapping.get(e.col))===null||t===void 0)&&t.get(e.row))}getHeight(){return this.height}getWidth(){return this.width}removeCell(e){var t;(t=this.mapping.get(e.col))===null||t===void 0||t.delete(e.row)}addRows(e,t){this.mapping.forEach(n=>{const i=new Map;n.forEach((s,o)=>{o>=e&&(i.set(o+t,s),n.delete(o))}),i.forEach((s,o)=>{n.set(o,s)})}),this.height+=t}addColumns(e,t){const n=new Map;this.mapping.forEach((i,s)=>{s>=e&&(n.set(s+t,i),this.mapping.delete(s))}),n.forEach((i,s)=>{this.mapping.set(s,i)}),this.width+=t}removeRows(e){this.mapping.forEach(i=>{const s=new Map;i.forEach((o,a)=>{a>=e.rowStart&&(i.delete(a),a>e.rowEnd&&s.set(a-e.numberOfRows,o))}),s.forEach((o,a)=>{i.set(a,o)})});const t=Math.min(this.height-1,e.rowEnd),n=Math.max(0,t-e.rowStart+1);this.height=Math.max(0,this.height-n)}removeColumns(e){const t=new Map;this.mapping.forEach((s,o)=>{o>=e.columnStart&&(this.mapping.delete(o),o>e.columnEnd&&t.set(o-e.numberOfColumns,s))}),t.forEach((s,o)=>{this.mapping.set(o,s)});const n=Math.min(this.width-1,e.columnEnd),i=Math.max(0,n-e.columnStart+1);this.width=Math.max(0,this.width-i)}*getEntries(e){for(const[t,n]of this.mapping)for(const[i,s]of n)yield[$e(e,t,i),s]}*verticesFromColumn(e){const t=this.mapping.get(e);if(t!==void 0)for(const[n,i]of t)yield i}*verticesFromRow(e){for(const t of this.mapping.values()){const n=t.get(e);n!==void 0&&(yield n)}}*verticesFromColumnsSpan(e){for(const t of e.columns()){const n=this.mapping.get(t);if(n!==void 0)for(const[i,s]of n)yield s}}*verticesFromRowsSpan(e){for(const t of this.mapping.values())for(const n of e.rows()){const i=t.get(n);i!==void 0&&(yield i)}}*entriesFromRowsSpan(e){for(const[t,n]of this.mapping.entries())for(const i of e.rows()){const s=n.get(i);s!==void 0&&(yield[$e(e.sheet,t,i),s])}}*entriesFromColumnsSpan(e){for(const t of e.columns()){const n=this.mapping.get(t);if(n!==void 0)for(const[i,s]of n.entries())yield[$e(e.sheet,t,i),s]}}*vertices(){for(const[e,t]of this.mapping)for(const[n,i]of t)i!==void 0&&(yield i)}}class Bg{constructor(e,t){this.width=e,this.height=t,this.mapping=new Array(t);for(let n=0;n<t;n++)this.mapping[n]=new Array(e)}getCell(e){return this.getCellVertex(e.col,e.row)}setCell(e,t){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1),this.mapping[e.row]||(this.mapping[e.row]=new Array(this.width)),this.mapping[e.row][e.col]=t}has(e){const t=this.mapping[e.row];return t?!!t[e.col]:!1}getHeight(){return this.height}getWidth(){return this.width}removeCell(e){this.mapping[e.row]!==void 0&&delete this.mapping[e.row][e.col]}addRows(e,t){const n=[];for(let i=0;i<t;i++)n.push(new Array(this.width));this.mapping.splice(e,0,...n),this.height+=t}addColumns(e,t){for(let n=0;n<this.height;n++)this.mapping[n]!==void 0&&this.mapping[n].splice(e,0,...new Array(t));this.width+=t}removeRows(e){this.mapping.splice(e.rowStart,e.numberOfRows);const t=Math.min(this.height-1,e.rowEnd),n=Math.max(0,t-e.rowStart+1);this.height=Math.max(0,this.height-n)}removeColumns(e){for(let i=0;i<this.height;i++)this.mapping[i]!==void 0&&this.mapping[i].splice(e.columnStart,e.numberOfColumns);const t=Math.min(this.width-1,e.columnEnd),n=Math.max(0,t-e.columnStart+1);this.width=Math.max(0,this.width-n)}*getEntries(e){for(let t=0;t<this.height;++t)for(let n=0;n<this.width;++n){const i=this.getCellVertex(n,t);i&&(yield[$e(e,n,t),i])}}*verticesFromColumn(e){for(let t=0;t<this.height;++t){const n=this.getCellVertex(e,t);n&&(yield n)}}*verticesFromRow(e){for(let t=0;t<this.width;++t){const n=this.getCellVertex(t,e);n&&(yield n)}}*verticesFromColumnsSpan(e){for(let t=e.columnStart;t<=e.columnEnd;++t)for(let n=0;n<this.height;++n){const i=this.getCellVertex(t,n);i&&(yield i)}}*verticesFromRowsSpan(e){for(let t=0;t<this.width;++t)for(let n=e.rowStart;n<=e.rowEnd;++n){const i=this.getCellVertex(t,n);i&&(yield i)}}*entriesFromRowsSpan(e){for(let t=0;t<this.width;++t)for(let n=e.rowStart;n<=e.rowEnd;++n){const i=this.getCellVertex(t,n);i&&(yield[$e(e.sheet,t,n),i])}}*entriesFromColumnsSpan(e){for(let t=e.columnStart;t<=e.columnEnd;++t)for(let n=0;n<this.height;++n){const i=this.getCellVertex(t,n);i&&(yield[$e(e.sheet,t,n),i])}}*vertices(){for(let e=0;e<this.height;++e)for(let t=0;t<this.width;++t){const n=this.getCellVertex(t,e);n&&(yield n)}}getCellVertex(e,t){var n;return(n=this.mapping[t])===null||n===void 0?void 0:n[e]}}var te;(function(r){r.DIV_BY_ZERO="DIV_BY_ZERO",r.NAME="NAME",r.VALUE="VALUE",r.NUM="NUM",r.NA="NA",r.CYCLE="CYCLE",r.REF="REF",r.SPILL="SPILL",r.LIC="LIC",r.ERROR="ERROR"})(te||(te={}));var ei;(function(r){r.FORMULA="FORMULA",r.VALUE="VALUE",r.ARRAY="ARRAY",r.EMPTY="EMPTY",r.ARRAYFORMULA="ARRAYFORMULA"})(ei||(ei={}));const G8=(r,e)=>r instanceof Wr?r.isLeftCorner(e)?ei.ARRAYFORMULA:ei.ARRAY:r instanceof Ms||r instanceof Yl?ei.FORMULA:r instanceof la?ei.VALUE:ei.EMPTY;var wf;(function(r){r.EMPTY="EMPTY",r.NUMBER="NUMBER",r.STRING="STRING",r.BOOLEAN="BOOLEAN",r.ERROR="ERROR"})(wf||(wf={}));var Ug;(function(r){r.NUMBER="NUMBER"})(Ug||(Ug={}));const rs=Object.assign(Object.assign({},wf),Ug),q8=Object.assign(Object.assign({},wf),Qe),I1=r=>{switch(r){case rs.EMPTY:return 0;case rs.NUMBER:return 1;case rs.STRING:return 2;case rs.BOOLEAN:return 3;case rs.ERROR:return 4}throw new Error("Cell value not computed")},_f=r=>{if(r===It)return rs.EMPTY;if(r instanceof J||r instanceof Ge)return rs.ERROR;if(typeof r=="string")return rs.STRING;if(Qt(r))return rs.NUMBER;if(typeof r=="boolean")return rs.BOOLEAN;throw new Error("Cell value not computed")},Y8=r=>Qt(r)?N8(r):_f(r),X8=r=>{if(Qt(r))return M8(r)};class J{constructor(e,t,n){this.type=e,this.message=t,this.root=n}static parsingError(e){return new J(te.ERROR,`${ue.ParseError}${e?" "+e:""}`)}attachRootVertex(e){return this.root===void 0?new J(this.type,this.message,e):this}}const RS=(r,e)=>({sheet:r,row:e}),K8=r=>r.row<0,AS=(r,e)=>({sheet:r,col:e}),Z8=r=>r.col<0,$e=(r,e,t)=>({sheet:r,col:e,row:t}),ii=r=>r.col<0||r.row<0,Q8=(r,e,t,n)=>$e(e,r.col+t,r.row+n),ac=r=>`${r.sheet},${r.row},${r.col}`;function kr(r){var e,t,n;return r&&(typeof r=="object"||typeof r=="function")&&typeof((e=r)===null||e===void 0?void 0:e.sheet)=="number"&&typeof((t=r)===null||t===void 0?void 0:t.col)=="number"&&typeof((n=r)===null||n===void 0?void 0:n.row)=="number"}const ls=(r,e)=>{var t;return(t=r.sheet)!==null&&t!==void 0?t:e.sheet},Oc=(r,e)=>r.sheet===e.sheet&&r.col===e.col&&r.row===e.row;const J8="AbsoluteCellRange: Wrong range size";function gi(r){if(r&&(typeof r=="object"||typeof r=="function")){const e=r;return"start"in e&&kr(e.start)&&"end"in e&&kr(e.end)}else return!1}const Vg=(r,e)=>({start:r,end:e});class it{constructor(e,t){if(e.sheet!==t.sheet)throw new Cc(e.sheet,t.sheet);this.start=$e(e.sheet,e.col,e.row),this.end=$e(t.sheet,t.col,t.row)}get sheet(){return this.start.sheet}static fromSimpleCellAddresses(e,t){if(e.sheet!==t.sheet)throw new Cc(e.sheet,t.sheet);const n=t.col-e.col,i=t.row-e.row;return Number.isFinite(i)&&Number.isFinite(n)?new it(e,t):Number.isFinite(i)?new wo(e.sheet,e.row,t.row):new bo(e.sheet,e.col,t.col)}static fromAst(e,t){return e.type===oe.CELL_RANGE?it.fromCellRange(e,t):e.type===oe.COLUMN_RANGE?bo.fromColumnRange(e,t):wo.fromRowRangeAst(e,t)}static fromAstOrUndef(e,t){try{return it.fromAst(e,t)}catch{return}}static fromCellRange(e,t){return new it(e.start.toSimpleCellAddress(t),e.end.toSimpleCellAddress(t))}static spanFrom(e,t,n){const i=it.spanFromOrUndef(e,t,n);if(i===void 0)throw new Error(J8);return i}static spanFromOrUndef(e,t,n){if(!Number.isFinite(t)&&Number.isFinite(n))return e.col!==0?void 0:new wo(e.sheet,e.row,e.row+n-1);if(!Number.isFinite(n)&&Number.isFinite(t))return e.row!==0?void 0:new bo(e.sheet,e.col,e.col+t-1);if(Number.isFinite(n)&&Number.isFinite(t))return new it(e,$e(e.sheet,e.col+t-1,e.row+n-1))}static fromCoordinates(e,t,n,i,s){return new it($e(e,t,n),$e(e,i,s))}isFinite(){return Number.isFinite(this.size())}doesOverlap(e){return!(this.start.sheet!=e.start.sheet||this.end.row<e.start.row||this.start.row>e.end.row||this.end.col<e.start.col||this.start.col>e.end.col)}addressInRange(e){return this.sheet!==e.sheet?!1:this.start.row<=e.row&&this.end.row>=e.row&&this.start.col<=e.col&&this.end.col>=e.col}columnInRange(e){return this.sheet!==e.sheet?!1:this.start.col<=e.col&&this.end.col>=e.col}rowInRange(e){return this.sheet!==e.sheet?!1:this.start.row<=e.row&&this.end.row>=e.row}containsRange(e){return this.addressInRange(e.start)&&this.addressInRange(e.end)}intersectionWith(e){if(this.sheet!==e.start.sheet)return;const t=Math.max(this.start.row,e.start.row),n=Math.min(this.end.row,e.end.row),i=Math.max(this.start.col,e.start.col),s=Math.min(this.end.col,e.end.col);if(!(t>n||i>s))return new it($e(this.sheet,i,t),$e(this.sheet,s,n))}includesRow(e){return this.start.row<e&&this.end.row>=e}includesColumn(e){return this.start.col<e&&this.end.col>=e}shiftByRows(e){this.start.row+=e,this.end.row+=e}expandByRows(e){this.end.row+=e}shiftByColumns(e){this.start.col+=e,this.end.col+=e}shifted(e,t){return it.spanFrom($e(this.sheet,this.start.col+e,this.start.row+t),this.width(),this.height())}expandByColumns(e){this.end.col+=e}moveToSheet(e){this.start.sheet=e,this.end.sheet=e}removeSpan(e){e instanceof si?this.removeRows(e.start,e.end):this.removeColumns(e.start,e.end)}shouldBeRemoved(){return this.width()<=0||this.height()<=0}rangeWithSameWidth(e,t){return it.spanFrom($e(this.sheet,this.start.col,e),this.width(),t)}rangeWithSameHeight(e,t){return it.spanFrom($e(this.sheet,e,this.start.row),t,this.height())}toString(){return`${this.start.sheet},${this.start.col},${this.start.row},${this.end.col},${this.end.row}`}width(){return this.end.col-this.start.col+1}height(){return this.end.row-this.start.row+1}size(){return this.height()*this.width()}arrayOfAddressesInRange(){const e=[];for(let t=0;t<this.height();++t){e[t]=[];for(let n=0;n<this.width();++n){const i=$e(this.sheet,this.start.col+n,this.start.row+t);e[t].push(i)}}return e}withStart(e){return new it(e,this.end)}sameDimensionsAs(e){return this.width()===e.width()&&this.height()===e.height()}sameAs(e){return Oc(this.start,e.start)&&Oc(this.end,e.end)}addressesArrayMap(e,t){const n=[];let i=this.start.row;for(;i<=this.effectiveEndRow(e);){let s=this.start.col;const o=[];for(;s<=this.effectiveEndColumn(e);)o.push(t($e(this.start.sheet,s,i))),s++;n.push(o),i++}return n}addresses(e){const t=[];let n=this.start.row;const i=this.effectiveEndRow(e),s=this.effectiveEndColumn(e);for(;n<=i;){let o=this.start.col;for(;o<=s;)t.push($e(this.start.sheet,o,n)),o++;n++}return t}*addressesWithDirection(e,t,n){if(e>0)if(t>0){let i=this.effectiveEndRow(n);for(;i>=this.start.row;){let s=this.effectiveEndColumn(n);for(;s>=this.start.col;)yield $e(this.start.sheet,s,i),s-=1;i-=1}}else{let i=this.start.row;for(;i<=this.effectiveEndRow(n);){let s=this.effectiveEndColumn(n);for(;s>=this.start.col;)yield $e(this.start.sheet,s,i),s-=1;i+=1}}else if(t>0){let i=this.effectiveEndRow(n);for(;i>=this.start.row;){let s=this.start.col;for(;s<=this.effectiveEndColumn(n);)yield $e(this.start.sheet,s,i),s+=1;i-=1}}else{let i=this.start.row;for(;i<=this.effectiveEndRow(n);){let s=this.start.col;for(;s<=this.effectiveEndColumn(n);)yield $e(this.start.sheet,s,i),s+=1;i+=1}}}getAddress(e,t){if(e<0||t<0||t>this.height()-1||e>this.width()-1)throw Error("Index out of bound");return $e(this.start.sheet,this.start.col+e,this.start.row+t)}exceedsSheetSizeLimits(e,t){return this.end.col>=e||this.end.row>=t}effectiveEndColumn(e){return this.end.col}effectiveEndRow(e){return this.end.row}effectiveWidth(e){return this.width()}effectiveHeight(e){return this.height()}removeRows(e,t){if(!(e>this.end.row)){if(t<this.start.row){const n=t-e+1;return this.shiftByRows(-n)}e<=this.start.row&&(this.start.row=e),this.end.row-=Math.min(t,this.end.row)-e+1}}removeColumns(e,t){if(!(e>this.end.col)){if(t<this.start.col){const n=t-e+1;return this.shiftByColumns(-n)}e<=this.start.col&&(this.start.col=e),this.end.col-=Math.min(t,this.end.col)-e+1}}}class bo extends it{constructor(e,t,n){super($e(e,t,0),$e(e,n,Number.POSITIVE_INFINITY))}static fromColumnRange(e,t){const n=e.start.toSimpleColumnAddress(t),i=e.end.toSimpleColumnAddress(t);if(n.sheet!==i.sheet)throw new Cc(n.sheet,i.sheet);return new bo(n.sheet,n.col,i.col)}shouldBeRemoved(){return this.width()<=0}shiftByRows(e){}expandByRows(e){}shifted(e,t){return new bo(this.sheet,this.start.col+e,this.end.col+e)}rangeWithSameHeight(e,t){return new bo(this.sheet,e,e+t-1)}exceedsSheetSizeLimits(e,t){return this.end.col>=e}effectiveEndRow(e){return this.effectiveHeight(e)-1}effectiveHeight(e){return e.getSheetHeight(this.sheet)}removeRows(e,t){}}class wo extends it{constructor(e,t,n){super($e(e,0,t),$e(e,Number.POSITIVE_INFINITY,n))}static fromRowRangeAst(e,t){const n=e.start.toSimpleRowAddress(t),i=e.end.toSimpleRowAddress(t);if(n.sheet!==i.sheet)throw new Cc(n.sheet,i.sheet);return new wo(n.sheet,n.row,i.row)}shouldBeRemoved(){return this.height()<=0}shiftByColumns(e){}expandByColumns(e){}shifted(e,t){return new wo(this.sheet,this.start.row+t,this.end.row+t)}rangeWithSameWidth(e,t){return new wo(this.sheet,e,e+t-1)}exceedsSheetSizeLimits(e,t){return this.end.row>=t}effectiveEndColumn(e){return this.effectiveWidth(e)-1}effectiveWidth(e){return e.getSheetWidth(this.sheet)}removeColumns(e,t){}}class Ls{constructor(e,t,n){this.formulaAddress=e,this.arraysFlag=t,this.formulaVertex=n}}function eO(r){const e=r.caseSensitive?r.accentSensitive?"variant":"case":r.accentSensitive?"accent":"base",t=r.caseFirst,n=r.ignorePunctuation;return new Intl.Collator(r.localeLang,{sensitivity:e,caseFirst:t,ignorePunctuation:n})}const tO="i",rO=/^\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij]))\s*(([+-])\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij])))?$/;class nO{constructor(e,t,n){this.config=e,this.dateTimeHelper=t,this.numberLiteralsHelper=n,this.lt=(i,s)=>this.compare(i,s)<0,this.leq=(i,s)=>this.compare(i,s)<=0,this.gt=(i,s)=>this.compare(i,s)>0,this.geq=(i,s)=>this.compare(i,s)>=0,this.eq=(i,s)=>this.compare(i,s)===0,this.neq=(i,s)=>this.compare(i,s)!==0,this.pow=(i,s)=>Math.pow(He(i),He(s)),this.addWithEpsilonRaw=(i,s)=>{const o=i+s;return Math.abs(o)<this.actualEps*Math.abs(i)?0:o},this.addWithEpsilon=(i,s)=>{const o=F1(i,s);return this.ExtendedNumberFactory(this.addWithEpsilonRaw(He(i),He(s)),o)},this.unaryMinus=i=>Dy(i,-He(i)),this.unaryPlus=i=>i,this.unaryPercent=i=>new vd(He(i)/100),this.concat=(i,s)=>i.concat(s),this.nonstrictadd=(i,s)=>i instanceof J?i:s instanceof J?s:typeof i=="number"?typeof s=="number"?this.addWithEpsilonRaw(i,s):i:typeof s=="number"?s:0,this.subtract=(i,s)=>{const o=F1(i,s),a=He(i),l=He(s);let u=a-l;return Math.abs(u)<this.actualEps*Math.abs(a)&&(u=0),this.ExtendedNumberFactory(u,o)},this.divide=(i,s)=>{const o=He(i),a=He(s);if(a===0)return new J(te.DIV_BY_ZERO);{const l=L1(i,s);return this.ExtendedNumberFactory(o/a,l)}},this.multiply=(i,s)=>{const o=L1(i,s);return this.ExtendedNumberFactory(He(i)*He(s),o)},this.manyToExactComplex=i=>{const s=[];for(const o of i){if(o instanceof J)return o;if(Qt(o)||typeof o=="string"){const a=this.coerceScalarToComplex(o);a instanceof J||s.push(a)}}return s},this.coerceNumbersExactRanges=i=>this.manyToNumbers(i,this.manyToExactNumbers),this.coerceNumbersCoerceRangesDropNulls=i=>this.manyToNumbers(i,this.manyToCoercedNumbersDropNulls),this.manyToExactNumbers=i=>{const s=[];for(const o of i){if(o instanceof J)return o;Qt(o)&&s.push(He(o))}return s},this.manyToOnlyNumbersDropNulls=i=>{const s=[];for(const o of i){if(o instanceof J)return o;if(Qt(o))s.push(He(o));else if(o!==It)return new J(te.VALUE,ue.NumberExpected)}return s},this.manyToCoercedNumbersDropNulls=i=>{const s=[];for(const o of i){if(o instanceof J)return o;if(o===It)continue;const a=this.coerceScalarToNumberOrError(o);Qt(a)&&s.push(He(a))}return s},this.collator=eO(e),this.actualEps=e.smartRounding?e.precisionEpsilon:0}eqMatcherFunction(e){const t=this.buildRegex(e);return n=>typeof n=="string"&&t.test(this.normalizeString(n))}neqMatcherFunction(e){const t=this.buildRegex(e);return n=>typeof n!="string"||!t.test(this.normalizeString(n))}searchString(e,t){var n;const s=this.buildRegex(e,!1).exec(t);return(n=s?.index)!==null&&n!==void 0?n:-1}requiresRegex(e){if(!this.config.useRegularExpressions&&!this.config.useWildcards)return!this.config.matchWholeCell;for(let t=0;t<e.length;t++){const n=e.charAt(t);if(Ic(n)||this.config.useRegularExpressions&&kc(n))return!0}return!1}floatCmp(e,t){const n=He(e),i=He(t),s=1+this.actualEps;return i>=0&&n*s>=i&&n<=i*s||i<=0&&n*s<=i&&n>=i*s?0:n>i?1:-1}coerceScalarToNumberOrError(e){var t;return e instanceof J?e:(t=this.coerceToMaybeNumber(e))!==null&&t!==void 0?t:new J(te.VALUE,ue.NumberCoercion)}coerceToMaybeNumber(e){var t;return(t=this.coerceNonDateScalarToMaybeNumber(e))!==null&&t!==void 0?t:typeof e=="string"?this.dateTimeHelper.dateStringToDateNumber(e):void 0}coerceNonDateScalarToMaybeNumber(e){if(e===It)return 0;if(typeof e=="string"){if(e==="")return 0;const t=this.coerceStringToMaybePercentNumber(e);if(t!==void 0)return t;const n=this.coerceStringToMaybeCurrencyNumber(e);return n!==void 0?n:this.numberLiteralsHelper.numericStringToMaybeNumber(e.trim())}else return Qt(e)?e:typeof e=="boolean"?Number(e):void 0}coerceStringToMaybePercentNumber(e){const t=e.trim();if(t.endsWith("%")){const n=t.slice(0,t.length-1).trim(),i=this.numberLiteralsHelper.numericStringToMaybeNumber(n);if(i!==void 0)return new vd(i/100)}}coerceStringToMaybeCurrencyNumber(e){const t=this.currencyMatcher(e.trim());if(t!==void 0){const[n,i]=t,s=this.numberLiteralsHelper.numericStringToMaybeNumber(i);if(s!==void 0)return new Lg(s,n)}}currencyMatcher(e){for(const t of this.config.currencySymbol){if(e.startsWith(t))return[t,e.slice(t.length).trim()];if(e.endsWith(t))return[t,e.slice(0,e.length-t.length).trim()]}}coerceComplexExactRanges(e){const t=[];for(const i of e)if(i instanceof Ge)t.push(i);else if(i!==It){const s=this.coerceScalarToComplex(i);if(s instanceof J)return s;t.push(s)}const n=[];for(const i of t)if(i instanceof Ge){const s=this.manyToExactComplex(i.valuesFromTopLeftCorner());if(s instanceof J)return s;n.push(...s)}else n.push(i);return n}coerceScalarToComplex(e){return e instanceof J?e:e===It?[0,0]:Qt(e)?[He(e),0]:typeof e=="string"?this.coerceStringToComplex(e):new J(te.NUM,ue.ComplexNumberExpected)}ExtendedNumberFactory(e,t){const{type:n,format:i}=t;switch(n){case Qe.NUMBER_RAW:return e;case Qe.NUMBER_CURRENCY:return new Lg(e,i??this.config.currencySymbol[0]);case Qe.NUMBER_DATE:return new By(e,i);case Qe.NUMBER_DATETIME:return new Vy(e,i);case Qe.NUMBER_TIME:return new Uy(e,i);case Qe.NUMBER_PERCENT:return new vd(e,i)}}buildRegex(e,t=!0){e=this.normalizeString(e);let n,i=this.config.useWildcards,s=this.config.useRegularExpressions;if(s)try{RegExp(e)}catch{s=!1,i=!1}return s?n=aO(e,this.config.caseSensitive):i?n=sO(e,this.config.caseSensitive):n=oO(e,this.config.caseSensitive),this.config.matchWholeCell&&t?RegExp("^("+n+")$"):RegExp(n)}normalizeString(e){return this.config.caseSensitive||(e=e.toLowerCase()),this.config.accentSensitive||(e=IS(e,"nfd").replace(/[\u0300-\u036f]/g,"")),e}compare(e,t){if(typeof e=="string"||typeof t=="string"){const n=typeof e=="string"?this.dateTimeHelper.dateStringToDateNumber(e):e,i=typeof t=="string"?this.dateTimeHelper.dateStringToDateNumber(t):t;if(Qt(n)&&Qt(i))return this.floatCmp(n,i)}return e===It?e=k1(t):t===It&&(t=k1(e)),typeof e=="string"&&typeof t=="string"?this.stringCmp(e,t):typeof e=="boolean"&&typeof t=="boolean"?P1(jg(e),jg(t)):Qt(e)&&Qt(t)?this.floatCmp(e,t):e===It&&t===It?0:P1(I1(_f(e)),I1(_f(t)))}stringCmp(e,t){return this.collator.compare(e,t)}manyToNumbers(e,t){const n=[];for(const s of e)if(s instanceof Ge)n.push(s);else{const o=He(this.coerceScalarToNumberOrError(s));if(o instanceof J)return o;n.push(o)}const i=[];for(const s of n)if(s instanceof Ge){const o=t(s.valuesFromTopLeftCorner());if(o instanceof J)return o;i.push(...o)}else i.push(s);return i}coerceStringToComplex(e){const t=rO.exec(e);if(t===null)return new J(te.NUM,ue.ComplexNumberExpected);let n;if(t[6]!==void 0?n=t[1]==="-"?[0,-1]:[0,1]:n=this.parseComplexToken(t[1]+t[3],t[5]),n instanceof J||t[8]===void 0)return n;let i;return t[14]!==void 0?i=t[9]==="-"?[0,-1]:[0,1]:i=this.parseComplexToken(t[9]+t[11],t[13]),i instanceof J?i:t[5]!==""||t[13]===""?new J(te.NUM,ue.ComplexNumberExpected):t[8]==="+"?[n[0]+i[0],n[1]+i[1]]:[n[0]-i[0],n[1]-i[1]]}parseComplexToken(e,t){const n=He(this.coerceNonDateScalarToMaybeNumber(e));return n===void 0?new J(te.NUM,ue.ComplexNumberExpected):t===""?[n,0]:[0,n]}}function Ur([r,e],t){if(!isFinite(r)||!isFinite(e))return new J(te.NUM,ue.NaN);if(t=t??tO,e===0)return`${r}`;const n=`${e===-1||e===1?"":Math.abs(e)}${t}`;return r===0?`${e<0?"-":""}${n}`:`${r}${e<0?"-":"+"}${n}`}function CS(r){return r instanceof Ge?r:Ge.fromScalar(r)}function jg(r){return Number(r)}function k1(r){return typeof r=="string"?"":Qt(r)?0:typeof r=="boolean"?!1:It}function NS(r){if(r instanceof J||typeof r=="boolean")return r;if(r===It)return!1;if(Qt(r))return He(r)!==0;{const e=r.toUpperCase();return e==="TRUE"?!0:e==="FALSE"||e===""?!1:void 0}}function $g(r){return r instanceof J||typeof r=="string"?r:r===It?"":Qt(r)?He(r).toString():r?"TRUE":"FALSE"}function Nh(r){return r===It?0:r}function P1(r,e){const t=He(r),n=He(e);return t>n?1:t<n?-1:0}function MS(r){return isNaN(r)||r===1/0||r===-1/0}function OS(r){return r===0?0:r}function Ic(r){return["*","?"].includes(r)}const iO=["{","}","[","]","(",")","<",">","=",".","+","-",",","\\","$","^","!"];function kc(r){return iO.includes(r)}function sO(r,e){let t="";for(let n=0;n<r.length;n++){const i=r.charAt(n);if(i==="~"){if(n==r.length-1){t+="~";continue}const s=r.charAt(n+1);Ic(s)||kc(s)?(t+="\\"+s,n++):(t+=s,n++)}else Ic(i)?t+="."+i:kc(i)?t+="\\"+i:e?t+=i:t+=i.toLowerCase()}return t}function oO(r,e){let t="";for(let n=0;n<r.length;n++){const i=r.charAt(n);Ic(i)||kc(i)?t+="\\"+i:e?t+=i:t+=i.toLowerCase()}return t}function aO(r,e){let t="";for(let n=0;n<r.length;n++){const i=r.charAt(n);Ic(i)||kc(i)||e?t+=i:t+=i.toLowerCase()}return t}function F1(r,e){const{type:t,format:n}=gf(r),{type:i,format:s}=gf(e);if(t===Qe.NUMBER_RAW)return{type:i,format:s};if(i===Qe.NUMBER_RAW)return{type:t,format:n};if((t===Qe.NUMBER_DATETIME||t===Qe.NUMBER_DATE)&&(i===Qe.NUMBER_DATETIME||i===Qe.NUMBER_DATE))return{type:Qe.NUMBER_RAW};if(t===Qe.NUMBER_TIME){if(i===Qe.NUMBER_DATE)return{type:Qe.NUMBER_DATETIME,format:`${s} ${n}`};if(i===Qe.NUMBER_DATETIME)return{type:Qe.NUMBER_DATETIME,format:s}}if(i===Qe.NUMBER_TIME){if(t===Qe.NUMBER_DATE)return{type:Qe.NUMBER_DATETIME,format:`${n} ${s}`};if(t===Qe.NUMBER_DATETIME)return{type:Qe.NUMBER_DATETIME,format:n}}return{type:t,format:n}}function L1(r,e){let{type:t,format:n}=gf(r),{type:i,format:s}=gf(e);return t===Qe.NUMBER_PERCENT&&(t=Qe.NUMBER_RAW,n=void 0),i===Qe.NUMBER_PERCENT&&(i=Qe.NUMBER_RAW,s=void 0),t===Qe.NUMBER_RAW?{type:i,format:s}:i===Qe.NUMBER_RAW?{type:t,format:n}:{type:Qe.NUMBER_RAW}}function lc(r){return IS(r.toLowerCase(),"nfd").replace(/[\u0300-\u036f]/g,"")}function wd(r,e){var t;if(r.isAdHoc())return(t=r.data[0])===null||t===void 0?void 0:t[0];const n=r.range;if(e.formulaAddress.sheet===n.sheet){if(n.width()===1){const i=e.formulaAddress.row-n.start.row;if(i>=0&&i<n.height())return r.data[i][0]}else if(n.height()===1){const i=e.formulaAddress.col-n.start.col;if(i>=0&&i<n.width())return r.data[0][i]}}}function IS(r,e){return r.normalize(e.toUpperCase())}var z;(function(r){r.STRING="STRING",r.NUMBER="NUMBER",r.BOOLEAN="BOOLEAN",r.SCALAR="SCALAR",r.NOERROR="NOERROR",r.RANGE="RANGE",r.INTEGER="INTEGER",r.COMPLEX="COMPLEX",r.ANY="ANY"})(z||(z={}));class At{constructor(e){this.coerceScalarToNumberOrError=t=>this.arithmeticHelper.coerceScalarToNumberOrError(t),this.runFunction=(t,n,i,s)=>{const o=this.evaluateArguments(t,n,i),a=o.map(([m,p])=>m),l=o.map(([m,p])=>p),u=this.buildMetadataForEachArgumentValue(a.length,i),c=n.arraysFlag&&!i.vectorizationForbidden;if(!this.isNumberOfArgumentValuesValid(u,a.length))return new J(te.NA,ue.WrongArgNumber);const[d,h]=c?this.calculateSizeOfVectorizedResultArray(a,u):[1,1];if(d===1&&h===1){const m=this.vectorizeAndBroadcastArgumentsIfNecessary(c,a,u,0,0);return this.calculateSingleCellOfResultArray(n,m,u,l,s,i.returnNumberType)}const f=[...Array(d).keys()].map(m=>[...Array(h).keys()].map(p=>{const g=this.vectorizeAndBroadcastArgumentsIfNecessary(c,a,u,m,p),v=this.calculateSingleCellOfResultArray(n,g,u,l,s,i.returnNumberType);if(v instanceof Ge)throw new Error("Function returning array cannot be vectorized.");return v}));return Ge.onlyValues(f)},this.runFunctionWithReferenceArgument=(t,n,i,s,o,a=()=>new J(te.NA,ue.CellRefExpected))=>{if(t.length===0)return this.returnNumberWrapper(s(),i.returnNumberType);if(t.length>1)return new J(te.NA,ue.WrongArgNumber);let l=t[0];for(;l.type===oe.PARENTHESIS;)l=l.expression;let u;if(l.type===oe.CELL_REFERENCE)u=l.reference.toSimpleCellAddress(n.formulaAddress);else if(l.type===oe.CELL_RANGE||l.type===oe.COLUMN_RANGE||l.type===oe.ROW_RANGE)try{u=it.fromAst(l,n.formulaAddress).start}catch{return new J(te.REF,ue.CellRefExpected)}return u!==void 0?this.returnNumberWrapper(o(u),i.returnNumberType):this.runFunction(t,n,i,a)},this.interpreter=e,this.dependencyGraph=e.dependencyGraph,this.columnSearch=e.columnSearch,this.config=e.config,this.serialization=e.serialization,this.arraySizePredictor=e.arraySizePredictor,this.dateTimeHelper=e.dateTimeHelper,this.arithmeticHelper=e.arithmeticHelper}evaluateAst(e,t){return this.interpreter.evaluateAst(e,t)}arraySizeForAst(e,t){return this.arraySizePredictor.checkArraySizeForAst(e,t)}listOfScalarValues(e,t){const n=[];for(const i of e){const s=this.evaluateAst(i,t);if(s instanceof Ge)for(const o of s.valuesFromTopLeftCorner())n.push([o,!0]);else n.push([s,!1])}return n}coerceToType(e,t,n){let i;if(e instanceof Ge)switch(t.argumentType){case z.RANGE:case z.ANY:i=e;break;default:{const s=wd(e,n);if(s===void 0)return;e=s}}if(!(e instanceof Ge))switch(t.argumentType){case z.INTEGER:case z.NUMBER:const s=this.coerceScalarToNumberOrError(e);if(!Qt(s)){i=s;break}const o=He(s);if(t.maxValue!==void 0&&o>t.maxValue)return new J(te.NUM,ue.ValueLarge);if(t.minValue!==void 0&&o<t.minValue)return new J(te.NUM,ue.ValueSmall);if(t.lessThan!==void 0&&o>=t.lessThan)return new J(te.NUM,ue.ValueLarge);if(t.greaterThan!==void 0&&o<=t.greaterThan)return new J(te.NUM,ue.ValueSmall);if(t.argumentType===z.INTEGER&&!Number.isInteger(o))return new J(te.NUM,ue.IntegerExpected);i=s;break;case z.STRING:i=$g(e);break;case z.BOOLEAN:i=NS(e);break;case z.SCALAR:case z.NOERROR:case z.ANY:i=e;break;case z.RANGE:if(e instanceof J)return e;i=CS(e);break;case z.COMPLEX:return this.arithmeticHelper.coerceScalarToComplex(He(e))}return t.passSubtype||i===void 0?i:He(i)}calculateSingleCellOfResultArray(e,t,n,i,s,o){const a=this.coerceArgumentsToRequiredTypes(e,t,n,i);if(a instanceof J)return a;const l=s(...a);return this.returnNumberWrapper(l,o)}coerceArgumentsToRequiredTypes(e,t,n,i){const s=[];for(let o=0;o<n.length;o++){const a=n[o],l=t[o]!==void 0?t[o]:a?.defaultValue;if(l===void 0){s.push(void 0);continue}const u=this.coerceToType(l,a,e);if(u===void 0&&!i[o])return new J(te.VALUE,ue.WrongType);if(u instanceof J&&a.argumentType!==z.SCALAR)return u;s.push(u)}return s}vectorizeAndBroadcastArgumentsIfNecessary(e,t,n,i,s){return t.map((o,a)=>e&&this.isRangePassedAsAScalarArgument(o,n[a])?this.vectorizeAndBroadcastRangeArgument(o,i,s):o)}vectorizeAndBroadcastRangeArgument(e,t,n){var i;const s=e.height()===1?0:t,o=e.width()===1?0:n;return(i=e.data[s])===null||i===void 0?void 0:i[o]}evaluateArguments(e,t,n){return n.expandRanges?this.listOfScalarValues(e,t):e.map(i=>[this.evaluateAst(i,t),!1])}buildMetadataForEachArgumentValue(e,t){const n=t.parameters?[...t.parameters]:[];if(t.repeatLastArgs!==void 0&&Number.isInteger(t.repeatLastArgs)&&t.repeatLastArgs>0)for(;e>n.length;)n.push(...n.slice(n.length-t.repeatLastArgs));return n}isNumberOfArgumentValuesValid(e,t){return t>e.length?!1:t<e.length?e.slice(t).every(s=>s?.optionalArg||s?.defaultValue!==void 0):!0}calculateSizeOfVectorizedResultArray(e,t){const n=e.filter((o,a)=>this.isRangePassedAsAScalarArgument(o,t[a])),i=Math.max(1,...n.map(o=>o.height())),s=Math.max(1,...n.map(o=>o.width()));return[i,s]}isRangePassedAsAScalarArgument(e,t){return e==null||t==null?!1:e instanceof Ge&&![z.RANGE,z.ANY].includes(t.argumentType)}metadata(e){const t=this.constructor.implementedFunctions[e];if(t!==void 0)return t;throw new Error(`No metadata for function ${e}.`)}returnNumberWrapper(e,t,n){return t!==void 0&&Qt(e)?this.arithmeticHelper.ExtendedNumberFactory(He(e),{type:t,format:n}):e}}class Ct{constructor(e,t,n=!1){this.width=e,this.height=t,this.isRef=n}static error(){return new Ct(1,1,!0)}static scalar(){return new Ct(1,1,!1)}isScalar(){return this.width===1&&this.height===1||this.isRef}}function lO(r,e){return new Ct(Math.max(r.width,e.width),Math.max(r.height,e.height))}function uO(r){return new Ct(r.width,r.height)}class cO{constructor(e,t){this.config=e,this.functionRegistry=t}checkArraySize(e,t){return this.checkArraySizeForAst(e,{formulaAddress:t,arraysFlag:this.config.useArrayArithmetic})}checkArraySizeForAst(e,t){switch(e.type){case oe.FUNCTION_CALL:return this.checkArraySizeForFunction(e,t);case oe.COLUMN_RANGE:case oe.ROW_RANGE:case oe.CELL_RANGE:{const n=it.fromAstOrUndef(e,t.formulaAddress);return n===void 0?Ct.error():new Ct(n.width(),n.height(),!0)}case oe.ARRAY:{const n=[],i=[];for(const a of e.args){const l=a.map(d=>this.checkArraySizeForAst(d,t)),u=Math.min(...l.map(d=>d.height)),c=l.reduce((d,h)=>d+h.width,0);n.push(u),i.push(c)}const s=n.reduce((a,l)=>a+l,0),o=Math.min(...i);return new Ct(o,s)}case oe.STRING:case oe.NUMBER:return Ct.scalar();case oe.CELL_REFERENCE:return new Ct(1,1,!0);case oe.DIV_OP:case oe.CONCATENATE_OP:case oe.EQUALS_OP:case oe.GREATER_THAN_OP:case oe.GREATER_THAN_OR_EQUAL_OP:case oe.LESS_THAN_OP:case oe.LESS_THAN_OR_EQUAL_OP:case oe.MINUS_OP:case oe.NOT_EQUAL_OP:case oe.PLUS_OP:case oe.POWER_OP:case oe.TIMES_OP:{const n=this.checkArraySizeForAst(e.left,t),i=this.checkArraySizeForAst(e.right,t);return!t.arraysFlag&&(n.height>1||n.width>1||i.height>1||i.width>1)?Ct.error():lO(n,i)}case oe.MINUS_UNARY_OP:case oe.PLUS_UNARY_OP:case oe.PERCENT_OP:{const n=this.checkArraySizeForAst(e.value,t);return!t.arraysFlag&&(n.height>1||n.width>1)?Ct.error():uO(n)}case oe.PARENTHESIS:return this.checkArraySizeForAst(e.expression,t);case oe.EMPTY:return Ct.error();default:return Ct.error()}}checkArraySizeForFunction(e,t){const n=this.functionRegistry.getArraySizeFunction(e.procedureName);if(n!==void 0)return n(e,t);const i=this.functionRegistry.getMetadata(e.procedureName);if(i===void 0||i.expandRanges||!t.arraysFlag||i.vectorizationForbidden||i.parameters===void 0)return new Ct(1,1);const s=e.args.map(u=>{var c;return this.checkArraySizeForAst(u,new Ls(t.formulaAddress,t.arraysFlag||((c=i?.enableArrayArithmeticForArguments)!==null&&c!==void 0?c:!1)))}),o=[...i.parameters];if(i.repeatLastArgs!==void 0&&o.length<s.length&&(s.length-o.length)%i.repeatLastArgs!==0)return Ct.error();for(;o.length<s.length;){if(i.repeatLastArgs===void 0)return Ct.error();o.push(...o.slice(o.length-i.repeatLastArgs))}let a=1,l=1;for(let u=0;u<s.length;u++)o[u].argumentType!==z.RANGE&&o[u].argumentType!==z.ANY&&(l=Math.max(l,s[u].height),a=Math.max(a,s[u].width));return new Ct(a,l)}}class kS{constructor(e,t,n){var i;this.value=t,this.address=n,this.type=e.type,this.message=(i=e.message)!==null&&i!==void 0?i:""}toString(){return this.value}valueOf(){return this.value}}function sr(r,e,t){if(typeof r>"u")return Si.defaultConfig[t];if(typeof e=="string"){if(typeof r===e)return r;throw new Zt(e,t)}else{if(e.includes(r))return r;throw new _S(e.map(n=>`'${n}'`).join(" "),t)}}function El(r,e,t){if(r<t)throw new bS(e,t)}function hO(r,e,t){if(r>t)throw new wS(e,t)}function Mh(r,e,t,n){if(e(r))return r;if(typeof r>"u")return Si.defaultConfig[n];throw new Zt(t,n)}function D1(...r){const e=new Map;r.forEach(n=>{const i=e.get(n.value)||[];i.push(n.name),e.set(n.value,i)});const t=[];for(const n of e.values())n.length>1&&t.push(n);if(t.length>0){t.forEach(i=>i.sort());const n=t.map(i=>`[${i}]`).join("; ");throw new Error(`Config initialization failed. Parameters in conflict: ${n}`)}}function Fe(r,e,t){if(typeof r!==e)throw new Zt(e,t)}const zy=new RegExp("^ss(\\.(s+|0+))?$"),dO=new RegExp("^[0-9/.\\-: ]+[ap]?m?$"),fO=new RegExp("\\s+"),PS=new RegExp("[ /.-]"),zg=":",B1=1e3,pO=FS(yO),mO=FS(vO);function gO(r,e,t){if(e===void 0&&t===void 0)return;let n=r.replace(fO," ").trim().toLowerCase();if(!bO(n))return;let i=n.substring(n.length-2);i==="am"||i==="pm"?n=n.substring(0,n.length-2).trim():(i=n.substring(n.length-1),i==="a"||i==="p"?n=n.substring(0,n.length-1).trim():i=void 0);const s=n.split(PS);s.length>=2&&s[s.length-2].includes(zg)&&(s[s.length-2]=s[s.length-2]+"."+s[s.length-1],s.pop());const o=s[s.length-1].split(zg);if(i!==void 0&&o.push(i),s.length===1)return U1(o,t);if(o.length===1)return V1(s,e);const a=V1(s.slice(0,s.length-1),e),l=U1(o,t);if(a!==void 0)return l===void 0?void 0:Object.assign(Object.assign({},a),l)}function U1(r,e){var t,n,i;if(e===void 0)return;const{itemsCount:s,hourItem:o,minuteItem:a,secondItem:l}=pO(e);let u;if(r[r.length-1]==="am"||r[r.length-1]==="a"?(u=!1,r.pop()):(r[r.length-1]==="pm"||r[r.length-1]==="p")&&(u=!0,r.pop()),r.length!==s)return;const c=Number((t=r[l])!==null&&t!==void 0?t:"0");if(!Number.isFinite(c))return;const d=Math.round(c*B1)/B1,h=Number((n=r[a])!==null&&n!==void 0?n:"0");if(!(Number.isFinite(h)&&Number.isInteger(h)))return;const f=Number((i=r[o])!==null&&i!==void 0?i:"0");return!(Number.isFinite(f)&&Number.isInteger(f))||u!==void 0&&(f<0||f>12)?void 0:{hours:u!==void 0?f%12+(u?12:0):f,minutes:h,seconds:d}}function V1(r,e){var t;if(e===void 0)return;const{itemsCount:n,dayItem:i,monthItem:s,shortYearItem:o,longYearItem:a}=mO(e);if(r.length!==n)return;const l=Number(r[i]);if(!(Number.isFinite(l)&&Number.isInteger(l)))return;const u=Number(r[s]);if(!(Number.isFinite(u)&&Number.isInteger(u))||r[a]&&r[o])return;const c=Number((t=r[a])!==null&&t!==void 0?t:r[o]);if(Number.isFinite(c)&&Number.isInteger(c)&&!(r[a]&&(c<1e3||c>9999))&&!(r[o]&&(c<0||c>99)))return{year:c,month:u,day:l}}function yO(r){const e=r.toLowerCase().trim(),n=(e.endsWith("am/pm")?e.substring(0,e.length-5):e.endsWith("a/p")?e.substring(0,r.length-3):e).trim().split(zg);return{itemsCount:n.length,hourItem:n.indexOf("hh"),minuteItem:n.indexOf("mm"),secondItem:n.findIndex(i=>zy.test(i))}}function vO(r){const e=r.toLowerCase().trim().split(PS);return{itemsCount:e.length,dayItem:e.indexOf("dd"),monthItem:e.indexOf("mm"),shortYearItem:e.indexOf("yy"),longYearItem:e.indexOf("yyyy")}}function bO(r){return dO.test(r)}function FS(r){const e={};return t=>{const n=e[t];if(n!==void 0)return n;const i=r(t);return e[t]=i,i}}const Hg=[31,28,31,30,31,30,31,31,30,31,30,31],Vl=[0,31,59,90,120,151,181,212,243,273,304,334],Oh=60,Ih=60,Wg=24;function uc(r){return r&&(typeof r=="object"||typeof r=="function")?"year"in r&&typeof r.year=="number"&&"month"in r&&typeof r.month=="number"&&"day"in r&&typeof r.day=="number":!1}function LS(r){return r&&(typeof r=="object"||typeof r=="function")?"hours"in r&&typeof r.hours=="number"&&"minutes"in r&&typeof r.minutes=="number"&&"seconds"in r&&typeof r.seconds=="number":!1}const wO={year:9999,month:12,day:31};class _O{constructor(e){this.config=e,this.minDateAbsoluteValue=this.dateToNumberFromZero(e.nullDate),this.maxDateValue=this.dateToNumber(wO),this.leapYear1900=e.leapYear1900,!this.leapYear1900&&0<=this.dateToNumber({year:1900,month:2,day:28})?this.epochYearZero=this.numberToSimpleDate(2).year:this.epochYearZero=this.numberToSimpleDate(1).year,this.parseDateTime=e.parseDateTime}getWithinBounds(e){return e<=this.maxDateValue&&e>=0?e:void 0}dateStringToDateNumber(e){const{dateTime:t,dateFormat:n="",timeFormat:i=""}=this.parseDateTimeFromConfigFormats(e);if(t!==void 0)return LS(t)?uc(t)?new Vy(Kl(t)+this.dateToNumber(t),n+" "+i):new Uy(Kl(t),i):uc(t)?new By(this.dateToNumber(t),n):0}parseDateTimeFromConfigFormats(e){return this.parseDateTimeFromFormats(e,this.config.dateFormats,this.config.timeFormats)}getNullYear(){return this.config.nullYear}getEpochYearZero(){return this.epochYearZero}isValidDate(e){return isNaN(e.year)||isNaN(e.month)||isNaN(e.day)||e.day!==Math.round(e.day)||e.month!==Math.round(e.month)||e.year!==Math.round(e.year)||e.year<1582||e.month<1||e.month>12||e.day<1?!1:this.isLeapYear(e.year)&&e.month===2?e.day<=29:e.day<=Hg[e.month-1]}dateToNumber(e){return this.dateToNumberFromZero(e)-this.minDateAbsoluteValue}relativeNumberToAbsoluteNumber(e){return e+this.minDateAbsoluteValue-(this.leapYear1900?1:0)}numberToSimpleDate(e){const t=Math.floor(e)+this.minDateAbsoluteValue;let n=Math.floor(t/365.2425);this.dateToNumberFromZero({year:n+1,month:1,day:1})<=t?n++:this.dateToNumberFromZero({year:n-1,month:1,day:1})>t&&n--;const i=t-this.dateToNumberFromZero({year:n,month:1,day:1}),s=xO(i-(this.isLeapYear(n)&&i>=59?1:0)),o=i-Vl[s]-(this.isLeapYear(n)&&s>1?1:0);return{year:n,month:s+1,day:o+1}}numberToSimpleDateTime(e){const t=Xl(e%1),n=Math.floor(t.hours/Wg);t.hours=t.hours%Wg;const i=this.numberToSimpleDate(Math.floor(e)+n);return Object.assign(Object.assign({},i),t)}leapYearsCount(e){return Math.floor(e/4)-Math.floor(e/100)+Math.floor(e/400)+(this.config.leapYear1900&&e>=1900?1:0)}daysInMonth(e,t){return this.isLeapYear(e)&&t===2?29:Hg[t-1]}endOfMonth(e){return{year:e.year,month:e.month,day:this.daysInMonth(e.year,e.month)}}toBasisUS(e,t){return e.day===31&&(e.day=30),e.day===30&&t.day===31&&(t.day=30),e.month===2&&e.day===this.daysInMonth(e.year,e.month)&&(e.day=30,t.month===2&&t.day===this.daysInMonth(t.year,t.month)&&(t.day=30)),[e,t]}yearLengthForBasis(e,t){return e.year!==t.year?e.year+1!==t.year||e.month<t.month||e.month===t.month&&e.day<t.day?(this.leapYearsCount(t.year)-this.leapYearsCount(e.year-1))/(t.year-e.year+1)+365:this.countLeapDays(t)!==this.countLeapDays({year:e.year,month:e.month,day:e.day-1})?366:365:this.isLeapYear(e.year)?366:365}parseSingleFormat(e,t,n){const i=this.parseDateTime(e,t,n);if(!(uc(i)&&(i.year>=0&&i.year<100&&(i.year<this.getNullYear()?i.year+=2e3:i.year+=1900),!this.isValidDate(i))))return i}parseDateTimeFromFormats(e,t,n){const i=t.length===0?[void 0]:t,s=n.length===0?[void 0]:n;for(const o of i)for(const a of s){const l=this.parseSingleFormat(e,o,a);if(l!==void 0)return{dateTime:l,timeFormat:a,dateFormat:o}}return{}}countLeapDays(e){return e.month>2||e.month===2&&e.day>=29?this.leapYearsCount(e.year):this.leapYearsCount(e.year-1)}dateToNumberFromZero(e){return 365*e.year+Vl[e.month-1]+e.day-1+(e.month<=2?this.leapYearsCount(e.year-1):this.leapYearsCount(e.year))}isLeapYear(e){return e%4?!1:e%100?!0:e%400?e===1900&&this.config.leapYear1900:!0}}function xO(r){let e=0;return Vl[e+6]<=r&&(e+=6),Vl[e+3]<=r&&(e+=3),Vl[e+2]<=r?e+=2:Vl[e+1]<=r&&(e+=1),e}function j1(r,e){const t=12*r.year+r.month-1+e;return{year:Math.floor(t/12),month:t%12+1,day:r.day}}function EO(r){return{year:r.year,month:r.month,day:Math.min(r.day,Hg[r.month-1])}}function Im(r){return Math.round(r*3600*24)/(3600*24)}function SO(r,e=1){return Math.round(r*e)/e}function Xl(r){const e=r*Wg*Ih*Oh,t=SO(e%Oh,1e5)%Oh,n=(e-t)/Oh,i=Math.round(n%Ih)%Ih,s=(n-i)/Ih;return{hours:Math.round(s),minutes:i,seconds:t}}function Kl(r){return((r.seconds/60+r.minutes)/60+r.hours)/24}function $1(r){return{year:r.year,month:r.month,day:Math.min(30,r.day)}}class TO{call(){return Bg}}const z1=/(\\.|dd|DD|d|D|mm|MM|m|M|YYYY|YY|yyyy|yy|HH|hh|H|h|ss(\.(0+|s+))?|s|AM\/PM|am\/pm|A\/P|a\/p|\[mm]|\[MM]|\[hh]|\[HH])/g,H1=/(\\.|[#0]+(\.[#0]*)?)/g;var Os;(function(r){r.FORMAT="FORMAT",r.FREE_TEXT="FREE_TEXT"})(Os||(Os={}));function kh(r,e){return{type:r,value:e}}var xf;(function(r){r.DATE="DATE",r.NUMBER="NUMBER",r.STRING="STRING"})(xf||(xf={}));function RO(r){z1.lastIndex=0;const e=[];let t;do t=z1.exec(r),t!==null&&e.push(t);while(t);return e}function AO(r){H1.lastIndex=0;const e=H1.exec(r);return e!==null?[e]:[]}function DS(r,e){const t=[];let n=0;for(let s=0;s<r.length;++s){const o=r[s];if(o.index!==n){const a=e.substr(n,o.index-n);t.push(kh(Os.FREE_TEXT,a))}o[0].startsWith("\\")?t.push(kh(Os.FREE_TEXT,o[0])):t.push(kh(Os.FORMAT,o[0])),n=o.index+o[0].length}const i=r[r.length-1];if(i.index+i[0].length<e.length){const s=e.substr(i.index+i[0].length,e.length);t.push(kh(Os.FREE_TEXT,s))}return t}function BS(r){const e=RO(r);if(!e.every(t=>US(t)))return{type:xf.DATE,tokens:DS(e,r)}}function CO(r){const e=AO(r);if(!e.every(t=>US(t)))return{type:xf.NUMBER,tokens:DS(e,r)}}function US(r){return r[0].startsWith("\\")}function NO(r,e,t,n){const i=t.stringifyDateTime(n.numberToSimpleDateTime(r),e);if(i!==void 0)return i;const s=t.stringifyDuration(Xl(r),e);if(s!==void 0)return s;const o=CO(e);return o!==void 0?OO(o.tokens,r):e}function ti(r,e){let t=`${r}`;for(;t.length<e;)t="0"+t;return t}function MO(r,e){let t=`${r}`;for(;t.length<e;)t=t+"0";return t}function W1(r,e){return r.split(e).length-1}function OO(r,e){let t="";for(let n=0;n<r.length;++n){const i=r[n];if(i.type===Os.FREE_TEXT){t+=i.value;continue}const s=i.value.split("."),o=s[0],a=s[1]||"",l=s[1]?".":"",u=Number(e.toFixed(a.length)).toString().split(".");let c=u[0]||"",d=u[1]||"";if(o.length>c.length){const f=W1(o.substr(0,o.length-c.length),"0");c=ti(c,f+c.length)}const h=W1(a.substr(d.length,a.length-d.length),"0");d=MO(d,h+d.length),t+=c+l+d}return t}function IO(r,e){const t=BS(e);if(t===void 0)return;const n=t.tokens;let i="";for(const s of n){if(s.type===Os.FREE_TEXT){i+=s.value;continue}switch(s.value.toLowerCase()){case"h":case"hh":{i+=ti(r.hours,s.value.length),r.hours=0;break}case"[hh]":{i+=ti(r.hours,s.value.length-2),r.hours=0;break}case"m":case"mm":{i+=ti(r.minutes,s.value.length),r.minutes=0;break}case"[mm]":{i+=ti(r.minutes+60*r.hours,s.value.length-2),r.minutes=0,r.hours=0;break}case"s":case"ss":{i+=ti(Math.floor(r.seconds),s.value.length);break}default:{if(zy.test(s.value)){const o=Math.max(s.value.length-3,0);i+=`${r.seconds<10?"0":""}${Math.floor(r.seconds*Math.pow(10,o))/Math.pow(10,o)}`;continue}return}}}return i}function kO(r,e){const t=BS(e);if(t===void 0)return;const n=t.tokens;let i="",s=!1;const o=n.some(a=>a.type===Os.FORMAT&&(a.value==="a/p"||a.value==="A/P"||a.value==="am/pm"||a.value==="AM/PM"));for(let a=0;a<n.length;a++){const l=n[a];if(l.type===Os.FREE_TEXT){i+=l.value;continue}switch(l.value.toLowerCase()){case"h":case"hh":{s=!0,i+=ti(o?(r.hours+11)%12+1:r.hours,l.value.length);break}case"d":case"dd":{i+=ti(r.day,l.value.length);break}case"s":case"ss":{i+=ti(Math.floor(r.seconds),l.value.length);break}case"m":case"mm":{a+1<n.length&&n[a+1].value.startsWith(":")&&(s=!0),s?i+=ti(r.minutes,l.value.length):i+=ti(r.month,l.value.length),s=!0;break}case"yy":{i+=ti(r.year%100,l.value.length);break}case"yyyy":{i+=r.year;break}case"am/pm":case"a/p":{const[u,c]=l.value.split("/");i+=r.hours<12?u:c;break}default:{if(zy.test(l.value)){const u=l.value.length-3;i+=`${r.seconds<10?"0":""}${Math.floor(r.seconds*Math.pow(10,u))/Math.pow(10,u)}`;continue}return}}}return i}const Gg="length",cc=r=>parseInt(r,16),G1=r=>parseInt(r,10),km=r=>(r+"").replace(/\-/g,""),Ef=(r,e,t)=>r.substr(e,t),Ki=r=>r.codePointAt(0)-65;function PO(r){return km(r)[Gg]===25?cc(Ef(km(r),cc("12"),Ki("F")))/(cc(Ef(km(r),Ki("C"),Ki("Y")>>4))||(~~![][Gg]<<3)+1):0}function FO(r){if(r=(r+"").replace(/\-/g,""),r[Gg]!==Ki("Z"))return!1;let e=0;return[[0,Ki("G")+1],[Ki("H"),Ki("H")-1],[Ki("G")+Ki("H"),Ki("G")]].reduce((t,[n,i],s)=>(t|=(G1(`${G1(cc(Ef(r,e+n-(s===0?0:2),i+(s?2:0)))+(cc(Ef(r,e+n+i,2))+[]).padStart(2,"0"))}`)%97||2)>>1,e+=2,t),Ki("A"))==="1">>1}const LO={invalid:()=>"The license key for HyperFormula is invalid.",expired:({keyValidityDate:r})=>`The license key for HyperFormula expired on ${r}, and is not valid for the installed version.`,missing:()=>"The license key for HyperFormula is missing."};let q1=!1;function DO(r){const e={template:"missing",vars:{}};if(r==="gpl-v3"||r==="internal-use-in-handsontable")e.template="valid";else if(typeof r=="string"&&FO(r)){const[t,n,i]="18/12/2025".split("/"),s=Math.floor(new Date(`${n}/${t}/${i}`).getTime()/864e5),o=PO(r);e.vars.keyValidityDate=BO(new Date((o+1)*864e5)),s>o?e.template="expired":e.template="valid"}else r!==""&&(e.template="invalid");return!q1&&e.template!=="valid"&&(console.warn(LO[e.template](e.vars)),q1=!0),e.template}function BO(r){const t=["January","February","March","April","May","June","July","August","September","October","November","December"][r.getMonth()],n=r.getDate(),i=r.getFullYear();return`${t} ${n}, ${i}`}var Mr;(function(r){class e{constructor(l){this.value=l,this.value=Dy(this.value,OS(He(this.value)))}}r.Number=e;class t{constructor(l){this.value=l}}r.String=t;class n{constructor(l){this.value=l}}r.Boolean=n;class i{static getSingletonInstance(){return i.instance||(i.instance=new i),i.instance}}r.Empty=i;class s{constructor(l){this.formula=l}}r.Formula=s;class o{constructor(l,u){this.value=new J(l,u)}}r.Error=o})(Mr||(Mr={}));function UO(r){return r.startsWith("=")}function VO(r){const e=r.toLowerCase();return e==="true"||e==="false"}function jO(r,e){const t=r.toUpperCase();return/#[A-Za-z0-9\/]+[?!]?/.test(t)&&Object.prototype.hasOwnProperty.call(e,t)}class $O{constructor(e,t,n){this.config=e,this.dateHelper=t,this.numberLiteralsHelper=n}parse(e){if(e==null)return Mr.Empty.getSingletonInstance();if(typeof e=="number")return MS(e)?new Mr.Error(te.NUM,ue.ValueLarge):new Mr.Number(e);if(typeof e=="boolean")return new Mr.Boolean(e);if(e instanceof Date){const t=this.dateHelper.dateToNumber({day:e.getDate(),month:e.getMonth()+1,year:e.getFullYear()}),n=Kl({hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds()+e.getMilliseconds()/1e3}),i=t+n;return i<0?new Mr.Error(te.NUM,ue.DateBounds):i%1===0?new Mr.Number(new By(i,"Date()")):i<1?new Mr.Number(new Uy(i,"Date()")):new Mr.Number(new Vy(i,"Date()"))}else if(typeof e=="string"){if(VO(e))return new Mr.Boolean(e.toLowerCase()==="true");if(UO(e))return new Mr.Formula(e);if(jO(e,this.config.errorMapping))return new Mr.Error(this.config.errorMapping[e.toUpperCase()]);{let t=e.trim(),n=0,i;if(t.endsWith("%"))n=1,t=t.slice(0,t.length-1);else{const a=this.currencyMatcher(t);a!==void 0&&(n=2,[i,t]=a)}const s=this.numberLiteralsHelper.numericStringToMaybeNumber(t);if(s!==void 0){let a;return n===1?a=new vd(s/100):n===2?a=new Lg(s,i):a=s,new Mr.Number(a)}const o=this.dateHelper.dateStringToDateNumber(t);return o!==void 0?new Mr.Number(o):new Mr.String(e.startsWith("'")?e.slice(1):e)}}else throw new vS(e)}currencyMatcher(e){for(const t of this.config.currencySymbol){if(e.startsWith(t))return[t,e.slice(t.length)];if(e.endsWith(t))return[t,e.slice(0,e.length-t.length)]}}}var Da;(function(r){r[r.COPY=0]="COPY",r[r.CUT=1]="CUT"})(Da||(Da={}));var bn;(function(r){r[r.VALUE=0]="VALUE",r[r.EMPTY=1]="EMPTY",r[r.FORMULA=2]="FORMULA",r[r.PARSING_ERROR=3]="PARSING_ERROR"})(bn||(bn={}));class Y1{constructor(e,t,n,i,s){this.sourceLeftCorner=e,this.width=t,this.height=n,this.type=i,this.content=s}*getContent(e){if(this.content!==void 0)for(let t=0;t<this.height;++t)for(let n=0;n<this.width;++n)yield[$e(e.sheet,e.col+n,e.row+t),this.content[t][n]]}}class zO{constructor(e,t,n){this.dependencyGraph=t,this.operations=n,this.maxRows=e.maxRows,this.maxColumns=e.maxColumns}cut(e,t,n){this.clipboard=new Y1(e,t,n,Da.CUT)}copy(e,t,n){const i=[];for(let s=0;s<n;++s){i[s]=[];for(let o=0;o<t;++o){const a=this.operations.getClipboardCell($e(e.sheet,e.col+o,e.row+s));i[s].push(a)}}this.clipboard=new Y1(e,t,n,Da.COPY,i)}abortCut(){this.clipboard&&this.clipboard.type===Da.CUT&&this.clear()}clear(){this.clipboard=void 0}ensureItIsPossibleToCopyPaste(e){if(this.clipboard===void 0)return;if(ii(e)||!this.dependencyGraph.sheetMapping.hasSheetWithId(e.sheet))throw new Zr("a valid target address.");const t=it.spanFrom(e,this.clipboard.width,this.clipboard.height);if(t.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new Ha;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(t))throw new Error("It is not possible to paste onto an array")}isCutClipboard(){return this.clipboard!==void 0&&this.clipboard.type===Da.CUT}isCopyClipboard(){return this.clipboard!==void 0&&this.clipboard.type===Da.COPY}}class _a{performEagerTransformations(e,t){for(const n of e.arrayFormulaNodes()){const[i,s]=this.transformSingleAst(n.getFormula(e.lazilyTransformingAstService),n.getAddress(e.lazilyTransformingAstService)),o=t.rememberNewAst(i);n.setFormula(o),n.setAddress(s)}}transformSingleAst(e,t){const n=this.transformAst(e,t),i=this.fixNodeAddress(t);return[n,i]}transformAst(e,t){switch(e.type){case oe.CELL_REFERENCE:return this.transformCellReferenceAst(e,t);case oe.CELL_RANGE:return this.transformCellRangeAst(e,t);case oe.COLUMN_RANGE:return this.transformColumnRangeAst(e,t);case oe.ROW_RANGE:return this.transformRowRangeAst(e,t);case oe.EMPTY:case oe.ERROR:case oe.NUMBER:case oe.NAMED_EXPRESSION:case oe.ERROR_WITH_RAW_INPUT:case oe.STRING:return e;case oe.PERCENT_OP:case oe.MINUS_UNARY_OP:case oe.PLUS_UNARY_OP:return Object.assign(Object.assign({},e),{value:this.transformAst(e.value,t)});case oe.FUNCTION_CALL:return Object.assign(Object.assign({},e),{procedureName:e.procedureName,args:e.args.map(n=>this.transformAst(n,t))});case oe.PARENTHESIS:return Object.assign(Object.assign({},e),{expression:this.transformAst(e.expression,t)});case oe.ARRAY:return Object.assign(Object.assign({},e),{args:e.args.map(n=>n.map(i=>this.transformAst(i,t)))});default:return Object.assign(Object.assign({},e),{left:this.transformAst(e.left,t),right:this.transformAst(e.right,t)})}}transformCellReferenceAst(e,t){const n=this.transformCellAddress(e.reference,t);return n instanceof vr?Object.assign(Object.assign({},e),{reference:n}):n===te.REF?As(new J(te.REF)):e}transformCellRangeAst(e,t){const n=this.transformCellRange(e.start,e.end,t);return Array.isArray(n)?Object.assign(Object.assign({},e),{start:n[0],end:n[1]}):n===te.REF?As(new J(te.REF)):e}transformColumnRangeAst(e,t){const n=this.transformColumnRange(e.start,e.end,t);return Array.isArray(n)?Object.assign(Object.assign({},e),{start:n[0],end:n[1]}):n===te.REF?As(new J(te.REF)):e}transformRowRangeAst(e,t){const n=this.transformRowRange(e.start,e.end,t);return Array.isArray(n)?Object.assign(Object.assign({},e),{start:n[0],end:n[1]}):n===te.REF?As(new J(te.REF)):e}}class HO extends _a{constructor(e){super(),this.columnsSpan=e}get sheet(){return this.columnsSpan.sheet}isIrreversible(){return!1}transformRowRangeAst(e,t){return e}transformCellRange(e,t,n){return this.transformRange(e,t,n)}transformRowRange(e,t,n){throw Error("Not implemented")}transformColumnRange(e,t,n){return this.transformRange(e,t,n)}transformCellAddress(e,t){const n=ls(e,t);if(n!==this.columnsSpan.sheet&&t.sheet!==this.columnsSpan.sheet)return!1;const i=e.toSimpleColumnAddress(t);return n===this.columnsSpan.sheet&&t.sheet!==this.columnsSpan.sheet?this.columnsSpan.columnStart<=i.col?e.shiftedByColumns(this.columnsSpan.numberOfColumns):!1:t.sheet===this.columnsSpan.sheet&&n!==this.columnsSpan.sheet?e.isColumnAbsolute()||t.col<this.columnsSpan.columnStart?!1:e.shiftedByColumns(-this.columnsSpan.numberOfColumns):e.isColumnAbsolute()?e.col<this.columnsSpan.columnStart?!1:e.shiftedByColumns(this.columnsSpan.numberOfColumns):e.toSimpleColumnAddress(t).col<this.columnsSpan.columnStart?t.col<this.columnsSpan.columnStart?!1:e.shiftedByColumns(-this.columnsSpan.numberOfColumns):t.col<this.columnsSpan.columnStart?e.shiftedByColumns(this.columnsSpan.numberOfColumns):!1}fixNodeAddress(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col+this.columnsSpan.numberOfColumns}):e}transformRange(e,t,n){const i=this.transformCellAddress(e,n),s=this.transformCellAddress(t,n);return i===te.REF||s===te.REF?te.REF:i||s?[i||e,s||t]:!1}}class qg extends _a{constructor(e){super(),this.rowsSpan=e}get sheet(){return this.rowsSpan.sheet}isIrreversible(){return!1}transformColumnRangeAst(e,t){return e}transformCellRange(e,t,n){return this.transformRange(e,t,n)}transformRowRange(e,t,n){return this.transformRange(e,t,n)}transformColumnRange(e,t,n){throw Error("Not implemented")}transformCellAddress(e,t){const n=ls(e,t);if(n!==this.rowsSpan.sheet&&t.sheet!==this.rowsSpan.sheet)return!1;const i=e.toSimpleRowAddress(t);return n===this.rowsSpan.sheet&&t.sheet!==this.rowsSpan.sheet?this.rowsSpan.rowStart<=i.row?e.shiftedByRows(this.rowsSpan.numberOfRows):!1:t.sheet===this.rowsSpan.sheet&&n!==this.rowsSpan.sheet?e.isRowAbsolute()||t.row<this.rowsSpan.rowStart?!1:e.shiftedByRows(-this.rowsSpan.numberOfRows):e.isRowAbsolute()?e.row<this.rowsSpan.rowStart?!1:e.shiftedByRows(this.rowsSpan.numberOfRows):i.row<this.rowsSpan.rowStart?t.row<this.rowsSpan.rowStart?!1:e.shiftedByRows(-this.rowsSpan.numberOfRows):t.row<this.rowsSpan.rowStart?e.shiftedByRows(this.rowsSpan.numberOfRows):!1}fixNodeAddress(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row+this.rowsSpan.numberOfRows}):e}transformRange(e,t,n){const i=this.transformCellAddress(e,n),s=this.transformCellAddress(t,n);return i===te.REF||s===te.REF?te.REF:i||s?[i||e,s||t]:!1}}class WO extends _a{constructor(e){super(),this.sheet=e}isIrreversible(){return!0}fixNodeAddress(e){return e}transformCellAddress(e,t){return e.isInvalid(t)?te.REF:!1}transformCellRange(e,t,n){return e.isInvalid(n)||t.isInvalid(n)?te.REF:!1}transformColumnRange(e,t,n){return e.isInvalid(n)||t.isInvalid(n)?te.REF:!1}transformRowRange(e,t,n){return e.isInvalid(n)||t.isInvalid(n)?te.REF:!1}}class GO extends _a{constructor(e,t,n,i){super(),this.sourceRange=e,this.toRight=t,this.toBottom=n,this.toSheet=i,this.dependentFormulaTransformer=new qO(e,t,n,i)}get sheet(){return this.sourceRange.sheet}isIrreversible(){return!0}transformSingleAst(e,t){return this.sourceRange.addressInRange(t)?[this.transformAst(e,t),this.fixNodeAddress(t)]:this.dependentFormulaTransformer.transformSingleAst(e,t)}fixNodeAddress(e){return $e(this.toSheet,e.col+this.toRight,e.row+this.toBottom)}transformCellAddress(e,t){return this.transformAddress(e,t)}transformCellRange(e,t,n){return this.transformRange(e,t,n)}transformColumnRange(e,t,n){return this.transformRange(e,t,n)}transformRowRange(e,t,n){return this.transformRange(e,t,n)}transformAddress(e,t){const n=this.sourceRange;if(e instanceof vr){const i=e.toSimpleCellAddress(t);if(n.addressInRange(i))return e.shiftAbsoluteDimensions(this.toRight,this.toBottom)}return e.shiftRelativeDimensions(-this.toRight,-this.toBottom)}transformRange(e,t,n){const i=this.sourceRange;if(e instanceof vr&&t instanceof vr){const s=e.toSimpleCellAddress(n),o=t.toSimpleCellAddress(n);if(i.addressInRange(s)&&i.addressInRange(o))return[e.shiftAbsoluteDimensions(this.toRight,this.toBottom),t.shiftAbsoluteDimensions(this.toRight,this.toBottom)]}return[e.shiftRelativeDimensions(-this.toRight,-this.toBottom),t.shiftRelativeDimensions(-this.toRight,-this.toBottom)]}}class qO extends _a{constructor(e,t,n,i){super(),this.sourceRange=e,this.toRight=t,this.toBottom=n,this.toSheet=i}get sheet(){return this.sourceRange.sheet}isIrreversible(){return!0}fixNodeAddress(e){return e}transformCellAddress(e,t){return this.shouldMove(e,t)?e.moved(this.toSheet,this.toRight,this.toBottom):!1}transformCellRange(e,t,n){return this.transformRange(e,t,n)}transformColumnRange(e,t,n){return this.transformRange(e,t,n)}transformRowRange(e,t,n){return this.transformRange(e,t,n)}shouldMove(e,t){return e instanceof vr?this.sourceRange.addressInRange(e.toSimpleCellAddress(t)):e instanceof Bn?this.sourceRange.rowInRange(e.toSimpleRowAddress(t))&&!this.sourceRange.isFinite():this.sourceRange.columnInRange(e.toSimpleColumnAddress(t))&&!this.sourceRange.isFinite()}transformRange(e,t,n){const i=this.transformCellAddress(e,n),s=this.transformCellAddress(t,n);return i&&s?[i,s]:!1}}class YO extends _a{constructor(e){super(),this.columnsSpan=e}get sheet(){return this.columnsSpan.sheet}isIrreversible(){return!0}transformRowRangeAst(e,t){return e}transformCellRange(e,t,n){return this.transformRange(e,t,n)}transformRowRange(e,t,n){throw Error("Not implemented")}transformColumnRange(e,t,n){return this.transformRange(e,t,n)}transformCellAddress(e,t){const n=ls(e,t);if(this.columnsSpan.sheet!==t.sheet&&this.columnsSpan.sheet!==n)return!1;if(this.columnsSpan.sheet!==t.sheet&&this.columnsSpan.sheet===n){const i=e.toSimpleColumnAddress(t);if(i.col<this.columnsSpan.columnStart)return!1;if(i.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===t.sheet&&this.columnsSpan.sheet!==n){if(e.isColumnAbsolute())return!1;if(t.col<this.columnsSpan.columnStart)return!1;if(t.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===t.sheet&&this.columnsSpan.sheet===n)if(e.isColumnAbsolute()){if(e.col<this.columnsSpan.columnStart)return!1;if(e.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}else{const i=e.toSimpleColumnAddress(t);if(i.col<this.columnsSpan.columnStart){if(t.col<this.columnsSpan.columnStart)return!1;if(t.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}else if(i.col>this.columnsSpan.columnEnd){if(t.col<this.columnsSpan.columnStart)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns);if(t.col>this.columnsSpan.columnEnd)return!1}}return te.REF}fixNodeAddress(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col-this.columnsSpan.numberOfColumns}):e}transformRange(e,t,n){const i=ls(e,n);let s=e,o=t;if(this.columnsSpan.sheet===i){const u=e.toSimpleColumnAddress(n),c=t.toSimpleColumnAddress(n);if(this.columnsSpan.columnStart<=u.col&&this.columnsSpan.columnEnd>=c.col)return te.REF;u.col>=this.columnsSpan.columnStart&&u.col<=this.columnsSpan.columnEnd&&(s=e.shiftedByColumns(this.columnsSpan.columnEnd-u.col+1)),c.col>=this.columnsSpan.columnStart&&c.col<=this.columnsSpan.columnEnd&&(o=t.shiftedByColumns(-(c.col-this.columnsSpan.columnStart+1)))}const a=this.transformCellAddress(s,n),l=this.transformCellAddress(o,n);if(a===!1&&l===!1)return[s,o];if(a===te.REF||l===te.REF)throw Error("Cannot happen");return[a||s,l||o]}}class Yg extends _a{constructor(e){super(),this.rowsSpan=e}get sheet(){return this.rowsSpan.sheet}isIrreversible(){return!0}transformColumnRangeAst(e,t){return e}transformCellAddress(e,t){const n=ls(e,t);if(this.rowsSpan.sheet!==t.sheet&&this.rowsSpan.sheet!==n)return!1;if(this.rowsSpan.sheet!==t.sheet&&this.rowsSpan.sheet===n){const i=e.toSimpleRowAddress(t);if(i.row<this.rowsSpan.rowStart)return!1;if(i.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===t.sheet&&this.rowsSpan.sheet!==n){if(e.isRowAbsolute())return!1;if(t.row<this.rowsSpan.rowStart)return!1;if(t.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===t.sheet&&this.rowsSpan.sheet===n)if(e.isRowAbsolute()){if(e.row<this.rowsSpan.rowStart)return!1;if(e.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}else{const i=e.toSimpleRowAddress(t);if(i.row<this.rowsSpan.rowStart){if(t.row<this.rowsSpan.rowStart)return!1;if(t.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}else if(i.row>this.rowsSpan.rowEnd){if(t.row<this.rowsSpan.rowStart)return e.shiftedByRows(-this.rowsSpan.numberOfRows);if(t.row>this.rowsSpan.rowEnd)return!1}}return te.REF}transformCellRange(e,t,n){return this.transformRange(e,t,n)}transformRowRange(e,t,n){return this.transformRange(e,t,n)}transformColumnRange(e,t,n){throw Error("Not implemented")}fixNodeAddress(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row-this.rowsSpan.numberOfRows}):e}transformRange(e,t,n){const i=ls(e,n);let s=e,o=t;if(this.rowsSpan.sheet===i){const u=e.toSimpleRowAddress(n),c=t.toSimpleRowAddress(n);if(this.rowsSpan.rowStart<=u.row&&this.rowsSpan.rowEnd>=c.row)return te.REF;u.row>=this.rowsSpan.rowStart&&u.row<=this.rowsSpan.rowEnd&&(s=e.shiftedByRows(this.rowsSpan.rowEnd-u.row+1)),c.row>=this.rowsSpan.rowStart&&c.row<=this.rowsSpan.rowEnd&&(o=t.shiftedByRows(-(c.row-this.rowsSpan.rowStart+1)))}const a=this.transformCellAddress(s,n),l=this.transformCellAddress(o,n);return a===!1&&l===!1?[s,o]:a===te.REF||l===te.REF?te.REF:[a||s,l||o]}}class XO extends _a{constructor(e,t){super(),this.sheetIdToKeep=e,this.sheetBeingMerged=t}get sheet(){return this.sheetIdToKeep}isIrreversible(){return!0}transformCellAddress(e,t){return this.updateSheetInAddress(e)}transformCellRange(e,t,n){return this.transformRange(e,t)}transformColumnRange(e,t,n){return this.transformRange(e,t)}transformRowRange(e,t,n){return this.transformRange(e,t)}fixNodeAddress(e){return e}transformRange(e,t){const n=this.updateSheetInAddress(e),i=this.updateSheetInAddress(t);return n||i?[n||e,i||t]:!1}updateSheetInAddress(e){return e.sheet===this.sheetBeingMerged?e.withSheet(this.sheetIdToKeep):!1}}class VS{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return Sf(this.indexes)}rowsSpans(){return this.normalizedIndexes().map(e=>si.fromNumberOfRows(this.sheet,e[0],e[1]))}}class jS{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return Tf(this.indexes)}rowsSpans(){return this.normalizedIndexes().map(e=>si.fromNumberOfRows(this.sheet,e[0],e[1]))}}class $S{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return Tf(this.indexes)}columnsSpans(){return this.normalizedIndexes().map(e=>xi.fromNumberOfColumns(this.sheet,e[0],e[1]))}}class zS{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return Sf(this.indexes)}columnsSpans(){return this.normalizedIndexes().map(e=>xi.fromNumberOfColumns(this.sheet,e[0],e[1]))}}class KO{constructor(e,t,n,i,s,o,a,l,u){this.dependencyGraph=t,this.columnSearch=n,this.cellContentParser=i,this.parser=s,this.stats=o,this.lazilyTransformingAstService=a,this.namedExpressions=l,this.arraySizePredictor=u,this.changes=aa.empty(),this.allocateNamedExpressionAddressSpace(),this.maxColumns=e.maxColumns,this.maxRows=e.maxRows}get sheetMapping(){return this.dependencyGraph.sheetMapping}get addressMapping(){return this.dependencyGraph.addressMapping}removeRows(e){const t=[];for(const n of e.rowsSpans()){const i=this.doRemoveRows(n);i&&t.push(i)}return t}addRows(e){for(const t of e.rowsSpans())this.doAddRows(t)}addColumns(e){for(const t of e.columnsSpans())this.doAddColumns(t)}removeColumns(e){const t=[];for(const n of e.columnsSpans()){const i=this.doRemoveColumns(n);i&&t.push(i)}return t}clearSheet(e){this.dependencyGraph.clearSheet(e),this.columnSearch.removeSheet(e)}addSheet(e){const t=this.sheetMapping.addSheet(e);return this.dependencyGraph.addSheet(t),{sheetName:this.sheetMapping.getSheetNameOrThrowError(t),sheetId:t}}addSheetWithId(e,t){this.sheetMapping.addSheetWithId(e,t),this.dependencyGraph.addSheet(e)}addPlaceholderSheetWithId(e,t){this.sheetMapping.addPlaceholderWithId(e,t),this.addressMapping.addSheetStrategyPlaceholderIfNotExists(e)}removeSheet(e){return this.dependencyGraph.removeSheet(e),this.columnSearch.removeSheet(e),this.namedExpressions.getAllNamedExpressionsForScope(e).map(n=>this.removeNamedExpression(n.normalizeExpressionName(),e))}removeSheetByName(e){const t=this.sheetMapping.getSheetIdOrThrowError(e);return this.removeSheet(t)}renameSheet(e,t){const{previousDisplayName:n,mergedWithPlaceholderSheet:i}=this.sheetMapping.renameSheet(e,t);let s;return i!==void 0&&(this.dependencyGraph.mergeSheets(e,i),this.stats.measure(wt.TRANSFORM_ASTS,()=>{const o=new XO(e,i);o.performEagerTransformations(this.dependencyGraph,this.parser),s=this.lazilyTransformingAstService.addTransformation(o)})),{previousDisplayName:n,version:s,mergedPlaceholderSheetId:i}}moveRows(e,t,n,i){const s=si.fromNumberOfRows(e,i,n);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddRows(s),i<t&&(t+=n);const o=$e(e,0,t),a=$e(e,0,i);this.moveCells(o,Number.POSITIVE_INFINITY,n,a);const l=si.fromNumberOfRows(e,t,n);return this.doRemoveRows(l),this.lazilyTransformingAstService.commitCombinedMode()}moveColumns(e,t,n,i){const s=xi.fromNumberOfColumns(e,i,n);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddColumns(s),i<t&&(t+=n);const o=$e(e,t,0),a=$e(e,i,0);this.moveCells(o,n,Number.POSITIVE_INFINITY,a);const l=xi.fromNumberOfColumns(e,t,n);return this.doRemoveColumns(l),this.lazilyTransformingAstService.commitCombinedMode()}moveCells(e,t,n,i){this.ensureItIsPossibleToMoveCells(e,t,n,i);const s=it.spanFrom(e,t,n),o=it.spanFrom(i,t,n),a=i.col-e.col,l=i.row-e.row,u=i.sheet,c=this.getRangeClipboardCells(o),d=this.dependencyGraph.rawValuesFromRange(o);this.columnSearch.removeValues(d);const h=this.dependencyGraph.rawValuesFromRange(s);this.columnSearch.moveValues(h,a,l,u);let f=0;this.stats.measure(wt.TRANSFORM_ASTS,()=>{const p=new GO(s,a,l,u);p.performEagerTransformations(this.dependencyGraph,this.parser),f=this.lazilyTransformingAstService.addTransformation(p)}),this.dependencyGraph.moveCells(s,a,l,u);const m=this.updateNamedExpressionsForMovedCells(e,t,n,i);return{version:f,overwrittenCellsData:c,addedGlobalNamedExpressions:m}}setRowOrder(e,t){const n=[];let i=[];for(const[s,o]of t)if(s!==o){const a=it.spanFrom({sheet:e,col:0,row:s},1/0,1),l=this.getRangeClipboardCells(a);i=i.concat(l),n.push(l.map(([{sheet:u,col:c},d])=>[{sheet:u,col:c,row:o},d]))}return n.forEach(s=>this.restoreClipboardCells(e,s.values())),i}setColumnOrder(e,t){const n=[];let i=[];for(const[s,o]of t)if(s!==o){const a=it.spanFrom({sheet:e,col:s,row:0},1,1/0),l=this.getRangeClipboardCells(a);i=i.concat(l),n.push(l.map(([{sheet:u,col:c,row:d},h])=>[{sheet:u,col:o,row:d},h]))}return n.forEach(s=>this.restoreClipboardCells(e,s.values())),i}addNamedExpression(e,t,n,i){const s=this.namedExpressions.addNamedExpression(e,n,i);this.storeNamedExpressionInCell(s.address,t),this.adjustNamedExpressionEdges(s,e,n)}restoreNamedExpression(e,t,n){const i=e.displayName;this.restoreCell(e.address,t);const s=this.namedExpressions.restoreNamedExpression(e,n);this.adjustNamedExpressionEdges(s,i,n)}changeNamedExpressionExpression(e,t,n,i){const s=this.namedExpressions.namedExpressionForScope(e,n);if(!s)throw new Nc(e);const o=s.copy();s.options=i;const a=this.getClipboardCell(s.address);return this.storeNamedExpressionInCell(s.address,t),[o,a]}removeNamedExpression(e,t){const n=this.namedExpressions.namedExpressionForScope(e,t);if(!n)throw new Nc(e);this.namedExpressions.remove(n.displayName,t);const i=this.getClipboardCell(n.address);if(t!==void 0){const s=this.namedExpressions.workbookNamedExpressionOrPlaceholder(e);this.dependencyGraph.exchangeNode(n.address,s.address)}else this.dependencyGraph.setCellEmpty(n.address);return[n,i]}ensureItIsPossibleToMoveCells(e,t,n,i){if(ii(e)||!(Rf(t)&&Rf(n)||ZO(e,t,n))||ii(i)||!this.sheetMapping.hasSheetWithId(e.sheet)||!this.sheetMapping.hasSheetWithId(i.sheet))throw new Zr("a valid range of cells to move.");const s=it.spanFrom(e,t,n),o=it.spanFrom(i,t,n);if(o.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new Ha;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(s))throw new Ul;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(o))throw new vf}restoreClipboardCells(e,t){const n=[];for(const[i,s]of t)if(this.restoreCell(i,s),s.type===bn.FORMULA){const{dependencies:o}=this.parser.fetchCachedResult(s.hash);n.push(...this.updateNamedExpressionsForTargetAddress(e,i,o))}return n}restoreCell(e,t){switch(t.type){case bn.VALUE:{this.setValueToCell(t,e);break}case bn.FORMULA:{this.setFormulaToCellFromCache(t.hash,e);break}case bn.EMPTY:{this.setCellEmpty(e);break}case bn.PARSING_ERROR:{this.setParsingErrorToCell(t.rawInput,t.errors,e);break}}}getOldContent(e){const t=this.dependencyGraph.getCell(e);if(t===void 0||t instanceof ta)return[e,{type:bn.EMPTY}];if(t instanceof la)return[e,Object.assign({type:bn.VALUE},t.getValues())];if(t instanceof ni)return[t.getAddress(this.lazilyTransformingAstService),{type:bn.FORMULA,hash:this.parser.computeHashFromAst(t.getFormula(this.lazilyTransformingAstService))}];if(t instanceof Yl)return[e,{type:bn.PARSING_ERROR,rawInput:t.rawInput,errors:t.errors}];throw Error("Trying to copy unsupported type")}getClipboardCell(e){const t=this.dependencyGraph.getCell(e);if(t===void 0||t instanceof ta)return{type:bn.EMPTY};if(t instanceof la)return Object.assign({type:bn.VALUE},t.getValues());if(t instanceof Wr){const n=t.getArrayCellValue(e);return n===It?{type:bn.EMPTY}:{type:bn.VALUE,parsedValue:n,rawValue:t.getArrayCellRawValue(e)}}else{if(t instanceof Ms)return{type:bn.FORMULA,hash:this.parser.computeHashFromAst(t.getFormula(this.lazilyTransformingAstService))};if(t instanceof Yl)return{type:bn.PARSING_ERROR,rawInput:t.rawInput,errors:t.errors}}throw Error("Trying to copy unsupported type")}getSheetClipboardCells(e){const t=this.dependencyGraph.getSheetHeight(e),n=this.dependencyGraph.getSheetWidth(e),i=new Array(t);for(let s=0;s<t;s++){i[s]=new Array(n);for(let o=0;o<n;o++){const a=$e(e,o,s);i[s][o]=this.getClipboardCell(a)}}return i}getRangeClipboardCells(e){const t=[];for(const n of e.addresses(this.dependencyGraph))t.push([n,this.getClipboardCell(n)]);return t}setCellContent(e,t){const n=this.cellContentParser.parse(t),i=this.getOldContent(e);if(n instanceof Mr.Formula){const s=this.parser.parse(n.formula,e),{ast:o,errors:a}=s;if(a.length>0)this.setParsingErrorToCell(n.formula,a,e);else try{const l=this.arraySizePredictor.checkArraySize(o,e);if(l.width<=0||l.height<=0)throw Error("Incorrect array size");this.setFormulaToCell(e,l,s)}catch(l){if(!l.message)throw l;const u={type:Vr.InvalidRangeSize,message:"Invalid range size."};this.setParsingErrorToCell(n.formula,[u],e)}}else n instanceof Mr.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:n.value,rawValue:t},e);return i}setSheetContent(e,t){this.clearSheet(e);for(let n=0;n<t.length;n++)for(let i=0;i<t[n].length;i++){const s=$e(e,i,n);this.setCellContent(s,t[n][i])}}setParsingErrorToCell(e,t,n){this.removeCellValueFromColumnSearch(n);const i=new Yl(t,e),s=this.dependencyGraph.setParsingErrorToCell(n,i);this.columnSearch.applyChanges(s.getChanges()),this.changes.addAll(s),this.changes.addChange(i.getCellValue(),n)}setFormulaToCell(e,t,{ast:n,hasVolatileFunction:i,hasStructuralChangeFunction:s,dependencies:o}){this.removeCellValueFromColumnSearch(e);const a=this.dependencyGraph.setFormulaToCell(e,n,Cs(o,e),t,i,s);this.columnSearch.applyChanges(a.getChanges()),this.changes.addAll(a)}setValueToCell(e,t){this.changeCellValueInColumnSearch(t,e.parsedValue);const n=this.dependencyGraph.setValueToCell(t,e);this.columnSearch.applyChanges(n.getChanges().filter(i=>!Oc(i.address,t))),this.changes.addAll(n),this.changes.addChange(e.parsedValue,t)}setCellEmpty(e){if(this.dependencyGraph.isArrayInternalCell(e))return;this.removeCellValueFromColumnSearch(e);const t=this.dependencyGraph.setCellEmpty(e);this.columnSearch.applyChanges(t.getChanges()),this.changes.addAll(t),this.changes.addChange(It,e)}setFormulaToCellFromCache(e,t){const{ast:n,hasVolatileFunction:i,hasStructuralChangeFunction:s,dependencies:o}=this.parser.fetchCachedResult(e),a=Cs(o,t),[l]=new WO(t.sheet).transformSingleAst(n,t);this.parser.rememberNewAst(l);const u=C8(a),c=this.arraySizePredictor.checkArraySize(n,t);this.dependencyGraph.setFormulaToCell(t,l,u,c,i,s)}rowEffectivelyNotInSheet(e,t){const n=this.dependencyGraph.addressMapping.getSheetHeight(t);return e>=n}getAndClearContentChanges(){const e=this.changes;return this.changes=aa.empty(),e}forceApplyPostponedTransformations(){this.dependencyGraph.forceApplyPostponedTransformations()}doRemoveRows(e){if(this.rowEffectivelyNotInSheet(e.rowStart,e.sheet))return;const t=[];for(const[o]of this.dependencyGraph.entriesFromRowsSpan(e))t.push({address:o,cellType:this.getClipboardCell(o)});const{affectedArrays:n,contentChanges:i}=this.dependencyGraph.removeRows(e);this.columnSearch.applyChanges(i.getChanges());let s=0;return this.stats.measure(wt.TRANSFORM_ASTS,()=>{const o=new Yg(e);o.performEagerTransformations(this.dependencyGraph,this.parser),s=this.lazilyTransformingAstService.addTransformation(o)}),this.rewriteAffectedArrays(n),{version:s,removedCells:t,rowFrom:e.rowStart,rowCount:e.numberOfRows}}doRemoveColumns(e){if(this.columnEffectivelyNotInSheet(e.columnStart,e.sheet))return;const t=[];for(const[o]of this.dependencyGraph.entriesFromColumnsSpan(e))t.push({address:o,cellType:this.getClipboardCell(o)});const{affectedArrays:n,contentChanges:i}=this.dependencyGraph.removeColumns(e);this.columnSearch.applyChanges(i.getChanges()),this.columnSearch.removeColumns(e);let s=0;return this.stats.measure(wt.TRANSFORM_ASTS,()=>{const o=new YO(e);o.performEagerTransformations(this.dependencyGraph,this.parser),s=this.lazilyTransformingAstService.addTransformation(o)}),this.rewriteAffectedArrays(n),{version:s,removedCells:t,columnFrom:e.columnStart,columnCount:e.numberOfColumns}}doAddRows(e){if(this.rowEffectivelyNotInSheet(e.rowStart,e.sheet))return;const{affectedArrays:t}=this.dependencyGraph.addRows(e);this.stats.measure(wt.TRANSFORM_ASTS,()=>{const n=new qg(e);n.performEagerTransformations(this.dependencyGraph,this.parser),this.lazilyTransformingAstService.addTransformation(n)}),this.rewriteAffectedArrays(t)}rewriteAffectedArrays(e){for(const t of e.values()){if(t.array.size.isRef)continue;const n=t.getFormula(this.lazilyTransformingAstService),i=t.getAddress(this.lazilyTransformingAstService),s=this.parser.computeHashFromAst(n);this.setFormulaToCellFromCache(s,i)}}doAddColumns(e){if(this.columnEffectivelyNotInSheet(e.columnStart,e.sheet))return;const{affectedArrays:t,contentChanges:n}=this.dependencyGraph.addColumns(e);this.columnSearch.addColumns(e),this.columnSearch.applyChanges(n.getChanges()),this.stats.measure(wt.TRANSFORM_ASTS,()=>{const i=new HO(e);i.performEagerTransformations(this.dependencyGraph,this.parser),this.lazilyTransformingAstService.addTransformation(i)}),this.rewriteAffectedArrays(t)}columnEffectivelyNotInSheet(e,t){const n=this.dependencyGraph.addressMapping.getSheetWidth(t);return e>=n}adjustNamedExpressionEdges(e,t,n){if(n===void 0)return;const{vertex:i,id:s}=this.dependencyGraph.fetchCellOrCreateEmpty(e.address),o=s??this.dependencyGraph.graph.getNodeId(i),a=this.namedExpressions.workbookNamedExpressionOrPlaceholder(t),{vertex:l,id:u}=this.dependencyGraph.fetchCellOrCreateEmpty(a.address),c=u??this.dependencyGraph.graph.getNodeId(l);for(const d of this.dependencyGraph.graph.adjacentNodes(l))if(d instanceof Ms&&d.getAddress(this.lazilyTransformingAstService).sheet===n){const h=d.getFormula(this.lazilyTransformingAstService),f=d.getAddress(this.lazilyTransformingAstService),{dependencies:m}=this.parser.fetchCachedResultForAst(h);for(const p of Cs(m,f))p instanceof mo&&p.name.toLowerCase()===e.displayName.toLowerCase()&&(this.dependencyGraph.graph.removeEdgeIfExists(c,d),this.dependencyGraph.graph.addEdge(o,d))}}storeNamedExpressionInCell(e,t){const n=this.cellContentParser.parse(t);if(n instanceof Mr.Formula){const i=this.parser.parse(n.formula,$e(-1,0,0));if(Ko(i.ast))throw new jy;const{ast:s,hasVolatileFunction:o,hasStructuralChangeFunction:a,dependencies:l}=i;this.dependencyGraph.setFormulaToCell(e,s,Cs(l,e),Ct.scalar(),o,a)}else n instanceof Mr.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:n.value,rawValue:t},e)}updateNamedExpressionsForMovedCells(e,t,n,i){if(e.sheet===i.sheet)return[];const s=[],o=it.spanFrom(i,t,n);for(const a of o.addresses(this.dependencyGraph)){const l=this.addressMapping.getCell(a,{throwIfCellNotExists:!0});if(l instanceof Ms&&a.sheet!==e.sheet){const u=l.getFormula(this.lazilyTransformingAstService),{dependencies:c}=this.parser.fetchCachedResultForAst(u);s.push(...this.updateNamedExpressionsForTargetAddress(e.sheet,a,c))}}return s}updateNamedExpressionsForTargetAddress(e,t,n){if(e===t.sheet)return[];const i=[],s=this.addressMapping.getCellOrThrow(t);for(const o of Cs(n,t)){if(!(o instanceof mo))continue;const a=o.name,l=this.dependencyGraph.fetchNamedExpressionVertex(a,e).vertex,c=this.namedExpressions.isExpressionInScope(a,t.sheet)?this.dependencyGraph.fetchNamedExpressionVertex(a,t.sheet).vertex:this.copyOrFetchGlobalNamedExpressionVertex(a,l,i);c!==l&&(this.dependencyGraph.graph.removeEdgeIfExists(l,s),this.dependencyGraph.graph.addEdge(c,s))}return i}allocateNamedExpressionAddressSpace(){this.dependencyGraph.addressMapping.addSheetWithStrategy(Ro.SHEET_FOR_WORKBOOK_EXPRESSIONS,new W8(0,0))}copyOrFetchGlobalNamedExpressionVertex(e,t,n){let i=this.namedExpressions.namedExpressionForScope(e);if(i===void 0)if(i=this.namedExpressions.addNamedExpression(e),n.push(i.normalizeExpressionName()),t instanceof Ms){const s=this.parser.fetchCachedResultForAst(t.getFormula(this.lazilyTransformingAstService)),{ast:o,hasVolatileFunction:a,hasStructuralChangeFunction:l,dependencies:u}=s;this.dependencyGraph.setFormulaToCell(i.address,o,Cs(u,i.address),Ct.scalar(),a,l)}else t instanceof ta?this.setCellEmpty(i.address):t instanceof la&&this.setValueToCell(t.getValues(),i.address);return this.dependencyGraph.fetchCellOrCreateEmpty(i.address).vertex}removeCellValueFromColumnSearch(e){if(this.isNotComputed(e))return;const t=this.dependencyGraph.getCellValue(e);this.columnSearch.remove(He(t),e)}changeCellValueInColumnSearch(e,t){if(this.isNotComputed(e))return;const n=this.dependencyGraph.getCellValue(e);this.columnSearch.change(He(n),He(t),e)}isNotComputed(e){const t=this.dependencyGraph.getCell(e);return t?"isComputed"in t&&!t.isComputed():!1}}function Sf(r){if(r.length<=1)return r;const e=[...r].sort(([i],[s])=>i-s),t=e.reduce((i,[s,o])=>{const a=i[i.length-1],l=a[0]+a[1];return s<=l?a[1]+=Math.max(0,o-(l-s)):i.push([s,o]),i},[e[0]]);let n=0;for(let i=0;i<t.length;++i)t[i][0]-=n,n+=t[i][1];return t}function Tf(r){if(r.length<=1)return r;const e=[...r].sort(([i],[s])=>i-s),t=e.reduce((i,[s,o])=>{const a=i[i.length-1];return s===a[0]?a[1]=Math.max(a[1],o):i.push([s,o]),i},[e[0]]);let n=0;for(let i=0;i<t.length;++i)t[i][0]+=n,n+=t[i][1];return t}function Rf(r){return Number.isInteger(r)&&r>0}function ZO(r,e,t){return r.row===0&&Rf(e)&&t===Number.POSITIVE_INFINITY||r.col===0&&Rf(t)&&e===Number.POSITIVE_INFINITY}class tn{}class QO extends tn{constructor(e,t){super(),this.command=e,this.rowsRemovals=t}doUndo(e){e.undoRemoveRows(this)}doRedo(e){e.redoRemoveRows(this)}}class JO extends tn{constructor(e,t,n,i,s,o,a){super(),this.sourceLeftCorner=e,this.width=t,this.height=n,this.destinationLeftCorner=i,this.overwrittenCellsData=s,this.addedGlobalNamedExpressions=o,this.version=a}doUndo(e){e.undoMoveCells(this)}doRedo(e){e.redoMoveCells(this)}}class eI extends tn{constructor(e){super(),this.command=e}doUndo(e){e.undoAddRows(this)}doRedo(e){e.redoAddRows(this)}}class tI extends tn{constructor(e,t,n){super(),this.sheetId=e,this.rowMapping=t,this.oldContent=n}doUndo(e){e.undoSetRowOrder(this)}doRedo(e){e.redoSetRowOrder(this)}}class rI extends tn{constructor(e,t,n){super(),this.sheetId=e,this.columnMapping=t,this.oldContent=n}doUndo(e){e.undoSetColumnOrder(this)}doRedo(e){e.redoSetColumnOrder(this)}}class nI extends tn{constructor(e,t,n){super(),this.sheetId=e,this.oldSheetContent=t,this.newSheetContent=n}doUndo(e){e.undoSetSheetContent(this)}doRedo(e){e.redoSetSheetContent(this)}}class iI extends tn{constructor(e,t,n,i,s){super(),this.sheet=e,this.startRow=t,this.numberOfRows=n,this.targetRow=i,this.version=s,this.undoStart=this.startRow<this.targetRow?this.targetRow-this.numberOfRows:this.targetRow,this.undoEnd=this.startRow>this.targetRow?this.startRow+this.numberOfRows:this.startRow}doUndo(e){e.undoMoveRows(this)}doRedo(e){e.redoMoveRows(this)}}class sI extends tn{constructor(e,t,n,i,s){super(),this.sheet=e,this.startColumn=t,this.numberOfColumns=n,this.targetColumn=i,this.version=s,this.undoStart=this.startColumn<this.targetColumn?this.targetColumn-this.numberOfColumns:this.targetColumn,this.undoEnd=this.startColumn>this.targetColumn?this.startColumn+this.numberOfColumns:this.startColumn}doUndo(e){e.undoMoveColumns(this)}doRedo(e){e.redoMoveColumns(this)}}class oI extends tn{constructor(e){super(),this.command=e}doUndo(e){e.undoAddColumns(this)}doRedo(e){e.redoAddColumns(this)}}class aI extends tn{constructor(e,t){super(),this.command=e,this.columnsRemovals=t}doUndo(e){e.undoRemoveColumns(this)}doRedo(e){e.redoRemoveColumns(this)}}class lI extends tn{constructor(e,t){super(),this.sheetName=e,this.sheetId=t}doUndo(e){e.undoAddSheet(this)}doRedo(e){e.redoAddSheet(this)}}class uI extends tn{constructor(e,t,n,i){super(),this.sheetName=e,this.sheetId=t,this.oldSheetContent=n,this.scopedNamedExpressions=i}doUndo(e){e.undoRemoveSheet(this)}doRedo(e){e.redoRemoveSheet(this)}}class cI extends tn{constructor(e,t,n,i,s){super(),this.sheetId=e,this.oldName=t,this.newName=n,this.version=i,this.mergedPlaceholderSheetId=s}doUndo(e){e.undoRenameSheet(this)}doRedo(e){e.redoRenameSheet(this)}}class hI extends tn{constructor(e,t){super(),this.sheetId=e,this.oldSheetContent=t}doUndo(e){e.undoClearSheet(this)}doRedo(e){e.redoClearSheet(this)}}class dI extends tn{constructor(e){super(),this.cellContents=e}doUndo(e){e.undoSetCellContents(this)}doRedo(e){e.redoSetCellContents(this)}}class fI extends tn{constructor(e,t,n,i){super(),this.targetLeftCorner=e,this.oldContent=t,this.newContent=n,this.addedGlobalNamedExpressions=i}doUndo(e){e.undoPaste(this)}doRedo(e){e.redoPaste(this)}}class pI extends tn{constructor(e,t,n,i){super(),this.name=e,this.newContent=t,this.scope=n,this.options=i}doUndo(e){e.undoAddNamedExpression(this)}doRedo(e){e.redoAddNamedExpression(this)}}class mI extends tn{constructor(e,t,n){super(),this.namedExpression=e,this.content=t,this.scope=n}doUndo(e){e.undoRemoveNamedExpression(this)}doRedo(e){e.redoRemoveNamedExpression(this)}}class gI extends tn{constructor(e,t,n,i,s){super(),this.namedExpression=e,this.newContent=t,this.oldContent=n,this.scope=i,this.options=s}doUndo(e){e.undoChangeNamedExpression(this)}doRedo(e){e.redoChangeNamedExpression(this)}}class yI extends tn{constructor(){super(...arguments),this.operations=[]}add(e){this.operations.push(e)}*reversedOperations(){for(let e=this.operations.length-1;e>=0;e--)yield this.operations[e]}doUndo(e){e.undoBatch(this)}doRedo(e){e.redoBatch(this)}}class vI{constructor(e,t){this.operations=t,this.oldData=new Map,this.undoStack=[],this.redoStack=[],this.undoLimit=e.undoLimit}saveOperation(e){this.batchUndoEntry!==void 0?this.batchUndoEntry.add(e):this.addUndoEntry(e)}beginBatchMode(){this.batchUndoEntry=new yI}commitBatchMode(){if(this.batchUndoEntry===void 0)throw Error("Batch mode wasn't started");this.addUndoEntry(this.batchUndoEntry),this.batchUndoEntry=void 0}storeDataForVersion(e,t,n){this.oldData.has(e)||this.oldData.set(e,[]),this.oldData.get(e).push([t,n])}clearRedoStack(){this.redoStack=[]}clearUndoStack(){this.undoStack=[]}isUndoStackEmpty(){return this.undoStack.length===0}isRedoStackEmpty(){return this.redoStack.length===0}undo(){const e=this.undoStack.pop();if(!e)throw Error("Attempted to undo without operation on stack");this.undoEntry(e),this.redoStack.push(e)}undoBatch(e){for(const t of e.reversedOperations())this.undoEntry(t)}undoRemoveRows(e){this.operations.forceApplyPostponedTransformations();const{command:{sheet:t},rowsRemovals:n}=e;for(let i=n.length-1;i>=0;--i){const s=n[i];this.operations.addRows(new jS(t,[[s.rowFrom,s.rowCount]]));for(const{address:o,cellType:a}of s.removedCells)this.operations.restoreCell(o,a);this.restoreOldDataFromVersion(s.version-1)}}undoRemoveColumns(e){this.operations.forceApplyPostponedTransformations();const{command:{sheet:t},columnsRemovals:n}=e;for(let i=n.length-1;i>=0;--i){const s=n[i];this.operations.addColumns(new $S(t,[[s.columnFrom,s.columnCount]]));for(const{address:o,cellType:a}of s.removedCells)this.operations.restoreCell(o,a);this.restoreOldDataFromVersion(s.version-1)}}undoAddRows(e){const t=e.command.rowsSpans();for(let n=t.length-1;n>=0;--n){const i=t[n];this.operations.removeRows(new VS(e.command.sheet,[[i.rowStart,i.numberOfRows]]))}}undoAddColumns(e){const t=e.command.columnsSpans();for(let n=t.length-1;n>=0;--n){const i=t[n];this.operations.removeColumns(new zS(e.command.sheet,[[i.columnStart,i.numberOfColumns]]))}}undoSetCellContents(e){for(const t of e.cellContents){const n=t.address,[i,s]=t.oldContent;Oc(n,i)||this.operations.setCellEmpty(n),this.operations.restoreCell(i,s)}}undoPaste(e){this.restoreOperationOldContent(e.oldContent);for(const t of e.addedGlobalNamedExpressions)this.operations.removeNamedExpression(t)}undoMoveRows(e){const{sheet:t}=e;this.operations.moveRows(t,e.undoStart,e.numberOfRows,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}undoMoveColumns(e){const{sheet:t}=e;this.operations.moveColumns(t,e.undoStart,e.numberOfColumns,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}undoMoveCells(e){this.operations.forceApplyPostponedTransformations(),this.operations.moveCells(e.destinationLeftCorner,e.width,e.height,e.sourceLeftCorner),this.restoreOperationOldContent(e.overwrittenCellsData),this.restoreOldDataFromVersion(e.version-1);for(const t of e.addedGlobalNamedExpressions)this.operations.removeNamedExpression(t)}undoAddSheet(e){const{sheetName:t}=e;this.operations.removeSheetByName(t)}undoRemoveSheet(e){this.operations.forceApplyPostponedTransformations();const{oldSheetContent:t,sheetId:n,scopedNamedExpressions:i,sheetName:s}=e;this.operations.addSheetWithId(n,s);for(let o=0;o<t.length;o++){const a=t[o];for(let l=0;l<a.length;l++){const u=a[l],c=$e(n,l,o);this.operations.restoreCell(c,u)}}for(const[o,a]of i)this.operations.restoreNamedExpression(o,a,n)}undoRenameSheet(e){this.operations.forceApplyPostponedTransformations(),this.operations.renameSheet(e.sheetId,e.oldName),e.mergedPlaceholderSheetId!==void 0&&e.version!==void 0&&(this.operations.addPlaceholderSheetWithId(e.mergedPlaceholderSheetId,e.newName),this.restoreOldDataFromVersion(e.version-1))}undoClearSheet(e){const{oldSheetContent:t,sheetId:n}=e;for(let i=0;i<t.length;i++){const s=t[i];for(let o=0;o<s.length;o++){const a=s[o],l=$e(n,o,i);this.operations.restoreCell(l,a)}}}undoSetSheetContent(e){const{oldSheetContent:t,sheetId:n}=e;this.operations.clearSheet(n);for(let i=0;i<t.length;i++){const s=t[i];for(let o=0;o<s.length;o++){const a=s[o],l=$e(n,o,i);this.operations.restoreCell(l,a)}}}undoAddNamedExpression(e){this.operations.removeNamedExpression(e.name,e.scope)}undoRemoveNamedExpression(e){this.operations.restoreNamedExpression(e.namedExpression,e.content,e.scope)}undoChangeNamedExpression(e){this.operations.restoreNamedExpression(e.namedExpression,e.oldContent,e.scope)}undoSetRowOrder(e){this.restoreOperationOldContent(e.oldContent)}undoSetColumnOrder(e){this.restoreOperationOldContent(e.oldContent)}redo(){const e=this.redoStack.pop();if(!e)throw Error("Attempted to redo without operation on stack");this.redoEntry(e),this.undoStack.push(e)}redoBatch(e){for(const t of e.operations)this.redoEntry(t)}redoRemoveRows(e){this.operations.removeRows(e.command)}redoMoveCells(e){this.operations.moveCells(e.sourceLeftCorner,e.width,e.height,e.destinationLeftCorner)}redoRemoveColumns(e){this.operations.removeColumns(e.command)}redoPaste(e){const{targetLeftCorner:t,newContent:n}=e,i=n.length,s=n[0].length;for(let o=0;o<i;++o)for(let a=0;a<s;++a){const l=$e(t.sheet,t.col+a,t.row+o);this.operations.restoreCell(l,n[o][a])}}redoSetCellContents(e){for(const t of e.cellContents)this.operations.setCellContent(t.address,t.newContent)}redoAddRows(e){this.operations.addRows(e.command)}redoAddColumns(e){this.operations.addColumns(e.command)}redoRemoveSheet(e){this.operations.removeSheetByName(e.sheetName)}redoAddSheet(e){this.operations.addSheetWithId(e.sheetId,e.sheetName)}redoRenameSheet(e){this.operations.renameSheet(e.sheetId,e.newName)}redoMoveRows(e){this.operations.moveRows(e.sheet,e.startRow,e.numberOfRows,e.targetRow)}redoMoveColumns(e){this.operations.moveColumns(e.sheet,e.startColumn,e.numberOfColumns,e.targetColumn)}redoClearSheet(e){this.operations.clearSheet(e.sheetId)}redoSetSheetContent(e){const{sheetId:t,newSheetContent:n}=e;this.operations.setSheetContent(t,n)}redoAddNamedExpression(e){this.operations.addNamedExpression(e.name,e.newContent,e.scope,e.options)}redoRemoveNamedExpression(e){this.operations.removeNamedExpression(e.namedExpression.displayName,e.scope)}redoChangeNamedExpression(e){this.operations.changeNamedExpressionExpression(e.namedExpression.displayName,e.newContent,e.scope,e.options)}redoSetRowOrder(e){this.operations.setRowOrder(e.sheetId,e.rowMapping)}redoSetColumnOrder(e){this.operations.setColumnOrder(e.sheetId,e.columnMapping)}addUndoEntry(e){this.undoStack.push(e),this.undoStack.splice(0,Math.max(0,this.undoStack.length-this.undoLimit))}undoEntry(e){e.doUndo(this)}restoreOperationOldContent(e){for(const[t,n]of e)this.operations.restoreCell(t,n)}redoEntry(e){e.doRedo(this)}restoreOldDataFromVersion(e){const t=this.oldData.get(e)||[];for(const n of t){const[i,s]=n;this.operations.setFormulaToCellFromCache(s,i)}}}class bI{constructor(e,t,n,i,s,o,a,l,u,c){this.operations=t,this.undoRedo=n,this.clipboardOperations=i,this.dependencyGraph=s,this.columnSearch=o,this.parser=a,this.cellContentParser=l,this.lazilyTransformingAstService=u,this.namedExpressions=c,this.maxRows=e.maxRows,this.maxColumns=e.maxColumns}get sheetMapping(){return this.dependencyGraph.sheetMapping}addRows(e,...t){const n=new jS(e,t);this.ensureItIsPossibleToAddRows(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addRows(n),this.undoRedo.saveOperation(new eI(n))}removeRows(e,...t){const n=new VS(e,t);this.ensureItIsPossibleToRemoveRows(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const i=this.operations.removeRows(n);this.undoRedo.saveOperation(new QO(n,i))}addColumns(e,...t){const n=new $S(e,t);this.ensureItIsPossibleToAddColumns(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addColumns(n),this.undoRedo.saveOperation(new oI(n))}removeColumns(e,...t){const n=new zS(e,t);this.ensureItIsPossibleToRemoveColumns(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const i=this.operations.removeColumns(n);this.undoRedo.saveOperation(new aI(n,i))}moveCells(e,t,n,i){this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const{version:s,overwrittenCellsData:o,addedGlobalNamedExpressions:a}=this.operations.moveCells(e,t,n,i);this.undoRedo.saveOperation(new JO(e,t,n,i,o,a,s))}moveRows(e,t,n,i){this.ensureItIsPossibleToMoveRows(e,t,n,i),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const s=this.operations.moveRows(e,t,n,i);this.undoRedo.saveOperation(new iI(e,t,n,i,s))}moveColumns(e,t,n,i){this.ensureItIsPossibleToMoveColumns(e,t,n,i),this.undoRedo.clearRedoStack();const s=this.operations.moveColumns(e,t,n,i);this.undoRedo.saveOperation(new sI(e,t,n,i,s))}cut(e,t,n){this.clipboardOperations.cut(e,t,n)}ensureItIsPossibleToCopy(e,t,n){if(!Sl(t))throw new Zr("width to be positive integer.");if(!Sl(n))throw new Zr("height to be positive integer.")}copy(e,t,n){this.ensureItIsPossibleToCopy(e,t,n),this.clipboardOperations.copy(e,t,n)}paste(e){const t=this.clipboardOperations.clipboard;if(t===void 0)throw new yS;if(this.clipboardOperations.isCutClipboard())this.moveCells(t.sourceLeftCorner,t.width,t.height,e);else if(this.clipboardOperations.isCopyClipboard()){this.clipboardOperations.ensureItIsPossibleToCopyPaste(e);const n=it.spanFrom(e,t.width,t.height),i=this.operations.getRangeClipboardCells(n);this.undoRedo.clearRedoStack();const s=this.operations.restoreClipboardCells(t.sourceLeftCorner.sheet,t.getContent(e));this.undoRedo.saveOperation(new fI(e,i,t.content,s))}}beginUndoRedoBatchMode(){this.undoRedo.beginBatchMode()}commitUndoRedoBatchMode(){this.undoRedo.commitBatchMode()}isClipboardEmpty(){return this.clipboardOperations.clipboard===void 0}clearClipboard(){this.clipboardOperations.clear()}addSheet(e){e!==void 0&&this.ensureItIsPossibleToAddSheet(e),this.undoRedo.clearRedoStack();const{sheetName:t,sheetId:n}=this.operations.addSheet(e);return this.undoRedo.saveOperation(new lI(t,n)),t}removeSheet(e){this.ensureScopeIdIsValid(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const t=this.sheetMapping.getSheetNameOrThrowError(e),n=this.operations.getSheetClipboardCells(e),i=this.operations.removeSheet(e);this.undoRedo.saveOperation(new uI(t,e,n,i))}renameSheet(e,t){this.ensureItIsPossibleToRenameSheet(e,t);const{previousDisplayName:n,version:i,mergedPlaceholderSheetId:s}=this.operations.renameSheet(e,t);return n!==void 0&&(this.undoRedo.clearRedoStack(),this.undoRedo.saveOperation(new cI(e,n,t,i,s))),n}clearSheet(e){this.ensureScopeIdIsValid(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const t=this.operations.getSheetClipboardCells(e);this.operations.clearSheet(e),this.undoRedo.saveOperation(new hI(e,t))}setCellContents(e,t){if(!(t instanceof Array))t=[[t]];else for(let i=0;i<t.length;i++)if(!(t[i]instanceof Array))throw new Zr("an array of arrays or a raw cell value.");this.ensureItIsPossibleToChangeCellContents(e,t),this.undoRedo.clearRedoStack();const n=[];for(let i=0;i<t.length;i++)for(let s=0;s<t[i].length;s++){const o={sheet:e.sheet,row:e.row+i,col:e.col+s},a=t[i][s];this.clipboardOperations.abortCut();const l=this.operations.setCellContent(o,a);n.push({address:o,newContent:a,oldContent:l})}this.undoRedo.saveOperation(new dI(n))}setSheetContent(e,t){this.ensureScopeIdIsValid(e),this.ensureItIsPossibleToChangeSheetContents(e,t),TS(t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const n=this.operations.getSheetClipboardCells(e);this.operations.setSheetContent(e,t),this.undoRedo.saveOperation(new nI(e,n,t))}setRowOrder(e,t){this.validateSwapRowIndexes(e,t),this.testRowOrderForArrays(e,t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const n=this.operations.setRowOrder(e,t);this.undoRedo.saveOperation(new tI(e,t,n))}validateSwapRowIndexes(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new Dn(e);this.validateRowOrColumnMapping(e,t,"row")}testColumnOrderForArrays(e,t){for(const[n,i]of t)if(n!==i){const s=it.spanFrom({sheet:e,col:n,row:0},1,1/0);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(s))throw new Ul}}setColumnOrder(e,t){this.validateSwapColumnIndexes(e,t),this.testColumnOrderForArrays(e,t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const n=this.operations.setColumnOrder(e,t);this.undoRedo.saveOperation(new rI(e,t,n))}validateSwapColumnIndexes(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new Dn(e);this.validateRowOrColumnMapping(e,t,"column")}testRowOrderForArrays(e,t){for(const[n,i]of t)if(n!==i){const s=it.spanFrom({sheet:e,col:0,row:n},1/0,1);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(s))throw new Ul}}mappingFromOrder(e,t,n){if(!this.sheetMapping.hasSheetWithId(e))throw new Dn(e);const i=n==="row"?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e);if(t.length!==i)throw new Zr(`number of ${n}s provided to be sheet ${n==="row"?"height":"width"}.`);const s=[];for(let o=0;o<i;o++)t[o]!==o&&s.push([o,t[o]]);return s}undo(){if(this.undoRedo.isUndoStackEmpty())throw new mS;this.clipboardOperations.abortCut(),this.undoRedo.undo()}redo(){if(this.undoRedo.isRedoStackEmpty())throw new gS;this.clipboardOperations.abortCut(),this.undoRedo.redo()}addNamedExpression(e,t,n,i){this.ensureItIsPossibleToAddNamedExpression(e,t,n),this.operations.addNamedExpression(e,t,n,i),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new pI(e,t,n,i))}changeNamedExpressionExpression(e,t,n,i){this.ensureItIsPossibleToChangeNamedExpression(e,n,t);const[s,o]=this.operations.changeNamedExpressionExpression(e,n,t,i);this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new gI(s,n,o,t,i))}removeNamedExpression(e,t){this.ensureScopeIdIsValid(t);const[n,i]=this.operations.removeNamedExpression(e,t);return this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new mI(n,i,t)),n}ensureItIsPossibleToAddNamedExpression(e,t,n){this.ensureScopeIdIsValid(n),this.ensureNamedExpressionNameIsValid(e,n),this.ensureNamedExpressionIsValid(t)}ensureItIsPossibleToChangeNamedExpression(e,t,n){if(this.ensureScopeIdIsValid(n),this.namedExpressions.namedExpressionForScope(e,n)===void 0)throw new Nc(e);this.ensureNamedExpressionIsValid(t)}isItPossibleToRemoveNamedExpression(e,t){if(this.ensureScopeIdIsValid(t),this.namedExpressions.namedExpressionForScope(e,t)===void 0)throw new Nc(e)}ensureItIsPossibleToAddRows(e,...t){if(!this.sheetMapping.hasSheetWithId(e))throw new Dn(e);const n=this.dependencyGraph.getSheetHeight(e),i=t.map(s=>s[1]).reduce((s,o)=>s+o,0);if(n+i>this.maxRows)throw new Ha;for(const[s,o]of t)if(!Ca(s)||!Sl(o))throw new Zr("row number to be nonnegative and number of rows to add to be positive.")}ensureItIsPossibleToRemoveRows(e,...t){for(const[n,i]of t){const s=n+i-1;if(!Ca(n)||!Ca(s))throw new Zr("starting and ending row to be nonnegative.");if(s<n)throw new Zr("starting row to be smaller than the ending row.");if(!this.sheetMapping.hasSheetWithId(e))throw new Dn(e)}}ensureItIsPossibleToAddColumns(e,...t){if(!this.sheetMapping.hasSheetWithId(e))throw new Dn(e);const n=this.dependencyGraph.getSheetWidth(e),i=t.map(s=>s[1]).reduce((s,o)=>s+o,0);if(n+i>this.maxColumns)throw new Ha;for(const[s,o]of t)if(!Ca(s)||!Sl(o))throw new Zr("column number to be nonnegative and number of columns to add to be positive.")}ensureItIsPossibleToRemoveColumns(e,...t){for(const[n,i]of t){const s=n+i-1;if(!Ca(n)||!Ca(s))throw new Zr("starting and ending column to be nonnegative.");if(s<n)throw new Zr("starting column to be smaller than the ending column.");if(!this.sheetMapping.hasSheetWithId(e))throw new Dn(e)}}ensureItIsPossibleToMoveRows(e,t,n,i){this.ensureItIsPossibleToAddRows(e,[i,n]);const s=$e(e,0,t),o=$e(e,0,i);if(!this.sheetMapping.hasSheetWithId(e)||ii(s)||ii(o)||!Sl(n)||i<=t+n&&i>=t)throw new Zr("a valid range of rows to move.");const a=this.dependencyGraph.getSheetWidth(e),l=it.spanFrom(s,a,n);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(l))throw new Ul;if(i>0&&this.dependencyGraph.arrayMapping.isFormulaArrayInAllRows(si.fromNumberOfRows(e,i-1,2)))throw new vf}ensureItIsPossibleToMoveColumns(e,t,n,i){this.ensureItIsPossibleToAddColumns(e,[i,n]);const s=$e(e,t,0),o=$e(e,i,0);if(!this.sheetMapping.hasSheetWithId(e)||ii(s)||ii(o)||!Sl(n)||i<=t+n&&i>=t)throw new Zr("a valid range of columns to move.");const a=this.dependencyGraph.getSheetHeight(e),l=it.spanFrom(s,n,a);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(l))throw new Ul;if(i>0&&this.dependencyGraph.arrayMapping.isFormulaArrayInAllColumns(xi.fromNumberOfColumns(e,i-1,2)))throw new vf}ensureItIsPossibleToAddSheet(e){if(this.sheetMapping.hasSheetWithName(e))throw new ea(e)}ensureItIsPossibleToRenameSheet(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new Dn(e);const n=this.sheetMapping.getSheetId(t);if(n!==void 0&&n!==e)throw new ea(t)}ensureItIsPossibleToChangeContent(e){if(ii(e))throw new dS(e);if(!this.sheetMapping.hasSheetWithId(e.sheet))throw new Dn(e.sheet)}ensureItIsPossibleToChangeCellContents(e,t){const n=bf(t),i=it.spanFrom(e,n.width,n.height);this.ensureRangeInSizeLimits(i);for(const s of i.addresses(this.dependencyGraph))this.ensureItIsPossibleToChangeContent(s)}ensureItIsPossibleToChangeSheetContents(e,t){const n=bf(t),i=it.spanFrom($e(e,0,0),n.width,n.height);this.ensureRangeInSizeLimits(i)}ensureRangeInSizeLimits(e){if(e.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new Ha}isThereSomethingToUndo(){return!this.undoRedo.isUndoStackEmpty()}isThereSomethingToRedo(){return!this.undoRedo.isRedoStackEmpty()}getAndClearContentChanges(){return this.operations.getAndClearContentChanges()}ensureScopeIdIsValid(e){if(e!==void 0&&!this.sheetMapping.hasSheetWithId(e))throw new Dn(e)}validateRowOrColumnMapping(e,t,n){const i=n==="row"?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e),s=t.map(([a,l])=>a).sort((a,l)=>a-l),o=t.map(([a,l])=>l).sort((a,l)=>a-l);for(let a=0;a<s.length;a++){if(!Ca(s[a])||s[a]>=i)throw new Zr(`${n} numbers to be nonnegative integers and less than sheet ${n==="row"?"height":"width"}.`);if(s[a]===s[a+1])throw new Zr(`source ${n} numbers to be unique.`);if(s[a]!==o[a])throw new Zr(`target ${n} numbers to be permutation of source ${n} numbers.`)}}ensureNamedExpressionNameIsValid(e,t){if(!this.namedExpressions.isNameValid(e))throw new pS(e);if(!this.namedExpressions.isNameAvailable(e,t))throw new fS(e)}ensureNamedExpressionIsValid(e){const t=this.cellContentParser.parse(e);if(t instanceof Mr.Formula){const n=this.parser.parse(t.formula,$e(-1,0,0));if(Ko(n.ast))throw new jy}}}function Sl(r){return Number.isInteger(r)&&r>0}function Ca(r){return Number.isInteger(r)&&r>=0}class wI{constructor(e,t,n,i,s,o){this.config=e,this.stats=t,this.interpreter=n,this.lazilyTransformingAstService=i,this.dependencyGraph=s,this.columnSearch=o}run(){this.stats.start(wt.TOP_SORT);const{sorted:e,cycled:t}=this.dependencyGraph.topSortWithScc();this.stats.end(wt.TOP_SORT),this.stats.measure(wt.EVALUATION,()=>{this.recomputeFormulas(t,e)})}partialRun(e){const t=aa.empty();return this.stats.measure(wt.EVALUATION,()=>{this.dependencyGraph.graph.getTopSortedWithSccSubgraphFrom(e,n=>this.recomputeVertex(n,t),n=>this.processVertexOnCycle(n,t))}),t}runAndForget(e,t,n){const i=[];for(const o of Cs(n,t))if(o instanceof it){const a=o;if(this.dependencyGraph.getRange(a.start,a.end)===void 0){const l=new Fn(a);this.dependencyGraph.rangeMapping.addOrUpdateVertex(l),i.push(l)}}const s=this.evaluateAstToCellValue(e,new Ls(t,this.config.useArrayArithmetic));return i.forEach(o=>{this.dependencyGraph.rangeMapping.removeVertexIfExists(o)}),s}recomputeVertex(e,t){if(e instanceof ni){const n=e.isComputed()?e.getCellValue():void 0,i=this.recomputeFormulaVertexValue(e);if(i!==n){const s=e.getAddress(this.lazilyTransformingAstService);return t.addChange(i,s),this.columnSearch.change(He(n),He(i),s),!0}return!1}else return e instanceof Fn&&e.clearCache(),!0}processVertexOnCycle(e,t){if(e instanceof Fn)e.clearCache();else if(e instanceof ni){const n=e.getAddress(this.lazilyTransformingAstService);this.columnSearch.remove(He(e.valueOrUndef()),n);const i=new J(te.CYCLE,void 0,e);e.setCellValue(i),t.addChange(i,n)}}recomputeFormulas(e,t){e.forEach(n=>{n instanceof ni&&n.setCellValue(new J(te.CYCLE,void 0,n))}),t.forEach(n=>{if(n instanceof ni){const i=this.recomputeFormulaVertexValue(n),s=n.getAddress(this.lazilyTransformingAstService);this.columnSearch.add(He(i),s)}else n instanceof Fn&&n.clearCache()})}recomputeFormulaVertexValue(e){const t=e.getAddress(this.lazilyTransformingAstService);if(e instanceof Wr&&(e.array.size.isRef||!this.dependencyGraph.isThereSpaceForArray(e)))return e.setNoSpace();{const n=e.getFormula(this.lazilyTransformingAstService),i=this.evaluateAstToCellValue(n,new Ls(t,this.config.useArrayArithmetic,e));return e.setCellValue(i)}}evaluateAstToCellValue(e,t){const n=this.interpreter.evaluateAst(e,t);return n instanceof Ge?n:n===It&&this.config.evaluateNullToZero?0:n}}class Xg{constructor(e,t){this.address=e,this.newValue=t}get col(){return this.address.col}get row(){return this.address.row}get sheet(){return this.address.sheet}get value(){return this.newValue}}class HS{constructor(e,t){this.name=e,this.newValue=t}}class _I{constructor(e,t,n,i){this.config=e,this.namedExpressions=t,this.sheetMapping=n,this.lazilyTransformingService=i}exportChange(e){const t=e.value,n=e.address;if(n.sheet===Ro.SHEET_FOR_WORKBOOK_EXPRESSIONS){const i=this.namedExpressions.namedExpressionInAddress(n.row);if(!i)throw new Error("Missing named expression");return new HS(i.displayName,this.exportScalarOrRange(t))}else if(t instanceof Ge){const i=[];for(const[s,o]of t.entriesFromTopLeftCorner(n))i.push(new Xg(o,this.exportValue(s)));return i}else return new Xg(n,this.exportValue(t))}exportValue(e){return e instanceof Ge?this.detailedError(new J(te.VALUE,ue.ScalarExpected)):this.config.smartRounding&&Qt(e)?this.cellValueRounding(He(e)):e instanceof J?this.detailedError(e):e===It?null:He(e)}exportScalarOrRange(e){return e instanceof Ge?e.rawData().map(t=>t.map(n=>this.exportValue(n))):this.exportValue(e)}detailedError(e){var t,n;let i;const s=(t=e.root)===null||t===void 0?void 0:t.getAddress(this.lazilyTransformingService);return s!==void 0&&(s.sheet===Ro.SHEET_FOR_WORKBOOK_EXPRESSIONS?i=(n=this.namedExpressions.namedExpressionInAddress(s.row))===null||n===void 0?void 0:n.displayName:i=nf(this.sheetMapping.getSheetNameOrThrowError.bind(this.sheetMapping),s,-1)),new kS(e,this.config.translationPackage.getErrorTranslation(e.type),i)}cellValueRounding(e){if(e===0)return e;const t=Math.floor(Math.log10(Math.abs(e))),n=Math.pow(10,this.config.precisionRounding-t);return e<0?-Math.round(-e*n)/n:Math.round(e*n)/n}}class xI{constructor(e,t,n,i,s,o){this.dependencyGraph=e,this.columnSearch=t,this.parser=n,this.cellContentParser=i,this.stats=s,this.arraySizePredictor=o,this.buildStrategy=new EI(e,t,n,s,i,o)}buildGraph(e,t){const n=t.measure(wt.COLLECT_DEPENDENCIES,()=>this.buildStrategy.run(e));this.dependencyGraph.getAndClearContentChanges(),t.measure(wt.PROCESS_DEPENDENCIES,()=>this.processDependencies(n))}processDependencies(e){e.forEach((t,n)=>{this.dependencyGraph.processCellDependencies(t,n)})}}class EI{constructor(e,t,n,i,s,o){this.dependencyGraph=e,this.columnIndex=t,this.parser=n,this.stats=i,this.cellContentParser=s,this.arraySizePredictor=o}run(e){const t=new Map;for(const n in e){const i=this.dependencyGraph.getSheetId(n),s=e[n];for(let o=0;o<s.length;++o){const a=s[o];for(let l=0;l<a.length;++l){const u=a[l],c=$e(i,l,o),d=this.cellContentParser.parse(u);if(d instanceof Mr.Formula){const h=this.stats.measure(wt.PARSER,()=>this.parser.parse(d.formula,c));if(h.errors.length>0){this.shrinkArrayIfNeeded(c);const f=new Yl(h.errors,d.formula);this.dependencyGraph.addVertex(c,f)}else{this.shrinkArrayIfNeeded(c);const f=this.arraySizePredictor.checkArraySize(h.ast,c);if(f.isScalar()){const m=new Ms(h.ast,c,0);t.set(m,Cs(h.dependencies,c)),this.dependencyGraph.addVertex(c,m),h.hasVolatileFunction&&this.dependencyGraph.markAsVolatile(m),h.hasStructuralChangeFunction&&this.dependencyGraph.markAsDependentOnStructureChange(m)}else{const m=new Wr(h.ast,c,new Ct(f.width,f.height));t.set(m,Cs(h.dependencies,c)),this.dependencyGraph.addArrayVertex(c,m)}}}else if(!(d instanceof Mr.Empty)){this.shrinkArrayIfNeeded(c);const h=new la(d.value,u);this.columnIndex.add(He(d.value),c),this.dependencyGraph.addVertex(c,h)}}}}return t}shrinkArrayIfNeeded(e){const t=this.dependencyGraph.getCell(e);t instanceof Wr&&this.dependencyGraph.shrinkArrayToCorner(t)}}const Ph=new Map([["gpl-v3",1],["missing",2],["invalid",3],["expired",4]]);class WS extends At{version(e,t){return this.runFunction(e.args,t,this.metadata("VERSION"),()=>{const{licenseKeyValidityState:n,licenseKey:i}=this.config;let s;return Ph.has(i)?s=Ph.get(i):Ph.has(n)?s=Ph.get(n):n==="valid"&&(s=i.slice(-5)),`HyperFormula v${yn.version}, ${s}`})}}WS.implementedFunctions={VERSION:{method:"version",parameters:[]}};function Pm(r,e){var t;let n=e.implementedFunctions[r];const i=(t=e.aliases)===null||t===void 0?void 0:t[r];if(i!==void 0){if(n!==void 0)throw new F8(r,e.name);n=e.implementedFunctions[i]}if(n===void 0)throw su.functionNotDeclaredInPlugin(r,e.name);return n}class on{constructor(e){if(this.config=e,this.functions=new Map,this.arraySizeFunctions=new Map,this.volatileFunctions=new Set,this.arrayFunctions=new Set,this.structuralChangeFunctions=new Set,this.functionsWhichDoesNotNeedArgumentsToBeComputed=new Set,this.functionsMetadata=new Map,this.doesFunctionNeedArgumentToBeComputed=t=>this.functionsWhichDoesNotNeedArgumentsToBeComputed.has(t),this.isFunctionVolatile=t=>this.volatileFunctions.has(t),this.isArrayFunction=t=>this.arrayFunctions.has(t),this.isFunctionDependentOnSheetStructureChange=t=>this.structuralChangeFunctions.has(t),e.functionPlugins.length>0){this.instancePlugins=new Map;for(const t of e.functionPlugins)on.loadPluginFunctions(t,this.instancePlugins)}else this.instancePlugins=new Map(on.plugins);for(const[t,n]of on.protectedFunctions())on.loadFunctionUnprotected(n,t,this.instancePlugins);for(const[t,n]of this.instancePlugins.entries())this.categorizeFunction(t,Pm(t,n))}static registerFunctionPlugin(e,t){this.loadPluginFunctions(e,this.plugins),t!==void 0&&this.loadTranslations(t)}static registerFunction(e,t,n){this.loadPluginFunction(t,e,this.plugins),n!==void 0&&this.loadTranslations(n)}static unregisterFunction(e){if(this.functionIsProtected(e))throw Wa.cannotUnregisterFunctionWithId(e);this.plugins.delete(e)}static unregisterFunctionPlugin(e){for(const t of this.protectedPlugins())if(t===e)throw Wa.cannotUnregisterProtectedPlugin();for(const[t,n]of this.plugins.entries())n===e&&this.plugins.delete(t)}static unregisterAll(){this.plugins.clear()}static getRegisteredFunctionIds(){return[...Array.from(this.plugins.keys()),...Array.from(this._protectedPlugins.keys())]}static getPlugins(){return Array.from(new Set(this.plugins.values()).values())}static getFunctionPlugin(e){if(!this.functionIsProtected(e))return this.plugins.get(e)}static functionIsProtected(e){return this._protectedPlugins.has(e)}static loadTranslations(e){const t=new Set(yn.getRegisteredLanguagesCodes());Object.keys(e).forEach(n=>{t.has(n)&&yn.getLanguage(n).extendFunctions(e[n])})}static loadPluginFunctions(e,t){Object.keys(e.implementedFunctions).forEach(n=>{this.loadPluginFunction(e,n,t)}),e.aliases!==void 0&&Object.keys(e.aliases).forEach(n=>{this.loadPluginFunction(e,n,t)})}static loadPluginFunction(e,t,n){if(this.functionIsProtected(t))throw Wa.cannotRegisterFunctionWithId(t);this.loadFunctionUnprotected(e,t,n)}static handleDeprecatedMetadata(e,t){t&&t.arrayFunction!==void 0&&(console.warn(`${e}: 'arrayFunction' parameter is deprecated since 3.1.0; Use 'enableArrayArithmeticForArguments' instead.`),t.enableArrayArithmeticForArguments=t.arrayFunction),t&&t.arraySizeMethod!==void 0&&(console.warn(`${e}: 'arraySizeMethod' parameter is deprecated since 3.1.0; Use 'sizeOfResultArrayMethod' instead.`),t.sizeOfResultArrayMethod=t.arraySizeMethod)}static loadFunctionUnprotected(e,t,n){const i=Pm(t,e),s=i.method;if(this.handleDeprecatedMetadata(t,i),Object.prototype.hasOwnProperty.call(e.prototype,s))n.set(t,e);else throw su.functionMethodNotFound(s,e.name)}static*protectedFunctions(){for(const[e,t]of this._protectedPlugins)t!==void 0&&(yield[e,t])}static*protectedPlugins(){for(const[,e]of this._protectedPlugins)e!==void 0&&(yield e)}initializePlugins(e){const t=[];for(const[n,i]of this.instancePlugins.entries()){let s=t.find(u=>u instanceof i);s===void 0&&(s=new i(e),t.push(s));const o=Pm(n,i),a=o.method;this.functions.set(n,[a,s]);const l=o.sizeOfResultArrayMethod;l!==void 0&&this.arraySizeFunctions.set(n,[l,s])}}getFunctionPlugin(e){if(!on.functionIsProtected(e))return this.instancePlugins.get(e)}getFunction(e){const t=this.functions.get(e);if(t!==void 0&&this.config.translationPackage.isFunctionTranslated(e)){const[n,i]=t;return(s,o)=>i[n](s,o)}else return}getArraySizeFunction(e){const t=this.arraySizeFunctions.get(e);if(t!==void 0&&this.config.translationPackage.isFunctionTranslated(e)){const[n,i]=t;return(s,o)=>i[n](s,o)}else return}getMetadata(e){return this.functionsMetadata.get(e)}getPlugins(){const e=new Set;for(const[t,n]of this.instancePlugins)on.functionIsProtected(t)||e.add(n);return Array.from(e)}getRegisteredFunctionIds(){return Array.from(this.functions.keys())}categorizeFunction(e,t){t.isVolatile&&this.volatileFunctions.add(e),t.enableArrayArithmeticForArguments&&this.arrayFunctions.add(e),t.doesNotNeedArgumentsToBeComputed&&this.functionsWhichDoesNotNeedArgumentsToBeComputed.add(e),t.isDependentOnSheetStructureChange&&this.structuralChangeFunctions.add(e),this.functionsMetadata.set(e,t)}}on.plugins=new Map;on._protectedPlugins=new Map([["VERSION",WS],["OFFSET",void 0]]);var pn;(function(r){r.GREATER_THAN="GREATER_THAN",r.GREATER_THAN_OR_EQUAL="GREATER_THAN_OR_EQUAL",r.LESS_THAN="LESS_THAN",r.LESS_THAN_OR_EQUAL="LESS_THAN_OR_EQUAL",r.NOT_EQUAL="NOT_EQUAL",r.EQUAL="EQUAL"})(pn||(pn={}));const Fh=(r,e)=>({operator:r,value:e});class SI{constructor(e){var t,n,i,s;this.trueString=(n=(t=e.translationPackage.getMaybeFunctionTranslation("TRUE"))===null||t===void 0?void 0:t.toLowerCase())!==null&&n!==void 0?n:"true",this.falseString=(s=(i=e.translationPackage.getMaybeFunctionTranslation("FALSE"))===null||i===void 0?void 0:i.toLowerCase())!==null&&s!==void 0?s:"false"}fromCellValue(e,t){if(typeof e!="string"&&typeof e!="boolean"&&typeof e!="number")return;const n=this.parseCriterion(e,t);if(n!==void 0)return{raw:e,lambda:AI(n,t)}}parseCriterion(e,t){if(typeof e=="number"||typeof e=="boolean")return Fh(pn.EQUAL,e);if(typeof e=="string"){const n=TI.exec(e);let i,s;n?(s=RI(n[1]),i=n[2]):(s=pn.EQUAL,i=e);const o=t.coerceToMaybeNumber(i),a=i.toLowerCase()===this.trueString?!0:i.toLowerCase()===this.falseString?!1:void 0;if(s===void 0)return;if(i==="")return Fh(s,null);if(o===void 0){if(s===pn.EQUAL||s===pn.NOT_EQUAL)return Fh(s,a??i)}else return Fh(s,He(o))}}}const TI=/([<>=]+)(.*)/;function RI(r){switch(r){case">":return pn.GREATER_THAN;case">=":return pn.GREATER_THAN_OR_EQUAL;case"<":return pn.LESS_THAN;case"<=":return pn.LESS_THAN_OR_EQUAL;case"<>":return pn.NOT_EQUAL;case"=":return pn.EQUAL;default:return}}const AI=(r,e)=>{switch(r.operator){case pn.GREATER_THAN:return typeof r.value=="number"?t=>typeof t=="number"&&e.floatCmp(t,r.value)>0:t=>!1;case pn.GREATER_THAN_OR_EQUAL:return typeof r.value=="number"?t=>typeof t=="number"&&e.floatCmp(t,r.value)>=0:t=>!1;case pn.LESS_THAN:return typeof r.value=="number"?t=>typeof t=="number"&&e.floatCmp(t,r.value)<0:t=>!1;case pn.LESS_THAN_OR_EQUAL:return typeof r.value=="number"?t=>typeof t=="number"&&e.floatCmp(t,r.value)<=0:t=>!1;case pn.EQUAL:return typeof r.value=="number"?t=>{if(typeof t=="number")return e.floatCmp(t,r.value)===0;if(typeof t=="string"){if(t==="")return!1;const n=e.coerceToMaybeNumber(t);return n===void 0?!1:e.floatCmp(n,r.value)===0}else return!1}:typeof r.value=="string"?e.eqMatcherFunction(r.value):typeof r.value=="boolean"?t=>typeof t=="boolean"&&t===r.value:t=>t===It;case pn.NOT_EQUAL:return typeof r.value=="number"?t=>{if(typeof t=="number")return e.floatCmp(t,r.value)!==0;if(typeof t=="string"){if(t==="")return!0;const n=e.coerceToMaybeNumber(t);return n===void 0?!0:e.floatCmp(n,r.value)!==0}else return!0}:typeof r.value=="string"?e.neqMatcherFunction(r.value):typeof r.value=="boolean"?t=>typeof t!="boolean"||t!==r.value:t=>t!==It}};class CI{constructor(e,t,n,i,s,o,a,l,u,c){this.config=e,this.dependencyGraph=t,this.columnSearch=n,this.stats=i,this.arithmeticHelper=s,this.functionRegistry=o,this.namedExpressions=a,this.serialization=l,this.arraySizePredictor=u,this.dateTimeHelper=c,this.equalOp=(d,h)=>Oi(this.arithmeticHelper.eq,d,h),this.notEqualOp=(d,h)=>Oi(this.arithmeticHelper.neq,d,h),this.greaterThanOp=(d,h)=>Oi(this.arithmeticHelper.gt,d,h),this.lessThanOp=(d,h)=>Oi(this.arithmeticHelper.lt,d,h),this.greaterThanOrEqualOp=(d,h)=>Oi(this.arithmeticHelper.geq,d,h),this.lessThanOrEqualOp=(d,h)=>Oi(this.arithmeticHelper.leq,d,h),this.concatOp=(d,h)=>Oi(this.arithmeticHelper.concat,$g(d),$g(h)),this.plusOp=(d,h)=>Oi(this.arithmeticHelper.addWithEpsilon,this.arithmeticHelper.coerceScalarToNumberOrError(d),this.arithmeticHelper.coerceScalarToNumberOrError(h)),this.minusOp=(d,h)=>Oi(this.arithmeticHelper.subtract,this.arithmeticHelper.coerceScalarToNumberOrError(d),this.arithmeticHelper.coerceScalarToNumberOrError(h)),this.timesOp=(d,h)=>Oi(this.arithmeticHelper.multiply,this.arithmeticHelper.coerceScalarToNumberOrError(d),this.arithmeticHelper.coerceScalarToNumberOrError(h)),this.powerOp=(d,h)=>Oi(this.arithmeticHelper.pow,this.arithmeticHelper.coerceScalarToNumberOrError(d),this.arithmeticHelper.coerceScalarToNumberOrError(h)),this.divOp=(d,h)=>Oi(this.arithmeticHelper.divide,this.arithmeticHelper.coerceScalarToNumberOrError(d),this.arithmeticHelper.coerceScalarToNumberOrError(h)),this.unaryMinusOp=d=>X1(this.arithmeticHelper.unaryMinus,this.arithmeticHelper.coerceScalarToNumberOrError(d)),this.percentOp=d=>X1(this.arithmeticHelper.unaryPercent,this.arithmeticHelper.coerceScalarToNumberOrError(d)),this.unaryPlusOp=d=>this.arithmeticHelper.unaryPlus(d),this.functionRegistry.initializePlugins(this),this.criterionBuilder=new SI(e)}evaluateAst(e,t){let n=this.evaluateAstWithoutPostprocessing(e,t);if(Qt(n)){if(MS(He(n)))return new J(te.NUM,ue.NaN);n=Dy(n,OS(He(n)))}return n instanceof Ge&&n.height()===1&&n.width()===1&&([[n]]=n.data),NI(n,t.formulaVertex)}evaluateAstWithoutPostprocessing(e,t){switch(e.type){case oe.EMPTY:return It;case oe.CELL_REFERENCE:{const n=e.reference.toSimpleCellAddress(t.formulaAddress);return ii(n)?new J(te.REF,ue.BadRef):this.isSheetValid(e.reference)?this.dependencyGraph.getCellValue(n):new J(te.REF,ue.SheetRef)}case oe.NUMBER:case oe.STRING:return e.value;case oe.CONCATENATE_OP:{const n=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.concatOp,n,i,t)}case oe.EQUALS_OP:{const n=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.equalOp,n,i,t)}case oe.NOT_EQUAL_OP:{const n=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.notEqualOp,n,i,t)}case oe.GREATER_THAN_OP:{const n=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.greaterThanOp,n,i,t)}case oe.LESS_THAN_OP:{const n=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.lessThanOp,n,i,t)}case oe.GREATER_THAN_OR_EQUAL_OP:{const n=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.greaterThanOrEqualOp,n,i,t)}case oe.LESS_THAN_OR_EQUAL_OP:{const n=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.lessThanOrEqualOp,n,i,t)}case oe.PLUS_OP:{const n=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.plusOp,n,i,t)}case oe.MINUS_OP:{const n=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.minusOp,n,i,t)}case oe.TIMES_OP:{const n=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.timesOp,n,i,t)}case oe.POWER_OP:{const n=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.powerOp,n,i,t)}case oe.DIV_OP:{const n=this.evaluateAst(e.left,t),i=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.divOp,n,i,t)}case oe.PLUS_UNARY_OP:{const n=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.unaryPlusOp,n,t)}case oe.MINUS_UNARY_OP:{const n=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.unaryMinusOp,n,t)}case oe.PERCENT_OP:{const n=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.percentOp,n,t)}case oe.FUNCTION_CALL:{if(this.config.licenseKeyValidityState!=="valid"&&!on.functionIsProtected(e.procedureName))return new J(te.LIC,ue.LicenseKey(this.config.licenseKeyValidityState));const n=this.functionRegistry.getFunction(e.procedureName);return n!==void 0?n(e,new Ls(t.formulaAddress,t.arraysFlag||this.functionRegistry.isArrayFunction(e.procedureName),t.formulaVertex)):new J(te.NAME,ue.FunctionName(e.procedureName))}case oe.NAMED_EXPRESSION:{const n=this.namedExpressions.nearestNamedExpression(e.expressionName,t.formulaAddress.sheet);return n?this.dependencyGraph.getCellValue(n.address):new J(te.NAME,ue.NamedExpressionName(e.expressionName))}case oe.CELL_RANGE:{if(!this.isSheetValid(e.start)||!this.isSheetValid(e.end))return new J(te.REF,ue.SheetRef);if(!this.rangeSpansOneSheet(e))return new J(te.REF,ue.RangeManySheets);const n=it.fromCellRange(e,t.formulaAddress),i=this.dependencyGraph.getArray(n);if(i){const s=i.array;if(s instanceof Uu)throw new Error("Array should be already computed");if(s instanceof J)return s;if(s instanceof ou)return Ge.fromRange(s.raw(),n,this.dependencyGraph);throw new Error("Unknown array")}return Ge.onlyRange(n,this.dependencyGraph)}case oe.COLUMN_RANGE:{if(!this.isSheetValid(e.start)||!this.isSheetValid(e.end))return new J(te.REF,ue.SheetRef);if(!this.rangeSpansOneSheet(e))return new J(te.REF,ue.RangeManySheets);const n=bo.fromColumnRange(e,t.formulaAddress);return Ge.onlyRange(n,this.dependencyGraph)}case oe.ROW_RANGE:{if(!this.isSheetValid(e.start)||!this.isSheetValid(e.end))return new J(te.REF,ue.SheetRef);if(!this.rangeSpansOneSheet(e))return new J(te.REF,ue.RangeManySheets);const n=wo.fromRowRangeAst(e,t.formulaAddress);return Ge.onlyRange(n,this.dependencyGraph)}case oe.PARENTHESIS:return this.evaluateAst(e.expression,t);case oe.ARRAY:{let n;const i=[];for(const s of e.args){let o;const a=[];for(const u of s){const c=CS(this.evaluateAst(u,t)),d=c.height();if(o===void 0)o=d,a.push(...c.data);else if(o===d)for(let h=0;h<d;h++)a[h].push(...c.data[h]);else return new J(te.REF,ue.SizeMismatch)}const l=a[0].length;if(n===void 0)n=l,i.push(...a);else if(n===l)i.push(...a);else return new J(te.REF,ue.SizeMismatch)}return Ge.onlyValues(i)}case oe.ERROR_WITH_RAW_INPUT:case oe.ERROR:return e.error}}isSheetValid(e){return e.sheet===void 0||e.sheet===Ro.SHEET_FOR_WORKBOOK_EXPRESSIONS||this.dependencyGraph.sheetMapping.hasSheetWithId(e.sheet,{includePlaceholders:!1})}rangeSpansOneSheet(e){return e.start.sheet===e.end.sheet}unaryRangeWrapper(e,t,n){var i;if(t instanceof Ge&&!n.arraysFlag&&(t=(i=wd(t,n))!==null&&i!==void 0?i:new J(te.VALUE,ue.ScalarExpected)),t instanceof J)return t;if(t instanceof Ge){const s=t.data.map(o=>o.map(e));return Ge.onlyValues(s)}return e(t)}binaryRangeWrapper(e,t,n,i){var s,o;if(t instanceof Ge&&!i.arraysFlag&&(t=(s=wd(t,i))!==null&&s!==void 0?s:new J(te.VALUE,ue.ScalarExpected)),t instanceof J)return t;if(n instanceof Ge&&!i.arraysFlag&&(n=(o=wd(n,i))!==null&&o!==void 0?o:new J(te.VALUE,ue.ScalarExpected)),n instanceof J)return n;if(t instanceof Ge||n instanceof Ge){if(!(t instanceof Ge))if(n.isAdHoc()){const c=n.data;for(let d=0;d<c.length;d++)for(let h=0;h<c[0].length;h++)c[d][h]=e(t,c[d][h]);return Ge.onlyValues(c)}else t=Ge.fromScalar(t);if(!(n instanceof Ge))if(t.isAdHoc()){const c=t.data;for(let d=0;d<c.length;d++)for(let h=0;h<c[0].length;h++)c[d][h]=e(c[d][h],n);return Ge.onlyValues(c)}else n=Ge.fromScalar(n);if(t.width()===n.width()&&t.height()===n.height()){if(t.isAdHoc()){const c=t.data,d=n.data;for(let h=0;h<c.length;h++)for(let f=0;f<c[0].length;f++)c[h][f]=e(c[h][f],d[h][f]);return Ge.onlyValues(c)}if(n.isAdHoc()){const c=t.data,d=n.data;for(let h=0;h<c.length;h++)for(let f=0;f<c[0].length;f++)d[h][f]=e(c[h][f],d[h][f]);return Ge.onlyValues(d)}}const a=Math.max(t.width(),n.width()),l=Math.max(t.height(),n.height()),u=Array(l);for(let c=0;c<l;c++)u[c]=Array(a);for(let c=0;c<l;c++){const d=t.height()!==1?c:0,h=n.height()!==1?c:0;for(let f=0;f<a;f++){const m=t.width()!==1?f:0,p=n.width()!==1?f:0;d<t.height()&&h<n.height()&&m<t.width()&&p<n.width()?u[c][f]=e(t.data[d][m],n.data[h][p]):u[c][f]=new J(te.NA)}}return Ge.onlyValues(u)}return e(t,n)}}function X1(r,e){return e instanceof J?e:r(e)}function Oi(r,e,t){return e instanceof J?e:t instanceof J?t:r(e,t)}function NI(r,e){return r instanceof J&&e!==void 0?r.attachRootVertex(e):r}class MI{constructor(e){this.sheet=e,this.transformations=[]}add(e){this.transformations.push(e)}performEagerTransformations(e,t){this.transformations.forEach(n=>n.performEagerTransformations(e,t))}transformSingleAst(e,t){let[n,i]=[e,t];return this.transformations.forEach(s=>{[n,i]=s.transformSingleAst(n,i)}),[n,i]}isIrreversible(){return!0}}class OI{constructor(e){this.stats=e,this.transformations=[]}version(){return this.transformations.length}addTransformation(e){return this.combinedTransformer!==void 0?this.combinedTransformer.add(e):this.transformations.push(e),this.version()}beginCombinedMode(e){this.combinedTransformer=new MI(e)}commitCombinedMode(){if(this.combinedTransformer===void 0)throw Error("Combined mode wasn't started");return this.transformations.push(this.combinedTransformer),this.combinedTransformer=void 0,this.version()}applyTransformations(e,t,n){this.stats.start(wt.TRANSFORM_ASTS_POSTPONED);for(let s=n;s<this.transformations.length;s++){const o=this.transformations[s];o.isIrreversible()&&(this.undoRedo.storeDataForVersion(s,t,this.parser.computeHashFromAst(e)),this.parser.rememberNewAst(e));const[a,l]=o.transformSingleAst(e,t);e=a,t=l}const i=this.parser.rememberNewAst(e);return this.stats.end(wt.TRANSFORM_ASTS_POSTPONED),[i,t,this.transformations.length]}*getTransformationsFrom(e,t){for(let n=e;n<this.transformations.length;n++){const i=this.transformations[n];(!t||t(i))&&(yield i)}}}const xs=-1;function II(r,e,{searchCoordinate:t,orderingDirection:n,ifNoMatch:i},s){const o=e.start[t],a=t==="col"?e.effectiveEndColumn(s):e.effectiveEndRow(s),l=t==="col"?h=>He(s.getCellValue($e(e.sheet,h,e.start.row))):h=>He(s.getCellValue($e(e.sheet,e.start.col,h))),u=n==="asc"?(h,f)=>Af(h,f):(h,f)=>-Af(h,f),c=kI(h=>u(r,l(h))>=0,o,a),d=l(c);if(d===r)return c-o;if(i==="returnLowerBound"){if(c===xs)return n==="asc"?xs:0;if(typeof d!=typeof r)return xs;if(n==="asc")return c-o;const h=c+1;return h<=a?h-o:xs}if(i==="returnUpperBound"){if(c===xs)return n==="asc"?0:xs;if(typeof d!=typeof r)return xs;if(n==="desc")return c-o;const h=c+1;return h<=a?h-o:xs}return xs}function kI(r,e,t){let n=e,i=t;for(;n<i;){const s=Math.ceil((n+i)/2);r(s)?n=s:i=s-1}return n===i&&r(n)?n:xs}function Af(r,e){return typeof r==typeof e?r===It?0:r<e?-1:r>e?1:0:r===It?-1:e===It?1:e instanceof J||typeof r=="number"&&typeof e=="string"||typeof r=="number"&&typeof e=="boolean"?-1:typeof r=="string"&&typeof e=="number"?1:typeof r=="string"&&typeof e=="boolean"?-1:1}const K1=-1;class GS{constructor(e){this.dependencyGraph=e}advancedFind(e,t,{returnOccurrence:n}={returnOccurrence:"first"}){const i=t.range,s=i===void 0?t.valuesFromTopLeftCorner():this.dependencyGraph.computeListOfValuesInRange(i),o=n==="first"?0:s.length-1,a=n==="first"?u=>u<s.length:u=>u>=0,l=n==="first"?u=>u+1:u=>u-1;for(let u=o;a(u);u=l(u))if(e(He(s[u])))return u;return K1}basicFind(e,t,n,{ordering:i,ifNoMatch:s,returnOccurrence:o}){const a=typeof e=="string"?lc(e):e,l=t.range;return l===void 0?this.findNormalizedValue(a,t.valuesFromTopLeftCorner(),s,o):i==="none"?this.findNormalizedValue(a,this.dependencyGraph.computeListOfValuesInRange(l),s,o):II(a,l,{searchCoordinate:n,orderingDirection:i,ifNoMatch:s},this.dependencyGraph)}findNormalizedValue(e,t,n="returnNotFound",i="first"){const s=t.map(He).map(h=>typeof h=="string"?lc(h):h);if(n==="returnNotFound")return i==="first"?s.indexOf(e):s.lastIndexOf(e);const o=n==="returnLowerBound"?(h,f)=>Af(h,f):(h,f)=>-Af(h,f);let a=n==="returnLowerBound"?-1/0:1/0,l=K1;const u=i==="first"?0:s.length-1,c=i==="first"?h=>h<s.length:h=>h>=0,d=i==="first"?h=>h+1:h=>h-1;for(let h=u;c(h);h=d(h)){const f=s[h];if(f===e)return h;o(f,e)>0||o(a,f)<0&&(a=f,l=h)}return l}}class qS extends GS{constructor(e){super(e),this.dependencyGraph=e}add(e,t){}remove(e,t){}change(e,t,n){}applyChanges(e){}addColumns(e){}removeColumns(e){}removeSheet(e){}moveValues(e,t,n,i){}removeValues(e){}find(e,t,n){return this.basicFind(e,t,"row",n)}}class Ba{constructor(e,t,n){this.dependencyGraph=e,this.config=t,this.stats=n,this.index=new Map,this.transformingService=this.dependencyGraph.lazilyTransformingAstService,this.binarySearchStrategy=new qS(e)}add(e,t){if(!(e===It||e instanceof J))if(e instanceof Ge)for(const[n,i]of e.entriesFromTopLeftCorner(t))this.addSingleCellValue(He(n),i);else this.addSingleCellValue(e,t)}remove(e,t){if(e!==void 0)if(e instanceof Ge)for(const[n,i]of e.entriesFromTopLeftCorner(t))this.removeSingleValue(He(n),i);else this.removeSingleValue(e,t)}change(e,t,n){e!==t&&(this.remove(e,n),this.add(t,n))}applyChanges(e){for(const t of e)t.oldValue!==void 0&&this.change(He(t.oldValue),He(t.value),t.address)}moveValues(e,t,n,i){for(const[s,o]of e){const a=Q8(o,i,t,n);this.remove(s,o),this.add(s,a)}}removeValues(e){for(const[t,n]of e)this.remove(t,n)}find(e,t,{ordering:n,ifNoMatch:i,returnOccurrence:s}){s==null&&(s=n==="none"?"first":"last");const o=this.findUsingColumnIndex(e,t,s);return o!==void 0?o:this.binarySearchStrategy.find(e,t,{ordering:n,ifNoMatch:i,returnOccurrence:s})}findUsingColumnIndex(e,t,n){const i=t.range;if(i===void 0)return;this.ensureRecentData(i.sheet,i.start.col,e);const s=this.getColumnMap(i.sheet,i.start.col);if(!s)return-1;const o=typeof e=="string"?lc(e):e,a=s.get(o);if(!a||!a.index||a.index.length===0)return;const l=Ba.findRowBelongingToRange(a,i,n);return l!==void 0?l-i.start.row:void 0}static findRowBelongingToRange(e,t,n){const i=t.start.row,s=t.end.row,o=n==="first"?Na(i,e.index,"upperBound"):Na(s,e.index,"lowerBound");if(o===-1)return;const a=e.index[o];return a>=i&&a<=s?a:void 0}advancedFind(e,t,n={returnOccurrence:"first"}){return this.binarySearchStrategy.advancedFind(e,t,n)}addColumns(e){const t=this.index.get(e.sheet);t&&t.splice(e.columnStart,0,...Array(e.numberOfColumns))}removeColumns(e){const t=this.index.get(e.sheet);t&&t.splice(e.columnStart,e.numberOfColumns)}removeSheet(e){this.index.delete(e)}getColumnMap(e,t){this.index.has(e)||this.index.set(e,[]);const n=this.index.get(e);let i=n[t];return i||(i=new Map,n[t]=i),i}getValueIndex(e,t,n){const i=this.getColumnMap(e,t);let s=this.getColumnMap(e,t).get(n);return s||(s={version:this.transformingService.version(),index:[]},i.set(n,s)),s}ensureRecentData(e,t,n){const i=this.getValueIndex(e,t,n),s=this.transformingService.version();if(i.version===s)return;const o=this.transformingService.getTransformationsFrom(i.version,a=>a.sheet===e&&(a instanceof qg||a instanceof Yg));for(const a of o)a instanceof qg?this.addRows(t,a.rowsSpan,n):a instanceof Yg&&this.removeRows(t,a.rowsSpan,n);i.version=s}addSingleCellValue(e,t){this.stats.measure(wt.BUILD_COLUMN_INDEX,()=>{this.ensureRecentData(t.sheet,t.col,e),typeof e=="string"&&(e=lc(e));const n=this.getValueIndex(t.sheet,t.col,e);Ba.addValue(n,t.row)})}removeSingleValue(e,t){this.stats.measure(wt.BUILD_COLUMN_INDEX,()=>{this.ensureRecentData(t.sheet,t.col,e);const n=this.getColumnMap(t.sheet,t.col);typeof e=="string"&&(e=lc(e));const i=n.get(e);if(!i)return;const s=Na(t.row,i.index);s>-1&&i.index.splice(s,1),i.index.length===0&&n.delete(e),n.size===0&&delete this.index.get(t.sheet)[t.col]})}addRows(e,t,n){const i=this.getValueIndex(t.sheet,e,n);Ba.shiftRows(i,t.rowStart,t.numberOfRows)}removeRows(e,t,n){const i=this.getValueIndex(t.sheet,e,n);Ba.removeRowsFromValues(i,t),Ba.shiftRows(i,t.rowEnd+1,-t.numberOfRows)}static addValue(e,t){const n=Na(t,e.index,"lowerBound");e.index[n]===t||e.index.splice(n+1,0,t)}static removeRowsFromValues(e,t){const n=Na(t.rowStart,e.index,"upperBound"),i=Na(t.rowEnd,e.index,"lowerBound");n>-1&&i>-1&&n<=i&&e.index[n]<=t.rowEnd&&e.index.splice(n,i-n+1)}static shiftRows(e,t,n){const i=Na(t,e.index,"upperBound");if(i!==-1)for(let s=i;s<e.index.length;++s)e.index[s]+=n}}function Na(r,e,t="upperBound"){let n=0,i=e.length-1;for(;n<=i;){const a=Math.floor((n+i)/2);if(r>e[a])n=a+1;else if(r<e[a])i=a-1;else return a}const s=t==="lowerBound"?i:n;return s>=0&&s<=e.length?s:-1}function PI(r,e,t){return e.useColumnIndex?new Ba(r,e,t):new qS(r)}class FI{constructor(e){this.config=e;const t=this.config.thousandSeparator==="."?`\\${this.config.thousandSeparator}`:this.config.thousandSeparator,n=this.config.decimalSeparator==="."?`\\${this.config.decimalSeparator}`:this.config.decimalSeparator;this.numberPattern=new RegExp(`^([+-]?((${n}\\d+)|(\\d+(${t}\\d{3,})*(${n}\\d*)?)))(e[+-]?\\d+)?$`),this.allThousandSeparatorsRegex=new RegExp(`${t}`,"g")}numericStringToMaybeNumber(e){if(this.numberPattern.test(e)){const t=this.numericStringToNumber(e);return isNaN(t)?void 0:t}}numericStringToNumber(e){const t=e.replace(this.allThousandSeparatorsRegex,"").replace(this.config.decimalSeparator,".");return Number(t)}}class Hy{constructor(e,t,n){this.dependencyGraph=e,this.unparser=t,this.exporter=n}getCellHyperlink(e){const t=this.dependencyGraph.getCell(e);if(t instanceof Ms){const n=t.getFormula(this.dependencyGraph.lazilyTransformingAstService);if(n.procedureName==="HYPERLINK")return n.hyperlink}}getCellFormula(e,t){const n=this.dependencyGraph.getCell(e);if(n instanceof Ms){const i=n.getFormula(this.dependencyGraph.lazilyTransformingAstService);return t=t??e,this.unparser.unparse(i,t)}else if(n instanceof Wr){const i=n.getAddress(this.dependencyGraph.lazilyTransformingAstService);if(i.row!==e.row||i.col!==e.col||i.sheet!==e.sheet)return;t=t??e;const s=n.getFormula(this.dependencyGraph.lazilyTransformingAstService);if(s!==void 0)return this.unparser.unparse(s,t)}else if(n instanceof Yl)return n.getFormula()}getCellSerialized(e,t){var n;return(n=this.getCellFormula(e,t))!==null&&n!==void 0?n:this.getRawValue(e)}getCellValue(e){return this.exporter.exportValue(this.dependencyGraph.getScalarValue(e))}getRawValue(e){return this.dependencyGraph.getRawValue(e)}getSheetValues(e){return this.genericSheetGetter(e,t=>this.getCellValue(t))}getSheetFormulas(e){return this.genericSheetGetter(e,t=>this.getCellFormula(t))}genericSheetGetter(e,t){const n=this.dependencyGraph.getSheetHeight(e),i=this.dependencyGraph.getSheetWidth(e),s=new Array(n);for(let o=0;o<n;o++){s[o]=new Array(i);for(let a=0;a<i;a++){const l=$e(e,a,o);s[o][a]=t(l)}for(let a=i-1;a>=0&&(s[o][a]===null||s[o][a]===void 0);a--)s[o].pop()}for(let o=n-1;o>=0&&s[o].length===0;o--)s.pop();return s}genericAllSheetsGetter(e){const t={};for(const n of this.dependencyGraph.sheetMapping.iterateSheetNames()){const i=this.dependencyGraph.sheetMapping.getSheetIdOrThrowError(n);t[n]=e(i)}return t}getSheetSerialized(e){return this.genericSheetGetter(e,t=>this.getCellSerialized(t))}getAllSheetsValues(){return this.genericAllSheetsGetter(e=>this.getSheetValues(e))}getAllSheetsFormulas(){return this.genericAllSheetsGetter(e=>this.getSheetFormulas(e))}getAllSheetsSerialized(){return this.genericAllSheetsGetter(e=>this.getSheetSerialized(e))}getAllNamedExpressionsSerialized(){const e=[];let t=0;for(const n of this.dependencyGraph.sheetMapping.iterateSheetNames()){const i=this.dependencyGraph.sheetMapping.getSheetIdOrThrowError(n);e[i]=t,t++}return this.dependencyGraph.namedExpressions.getAllNamedExpressions().map(n=>({name:n.expression.displayName,expression:this.getCellSerialized(n.expression.address),scope:n.scope!==void 0?e[n.scope]:void 0,options:n.expression.options}))}withNewConfig(e,t){const n=new aS(e,this.dependencyGraph.sheetMapping,t);return new Hy(this.dependencyGraph,n,this.exporter)}}class Lh{static buildFromSheets(e,t={},n=[]){const i=new Si(t);return this.buildEngine(i,e,n)}static buildFromSheet(e,t={},n=[]){const i=new Si(t),s=i.translationPackage.getUITranslation(Mc.NEW_SHEET_PREFIX)+"1";return this.buildEngine(i,{[s]:e},n)}static buildEmpty(e={},t=[]){return this.buildEngine(new Si(e),{},t)}static rebuildWithConfig(e,t,n,i){return this.buildEngine(e,t,n,i)}static buildEngine(e,t={},n=[],i=e.useStats?new cS:new I8){i.start(wt.BUILD_ENGINE_TOTAL);const s=new Ro,o=new on(e),a=new OI(i),l=$y.buildEmpty(a,e,o,s,i),u=PI(l,e,i),c=l.sheetMapping,d=l.addressMapping;for(const $ in t)if(Object.prototype.hasOwnProperty.call(t,$)){const V=t[$];TS(V);const R=bf(V);if(R.height>e.maxRows||R.width>e.maxColumns)throw new Ha;const O=c.addSheet($);d.addSheetAndSetStrategyBasedOnBoundaries(O,R,{throwIfSheetAlreadyExists:!0})}const h=new oc(e,o,l.sheetReferenceRegistrar.ensureSheetRegistered.bind(l.sheetReferenceRegistrar));a.parser=h;const f=new aS(e,c,s),m=new _O(e),p=new FI(e),g=new nO(e,m,p),v=new $O(e,m,p),y=new cO(e,o),b=new KO(e,l,u,v,h,i,a,s,y),E=new vI(e,b);a.undoRedo=E;const A=new zO(e,l,b),M=new bI(e,b,E,A,l,u,h,v,a,s),L=new _I(e,s,c,a),k=new Hy(l,f,L),P=new CI(e,l,u,i,g,o,s,k,y,m);i.measure(wt.GRAPH_BUILD,()=>{new xI(l,u,h,v,i,y).buildGraph(t,i)}),n.forEach($=>{M.ensureItIsPossibleToAddNamedExpression($.name,$.expression,$.scope),M.operations.addNamedExpression($.name,$.expression,$.scope,$.options)});const U=new wI(e,i,P,a,l,u);return U.run(),i.end(wt.BUILD_ENGINE_TOTAL),{config:e,stats:i,dependencyGraph:l,columnSearch:u,parser:h,unparser:f,cellContentParser:v,evaluator:U,lazilyTransformingAstService:a,crudOperations:M,exporter:L,namedExpressions:s,serialization:k,functionRegistry:o}}}function LI(r){for(const[e,t]of Object.entries(r))t instanceof Function?r[e]=DI(t):delete r[e]}function DI(r){return()=>{throw new Error(`The "${r}" method cannot be called because this HyperFormula instance has been destroyed`)}}var Dh={exports:{}},Z1;function BI(){if(Z1)return Dh.exports;Z1=1;function r(){}return r.prototype={on:function(e,t,n){var i=this.e||(this.e={});return(i[e]||(i[e]=[])).push({fn:t,ctx:n}),this},once:function(e,t,n){var i=this;function s(){i.off(e,s),t.apply(n,arguments)}return s._=t,this.on(e,s,n)},emit:function(e){var t=[].slice.call(arguments,1),n=((this.e||(this.e={}))[e]||[]).slice(),i=0,s=n.length;for(i;i<s;i++)n[i].fn.apply(n[i].ctx,t);return this},off:function(e,t){var n=this.e||(this.e={}),i=n[e],s=[];if(i&&t)for(var o=0,a=i.length;o<a;o++)i[o].fn!==t&&i[o].fn._!==t&&s.push(i[o]);return s.length?n[e]=s:delete n[e],this}},Dh.exports=r,Dh.exports.TinyEmitter=r,Dh.exports}var UI=BI();var Ss;(function(r){r.SheetAdded="sheetAdded",r.SheetRemoved="sheetRemoved",r.SheetRenamed="sheetRenamed",r.NamedExpressionAdded="namedExpressionAdded",r.NamedExpressionRemoved="namedExpressionRemoved",r.ValuesUpdated="valuesUpdated",r.EvaluationSuspended="evaluationSuspended",r.EvaluationResumed="evaluationResumed"})(Ss||(Ss={}));class VI extends UI.TinyEmitter{emit(e,...t){return super.emit(e,...t),this}}class yn{constructor(e,t,n,i,s,o,a,l,u,c,d,h,f,m){this._config=e,this._stats=t,this._dependencyGraph=n,this._columnSearch=i,this._parser=s,this._unparser=o,this._cellContentParser=a,this._evaluator=l,this._lazilyTransformingAstService=u,this._crudOperations=c,this._exporter=d,this._namedExpressions=h,this._serialization=f,this._functionRegistry=m,this._emitter=new VI,this._evaluationSuspended=!1}static get defaultConfig(){return jI()}get graph(){return this.dependencyGraph.graph}get rangeMapping(){return this.dependencyGraph.rangeMapping}get arrayMapping(){return this.dependencyGraph.arrayMapping}get sheetMapping(){return this.dependencyGraph.sheetMapping}get addressMapping(){return this.dependencyGraph.addressMapping}get dependencyGraph(){return this._dependencyGraph}get evaluator(){return this._evaluator}get columnSearch(){return this._columnSearch}get lazilyTransformingAstService(){return this._lazilyTransformingAstService}get licenseKeyValidityState(){return this._config.licenseKeyValidityState}static buildFromArray(e,t={},n=[]){return this.buildFromEngineState(Lh.buildFromSheet(e,t,n))}static buildFromSheets(e,t={},n=[]){return this.buildFromEngineState(Lh.buildFromSheets(e,t,n))}static buildEmpty(e={},t=[]){return this.buildFromEngineState(Lh.buildEmpty(e,t))}static getLanguage(e){Fe(e,"string","languageCode");const t=this.registeredLanguages.get(e);if(t===void 0)throw new Dg;return t}static registerLanguage(e,t){if(Fe(e,"string","languageCode"),this.registeredLanguages.has(e))throw new SS;this.registeredLanguages.set(e,z8(t))}static unregisterLanguage(e){if(Fe(e,"string","languageCode"),this.registeredLanguages.has(e))this.registeredLanguages.delete(e);else throw new Dg}static getRegisteredLanguagesCodes(){return Array.from(this.registeredLanguages.keys())}static registerFunctionPlugin(e,t){on.registerFunctionPlugin(e,t)}static unregisterFunctionPlugin(e){on.unregisterFunctionPlugin(e)}static registerFunction(e,t,n){Fe(e,"string","functionId"),on.registerFunction(e,t,n)}static unregisterFunction(e){Fe(e,"string","functionId"),on.unregisterFunction(e)}static unregisterAllFunctions(){on.unregisterAll()}static getRegisteredFunctionNames(e){Fe(e,"string","code");const t=on.getRegisteredFunctionIds();return this.getLanguage(e).getFunctionTranslations(t)}static getFunctionPlugin(e){return Fe(e,"string","functionId"),on.getFunctionPlugin(e)}static getAllFunctionPlugins(){return on.getPlugins()}static buildFromEngineState(e){return new yn(e.config,e.stats,e.dependencyGraph,e.columnSearch,e.parser,e.unparser,e.cellContentParser,e.evaluator,e.lazilyTransformingAstService,e.crudOperations,e.exporter,e.namedExpressions,e.serialization,e.functionRegistry)}getCellValue(e){if(!kr(e))throw new Zt("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellValue(e)}getCellFormula(e){if(!kr(e))throw new Zt("SimpleCellAddress","cellAddress");return this._serialization.getCellFormula(e)}getCellHyperlink(e){if(!kr(e))throw new Zt("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellHyperlink(e)}getCellSerialized(e){if(!kr(e))throw new Zt("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellSerialized(e)}getSheetValues(e){return Fe(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetValues(e)}getSheetFormulas(e){return Fe(e,"number","sheetId"),this._serialization.getSheetFormulas(e)}getSheetSerialized(e){return Fe(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetSerialized(e)}getAllSheetsDimensions(){return this._serialization.genericAllSheetsGetter(e=>this.getSheetDimensions(e))}getSheetDimensions(e){return Fe(e,"number","sheetId"),{width:this.dependencyGraph.getSheetWidth(e),height:this.dependencyGraph.getSheetHeight(e)}}getAllSheetsValues(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsValues()}getAllSheetsFormulas(){return this._serialization.getAllSheetsFormulas()}getAllSheetsSerialized(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsSerialized()}updateConfig(e){Object.entries(e).every(([n,i])=>this._config[n]===i)||this.rebuildWithConfig(e)}getConfig(){return this._config.getConfig()}rebuildAndRecalculate(){this.rebuildWithConfig({})}getStats(){return this._stats.snapshot()}undo(){return this._crudOperations.undo(),this.recomputeIfDependencyGraphNeedsIt()}redo(){return this._crudOperations.redo(),this.recomputeIfDependencyGraphNeedsIt()}isThereSomethingToUndo(){return this._crudOperations.isThereSomethingToUndo()}isThereSomethingToRedo(){return this._crudOperations.isThereSomethingToRedo()}isItPossibleToSetCellContents(e){let t;if(kr(e))t=new it(e,e);else if(gi(e))t=new it(e.start,e.end);else throw new Zt("SimpleCellAddress | SimpleCellRange","address");try{this._crudOperations.ensureRangeInSizeLimits(t);for(const n of t.addresses(this._dependencyGraph))this._crudOperations.ensureItIsPossibleToChangeContent(n)}catch{return!1}return!0}setCellContents(e,t){return this._crudOperations.setCellContents(e,t),this.recomputeIfDependencyGraphNeedsIt()}swapRowIndexes(e,t){return Fe(e,"number","sheetId"),this._crudOperations.setRowOrder(e,t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToSwapRowIndexes(e,t){Fe(e,"number","sheetId");try{return this._crudOperations.validateSwapRowIndexes(e,t),this._crudOperations.testRowOrderForArrays(e,t),!0}catch{return!1}}setRowOrder(e,t){Fe(e,"number","sheetId");const n=this._crudOperations.mappingFromOrder(e,t,"row");return this.swapRowIndexes(e,n)}isItPossibleToSetRowOrder(e,t){Fe(e,"number","sheetId");try{const n=this._crudOperations.mappingFromOrder(e,t,"row");return this._crudOperations.validateSwapRowIndexes(e,n),this._crudOperations.testRowOrderForArrays(e,n),!0}catch{return!1}}swapColumnIndexes(e,t){return Fe(e,"number","sheetId"),this._crudOperations.setColumnOrder(e,t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToSwapColumnIndexes(e,t){Fe(e,"number","sheetId");try{return this._crudOperations.validateSwapColumnIndexes(e,t),this._crudOperations.testColumnOrderForArrays(e,t),!0}catch{return!1}}setColumnOrder(e,t){Fe(e,"number","sheetId");const n=this._crudOperations.mappingFromOrder(e,t,"column");return this.swapColumnIndexes(e,n)}isItPossibleToSetColumnOrder(e,t){Fe(e,"number","sheetId");try{const n=this._crudOperations.mappingFromOrder(e,t,"column");return this._crudOperations.validateSwapColumnIndexes(e,n),this._crudOperations.testColumnOrderForArrays(e,n),!0}catch{return!1}}isItPossibleToAddRows(e,...t){Fe(e,"number","sheetId");const n=Tf(t);try{return this._crudOperations.ensureItIsPossibleToAddRows(e,...n),!0}catch{return!1}}addRows(e,...t){return Fe(e,"number","sheetId"),this._crudOperations.addRows(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveRows(e,...t){Fe(e,"number","sheetId");const n=Sf(t);try{return this._crudOperations.ensureItIsPossibleToRemoveRows(e,...n),!0}catch{return!1}}removeRows(e,...t){return Fe(e,"number","sheetId"),this._crudOperations.removeRows(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToAddColumns(e,...t){Fe(e,"number","sheetId");const n=Tf(t);try{return this._crudOperations.ensureItIsPossibleToAddColumns(e,...n),!0}catch{return!1}}addColumns(e,...t){return Fe(e,"number","sheetId"),this._crudOperations.addColumns(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveColumns(e,...t){Fe(e,"number","sheetId");const n=Sf(t);try{return this._crudOperations.ensureItIsPossibleToRemoveColumns(e,...n),!0}catch{return!1}}removeColumns(e,...t){return Fe(e,"number","sheetId"),this._crudOperations.removeColumns(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveCells(e,t){if(!kr(t))throw new Zt("SimpleCellAddress","destinationLeftCorner");if(!gi(e))throw new Zt("SimpleCellRange","source");try{const n=new it(e.start,e.end);return this._crudOperations.operations.ensureItIsPossibleToMoveCells(n.start,n.width(),n.height(),t),!0}catch{return!1}}moveCells(e,t){if(!kr(t))throw new Zt("SimpleCellAddress","destinationLeftCorner");if(!gi(e))throw new Zt("SimpleCellRange","source");const n=new it(e.start,e.end);return this._crudOperations.moveCells(n.start,n.width(),n.height(),t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveRows(e,t,n,i){Fe(e,"number","sheetId"),Fe(t,"number","startRow"),Fe(n,"number","numberOfRows"),Fe(i,"number","targetRow");try{return this._crudOperations.ensureItIsPossibleToMoveRows(e,t,n,i),!0}catch{return!1}}moveRows(e,t,n,i){return Fe(e,"number","sheetId"),Fe(t,"number","startRow"),Fe(n,"number","numberOfRows"),Fe(i,"number","targetRow"),this._crudOperations.moveRows(e,t,n,i),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveColumns(e,t,n,i){Fe(e,"number","sheetId"),Fe(t,"number","startColumn"),Fe(n,"number","numberOfColumns"),Fe(i,"number","targetColumn");try{return this._crudOperations.ensureItIsPossibleToMoveColumns(e,t,n,i),!0}catch{return!1}}moveColumns(e,t,n,i){return Fe(e,"number","sheetId"),Fe(t,"number","startColumn"),Fe(n,"number","numberOfColumns"),Fe(i,"number","targetColumn"),this._crudOperations.moveColumns(e,t,n,i),this.recomputeIfDependencyGraphNeedsIt()}copy(e){if(!gi(e))throw new Zt("SimpleCellRange","source");const t=new it(e.start,e.end);return this._crudOperations.copy(t.start,t.width(),t.height()),this.getRangeValues(e)}cut(e){if(!gi(e))throw new Zt("SimpleCellRange","source");const t=new it(e.start,e.end);return this._crudOperations.cut(t.start,t.width(),t.height()),this.getRangeValues(e)}paste(e){if(!kr(e))throw new Zt("SimpleCellAddress","targetLeftCorner");return this.ensureEvaluationIsNotSuspended(),this._crudOperations.paste(e),this.recomputeIfDependencyGraphNeedsIt()}isClipboardEmpty(){return this._crudOperations.isClipboardEmpty()}clearClipboard(){this._crudOperations.clearClipboard()}clearRedoStack(){this._crudOperations.undoRedo.clearRedoStack()}clearUndoStack(){this._crudOperations.undoRedo.clearUndoStack()}getRangeValues(e){if(!gi(e))throw new Zt("SimpleCellRange","source");return new it(e.start,e.end).arrayOfAddressesInRange().map(n=>n.map(i=>this.getCellValue(i)))}getRangeFormulas(e){if(!gi(e))throw new Zt("SimpleCellRange","source");return new it(e.start,e.end).arrayOfAddressesInRange().map(n=>n.map(i=>this.getCellFormula(i)))}getRangeSerialized(e){if(!gi(e))throw new Zt("SimpleCellRange","source");return new it(e.start,e.end).arrayOfAddressesInRange().map(n=>n.map(i=>this.getCellSerialized(i)))}getFillRangeData(e,t,n=!1){if(!gi(e))throw new Zt("SimpleCellRange","source");if(!gi(t))throw new Zt("SimpleCellRange","target");const i=new it(e.start,e.end),s=new it(t.start,t.end);return this.ensureEvaluationIsNotSuspended(),s.arrayOfAddressesInRange().map(o=>o.map(a=>{const l=((a.row-(n?t:e).start.row)%i.height()+i.height())%i.height()+e.start.row,u=((a.col-(n?t:e).start.col)%i.width()+i.width())%i.width()+e.start.col;return this._serialization.getCellSerialized({row:l,col:u,sheet:i.sheet},a)}))}isItPossibleToAddSheet(e){Fe(e,"string","sheetName");try{return this._crudOperations.ensureItIsPossibleToAddSheet(e),!0}catch{return!1}}addSheet(e){e!==void 0&&Fe(e,"string","sheetName");const t=this._crudOperations.addSheet(e);return this.recomputeIfDependencyGraphNeedsIt(),this._emitter.emit(Ss.SheetAdded,t),t}isItPossibleToRemoveSheet(e){Fe(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch{return!1}}removeSheet(e){Fe(e,"number","sheetId");const t=this.sheetMapping.getSheetName(e);this._crudOperations.removeSheet(e);const n=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(Ss.SheetRemoved,t,n),n}isItPossibleToClearSheet(e){Fe(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch{return!1}}clearSheet(e){return Fe(e,"number","sheetId"),this._crudOperations.clearSheet(e),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToReplaceSheetContent(e,t){Fe(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),this._crudOperations.ensureItIsPossibleToChangeSheetContents(e,t),!0}catch{return!1}}setSheetContent(e,t){return Fe(e,"number","sheetId"),this._crudOperations.setSheetContent(e,t),this.recomputeIfDependencyGraphNeedsIt()}simpleCellAddressFromString(e,t){return Fe(e,"string","cellAddress"),Fe(t,"number","sheetId"),Sg(this.sheetMapping.getSheetId.bind(this.sheetMapping),e,t)}simpleCellRangeFromString(e,t){return Fe(e,"string","cellRange"),Fe(t,"number","sheetId"),CN(this.sheetMapping.getSheetId.bind(this.sheetMapping),e,t)}simpleCellAddressToString(e,t={}){if(!kr(e))throw new Zt("SimpleCellAddress","cellAddress");const n=typeof t=="number"?t:t.includeSheetName?e.sheet+1:e.sheet;return nf(this.sheetMapping.getSheetNameOrThrowError.bind(this.sheetMapping),e,n)}simpleCellRangeToString(e,t={}){if(!gi(e))throw new Zt("SimpleCellRange","cellRange");const n=typeof t=="number"?t:t.includeSheetName?e.start.sheet+e.end.sheet+1:e.start.sheet;return NN(this.sheetMapping.getSheetNameOrThrowError.bind(this.sheetMapping),e,n)}getCellDependents(e){let t;if(kr(e))t=this._dependencyGraph.addressMapping.getCell(e);else if(gi(e))t=this._dependencyGraph.rangeMapping.getRangeVertex(e.start,e.end);else throw new Zt("SimpleCellAddress | SimpleCellRange",e);return t===void 0?[]:this._dependencyGraph.getAdjacentNodesAddresses(t)}getCellPrecedents(e){let t;if(kr(e))t=this._dependencyGraph.addressMapping.getCell(e);else if(gi(e))t=this._dependencyGraph.rangeMapping.getRangeVertex(e.start,e.end);else throw new Zt("SimpleCellAddress | SimpleCellRange",e);return t===void 0?[]:this._dependencyGraph.dependencyQueryAddresses(t)}getSheetName(e){return Fe(e,"number","sheetId"),this.sheetMapping.getSheetName(e)}getSheetNames(){return this.sheetMapping.getSheetNames()}getSheetId(e){return Fe(e,"string","sheetName"),this.sheetMapping.getSheetId(e)}doesSheetExist(e){return Fe(e,"string","sheetName"),this.sheetMapping.hasSheetWithName(e)}getCellType(e){if(!kr(e))throw new Zt("SimpleCellAddress","cellAddress");const t=this.dependencyGraph.getCell(e);return G8(t,e)}doesCellHaveSimpleValue(e){if(!kr(e))throw new Zt("SimpleCellAddress","cellAddress");return this.getCellType(e)===ei.VALUE}doesCellHaveFormula(e){if(!kr(e))throw new Zt("SimpleCellAddress","cellAddress");const t=this.getCellType(e);return t===ei.FORMULA||t===ei.ARRAYFORMULA}isCellEmpty(e){if(!kr(e))throw new Zt("SimpleCellAddress","cellAddress");return this.getCellType(e)===ei.EMPTY}isCellPartOfArray(e){if(!kr(e))throw new Zt("SimpleCellAddress","cellAddress");const t=this.getCellType(e);return t===ei.ARRAY||t===ei.ARRAYFORMULA}getCellValueType(e){if(!kr(e))throw new Zt("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const t=this.dependencyGraph.getCellValue(e);return _f(t)}getCellValueDetailedType(e){if(!kr(e))throw new Zt("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const t=this.dependencyGraph.getCellValue(e);return Y8(t)}getCellValueFormat(e){if(!kr(e))throw new Zt("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const t=this.dependencyGraph.getCellValue(e);return X8(t)}countSheets(){return this.sheetMapping.numberOfSheets()}isItPossibleToRenameSheet(e,t){Fe(e,"number","sheetId"),Fe(t,"string","newName");try{return this._crudOperations.ensureItIsPossibleToRenameSheet(e,t),!0}catch{return!1}}renameSheet(e,t){Fe(e,"number","sheetId"),Fe(t,"string","newName");const n=this._crudOperations.renameSheet(e,t);this.recomputeIfDependencyGraphNeedsIt(),n!==void 0&&this._emitter.emit(Ss.SheetRenamed,n,t)}batch(e){this.suspendEvaluation(),this._crudOperations.beginUndoRedoBatchMode();try{e()}catch(t){throw this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation(),t}return this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation()}suspendEvaluation(){this._evaluationSuspended=!0,this._emitter.emit(Ss.EvaluationSuspended)}resumeEvaluation(){this._evaluationSuspended=!1;const e=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(Ss.EvaluationResumed,e),e}isEvaluationSuspended(){return this._evaluationSuspended}isItPossibleToAddNamedExpression(e,t,n){Fe(e,"string","expressionName"),n!==void 0&&Fe(n,"number","scope");try{return this._crudOperations.ensureItIsPossibleToAddNamedExpression(e,t,n),!0}catch{return!1}}addNamedExpression(e,t,n,i){Fe(e,"string","expressionName"),n!==void 0&&Fe(n,"number","scope"),this._crudOperations.addNamedExpression(e,t,n,i);const s=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(Ss.NamedExpressionAdded,e,s),s}getNamedExpressionValue(e,t){Fe(e,"string","expressionName"),t!==void 0&&Fe(t,"number","scope"),this.ensureEvaluationIsNotSuspended(),this._crudOperations.ensureScopeIdIsValid(t);const n=this._namedExpressions.namedExpressionForScope(e,t);if(n)return this._serialization.getCellValue(n.address)}getNamedExpressionFormula(e,t){Fe(e,"string","expressionName"),t!==void 0&&Fe(t,"number","scope"),this._crudOperations.ensureScopeIdIsValid(t);const n=this._namedExpressions.namedExpressionForScope(e,t);if(n!==void 0)return this._serialization.getCellFormula(n.address)}getNamedExpression(e,t){Fe(e,"string","expressionName"),t!==void 0&&Fe(t,"number","scope");const n=this._namedExpressions.namedExpressionForScope(e,t);if(n===void 0)return;const i=this._serialization.getCellFormula(n.address);return{name:e,scope:t,expression:i,options:n.options}}isItPossibleToChangeNamedExpression(e,t,n){Fe(e,"string","expressionName"),n!==void 0&&Fe(n,"number","scope");try{return this._crudOperations.ensureItIsPossibleToChangeNamedExpression(e,t,n),!0}catch{return!1}}changeNamedExpression(e,t,n,i){return Fe(e,"string","expressionName"),n!==void 0&&Fe(n,"number","scope"),this._crudOperations.changeNamedExpressionExpression(e,n,t,i),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveNamedExpression(e,t){Fe(e,"string","expressionName"),t!==void 0&&Fe(t,"number","scope");try{return this._crudOperations.isItPossibleToRemoveNamedExpression(e,t),!0}catch{return!1}}removeNamedExpression(e,t){Fe(e,"string","expressionName"),t!==void 0&&Fe(t,"number","scope");const n=this._crudOperations.removeNamedExpression(e,t);if(n){const i=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(Ss.NamedExpressionRemoved,n.displayName,i),i}else return[]}listNamedExpressions(e){return e!==void 0&&Fe(e,"number","scope"),this._crudOperations.ensureScopeIdIsValid(e),this._namedExpressions.getAllNamedExpressionsNamesInScope(e)}getAllNamedExpressionsSerialized(){return this._serialization.getAllNamedExpressionsSerialized()}normalizeFormula(e){Fe(e,"string","formulaString");const{ast:t,address:n}=this.extractTemporaryFormula(e);if(t===void 0)throw new bd;return this._unparser.unparse(t,n)}calculateFormula(e,t){Fe(e,"string","formulaString"),Fe(t,"number","sheetId"),this._crudOperations.ensureScopeIdIsValid(t);const{ast:n,address:i,dependencies:s}=this.extractTemporaryFormula(e,t);if(n===void 0)throw new bd;const o=this.evaluator.runAndForget(n,i,s);return this._exporter.exportScalarOrRange(o)}getNamedExpressionsFromFormula(e){Fe(e,"string","formulaString");const{ast:t,dependencies:n}=this.extractTemporaryFormula(e);if(t===void 0)throw new bd;const i=n.filter(o=>o instanceof mo).map(o=>o.name);return[...new Set(i)]}validateFormula(e){Fe(e,"string","formulaString");const{ast:t}=this.extractTemporaryFormula(e);return t!==void 0}getRegisteredFunctionNames(){return yn.getLanguage(this._config.language).getFunctionTranslations(this._functionRegistry.getRegisteredFunctionIds())}getFunctionPlugin(e){return Fe(e,"string","functionId"),this._functionRegistry.getFunctionPlugin(e)}getAllFunctionPlugins(){return this._functionRegistry.getPlugins()}numberToDateTime(e){return Fe(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDateTime(e)}numberToDate(e){return Fe(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDate(e)}numberToTime(e){return Fe(e,"number","val"),Xl(e)}on(e,t){this._emitter.on(e,t)}once(e,t){this._emitter.once(e,t)}off(e,t){this._emitter.off(e,t)}destroy(){LI(this)}ensureEvaluationIsNotSuspended(){if(this._evaluationSuspended)throw new xS}extractTemporaryFormula(e,t=1){const n=this._cellContentParser.parse(e),i={sheet:t,col:0,row:0};if(!(n instanceof Mr.Formula))return{address:i,dependencies:[]};const{ast:s,errors:o,dependencies:a}=this._parser.parse(n.formula,i);return o.length>0?{address:i,dependencies:[]}:{ast:s,address:i,dependencies:a}}rebuildWithConfig(e){const t=this._config.mergeConfig(e),n=this._config.mergeConfig({language:e.language}),i=this._serialization.withNewConfig(n,this._namedExpressions).getAllSheetsSerialized(),s=this._serialization.getAllNamedExpressionsSerialized(),o=Lh.rebuildWithConfig(t,i,s,this._stats);this._config=o.config,this._stats=o.stats,this._dependencyGraph=o.dependencyGraph,this._columnSearch=o.columnSearch,this._parser=o.parser,this._unparser=o.unparser,this._cellContentParser=o.cellContentParser,this._evaluator=o.evaluator,this._lazilyTransformingAstService=o.lazilyTransformingAstService,this._crudOperations=o.crudOperations,this._exporter=o.exporter,this._namedExpressions=o.namedExpressions,this._serialization=o.serialization,this._functionRegistry=o.functionRegistry}recomputeIfDependencyGraphNeedsIt(){if(this._evaluationSuspended)return[];{const e=this._crudOperations.getAndClearContentChanges(),t=this.dependencyGraph.verticesToRecompute();this.dependencyGraph.clearDirtyVertices(),t.length>0&&e.addAll(this.evaluator.partialRun(t));const n=e.exportChanges(this._exporter);return e.isEmpty()||this._emitter.emit(Ss.ValuesUpdated,n),n}}}yn.version="3.1.1";yn.buildDate="18/12/2025 11:47:25";yn.releaseDate="18/12/2025";yn.languages={};yn.registeredLanguages=new Map;const Q1=new WeakMap;class Si{constructor(e={},t=!0){const{accentSensitive:n,caseSensitive:i,caseFirst:s,chooseAddressMappingPolicy:o,context:a,currencySymbol:l,dateFormats:u,decimalSeparator:c,evaluateNullToZero:d,functionArgSeparator:h,functionPlugins:f,ignorePunctuation:m,leapYear1900:p,localeLang:g,language:v,ignoreWhiteSpace:y,licenseKey:b,matchWholeCell:E,arrayColumnSeparator:A,arrayRowSeparator:M,maxRows:L,maxColumns:k,nullYear:P,nullDate:U,parseDateTime:$,precisionEpsilon:V,precisionRounding:R,stringifyDateTime:O,stringifyDuration:T,smartRounding:w,timeFormats:x,thousandSeparator:_,useArrayArithmetic:S,useStats:C,undoLimit:F,useColumnIndex:D,useRegularExpressions:H,useWildcards:G}=e;this.useArrayArithmetic=sr(S,"boolean","useArrayArithmetic"),this.accentSensitive=sr(n,"boolean","accentSensitive"),this.caseSensitive=sr(i,"boolean","caseSensitive"),this.caseFirst=sr(s,["upper","lower","false"],"caseFirst"),this.ignorePunctuation=sr(m,"boolean","ignorePunctuation"),this.chooseAddressMappingPolicy=o??Si.defaultConfig.chooseAddressMappingPolicy,this.dateFormats=[...Mh(u,Array.isArray,"array","dateFormats")],this.timeFormats=[...Mh(x,Array.isArray,"array","timeFormats")],this.functionArgSeparator=sr(h,"string","functionArgSeparator"),this.decimalSeparator=sr(c,[".",","],"decimalSeparator"),this.language=sr(v,"string","language"),this.ignoreWhiteSpace=sr(y,["standard","any"],"ignoreWhiteSpace"),this.licenseKey=sr(b,"string","licenseKey"),this.thousandSeparator=sr(_,["",","," ","."],"thousandSeparator"),this.arrayColumnSeparator=sr(A,[",",";"],"arrayColumnSeparator"),this.arrayRowSeparator=sr(M,[";","|"],"arrayRowSeparator"),this.localeLang=sr(g,"string","localeLang"),this.functionPlugins=[...f??Si.defaultConfig.functionPlugins],this.smartRounding=sr(w,"boolean","smartRounding"),this.evaluateNullToZero=sr(d,"boolean","evaluateNullToZero"),this.nullYear=sr(P,"number","nullYear"),El(this.nullYear,"nullYear",0),hO(this.nullYear,"nullYear",100),this.precisionRounding=sr(R,"number","precisionRounding"),El(this.precisionRounding,"precisionRounding",0),this.precisionEpsilon=sr(V,"number","precisionEpsilon"),El(this.precisionEpsilon,"precisionEpsilon",0),this.useColumnIndex=sr(D,"boolean","useColumnIndex"),this.useStats=sr(C,"boolean","useStats"),this.parseDateTime=sr($,"function","parseDateTime"),this.stringifyDateTime=sr(O,"function","stringifyDateTime"),this.stringifyDuration=sr(T,"function","stringifyDuration"),this.translationPackage=yn.getLanguage(this.language),this.errorMapping=this.translationPackage.buildErrorMapping(),this.nullDate=Mh(U,uc,"IDate","nullDate"),this.leapYear1900=sr(p,"boolean","leapYear1900"),this.undoLimit=sr(F,"number","undoLimit"),this.useRegularExpressions=sr(H,"boolean","useRegularExpressions"),this.useWildcards=sr(G,"boolean","useWildcards"),this.matchWholeCell=sr(E,"boolean","matchWholeCell"),El(this.undoLimit,"undoLimit",0),this.maxRows=sr(L,"number","maxRows"),El(this.maxRows,"maxRows",1),this.maxColumns=sr(k,"number","maxColumns"),this.currencySymbol=this.setupCurrencySymbol(l),El(this.maxColumns,"maxColumns",1),this.context=a,Q1.set(this,{licenseKeyValidityState:DO(this.licenseKey)}),D1({value:this.decimalSeparator,name:"decimalSeparator"},{value:this.functionArgSeparator,name:"functionArgSeparator"},{value:this.thousandSeparator,name:"thousandSeparator"}),D1({value:this.arrayRowSeparator,name:"arrayRowSeparator"},{value:this.arrayColumnSeparator,name:"arrayColumnSeparator"})}setupCurrencySymbol(e){const t=[...Mh(e,Array.isArray,"array","currencySymbol")];return t.forEach(n=>{if(typeof n!="string")throw new Zt("string[]","currencySymbol");if(n==="")throw new P8("currencySymbol")}),t}get licenseKeyValidityState(){return Q1.get(this).licenseKeyValidityState}getConfig(){return YS(this)}mergeConfig(e){const t=Object.assign({},this.getConfig(),e);return new Si(t,!1)}static warnDeprecatedOptions(e){}static warnDeprecatedIfUsed(e,t,n,i){e!==void 0&&console.warn(i===void 0?`${t} option is deprecated since ${n}`:`${t} option is deprecated since ${n}, please use ${i}`)}}Si.defaultConfig={accentSensitive:!1,currencySymbol:["$"],caseSensitive:!1,caseFirst:"lower",context:void 0,chooseAddressMappingPolicy:new TO,dateFormats:["DD/MM/YYYY","DD/MM/YY"],decimalSeparator:".",evaluateNullToZero:!1,functionArgSeparator:",",functionPlugins:[],ignorePunctuation:!1,language:"enGB",ignoreWhiteSpace:"standard",licenseKey:"",leapYear1900:!1,localeLang:"en",matchWholeCell:!0,arrayColumnSeparator:",",arrayRowSeparator:";",maxRows:4e4,maxColumns:18278,nullYear:30,nullDate:{year:1899,month:12,day:30},parseDateTime:gO,precisionEpsilon:1e-13,precisionRounding:10,smartRounding:!0,stringifyDateTime:kO,stringifyDuration:IO,timeFormats:["hh:mm","hh:mm:ss.sss"],thousandSeparator:"",undoLimit:20,useRegularExpressions:!1,useWildcards:!0,useColumnIndex:!1,useStats:!1,useArrayArithmetic:!1};function YS(r){var e;const t={};for(const n in Si.defaultConfig){const i=(e=r[n])!==null&&e!==void 0?e:Si.defaultConfig[n];Array.isArray(i)?t[n]=[...i]:t[n]=i}return t}function jI(){return YS({})}const Kg={errors:{CYCLE:"#CYCLE!",DIV_BY_ZERO:"#DIV/0!",ERROR:"#ERROR!",NA:"#N/A",NAME:"#NAME?",NUM:"#NUM!",REF:"#REF!",SPILL:"#SPILL!",VALUE:"#VALUE!"},functions:{FILTER:"FILTER",ADDRESS:"ADDRESS",ARRAY_CONSTRAIN:"ARRAY_CONSTRAIN",ARRAYFORMULA:"ARRAYFORMULA",ABS:"ABS",ACOS:"ACOS",ACOSH:"ACOSH",ACOT:"ACOT",ACOTH:"ACOTH",AND:"AND",ARABIC:"ARABIC",ASIN:"ASIN",ASINH:"ASINH",ATAN2:"ATAN2",ATAN:"ATAN",ATANH:"ATANH",AVERAGE:"AVERAGE",AVERAGEA:"AVERAGEA",AVERAGEIF:"AVERAGEIF",BASE:"BASE",BIN2DEC:"BIN2DEC",BIN2HEX:"BIN2HEX",BIN2OCT:"BIN2OCT",BITAND:"BITAND",BITLSHIFT:"BITLSHIFT",BITOR:"BITOR",BITRSHIFT:"BITRSHIFT",BITXOR:"BITXOR",CEILING:"CEILING",CHAR:"CHAR",CHOOSE:"CHOOSE",CLEAN:"CLEAN",CODE:"CODE",COLUMN:"COLUMN",COLUMNS:"COLUMNS",CONCATENATE:"CONCATENATE",CORREL:"CORREL",COS:"COS",COSH:"COSH",COT:"COT",COTH:"COTH",COUNT:"COUNT",COUNTA:"COUNTA",COUNTBLANK:"COUNTBLANK",COUNTIF:"COUNTIF",COUNTIFS:"COUNTIFS",COUNTUNIQUE:"COUNTUNIQUE",CSC:"CSC",CSCH:"CSCH",CUMIPMT:"CUMIPMT",CUMPRINC:"CUMPRINC",DATE:"DATE",DATEDIF:"DATEDIF",DATEVALUE:"DATEVALUE",DAY:"DAY",DAYS360:"DAYS360",DAYS:"DAYS",DB:"DB",DDB:"DDB",DEC2BIN:"DEC2BIN",DEC2HEX:"DEC2HEX",DEC2OCT:"DEC2OCT",DECIMAL:"DECIMAL",DEGREES:"DEGREES",DELTA:"DELTA",DOLLARDE:"DOLLARDE",DOLLARFR:"DOLLARFR",EDATE:"EDATE",EFFECT:"EFFECT",EOMONTH:"EOMONTH",ERF:"ERF",ERFC:"ERFC",EVEN:"EVEN",EXACT:"EXACT",EXP:"EXP",FALSE:"FALSE",FIND:"FIND",FORMULATEXT:"FORMULATEXT",FV:"FV",FVSCHEDULE:"FVSCHEDULE",HEX2BIN:"HEX2BIN",HEX2DEC:"HEX2DEC",HEX2OCT:"HEX2OCT",HLOOKUP:"HLOOKUP",HOUR:"HOUR",HYPERLINK:"HYPERLINK",IF:"IF",IFERROR:"IFERROR",IFNA:"IFNA",IFS:"IFS",INDEX:"INDEX",INT:"INT",INTERVAL:"INTERVAL",IPMT:"IPMT",ISBINARY:"ISBINARY",ISBLANK:"ISBLANK",ISERR:"ISERR",ISERROR:"ISERROR",ISEVEN:"ISEVEN",ISFORMULA:"ISFORMULA",ISLOGICAL:"ISLOGICAL",ISNA:"ISNA",ISNONTEXT:"ISNONTEXT",ISNUMBER:"ISNUMBER",ISODD:"ISODD",ISOWEEKNUM:"ISOWEEKNUM",ISPMT:"ISPMT",ISREF:"ISREF",ISTEXT:"ISTEXT",LEFT:"LEFT",LEN:"LEN",LN:"LN",LOG10:"LOG10",LOG:"LOG",LOWER:"LOWER",MATCH:"MATCH",MAX:"MAX",MAXA:"MAXA",MAXIFS:"MAXIFS",MAXPOOL:"MAXPOOL",MEDIAN:"MEDIAN",MEDIANPOOL:"MEDIANPOOL",MID:"MID",MIN:"MIN",MINA:"MINA",MINIFS:"MINIFS",MINUTE:"MINUTE",MIRR:"MIRR",MMULT:"MMULT",MOD:"MOD",MONTH:"MONTH",NA:"NA",NETWORKDAYS:"NETWORKDAYS","NETWORKDAYS.INTL":"NETWORKDAYS.INTL",NOMINAL:"NOMINAL",NOT:"NOT",NOW:"NOW",NPER:"NPER",NPV:"NPV",OCT2BIN:"OCT2BIN",OCT2DEC:"OCT2DEC",OCT2HEX:"OCT2HEX",ODD:"ODD",OFFSET:"OFFSET",OR:"OR",PI:"PI",PMT:"PMT",PDURATION:"PDURATION",PRODUCT:"PRODUCT",POWER:"POWER",PPMT:"PPMT",PROPER:"PROPER",PV:"PV",RADIANS:"RADIANS",RAND:"RAND",RATE:"RATE",REPLACE:"REPLACE",REPT:"REPT",RIGHT:"RIGHT",ROMAN:"ROMAN",ROUND:"ROUND",ROUNDDOWN:"ROUNDDOWN",ROUNDUP:"ROUNDUP",ROW:"ROW",ROWS:"ROWS",RRI:"RRI",SEARCH:"SEARCH",SEC:"SEC",SECH:"SECH",SECOND:"SECOND",SHEET:"SHEET",SHEETS:"SHEETS",SIN:"SIN",SINH:"SINH",SLN:"SLN",SPLIT:"SPLIT",SQRT:"SQRT",STDEVA:"STDEVA","STDEV.P":"STDEV.P",STDEVPA:"STDEVPA","STDEV.S":"STDEV.S",SUBSTITUTE:"SUBSTITUTE",SUBTOTAL:"SUBTOTAL",SUM:"SUM",SUMIF:"SUMIF",SUMIFS:"SUMIFS",SUMPRODUCT:"SUMPRODUCT",SUMSQ:"SUMSQ",SWITCH:"SWITCH",SYD:"SYD",T:"T",TAN:"TAN",TANH:"TANH",TBILLEQ:"TBILLEQ",TBILLPRICE:"TBILLPRICE",TBILLYIELD:"TBILLYIELD",TEXT:"TEXT",TIME:"TIME",TIMEVALUE:"TIMEVALUE",TODAY:"TODAY",TRANSPOSE:"TRANSPOSE",TRIM:"TRIM",TRUE:"TRUE",TRUNC:"TRUNC",UNICHAR:"UNICHAR",UNICODE:"UNICODE",UPPER:"UPPER",VARA:"VARA","VAR.P":"VAR.P",VARPA:"VARPA","VAR.S":"VAR.S",VLOOKUP:"VLOOKUP",WEEKDAY:"WEEKDAY",WEEKNUM:"WEEKNUM",WORKDAY:"WORKDAY","WORKDAY.INTL":"WORKDAY.INTL",XNPV:"XNPV",XOR:"XOR",XLOOKUP:"XLOOKUP",YEAR:"YEAR",YEARFRAC:"YEARFRAC","HF.ADD":"HF.ADD","HF.CONCAT":"HF.CONCAT","HF.DIVIDE":"HF.DIVIDE","HF.EQ":"HF.EQ","HF.GT":"HF.GT","HF.GTE":"HF.GTE","HF.LT":"HF.LT","HF.LTE":"HF.LTE","HF.MINUS":"HF.MINUS","HF.MULTIPLY":"HF.MULTIPLY","HF.NE":"HF.NE","HF.POW":"HF.POW","HF.UMINUS":"HF.UMINUS","HF.UNARY_PERCENT":"HF.UNARY_PERCENT","HF.UPLUS":"HF.UPLUS",VARP:"VARP",VAR:"VAR",STDEVP:"STDEVP",STDEV:"STDEV","EXPON.DIST":"EXPON.DIST",FISHER:"FISHER",FISHERINV:"FISHERINV",GAMMA:"GAMMA","GAMMA.DIST":"GAMMA.DIST",GAMMALN:"GAMMALN","GAMMALN.PRECISE":"GAMMALN.PRECISE","GAMMA.INV":"GAMMA.INV",GAUSS:"GAUSS",FACT:"FACT",FACTDOUBLE:"FACTDOUBLE",COMBIN:"COMBIN",COMBINA:"COMBINA",GCD:"GCD",LCM:"LCM",MROUND:"MROUND",MULTINOMIAL:"MULTINOMIAL",QUOTIENT:"QUOTIENT",RANDBETWEEN:"RANDBETWEEN",SERIESSUM:"SERIESSUM",SIGN:"SIGN",SQRTPI:"SQRTPI",SUMX2MY2:"SUMX2MY2",SUMX2PY2:"SUMX2PY2",SUMXMY2:"SUMXMY2",EXPONDIST:"EXPONDIST",GAMMADIST:"GAMMADIST",GAMMAINV:"GAMMAINV","BETA.DIST":"BETA.DIST",BETADIST:"BETADIST","BETA.INV":"BETA.INV",BETAINV:"BETAINV","BINOM.DIST":"BINOM.DIST",BINOMDIST:"BINOMDIST","BINOM.INV":"BINOM.INV",BESSELI:"BESSELI",BESSELJ:"BESSELJ",BESSELK:"BESSELK",BESSELY:"BESSELY","CHISQ.DIST":"CHISQ.DIST","CHISQ.DIST.RT":"CHISQ.DIST.RT","CHISQ.INV":"CHISQ.INV","CHISQ.INV.RT":"CHISQ.INV.RT",CHIDIST:"CHIDIST",CHIINV:"CHIINV","F.DIST":"F.DIST","F.DIST.RT":"F.DIST.RT","F.INV":"F.INV","F.INV.RT":"F.INV.RT",FDIST:"FDIST",FINV:"FINV",WEIBULL:"WEIBULL","WEIBULL.DIST":"WEIBULL.DIST",POISSON:"POISSON","POISSON.DIST":"POISSON.DIST","HYPGEOM.DIST":"HYPGEOM.DIST",HYPGEOMDIST:"HYPGEOMDIST","T.DIST":"T.DIST","T.DIST.2T":"T.DIST.2T","T.DIST.RT":"T.DIST.RT","T.INV":"T.INV","T.INV.2T":"T.INV.2T",TDIST:"TDIST",TINV:"TINV",LOGINV:"LOGINV","LOGNORM.DIST":"LOGNORM.DIST","LOGNORM.INV":"LOGNORM.INV",LOGNORMDIST:"LOGNORMDIST","NORM.DIST":"NORM.DIST","NORM.INV":"NORM.INV","NORM.S.DIST":"NORM.S.DIST","NORM.S.INV":"NORM.S.INV",NORMDIST:"NORMDIST",NORMINV:"NORMINV",NORMSDIST:"NORMSDIST",NORMSINV:"NORMSINV",PHI:"PHI","NEGBINOM.DIST":"NEGBINOM.DIST",NEGBINOMDIST:"NEGBINOMDIST",COMPLEX:"COMPLEX",IMABS:"IMABS",IMAGINARY:"IMAGINARY",IMARGUMENT:"IMARGUMENT",IMCONJUGATE:"IMCONJUGATE",IMCOS:"IMCOS",IMCOSH:"IMCOSH",IMCOT:"IMCOT",IMCSC:"IMCSC",IMCSCH:"IMCSCH",IMDIV:"IMDIV",IMEXP:"IMEXP",IMLN:"IMLN",IMLOG10:"IMLOG10",IMLOG2:"IMLOG2",IMPOWER:"IMPOWER",IMPRODUCT:"IMPRODUCT",IMREAL:"IMREAL",IMSEC:"IMSEC",IMSECH:"IMSECH",IMSIN:"IMSIN",IMSINH:"IMSINH",IMSQRT:"IMSQRT",IMSUB:"IMSUB",IMSUM:"IMSUM",IMTAN:"IMTAN",LARGE:"LARGE",SMALL:"SMALL",AVEDEV:"AVEDEV",CONFIDENCE:"CONFIDENCE","CONFIDENCE.NORM":"CONFIDENCE.NORM","CONFIDENCE.T":"CONFIDENCE.T",DEVSQ:"DEVSQ",GEOMEAN:"GEOMEAN",HARMEAN:"HARMEAN",CRITBINOM:"CRITBINOM","COVARIANCE.P":"COVARIANCE.P","COVARIANCE.S":"COVARIANCE.S",COVAR:"COVAR",PEARSON:"PEARSON",RSQ:"RSQ",STANDARDIZE:"STANDARDIZE","Z.TEST":"Z.TEST",ZTEST:"ZTEST","F.TEST":"F.TEST",FTEST:"FTEST",STEYX:"STEYX",SLOPE:"SLOPE","CHISQ.TEST":"CHISQ.TEST",CHITEST:"CHITEST","T.TEST":"T.TEST",TTEST:"TTEST",SKEW:"SKEW","SKEW.P":"SKEW.P",WEIBULLDIST:"WEIBULLDIST",VARS:"VARS",TINV2T:"TINV2T",TDISTRT:"TDISTRT",TDIST2T:"TDIST2T",STDEVS:"STDEVS",FINVRT:"FINVRT",FDISTRT:"FDISTRT",CHIDISTRT:"CHIDISTRT",CHIINVRT:"CHIINVRT",COVARIANCEP:"COVARIANCEP",COVARIANCES:"COVARIANCES",LOGNORMINV:"LOGNORMINV",POISSONDIST:"POISSONDIST",SKEWP:"SKEWP","CEILING.MATH":"CEILING.MATH",FLOOR:"FLOOR","FLOOR.MATH":"FLOOR.MATH","CEILING.PRECISE":"CEILING.PRECISE","FLOOR.PRECISE":"FLOOR.PRECISE","ISO.CEILING":"ISO.CEILING"},langCode:"enGB",ui:{NEW_SHEET_PREFIX:"Sheet"}};var Zo;(function(r){r[r.FullyAbsolute=1]="FullyAbsolute",r[r.RowAbsoluteColRelative=2]="RowAbsoluteColRelative",r[r.RowRelativeColAbsolute=3]="RowRelativeColAbsolute",r[r.FullyRelative=4]="FullyRelative"})(Zo||(Zo={}));class XS extends At{verifyAddressArguments(e,t,n,i){if(i){if(e<1||t<1)return new J(te.VALUE,ue.LessThanOne)}else if(Zo.FullyAbsolute==n){if(e<1||t<1)return new J(te.VALUE,ue.LessThanOne)}else if(Zo.RowAbsoluteColRelative==n){if(e<1)return new J(te.VALUE,ue.LessThanOne)}else if(Zo.RowRelativeColAbsolute==n&&t<1)return new J(te.VALUE,ue.LessThanOne)}address(e,t){return this.runFunction(e.args,t,this.metadata("ADDRESS"),(n,i,s,o,a)=>{const l=this.verifyAddressArguments(n,i,s,o);if(l!==void 0)return l;const u=Np(i-1);let c="";a!=null&&(c=`${a}!`);const d=i==0?"C":`C[${i}]`,h=n==0?"R":`R[${n}]`;return Zo.FullyRelative==s?o?`${c}${u}${n}`:`${c}${h}${d}`:Zo.RowRelativeColAbsolute==s?o?`${c}$${u}${n}`:`${c}${h}C${i}`:Zo.RowAbsoluteColRelative==s?o?`${c}${u}$${n}`:`${c}R${n}${d}`:o?`${c}$${u}$${n}`:`${c}R${n}C${i}`})}}XS.implementedFunctions={ADDRESS:{method:"address",parameters:[{argumentType:z.NUMBER},{argumentType:z.NUMBER},{argumentType:z.NUMBER,optionalArg:!0,defaultValue:1,minValue:1,maxValue:4},{argumentType:z.BOOLEAN,optionalArg:!0,defaultValue:!0},{argumentType:z.STRING,optionalArg:!0}]}};class KS extends At{arrayformula(e,t){return this.runFunction(e.args,t,this.metadata("ARRAYFORMULA"),n=>n)}arrayformulaArraySize(e,t){if(e.args.length!==1)return Ct.error();const n=this.metadata("ARRAYFORMULA");return e.args.map(s=>{var o;return this.arraySizeForAst(s,new Ls(t.formulaAddress,t.arraysFlag||((o=n?.enableArrayArithmeticForArguments)!==null&&o!==void 0?o:!1)))})[0]}arrayconstrain(e,t){return this.runFunction(e.args,t,this.metadata("ARRAY_CONSTRAIN"),(n,i,s)=>{i=Math.min(i,n.height()),s=Math.min(s,n.width());const o=n.data,a=[];for(let l=0;l<i;l++)a.push(o[l].slice(0,s));return Ge.onlyValues(a)})}arrayconstrainArraySize(e,t){if(e.args.length!==3)return Ct.error();const n=this.metadata("ARRAY_CONSTRAIN"),i=e.args.map(a=>{var l;return this.arraySizeForAst(a,new Ls(t.formulaAddress,t.arraysFlag||((l=n?.enableArrayArithmeticForArguments)!==null&&l!==void 0?l:!1)))});let{height:s,width:o}=i[0];return e.args[1].type===oe.NUMBER&&(s=Math.min(s,e.args[1].value)),e.args[2].type===oe.NUMBER&&(o=Math.min(o,e.args[2].value)),s<1||o<1||!Number.isInteger(s)||!Number.isInteger(o)?Ct.error():new Ct(o,s)}filter(e,t){return this.runFunction(e.args,t,this.metadata("FILTER"),(n,...i)=>{for(const a of i)if(n.width()!==a.width()||n.height()!==a.height())return new J(te.NA,ue.EqualLength);if(n.width()>1&&n.height()>1)return new J(te.NA,ue.WrongDimension);const s=n.data,o=[];for(let a=0;a<n.height();a++){const l=[];for(let u=0;u<n.width();u++){let c=!0;for(const d of i)if(NS(d.data[a][u])!==!0){c=!1;break}c&&l.push(s[a][u])}l.length>0&&o.push(l)}return o.length>0?Ge.onlyValues(o):new J(te.NA,ue.EmptyRange)})}filterArraySize(e,t){if(e.args.length<=1)return Ct.error();const n=this.metadata("FILTER"),i=e.args.map(a=>{var l;return this.arraySizeForAst(a,new Ls(t.formulaAddress,t.arraysFlag||((l=n?.enableArrayArithmeticForArguments)!==null&&l!==void 0?l:!1)))}),s=Math.max(...i.map(a=>a.width)),o=Math.max(...i.map(a=>a.height));return new Ct(s,o)}}KS.implementedFunctions={ARRAYFORMULA:{method:"arrayformula",sizeOfResultArrayMethod:"arrayformulaArraySize",enableArrayArithmeticForArguments:!0,parameters:[{argumentType:z.ANY}]},ARRAY_CONSTRAIN:{method:"arrayconstrain",sizeOfResultArrayMethod:"arrayconstrainArraySize",parameters:[{argumentType:z.RANGE},{argumentType:z.INTEGER,minValue:1},{argumentType:z.INTEGER,minValue:1}],vectorizationForbidden:!0},FILTER:{method:"filter",sizeOfResultArrayMethod:"filterArraySize",enableArrayArithmeticForArguments:!0,parameters:[{argumentType:z.RANGE},{argumentType:z.RANGE}],repeatLastArgs:1}};class ZS extends At{abs(e,t){return this.runFunction(e.args,t,this.metadata("ABS"),Math.abs)}}ZS.implementedFunctions={ABS:{method:"abs",parameters:[{argumentType:z.NUMBER}]}};const $I=0xffffffffffff,J1=-53,ew=53;class QS extends At{bitlshift(e,t){return this.runFunction(e.args,t,this.metadata("BITLSHIFT"),JS)}bitrshift(e,t){return this.runFunction(e.args,t,this.metadata("BITRSHIFT"),eT)}}QS.implementedFunctions={BITLSHIFT:{method:"bitlshift",parameters:[{argumentType:z.INTEGER,minValue:0},{argumentType:z.INTEGER,minValue:J1,maxValue:ew}]},BITRSHIFT:{method:"bitrshift",parameters:[{argumentType:z.INTEGER,minValue:0},{argumentType:z.INTEGER,minValue:J1,maxValue:ew}]}};function JS(r,e){return e<0?eT(r,-e):tT(r*Math.pow(2,e))}function eT(r,e){return e<0?JS(r,-e):tT(Math.floor(r/Math.pow(2,e)))}function tT(r){return r>$I?new J(te.NUM,ue.BitshiftLong):r}class rT extends At{bitand(e,t){return this.runFunction(e.args,t,this.metadata("BITAND"),(n,i)=>n&i)}bitor(e,t){return this.runFunction(e.args,t,this.metadata("BITOR"),(n,i)=>n|i)}bitxor(e,t){return this.runFunction(e.args,t,this.metadata("BITXOR"),(n,i)=>n^i)}}rT.implementedFunctions={BITAND:{method:"bitand",parameters:[{argumentType:z.INTEGER,minValue:0},{argumentType:z.INTEGER,minValue:0}]},BITOR:{method:"bitor",parameters:[{argumentType:z.INTEGER,minValue:0},{argumentType:z.INTEGER,minValue:0}]},BITXOR:{method:"bitxor",parameters:[{argumentType:z.INTEGER,minValue:0},{argumentType:z.INTEGER,minValue:0}]}};class nT extends At{literalTrue(e,t){return this.runFunction(e.args,t,this.metadata("TRUE"),()=>!0)}literalFalse(e,t){return this.runFunction(e.args,t,this.metadata("FALSE"),()=>!1)}conditionalIf(e,t){return this.runFunction(e.args,t,this.metadata("IF"),(n,i,s)=>n?i:s)}ifs(e,t){return this.runFunction(e.args,t,this.metadata("IFS"),(...n)=>{for(let i=0;i<n.length;i+=2)if(n[i])return n[i+1];return new J(te.NA,ue.NoConditionMet)})}and(e,t){return this.runFunction(e.args,t,this.metadata("AND"),(...n)=>n.filter(i=>i!==void 0).every(i=>!!i))}or(e,t){return this.runFunction(e.args,t,this.metadata("OR"),(...n)=>n.filter(i=>i!==void 0).some(i=>i))}not(e,t){return this.runFunction(e.args,t,this.metadata("NOT"),n=>!n)}xor(e,t){return this.runFunction(e.args,t,this.metadata("XOR"),(...n)=>{let i=0;return n.filter(s=>s!==void 0).forEach(s=>{s&&i++}),i%2===1})}switch(e,t){return this.runFunction(e.args,t,this.metadata("SWITCH"),(n,...i)=>{const s=i.length;let o=0;for(;o+1<s;o+=2)if(!(i[o]instanceof J)&&this.arithmeticHelper.eq(n,i[o]))return i[o+1];return o<s?i[o]:new J(te.NA,ue.NoDefault)})}iferror(e,t){return this.runFunction(e.args,t,this.metadata("IFERROR"),(n,i)=>n instanceof J?i:n)}ifna(e,t){return this.runFunction(e.args,t,this.metadata("IFNA"),(n,i)=>n instanceof J&&n.type===te.NA?i:n)}choose(e,t){return this.runFunction(e.args,t,this.metadata("CHOOSE"),(n,...i)=>n>i.length?new J(te.NUM,ue.Selector):i[n-1])}}nT.implementedFunctions={TRUE:{method:"literalTrue",parameters:[]},FALSE:{method:"literalFalse",parameters:[]},IF:{method:"conditionalIf",parameters:[{argumentType:z.BOOLEAN},{argumentType:z.SCALAR,passSubtype:!0},{argumentType:z.SCALAR,defaultValue:!1,passSubtype:!0}]},IFS:{method:"ifs",parameters:[{argumentType:z.BOOLEAN},{argumentType:z.SCALAR,passSubtype:!0}],repeatLastArgs:2},AND:{method:"and",parameters:[{argumentType:z.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},OR:{method:"or",parameters:[{argumentType:z.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},XOR:{method:"xor",parameters:[{argumentType:z.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},NOT:{method:"not",parameters:[{argumentType:z.BOOLEAN}]},SWITCH:{method:"switch",parameters:[{argumentType:z.NOERROR},{argumentType:z.SCALAR,passSubtype:!0},{argumentType:z.SCALAR,passSubtype:!0}],repeatLastArgs:1},IFERROR:{method:"iferror",parameters:[{argumentType:z.SCALAR,passSubtype:!0},{argumentType:z.SCALAR,passSubtype:!0}]},IFNA:{method:"ifna",parameters:[{argumentType:z.SCALAR,passSubtype:!0},{argumentType:z.SCALAR,passSubtype:!0}]},CHOOSE:{method:"choose",parameters:[{argumentType:z.INTEGER,minValue:1},{argumentType:z.SCALAR,passSubtype:!0}],repeatLastArgs:1}};class iT extends At{char(e,t){return this.runFunction(e.args,t,this.metadata("CHAR"),n=>n<1||n>=256?new J(te.VALUE,ue.CharacterCodeBounds):String.fromCharCode(Math.trunc(n)))}unichar(e,t){return this.runFunction(e.args,t,this.metadata("CHAR"),n=>n<1||n>=1114112?new J(te.VALUE,ue.CharacterCodeBounds):String.fromCodePoint(Math.trunc(n)))}}iT.implementedFunctions={CHAR:{method:"char",parameters:[{argumentType:z.NUMBER}]},UNICHAR:{method:"unichar",parameters:[{argumentType:z.NUMBER}]}};class sT extends At{code(e,t){return this.runFunction(e.args,t,this.metadata("CODE"),n=>n.length===0?new J(te.VALUE,ue.EmptyString):n.charCodeAt(0))}unicode(e,t){return this.runFunction(e.args,t,this.metadata("UNICODE"),n=>{var i;return(i=n.codePointAt(0))!==null&&i!==void 0?i:new J(te.VALUE,ue.EmptyString)})}}sT.implementedFunctions={CODE:{method:"code",parameters:[{argumentType:z.STRING}]},UNICODE:{method:"unicode",parameters:[{argumentType:z.STRING}]}};class oT extends At{countblank(e,t){return this.runFunction(e.args,t,this.metadata("COUNTBLANK"),(...n)=>{let i=0;return n.forEach(s=>{s===It&&i++}),i})}}oT.implementedFunctions={COUNTBLANK:{method:"countblank",parameters:[{argumentType:z.SCALAR}],repeatLastArgs:1,expandRanges:!0}};class aT extends At{countunique(e,t){return this.runFunction(e.args,t,this.metadata("COUNTUNIQUE"),(...n)=>{const i=new Set,s=new Set;for(const o of n)o instanceof J?s.add(o.type):o!==""&&i.add(o);return i.size+s.size})}}aT.implementedFunctions={COUNTUNIQUE:{method:"countunique",parameters:[{argumentType:z.SCALAR}],repeatLastArgs:1,expandRanges:!0}};class lT extends At{constructor(){super(...arguments),this.isoweeknumCore=e=>{const t=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e)),n=this.dateTimeHelper.numberToSimpleDate(e),i=this.dateTimeHelper.dateToNumber({year:n.year,month:1,day:1}),s=this.dateTimeHelper.relativeNumberToAbsoluteNumber(i),o=s+((4-s)%7+7)%7,a=Math.floor((t-1)/7)-Math.floor((o-1)/7)+1;return a===0?this.isoweeknumCore(e-7)+1:a},this.days360Core=(e,t,n)=>{const i=this.dateTimeHelper.numberToSimpleDate(e),s=this.dateTimeHelper.numberToSimpleDate(t);let o,a;return n?(o=$1(i),a=$1(s)):[o,a]=this.dateTimeHelper.toBasisUS(i,s),360*(a.year-o.year)+30*(a.month-o.month)+a.day-o.day}}date(e,t){return this.runFunction(e.args,t,this.metadata("DATE"),(n,i,s)=>{const o=Math.trunc(s);let a=Math.trunc(i),l=Math.trunc(n);l<this.dateTimeHelper.getEpochYearZero()&&(l+=this.dateTimeHelper.getEpochYearZero());const u=Math.floor((a-1)/12);l+=u,a-=u*12;const c={year:l,month:a,day:1};if(this.dateTimeHelper.isValidDate(c)){let d=this.dateTimeHelper.dateToNumber(c)+(o-1);return d=this.dateTimeHelper.getWithinBounds(d),d===void 0?new J(te.NUM,ue.DateBounds):d}return new J(te.VALUE,ue.InvalidDate)})}time(e,t){return this.runFunction(e.args,t,this.metadata("TIME"),(n,i,s)=>{const o=Kl({hours:Math.trunc(n),minutes:Math.trunc(i),seconds:Math.trunc(s)});return o<0?new J(te.NUM,ue.NegativeTime):o%1})}eomonth(e,t){return this.runFunction(e.args,t,this.metadata("EOMONTH"),(n,i)=>{const s=this.dateTimeHelper.numberToSimpleDate(n);let o=this.dateTimeHelper.dateToNumber(this.dateTimeHelper.endOfMonth(j1(s,i)));return o=this.dateTimeHelper.getWithinBounds(o),o===void 0?new J(te.NUM,ue.DateBounds):o})}day(e,t){return this.runFunction(e.args,t,this.metadata("DAY"),n=>this.dateTimeHelper.numberToSimpleDate(n).day)}days(e,t){return this.runFunction(e.args,t,this.metadata("DAYS"),(n,i)=>Math.trunc(n)-Math.trunc(i))}month(e,t){return this.runFunction(e.args,t,this.metadata("MONTH"),n=>this.dateTimeHelper.numberToSimpleDate(n).month)}year(e,t){return this.runFunction(e.args,t,this.metadata("YEAR"),n=>this.dateTimeHelper.numberToSimpleDate(n).year)}hour(e,t){return this.runFunction(e.args,t,this.metadata("HOUR"),n=>Xl(Im(n)%1).hours)}minute(e,t){return this.runFunction(e.args,t,this.metadata("MINUTE"),n=>Xl(Im(n)%1).minutes)}second(e,t){return this.runFunction(e.args,t,this.metadata("SECOND"),n=>Xl(Im(n)%1).seconds)}text(e,t){return this.runFunction(e.args,t,this.metadata("TEXT"),(n,i)=>NO(n,i,this.config,this.dateTimeHelper))}weekday(e,t){return this.runFunction(e.args,t,this.metadata("WEEKDAY"),(n,i)=>{const s=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(n));if(i===3)return(s-1)%7;const o=nw.get(i);return o===void 0?new J(te.NUM,ue.BadMode):(s-o)%7+1})}weeknum(e,t){return this.runFunction(e.args,t,this.metadata("WEEKNUM"),(n,i)=>{const s=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(n)),o=this.dateTimeHelper.numberToSimpleDate(n),a=this.dateTimeHelper.dateToNumber({year:o.year,month:1,day:1}),l=this.dateTimeHelper.relativeNumberToAbsoluteNumber(a);if(i===21)return this.isoweeknumCore(n);const u=nw.get(i);return u===void 0?new J(te.NUM,ue.BadMode):Math.floor((s-u)/7)-Math.floor((l-u)/7)+1})}isoweeknum(e,t){return this.runFunction(e.args,t,this.metadata("ISOWEEKNUM"),this.isoweeknumCore)}datevalue(e,t){return this.runFunction(e.args,t,this.metadata("DATEVALUE"),n=>{const{dateTime:i}=this.dateTimeHelper.parseDateTimeFromConfigFormats(n);return i===void 0?new J(te.VALUE,ue.IncorrectDateTime):uc(i)?(LS(i)?Math.trunc(Kl(i)):0)+this.dateTimeHelper.dateToNumber(i):0})}timevalue(e,t){return this.runFunction(e.args,t,this.metadata("TIMEVALUE"),n=>{const i=this.dateTimeHelper.dateStringToDateNumber(n);return i===void 0?new J(te.VALUE,ue.IncorrectDateTime):He(i)%1})}now(e,t){return this.runFunction(e.args,t,this.metadata("NOW"),()=>{const n=new Date(Date.now());return Kl({hours:n.getHours(),minutes:n.getMinutes(),seconds:n.getSeconds()})+this.dateTimeHelper.dateToNumber({year:n.getFullYear(),month:n.getMonth()+1,day:n.getDate()})})}today(e,t){return this.runFunction(e.args,t,this.metadata("TODAY"),()=>{const n=new Date(Date.now());return this.dateTimeHelper.dateToNumber({year:n.getFullYear(),month:n.getMonth()+1,day:n.getDate()})})}edate(e,t){return this.runFunction(e.args,t,this.metadata("EDATE"),(n,i)=>{const s=this.dateTimeHelper.numberToSimpleDate(n),o=EO(j1(s,i));let a=this.dateTimeHelper.dateToNumber(o);return a=this.dateTimeHelper.getWithinBounds(a),a===void 0?new J(te.NUM,ue.DateBounds):a})}datedif(e,t){return this.runFunction(e.args,t,this.metadata("DATEDIF"),(n,i,s)=>{if(n>i)return new J(te.NUM,ue.StartEndDate);if(s==="D")return Math.floor(i)-Math.floor(n);const o=this.dateTimeHelper.numberToSimpleDate(n),a=this.dateTimeHelper.numberToSimpleDate(i);switch(s){case"M":return(a.year-o.year)*12+(a.month-o.month)-(a.day<o.day?1:0);case"YM":return(12+(a.month-o.month)-(a.day<o.day?1:0))%12;case"Y":return a.month>o.month||a.month===o.month&&a.day>=o.day?a.year-o.year:a.year-o.year-1;case"MD":if(a.day>=o.day)return a.day-o.day;{const l=a.month===1?12:a.month-1,u=a.month===1?a.year-1:a.year;return this.dateTimeHelper.daysInMonth(u,l)+a.day-o.day}case"YD":return a.month>o.month||a.month===o.month&&a.day>=o.day?Math.floor(i)-this.dateTimeHelper.dateToNumber({year:a.year,month:o.month,day:o.day}):Math.floor(i)-Math.floor(n)-365*(a.year-o.year-1)-this.dateTimeHelper.leapYearsCount(a.year-1)+this.dateTimeHelper.leapYearsCount(o.year);default:return new J(te.NUM,ue.BadMode)}})}days360(e,t){return this.runFunction(e.args,t,this.metadata("DAYS360"),this.days360Core)}yearfrac(e,t){return this.runFunction(e.args,t,this.metadata("YEARFRAC"),(n,i,s)=>{switch(n=Math.trunc(n),i=Math.trunc(i),n>i&&([n,i]=[i,n]),s){case 0:return this.days360Core(n,i,!1)/360;case 1:return(i-n)/this.dateTimeHelper.yearLengthForBasis(this.dateTimeHelper.numberToSimpleDate(n),this.dateTimeHelper.numberToSimpleDate(i));case 2:return(i-n)/360;case 3:return(i-n)/365;case 4:return this.days360Core(n,i,!0)/360}throw new Error("Should not be reachable.")})}interval(e,t){return this.runFunction(e.args,t,this.metadata("INTERVAL"),n=>{n=Math.trunc(n);const i=n%60;n=Math.trunc(n/60);const s=n%60;n=Math.trunc(n/60);const o=n%24;n=Math.trunc(n/24);const a=n%30;n=Math.trunc(n/30);const l=n%12,u=Math.trunc(n/12);return"P"+(u>0?`${u}Y`:"")+(l>0?`${l}M`:"")+(a>0?`${a}D`:"")+"T"+(o>0?`${o}H`:"")+(s>0?`${s}M`:"")+(i>0?`${i}S`:"")})}networkdays(e,t){return this.runFunction(e.args,t,this.metadata("NETWORKDAYS"),(n,i,s)=>this.networkdayscore(n,i,1,s))}networkdaysintl(e,t){return this.runFunction(e.args,t,this.metadata("NETWORKDAYS.INTL"),(n,i,s,o)=>this.networkdayscore(n,i,s,o))}workday(e,t){return this.runFunction(e.args,t,this.metadata("WORKDAY"),(n,i,s)=>this.workdaycore(n,i,1,s))}workdayintl(e,t){return this.runFunction(e.args,t,this.metadata("WORKDAY.INTL"),(n,i,s,o)=>this.workdaycore(n,i,s,o))}networkdayscore(e,t,n,i){e=Math.trunc(e),t=Math.trunc(t);let s=1;e>t&&([e,t]=[t,e],s=-1);const o=rw(n);if(o instanceof J)return o;const a=this.simpleRangeToFilteredHolidays(o,i);return a instanceof J?a:s*this.countWorkdays(e,t,o,a)}workdaycore(e,t,n,i){e=Math.trunc(e),t=Math.trunc(t);const s=rw(n);if(s instanceof J)return s;const o=this.simpleRangeToFilteredHolidays(s,i);if(o instanceof J)return o;if(t>0){let a=1;for(;this.countWorkdays(e+1,e+a,s,o)<t;)a*=2;let l=1;for(;l+1<a;){const u=Math.trunc((l+a)/2);this.countWorkdays(e+1,e+u,s,o)<t?l=u:a=u}return e+a}else if(t<0){t*=-1;let a=1;for(;this.countWorkdays(e-a,e-1,s,o)<t;)a*=2;let l=1;for(;l+1<a;){const u=Math.trunc((l+a)/2);this.countWorkdays(e-u,e-1,s,o)<t?l=u:a=u}return e-a}else return e}countWorkdays(e,t,n,i){const s=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(t)),o=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e));let a=0;for(let l=0;l<7;l++)n.charAt(l)==="0"&&(a+=Math.floor((s+6-l)/7),a-=Math.floor((o-1+6-l)/7));return a-=tw(t+1,i)-tw(e,i),a}simpleRangeToFilteredHolidays(e,t){var n;const i=(n=t?.valuesFromTopLeftCorner())!==null&&n!==void 0?n:[];for(const o of i)if(o instanceof J)return o;const s=[];for(const o of i)if(o!==It)if(Qt(o))s.push(Math.trunc(He(o)));else return new J(te.VALUE,ue.WrongType);return[...new Set(s)].sort((o,a)=>o-a).filter(o=>{const l=(this.dateTimeHelper.relativeNumberToAbsoluteNumber(o)-1)%7;return e.charAt(l)==="0"})}}lT.implementedFunctions={DATE:{method:"date",parameters:[{argumentType:z.NUMBER},{argumentType:z.NUMBER},{argumentType:z.NUMBER}],returnNumberType:Qe.NUMBER_DATE},TIME:{method:"time",parameters:[{argumentType:z.NUMBER},{argumentType:z.NUMBER},{argumentType:z.NUMBER}],returnNumberType:Qe.NUMBER_TIME},MONTH:{method:"month",parameters:[{argumentType:z.NUMBER,minValue:0}]},YEAR:{method:"year",parameters:[{argumentType:z.NUMBER,minValue:0}]},HOUR:{method:"hour",parameters:[{argumentType:z.NUMBER,minValue:0}]},MINUTE:{method:"minute",parameters:[{argumentType:z.NUMBER,minValue:0}]},SECOND:{method:"second",parameters:[{argumentType:z.NUMBER,minValue:0}]},TEXT:{method:"text",parameters:[{argumentType:z.NUMBER},{argumentType:z.STRING}]},EOMONTH:{method:"eomonth",parameters:[{argumentType:z.NUMBER,minValue:0},{argumentType:z.NUMBER}],returnNumberType:Qe.NUMBER_DATE},DAY:{method:"day",parameters:[{argumentType:z.NUMBER,minValue:0}]},DAYS:{method:"days",parameters:[{argumentType:z.NUMBER,minValue:0},{argumentType:z.NUMBER,minValue:0}]},WEEKDAY:{method:"weekday",parameters:[{argumentType:z.NUMBER,minValue:0},{argumentType:z.NUMBER,defaultValue:1}]},WEEKNUM:{method:"weeknum",parameters:[{argumentType:z.NUMBER,minValue:0},{argumentType:z.NUMBER,defaultValue:1}]},ISOWEEKNUM:{method:"isoweeknum",parameters:[{argumentType:z.NUMBER,minValue:0}]},DATEVALUE:{method:"datevalue",parameters:[{argumentType:z.STRING}],returnNumberType:Qe.NUMBER_DATE},TIMEVALUE:{method:"timevalue",parameters:[{argumentType:z.STRING}],returnNumberType:Qe.NUMBER_TIME},NOW:{method:"now",parameters:[],isVolatile:!0,returnNumberType:Qe.NUMBER_DATETIME},TODAY:{method:"today",parameters:[],isVolatile:!0,returnNumberType:Qe.NUMBER_DATE},EDATE:{method:"edate",parameters:[{argumentType:z.NUMBER,minValue:0},{argumentType:z.NUMBER}],returnNumberType:Qe.NUMBER_DATE},DAYS360:{method:"days360",parameters:[{argumentType:z.NUMBER,minValue:0},{argumentType:z.NUMBER,minValue:0},{argumentType:z.BOOLEAN,defaultValue:!1}]},DATEDIF:{method:"datedif",parameters:[{argumentType:z.NUMBER,minValue:0},{argumentType:z.NUMBER,minValue:0},{argumentType:z.STRING}]},YEARFRAC:{method:"yearfrac",parameters:[{argumentType:z.NUMBER,minValue:0},{argumentType:z.NUMBER,minValue:0},{argumentType:z.INTEGER,defaultValue:0,minValue:0,maxValue:4}]},INTERVAL:{method:"interval",parameters:[{argumentType:z.NUMBER,minValue:0}]},NETWORKDAYS:{method:"networkdays",parameters:[{argumentType:z.NUMBER,minValue:0},{argumentType:z.NUMBER,minValue:0},{argumentType:z.RANGE,optionalArg:!0}]},"NETWORKDAYS.INTL":{method:"networkdaysintl",parameters:[{argumentType:z.NUMBER,minValue:0},{argumentType:z.NUMBER,minValue:0},{argumentType:z.NOERROR,defaultValue:1},{argumentType:z.RANGE,optionalArg:!0}]},WORKDAY:{method:"workday",parameters:[{argumentType:z.NUMBER,minValue:0},{argumentType:z.NUMBER},{argumentType:z.RANGE,optionalArg:!0}]},"WORKDAY.INTL":{method:"workdayintl",parameters:[{argumentType:z.NUMBER,minValue:0},{argumentType:z.NUMBER},{argumentType:z.NOERROR,defaultValue:1},{argumentType:z.RANGE,optionalArg:!0}]}};function tw(r,e){if(e.length===0||r<=e[0])return 0;if(e[e.length-1]<r)return e.length;let t=0,n=e.length-1;for(;t+1<n;){const i=Math.floor((n+t)/2);e[i]>=r?n=i:t=i}return n}function rw(r){var e;return typeof r!="number"&&typeof r!="string"?new J(te.VALUE,ue.WrongType):typeof r=="string"?r.length!==7||!/^(0|1)*$/.test(r)||r==="1111111"?new J(te.NUM,ue.WeekendString):r:(e=zI.get(r))!==null&&e!==void 0?e:new J(te.NUM,ue.BadMode)}const nw=new Map([[1,0],[2,1],[11,1],[12,2],[13,3],[14,4],[15,5],[16,6],[17,0]]),zI=new Map([[1,"0000011"],[2,"1000001"],[3,"1100000"],[4,"0110000"],[5,"0011000"],[6,"0001100"],[7,"0000110"],[11,"0000001"],[12,"1000000"],[13,"0100000"],[14,"0010000"],[15,"0001000"],[16,"0000100"],[17,"0000010"]]);class uT extends At{degrees(e,t){return this.runFunction(e.args,t,this.metadata("DEGREES"),n=>n*(180/Math.PI))}}uT.implementedFunctions={DEGREES:{method:"degrees",parameters:[{argumentType:z.NUMBER}]}};class cT extends At{delta(e,t){return this.runFunction(e.args,t,this.metadata("DELTA"),(n,i)=>n===i?1:0)}}cT.implementedFunctions={DELTA:{method:"delta",parameters:[{argumentType:z.NUMBER},{argumentType:z.NUMBER,defaultValue:0}]}};class hT extends At{exp(e,t){return this.runFunction(e.args,t,this.metadata("EXP"),Math.exp)}}hT.implementedFunctions={EXP:{method:"exp",parameters:[{argumentType:z.NUMBER}]}};class dT extends At{pmt(e,t){return this.runFunction(e.args,t,this.metadata("PMT"),Wy)}ipmt(e,t){return this.runFunction(e.args,t,this.metadata("IPMT"),Zg)}ppmt(e,t){return this.runFunction(e.args,t,this.metadata("PPMT"),iw)}fv(e,t){return this.runFunction(e.args,t,this.metadata("FV"),Qg)}cumipmt(e,t){return this.runFunction(e.args,t,this.metadata("CUMIPMT"),(n,i,s,o,a,l)=>{if(o>a)return new J(te.NUM,ue.EndStartPeriod);let u=0;for(let c=o;c<=a;c++)u+=Zg(n,c,i,s,0,l);return u})}cumprinc(e,t){return this.runFunction(e.args,t,this.metadata("CUMPRINC"),(n,i,s,o,a,l)=>{if(o>a)return new J(te.NUM,ue.EndStartPeriod);let u=0;for(let c=o;c<=a;c++)u+=iw(n,c,i,s,0,l);return u})}db(e,t){return this.runFunction(e.args,t,this.metadata("DB"),(n,i,s,o,a)=>{if(a===12&&o>s||o>s+1)return new J(te.NUM,ue.PeriodLong);if(i>=n)return 0;const l=Math.round((1-Math.pow(i/n,1/s))*1e3)/1e3,u=n*l*a/12;if(o===1)return u;let c=u;for(let d=0;d<o-2;d++)c+=(n-c)*l;return o===s+1?(n-c)*l*(12-a)/12:(n-c)*l})}ddb(e,t){return this.runFunction(e.args,t,this.metadata("DDB"),(n,i,s,o,a)=>{if(o>s)return new J(te.NUM);let l=a/s,u;l>=1?(l=1,o===1?u=n:u=0):u=n*Math.pow(1-l,o-1);const c=n*Math.pow(1-l,o);return Math.max(u-Math.max(i,c),0)})}dollarde(e,t){return this.runFunction(e.args,t,this.metadata("DOLLARDE"),(n,i)=>{if(i<1)return new J(te.DIV_BY_ZERO);for(i=Math.trunc(i);i>10;)i/=10;return Math.trunc(n)+(n-Math.trunc(n))*10/i})}dollarfr(e,t){return this.runFunction(e.args,t,this.metadata("DOLLARFR"),(n,i)=>{if(i<1)return new J(te.DIV_BY_ZERO);for(i=Math.trunc(i);i>10;)i/=10;return Math.trunc(n)+(n-Math.trunc(n))*i/10})}effect(e,t){return this.runFunction(e.args,t,this.metadata("EFFECT"),(n,i)=>(i=Math.trunc(i),Math.pow(1+n/i,i)-1))}ispmt(e,t){return this.runFunction(e.args,t,this.metadata("ISPMT"),(n,i,s,o)=>s===0?new J(te.DIV_BY_ZERO):o*n*(i/s-1))}nominal(e,t){return this.runFunction(e.args,t,this.metadata("NOMINAL"),(n,i)=>(i=Math.trunc(i),(Math.pow(n+1,1/i)-1)*i))}nper(e,t){return this.runFunction(e.args,t,this.metadata("NPER"),(n,i,s,o,a)=>n===0?i===0?new J(te.DIV_BY_ZERO):(-s-o)/i:(a&&(i*=1+n),Math.log((i-o*n)/(s*n+i))/Math.log(1+n)))}rate(e,t){return this.runFunction(e.args,t,this.metadata("RATE"),(n,i,s,o,a,l)=>{if(l<=-1)return new J(te.VALUE);const u=1e-7,c=50;let d=l;a=a?1:0;for(let h=0;h<c;h++){if(d<=-1)return new J(te.NUM);let f;if(Math.abs(d)<u)f=s*(1+n*d)+i*(1+d*a)*n+o;else{const p=Math.pow(1+d,n);f=s*p+i*(1/d+a)*(p-1)+o}if(Math.abs(f)<u)return d;let m;if(Math.abs(d)<u)m=s*n+i*a*n;else{const p=Math.pow(1+d,n),g=n*Math.pow(1+d,n-1);m=s*g+i*(1/d+a)*g+i*(-1/(d*d))*(p-1)}d-=f/m}return new J(te.NUM)})}pv(e,t){return this.runFunction(e.args,t,this.metadata("PV"),(n,i,s,o,a)=>(a=a?1:0,n===-1?i===0?new J(te.NUM):new J(te.DIV_BY_ZERO):n===0?-s*i-o:((1-Math.pow(1+n,i))*s*(1+n*a)/n-o)/Math.pow(1+n,i)))}rri(e,t){return this.runFunction(e.args,t,this.metadata("RRI"),(n,i,s)=>i===0||s<0&&i>0||s>0&&i<0?new J(te.NUM):Math.pow(s/i,1/n)-1)}sln(e,t){return this.runFunction(e.args,t,this.metadata("SLN"),(n,i,s)=>s===0?new J(te.DIV_BY_ZERO):(n-i)/s)}syd(e,t){return this.runFunction(e.args,t,this.metadata("SYD"),(n,i,s,o)=>o>s?new J(te.NUM):(n-i)*(s-o+1)*2/(s*(s+1)))}tbilleq(e,t){return this.runFunction(e.args,t,this.metadata("TBILLEQ"),(n,i,s)=>{if(n=Math.round(n),i=Math.round(i),n>=i)return new J(te.NUM);const o=this.dateTimeHelper.numberToSimpleDate(n),a=this.dateTimeHelper.numberToSimpleDate(i);if(a.year>o.year+1||a.year===o.year+1&&(a.month>o.month||a.month===o.month&&a.day>o.day))return new J(te.NUM);const l=360-s*(i-n);return l===0?0:l<0?new J(te.NUM):365*s/l})}tbillprice(e,t){return this.runFunction(e.args,t,this.metadata("TBILLPRICE"),(n,i,s)=>{if(n=Math.round(n),i=Math.round(i),n>=i)return new J(te.NUM);const o=this.dateTimeHelper.numberToSimpleDate(n),a=this.dateTimeHelper.numberToSimpleDate(i);if(a.year>o.year+1||a.year===o.year+1&&(a.month>o.month||a.month===o.month&&a.day>o.day))return new J(te.NUM);const l=360-s*(i-n);return l===0?0:l<0?new J(te.NUM):100*(1-s*(i-n)/360)})}tbillyield(e,t){return this.runFunction(e.args,t,this.metadata("TBILLYIELD"),(n,i,s)=>{if(n=Math.round(n),i=Math.round(i),n>=i)return new J(te.NUM);const o=this.dateTimeHelper.numberToSimpleDate(n),a=this.dateTimeHelper.numberToSimpleDate(i);return a.year>o.year+1||a.year===o.year+1&&(a.month>o.month||a.month===o.month&&a.day>o.day)?new J(te.NUM):(100-s)*360/(s*(i-n))})}fvschedule(e,t){return this.runFunction(e.args,t,this.metadata("FVSCHEDULE"),(n,i)=>{const s=i.valuesFromTopLeftCorner();for(const o of s)if(o instanceof J)return o;for(const o of s)if(Qt(o))n*=1+He(o);else if(o!==It)return new J(te.VALUE,ue.NumberExpected);return n})}npv(e,t){return this.runFunction(e.args,t,this.metadata("NPV"),(n,...i)=>{const s=this.arithmeticHelper.coerceNumbersExactRanges(i);return s instanceof J?s:Fm(n,s)})}mirr(e,t){return this.runFunction(e.args,t,this.metadata("MIRR"),(n,i,s)=>{const o=this.arithmeticHelper.manyToExactNumbers(n.valuesFromTopLeftCorner());if(o instanceof J)return o;let a=!1,l=!1;const u=[],c=[];for(const m of o)m>0?(a=!0,u.push(m),c.push(0)):m<0?(l=!0,c.push(m),u.push(0)):(c.push(0),u.push(0));if(!a||!l)return new J(te.DIV_BY_ZERO);const d=o.length,h=Fm(s,u);if(h instanceof J)return h;const f=Fm(i,c);return f instanceof J?f:Math.pow(-h*Math.pow(1+s,d)/f/(1+i),1/(d-1))-1})}pduration(e,t){return this.runFunction(e.args,t,this.metadata("PDURATION"),(n,i,s)=>(Math.log(s)-Math.log(i))/Math.log(1+n))}xnpv(e,t){return this.runFunction(e.args,t,this.metadata("XNPV"),(n,i,s)=>{const o=i.valuesFromTopLeftCorner();for(const h of o)if(typeof h!="number")return new J(te.VALUE,ue.NumberExpected);const a=o,l=s.valuesFromTopLeftCorner();for(const h of l)if(typeof h!="number")return new J(te.VALUE,ue.NumberExpected);const u=l;if(u.length!==a.length)return new J(te.NUM,ue.EqualLength);const c=u.length;let d=0;if(u[0]<0)return new J(te.NUM,ue.ValueSmall);for(let h=0;h<c;h++){if(u[h]=Math.floor(u[h]),u[h]<u[0])return new J(te.NUM,ue.ValueSmall);d+=a[h]/Math.pow(1+n,(u[h]-u[0])/365)}return d})}}dT.implementedFunctions={PMT:{method:"pmt",parameters:[{argumentType:z.NUMBER},{argumentType:z.NUMBER},{argumentType:z.NUMBER},{argumentType:z.NUMBER,defaultValue:0},{argumentType:z.NUMBER,defaultValue:0}],returnNumberType:Qe.NUMBER_CURRENCY},IPMT:{method:"ipmt",parameters:[{argumentType:z.NUMBER},{argumentType:z.NUMBER},{argumentType:z.NUMBER},{argumentType:z.NUMBER},{argumentType:z.NUMBER,defaultValue:0},{argumentType:z.NUMBER,defaultValue:0}],returnNumberType:Qe.NUMBER_CURRENCY},PPMT:{method:"ppmt",parameters:[{argumentType:z.NUMBER},{argumentType:z.NUMBER},{argumentType:z.NUMBER},{argumentType:z.NUMBER},{argumentType:z.NUMBER,defaultValue:0},{argumentType:z.NUMBER,defaultValue:0}],returnNumberType:Qe.NUMBER_CURRENCY},FV:{method:"fv",parameters:[{argumentType:z.NUMBER},{argumentType:z.NUMBER},{argumentType:z.NUMBER},{argumentType:z.NUMBER,defaultValue:0},{argumentType:z.NUMBER,defaultValue:0}],returnNumberType:Qe.NUMBER_CURRENCY},CUMIPMT:{method:"cumipmt",parameters:[{argumentType:z.NUMBER,greaterThan:0},{argumentType:z.NUMBER,greaterThan:0},{argumentType:z.NUMBER,greaterThan:0},{argumentType:z.INTEGER,minValue:1},{argumentType:z.INTEGER,minValue:1},{argumentType:z.INTEGER,minValue:0,maxValue:1}],returnNumberType:Qe.NUMBER_CURRENCY},CUMPRINC:{method:"cumprinc",parameters:[{argumentType:z.NUMBER,greaterThan:0},{argumentType:z.NUMBER,greaterThan:0},{argumentType:z.NUMBER,greaterThan:0},{argumentType:z.INTEGER,minValue:1},{argumentType:z.INTEGER,minValue:1},{argumentType:z.INTEGER,minValue:0,maxValue:1}],returnNumberType:Qe.NUMBER_CURRENCY},DB:{method:"db",parameters:[{argumentType:z.NUMBER,minValue:0},{argumentType:z.NUMBER,minValue:0},{argumentType:z.INTEGER,minValue:0},{argumentType:z.INTEGER,minValue:0},{argumentType:z.INTEGER,minValue:1,maxValue:12,defaultValue:12}],returnNumberType:Qe.NUMBER_CURRENCY},DDB:{method:"ddb",parameters:[{argumentType:z.NUMBER,minValue:0},{argumentType:z.NUMBER,minValue:0},{argumentType:z.INTEGER,minValue:0},{argumentType:z.NUMBER,minValue:0},{argumentType:z.NUMBER,greaterThan:0,defaultValue:2}],returnNumberType:Qe.NUMBER_CURRENCY},DOLLARDE:{method:"dollarde",parameters:[{argumentType:z.NUMBER},{argumentType:z.NUMBER,minValue:0}]},DOLLARFR:{method:"dollarfr",parameters:[{argumentType:z.NUMBER},{argumentType:z.NUMBER,minValue:0}]},EFFECT:{method:"effect",parameters:[{argumentType:z.NUMBER,minValue:0},{argumentType:z.NUMBER,minValue:1}],returnNumberType:Qe.NUMBER_PERCENT},ISPMT:{method:"ispmt",parameters:[{argumentType:z.NUMBER},{argumentType:z.NUMBER},{argumentType:z.NUMBER},{argumentType:z.NUMBER}]},NOMINAL:{method:"nominal",parameters:[{argumentType:z.NUMBER,minValue:0},{argumentType:z.NUMBER,minValue:1}],returnNumberType:Qe.NUMBER_PERCENT},NPER:{method:"nper",parameters:[{argumentType:z.NUMBER},{argumentType:z.NUMBER},{argumentType:z.NUMBER},{argumentType:z.NUMBER,defaultValue:0},{argumentType:z.NUMBER,defaultValue:0}]},PV:{method:"pv",parameters:[{argumentType:z.NUMBER},{argumentType:z.NUMBER},{argumentType:z.NUMBER},{argumentType:z.NUMBER,defaultValue:0},{argumentType:z.NUMBER,defaultValue:0}],returnNumberType:Qe.NUMBER_CURRENCY},RATE:{method:"rate",parameters:[{argumentType:z.NUMBER,greaterThan:0},{argumentType:z.NUMBER},{argumentType:z.NUMBER},{argumentType:z.NUMBER,defaultValue:0},{argumentType:z.NUMBER,defaultValue:0},{argumentType:z.NUMBER,defaultValue:.1}],returnNumberType:Qe.NUMBER_PERCENT},RRI:{method:"rri",parameters:[{argumentType:z.NUMBER,greaterThan:0},{argumentType:z.NUMBER},{argumentType:z.NUMBER}],returnNumberType:Qe.NUMBER_PERCENT},SLN:{method:"sln",parameters:[{argumentType:z.NUMBER},{argumentType:z.NUMBER},{argumentType:z.NUMBER}],returnNumberType:Qe.NUMBER_CURRENCY},SYD:{method:"syd",parameters:[{argumentType:z.NUMBER},{argumentType:z.NUMBER},{argumentType:z.NUMBER,greaterThan:0},{argumentType:z.NUMBER,greaterThan:0}],returnNumberType:Qe.NUMBER_CURRENCY},TBILLEQ:{method:"tbilleq",parameters:[{argumentType:z.NUMBER,minValue:0},{argumentType:z.NUMBER,minValue:0},{argumentType:z.NUMBER,greaterThan:0}],returnNumberType:Qe.NUMBER_PERCENT},TBILLPRICE:{method:"tbillprice",parameters:[{argumentType:z.NUMBER,minValue:0},{argumentType:z.NUMBER,minValue:0},{argumentType:z.NUMBER,greaterThan:0}],returnNumberType:Qe.NUMBER_CURRENCY},TBILLYIELD:{method:"tbillyield",parameters:[{argumentType:z.NUMBER,minValue:0},{argumentType:z.NUMBER,minValue:0},{argumentType:z.NUMBER,greaterThan:0}],returnNumberType:Qe.NUMBER_PERCENT},FVSCHEDULE:{method:"fvschedule",parameters:[{argumentType:z.NUMBER},{argumentType:z.RANGE}],returnNumberType:Qe.NUMBER_CURRENCY},NPV:{method:"npv",parameters:[{argumentType:z.NUMBER},{argumentType:z.ANY}],repeatLastArgs:1,returnNumberType:Qe.NUMBER_CURRENCY},MIRR:{method:"mirr",parameters:[{argumentType:z.RANGE},{argumentType:z.NUMBER},{argumentType:z.NUMBER}],returnNumberType:Qe.NUMBER_PERCENT},PDURATION:{method:"pduration",parameters:[{argumentType:z.NUMBER,greaterThan:0},{argumentType:z.NUMBER,greaterThan:0},{argumentType:z.NUMBER,greaterThan:0}]},XNPV:{method:"xnpv",parameters:[{argumentType:z.NUMBER,greaterThan:-1},{argumentType:z.RANGE},{argumentType:z.RANGE}]}};function Wy(r,e,t,n,i){if(r===0)return(-t-n)/e;{const s=Math.pow(1+r,e);return(n*r+t*r*s)*(i?1/(1+r):1)/(1-s)}}function Zg(r,e,t,n,i,s){const o=Wy(r,t,n,i,s);return e===1?r*(s?0:-n):r*(s?Qg(r,e-2,o,n,s)-o:Qg(r,e-1,o,n,s))}function Qg(r,e,t,n,i){if(r===0)return-n-t*e;{const s=Math.pow(1+r,e);return t*(i?1+r:1)*(1-s)/r-n*s}}function iw(r,e,t,n,i,s){return Wy(r,t,n,i,s)-Zg(r,e,t,n,i,s)}function Fm(r,e){let t=0;for(let n=e.length-1;n>=0;n--){if(t+=e[n],r===-1){if(t===0)continue;return new J(te.DIV_BY_ZERO)}t/=1+r}return t}class fT extends At{formulatext(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("FORMULATEXT"),()=>new J(te.NA,ue.WrongArgNumber),n=>{var i;return(i=this.serialization.getCellFormula(n))!==null&&i!==void 0?i:new J(te.NA,ue.Formula)})}}fT.implementedFunctions={FORMULATEXT:{method:"formulatext",parameters:[{argumentType:z.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,isDependentOnSheetStructureChange:!0,vectorizationForbidden:!0}};class pT extends At{hyperlink(e,t){return this.runFunction(e.args,t,this.metadata("HYPERLINK"),(n,i)=>(e.hyperlink=n,i??n))}}pT.implementedFunctions={HYPERLINK:{method:"hyperlink",parameters:[{argumentType:z.STRING},{argumentType:z.STRING,optionalArg:!0}]}};class mT extends At{isbinary(e,t){return this.runFunction(e.args,t,this.metadata("ISBINARY"),n=>/^[01]{1,10}$/.test(n))}iserr(e,t){return this.runFunction(e.args,t,this.metadata("ISERR"),n=>n instanceof J&&n.type!==te.NA)}iserror(e,t){return this.runFunction(e.args,t,this.metadata("ISERROR"),n=>n instanceof J)}isformula(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("ISFORMULA"),()=>new J(te.NA,ue.WrongArgNumber),n=>this.dependencyGraph.addressMapping.getCell(n)instanceof ni)}isblank(e,t){return this.runFunction(e.args,t,this.metadata("ISBLANK"),n=>n===It)}isna(e,t){return this.runFunction(e.args,t,this.metadata("ISNA"),n=>n instanceof J&&n.type==te.NA)}isnumber(e,t){return this.runFunction(e.args,t,this.metadata("ISNUMBER"),Qt)}islogical(e,t){return this.runFunction(e.args,t,this.metadata("ISLOGICAL"),n=>typeof n=="boolean")}isref(e,t){return this.runFunction(e.args,t,this.metadata("ISREF"),n=>n instanceof J&&(n.type==te.REF||n.type==te.CYCLE))}istext(e,t){return this.runFunction(e.args,t,this.metadata("ISTEXT"),n=>typeof n=="string")}isnontext(e,t){return this.runFunction(e.args,t,this.metadata("ISNONTEXT"),n=>typeof n!="string")}column(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("COLUMN"),()=>t.formulaAddress.col+1,n=>n.col+1)}columns(e,t){if(e.args.length!==1)return new J(te.NA,ue.WrongArgNumber);if(e.args.some(i=>i.type===oe.EMPTY))return new J(te.NUM,ue.EmptyArg);let n=e.args[0];for(;n.type===oe.PARENTHESIS;)n=n.expression;if(n.type===oe.CELL_RANGE||n.type===oe.COLUMN_RANGE)return n.end.col-n.start.col+1;if(n.type===oe.CELL_REFERENCE)return 1;if(n.type===oe.ROW_RANGE)return this.config.maxColumns;{const i=this.evaluateAst(n,t);return i instanceof Ge?i.width():i instanceof J?i:1}}row(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("ROW"),()=>t.formulaAddress.row+1,n=>n.row+1)}rows(e,t){if(e.args.length!==1)return new J(te.NA,ue.WrongArgNumber);if(e.args.some(i=>i.type===oe.EMPTY))return new J(te.NUM,ue.EmptyArg);let n=e.args[0];for(;n.type===oe.PARENTHESIS;)n=n.expression;if(n.type===oe.CELL_RANGE||n.type===oe.ROW_RANGE)return n.end.row-n.start.row+1;if(n.type===oe.CELL_REFERENCE)return 1;if(n.type===oe.COLUMN_RANGE)return this.config.maxRows;{const i=this.evaluateAst(n,t);return i instanceof Ge?i.height():i instanceof J?i:1}}index(e,t){return this.runFunction(e.args,t,this.metadata("INDEX"),(n,i,s)=>{var o,a,l,u,c,d;return s<1||i<1?new J(te.VALUE,ue.LessThanOne):s>n.width()||i>n.height()?new J(te.NUM,ue.ValueLarge):(d=(l=(a=(o=n?.data)===null||o===void 0?void 0:o[i-1])===null||a===void 0?void 0:a[s-1])!==null&&l!==void 0?l:(c=(u=n?.data)===null||u===void 0?void 0:u[0])===null||c===void 0?void 0:c[0])!==null&&d!==void 0?d:new J(te.VALUE,ue.CellRangeExpected)})}na(e,t){return new J(te.NA)}sheet(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("SHEET"),()=>t.formulaAddress.sheet+1,n=>n.sheet+1,n=>{const i=this.dependencyGraph.sheetMapping.getSheetId(n);return i!==void 0?i+1:new J(te.NA,ue.SheetRef)})}sheets(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("SHEETS"),()=>this.dependencyGraph.sheetMapping.numberOfSheets(),()=>1,()=>new J(te.VALUE,ue.CellRefExpected))}}mT.implementedFunctions={COLUMN:{method:"column",parameters:[{argumentType:z.NOERROR,optionalArg:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},COLUMNS:{method:"columns",parameters:[{argumentType:z.RANGE}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ISBINARY:{method:"isbinary",parameters:[{argumentType:z.STRING}]},ISERR:{method:"iserr",parameters:[{argumentType:z.SCALAR}]},ISFORMULA:{method:"isformula",parameters:[{argumentType:z.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ISNA:{method:"isna",parameters:[{argumentType:z.SCALAR}]},ISREF:{method:"isref",parameters:[{argumentType:z.SCALAR}],vectorizationForbidden:!0},ISERROR:{method:"iserror",parameters:[{argumentType:z.SCALAR}]},ISBLANK:{method:"isblank",parameters:[{argumentType:z.SCALAR}]},ISNUMBER:{method:"isnumber",parameters:[{argumentType:z.SCALAR}]},ISLOGICAL:{method:"islogical",parameters:[{argumentType:z.SCALAR}]},ISTEXT:{method:"istext",parameters:[{argumentType:z.SCALAR}]},ISNONTEXT:{method:"isnontext",parameters:[{argumentType:z.SCALAR}]},INDEX:{method:"index",parameters:[{argumentType:z.RANGE},{argumentType:z.NUMBER},{argumentType:z.NUMBER,defaultValue:1}]},NA:{method:"na",parameters:[]},ROW:{method:"row",parameters:[{argumentType:z.NOERROR,optionalArg:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ROWS:{method:"rows",parameters:[{argumentType:z.RANGE}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},SHEET:{method:"sheet",parameters:[{argumentType:z.STRING}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},SHEETS:{method:"sheets",parameters:[{argumentType:z.STRING}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0}};class gT extends At{iseven(e,t){return this.runFunction(e.args,t,this.metadata("ISEVEN"),n=>n%2===0)}}gT.implementedFunctions={ISEVEN:{method:"iseven",parameters:[{argumentType:z.NUMBER}]}};class yT extends At{isodd(e,t){return this.runFunction(e.args,t,this.metadata("ISODD"),n=>n%2===1)}}yT.implementedFunctions={ISODD:{method:"isodd",parameters:[{argumentType:z.NUMBER}]}};class vT extends At{log10(e,t){return this.runFunction(e.args,t,this.metadata("LOG10"),Math.log10)}log(e,t){return this.runFunction(e.args,t,this.metadata("LOG"),(n,i)=>Math.log(n)/Math.log(i))}ln(e,t){return this.runFunction(e.args,t,this.metadata("LN"),Math.log)}}vT.implementedFunctions={LOG10:{method:"log10",parameters:[{argumentType:z.NUMBER}]},LOG:{method:"log",parameters:[{argumentType:z.NUMBER,greaterThan:0},{argumentType:z.NUMBER,defaultValue:10,greaterThan:0}]},LN:{method:"ln",parameters:[{argumentType:z.NUMBER}]}};const Jg=parseFloat(Math.PI.toFixed(14));class bT extends At{pi(e,t){return this.runFunction(e.args,t,this.metadata("PI"),()=>Jg)}sqrtpi(e,t){return this.runFunction(e.args,t,this.metadata("SQRTPI"),n=>Math.sqrt(Jg*n))}}bT.implementedFunctions={PI:{method:"pi",parameters:[]},SQRTPI:{method:"sqrtpi",parameters:[{argumentType:z.NUMBER,minValue:0}]}};function sw(r,e){return new Ct(e.width,r.height)}function Lm(r,e,t){return new Ct(1+(r.width-e)/t,1+(r.height-e)/t)}class wT extends At{mmult(e,t){return this.runFunction(e.args,t,this.metadata("MMULT"),(n,i)=>{if(!n.hasOnlyNumbers()||!i.hasOnlyNumbers())return new J(te.VALUE,ue.NumberRange);if(i.height()!==n.width())return new J(te.VALUE,ue.ArrayDimensions);const s=sw(n.size,i.size),o=this.createKernel(function(a,l,u){let c=0;for(let d=0;d<u;++d)c+=a[this.thread.y][d]*l[d][this.thread.x];return c},s)(n.rawNumbers(),i.rawNumbers(),n.width());return Ge.onlyNumbers(o)})}mmultArraySize(e,t){if(e.args.length!==2)return Ct.error();const n=this.metadata("MMULT"),i=e.args.map(a=>{var l;return this.arraySizeForAst(a,new Ls(t.formulaAddress,t.arraysFlag||((l=n?.enableArrayArithmeticForArguments)!==null&&l!==void 0?l:!1)))}),[s,o]=i;return sw(s,o)}maxpool(e,t){return this.runFunction(e.args,t,this.metadata("MAXPOOL"),(n,i,s=i)=>{if(!n.hasOnlyNumbers())return new J(te.VALUE,ue.NumberRange);const o=Lm(n.size,i,s),a=this.createKernel(function(l,u,c){const d=this.thread.x*c,h=this.thread.y*c;let f=l[h][d];for(let m=0;m<u;m++)for(let p=0;p<u;p++)f=Math.max(f,l[h+m][d+p]);return f},o)(n.rawNumbers(),i,s);return Ge.onlyNumbers(a)})}medianpool(e,t){return this.runFunction(e.args,t,this.metadata("MEDIANPOOL"),(n,i,s=i)=>{if(!n.hasOnlyNumbers())return new J(te.VALUE,ue.NumberRange);const o=Lm(n.size,i,s),a=this.createKernel(function(l,u,c){const d=this.thread.x*c,h=this.thread.y*c;let f=l[h][d];for(let b=0;b<u;b++)for(let E=0;E<u;E++)f=Math.max(f,l[h+b][d+E]);let m=l[h][d];for(let b=0;b<u;b++)for(let E=0;E<u;E++)m=Math.min(m,l[h+b][d+E]);const p=u*u;let g=m,v=f,y=42;for(let b=0;b<32;b++){const E=(g+v)/2;let A=0;for(let M=0;M<u;M++)for(let L=0;L<u;L++)l[h+M][d+L]>E&&A++;if(u%2===0)if(A===p/2){y=E;break}else A>p/2?g=E:v=E;else if(A===(p-1)/2){y=E;break}else A>(p-1)/2?g=E:v=E}return y},o)(n.rawNumbers(),i,s);return Ge.onlyNumbers(a)})}maxpoolArraySize(e,t){if(e.args.length<2||e.args.length>3)return Ct.error();const n=this.metadata("MAXPOOL"),s=e.args.map(u=>{var c;return this.arraySizeForAst(u,new Ls(t.formulaAddress,t.arraysFlag||((c=n?.enableArrayArithmeticForArguments)!==null&&c!==void 0?c:!1)))})[0],o=e.args[1];let a;o.type===oe.NUMBER?a=o.value:a=1;let l=a;if(e.args.length===3){const u=e.args[2];u.type===oe.NUMBER?l=u.value:l=1}return a>s.width||a>s.height||l>a||(s.width-a)%l!==0||(s.height-a)%l!==0?Ct.error():Lm(s,a,l)}medianpoolArraySize(e,t){return this.maxpoolArraySize(e,t)}transpose(e,t){return this.runFunction(e.args,t,this.metadata("TRANSPOSE"),n=>{const i=n.rawData(),s=n.size,o=[];for(let a=0;a<s.width;++a){o[a]=[];for(let l=0;l<s.height;++l)o[a][l]=i[l][a]}return Ge.onlyValues(o)})}transposeArraySize(e,t){if(e.args.length!==1)return Ct.error();const n=this.metadata("TRANSPOSE"),i=e.args.map(o=>{var a;return this.arraySizeForAst(o,new Ls(t.formulaAddress,t.arraysFlag||((a=n?.enableArrayArithmeticForArguments)!==null&&a!==void 0?a:!1)))}),[s]=i;return new Ct(s.height,s.width)}createKernel(e,t){return function(...n){const i=[];for(let s=0;s<t.height;++s){i.push([]);for(let o=0;o<t.width;++o)i[s][o]=e.apply({thread:{x:o,y:s}},n)}return i}}}wT.implementedFunctions={MMULT:{method:"mmult",sizeOfResultArrayMethod:"mmultArraySize",parameters:[{argumentType:z.RANGE},{argumentType:z.RANGE}],vectorizationForbidden:!0},TRANSPOSE:{method:"transpose",sizeOfResultArrayMethod:"transposeArraySize",parameters:[{argumentType:z.RANGE}],vectorizationForbidden:!0},MAXPOOL:{method:"maxpool",sizeOfResultArrayMethod:"maxpoolArraySize",parameters:[{argumentType:z.RANGE},{argumentType:z.NUMBER},{argumentType:z.NUMBER,optionalArg:!0}],vectorizationForbidden:!0},MEDIANPOOL:{method:"medianpool",sizeOfResultArrayMethod:"medianpoolArraySize",parameters:[{argumentType:z.RANGE},{argumentType:z.NUMBER},{argumentType:z.NUMBER,optionalArg:!0}],vectorizationForbidden:!0}};class _T extends At{median(e,t){return this.runFunction(e.args,t,this.metadata("MEDIAN"),(...n)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(n);return i instanceof J?i:i.length===0?new J(te.NUM,ue.OneValue):(i.sort((s,o)=>s-o),i.length%2===0?(i[i.length/2-1]+i[i.length/2])/2:i[Math.floor(i.length/2)])})}large(e,t){return this.runFunction(e.args,t,this.metadata("LARGE"),(n,i)=>{const s=this.arithmeticHelper.manyToExactNumbers(n.valuesFromTopLeftCorner());return s instanceof J?s:(s.sort((o,a)=>o-a),i=Math.trunc(i),i>s.length?new J(te.NUM,ue.ValueLarge):s[s.length-i])})}small(e,t){return this.runFunction(e.args,t,this.metadata("SMALL"),(n,i)=>{const s=this.arithmeticHelper.manyToExactNumbers(n.valuesFromTopLeftCorner());return s instanceof J?s:(s.sort((o,a)=>o-a),i=Math.trunc(i),i>s.length?new J(te.NUM,ue.ValueLarge):s[i-1])})}}_T.implementedFunctions={MEDIAN:{method:"median",parameters:[{argumentType:z.ANY}],repeatLastArgs:1},LARGE:{method:"large",parameters:[{argumentType:z.RANGE},{argumentType:z.NUMBER,minValue:1}]},SMALL:{method:"small",parameters:[{argumentType:z.RANGE},{argumentType:z.NUMBER,minValue:1}]}};class xT extends At{mod(e,t){return this.runFunction(e.args,t,this.metadata("MOD"),(n,i)=>i===0?new J(te.DIV_BY_ZERO):n%i)}}xT.implementedFunctions={MOD:{method:"mod",parameters:[{argumentType:z.NUMBER},{argumentType:z.NUMBER}]}};function Bh(r){return Qt(r)&&!Number.isFinite(He(r))?0:r}class Ji{constructor(e,t,n){this.sumsq=e,this.sum=t,this.count=n}static single(e){return new Ji(e*e,e,1)}compose(e){return new Ji(this.sumsq+e.sumsq,this.sum+e.sum,this.count+e.count)}averageValue(){if(this.count>0)return this.sum/this.count}varSValue(){if(this.count>1)return(this.sumsq-this.sum*this.sum/this.count)/(this.count-1)}varPValue(){if(this.count>0)return(this.sumsq-this.sum*this.sum/this.count)/this.count}}Ji.empty=new Ji(0,0,0);class Gy extends At{constructor(){super(...arguments),this.addWithEpsilonRaw=(e,t)=>this.arithmeticHelper.addWithEpsilonRaw(e,t)}sum(e,t){return this.doSum(e.args,t)}sumsq(e,t){return this.reduce(e.args,t,0,"SUMSQ",this.addWithEpsilonRaw,n=>Math.pow(He(n),2),Tl)}max(e,t){return this.doMax(e.args,t)}maxa(e,t){const n=this.reduce(e.args,t,Number.NEGATIVE_INFINITY,"MAXA",(i,s)=>Math.max(i,s),He,Uh);return Bh(n)}min(e,t){return this.doMin(e.args,t)}mina(e,t){const n=this.reduce(e.args,t,Number.POSITIVE_INFINITY,"MINA",(i,s)=>Math.min(i,s),He,Uh);return Bh(n)}count(e,t){return this.doCount(e.args,t)}counta(e,t){return this.doCounta(e.args,t)}average(e,t){return this.doAverage(e.args,t)}averagea(e,t){var n;const i=this.reduce(e.args,t,Ji.empty,"_AGGREGATE_A",(s,o)=>s.compose(o),s=>Ji.single(He(s)),Uh);return i instanceof J?i:(n=i.averageValue())!==null&&n!==void 0?n:new J(te.DIV_BY_ZERO)}vars(e,t){return this.doVarS(e.args,t)}varp(e,t){return this.doVarP(e.args,t)}vara(e,t){var n;const i=this.reduceAggregateA(e.args,t);return i instanceof J?i:(n=i.varSValue())!==null&&n!==void 0?n:new J(te.DIV_BY_ZERO)}varpa(e,t){var n;const i=this.reduceAggregateA(e.args,t);return i instanceof J?i:(n=i.varPValue())!==null&&n!==void 0?n:new J(te.DIV_BY_ZERO)}stdevs(e,t){return this.doStdevS(e.args,t)}stdevp(e,t){return this.doStdevP(e.args,t)}stdeva(e,t){const n=this.reduceAggregateA(e.args,t);if(n instanceof J)return n;{const i=n.varSValue();return i===void 0?new J(te.DIV_BY_ZERO):Math.sqrt(i)}}stdevpa(e,t){const n=this.reduceAggregateA(e.args,t);if(n instanceof J)return n;{const i=n.varPValue();return i===void 0?new J(te.DIV_BY_ZERO):Math.sqrt(i)}}product(e,t){return this.doProduct(e.args,t)}subtotal(e,t){if(e.args.length<2)return new J(te.NA,ue.WrongArgNumber);const n=this.coerceToType(this.evaluateAst(e.args[0],t),{argumentType:z.NUMBER},t),i=e.args.slice(1);switch(n){case 1:case 101:return this.doAverage(i,t);case 2:case 102:return this.doCount(i,t);case 3:case 103:return this.doCounta(i,t);case 4:case 104:return this.doMax(i,t);case 5:case 105:return this.doMin(i,t);case 6:case 106:return this.doProduct(i,t);case 7:case 107:return this.doStdevS(i,t);case 8:case 108:return this.doStdevP(i,t);case 9:case 109:return this.doSum(i,t);case 10:case 110:return this.doVarS(i,t);case 11:case 111:return this.doVarP(i,t);default:return new J(te.VALUE,ue.BadMode)}}reduceAggregate(e,t){return this.reduce(e,t,Ji.empty,"_AGGREGATE",(n,i)=>n.compose(i),n=>Ji.single(He(n)),Tl)}reduceAggregateA(e,t){return this.reduce(e,t,Ji.empty,"_AGGREGATE_A",(n,i)=>n.compose(i),n=>Ji.single(He(n)),Uh)}doAverage(e,t){var n;const i=this.reduceAggregate(e,t);return i instanceof J?i:(n=i.averageValue())!==null&&n!==void 0?n:new J(te.DIV_BY_ZERO)}doVarS(e,t){var n;const i=this.reduceAggregate(e,t);return i instanceof J?i:(n=i.varSValue())!==null&&n!==void 0?n:new J(te.DIV_BY_ZERO)}doVarP(e,t){var n;const i=this.reduceAggregate(e,t);return i instanceof J?i:(n=i.varPValue())!==null&&n!==void 0?n:new J(te.DIV_BY_ZERO)}doStdevS(e,t){const n=this.reduceAggregate(e,t);if(n instanceof J)return n;{const i=n.varSValue();return i===void 0?new J(te.DIV_BY_ZERO):Math.sqrt(i)}}doStdevP(e,t){const n=this.reduceAggregate(e,t);if(n instanceof J)return n;{const i=n.varPValue();return i===void 0?new J(te.DIV_BY_ZERO):Math.sqrt(i)}}doCount(e,t){return this.reduce(e,t,0,"COUNT",(n,i)=>n+i,He,n=>Qt(n)?1:0)}doCounta(e,t){return this.reduce(e,t,0,"COUNTA",(n,i)=>n+i,He,n=>n===It?0:1)}doMax(e,t){const n=this.reduce(e,t,Number.NEGATIVE_INFINITY,"MAX",(i,s)=>Math.max(i,s),He,Tl);return Bh(n)}doMin(e,t){const n=this.reduce(e,t,Number.POSITIVE_INFINITY,"MIN",(i,s)=>Math.min(i,s),He,Tl);return Bh(n)}doSum(e,t){return this.reduce(e,t,0,"SUM",this.addWithEpsilonRaw,He,Tl)}doProduct(e,t){return this.reduce(e,t,1,"PRODUCT",(n,i)=>n*i,He,Tl)}reduce(e,t,n,i,s,o,a){return e.length<1?new J(te.NA,ue.WrongArgNumber):e.reduce((l,u)=>{if(l instanceof J)return l;if(u.type===oe.CELL_RANGE||u.type===oe.COLUMN_RANGE||u.type===oe.ROW_RANGE){const d=this.evaluateRange(u,t,n,i,s,o,a);return d instanceof J?d:s(d,l)}let c;if(c=this.evaluateAst(u,t),c instanceof Ge)return Array.from(c.valuesFromTopLeftCorner()).map(a).filter(h=>h!==void 0).map(h=>h instanceof J?h:o(h)).reduce((h,f)=>h instanceof J?h:f instanceof J?f:s(h,f),l);if(u.type===oe.CELL_REFERENCE){if(c=a(c),c===void 0)return l}else if(c=this.coerceScalarToNumberOrError(c),c=a(c),c===void 0)return l;return c instanceof J?c:s(l,o(c))},n)}evaluateRange(e,t,n,i,s,o,a){let l;try{l=it.fromAst(e,t.formulaAddress)}catch(d){if(d instanceof Cc)return new J(te.REF,ue.RangeManySheets);throw d}if(!this.isSheetValid(l))return new J(te.REF,ue.SheetRef);const u=this.dependencyGraph.getRange(l.start,l.end);if(u===void 0)throw new Error("Range does not exists in graph");let c=u.getFunctionValue(i);return c===void 0&&(c=this.getRangeValues(i,l,u,o,a).reduce((h,f)=>h instanceof J?h:f instanceof J?f:s(h,f),n),u.setFunctionValue(i,c)),c}isSheetValid(e){return this.dependencyGraph.sheetMapping.hasSheetWithId(e.start.sheet,{includePlaceholders:!1})&&this.dependencyGraph.sheetMapping.hasSheetWithId(e.end.sheet,{includePlaceholders:!1})}getRangeValues(e,t,n,i,s){const o=[],{smallerRangeVertex:a,restRange:l}=this.dependencyGraph.rangeMapping.findSmallerRange(t);let u;if(a!==void 0&&this.dependencyGraph.existsEdge(a,n)){const c=a.getFunctionValue(e);if(c!==void 0)o.push(c);else for(const d of a.range.addresses(this.dependencyGraph)){const h=s(this.dependencyGraph.getScalarValue(d));h instanceof J?o.push(h):h!==void 0&&o.push(i(h))}u=l}else u=t;for(const c of u.addresses(this.dependencyGraph)){const d=s(this.dependencyGraph.getScalarValue(c));d instanceof J?o.push(d):d!==void 0&&o.push(i(d))}return o}}Gy.implementedFunctions={SUM:{method:"sum",parameters:[{argumentType:z.ANY}],repeatLastArgs:1},SUMSQ:{method:"sumsq",parameters:[{argumentType:z.ANY}],repeatLastArgs:1},MAX:{method:"max",parameters:[{argumentType:z.ANY}],repeatLastArgs:1},MIN:{method:"min",parameters:[{argumentType:z.ANY}],repeatLastArgs:1},MAXA:{method:"maxa",parameters:[{argumentType:z.ANY}],repeatLastArgs:1},MINA:{method:"mina",parameters:[{argumentType:z.ANY}],repeatLastArgs:1},COUNT:{method:"count",parameters:[{argumentType:z.ANY}],repeatLastArgs:1},COUNTA:{method:"counta",parameters:[{argumentType:z.ANY}],repeatLastArgs:1},AVERAGE:{method:"average",parameters:[{argumentType:z.ANY}],repeatLastArgs:1},AVERAGEA:{method:"averagea",parameters:[{argumentType:z.ANY}],repeatLastArgs:1},PRODUCT:{method:"product",parameters:[{argumentType:z.ANY}],repeatLastArgs:1},"VAR.S":{method:"vars",parameters:[{argumentType:z.ANY}],repeatLastArgs:1},"VAR.P":{method:"varp",parameters:[{argumentType:z.ANY}],repeatLastArgs:1},VARA:{method:"vara",parameters:[{argumentType:z.ANY}],repeatLastArgs:1},VARPA:{method:"varpa",parameters:[{argumentType:z.ANY}],repeatLastArgs:1},"STDEV.S":{method:"stdevs",parameters:[{argumentType:z.ANY}],repeatLastArgs:1},"STDEV.P":{method:"stdevp",parameters:[{argumentType:z.ANY}],repeatLastArgs:1},STDEVA:{method:"stdeva",parameters:[{argumentType:z.ANY}],repeatLastArgs:1},STDEVPA:{method:"stdevpa",parameters:[{argumentType:z.ANY}],repeatLastArgs:1},SUBTOTAL:{method:"subtotal",parameters:[{argumentType:z.NUMBER},{argumentType:z.ANY}],repeatLastArgs:1}};Gy.aliases={VAR:"VAR.S",VARP:"VAR.P",STDEV:"STDEV.S",STDEVP:"STDEV.P",VARS:"VAR.S",STDEVS:"STDEV.S"};function Tl(r){if(Qt(r)||r instanceof J)return r}function Uh(r){return typeof r=="boolean"?jg(r):Qt(r)||r instanceof J?r:typeof r=="string"?0:void 0}class ET extends At{power(e,t){return this.runFunction(e.args,t,this.metadata("POWER"),Math.pow)}}ET.implementedFunctions={POWER:{method:"power",parameters:[{argumentType:z.NUMBER},{argumentType:z.NUMBER}]}};class ST extends At{radians(e,t){return this.runFunction(e.args,t,this.metadata("RADIANS"),n=>n*(Math.PI/180))}}ST.implementedFunctions={RADIANS:{method:"radians",parameters:[{argumentType:z.NUMBER}]}};const fn=10,TT=255,ow=2,aw=36,HI="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";class RT extends At{dec2bin(e,t){return this.runFunction(e.args,t,this.metadata("DEC2BIN"),(n,i)=>no(n,2,i))}dec2oct(e,t){return this.runFunction(e.args,t,this.metadata("DEC2OCT"),(n,i)=>no(n,8,i))}dec2hex(e,t){return this.runFunction(e.args,t,this.metadata("DEC2HEX"),(n,i)=>no(n,16,i))}bin2dec(e,t){return this.runFunction(e.args,t,this.metadata("BIN2DEC"),n=>{const i=bs(n,2,fn);return i===void 0?new J(te.NUM,ue.NotBinary):io(i,2)})}bin2oct(e,t){return this.runFunction(e.args,t,this.metadata("BIN2OCT"),(n,i)=>{const s=bs(n,2,fn);return s===void 0?new J(te.NUM,ue.NotBinary):no(io(s,2),8,i)})}bin2hex(e,t){return this.runFunction(e.args,t,this.metadata("BIN2HEX"),(n,i)=>{const s=bs(n,2,fn);return s===void 0?new J(te.NUM,ue.NotBinary):no(io(s,2),16,i)})}oct2dec(e,t){return this.runFunction(e.args,t,this.metadata("OCT2DEC"),n=>{const i=bs(n,8,fn);return i===void 0?new J(te.NUM,ue.NotOctal):io(i,8)})}oct2bin(e,t){return this.runFunction(e.args,t,this.metadata("OCT2BIN"),(n,i)=>{const s=bs(n,8,fn);return s===void 0?new J(te.NUM,ue.NotOctal):no(io(s,8),2,i)})}oct2hex(e,t){return this.runFunction(e.args,t,this.metadata("OCT2HEX"),(n,i)=>{const s=bs(n,8,fn);return s===void 0?new J(te.NUM,ue.NotOctal):no(io(s,8),16,i)})}hex2dec(e,t){return this.runFunction(e.args,t,this.metadata("HEX2DEC"),n=>{const i=bs(n,16,fn);return i===void 0?new J(te.NUM,ue.NotHex):io(i,16)})}hex2bin(e,t){return this.runFunction(e.args,t,this.metadata("HEX2BIN"),(n,i)=>{const s=bs(n,16,fn);return s===void 0?new J(te.NUM,ue.NotHex):no(io(s,16),2,i)})}hex2oct(e,t){return this.runFunction(e.args,t,this.metadata("HEX2OCT"),(n,i)=>{const s=bs(n,16,fn);return s===void 0?new J(te.NUM,ue.NotHex):no(io(s,16),8,i)})}base(e,t){return this.runFunction(e.args,t,this.metadata("BASE"),GI)}decimal(e,t){return this.runFunction(e.args,t,this.metadata("DECIMAL"),(n,i)=>{const s=bs(n,i,TT);return s===void 0?new J(te.NUM,ue.NotHex):parseInt(s,i)})}}RT.implementedFunctions={DEC2BIN:{method:"dec2bin",parameters:[{argumentType:z.NUMBER},{argumentType:z.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2OCT:{method:"dec2oct",parameters:[{argumentType:z.NUMBER},{argumentType:z.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2HEX:{method:"dec2hex",parameters:[{argumentType:z.NUMBER},{argumentType:z.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},BIN2DEC:{method:"bin2dec",parameters:[{argumentType:z.STRING}]},BIN2OCT:{method:"bin2oct",parameters:[{argumentType:z.STRING},{argumentType:z.NUMBER,optionalArg:!0,minValue:0,maxValue:fn}]},BIN2HEX:{method:"bin2hex",parameters:[{argumentType:z.STRING},{argumentType:z.NUMBER,optionalArg:!0,minValue:0,maxValue:fn}]},OCT2DEC:{method:"oct2dec",parameters:[{argumentType:z.STRING}]},OCT2BIN:{method:"oct2bin",parameters:[{argumentType:z.STRING},{argumentType:z.NUMBER,optionalArg:!0,minValue:0,maxValue:fn}]},OCT2HEX:{method:"oct2hex",parameters:[{argumentType:z.STRING},{argumentType:z.NUMBER,optionalArg:!0,minValue:0,maxValue:fn}]},HEX2DEC:{method:"hex2dec",parameters:[{argumentType:z.STRING}]},HEX2BIN:{method:"hex2bin",parameters:[{argumentType:z.STRING},{argumentType:z.NUMBER,optionalArg:!0,minValue:0,maxValue:fn}]},HEX2OCT:{method:"hex2oct",parameters:[{argumentType:z.STRING},{argumentType:z.NUMBER,optionalArg:!0,minValue:0,maxValue:fn}]},DECIMAL:{method:"decimal",parameters:[{argumentType:z.STRING},{argumentType:z.NUMBER,minValue:ow,maxValue:aw}]},BASE:{method:"base",parameters:[{argumentType:z.NUMBER,minValue:0},{argumentType:z.NUMBER,minValue:ow,maxValue:aw},{argumentType:z.NUMBER,optionalArg:!0,minValue:0,maxValue:TT}]}};function bs(r,e,t){const n=HI.substr(0,e),i=new RegExp(`^[${n}]+$`);if(!(r.length>t||!i.test(r)))return r}function no(r,e,t){if(r>WI(e))return new J(te.NUM,ue.ValueBaseLarge);if(r<AT(e))return new J(te.NUM,ue.ValueBaseSmall);const n=CT(r,e);return t===void 0||r<0?n:n.length>t?new J(te.NUM,ue.ValueBaseLong):ti(n,t)}function AT(r){return-Math.pow(r,fn)/2}function WI(r){return-AT(r)-1}function GI(r,e,t){const n=CT(r,e);return t!==void 0&&t>n.length?ti(n,t):n}function CT(r,e){const t=r<0?Math.pow(e,fn):0;return(r+t).toString(e).toUpperCase()}function io(r,e){const t=parseInt(r,e),n=Math.pow(e,fn);return t>=n/2?t-n:t}class NT extends At{rand(e,t){return this.runFunction(e.args,t,this.metadata("RAND"),Math.random)}randbetween(e,t){return this.runFunction(e.args,t,this.metadata("RANDBETWEEN"),(n,i)=>i<n?new J(te.NUM,ue.WrongOrder):(n=Math.ceil(n),i=Math.floor(i)+1,n===i&&(i+=1),n+Math.floor(Math.random()*(i-n))))}}NT.implementedFunctions={RAND:{method:"rand",parameters:[],isVolatile:!0},RANDBETWEEN:{method:"randbetween",parameters:[{argumentType:z.NUMBER},{argumentType:z.NUMBER}],isVolatile:!0}};function lw(r){const e=Math.ceil(r);return e%2===1?e:e+1}function uw(r){const e=Math.ceil(r);return e%2===0?e:e+1}class qy extends At{roundup(e,t){return this.runFunction(e.args,t,this.metadata("ROUNDDOWN"),(n,i)=>{const s=Math.pow(10,i);return n<0?-Math.ceil(-n*s)/s:Math.ceil(n*s)/s})}rounddown(e,t){return this.runFunction(e.args,t,this.metadata("ROUNDDOWN"),(n,i)=>{const s=Math.pow(10,i);return n<0?-Math.floor(-n*s)/s:Math.floor(n*s)/s})}round(e,t){return this.runFunction(e.args,t,this.metadata("ROUND"),(n,i)=>{const s=Math.pow(10,i);return n<0?-Math.round(-n*s)/s:Math.round(n*s)/s})}intFunc(e,t){return this.runFunction(e.args,t,this.metadata("INT"),n=>n<0?-Math.floor(-n):Math.floor(n))}even(e,t){return this.runFunction(e.args,t,this.metadata("EVEN"),n=>n<0?-uw(-n):uw(n))}odd(e,t){return this.runFunction(e.args,t,this.metadata("ODD"),n=>n<0?-lw(-n):lw(n))}ceilingmath(e,t){return this.runFunction(e.args,t,this.metadata("CEILING.MATH"),(n,i,s)=>i===0||n===0?0:(i=Math.abs(i),s===1&&n<0&&(i=-i),Math.ceil(n/i)*i))}ceiling(e,t){return this.runFunction(e.args,t,this.metadata("CEILING"),(n,i)=>n===0?0:i===0?new J(te.DIV_BY_ZERO):n>0&&i<0?new J(te.NUM,ue.DistinctSigns):Math.ceil(n/i)*i)}ceilingprecise(e,t){return this.runFunction(e.args,t,this.metadata("CEILING.PRECISE"),(n,i)=>i===0||n===0?0:(i=Math.abs(i),Math.ceil(n/i)*i))}floormath(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR.MATH"),(n,i,s)=>i===0||n===0?0:(i=Math.abs(i),s===1&&n<0&&(i*=-1),Math.floor(n/i)*i))}floor(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR"),(n,i)=>n===0?0:i===0?new J(te.DIV_BY_ZERO):n>0&&i<0?new J(te.NUM,ue.DistinctSigns):Math.floor(n/i)*i)}floorprecise(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR.PRECISE"),(n,i)=>i===0||n===0?0:(i=Math.abs(i),Math.floor(n/i)*i))}}qy.implementedFunctions={ROUNDUP:{method:"roundup",parameters:[{argumentType:z.NUMBER},{argumentType:z.NUMBER,defaultValue:0}]},ROUNDDOWN:{method:"rounddown",parameters:[{argumentType:z.NUMBER},{argumentType:z.NUMBER,defaultValue:0}]},ROUND:{method:"round",parameters:[{argumentType:z.NUMBER},{argumentType:z.NUMBER,defaultValue:0}]},INT:{method:"intFunc",parameters:[{argumentType:z.NUMBER}]},EVEN:{method:"even",parameters:[{argumentType:z.NUMBER}]},ODD:{method:"odd",parameters:[{argumentType:z.NUMBER}]},"CEILING.MATH":{method:"ceilingmath",parameters:[{argumentType:z.NUMBER},{argumentType:z.NUMBER,defaultValue:1},{argumentType:z.NUMBER,defaultValue:0}]},CEILING:{method:"ceiling",parameters:[{argumentType:z.NUMBER},{argumentType:z.NUMBER}]},"CEILING.PRECISE":{method:"ceilingprecise",parameters:[{argumentType:z.NUMBER},{argumentType:z.NUMBER,defaultValue:1}]},"FLOOR.MATH":{method:"floormath",parameters:[{argumentType:z.NUMBER},{argumentType:z.NUMBER,defaultValue:1},{argumentType:z.NUMBER,defaultValue:0}]},FLOOR:{method:"floor",parameters:[{argumentType:z.NUMBER},{argumentType:z.NUMBER}]},"FLOOR.PRECISE":{method:"floorprecise",parameters:[{argumentType:z.NUMBER},{argumentType:z.NUMBER,defaultValue:1}]}};qy.aliases={"ISO.CEILING":"CEILING.PRECISE",TRUNC:"ROUNDDOWN"};class MT extends At{sqrt(e,t){return this.runFunction(e.args,t,this.metadata("SQRT"),Math.sqrt)}}MT.implementedFunctions={SQRT:{method:"sqrt",parameters:[{argumentType:z.NUMBER}]}};function*qI(){}function YI(r){const e=r[Symbol.iterator](),{done:t,value:n}=e.next();return t?{rest:qI()}:{value:n,rest:e}}const XI=(r,e,t)=>{if(t.end.row>t.start.row){const n=$e(t.end.sheet,t.end.col,t.end.row-1),i=r.getRange(t.start,n);if(i!==void 0)return{smallerRangeVertex:i,restValuesRange:t.withStart($e(t.start.sheet,t.start.col,t.end.row)),restConditionRanges:e.map(s=>s.withStart($e(s.start.sheet,s.start.col,s.end.row)))}}return{restValuesRange:t,restConditionRanges:e}};class KI{constructor(e,t,n,i,s){this.interpreter=e,this.cacheKey=t,this.reduceInitialValue=n,this.composeFunction=i,this.mapFunction=s,this.dependencyGraph=this.interpreter.dependencyGraph}compute(e,t){for(const s of t)if(!s.conditionRange.sameDimensionsAs(e))return new J(te.VALUE,ue.EqualLength);const n=this.tryToGetRangeVertexForRangeValue(e),i=t.map(s=>this.tryToGetRangeVertexForRangeValue(s.conditionRange));if(n&&i.every(s=>s!==void 0)){const s=t.map(l=>l.criterionPackage.raw).join(","),o=this.findAlreadyComputedValueInCache(n,this.cacheKey(t),s);if(o!==void 0)return this.interpreter.stats.incrementCriterionFunctionFullCacheUsed(),o;const a=this.buildNewCriterionCache(this.cacheKey(t),t.map(l=>l.conditionRange.range),e.range);return a.has(s)||a.set(s,[this.evaluateRangeValue(e,t),t.map(l=>l.criterionPackage.lambda)]),n.setCriterionFunctionValues(this.cacheKey(t),a),i.forEach(l=>{l!==void 0&&l.addDependentCacheRange(n)}),a.get(s)[0]}else return this.evaluateRangeValue(e,t)}tryToGetRangeVertexForRangeValue(e){const t=e.range;if(t!==void 0)return this.dependencyGraph.getRange(t.start,t.end)}reduceFunction(e){let t=this.reduceInitialValue;for(const n of e)t=this.composeFunction(t,n);return t}findAlreadyComputedValueInCache(e,t,n){return e.getCriterionFunctionValue(t,n)}evaluateRangeValue(e,t){const n=t.map(a=>a.criterionPackage.lambda),i=Array.from(e.valuesFromTopLeftCorner()).map(this.mapFunction)[Symbol.iterator](),s=t.map(a=>a.conditionRange.iterateValuesFromTopLeftCorner()),o=hw(n,s,i);return this.reduceFunction(o)}buildNewCriterionCache(e,t,n){const i=this.dependencyGraph.getRange(n.start,n.end),{smallerRangeVertex:s,restConditionRanges:o,restValuesRange:a}=XI(this.dependencyGraph,t,n);let l;s!==void 0&&this.dependencyGraph.existsEdge(s,i)?l=s.getCriterionFunctionValues(e):l=new Map;const u=new Map;return l.forEach(([c,d],h)=>{const f=hw(d,o.map(p=>cw(this.dependencyGraph,p)),Array.from(cw(this.dependencyGraph,a)).map(this.mapFunction)[Symbol.iterator]()),m=this.composeFunction(c,this.reduceFunction(f));this.interpreter.stats.incrementCriterionFunctionPartialCacheUsed(),u.set(h,[m,d])}),u}}class ZI{constructor(e,t){this.conditionRange=e,this.criterionPackage=t}}function*cw(r,e){for(const t of e.addresses(r))yield He(r.getScalarValue(t))}function*hw(r,e,t){for(const n of t){const i=e.map(o=>YI(o));if(!i.every(o=>Object.prototype.hasOwnProperty.call(o,"value")))return;const s=i.map(o=>He(o.value));QI(s,r).every(([o,a])=>a(o))&&(yield n),e=i.map(o=>o.rest)}}function QI(r,e){const t=[];for(let n=0;n<Math.min(r.length,e.length);n++)t.push([r[n],e[n]]);return t}class ua{constructor(e,t){this.sum=e,this.count=t}static single(e){return new ua(e,1)}compose(e){return new ua(this.sum+e.sum,this.count+e.count)}averageValue(){if(this.count>0)return this.sum/this.count}}ua.empty=new ua(0,0);function JI(r){return e=>{const t=e.map(n=>`${n.conditionRange.range.sheet},${n.conditionRange.range.start.col},${n.conditionRange.range.start.row}`);return[r,...t].join(",")}}function dw(r){return Qt(r)&&!Number.isFinite(He(r))?0:r}function Vh(r){if(r instanceof J)return r;if(Qt(r))return He(r)}class OT extends At{sumif(e,t){const n="SUMIF",i=(s,o,a)=>this.computeConditionalAggregationFunction(a??s,[s,o],n,0,(l,u)=>this.arithmeticHelper.nonstrictadd(l,u),Vh);return this.runFunction(e.args,t,this.metadata(n),i)}sumifs(e,t){const n="SUMIFS",i=(s,...o)=>this.computeConditionalAggregationFunction(s,o,n,0,(a,l)=>this.arithmeticHelper.nonstrictadd(a,l),Vh);return this.runFunction(e.args,t,this.metadata(n),i)}averageif(e,t){const n="AVERAGEIF",i=(s,o,a)=>{const l=this.computeConditionalAggregationFunction(a??s,[s,o],n,ua.empty,(u,c)=>u.compose(c),u=>Qt(u)?ua.single(He(u)):ua.empty);return l instanceof J?l:l.averageValue()||new J(te.DIV_BY_ZERO)};return this.runFunction(e.args,t,this.metadata(n),i)}countif(e,t){const n="COUNTIF",i=(s,o)=>this.computeConditionalAggregationFunction(s,[s,o],n,0,(a,l)=>a+l,()=>1);return this.runFunction(e.args,t,this.metadata(n),i)}countifs(e,t){const n="COUNTIFS",i=(...s)=>this.computeConditionalAggregationFunction(s[0],s,n,0,(o,a)=>o+a,()=>1);return this.runFunction(e.args,t,this.metadata(n),i)}minifs(e,t){const n="MINIFS",i=(o,a)=>a===void 0||o===void 0?a===void 0?o:a:Math.min(o,a),s=(o,...a)=>{const l=this.computeConditionalAggregationFunction(o,a,n,Number.POSITIVE_INFINITY,i,Vh);return dw(l)};return this.runFunction(e.args,t,this.metadata(n),s)}maxifs(e,t){const n="MAXIFS",i=(o,a)=>a===void 0||o===void 0?a===void 0?o:a:Math.max(o,a),s=(o,...a)=>{const l=this.computeConditionalAggregationFunction(o,a,n,Number.NEGATIVE_INFINITY,i,Vh);return dw(l)};return this.runFunction(e.args,t,this.metadata(n),s)}computeConditionalAggregationFunction(e,t,n,i,s,o){const a=[];for(let l=0;l<t.length;l+=2){const u=t[l],c=this.interpreter.criterionBuilder.fromCellValue(t[l+1],this.arithmeticHelper);if(c===void 0)return new J(te.VALUE,ue.BadCriterion);a.push(new ZI(u,c))}return new KI(this.interpreter,JI(n),i,s,o).compute(e,a)}}OT.implementedFunctions={SUMIF:{method:"sumif",parameters:[{argumentType:z.RANGE},{argumentType:z.NOERROR},{argumentType:z.RANGE,optionalArg:!0}]},COUNTIF:{method:"countif",parameters:[{argumentType:z.RANGE},{argumentType:z.NOERROR}]},AVERAGEIF:{method:"averageif",parameters:[{argumentType:z.RANGE},{argumentType:z.NOERROR},{argumentType:z.RANGE,optionalArg:!0}]},SUMIFS:{method:"sumifs",parameters:[{argumentType:z.RANGE},{argumentType:z.RANGE},{argumentType:z.NOERROR}],repeatLastArgs:2},COUNTIFS:{method:"countifs",parameters:[{argumentType:z.RANGE},{argumentType:z.NOERROR}],repeatLastArgs:2},MINIFS:{method:"minifs",parameters:[{argumentType:z.RANGE},{argumentType:z.RANGE},{argumentType:z.NOERROR}],repeatLastArgs:2},MAXIFS:{method:"maxifs",parameters:[{argumentType:z.RANGE},{argumentType:z.RANGE},{argumentType:z.NOERROR}],repeatLastArgs:2}};class IT extends At{sumproduct(e,t){return this.runFunction(e.args,t,this.metadata("SUMPRODUCT"),(...n)=>{const i=n[0].width(),s=n[0].height();for(const l of n)if(l.width()!==i||l.height()!==s)return new J(te.VALUE,ue.EqualLength);let o=0;const a=n.map(l=>l.iterateValuesFromTopLeftCorner());for(let l=0;l<i*s;l++){let u=1;for(const c of a){const d=c.next().value;if(d instanceof J)return d;const h=this.coerceScalarToNumberOrError(d);Qt(h)?u*=He(h):u=0}o+=u}return o})}}IT.implementedFunctions={SUMPRODUCT:{method:"sumproduct",parameters:[{argumentType:z.RANGE}],repeatLastArgs:1}};class kT extends At{concatenate(e,t){return this.runFunction(e.args,t,this.metadata("CONCATENATE"),(...n)=>"".concat(...n))}split(e,t){return this.runFunction(e.args,t,this.metadata("SPLIT"),(n,i)=>{const s=n.split(" ");return i>=s.length||i<0?new J(te.VALUE,ue.IndexBounds):s[i]})}len(e,t){return this.runFunction(e.args,t,this.metadata("LEN"),n=>n.length)}lower(e,t){return this.runFunction(e.args,t,this.metadata("LOWER"),n=>n.toLowerCase())}trim(e,t){return this.runFunction(e.args,t,this.metadata("TRIM"),n=>n.replace(/^ +/g,"").replace(/ +$/g,"").replace(/ +/g," "))}proper(e,t){return this.runFunction(e.args,t,this.metadata("PROPER"),n=>n.replace(new RegExp("\\p{L}+","gu"),i=>i.charAt(0).toUpperCase()+i.substring(1).toLowerCase()))}clean(e,t){return this.runFunction(e.args,t,this.metadata("CLEAN"),n=>n.replace(/[\u0000-\u001F]/g,""))}exact(e,t){return this.runFunction(e.args,t,this.metadata("EXACT"),(n,i)=>n===i)}rept(e,t){return this.runFunction(e.args,t,this.metadata("REPT"),(n,i)=>i<0?new J(te.VALUE,ue.NegativeCount):n.repeat(i))}right(e,t){return this.runFunction(e.args,t,this.metadata("RIGHT"),(n,i)=>i<0?new J(te.VALUE,ue.NegativeLength):i===0?"":n.slice(-i))}left(e,t){return this.runFunction(e.args,t,this.metadata("LEFT"),(n,i)=>i<0?new J(te.VALUE,ue.NegativeLength):n.slice(0,i))}mid(e,t){return this.runFunction(e.args,t,this.metadata("MID"),(n,i,s)=>i<1?new J(te.VALUE,ue.LessThanOne):s<0?new J(te.VALUE,ue.NegativeLength):n.substring(i-1,i+s-1))}replace(e,t){return this.runFunction(e.args,t,this.metadata("REPLACE"),(n,i,s,o)=>i<1?new J(te.VALUE,ue.LessThanOne):s<0?new J(te.VALUE,ue.NegativeLength):n.substring(0,i-1)+o+n.substring(i+s-1))}search(e,t){return this.runFunction(e.args,t,this.metadata("SEARCH"),(n,i,s)=>{if(s<1||s>i.length)return new J(te.VALUE,ue.LengthBounds);const o=n.toLowerCase(),a=i.substring(s-1).toLowerCase(),l=this.arithmeticHelper.requiresRegex(o)?this.arithmeticHelper.searchString(o,a):a.indexOf(o);return l>-1?l+s:new J(te.VALUE,ue.PatternNotFound)})}substitute(e,t){return this.runFunction(e.args,t,this.metadata("SUBSTITUTE"),(n,i,s,o)=>{const a=this.escapeRegExpSpecialCharacters(i),l=new RegExp(a,"g");if(o===void 0)return n.replace(l,s);if(o<1)return new J(te.VALUE,ue.LessThanOne);let u,c=0;for(;(u=l.exec(n))!==null;)if(o===++c)return n.substring(0,u.index)+s+n.substring(l.lastIndex);return n})}find(e,t){return this.runFunction(e.args,t,this.metadata("FIND"),(n,i,s)=>{if(s<1||s>i.length)return new J(te.VALUE,ue.IndexBounds);const a=i.substring(s-1).indexOf(n)+s;return a>0?a:new J(te.VALUE,ue.PatternNotFound)})}t(e,t){return this.runFunction(e.args,t,this.metadata("T"),n=>n instanceof J||typeof n=="string"?n:"")}upper(e,t){return this.runFunction(e.args,t,this.metadata("UPPER"),n=>n.toUpperCase())}escapeRegExpSpecialCharacters(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}}kT.implementedFunctions={CONCATENATE:{method:"concatenate",parameters:[{argumentType:z.STRING}],repeatLastArgs:1,expandRanges:!0},EXACT:{method:"exact",parameters:[{argumentType:z.STRING},{argumentType:z.STRING}]},SPLIT:{method:"split",parameters:[{argumentType:z.STRING},{argumentType:z.NUMBER}]},LEN:{method:"len",parameters:[{argumentType:z.STRING}]},LOWER:{method:"lower",parameters:[{argumentType:z.STRING}]},MID:{method:"mid",parameters:[{argumentType:z.STRING},{argumentType:z.NUMBER},{argumentType:z.NUMBER}]},TRIM:{method:"trim",parameters:[{argumentType:z.STRING}]},T:{method:"t",parameters:[{argumentType:z.SCALAR}]},PROPER:{method:"proper",parameters:[{argumentType:z.STRING}]},CLEAN:{method:"clean",parameters:[{argumentType:z.STRING}]},REPT:{method:"rept",parameters:[{argumentType:z.STRING},{argumentType:z.NUMBER}]},RIGHT:{method:"right",parameters:[{argumentType:z.STRING},{argumentType:z.NUMBER,defaultValue:1}]},LEFT:{method:"left",parameters:[{argumentType:z.STRING},{argumentType:z.NUMBER,defaultValue:1}]},REPLACE:{method:"replace",parameters:[{argumentType:z.STRING},{argumentType:z.NUMBER},{argumentType:z.NUMBER},{argumentType:z.STRING}]},SEARCH:{method:"search",parameters:[{argumentType:z.STRING},{argumentType:z.STRING},{argumentType:z.NUMBER,defaultValue:1}]},SUBSTITUTE:{method:"substitute",parameters:[{argumentType:z.STRING},{argumentType:z.STRING},{argumentType:z.STRING},{argumentType:z.NUMBER,optionalArg:!0}]},FIND:{method:"find",parameters:[{argumentType:z.STRING},{argumentType:z.STRING},{argumentType:z.NUMBER,defaultValue:1}]},UPPER:{method:"upper",parameters:[{argumentType:z.STRING}]}};class PT extends At{acos(e,t){return this.runFunction(e.args,t,this.metadata("ACOS"),Math.acos)}asin(e,t){return this.runFunction(e.args,t,this.metadata("ASIN"),Math.asin)}cos(e,t){return this.runFunction(e.args,t,this.metadata("COS"),Math.cos)}sin(e,t){return this.runFunction(e.args,t,this.metadata("SIN"),Math.sin)}tan(e,t){return this.runFunction(e.args,t,this.metadata("TAN"),Math.tan)}atan(e,t){return this.runFunction(e.args,t,this.metadata("ATAN"),Math.atan)}atan2(e,t){return this.runFunction(e.args,t,this.metadata("ATAN2"),(n,i)=>n===0&&i===0?new J(te.DIV_BY_ZERO):Math.atan2(i,n))}cot(e,t){return this.runFunction(e.args,t,this.metadata("COT"),n=>n===0?new J(te.DIV_BY_ZERO):1/Math.tan(n))}acot(e,t){return this.runFunction(e.args,t,this.metadata("ACOT"),n=>n===0?Jg/2:Math.atan(1/n))}sec(e,t){return this.runFunction(e.args,t,this.metadata("SEC"),n=>1/Math.cos(n))}csc(e,t){return this.runFunction(e.args,t,this.metadata("CSC"),n=>n===0?new J(te.DIV_BY_ZERO):1/Math.sin(n))}sinh(e,t){return this.runFunction(e.args,t,this.metadata("SINH"),Math.sinh)}asinh(e,t){return this.runFunction(e.args,t,this.metadata("ASINH"),Math.asinh)}cosh(e,t){return this.runFunction(e.args,t,this.metadata("COSH"),Math.cosh)}acosh(e,t){return this.runFunction(e.args,t,this.metadata("ACOSH"),Math.acosh)}tanh(e,t){return this.runFunction(e.args,t,this.metadata("TANH"),Math.tanh)}atanh(e,t){return this.runFunction(e.args,t,this.metadata("ATANH"),Math.atanh)}coth(e,t){return this.runFunction(e.args,t,this.metadata("COTH"),n=>n===0?new J(te.DIV_BY_ZERO):1/Math.tanh(n))}acoth(e,t){return this.runFunction(e.args,t,this.metadata("ACOTH"),n=>n===0?new J(te.NUM,ue.NonZero):Math.atanh(1/n))}sech(e,t){return this.runFunction(e.args,t,this.metadata("SECH"),n=>1/Math.cosh(n))}csch(e,t){return this.runFunction(e.args,t,this.metadata("CSCH"),n=>n===0?new J(te.DIV_BY_ZERO):1/Math.sinh(n))}}PT.implementedFunctions={ACOS:{method:"acos",parameters:[{argumentType:z.NUMBER}]},ASIN:{method:"asin",parameters:[{argumentType:z.NUMBER}]},COS:{method:"cos",parameters:[{argumentType:z.NUMBER}]},SIN:{method:"sin",parameters:[{argumentType:z.NUMBER}]},TAN:{method:"tan",parameters:[{argumentType:z.NUMBER}]},ATAN:{method:"atan",parameters:[{argumentType:z.NUMBER}]},ATAN2:{method:"atan2",parameters:[{argumentType:z.NUMBER},{argumentType:z.NUMBER}]},COT:{method:"cot",parameters:[{argumentType:z.NUMBER}]},SEC:{method:"sec",parameters:[{argumentType:z.NUMBER}]},CSC:{method:"csc",parameters:[{argumentType:z.NUMBER}]},SINH:{method:"sinh",parameters:[{argumentType:z.NUMBER}]},COSH:{method:"cosh",parameters:[{argumentType:z.NUMBER}]},TANH:{method:"tanh",parameters:[{argumentType:z.NUMBER}]},COTH:{method:"coth",parameters:[{argumentType:z.NUMBER}]},SECH:{method:"sech",parameters:[{argumentType:z.NUMBER}]},CSCH:{method:"csch",parameters:[{argumentType:z.NUMBER}]},ACOT:{method:"acot",parameters:[{argumentType:z.NUMBER}]},ASINH:{method:"asinh",parameters:[{argumentType:z.NUMBER}]},ACOSH:{method:"acosh",parameters:[{argumentType:z.NUMBER}]},ATANH:{method:"atanh",parameters:[{argumentType:z.NUMBER}]},ACOTH:{method:"acoth",parameters:[{argumentType:z.NUMBER}]}};class ek extends GS{constructor(e){super(e),this.dependencyGraph=e}find(e,t,n){return this.basicFind(e,t,"col",n)}}class FT extends At{constructor(){super(...arguments),this.rowSearch=new ek(this.dependencyGraph)}vlookup(e,t){return this.runFunction(e.args,t,this.metadata("VLOOKUP"),(n,i,s,o)=>{const a=i.range;if(a===void 0)return new J(te.VALUE,ue.WrongType);if(s<1)return new J(te.VALUE,ue.LessThanOne);if(s>a.width())return new J(te.REF,ue.IndexLarge);const l={ordering:o?"asc":"none",ifNoMatch:o?"returnLowerBound":"returnNotFound"};return this.doVlookup(Nh(n),i,s-1,l)})}hlookup(e,t){return this.runFunction(e.args,t,this.metadata("HLOOKUP"),(n,i,s,o)=>{const a=i.range;if(a===void 0)return new J(te.VALUE,ue.WrongType);if(s<1)return new J(te.VALUE,ue.LessThanOne);if(s>a.height())return new J(te.REF,ue.IndexLarge);const l={ordering:o?"asc":"none",ifNoMatch:o?"returnLowerBound":"returnNotFound"};return this.doHlookup(Nh(n),i,s-1,l)})}xlookup(e,t){return this.runFunction(e.args,t,this.metadata("XLOOKUP"),(n,i,s,o,a,l)=>{if(![0,-1,1,2].includes(a))return new J(te.VALUE,ue.BadMode);if(![1,-1,2,-2].includes(l))return new J(te.VALUE,ue.BadMode);const u=i instanceof Ge?i:Ge.fromScalar(i),c=s instanceof Ge?s:Ge.fromScalar(s),d=a===2,h={ordering:l===2?"asc":l===-2?"desc":"none",returnOccurrence:l===-1?"last":"first",ifNoMatch:a===-1?"returnLowerBound":a===1?"returnUpperBound":"returnNotFound"};return this.doXlookup(Nh(n),u,c,o,d,h)})}xlookupArraySize(e){var t,n;const i=(t=e?.args)===null||t===void 0?void 0:t[1],s=(n=e?.args)===null||n===void 0?void 0:n[2];if(i?.start==null||i?.end==null||s?.start==null||s?.end==null)return Ct.error();const o=i.end.row-i.start.row+1,a=i.end.col-i.start.col+1,l=s.end.row-s.start.row+1,u=s.end.col-s.start.col+1,c=a===1&&l===o;return!c&&!(o===1&&u===a)?Ct.error():c?new Ct(u,1):new Ct(1,l)}match(e,t){return this.runFunction(e.args,t,this.metadata("MATCH"),(n,i,s)=>this.doMatch(Nh(n),i,s))}searchInRange(e,t,n,i,s){return n&&typeof e=="string"&&this.arithmeticHelper.requiresRegex(e)?s.advancedFind(this.arithmeticHelper.eqMatcherFunction(e),t,{returnOccurrence:i.returnOccurrence}):s.find(e,t,i)}doVlookup(e,t,n,i){this.dependencyGraph.stats.start(wt.VLOOKUP);const s=t.range;let o;s===void 0?o=Ge.onlyValues(t.data.map(u=>[u[0]])):o=Ge.onlyRange(it.spanFrom(s.start,1,s.height()),this.dependencyGraph);const a=this.searchInRange(e,o,i.ordering==="none",i,this.columnSearch);if(this.dependencyGraph.stats.end(wt.VLOOKUP),a===-1)return new J(te.NA,ue.ValueNotFound);let l;if(s===void 0)l=t.data[a][n];else{const u=$e(s.sheet,s.start.col+n,s.start.row+a);l=this.dependencyGraph.getCellValue(u)}return l instanceof Ge?new J(te.VALUE,ue.WrongType):l}doHlookup(e,t,n,i){const s=t.range;let o;s===void 0?o=Ge.onlyValues([t.data[0]]):o=Ge.onlyRange(it.spanFrom(s.start,s.width(),1),this.dependencyGraph);const a=this.searchInRange(e,o,i.ordering==="none",i,this.rowSearch);if(a===-1)return new J(te.NA,ue.ValueNotFound);let l;if(s===void 0)l=t.data[n][a];else{const u=$e(s.sheet,s.start.col+a,s.start.row+n);l=this.dependencyGraph.getCellValue(u)}return l instanceof Ge?new J(te.VALUE,ue.WrongType):l}doXlookup(e,t,n,i,s,o){const a=t.width()===1&&n.height()===t.height(),l=t.height()===1&&n.width()===t.width();if(!a&&!l)return new J(te.VALUE,ue.WrongDimension);const u=a?this.columnSearch:this.rowSearch,c=this.searchInRange(e,t,s,o,u);if(c===-1)return i==te.NA?new J(te.NA,ue.ValueNotFound):i;const d=a?[n.data[c]]:n.data.map(h=>[h[c]]);return Ge.onlyValues(d)}doMatch(e,t,n){if(![-1,0,1].includes(n))return new J(te.VALUE,ue.BadMode);if(t.width()>1&&t.height()>1)return new J(te.NA);const i=t.width()===1?this.columnSearch:this.rowSearch,s=n===0?{ordering:"none",ifNoMatch:"returnNotFound"}:{ordering:n===-1?"desc":"asc",ifNoMatch:n===-1?"returnUpperBound":"returnLowerBound"},o=i.find(e,t,s);return o===-1?new J(te.NA,ue.ValueNotFound):o+1}}FT.implementedFunctions={VLOOKUP:{method:"vlookup",parameters:[{argumentType:z.NOERROR},{argumentType:z.RANGE},{argumentType:z.NUMBER},{argumentType:z.BOOLEAN,defaultValue:!0}]},HLOOKUP:{method:"hlookup",parameters:[{argumentType:z.NOERROR},{argumentType:z.RANGE},{argumentType:z.NUMBER},{argumentType:z.BOOLEAN,defaultValue:!0}]},XLOOKUP:{method:"xlookup",sizeOfResultArrayMethod:"xlookupArraySize",parameters:[{argumentType:z.NOERROR},{argumentType:z.RANGE},{argumentType:z.RANGE},{argumentType:z.SCALAR,optionalArg:!0,defaultValue:te.NA},{argumentType:z.NUMBER,optionalArg:!0,defaultValue:0},{argumentType:z.NUMBER,optionalArg:!0,defaultValue:1}]},MATCH:{method:"match",parameters:[{argumentType:z.NOERROR},{argumentType:z.RANGE},{argumentType:z.NUMBER,defaultValue:1}]}};class LT extends At{roman(e,t){return this.runFunction(e.args,t,this.metadata("ROMAN"),(n,i)=>(n=Math.trunc(n),i===!1?i=4:i===!0&&(i=0),i=He(this.coerceScalarToNumberOrError(i)),i instanceof J?i:(i=Math.trunc(i),i<0?new J(te.VALUE,ue.ValueSmall):i>4?new J(te.VALUE,ue.ValueLarge):tk(n,i))))}arabic(e,t){return this.runFunction(e.args,t,this.metadata("ARABIC"),n=>{n=n.trim().toUpperCase();let i=!1;if(n.startsWith("-")&&(n=n.slice(1),i=!0,n===""))return new J(te.VALUE,ue.InvalidRoman);const s={input:n,acc:0};return ws(s,{token:"MMM",val:3e3},{token:"MM",val:2e3},{token:"M",val:1e3}),ws(s,{token:"IM",val:999},{token:"VM",val:995},{token:"XM",val:990},{token:"LM",val:950},{token:"CM",val:900}),ws(s,{token:"D",val:500},{token:"ID",val:499},{token:"VD",val:495},{token:"XD",val:490},{token:"LD",val:450},{token:"CD",val:400}),ws(s,{token:"CCC",val:300},{token:"CC",val:200},{token:"C",val:100}),ws(s,{token:"IC",val:99},{token:"VC",val:95},{token:"XC",val:90}),ws(s,{token:"L",val:50},{token:"IL",val:49},{token:"VL",val:45},{token:"XL",val:40}),ws(s,{token:"XXX",val:30},{token:"XX",val:20},{token:"X",val:10}),ws(s,{token:"IX",val:9}),ws(s,{token:"V",val:5},{token:"IV",val:4}),ws(s,{token:"III",val:3},{token:"II",val:2},{token:"I",val:1}),s.input!==""?new J(te.VALUE,ue.InvalidRoman):i?-s.acc:s.acc})}}LT.implementedFunctions={ROMAN:{method:"roman",parameters:[{argumentType:z.NUMBER,minValue:1,lessThan:4e3},{argumentType:z.NOERROR,optionalArg:!0,defaultValue:0}]},ARABIC:{method:"arabic",parameters:[{argumentType:z.STRING}]}};function ws(r,...e){for(const t of e)if(r.input.startsWith(t.token)){r.input=r.input.slice(t.token.length),r.acc+=t.val;break}}function tk(r,e){const t={val:r%1e3,acc:"M".repeat(Math.floor(r/1e3))};return e===4&&(Hr(t,"IM",999,1e3),Hr(t,"ID",499,500)),e>=3&&(Hr(t,"VM",995,1e3),Hr(t,"VD",495,500)),e>=2&&(Hr(t,"XM",990,1e3),Hr(t,"XD",490,500)),e>=1&&(Hr(t,"LM",950,1e3),Hr(t,"LD",450,500)),Hr(t,"CM",900,1e3),Hr(t,"CD",400,500),Hr(t,"D",500,900),t.acc+="C".repeat(Math.floor(t.val/100)),t.val%=100,e>=2&&(Hr(t,"IC",99,100),Hr(t,"IL",49,50)),e>=1&&(Hr(t,"VC",95,100),Hr(t,"VL",45,50)),Hr(t,"XC",90,100),Hr(t,"XL",40,50),Hr(t,"L",50,90),t.acc+="X".repeat(Math.floor(t.val/10)),t.val%=10,Hr(t,"IX",9,10),Hr(t,"IV",4,5),Hr(t,"V",5,9),t.acc+="I".repeat(t.val),t.acc}function Hr(r,e,t,n){r.val>=t&&r.val<n&&(r.val-=t,r.acc+=e)}class DT extends At{add(e,t){return this.runFunction(e.args,t,this.metadata("HF.ADD"),this.arithmeticHelper.addWithEpsilon)}concat(e,t){return this.runFunction(e.args,t,this.metadata("HF.CONCAT"),this.arithmeticHelper.concat)}divide(e,t){return this.runFunction(e.args,t,this.metadata("HF.DIVIDE"),this.arithmeticHelper.divide)}eq(e,t){return this.runFunction(e.args,t,this.metadata("HF.EQ"),this.arithmeticHelper.eq)}gt(e,t){return this.runFunction(e.args,t,this.metadata("HF.GT"),this.arithmeticHelper.gt)}gte(e,t){return this.runFunction(e.args,t,this.metadata("HF.GTE"),this.arithmeticHelper.geq)}lt(e,t){return this.runFunction(e.args,t,this.metadata("HF.LT"),this.arithmeticHelper.lt)}lte(e,t){return this.runFunction(e.args,t,this.metadata("HF.LTE"),this.arithmeticHelper.leq)}minus(e,t){return this.runFunction(e.args,t,this.metadata("HF.MINUS"),this.arithmeticHelper.subtract)}multiply(e,t){return this.runFunction(e.args,t,this.metadata("HF.MULTIPLY"),this.arithmeticHelper.multiply)}ne(e,t){return this.runFunction(e.args,t,this.metadata("HF.NE"),this.arithmeticHelper.neq)}pow(e,t){return this.runFunction(e.args,t,this.metadata("HF.POW"),this.arithmeticHelper.pow)}uminus(e,t){return this.runFunction(e.args,t,this.metadata("HF.UMINUS"),this.arithmeticHelper.unaryMinus)}upercent(e,t){return this.runFunction(e.args,t,this.metadata("HF.UNARY_PERCENT"),this.arithmeticHelper.unaryPercent)}uplus(e,t){return this.runFunction(e.args,t,this.metadata("HF.UPLUS"),this.arithmeticHelper.unaryPlus)}}DT.implementedFunctions={"HF.ADD":{method:"add",parameters:[{argumentType:z.NUMBER,passSubtype:!0},{argumentType:z.NUMBER,passSubtype:!0}]},"HF.CONCAT":{method:"concat",parameters:[{argumentType:z.STRING,passSubtype:!0},{argumentType:z.STRING,passSubtype:!0}]},"HF.DIVIDE":{method:"divide",parameters:[{argumentType:z.NUMBER,passSubtype:!0},{argumentType:z.NUMBER,passSubtype:!0}]},"HF.EQ":{method:"eq",parameters:[{argumentType:z.NOERROR,passSubtype:!0},{argumentType:z.NOERROR,passSubtype:!0}]},"HF.GT":{method:"gt",parameters:[{argumentType:z.NOERROR,passSubtype:!0},{argumentType:z.NOERROR,passSubtype:!0}]},"HF.GTE":{method:"gte",parameters:[{argumentType:z.NOERROR,passSubtype:!0},{argumentType:z.NOERROR,passSubtype:!0}]},"HF.LT":{method:"lt",parameters:[{argumentType:z.NOERROR,passSubtype:!0},{argumentType:z.NOERROR,passSubtype:!0}]},"HF.LTE":{method:"lte",parameters:[{argumentType:z.NOERROR,passSubtype:!0},{argumentType:z.NOERROR,passSubtype:!0}]},"HF.MINUS":{method:"minus",parameters:[{argumentType:z.NUMBER,passSubtype:!0},{argumentType:z.NUMBER,passSubtype:!0}]},"HF.MULTIPLY":{method:"multiply",parameters:[{argumentType:z.NUMBER,passSubtype:!0},{argumentType:z.NUMBER,passSubtype:!0}]},"HF.NE":{method:"ne",parameters:[{argumentType:z.NOERROR,passSubtype:!0},{argumentType:z.NOERROR,passSubtype:!0}]},"HF.POW":{method:"pow",parameters:[{argumentType:z.NUMBER,passSubtype:!0},{argumentType:z.NUMBER,passSubtype:!0}]},"HF.UMINUS":{method:"uminus",parameters:[{argumentType:z.NUMBER,passSubtype:!0}]},"HF.UNARY_PERCENT":{method:"upercent",parameters:[{argumentType:z.NUMBER,passSubtype:!0}]},"HF.UPLUS":{method:"uplus",parameters:[{argumentType:z.NUMBER,passSubtype:!0}]}};var Nt=Math;function Or(r,e){for(var t=0,n=0;t<r.length;++t)n=e*n+r[t];return n}function BT(r,e,t,n,i){if(e===0)return t;if(e===1)return n;for(var s=2/r,o=n,a=1;a<e;++a)o=n*a*s+i*t,t=n,n=o;return o}function UT(r,e,t,n,i){return function(o,a){if(n){if(o===0)return n==1?-1/0:1/0;if(o<0)return NaN}if(a===0)return r(o);if(a===1)return e(o);if(a<0)return NaN;a|=0;var l=r(o),u=e(o);return BT(o,a,l,u,i)}}var e0=(function(){var r=.636619772,e=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),t=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),n=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),i=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function s(d){var h=0,f=0,m=0,p=d*d;if(d<8)f=Or(e,p),m=Or(t,p),h=f/m;else{var g=d-.785398164;p=64/p,f=Or(n,p),m=Or(i,p),h=Nt.sqrt(r/d)*(Nt.cos(g)*f-Nt.sin(g)*m*8/d)}return h}var o=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),a=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),l=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),u=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function c(d){var h=0,f=0,m=0,p=d*d,g=Nt.abs(d)-2.356194491;return Math.abs(d)<8?(f=d*Or(o,p),m=Or(a,p),h=f/m):(p=64/p,f=Or(l,p),m=Or(u,p),h=Nt.sqrt(r/Nt.abs(d))*(Nt.cos(g)*f-Nt.sin(g)*m*8/Nt.abs(d)),d<0&&(h=-h)),h}return function d(h,f){if(f=Math.round(f),!isFinite(h))return isNaN(h)?h:0;if(f<0)return(f%2?-1:1)*d(h,-f);if(h<0)return(f%2?-1:1)*d(-h,f);if(f===0)return s(h);if(f===1)return c(h);if(h===0)return 0;var m=0;if(h>f)m=BT(h,f,s(h),c(h),-1);else{for(var p=2*Nt.floor((f+Nt.floor(Nt.sqrt(40*f)))/2),g=!1,v=0,y=0,b=1,E=0,A=2/h,M=p;M>0;M--)E=M*A*b-v,v=b,b=E,Nt.abs(b)>1e10&&(b*=1e-10,v*=1e-10,m*=1e-10,y*=1e-10),g&&(y+=b),g=!g,M==f&&(m=v);y=2*y-b,m/=y}return m}})(),rk=(function(){var r=.636619772,e=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),t=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),n=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),i=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse();function s(d){var h=0,f=0,m=0,p=d*d,g=d-.785398164;return d<8?(f=Or(e,p),m=Or(t,p),h=f/m+r*e0(d,0)*Nt.log(d)):(p=64/p,f=Or(n,p),m=Or(i,p),h=Nt.sqrt(r/d)*(Nt.sin(g)*f+Nt.cos(g)*m*8/d)),h}var o=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),a=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),l=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),u=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function c(d){var h=0,f=0,m=0,p=d*d,g=d-2.356194491;return d<8?(f=d*Or(o,p),m=Or(a,p),h=f/m+r*(e0(d,1)*Nt.log(d)-1/d)):(p=64/p,f=Or(l,p),m=Or(u,p),h=Nt.sqrt(r/d)*(Nt.sin(g)*f+Nt.cos(g)*m*8/d)),h}return UT(s,c,"BESSELY",1,-1)})(),t0=(function(){var r=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),e=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse();function t(o){return o<=3.75?Or(r,o*o/(3.75*3.75)):Nt.exp(Nt.abs(o))/Nt.sqrt(Nt.abs(o))*Or(e,3.75/Nt.abs(o))}var n=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),i=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();function s(o){return o<3.75?o*Or(n,o*o/(3.75*3.75)):(o<0?-1:1)*Nt.exp(Nt.abs(o))/Nt.sqrt(Nt.abs(o))*Or(i,3.75/Nt.abs(o))}return function o(a,l){if(l=Math.round(l),l===0)return t(a);if(l===1)return s(a);if(l<0)return NaN;if(Nt.abs(a)===0)return 0;if(a==1/0)return 1/0;var u=0,c,d=2/Nt.abs(a),h=0,f=1,m=0,p=2*Nt.round((l+Nt.round(Nt.sqrt(40*l)))/2);for(c=p;c>0;c--)m=c*d*f+h,h=f,f=m,Nt.abs(f)>1e10&&(f*=1e-10,h*=1e-10,u*=1e-10),c==l&&(u=h);return u*=o(a,0)/f,a<0&&l%2?-u:u}})(),nk=(function(){var r=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),e=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse();function t(o){return o<=2?-Nt.log(o/2)*t0(o,0)+Or(r,o*o/4):Nt.exp(-o)/Nt.sqrt(o)*Or(e,2/o)}var n=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),i=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();function s(o){return o<=2?Nt.log(o/2)*t0(o,1)+1/o*Or(n,o*o/4):Nt.exp(-o)/Nt.sqrt(o)*Or(i,2/o)}return UT(t,s,"BESSELK",2,1)})();function Zl(r){const e=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18];let t=e.length-1,n=!1,i=0,s=0,o,a,l,u;if(r===0)return 0;for(r<0&&(r=-r,n=!0),o=2/(2+r),a=4*o-2;t>0;t--)l=i,i=a*i-s+e[t],s=l;return u=o*Math.exp(-r*r+.5*(e[0]+a*i)-s),n?u-1:1-u}function VT(r){return 1-Zl(r)}function jT(r){let e=0,t,n,i,s;if(r>=2)return-100;if(r<=0)return 100;for(s=r<1?r:2-r,i=Math.sqrt(-2*Math.log(s/2)),t=-.70711*((2.30753+i*.27061)/(1+i*(.99229+i*.04481))-i);e<2;e++)n=VT(t)-s,t+=n/(1.1283791670955126*Math.exp(-t*t)-t*n);return r<1?t:-t}const fw={pdf:(r,e)=>r<0?0:e*Math.exp(-e*r),cdf:(r,e)=>r<0?0:1-Math.exp(-e*r)};function hc(r){const e=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],t=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535];let n=!1,i=0,s=0,o=0,a=r,l,u,c,d;if(r>171.6243769536076)return 1/0;if(a<=0)if(d=a%1,d)n=(a&1?-1:1)*Math.PI/Math.sin(Math.PI*d),a=1-a;else return 1/0;for(c=a,a<1?u=a++:u=(a-=i=(a|0)-1)-1,l=0;l<8;++l)o=(o+e[l])*u,s=s*u+t[l];if(d=o/s+1,c<a)d/=c;else if(c>a)for(l=0;l<i;++l)d*=a,a++;return n&&(d=n/d),d}const Dm={pdf:function(e,t,n){return e<0?0:e===0&&t===1?1/n:Math.exp((t-1)*Math.log(e)-e/n-mn(t)-t*Math.log(n))},cdf:function(e,t,n){return e<0?0:Yy(t,e/n)},inv:function(r,e,t){return $T(r,e)*t}};function mn(r){let e=0;const t=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18];let n=1.000000000190015,i,s,o;for(o=(s=i=r)+5.5,o-=(i+.5)*Math.log(o);e<6;e++)n+=t[e]/++s;return Math.log(2.5066282746310007*n/i)-o}function Yy(r,e){const t=mn(r);let n=r,i=1/r,s=i,o=e+1-r,a=1/1e-30,l=1/o,u=l,c=1;const d=-~(Math.log(r>=1?r:1/r)*8.5+r*.4+17);let h;if(e<0||r<=0)return NaN;if(e<r+1){for(;c<=d;c++)i+=s*=e/++n;return i*Math.exp(-e+r*Math.log(e)-t)}for(;c<=d;c++)h=-c*(c-r),o+=2,l=h*l+o,a=o+h/a,l=1/l,u*=l*a;return 1-u*Math.exp(-e+r*Math.log(e)-t)}function $T(r,e){let t=0;const n=e-1,i=1e-8,s=mn(e);let o,a,l,u,c,d,h;if(r>=1)return Math.max(100,e+100*Math.sqrt(e));if(r<=0)return 0;for(e>1?(d=Math.log(n),h=Math.exp(n*(d-1)-s),c=r<.5?r:1-r,l=Math.sqrt(-2*Math.log(c)),o=(2.30753+l*.27061)/(1+l*(.99229+l*.04481))-l,r<.5&&(o=-o),o=Math.max(.001,e*Math.pow(1-1/(9*e)-o/(3*Math.sqrt(e)),3))):(l=1-e*(.253+e*.12),r<l?o=Math.pow(r/l,1/e):o=1-Math.log(1-(r-l)/(1-l)));t<12;t++){if(o<=0)return 0;if(a=Yy(e,o)-r,e>1?l=h*Math.exp(-(o-n)+n*(Math.log(o)-d)):l=Math.exp(-o+n*Math.log(o)-s),u=a/l,o-=l=u/(1-.5*Math.min(1,u*((e-1)/o-1))),o<=0&&(o=.5*(o+l)),Math.abs(l)<i*o)break}return o}const Zi={pdf:function(e,t,n){return Math.exp(-.5*Math.log(2*Math.PI)-Math.log(n)-Math.pow(e-t,2)/(2*n*n))},cdf:function(e,t,n){return .5*(1+Zl((e-t)/Math.sqrt(2*n*n)))},inv:function(r,e,t){return-1.4142135623730951*t*jT(2*r)+e}},Bm={pdf:function(e,t,n){return e>1||e<0?0:t==1&&n==1?1:t<512&&n<512?Math.pow(e,t-1)*Math.pow(1-e,n-1)/Xy(t,n):Math.exp((t-1)*Math.log(e)+(n-1)*Math.log(1-e)-zT(t,n))},cdf:function(e,t,n){return e>1||e<0?+(e>1):zp(e,t,n)},inv:function(e,t,n){return Ky(e,t,n)}};function Xy(r,e){if(!(r<=0||e<=0))return r+e>170?Math.exp(zT(r,e)):hc(r)*hc(e)/hc(r+e)}function zT(r,e){return mn(r)+mn(e)-mn(r+e)}function Ky(r,e,t){var n=1e-8,i=e-1,s=t-1,o=0,a,l,u,c,d,h,f,m,p,g,v;if(r<=0)return 0;if(r>=1)return 1;for(e>=1&&t>=1?(u=r<.5?r:1-r,c=Math.sqrt(-2*Math.log(u)),f=(2.30753+c*.27061)/(1+c*(.99229+c*.04481))-c,r<.5&&(f=-f),m=(f*f-3)/6,p=2/(1/(2*e-1)+1/(2*t-1)),g=f*Math.sqrt(m+p)/p-(1/(2*t-1)-1/(2*e-1))*(m+5/6-2/(3*p)),f=e/(e+t*Math.exp(2*g))):(a=Math.log(e/(e+t)),l=Math.log(t/(e+t)),c=Math.exp(e*a)/e,d=Math.exp(t*l)/t,g=c+d,r<c/g?f=Math.pow(e*g*r,1/e):f=1-Math.pow(t*g*(1-r),1/t)),v=-mn(e)-mn(t)+mn(e+t);o<10;o++){if(f===0||f===1)return f;if(h=zp(f,e,t)-r,c=Math.exp(i*Math.log(f)+s*Math.log(1-f)+v),d=h/c,f-=c=d/(1-.5*Math.min(1,d*(i/f-s/(1-f)))),f<=0&&(f=.5*(f+c)),f>=1&&(f=.5*(f+c+1)),Math.abs(c)<n*f&&o>0)break}return f}function zp(r,e,t){var n=r===0||r===1?0:Math.exp(mn(e+t)-mn(e)-mn(t)+e*Math.log(r)+t*Math.log(1-r));return r<0||r>1?!1:r<(e+1)/(e+t+2)?n*pw(r,e,t)/e:1-n*pw(1-r,t,e)/t}function pw(r,e,t){var n=1e-30,i=1,s=e+t,o=e+1,a=e-1,l=1,u=1-s*r/o,c,d,h,f;for(Math.abs(u)<n&&(u=n),u=1/u,f=u;i<=100&&(c=2*i,d=i*(t-i)*r/((a+c)*(e+c)),u=1+d*u,Math.abs(u)<n&&(u=n),l=1+d/l,Math.abs(l)<n&&(l=n),u=1/u,f*=u*l,d=-(e+i)*(s+i)*r/((e+c)*(o+c)),u=1+d*u,Math.abs(u)<n&&(u=n),l=1+d/l,Math.abs(l)<n&&(l=n),u=1/u,h=u*l,f*=h,!(Math.abs(h-1)<3e-7));i++);return f}const _d={pdf:function(r,e,t){return t===0||t===1?e*t===r?1:0:HT(e,r)*Math.pow(t,r)*Math.pow(1-t,e-r)},cdf:function(r,e,t){var n,i=1e-10;if(r<0)return 0;if(r>=e)return 1;if(t<0||t>1||e<=0)return NaN;r=Math.floor(r);var s=t,o=r+1,a=e-r,l=o+a,u=Math.exp(mn(l)-mn(a)-mn(o)+o*Math.log(s)+a*Math.log(1-s));return s<(o+1)/(l+2)?n=u*mw(s,o,a,i):n=1-u*mw(1-s,a,o,i),Math.round((1-n)*(1/i))/(1/i)}};function mw(r,e,t,n){for(var i=0,s=1,o=1,a=1,l=0,u=0,c;Math.abs((o-u)/o)>n;)u=o,c=-(e+l)*(e+t+l)*r/(e+2*l)/(e+2*l+1),i=o+c*i,s=a+c*s,l=l+1,c=l*(t-l)*r/(e+2*l-1)/(e+2*l),o=i+c*o,a=s+c*a,i=i/a,s=s/a,o=o/a,a=1;return o/e}function HT(r,e){return r>170||e>170?Math.exp(ik(r,e)):xd(r)/xd(e)/xd(r-e)}function ik(r,e){return Um(r)-Um(e)-Um(r-e)}function Um(r){return r<0?NaN:mn(r+1)}function xd(r){return r<0?NaN:hc(r+1)}const Pl={pdf:function(e,t){return e<0?0:e===0&&t===2?.5:Math.exp((t/2-1)*Math.log(e)-e/2-t/2*Math.log(2)-mn(t/2))},cdf:function(e,t){return e<0?0:Yy(t/2,e/2)},inv:function(r,e){return 2*$T(r,.5*e)}},Fl={pdf:function(e,t,n){var i,s,o;return e<0?0:t<=2?e===0&&t<2?1/0:e===0&&t===2?1:1/Xy(t/2,n/2)*Math.pow(t/n,t/2)*Math.pow(e,t/2-1)*Math.pow(1+t/n*e,-(t+n)/2):(i=t*e/(n+e*t),s=n/(n+e*t),o=t*s/2,o*_d.pdf((t-2)/2,(t+n-2)/2,i))},cdf:function(e,t,n){return e<0?0:zp(t*e/(t*e+n),t/2,n/2)},inv:function(e,t,n){return n/(t*(1/Ky(e,t/2,n/2)-1))}},gw={pdf:function(e,t,n){return e<0||t<0||n<0?0:n/t*Math.pow(e/t,n-1)*Math.exp(-Math.pow(e/t,n))},cdf:function(e,t,n){return e<0?0:1-Math.exp(-Math.pow(e/t,n))}},r0={pdf:function(e,t){return t<0||e%1!==0||e<0?0:Math.pow(t,e)*Math.exp(-t)/xd(e)},cdf:function(e,t){var n=0;if(e<0)return 0;for(var i=0;n<=e;n++)i+=r0.pdf(n,t);return i}},uo={pdf:function(e,t,n,i){if(e<0||e<n-(t-i))return 0;if(e>i||e>n)return 0;if(n*2>t)return i*2>t?uo.pdf(t-n-i+e,t,t-n,t-i):uo.pdf(i-e,t,t-n,i);if(i*2>t)return uo.pdf(n-e,t,n,t-i);if(n<i)return uo.pdf(e,t,i,n);for(var s=1,o=0,a=0;a<e;a++){for(;s>1&&o<i;)s*=1-n/(t-o),o++;s*=(i-a)*(n-a)/((a+1)*(t-n-i+a+1))}for(;o<i;o++)s*=1-n/(t-o);return Math.min(1,Math.max(0,s))},cdf:function r(e,t,n,i){if(e<0||e<n-(t-i))return 0;if(e>=i||e>=n)return 1;if(n*2>t)return i*2>t?r(t-n-i+e,t,t-n,t-i):1-uo.cdf(i-e-1,t,t-n,i);if(i*2>t)return 1-uo.cdf(n-e-1,t,n,t-i);if(n<i)return uo.cdf(e,t,i,n);for(var s=1,o=1,a=0,l=0;l<e;l++){for(;s>1&&a<i;){var u=1-n/(t-a);o*=u,s*=u,a++}o*=(i-l)*(n-l)/((l+1)*(t-n-i+l+1)),s+=o}for(;a<i;a++)s*=1-n/(t-a);return Math.min(1,Math.max(0,s))}},Li={pdf:function(e,t){return t=t>1e100?1e100:t,1/(Math.sqrt(t)*Xy(.5,t/2))*Math.pow(1+e*e/t,-((t+1)/2))},cdf:function(e,t){var n=t/2;return zp((e+Math.sqrt(e*e+t))/(2*Math.sqrt(e*e+t)),n,n)},inv:function(r,e){var t=Ky(2*Math.min(r,1-r),.5*e,.5);return t=Math.sqrt(e*(1-t)/t),r>.5?t:-t}},Vm={pdf:function(e,t,n){return e<=0?0:Math.exp(-Math.log(e)-.5*Math.log(2*Math.PI)-Math.log(n)-Math.pow(Math.log(e)-t,2)/(2*n*n))},cdf:function(e,t,n){return e<0?0:.5+.5*Zl((Math.log(e)-t)/Math.sqrt(2*n*n))},inv:function(r,e,t){return Math.exp(-1.4142135623730951*t*jT(2*r)+e)}},n0={pdf:function(e,t,n){return e!==e>>>0?!1:e<0?0:HT(e+t-1,t-1)*Math.pow(1-n,e)*Math.pow(n,t)},cdf:function(e,t,n){var i=0,s=0;if(e<0)return 0;for(;s<=e;s++)i+=n0.pdf(s,t,n);return i}};function WT(r){for(var e=0,t=r.length;--t>=0;)e+=r[t];return e}function Fi(r){return WT(r)/r.length}function Pa(r){for(var e=Fi(r),t=0,n=r.length,i;--n>=0;)i=r[n]-e,t+=i*i;return t}function Vu(r,e){return Pa(r)/(r.length-(e?1:0))}function na(r,e){return Math.sqrt(Vu(r,e))}function sk(){var r=[].slice.call(arguments),e=new Array(2),t;return r.length===4?t=Math.abs(Zi.inv(r[1]/2,0,1)*r[2]/Math.sqrt(r[3])):t=Math.abs(Zi.inv(r[1]/2,0,1)*na(r[2])/Math.sqrt(r[2].length)),e[0]=r[0]-t,e[1]=r[0]+t,e}function ok(){var r=[].slice.call(arguments),e=new Array(2),t;return r.length===4?t=Math.abs(Li.inv(r[1]/2,r[3]-1)*r[2]/Math.sqrt(r[3])):t=Math.abs(Li.inv(r[1]/2,r[2].length-1)*na(r[2],!0)/Math.sqrt(r[2].length)),e[0]=r[0]-t,e[1]=r[0]+t,e}function ak(r){for(var e=1,t=r.length;--t>=0;)e*=r[t];return e}function lk(r){return Math.pow(ak(r),1/r.length)}function ju(r,e){var t=Fi(r),n=Fi(e),i=r.length,s=new Array(i),o;for(o=0;o<i;o++)s[o]=(r[o]-t)*(e[o]-n);return WT(s)/(i-1)}function yw(r,e){return ju(r,e)/na(r,1)/na(e,1)}class Zy extends At{erf(e,t){return this.runFunction(e.args,t,this.metadata("ERF"),(n,i)=>i===void 0?Zl(n):Zl(i)-Zl(n))}erfc(e,t){return this.runFunction(e.args,t,this.metadata("ERFC"),VT)}expondist(e,t){return this.runFunction(e.args,t,this.metadata("EXPON.DIST"),(n,i,s)=>s?fw.cdf(n,i):fw.pdf(n,i))}fisher(e,t){return this.runFunction(e.args,t,this.metadata("FISHER"),n=>Math.log((1+n)/(1-n))/2)}fisherinv(e,t){return this.runFunction(e.args,t,this.metadata("FISHERINV"),n=>1-2/(Math.exp(2*n)+1))}gamma(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA"),hc)}gammadist(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA.DIST"),(n,i,s,o)=>o?Dm.cdf(n,i,s):Dm.pdf(n,i,s))}gammaln(e,t){return this.runFunction(e.args,t,this.metadata("GAMMALN"),mn)}gammainv(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA.INV"),Dm.inv)}gauss(e,t){return this.runFunction(e.args,t,this.metadata("GAUSS"),n=>Zi.cdf(n,0,1)-.5)}betadist(e,t){return this.runFunction(e.args,t,this.metadata("BETA.DIST"),(n,i,s,o,a,l)=>n<=a?new J(te.NUM,ue.ValueSmall):n>=l?new J(te.NUM,ue.ValueLarge):(n=(n-a)/(l-a),o?Bm.cdf(n,i,s):Bm.pdf(n,i,s)))}betainv(e,t){return this.runFunction(e.args,t,this.metadata("BETA.INV"),(n,i,s,o,a)=>o>=a?new J(te.NUM,ue.WrongOrder):Bm.inv(n,i,s)*(a-o)+o)}binomialdist(e,t){return this.runFunction(e.args,t,this.metadata("BINOM.DIST"),(n,i,s,o)=>n>i?new J(te.NUM,ue.WrongOrder):(n=Math.trunc(n),i=Math.trunc(i),o?_d.cdf(n,i,s):_d.pdf(n,i,s)))}binomialinv(e,t){return this.runFunction(e.args,t,this.metadata("BINOM.INV"),(n,i,s)=>{n=Math.trunc(n);let o=-1,a=n;for(;a>o+1;){const l=Math.trunc((o+a)/2);_d.cdf(l,n,i)>=s?a=l:o=l}return a})}besselifn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELI"),(n,i)=>t0(n,Math.trunc(i)))}besseljfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELJ"),(n,i)=>e0(n,Math.trunc(i)))}besselkfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELK"),(n,i)=>nk(n,Math.trunc(i)))}besselyfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELY"),(n,i)=>rk(n,Math.trunc(i)))}chisqdist(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.DIST"),(n,i,s)=>(i=Math.trunc(i),s?Pl.cdf(n,i):Pl.pdf(n,i)))}chisqdistrt(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.DIST.RT"),(n,i)=>1-Pl.cdf(n,Math.trunc(i)))}chisqinv(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.INV"),(n,i)=>Pl.inv(n,Math.trunc(i)))}chisqinvrt(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.INV.RT"),(n,i)=>Pl.inv(1-n,Math.trunc(i)))}fdist(e,t){return this.runFunction(e.args,t,this.metadata("F.DIST"),(n,i,s,o)=>(i=Math.trunc(i),s=Math.trunc(s),o?Fl.cdf(n,i,s):Fl.pdf(n,i,s)))}fdistrt(e,t){return this.runFunction(e.args,t,this.metadata("F.DIST.RT"),(n,i,s)=>1-Fl.cdf(n,Math.trunc(i),Math.trunc(s)))}finv(e,t){return this.runFunction(e.args,t,this.metadata("F.INV"),(n,i,s)=>Fl.inv(n,Math.trunc(i),Math.trunc(s)))}finvrt(e,t){return this.runFunction(e.args,t,this.metadata("F.INV.RT"),(n,i,s)=>Fl.inv(1-n,Math.trunc(i),Math.trunc(s)))}weibulldist(e,t){return this.runFunction(e.args,t,this.metadata("WEIBULL.DIST"),(n,i,s,o)=>o?gw.cdf(n,s,i):gw.pdf(n,s,i))}poissondist(e,t){return this.runFunction(e.args,t,this.metadata("POISSON.DIST"),(n,i,s)=>(n=Math.trunc(n),s?r0.cdf(n,i):r0.pdf(n,i)))}hypgeomdist(e,t){return this.runFunction(e.args,t,this.metadata("HYPGEOM.DIST"),(n,i,s,o,a)=>n>i||n>s||i>o||s>o?new J(te.NUM,ue.ValueLarge):n+o<s+i?new J(te.NUM,ue.ValueLarge):(n=Math.trunc(n),i=Math.trunc(i),s=Math.trunc(s),o=Math.trunc(o),a?uo.cdf(n,o,s,i):uo.pdf(n,o,s,i)))}tdist(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST"),(n,i,s)=>(i=Math.trunc(i),s?Li.cdf(n,i):Li.pdf(n,i)))}tdist2t(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST.2T"),(n,i)=>(1-Li.cdf(n,Math.trunc(i)))*2)}tdistrt(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST.RT"),(n,i)=>1-Li.cdf(n,Math.trunc(i)))}tdistold(e,t){return this.runFunction(e.args,t,this.metadata("TDIST"),(n,i,s)=>s*(1-Li.cdf(n,Math.trunc(i))))}tinv(e,t){return this.runFunction(e.args,t,this.metadata("T.INV"),(n,i)=>Li.inv(n,Math.trunc(i)))}tinv2t(e,t){return this.runFunction(e.args,t,this.metadata("T.INV.2T"),(n,i)=>Li.inv(1-n/2,Math.trunc(i)))}lognormdist(e,t){return this.runFunction(e.args,t,this.metadata("LOGNORM.DIST"),(n,i,s,o)=>o?Vm.cdf(n,i,s):Vm.pdf(n,i,s))}lognorminv(e,t){return this.runFunction(e.args,t,this.metadata("LOGNORM.INV"),(n,i,s)=>Vm.inv(n,i,s))}normdist(e,t){return this.runFunction(e.args,t,this.metadata("NORM.DIST"),(n,i,s,o)=>o?Zi.cdf(n,i,s):Zi.pdf(n,i,s))}norminv(e,t){return this.runFunction(e.args,t,this.metadata("NORM.INV"),(n,i,s)=>Zi.inv(n,i,s))}normsdist(e,t){return this.runFunction(e.args,t,this.metadata("NORM.S.DIST"),(n,i)=>i?Zi.cdf(n,0,1):Zi.pdf(n,0,1))}normsinv(e,t){return this.runFunction(e.args,t,this.metadata("NORM.S.INV"),n=>Zi.inv(n,0,1))}phi(e,t){return this.runFunction(e.args,t,this.metadata("PHI"),n=>Zi.pdf(n,0,1))}negbinomdist(e,t){return this.runFunction(e.args,t,this.metadata("NEGBINOM.DIST"),(n,i,s,o)=>(n=Math.trunc(n),i=Math.trunc(i),o?n0.cdf(n,i,s):n0.pdf(n,i,s)))}confidencenorm(e,t){return this.runFunction(e.args,t,this.metadata("CONFIDENCE.NORM"),(n,i,s)=>sk(1,n,i,Math.trunc(s))[1]-1)}confidencet(e,t){return this.runFunction(e.args,t,this.metadata("CONFIDENCE.T"),(n,i,s)=>(s=Math.trunc(s),s===1?new J(te.DIV_BY_ZERO):ok(1,n,i,s)[1]-1))}standardize(e,t){return this.runFunction(e.args,t,this.metadata("STANDARDIZE"),(n,i,s)=>(n-i)/s)}}Zy.implementedFunctions={ERF:{method:"erf",parameters:[{argumentType:z.NUMBER},{argumentType:z.NUMBER,optionalArg:!0}]},ERFC:{method:"erfc",parameters:[{argumentType:z.NUMBER}]},"EXPON.DIST":{method:"expondist",parameters:[{argumentType:z.NUMBER,minValue:0},{argumentType:z.NUMBER,greaterThan:0},{argumentType:z.BOOLEAN}]},FISHER:{method:"fisher",parameters:[{argumentType:z.NUMBER,greaterThan:-1,lessThan:1}]},FISHERINV:{method:"fisherinv",parameters:[{argumentType:z.NUMBER}]},GAMMA:{method:"gamma",parameters:[{argumentType:z.NUMBER}]},"GAMMA.DIST":{method:"gammadist",parameters:[{argumentType:z.NUMBER,minValue:0},{argumentType:z.NUMBER,greaterThan:0},{argumentType:z.NUMBER,greaterThan:0},{argumentType:z.BOOLEAN}]},GAMMALN:{method:"gammaln",parameters:[{argumentType:z.NUMBER,greaterThan:0}]},"GAMMA.INV":{method:"gammainv",parameters:[{argumentType:z.NUMBER,minValue:0,lessThan:1},{argumentType:z.NUMBER,greaterThan:0},{argumentType:z.NUMBER,greaterThan:0}]},GAUSS:{method:"gauss",parameters:[{argumentType:z.NUMBER}]},"BETA.DIST":{method:"betadist",parameters:[{argumentType:z.NUMBER},{argumentType:z.NUMBER,greaterThan:0},{argumentType:z.NUMBER,greaterThan:0},{argumentType:z.BOOLEAN},{argumentType:z.NUMBER,defaultValue:0},{argumentType:z.NUMBER,defaultValue:1}]},"BETA.INV":{method:"betainv",parameters:[{argumentType:z.NUMBER,greaterThan:0,maxValue:1},{argumentType:z.NUMBER,greaterThan:0},{argumentType:z.NUMBER,greaterThan:0},{argumentType:z.NUMBER,defaultValue:0},{argumentType:z.NUMBER,defaultValue:1}]},"BINOM.DIST":{method:"binomialdist",parameters:[{argumentType:z.NUMBER,minValue:0},{argumentType:z.NUMBER,minValue:0},{argumentType:z.NUMBER,minValue:0,maxValue:1},{argumentType:z.BOOLEAN}]},"BINOM.INV":{method:"binomialinv",parameters:[{argumentType:z.NUMBER,minValue:0},{argumentType:z.NUMBER,minValue:0,maxValue:1},{argumentType:z.NUMBER,greaterThan:0,lessThan:1}]},BESSELI:{method:"besselifn",parameters:[{argumentType:z.NUMBER},{argumentType:z.NUMBER,minValue:0}]},BESSELJ:{method:"besseljfn",parameters:[{argumentType:z.NUMBER},{argumentType:z.NUMBER,minValue:0}]},BESSELK:{method:"besselkfn",parameters:[{argumentType:z.NUMBER},{argumentType:z.NUMBER,minValue:0}]},BESSELY:{method:"besselyfn",parameters:[{argumentType:z.NUMBER},{argumentType:z.NUMBER,minValue:0}]},"CHISQ.DIST":{method:"chisqdist",parameters:[{argumentType:z.NUMBER},{argumentType:z.NUMBER,minValue:1,maxValue:1e10},{argumentType:z.BOOLEAN}]},"CHISQ.DIST.RT":{method:"chisqdistrt",parameters:[{argumentType:z.NUMBER},{argumentType:z.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV":{method:"chisqinv",parameters:[{argumentType:z.NUMBER,minValue:0,maxValue:1},{argumentType:z.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV.RT":{method:"chisqinvrt",parameters:[{argumentType:z.NUMBER,minValue:0,maxValue:1},{argumentType:z.NUMBER,minValue:1}]},"F.DIST":{method:"fdist",parameters:[{argumentType:z.NUMBER,minValue:0},{argumentType:z.NUMBER,minValue:1},{argumentType:z.NUMBER,minValue:1},{argumentType:z.BOOLEAN}]},"F.DIST.RT":{method:"fdistrt",parameters:[{argumentType:z.NUMBER,minValue:0},{argumentType:z.NUMBER,minValue:1},{argumentType:z.NUMBER,minValue:1}]},"F.INV":{method:"finv",parameters:[{argumentType:z.NUMBER,minValue:0,maxValue:1},{argumentType:z.NUMBER,minValue:1},{argumentType:z.NUMBER,minValue:1}]},"F.INV.RT":{method:"finvrt",parameters:[{argumentType:z.NUMBER,minValue:0,maxValue:1},{argumentType:z.NUMBER,minValue:1},{argumentType:z.NUMBER,minValue:1}]},"WEIBULL.DIST":{method:"weibulldist",parameters:[{argumentType:z.NUMBER,minValue:0},{argumentType:z.NUMBER,greaterThan:0},{argumentType:z.NUMBER,greaterThan:0},{argumentType:z.BOOLEAN}]},"POISSON.DIST":{method:"poissondist",parameters:[{argumentType:z.NUMBER,minValue:0},{argumentType:z.NUMBER,minValue:0},{argumentType:z.BOOLEAN}]},"HYPGEOM.DIST":{method:"hypgeomdist",parameters:[{argumentType:z.NUMBER,minValue:0},{argumentType:z.NUMBER,greaterThan:0},{argumentType:z.NUMBER,greaterThan:0},{argumentType:z.NUMBER,greaterThan:0},{argumentType:z.BOOLEAN}]},"T.DIST":{method:"tdist",parameters:[{argumentType:z.NUMBER},{argumentType:z.NUMBER,minValue:1},{argumentType:z.BOOLEAN}]},"T.DIST.2T":{method:"tdist2t",parameters:[{argumentType:z.NUMBER,minValue:0},{argumentType:z.NUMBER,minValue:1}]},"T.DIST.RT":{method:"tdistrt",parameters:[{argumentType:z.NUMBER},{argumentType:z.NUMBER,minValue:1}]},TDIST:{method:"tdistold",parameters:[{argumentType:z.NUMBER,minValue:0},{argumentType:z.NUMBER,minValue:1},{argumentType:z.INTEGER,minValue:1,maxValue:2}]},"T.INV":{method:"tinv",parameters:[{argumentType:z.NUMBER,greaterThan:0,lessThan:1},{argumentType:z.NUMBER,minValue:1}]},"T.INV.2T":{method:"tinv2t",parameters:[{argumentType:z.NUMBER,greaterThan:0,maxValue:1},{argumentType:z.NUMBER,minValue:1}]},"LOGNORM.DIST":{method:"lognormdist",parameters:[{argumentType:z.NUMBER,greaterThan:0},{argumentType:z.NUMBER},{argumentType:z.NUMBER,greaterThan:0},{argumentType:z.BOOLEAN}]},"LOGNORM.INV":{method:"lognorminv",parameters:[{argumentType:z.NUMBER,greaterThan:0,lessThan:1},{argumentType:z.NUMBER},{argumentType:z.NUMBER,greaterThan:0}]},"NORM.DIST":{method:"normdist",parameters:[{argumentType:z.NUMBER},{argumentType:z.NUMBER},{argumentType:z.NUMBER,greaterThan:0},{argumentType:z.BOOLEAN}]},"NORM.INV":{method:"norminv",parameters:[{argumentType:z.NUMBER,greaterThan:0,lessThan:1},{argumentType:z.NUMBER},{argumentType:z.NUMBER,greaterThan:0}]},"NORM.S.DIST":{method:"normsdist",parameters:[{argumentType:z.NUMBER},{argumentType:z.BOOLEAN}]},"NORM.S.INV":{method:"normsinv",parameters:[{argumentType:z.NUMBER,greaterThan:0,lessThan:1}]},PHI:{method:"phi",parameters:[{argumentType:z.NUMBER}]},"NEGBINOM.DIST":{method:"negbinomdist",parameters:[{argumentType:z.NUMBER,minValue:0},{argumentType:z.NUMBER,minValue:1},{argumentType:z.NUMBER,minValue:0,maxValue:1},{argumentType:z.BOOLEAN}]},"CONFIDENCE.NORM":{method:"confidencenorm",parameters:[{argumentType:z.NUMBER,greaterThan:0,lessThan:1},{argumentType:z.NUMBER,greaterThan:0},{argumentType:z.NUMBER,minValue:1}]},"CONFIDENCE.T":{method:"confidencet",parameters:[{argumentType:z.NUMBER,greaterThan:0,lessThan:1},{argumentType:z.NUMBER,greaterThan:0},{argumentType:z.NUMBER,minValue:1}]},STANDARDIZE:{method:"standardize",parameters:[{argumentType:z.NUMBER},{argumentType:z.NUMBER},{argumentType:z.NUMBER,greaterThan:0}]}};Zy.aliases={NEGBINOMDIST:"NEGBINOM.DIST",EXPONDIST:"EXPON.DIST",BETADIST:"BETA.DIST",NORMDIST:"NORM.DIST",NORMINV:"NORM.INV",NORMSDIST:"NORM.S.DIST",NORMSINV:"NORM.S.INV",LOGNORMDIST:"LOGNORM.DIST",LOGINV:"LOGNORM.INV",TINV:"T.INV.2T",HYPGEOMDIST:"HYPGEOM.DIST",POISSON:"POISSON.DIST",WEIBULL:"WEIBULL.DIST",FINV:"F.INV.RT",FDIST:"F.DIST.RT",CHIDIST:"CHISQ.DIST.RT",CHIINV:"CHISQ.INV.RT",GAMMADIST:"GAMMA.DIST","GAMMALN.PRECISE":"GAMMALN",GAMMAINV:"GAMMA.INV",BETAINV:"BETA.INV",BINOMDIST:"BINOM.DIST",CONFIDENCE:"CONFIDENCE.NORM",CRITBINOM:"BINOM.INV",WEIBULLDIST:"WEIBULL.DIST",TINV2T:"T.INV.2T",TDISTRT:"T.DIST.RT",TDIST2T:"T.DIST.2T",FINVRT:"F.INV.RT",FDISTRT:"F.DIST.RT",CHIDISTRT:"CHISQ.DIST.RT",CHIINVRT:"CHISQ.INV.RT",LOGNORMINV:"LOGNORM.INV",POISSONDIST:"POISSON.DIST"};class GT extends At{fact(e,t){return this.runFunction(e.args,t,this.metadata("FACT"),n=>{n=Math.trunc(n);let i=1;for(let s=1;s<=n;s++)i*=s;return i})}factdouble(e,t){return this.runFunction(e.args,t,this.metadata("FACTDOUBLE"),n=>{n=Math.trunc(n);let i=1;for(let s=n;s>=1;s-=2)i*=s;return i})}combin(e,t){return this.runFunction(e.args,t,this.metadata("COMBIN"),(n,i)=>i>n?new J(te.NUM,ue.WrongOrder):(n=Math.trunc(n),i=Math.trunc(i),vw(n,i)))}combina(e,t){return this.runFunction(e.args,t,this.metadata("COMBINA"),(n,i)=>(n=Math.trunc(n),i=Math.trunc(i),n+i-1>=1030?new J(te.NUM,ue.ValueLarge):n===0&&i===0?1:vw(n+i-1,i)))}gcd(e,t){return this.runFunction(e.args,t,this.metadata("GCD"),(...n)=>{const i=this.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(n);if(i instanceof J)return i;let s=0;for(const o of i){if(o<0)return new J(te.NUM,ue.ValueSmall);s=qT(s,Math.trunc(o))}return s>Number.MAX_SAFE_INTEGER?new J(te.NUM,ue.ValueLarge):s})}lcm(e,t){return this.runFunction(e.args,t,this.metadata("LCM"),(...n)=>{const i=this.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(n);if(i instanceof J)return i;let s=1;for(const o of i){if(o<0)return new J(te.NUM,ue.ValueSmall);s=uk(s,Math.trunc(o))}return s>Number.MAX_SAFE_INTEGER?new J(te.NUM,ue.ValueLarge):s})}mround(e,t){return this.runFunction(e.args,t,this.metadata("MROUND"),(n,i)=>i===0?0:n>0&&i<0||n<0&&i>0?new J(te.NUM,ue.DistinctSigns):Math.round(n/i)*i)}multinomial(e,t){return this.runFunction(e.args,t,this.metadata("MULTINOMIAL"),(...n)=>{let i=0,s=1;for(let o of n){if(o<0)return new J(te.NUM,ue.ValueSmall);o=Math.trunc(o);for(let a=1;a<=o;a++)s*=(i+a)/a;i+=o}return Math.round(s)})}quotient(e,t){return this.runFunction(e.args,t,this.metadata("QUOTIENT"),(n,i)=>i===0?new J(te.DIV_BY_ZERO):Math.trunc(n/i))}seriessum(e,t){return this.runFunction(e.args,t,this.metadata("SERIESSUM"),(n,i,s,o)=>{const a=this.arithmeticHelper.manyToOnlyNumbersDropNulls(o.valuesFromTopLeftCorner());if(a instanceof J)return a;let l=0;a.reverse();for(const u of a)l*=Math.pow(n,s),l+=u;return l*Math.pow(n,i)})}sign(e,t){return this.runFunction(e.args,t,this.metadata("SIGN"),n=>n>0?1:n<0?-1:0)}sumx2my2(e,t){return this.runFunction(e.args,t,this.metadata("SUMX2MY2"),(n,i)=>{const s=n.valuesFromTopLeftCorner(),o=i.valuesFromTopLeftCorner();if(s.length!==o.length)return new J(te.NA,ue.EqualLength);const a=s.length;let l=0;for(let u=0;u<a;u++){const c=s[u],d=o[u];if(c instanceof J)return c;if(d instanceof J)return d;typeof c=="number"&&typeof d=="number"&&(l+=Math.pow(c,2)-Math.pow(d,2))}return l})}sumx2py2(e,t){return this.runFunction(e.args,t,this.metadata("SUMX2PY2"),(n,i)=>{const s=n.valuesFromTopLeftCorner(),o=i.valuesFromTopLeftCorner();if(s.length!==o.length)return new J(te.NA,ue.EqualLength);const a=s.length;let l=0;for(let u=0;u<a;u++){const c=s[u],d=o[u];if(c instanceof J)return c;if(d instanceof J)return d;typeof c=="number"&&typeof d=="number"&&(l+=Math.pow(c,2)+Math.pow(d,2))}return l})}sumxmy2(e,t){return this.runFunction(e.args,t,this.metadata("SUMXMY2"),(n,i)=>{const s=n.valuesFromTopLeftCorner(),o=i.valuesFromTopLeftCorner();if(s.length!==o.length)return new J(te.NA,ue.EqualLength);const a=s.length;let l=0;for(let u=0;u<a;u++){const c=s[u],d=o[u];if(c instanceof J)return c;if(d instanceof J)return d;typeof c=="number"&&typeof d=="number"&&(l+=Math.pow(c-d,2))}return l})}}GT.implementedFunctions={FACT:{method:"fact",parameters:[{argumentType:z.NUMBER,minValue:0,maxValue:170}]},FACTDOUBLE:{method:"factdouble",parameters:[{argumentType:z.NUMBER,minValue:0,maxValue:288}]},COMBIN:{method:"combin",parameters:[{argumentType:z.NUMBER,minValue:0,lessThan:1030},{argumentType:z.NUMBER,minValue:0}]},COMBINA:{method:"combina",parameters:[{argumentType:z.NUMBER,minValue:0},{argumentType:z.NUMBER,minValue:0}]},GCD:{method:"gcd",parameters:[{argumentType:z.ANY}],repeatLastArgs:1},LCM:{method:"lcm",parameters:[{argumentType:z.ANY}],repeatLastArgs:1},MROUND:{method:"mround",parameters:[{argumentType:z.NUMBER},{argumentType:z.NUMBER}]},MULTINOMIAL:{method:"multinomial",parameters:[{argumentType:z.NUMBER}],repeatLastArgs:1,expandRanges:!0},QUOTIENT:{method:"quotient",parameters:[{argumentType:z.NUMBER},{argumentType:z.NUMBER}]},SERIESSUM:{method:"seriessum",parameters:[{argumentType:z.NUMBER},{argumentType:z.NUMBER},{argumentType:z.NUMBER},{argumentType:z.RANGE}]},SIGN:{method:"sign",parameters:[{argumentType:z.NUMBER}]},SUMX2MY2:{method:"sumx2my2",parameters:[{argumentType:z.RANGE},{argumentType:z.RANGE}]},SUMX2PY2:{method:"sumx2py2",parameters:[{argumentType:z.RANGE},{argumentType:z.RANGE}]},SUMXMY2:{method:"sumxmy2",parameters:[{argumentType:z.RANGE},{argumentType:z.RANGE}]}};function vw(r,e){2*e>r&&(e=r-e);let t=1;for(let n=1;n<=e;n++)t*=(r-e+n)/n;return Math.round(t)}function qT(r,e){for(r<e&&([r,e]=[e,r]);e>0;)[r,e]=[e,r%e];return r}function uk(r,e){return r===0||e===0?0:r*(e/qT(r,e))}class YT extends At{complex(e,t){return this.runFunction(e.args,t,this.metadata("COMPLEX"),(n,i,s)=>s!=="i"&&s!=="j"?new J(te.VALUE,ue.ShouldBeIorJ):Ur([n,i],s))}imabs(e,t){return this.runFunction(e.args,t,this.metadata("IMABS"),ZT)}imaginary(e,t){return this.runFunction(e.args,t,this.metadata("IMAGINARY"),([n,i])=>i)}imreal(e,t){return this.runFunction(e.args,t,this.metadata("IMREAL"),([n,i])=>n)}imargument(e,t){return this.runFunction(e.args,t,this.metadata("IMARGUMENT"),([n,i])=>n===0&&i===0?new J(te.DIV_BY_ZERO):Math.atan2(i,n))}imconjugate(e,t){return this.runFunction(e.args,t,this.metadata("IMCONJUGATE"),([n,i])=>Ur([n,-i]))}imcos(e,t){return this.runFunction(e.args,t,this.metadata("IMCOS"),n=>Ur(jh(n)))}imcosh(e,t){return this.runFunction(e.args,t,this.metadata("IMCOSH"),n=>Ur(bw(n)))}imcot(e,t){return this.runFunction(e.args,t,this.metadata("IMCOT"),n=>Ur(Ma(jh(n),$h(n))))}imcsc(e,t){return this.runFunction(e.args,t,this.metadata("IMCSC"),n=>Ur(Ma([1,0],$h(n))))}imcsch(e,t){return this.runFunction(e.args,t,this.metadata("IMCSCH"),n=>Ur(Ma([1,0],ww(n))))}imsec(e,t){return this.runFunction(e.args,t,this.metadata("IMSEC"),n=>Ur(Ma([1,0],jh(n))))}imsech(e,t){return this.runFunction(e.args,t,this.metadata("IMSECH"),n=>Ur(Ma([1,0],bw(n))))}imsin(e,t){return this.runFunction(e.args,t,this.metadata("IMSIN"),n=>Ur($h(n)))}imsinh(e,t){return this.runFunction(e.args,t,this.metadata("IMSINH"),n=>Ur(ww(n)))}imtan(e,t){return this.runFunction(e.args,t,this.metadata("IMTAN"),n=>Ur(Ma($h(n),jh(n))))}imdiv(e,t){return this.runFunction(e.args,t,this.metadata("IMDIV"),(n,i)=>Ur(Ma(n,i)))}improduct(e,t){return this.runFunction(e.args,t,this.metadata("IMPRODUCT"),(...n)=>{const i=this.arithmeticHelper.coerceComplexExactRanges(n);if(i instanceof J)return i;let s=[1,0];for(const o of i)s=XT(s,o);return Ur(s)})}imsum(e,t){return this.runFunction(e.args,t,this.metadata("IMSUM"),(...n)=>{const i=this.arithmeticHelper.coerceComplexExactRanges(n);if(i instanceof J)return i;let s=[0,0];for(const o of i)s=ck(s,o);return Ur(s)})}imsub(e,t){return this.runFunction(e.args,t,this.metadata("IMSUB"),(n,i)=>Ur(hk(n,i)))}imexp(e,t){return this.runFunction(e.args,t,this.metadata("IMEXP"),n=>Ur(KT(n)))}imln(e,t){return this.runFunction(e.args,t,this.metadata("IMLN"),n=>Ur(Ed(n)))}imlog10(e,t){return this.runFunction(e.args,t,this.metadata("IMLOG10"),n=>{const[i,s]=Ed(n),o=Math.log(10);return Ur([i/o,s/o])})}imlog2(e,t){return this.runFunction(e.args,t,this.metadata("IMLOG2"),n=>{const[i,s]=Ed(n),o=Math.log(2);return Ur([i/o,s/o])})}impower(e,t){return this.runFunction(e.args,t,this.metadata("IMPOWER"),(n,i)=>Ur(_w(n,i)))}imsqrt(e,t){return this.runFunction(e.args,t,this.metadata("IMSQRT"),n=>Ur(_w(n,.5)))}}YT.implementedFunctions={COMPLEX:{method:"complex",parameters:[{argumentType:z.NUMBER},{argumentType:z.NUMBER},{argumentType:z.STRING,defaultValue:"i"}]},IMABS:{method:"imabs",parameters:[{argumentType:z.COMPLEX}]},IMAGINARY:{method:"imaginary",parameters:[{argumentType:z.COMPLEX}]},IMREAL:{method:"imreal",parameters:[{argumentType:z.COMPLEX}]},IMARGUMENT:{method:"imargument",parameters:[{argumentType:z.COMPLEX}]},IMCONJUGATE:{method:"imconjugate",parameters:[{argumentType:z.COMPLEX}]},IMCOS:{method:"imcos",parameters:[{argumentType:z.COMPLEX}]},IMCOSH:{method:"imcosh",parameters:[{argumentType:z.COMPLEX}]},IMCOT:{method:"imcot",parameters:[{argumentType:z.COMPLEX}]},IMCSC:{method:"imcsc",parameters:[{argumentType:z.COMPLEX}]},IMCSCH:{method:"imcsch",parameters:[{argumentType:z.COMPLEX}]},IMSEC:{method:"imsec",parameters:[{argumentType:z.COMPLEX}]},IMSECH:{method:"imsech",parameters:[{argumentType:z.COMPLEX}]},IMSIN:{method:"imsin",parameters:[{argumentType:z.COMPLEX}]},IMSINH:{method:"imsinh",parameters:[{argumentType:z.COMPLEX}]},IMTAN:{method:"imtan",parameters:[{argumentType:z.COMPLEX}]},IMDIV:{method:"imdiv",parameters:[{argumentType:z.COMPLEX},{argumentType:z.COMPLEX}]},IMPRODUCT:{method:"improduct",parameters:[{argumentType:z.ANY}],repeatLastArgs:1},IMSUM:{method:"imsum",parameters:[{argumentType:z.ANY}],repeatLastArgs:1},IMSUB:{method:"imsub",parameters:[{argumentType:z.COMPLEX},{argumentType:z.COMPLEX}]},IMEXP:{method:"imexp",parameters:[{argumentType:z.COMPLEX}]},IMLN:{method:"imln",parameters:[{argumentType:z.COMPLEX}]},IMLOG10:{method:"imlog10",parameters:[{argumentType:z.COMPLEX}]},IMLOG2:{method:"imlog2",parameters:[{argumentType:z.COMPLEX}]},IMPOWER:{method:"impower",parameters:[{argumentType:z.COMPLEX},{argumentType:z.NUMBER}]},IMSQRT:{method:"imsqrt",parameters:[{argumentType:z.COMPLEX}]}};function ck([r,e],[t,n]){return[r+t,e+n]}function hk([r,e],[t,n]){return[r-t,e-n]}function XT([r,e],[t,n]){return[r*t-e*n,r*n+t*e]}function Ma([r,e],[t,n]){const i=Math.pow(t,2)+Math.pow(n,2),[s,o]=XT([r,e],[t,-n]);return[s/i,o/i]}function jh([r,e]){return[Math.cos(r)*Math.cosh(e),-Math.sin(r)*Math.sinh(e)]}function bw([r,e]){return[Math.cosh(r)*Math.cos(e),Math.sinh(r)*Math.sin(e)]}function $h([r,e]){return[Math.sin(r)*Math.cosh(e),Math.cos(r)*Math.sinh(e)]}function ww([r,e]){return[Math.sinh(r)*Math.cos(e),Math.cosh(r)*Math.sin(e)]}function KT([r,e]){return[Math.exp(r)*Math.cos(e),Math.exp(r)*Math.sin(e)]}function ZT([r,e]){return Math.sqrt(r*r+e*e)}function Ed([r,e]){return[Math.log(ZT([r,e])),Math.atan2(e,r)]}function _w(r,e){const[t,n]=Ed(r);return KT([e*t,e*n])}class Qy extends At{avedev(e,t){return this.runFunction(e.args,t,this.metadata("AVEDEV"),(...n)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(n);if(i instanceof J)return i;if(i.length===0)return new J(te.DIV_BY_ZERO);const s=Fi(i);return i.reduce((o,a)=>o+Math.abs(a-s),0)/i.length})}devsq(e,t){return this.runFunction(e.args,t,this.metadata("DEVSQ"),(...n)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(n);return i instanceof J?i:i.length===0?0:Pa(i)})}geomean(e,t){return this.runFunction(e.args,t,this.metadata("GEOMEAN"),(...n)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(n);if(i instanceof J)return i;if(i.length===0)return new J(te.NUM,ue.OneValue);for(const s of i)if(s<=0)return new J(te.NUM,ue.ValueSmall);return lk(i)})}harmean(e,t){return this.runFunction(e.args,t,this.metadata("HARMEAN"),(...n)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(n);if(i instanceof J)return i;if(i.length===0)return new J(te.NUM,ue.OneValue);for(const s of i)if(s<=0)return new J(te.NUM,ue.ValueSmall);return i.length/i.reduce((s,o)=>s+1/o,0)})}correl(e,t){return this.runFunction(e.args,t,this.metadata("CORREL"),(n,i)=>{if(n.numberOfElements()!==i.numberOfElements())return new J(te.NA,ue.EqualLength);const s=Oa(n,i);return s instanceof J?s:s[0].length<=1?new J(te.DIV_BY_ZERO,ue.TwoValues):yw(s[0],s[1])})}rsq(e,t){return this.runFunction(e.args,t,this.metadata("RSQ"),(n,i)=>{if(n.numberOfElements()!==i.numberOfElements())return new J(te.NA,ue.EqualLength);const s=Oa(n,i);return s instanceof J?s:s[0].length<=1?new J(te.DIV_BY_ZERO,ue.TwoValues):Math.pow(yw(s[0],s[1]),2)})}covariancep(e,t){return this.runFunction(e.args,t,this.metadata("COVARIANCE.P"),(n,i)=>{if(n.numberOfElements()!==i.numberOfElements())return new J(te.NA,ue.EqualLength);const s=Oa(n,i);if(s instanceof J)return s;const o=s[0].length;return o<1?new J(te.DIV_BY_ZERO,ue.OneValue):o===1?0:ju(s[0],s[1])*(o-1)/o})}covariances(e,t){return this.runFunction(e.args,t,this.metadata("COVARIANCE.S"),(n,i)=>{if(n.numberOfElements()!==i.numberOfElements())return new J(te.NA,ue.EqualLength);const s=Oa(n,i);return s instanceof J?s:s[0].length<=1?new J(te.DIV_BY_ZERO,ue.TwoValues):ju(s[0],s[1])})}ztest(e,t){return this.runFunction(e.args,t,this.metadata("Z.TEST"),(n,i,s)=>{const o=this.arithmeticHelper.manyToExactNumbers(n.valuesFromTopLeftCorner());if(o instanceof J)return o;const a=o.length;if(s===void 0){if(a<2)return new J(te.DIV_BY_ZERO,ue.TwoValues);s=na(o,!0)}return a<1?new J(te.NA,ue.OneValue):s===0?new J(te.DIV_BY_ZERO):1-Zi.cdf((Fi(o)-i)/(s/Math.sqrt(a)),0,1)})}ftest(e,t){return this.runFunction(e.args,t,this.metadata("F.TEST"),(n,i)=>{const s=this.arithmeticHelper.manyToExactNumbers(n.valuesFromTopLeftCorner()),o=this.arithmeticHelper.manyToExactNumbers(i.valuesFromTopLeftCorner());if(s instanceof J)return s;if(o instanceof J)return o;if(s.length<=1||o.length<=1)return new J(te.DIV_BY_ZERO);const a=Vu(s,!0),l=Vu(o,!0);if(a===0||l===0)return new J(te.DIV_BY_ZERO);const u=a/l,c=Fl.cdf(u,s.length-1,o.length-1);return 2*Math.min(c,1-c)})}steyx(e,t){return this.runFunction(e.args,t,this.metadata("STEYX"),(n,i)=>{if(n.numberOfElements()!==i.numberOfElements())return new J(te.NA,ue.EqualLength);const s=Oa(n,i);if(s instanceof J)return s;const o=s[0].length;return o<=2?new J(te.DIV_BY_ZERO,ue.ThreeValues):Math.sqrt((Pa(s[0])-Math.pow(ju(s[0],s[1])*(o-1),2)/Pa(s[1]))/(o-2))})}slope(e,t){return this.runFunction(e.args,t,this.metadata("SLOPE"),(n,i)=>{if(n.numberOfElements()!==i.numberOfElements())return new J(te.NA,ue.EqualLength);const s=Oa(n,i);if(s instanceof J)return s;const o=s[0].length;return o<=1?new J(te.DIV_BY_ZERO,ue.TwoValues):ju(s[0],s[1])*(o-1)/Pa(s[1])})}chisqtest(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.TEST"),(n,i)=>{const s=n.height(),o=n.width();if(i.height()!==s||i.width()!==o)return new J(te.NA,ue.EqualLength);const a=Oa(n,i);if(a instanceof J)return a;if(a[0].length<=1)return new J(te.DIV_BY_ZERO,ue.TwoValues);let l=0;for(let u=0;u<a[0].length;u++){if(a[1][u]===0)return new J(te.DIV_BY_ZERO);l+=Math.pow(a[0][u]-a[1][u],2)/a[1][u]}return l<0?new J(te.NUM,ue.NaN):1-Pl.cdf(l,s>1&&o>1?(s-1)*(o-1):s*o-1)})}ttest(e,t){return this.runFunction(e.args,t,this.metadata("T.TEST"),(n,i,s,o)=>{const a=this.arithmeticHelper.manyToExactNumbers(n.valuesFromTopLeftCorner()),l=this.arithmeticHelper.manyToExactNumbers(i.valuesFromTopLeftCorner());if(a instanceof J)return a;if(l instanceof J)return l;const u=a.length,c=l.length;if(o===1){if(c!==u)return new J(te.NA,ue.EqualLength);if(u<=1)return new J(te.DIV_BY_ZERO,ue.TwoValues);const d=Array(u);for(let m=0;m<u;m++)d[m]=a[m]-l[m];const h=na(d,!0);if(h===0)return new J(te.DIV_BY_ZERO);const f=Math.abs(Math.sqrt(u)*Fi(d)/h);return s*(1-Li.cdf(f,u-1))}else if(o===2){if(u<=1||c<=1)return new J(te.DIV_BY_ZERO,ue.TwoValues);const d=(Pa(a)+Pa(l))/(u+c-2);if(d===0)return new J(te.DIV_BY_ZERO);const h=Math.abs((Fi(a)-Fi(l))/Math.sqrt(d*(1/u+1/c)));return s*(1-Li.cdf(h,u+c-2))}else{if(u<=1||c<=1)return new J(te.DIV_BY_ZERO,ue.TwoValues);const d=Vu(a,!0),h=Vu(l,!0);if(d===0&&h===0)return new J(te.DIV_BY_ZERO);const f=Math.abs((Fi(a)-Fi(l))/Math.sqrt(d/u+h/c)),m=Math.pow(d/u+h/c,2)/(Math.pow(d/u,2)/(u-1)+Math.pow(h/c,2)/(c-1));return s*(1-Li.cdf(f,m))}})}skew(e,t){return this.runFunction(e.args,t,this.metadata("SKEW"),(...n)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(n);if(i instanceof J)return i;const s=i.length;if(s<3)return new J(te.DIV_BY_ZERO,ue.ThreeValues);const o=Fi(i),a=na(i,!0);return a===0?new J(te.DIV_BY_ZERO):i.reduce((l,u)=>l+Math.pow((u-o)/a,3),0)*s/(s-1)/(s-2)})}skewp(e,t){return this.runFunction(e.args,t,this.metadata("SKEW.P"),(...n)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(n);if(i instanceof J)return i;const s=i.length;if(s<3)return new J(te.DIV_BY_ZERO,ue.ThreeValues);const o=Fi(i),a=na(i,!1);return a===0?new J(te.DIV_BY_ZERO):i.reduce((l,u)=>l+Math.pow((u-o)/a,3),0)/s})}}Qy.implementedFunctions={AVEDEV:{method:"avedev",parameters:[{argumentType:z.ANY}],repeatLastArgs:1},DEVSQ:{method:"devsq",parameters:[{argumentType:z.ANY}],repeatLastArgs:1},GEOMEAN:{method:"geomean",parameters:[{argumentType:z.ANY}],repeatLastArgs:1},HARMEAN:{method:"harmean",parameters:[{argumentType:z.ANY}],repeatLastArgs:1},CORREL:{method:"correl",parameters:[{argumentType:z.RANGE},{argumentType:z.RANGE}]},RSQ:{method:"rsq",parameters:[{argumentType:z.RANGE},{argumentType:z.RANGE}]},"COVARIANCE.P":{method:"covariancep",parameters:[{argumentType:z.RANGE},{argumentType:z.RANGE}]},"COVARIANCE.S":{method:"covariances",parameters:[{argumentType:z.RANGE},{argumentType:z.RANGE}]},"Z.TEST":{method:"ztest",parameters:[{argumentType:z.RANGE},{argumentType:z.NUMBER},{argumentType:z.NUMBER,optionalArg:!0}]},"F.TEST":{method:"ftest",parameters:[{argumentType:z.RANGE},{argumentType:z.RANGE}]},STEYX:{method:"steyx",parameters:[{argumentType:z.RANGE},{argumentType:z.RANGE}]},SLOPE:{method:"slope",parameters:[{argumentType:z.RANGE},{argumentType:z.RANGE}]},"CHISQ.TEST":{method:"chisqtest",parameters:[{argumentType:z.RANGE},{argumentType:z.RANGE}]},"T.TEST":{method:"ttest",parameters:[{argumentType:z.RANGE},{argumentType:z.RANGE},{argumentType:z.INTEGER,minValue:1,maxValue:2},{argumentType:z.INTEGER,minValue:1,maxValue:3}]},SKEW:{method:"skew",parameters:[{argumentType:z.ANY}],repeatLastArgs:1},"SKEW.P":{method:"skewp",parameters:[{argumentType:z.ANY}],repeatLastArgs:1}};Qy.aliases={COVAR:"COVARIANCE.P",FTEST:"F.TEST",PEARSON:"CORREL",ZTEST:"Z.TEST",CHITEST:"CHISQ.TEST",TTEST:"T.TEST",COVARIANCEP:"COVARIANCE.P",COVARIANCES:"COVARIANCE.S",SKEWP:"SKEW.P"};function Oa(r,e){const t=r.iterateValuesFromTopLeftCorner(),n=e.iterateValuesFromTopLeftCorner();let i,s;const o=[],a=[];for(;i=t.next(),s=n.next(),!i.done&&!s.done;){const l=i.value,u=s.value;if(l instanceof J)return l;if(u instanceof J)return u;Qt(l)&&Qt(u)&&(o.push(He(l)),a.push(He(u)))}return[o,a]}const xw=Object.freeze(Object.defineProperty({__proto__:null,AbsPlugin:ZS,AddressPlugin:XS,ArrayPlugin:KS,BitShiftPlugin:QS,BitwiseLogicOperationsPlugin:rT,BooleanPlugin:nT,CharPlugin:iT,CodePlugin:sT,ComplexPlugin:YT,ConditionalAggregationPlugin:OT,CountBlankPlugin:oT,CountUniquePlugin:aT,DateTimePlugin:lT,DegreesPlugin:uT,DeltaPlugin:cT,ExpPlugin:hT,FinancialPlugin:dT,FormulaTextPlugin:fT,HyperlinkPlugin:pT,InformationPlugin:mT,IsEvenPlugin:gT,IsOddPlugin:yT,LogarithmPlugin:vT,LookupPlugin:FT,MathConstantsPlugin:bT,MathPlugin:GT,MatrixPlugin:wT,MedianPlugin:_T,ModuloPlugin:xT,NumericAggregationPlugin:Gy,PowerPlugin:ET,RadiansPlugin:ST,RadixConversionPlugin:RT,RandomPlugin:NT,RomanPlugin:LT,RoundingPlugin:qy,SimpleArithmerticPlugin:DT,SqrtPlugin:MT,StatisticalAggregationPlugin:Qy,StatisticalPlugin:Zy,SumprodPlugin:IT,TextPlugin:kT,TrigonometryPlugin:PT},Symbol.toStringTag,{value:"Module"}));class kt extends yn{}kt.HyperFormula=yn;kt.ErrorType=te;kt.CellError=J;kt.CellType=ei;kt.CellValueType=rs;kt.CellValueDetailedType=q8;kt.DetailedCellError=kS;kt.ExportedCellChange=Xg;kt.ExportedNamedExpressionChange=HS;kt.ConfigValueTooBigError=wS;kt.ConfigValueTooSmallError=bS;kt.EvaluationSuspendedError=xS;kt.ExpectedOneOfValuesError=_S;kt.ExpectedValueOfTypeError=Zt;kt.ArraySize=Ct;kt.SimpleRangeValue=Ge;kt.EmptyValue=It;kt.FunctionPlugin=At;kt.FunctionArgumentType=z;kt.FunctionPluginValidationError=su;kt.InvalidAddressError=dS;kt.InvalidArgumentsError=Zr;kt.LanguageNotRegisteredError=Dg;kt.LanguageAlreadyRegisteredError=SS;kt.MissingTranslationError=kl;kt.NamedExpressionDoesNotExistError=Nc;kt.NamedExpressionNameIsAlreadyTakenError=fS;kt.NamedExpressionNameIsInvalidError=pS;kt.NoOperationToRedoError=gS;kt.NoOperationToUndoError=mS;kt.NoRelativeAddressesAllowedError=jy;kt.NoSheetWithIdError=Dn;kt.NoSheetWithNameError=hS;kt.NotAFormulaError=bd;kt.NothingToPasteError=yS;kt.ProtectedFunctionTranslationError=ES;kt.SheetNameAlreadyTakenError=ea;kt.SheetSizeLimitExceededError=Ha;kt.SourceLocationHasArrayError=Ul;kt.TargetLocationHasArrayError=vf;kt.UnableToParseError=vS;const dk=Si.defaultConfig.language;yn.registerLanguage(dk,Kg);yn.languages[Kg.langCode]=Kg;for(const r of Object.getOwnPropertyNames(xw))r.startsWith("_")||yn.registerFunctionPlugin(xw[r]);class fk{engine=null;sheetMapping=new Map;initialize(e,t){const n={};t.forEach(i=>{const o=(e[i]||[]).map(a=>a.map(l=>this.extractCellValue(l)));n[i]=o}),this.engine=yn.buildFromSheets(n,{licenseKey:"gpl-v3"}),this.sheetMapping.clear(),t.forEach(i=>{const s=this.engine.getSheetId(i);s!==void 0&&this.sheetMapping.set(i,s)})}extractCellValue(e){if(!e)return null;const t=e.value;return t==null?null:typeof t=="object"&&"formula"in t?`=${t.formula}`:typeof t=="number"||typeof t=="string"||typeof t=="boolean"?t:t instanceof Date?this.convertDateToExcelSerial(t):typeof t=="object"&&"richText"in t?t.richText.map(n=>n.text).join(""):typeof t=="object"&&"text"in t?t.text:null}convertDateToExcelSerial(e){const t=new Date(1899,11,30);return(e.getTime()-t.getTime())/(1e3*60*60*24)}setCellValue(e,t,n,i){if(!this.engine)return console.warn("Formula engine not initialized"),[];const s=this.sheetMapping.get(e);if(s===void 0)return console.warn(`Sheet "${e}" not found in engine`),[];try{return this.engine.setCellContents({sheet:s,row:t,col:n},i)}catch(o){return console.error("Formula engine error:",o),[]}}destroy(){this.engine=null,this.sheetMapping.clear()}}const i0=new fk;let Jy=class $u{constructor(e){this.config=e}static create(e,t,n,i,s){return new $u({name:e,worksheet:t,rawData:n,title:i,sections:s.map(o=>o.toConfig()),currentCell:null,editionMode:!1})}static fromConfig(e){return new $u({...e})}get name(){return this.config.name}get worksheet(){return this.config.worksheet}get rawData(){return this.config.rawData}get title(){return this.config.title}get sections(){return this.config.sections.map(e=>Nr.fromConfig(e))}updateSection(e,t){const n=this.config.sections.map((i,s)=>s===e?t(Nr.fromConfig(i)).toConfig():i);return new $u({...this.config,sections:n})}getSection(e){const t=this.config.sections[e];return t?Nr.fromConfig(t):void 0}updateCell(e,t){const n=this.name,i=e.formula?"="+t:t;return i0.setCellValue(n,Number(e.row)-1,Number(e.col)-1,i).forEach(o=>{if(!("address"in o))return;const{row:a,col:l}=o.address,u=this.rawData[a]?.[l];u&&(e==u&&u.formula?u.value={formula:i.substring(1),result:o.newValue}:e==u?u.value=o.newValue:u.value={formula:u.formula,result:o.newValue})}),new $u({...this.config})}getMetadata(){return{totalRows:this.config.rawData.length,totalColumns:this.config.rawData[0]?.length||0,sectionCount:this.config.sections.length,hasTitle:!!this.config.title,isEmpty:this.config.rawData.length===0}}getSectionCount(){return this.config.sections.length}hasSections(){return this.config.sections.length>0}isEmpty(){return this.config.rawData.length===0}toConfig(){return{...this.config}}toJSON(){return this.toConfig()}};class Sd{static matchesSearchText(e,t){if(!t.trim())return!0;const n=t.toLowerCase();return e.some(i=>i==null?!1:String(i.value).toLowerCase().includes(n))}static filterSectionData(e){return e.searchText?e.data.filter(t=>this.matchesSearchText(t,e.searchText)):e.data}static compareValues(e,t,n){let i=e.result??e.value??null,s=t.result??t.value??null;if(i==null)return 1;if(s==null)return-1;if(typeof i=="number"&&typeof s=="number")return n==="asc"?i-s:s-i;if(i instanceof Date&&s instanceof Date)return n==="asc"?i.getTime()-s.getTime():s.getTime()-i.getTime();const o=String(i).toLowerCase(),a=String(s).toLowerCase();return n==="asc"?o.localeCompare(a):a.localeCompare(o)}static sortSectionData(e,t){if(!t)return e;const{columnIndex:n,direction:i}=t;return[...e].sort((s,o)=>{const a=s[n],l=o[n];return this.compareValues(a,l,i)})}static applyFiltersAndSort(e){let t=this.filterSectionData(e);return t=this.sortSectionData(t,e.sortConfig),t}static getFilteredRowCount(e){return this.filterSectionData(e).length}static hasActiveSearch(e){return!!e.searchText&&e.searchText.trim().length>0}static hasActiveSort(e){return!!e.sortConfig}}class Ga{static isNumericColumn(e,t){if(e.data.length===0)return!1;const n=e.data.map(s=>s[t]),i=n.filter(s=>{if(typeof s=="object"&&s!==null){const o=s;return typeof o.value=="number"||typeof o.result=="number"}return typeof s=="number"}).length;return n.length===i}static findLabelColumn(e){for(let t=0;t<e.header.length;t++){const n=e.data.map(s=>s[t]);if(n.filter(s=>typeof s=="string"||s===null||s===void 0).length===n.length)return t}return 0}static createChart(e,t){const n=this.findLabelColumn(e);return Qr.create(t,n,"bar")}static prepareChartData(e,t){let n;const i=e.applyFiltersToCharts!==!1,s=Sd.hasActiveSearch(e)||Sd.hasActiveSort(e);i&&s?n=Sd.applyFiltersAndSort(e):n=e.data;const o=n.filter(l=>!t.excludedRows.includes(l)).map((l,u)=>({index:u,name:String(l[t.labelColumnIndex]?.value||""),value:Number(l[t.columnIndex]?.result??l[t.columnIndex]?.value)||0})),a=o.reduce((l,u)=>l+u.value,0);return o.map(l=>({...l,percentage:a>0?l.value/a*100:0}))}static getChartValueLabel(e,t){return String(e.header[t.columnIndex]?.value||"Value")}static getChartLabelName(e,t){return String(e.header[t.labelColumnIndex]||"Label")}static getLabelCandidateColumns(e){return e.header.map((t,n)=>({index:n,label:String(t.value||`Col ${n+1}`)})).filter(t=>!this.isNumericColumn(e,t.index))}static changeChartType(e,t){return e.withType(t)}static changeChartLabelColumn(e,t){return e.withLabelColumn(t)}static toggleRowExclusion(e,t){return e.toggleRowExclusion(t)}}class QT{static createCardRecap(e,t,n,i){const s=e.data.length>0?e.data[t]?.[n]:e.header[n],o=e.data.length>0?e.header[n]:e.header[0],a=yi.create(t,n,s,o);return i?a.withStyle(i):a}static updateCardStyle(e,t){return e.withStyle(t)}static setCardStyle(e,t){return e.withFullStyle(t)}static formatCardValue(e){return e==null?"-":typeof e=="number"?new Intl.NumberFormat("fr-FR",{maximumFractionDigits:2}).format(e):e instanceof Date?e.toLocaleDateString("fr-FR"):typeof e=="boolean"?e?"Yes":"No":String(e)}static isNumericValue(e){return typeof e=="number"}static getValueType(e){return e==null||e===""?"empty":typeof e=="number"?"number":typeof e=="boolean"?"boolean":e instanceof Date?"date":"text"}}class Do{static setCardRecap(e,t,n){const i=QT.createCardRecap(e.toConfig(),t,n);return e.setCardRecap(i)}static toggleChart(e,t){return e.toggleChart(t)}static setChartType(e,t,n){return e.updateChart(t,i=>Ga.changeChartType(i,n))}static setChartLabelColumn(e,t,n){return e.updateChart(t,i=>Ga.changeChartLabelColumn(i,n))}static toggleRowExclusion(e,t){const n=e.getVisibleCharts();let i=e;for(const s of n)i=i.updateChart(s.columnIndex,o=>Ga.toggleRowExclusion(o,t));return i}static setSearchText(e,t){return e.withSearchText(t)}static clearSearch(e){return e.clearSearch()}static toggleSort(e,t){return e.toggleSort(t)}static clearSort(e){return e.clearSort()}static setApplyFiltersToCharts(e,t){return e.withApplyFiltersToCharts(t)}static updateSectionStyle(e,t){return e.withStyle(t)}static setSectionStyle(e,t){return e.withFullStyle(t)}}class s0{static extractRawData(e){const t=[];return e.eachRow({includeEmpty:!0},n=>{const i=[];n.eachCell({includeEmpty:!0},s=>{i.push(s)}),t.push(i)}),t}static isEmptyRow(e){return e.every(t=>t==null||t.value===""||t.value===null||t.value===void 0)}static countFilledCells(e){return e?e.filter(t=>t!=null&&t.value!==""&&t.value!==null&&t.value!==void 0).length:0}}class pk{static detectSections(e){const t=[];let n=[];return e.slice(1).forEach(i=>{s0.isEmptyRow(i)?n.length>0&&(t.push(this.parseSection(n)),n=[]):n.push(i)}),n.length>0&&t.push(this.parseSection(n)),t}static parseSection(e){const t={header:[],data:[]};return e.length===0||(s0.countFilledCells(e[0])===1&&e.length>1?(t.title=e[0]?.[0],t.header=e[1],t.data=e.slice(2)):(t.header=e[0],t.data=e.slice(1))),t}}class ev{static buildSheet(e,t){const n=s0.extractRawData(t),i=n[0]?.[0]?.value||"",o=pk.detectSections(n).map(a=>Nr.fromConfig(a));return Jy.create(e,t,n,i,o)}static updateSection(e,t,n){return e.updateSection(t,n)}static updateCell(e,t,n){return e.updateCell(t,n)}static getSection(e,t){return e.getSection(t)}}const ht=Vs({workbook:null,fileName:"",sheetNames:[],sheets:{},currentSheet:{name:"",worksheet:null,rawData:[],title:"",sections:[],currentCell:null,editionMode:!1}});function mk(r,e){ht.workbook=r,ht.fileName=e,ht.sheetNames=r.worksheets.map(n=>n.name);const t={};r.worksheets.forEach(n=>{const i=ev.buildSheet(n.name,n);ht.sheets[i.name]=i.toConfig(),t[i.name]=i.rawData.map(s=>s)}),i0.destroy(),i0.initialize(t,ht.sheetNames),ht.sheetNames[0]&&JT(ht.sheetNames[0])}function JT(r){if(ht.workbook){if(ht.sheets[r]){ht.currentSheet=ht.sheets[r];return}throw new Error(`Sheet ${r} not found in workbook`)}}function gk(r,e){const t=Jy.fromConfig(ht.currentSheet),n=ev.updateCell(t,r,e),i=n.toConfig();ht.sheets[n.name]=i}function yk(){ht.currentSheet.editionMode=!0}function vk(){ht.currentSheet.editionMode=!1,ht.currentSheet.currentCell=null}function Zs(r,e){const t=Jy.fromConfig(ht.currentSheet),n=ev.updateSection(t,r,e),i=n.toConfig();ht.sheets[n.name]=i,ht.currentSheet=i}function Ew(r,e,t){Zs(r,n=>Do.setCardRecap(n,e,t))}function bk(r,e){Zs(r,t=>{if(!t.cardRecap)return t;const n=QT.setCardStyle(t.cardRecap,e);return t.setCardRecap(n)})}function wk(r,e){Zs(r,t=>Do.setSectionStyle(t,e))}function _k(r,e){Zs(r,t=>Do.setSearchText(t,e))}function eR(r,e){Zs(r,t=>Do.toggleChart(t,e))}function xk(r,e,t){Zs(r,n=>Do.setChartType(n,e,t))}function Ek(r,e,t){Zs(r,n=>Do.setChartLabelColumn(n,e,t))}function Sk(r,e){Zs(r,t=>Do.toggleRowExclusion(t,e))}function Tk(r,e){Zs(r,t=>Do.toggleSort(t,e))}function Rk(r,e){Zs(r,t=>Do.setApplyFiltersToCharts(t,e))}function zh(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var jm={exports:{}};var Sw;function Ak(){return Sw||(Sw=1,(function(r,e){(function(t){r.exports=t()})((function(){return(function t(n,i,s){function o(u,c){if(!i[u]){if(!n[u]){var d=typeof zh=="function"&&zh;if(!c&&d)return d(u,!0);if(a)return a(u,!0);var h=new Error("Cannot find module '"+u+"'");throw h.code="MODULE_NOT_FOUND",h}var f=i[u]={exports:{}};n[u][0].call(f.exports,(function(m){return o(n[u][1][m]||m)}),f,f.exports,t,n,i,s)}return i[u].exports}for(var a=typeof zh=="function"&&zh,l=0;l<s.length;l++)o(s[l]);return o})({1:[function(t,n,i){const s=t("fs"),o=t("fast-csv"),a=t("dayjs/plugin/customParseFormat"),l=t("dayjs/plugin/utc"),u=t("dayjs").extend(a).extend(l),c=t("../utils/stream-buf"),{fs:{exists:d}}=t("../utils/utils"),h={true:!0,false:!1,"#N/A":{error:"#N/A"},"#REF!":{error:"#REF!"},"#NAME?":{error:"#NAME?"},"#DIV/0!":{error:"#DIV/0!"},"#NULL!":{error:"#NULL!"},"#VALUE!":{error:"#VALUE!"},"#NUM!":{error:"#NUM!"}};n.exports=class{constructor(f){this.workbook=f,this.worksheet=null}async readFile(f,m){if(m=m||{},!await d(f))throw new Error("File not found: "+f);const p=s.createReadStream(f),g=await this.read(p,m);return p.close(),g}read(f,m){return m=m||{},new Promise((p,g)=>{const v=this.workbook.addWorksheet(m.sheetName),y=m.dateFormats||["YYYY-MM-DD[T]HH:mm:ssZ","YYYY-MM-DD[T]HH:mm:ss","MM-DD-YYYY","YYYY-MM-DD"],b=m.map||function(A){if(A==="")return null;const M=Number(A);if(!Number.isNaN(M)&&M!==1/0)return M;const L=y.reduce((P,U)=>{if(P)return P;const $=u(A,U,!0);return $.isValid()?$:null},null);if(L)return new Date(L.valueOf());const k=h[A];return k!==void 0?k:A},E=o.parse(m.parserOptions).on("data",A=>{v.addRow(A.map(b))}).on("end",()=>{E.emit("worksheet",v)});E.on("worksheet",p).on("error",g),f.pipe(E)})}createInputStream(){throw new Error("`CSV#createInputStream` is deprecated. You should use `CSV#read` instead. This method will be removed in version 5.0. Please follow upgrade instruction: https://github.com/exceljs/exceljs/blob/master/UPGRADE-4.0.md")}write(f,m){return new Promise((p,g)=>{m=m||{};const v=this.workbook.getWorksheet(m.sheetName||m.sheetId),y=o.format(m.formatterOptions);f.on("finish",()=>{p()}),y.on("error",g),y.pipe(f);const{dateFormat:b,dateUTC:E}=m,A=m.map||(k=>{if(k){if(k.text||k.hyperlink)return k.hyperlink||k.text||"";if(k.formula||k.result)return k.result||"";if(k instanceof Date)return b?E?u.utc(k).format(b):u(k).format(b):E?u.utc(k).format():u(k).format();if(k.error)return k.error;if(typeof k=="object")return JSON.stringify(k)}return k}),M=m.includeEmptyRows===void 0||m.includeEmptyRows;let L=1;v&&v.eachRow((k,P)=>{if(M)for(;L++<P-1;)y.write([]);const{values:U}=k;U.shift(),y.write(U.map(A)),L=P}),y.end()})}writeFile(f,m){const p={encoding:(m=m||{}).encoding||"utf8"},g=s.createWriteStream(f,p);return this.write(g,m)}async writeBuffer(f){const m=new c;return await this.write(m,f),m.read()}}},{"../utils/stream-buf":24,"../utils/utils":27,dayjs:391,"dayjs/plugin/customParseFormat":392,"dayjs/plugin/utc":393,"fast-csv":424,fs:216}],2:[function(t,n,i){const s=t("../utils/col-cache");class o{constructor(l,u){let c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;if(this.worksheet=l,u)if(typeof u=="string"){const d=s.decodeAddress(u);this.nativeCol=d.col+c,this.nativeColOff=0,this.nativeRow=d.row+c,this.nativeRowOff=0}else u.nativeCol!==void 0?(this.nativeCol=u.nativeCol||0,this.nativeColOff=u.nativeColOff||0,this.nativeRow=u.nativeRow||0,this.nativeRowOff=u.nativeRowOff||0):u.col!==void 0?(this.col=u.col+c,this.row=u.row+c):(this.nativeCol=0,this.nativeColOff=0,this.nativeRow=0,this.nativeRowOff=0);else this.nativeCol=0,this.nativeColOff=0,this.nativeRow=0,this.nativeRowOff=0}static asInstance(l){return l instanceof o||l==null?l:new o(l)}get col(){return this.nativeCol+Math.min(this.colWidth-1,this.nativeColOff)/this.colWidth}set col(l){this.nativeCol=Math.floor(l),this.nativeColOff=Math.floor((l-this.nativeCol)*this.colWidth)}get row(){return this.nativeRow+Math.min(this.rowHeight-1,this.nativeRowOff)/this.rowHeight}set row(l){this.nativeRow=Math.floor(l),this.nativeRowOff=Math.floor((l-this.nativeRow)*this.rowHeight)}get colWidth(){return this.worksheet&&this.worksheet.getColumn(this.nativeCol+1)&&this.worksheet.getColumn(this.nativeCol+1).isCustomWidth?Math.floor(1e4*this.worksheet.getColumn(this.nativeCol+1).width):64e4}get rowHeight(){return this.worksheet&&this.worksheet.getRow(this.nativeRow+1)&&this.worksheet.getRow(this.nativeRow+1).height?Math.floor(1e4*this.worksheet.getRow(this.nativeRow+1).height):18e4}get model(){return{nativeCol:this.nativeCol,nativeColOff:this.nativeColOff,nativeRow:this.nativeRow,nativeRowOff:this.nativeRowOff}}set model(l){this.nativeCol=l.nativeCol,this.nativeColOff=l.nativeColOff,this.nativeRow=l.nativeRow,this.nativeRowOff=l.nativeRowOff}}n.exports=o},{"../utils/col-cache":19}],3:[function(t,n,i){const s=t("../utils/col-cache"),o=t("../utils/under-dash"),a=t("./enums"),{slideFormula:l}=t("../utils/shared-formula"),u=t("./note");class c{constructor(f,m,p){if(!f||!m)throw new Error("A Cell needs a Row");this._row=f,this._column=m,s.validateAddress(p),this._address=p,this._value=d.create(c.Types.Null,this),this.style=this._mergeStyle(f.style,m.style,{}),this._mergeCount=0}get worksheet(){return this._row.worksheet}get workbook(){return this._row.worksheet.workbook}destroy(){delete this.style,delete this._value,delete this._row,delete this._column,delete this._address}get numFmt(){return this.style.numFmt}set numFmt(f){this.style.numFmt=f}get font(){return this.style.font}set font(f){this.style.font=f}get alignment(){return this.style.alignment}set alignment(f){this.style.alignment=f}get border(){return this.style.border}set border(f){this.style.border=f}get fill(){return this.style.fill}set fill(f){this.style.fill=f}get protection(){return this.style.protection}set protection(f){this.style.protection=f}_mergeStyle(f,m,p){const g=f&&f.numFmt||m&&m.numFmt;g&&(p.numFmt=g);const v=f&&f.font||m&&m.font;v&&(p.font=v);const y=f&&f.alignment||m&&m.alignment;y&&(p.alignment=y);const b=f&&f.border||m&&m.border;b&&(p.border=b);const E=f&&f.fill||m&&m.fill;E&&(p.fill=E);const A=f&&f.protection||m&&m.protection;return A&&(p.protection=A),p}get address(){return this._address}get row(){return this._row.number}get col(){return this._column.number}get $col$row(){return`$${this._column.letter}$${this.row}`}get type(){return this._value.type}get effectiveType(){return this._value.effectiveType}toCsvString(){return this._value.toCsvString()}addMergeRef(){this._mergeCount++}releaseMergeRef(){this._mergeCount--}get isMerged(){return this._mergeCount>0||this.type===c.Types.Merge}merge(f,m){this._value.release(),this._value=d.create(c.Types.Merge,this,f),m||(this.style=f.style)}unmerge(){this.type===c.Types.Merge&&(this._value.release(),this._value=d.create(c.Types.Null,this),this.style=this._mergeStyle(this._row.style,this._column.style,{}))}isMergedTo(f){return this._value.type===c.Types.Merge&&this._value.isMergedTo(f)}get master(){return this.type===c.Types.Merge?this._value.master:this}get isHyperlink(){return this._value.type===c.Types.Hyperlink}get hyperlink(){return this._value.hyperlink}get value(){return this._value.value}set value(f){this.type!==c.Types.Merge?(this._value.release(),this._value=d.create(d.getType(f),this,f)):this._value.master.value=f}get note(){return this._comment&&this._comment.note}set note(f){this._comment=new u(f)}get text(){return this._value.toString()}get html(){return o.escapeHtml(this.text)}toString(){return this.text}_upgradeToHyperlink(f){this.type===c.Types.String&&(this._value=d.create(c.Types.Hyperlink,this,{text:this._value.value,hyperlink:f}))}get formula(){return this._value.formula}get result(){return this._value.result}get formulaType(){return this._value.formulaType}get fullAddress(){const{worksheet:f}=this._row;return{sheetName:f.name,address:this.address,row:this.row,col:this.col}}get name(){return this.names[0]}set name(f){this.names=[f]}get names(){return this.workbook.definedNames.getNamesEx(this.fullAddress)}set names(f){const{definedNames:m}=this.workbook;m.removeAllNames(this.fullAddress),f.forEach(p=>{m.addEx(this.fullAddress,p)})}addName(f){this.workbook.definedNames.addEx(this.fullAddress,f)}removeName(f){this.workbook.definedNames.removeEx(this.fullAddress,f)}removeAllNames(){this.workbook.definedNames.removeAllNames(this.fullAddress)}get _dataValidations(){return this.worksheet.dataValidations}get dataValidation(){return this._dataValidations.find(this.address)}set dataValidation(f){this._dataValidations.add(this.address,f)}get model(){const{model:f}=this._value;return f.style=this.style,this._comment&&(f.comment=this._comment.model),f}set model(f){this._value.release(),this._value=d.create(f.type,this),this._value.model=f,f.comment&&f.comment.type==="note"&&(this._comment=u.fromModel(f.comment)),f.style?this.style=f.style:this.style={}}}c.Types=a.ValueType;const d={getType:h=>h==null?c.Types.Null:h instanceof String||typeof h=="string"?c.Types.String:typeof h=="number"?c.Types.Number:typeof h=="boolean"?c.Types.Boolean:h instanceof Date?c.Types.Date:h.text&&h.hyperlink?c.Types.Hyperlink:h.formula||h.sharedFormula?c.Types.Formula:h.richText?c.Types.RichText:h.sharedString?c.Types.SharedString:h.error?c.Types.Error:c.Types.JSON,types:[{t:c.Types.Null,f:class{constructor(h){this.model={address:h.address,type:c.Types.Null}}get value(){return null}set value(h){}get type(){return c.Types.Null}get effectiveType(){return c.Types.Null}get address(){return this.model.address}set address(h){this.model.address=h}toCsvString(){return""}release(){}toString(){return""}}},{t:c.Types.Number,f:class{constructor(h,f){this.model={address:h.address,type:c.Types.Number,value:f}}get value(){return this.model.value}set value(h){this.model.value=h}get type(){return c.Types.Number}get effectiveType(){return c.Types.Number}get address(){return this.model.address}set address(h){this.model.address=h}toCsvString(){return this.model.value.toString()}release(){}toString(){return this.model.value.toString()}}},{t:c.Types.String,f:class{constructor(h,f){this.model={address:h.address,type:c.Types.String,value:f}}get value(){return this.model.value}set value(h){this.model.value=h}get type(){return c.Types.String}get effectiveType(){return c.Types.String}get address(){return this.model.address}set address(h){this.model.address=h}toCsvString(){return`"${this.model.value.replace(/"/g,'""')}"`}release(){}toString(){return this.model.value}}},{t:c.Types.Date,f:class{constructor(h,f){this.model={address:h.address,type:c.Types.Date,value:f}}get value(){return this.model.value}set value(h){this.model.value=h}get type(){return c.Types.Date}get effectiveType(){return c.Types.Date}get address(){return this.model.address}set address(h){this.model.address=h}toCsvString(){return this.model.value.toISOString()}release(){}toString(){return this.model.value.toString()}}},{t:c.Types.Hyperlink,f:class{constructor(h,f){this.model={address:h.address,type:c.Types.Hyperlink,text:f?f.text:void 0,hyperlink:f?f.hyperlink:void 0},f&&f.tooltip&&(this.model.tooltip=f.tooltip)}get value(){const h={text:this.model.text,hyperlink:this.model.hyperlink};return this.model.tooltip&&(h.tooltip=this.model.tooltip),h}set value(h){this.model={text:h.text,hyperlink:h.hyperlink},h.tooltip&&(this.model.tooltip=h.tooltip)}get text(){return this.model.text}set text(h){this.model.text=h}get hyperlink(){return this.model.hyperlink}set hyperlink(h){this.model.hyperlink=h}get type(){return c.Types.Hyperlink}get effectiveType(){return c.Types.Hyperlink}get address(){return this.model.address}set address(h){this.model.address=h}toCsvString(){return this.model.hyperlink}release(){}toString(){return this.model.text}}},{t:c.Types.Formula,f:class{constructor(h,f){this.cell=h,this.model={address:h.address,type:c.Types.Formula,shareType:f?f.shareType:void 0,ref:f?f.ref:void 0,formula:f?f.formula:void 0,sharedFormula:f?f.sharedFormula:void 0,result:f?f.result:void 0}}_copyModel(h){const f={},m=p=>{const g=h[p];g&&(f[p]=g)};return m("formula"),m("result"),m("ref"),m("shareType"),m("sharedFormula"),f}get value(){return this._copyModel(this.model)}set value(h){this.model=this._copyModel(h)}validate(h){switch(d.getType(h)){case c.Types.Null:case c.Types.String:case c.Types.Number:case c.Types.Date:break;case c.Types.Hyperlink:case c.Types.Formula:default:throw new Error("Cannot process that type of result value")}}get dependencies(){return{ranges:this.formula.match(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}:[A-Z]{1,3}\d{1,4}/g),cells:this.formula.replace(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}:[A-Z]{1,3}\d{1,4}/g,"").match(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}/g)}}get formula(){return this.model.formula||this._getTranslatedFormula()}set formula(h){this.model.formula=h}get formulaType(){return this.model.formula?a.FormulaType.Master:this.model.sharedFormula?a.FormulaType.Shared:a.FormulaType.None}get result(){return this.model.result}set result(h){this.model.result=h}get type(){return c.Types.Formula}get effectiveType(){const h=this.model.result;return h==null?a.ValueType.Null:h instanceof String||typeof h=="string"?a.ValueType.String:typeof h=="number"?a.ValueType.Number:h instanceof Date?a.ValueType.Date:h.text&&h.hyperlink?a.ValueType.Hyperlink:h.formula?a.ValueType.Formula:a.ValueType.Null}get address(){return this.model.address}set address(h){this.model.address=h}_getTranslatedFormula(){if(!this._translatedFormula&&this.model.sharedFormula){const{worksheet:h}=this.cell,f=h.findCell(this.model.sharedFormula);this._translatedFormula=f&&l(f.formula,f.address,this.model.address)}return this._translatedFormula}toCsvString(){return""+(this.model.result||"")}release(){}toString(){return this.model.result?this.model.result.toString():""}}},{t:c.Types.Merge,f:class{constructor(h,f){this.model={address:h.address,type:c.Types.Merge,master:f?f.address:void 0},this._master=f,f&&f.addMergeRef()}get value(){return this._master.value}set value(h){h instanceof c?(this._master&&this._master.releaseMergeRef(),h.addMergeRef(),this._master=h):this._master.value=h}isMergedTo(h){return h===this._master}get master(){return this._master}get type(){return c.Types.Merge}get effectiveType(){return this._master.effectiveType}get address(){return this.model.address}set address(h){this.model.address=h}toCsvString(){return""}release(){this._master.releaseMergeRef()}toString(){return this.value.toString()}}},{t:c.Types.JSON,f:class{constructor(h,f){this.model={address:h.address,type:c.Types.String,value:JSON.stringify(f),rawValue:f}}get value(){return this.model.rawValue}set value(h){this.model.rawValue=h,this.model.value=JSON.stringify(h)}get type(){return c.Types.String}get effectiveType(){return c.Types.String}get address(){return this.model.address}set address(h){this.model.address=h}toCsvString(){return this.model.value}release(){}toString(){return this.model.value}}},{t:c.Types.SharedString,f:class{constructor(h,f){this.model={address:h.address,type:c.Types.SharedString,value:f}}get value(){return this.model.value}set value(h){this.model.value=h}get type(){return c.Types.SharedString}get effectiveType(){return c.Types.SharedString}get address(){return this.model.address}set address(h){this.model.address=h}toCsvString(){return this.model.value.toString()}release(){}toString(){return this.model.value.toString()}}},{t:c.Types.RichText,f:class{constructor(h,f){this.model={address:h.address,type:c.Types.String,value:f}}get value(){return this.model.value}set value(h){this.model.value=h}toString(){return this.model.value.richText.map(h=>h.text).join("")}get type(){return c.Types.RichText}get effectiveType(){return c.Types.RichText}get address(){return this.model.address}set address(h){this.model.address=h}toCsvString(){return`"${this.text.replace(/"/g,'""')}"`}release(){}}},{t:c.Types.Boolean,f:class{constructor(h,f){this.model={address:h.address,type:c.Types.Boolean,value:f}}get value(){return this.model.value}set value(h){this.model.value=h}get type(){return c.Types.Boolean}get effectiveType(){return c.Types.Boolean}get address(){return this.model.address}set address(h){this.model.address=h}toCsvString(){return this.model.value?1:0}release(){}toString(){return this.model.value.toString()}}},{t:c.Types.Error,f:class{constructor(h,f){this.model={address:h.address,type:c.Types.Error,value:f}}get value(){return this.model.value}set value(h){this.model.value=h}get type(){return c.Types.Error}get effectiveType(){return c.Types.Error}get address(){return this.model.address}set address(h){this.model.address=h}toCsvString(){return this.toString()}release(){}toString(){return this.model.value.error.toString()}}}].reduce((h,f)=>(h[f.t]=f.f,h),[]),create(h,f,m){const p=this.types[h];if(!p)throw new Error("Could not create Value of type "+h);return new p(f,m)}};n.exports=c},{"../utils/col-cache":19,"../utils/shared-formula":23,"../utils/under-dash":26,"./enums":7,"./note":9}],4:[function(t,n,i){const s=t("../utils/under-dash"),o=t("./enums"),a=t("../utils/col-cache");class l{constructor(c,d,h){this._worksheet=c,this._number=d,h!==!1&&(this.defn=h)}get number(){return this._number}get worksheet(){return this._worksheet}get letter(){return a.n2l(this._number)}get isCustomWidth(){return this.width!==void 0&&this.width!==9}get defn(){return{header:this._header,key:this.key,width:this.width,style:this.style,hidden:this.hidden,outlineLevel:this.outlineLevel}}set defn(c){c?(this.key=c.key,this.width=c.width!==void 0?c.width:9,this.outlineLevel=c.outlineLevel,c.style?this.style=c.style:this.style={},this.header=c.header,this._hidden=!!c.hidden):(delete this._header,delete this._key,delete this.width,this.style={},this.outlineLevel=0)}get headers(){return this._header&&this._header instanceof Array?this._header:[this._header]}get header(){return this._header}set header(c){c!==void 0?(this._header=c,this.headers.forEach((d,h)=>{this._worksheet.getCell(h+1,this.number).value=d})):this._header=void 0}get key(){return this._key}set key(c){(this._key&&this._worksheet.getColumnKey(this._key))===this&&this._worksheet.deleteColumnKey(this._key),this._key=c,c&&this._worksheet.setColumnKey(this._key,this)}get hidden(){return!!this._hidden}set hidden(c){this._hidden=c}get outlineLevel(){return this._outlineLevel||0}set outlineLevel(c){this._outlineLevel=c}get collapsed(){return!!(this._outlineLevel&&this._outlineLevel>=this._worksheet.properties.outlineLevelCol)}toString(){return JSON.stringify({key:this.key,width:this.width,headers:this.headers.length?this.headers:void 0})}equivalentTo(c){return this.width===c.width&&this.hidden===c.hidden&&this.outlineLevel===c.outlineLevel&&s.isEqual(this.style,c.style)}get isDefault(){if(this.isCustomWidth||this.hidden||this.outlineLevel)return!1;const c=this.style;return!c||!(c.font||c.numFmt||c.alignment||c.border||c.fill||c.protection)}get headerCount(){return this.headers.length}eachCell(c,d){const h=this.number;d||(d=c,c=null),this._worksheet.eachRow(c,(f,m)=>{d(f.getCell(h),m)})}get values(){const c=[];return this.eachCell((d,h)=>{d&&d.type!==o.ValueType.Null&&(c[h]=d.value)}),c}set values(c){if(!c)return;const d=this.number;let h=0;c.hasOwnProperty("0")&&(h=1),c.forEach((f,m)=>{this._worksheet.getCell(m+h,d).value=f})}_applyStyle(c,d){return this.style[c]=d,this.eachCell(h=>{h[c]=d}),d}get numFmt(){return this.style.numFmt}set numFmt(c){this._applyStyle("numFmt",c)}get font(){return this.style.font}set font(c){this._applyStyle("font",c)}get alignment(){return this.style.alignment}set alignment(c){this._applyStyle("alignment",c)}get protection(){return this.style.protection}set protection(c){this._applyStyle("protection",c)}get border(){return this.style.border}set border(c){this._applyStyle("border",c)}get fill(){return this.style.fill}set fill(c){this._applyStyle("fill",c)}static toModel(c){const d=[];let h=null;return c&&c.forEach((f,m)=>{f.isDefault?h&&(h=null):h&&f.equivalentTo(h)?h.max=m+1:(h={min:m+1,max:m+1,width:f.width!==void 0?f.width:9,style:f.style,isCustomWidth:f.isCustomWidth,hidden:f.hidden,outlineLevel:f.outlineLevel,collapsed:f.collapsed},d.push(h))}),d.length?d:void 0}static fromModel(c,d){const h=[];let f=1,m=0;for(d=(d=d||[]).sort((function(p,g){return p.min-g.min}));m<d.length;){const p=d[m++];for(;f<p.min;)h.push(new l(c,f++));for(;f<=p.max;)h.push(new l(c,f++,p))}return h.length?h:null}}n.exports=l},{"../utils/col-cache":19,"../utils/under-dash":26,"./enums":7}],5:[function(t,n,i){n.exports=class{constructor(s){this.model=s||{}}add(s,o){return this.model[s]=o}find(s){return this.model[s]}remove(s){this.model[s]=void 0}}},{}],6:[function(t,n,i){const s=t("../utils/under-dash"),o=t("../utils/col-cache"),a=t("../utils/cell-matrix"),l=t("./range"),u=/[$](\w+)[$](\d+)(:[$](\w+)[$](\d+))?/;n.exports=class{constructor(){this.matrixMap={}}getMatrix(c){return this.matrixMap[c]||(this.matrixMap[c]=new a)}add(c,d){const h=o.decodeEx(c);this.addEx(h,d)}addEx(c,d){const h=this.getMatrix(d);if(c.top)for(let f=c.left;f<=c.right;f++)for(let m=c.top;m<=c.bottom;m++){const p={sheetName:c.sheetName,address:o.n2l(f)+m,row:m,col:f};h.addCellEx(p)}else h.addCellEx(c)}remove(c,d){const h=o.decodeEx(c);this.removeEx(h,d)}removeEx(c,d){this.getMatrix(d).removeCellEx(c)}removeAllNames(c){s.each(this.matrixMap,d=>{d.removeCellEx(c)})}forEach(c){s.each(this.matrixMap,(d,h)=>{d.forEach(f=>{c(h,f)})})}getNames(c){return this.getNamesEx(o.decodeEx(c))}getNamesEx(c){return s.map(this.matrixMap,(d,h)=>d.findCellEx(c)&&h).filter(Boolean)}_explore(c,d){d.mark=!1;const{sheetName:h}=d,f=new l(d.row,d.col,d.row,d.col,h);let m,p;function g(y,b){const E=c.findCellAt(h,y,d.col);return!(!E||!E.mark)&&(f[b]=y,E.mark=!1,!0)}for(p=d.row-1;g(p,"top");p--);for(p=d.row+1;g(p,"bottom");p++);function v(y,b){const E=[];for(p=f.top;p<=f.bottom;p++){const A=c.findCellAt(h,p,y);if(!A||!A.mark)return!1;E.push(A)}f[b]=y;for(let A=0;A<E.length;A++)E[A].mark=!1;return!0}for(m=d.col-1;v(m,"left");m--);for(m=d.col+1;v(m,"right");m++);return f}getRanges(c,d){return(d=d||this.matrixMap[c])?(d.forEach(h=>{h.mark=!0}),{name:c,ranges:d.map(h=>h.mark&&this._explore(d,h)).filter(Boolean).map(h=>h.$shortRange)}):{name:c,ranges:[]}}normaliseMatrix(c,d){c.forEachInSheet(d,(h,f,m)=>{h&&(h.row===f&&h.col===m||(h.row=f,h.col=m,h.address=o.n2l(m)+f))})}spliceRows(c,d,h,f){s.each(this.matrixMap,m=>{m.spliceRows(c,d,h,f),this.normaliseMatrix(m,c)})}spliceColumns(c,d,h,f){s.each(this.matrixMap,m=>{m.spliceColumns(c,d,h,f),this.normaliseMatrix(m,c)})}get model(){return s.map(this.matrixMap,(c,d)=>this.getRanges(d,c)).filter(c=>c.ranges.length)}set model(c){const d=this.matrixMap={};c.forEach(h=>{const f=d[h.name]=new a;h.ranges.forEach(m=>{u.test(m.split("!").pop()||"")&&f.addCell(m)})})}}},{"../utils/cell-matrix":18,"../utils/col-cache":19,"../utils/under-dash":26,"./range":10}],7:[function(t,n,i){n.exports={ValueType:{Null:0,Merge:1,Number:2,String:3,Date:4,Hyperlink:5,Formula:6,SharedString:7,RichText:8,Boolean:9,Error:10},FormulaType:{None:0,Master:1,Shared:2},RelationshipType:{None:0,OfficeDocument:1,Worksheet:2,CalcChain:3,SharedStrings:4,Styles:5,Theme:6,Hyperlink:7},DocumentType:{Xlsx:1},ReadingOrder:{LeftToRight:1,RightToLeft:2},ErrorValue:{NotApplicable:"#N/A",Ref:"#REF!",Name:"#NAME?",DivZero:"#DIV/0!",Null:"#NULL!",Value:"#VALUE!",Num:"#NUM!"}}},{}],8:[function(t,n,i){const s=t("../utils/col-cache"),o=t("./anchor");n.exports=class{constructor(a,l){this.worksheet=a,this.model=l}get model(){switch(this.type){case"background":return{type:this.type,imageId:this.imageId};case"image":return{type:this.type,imageId:this.imageId,hyperlinks:this.range.hyperlinks,range:{tl:this.range.tl.model,br:this.range.br&&this.range.br.model,ext:this.range.ext,editAs:this.range.editAs}};default:throw new Error("Invalid Image Type")}}set model(a){let{type:l,imageId:u,range:c,hyperlinks:d}=a;if(this.type=l,this.imageId=u,l==="image")if(typeof c=="string"){const h=s.decode(c);this.range={tl:new o(this.worksheet,{col:h.left,row:h.top},-1),br:new o(this.worksheet,{col:h.right,row:h.bottom},0),editAs:"oneCell"}}else this.range={tl:new o(this.worksheet,c.tl,0),br:c.br&&new o(this.worksheet,c.br,0),ext:c.ext,editAs:c.editAs,hyperlinks:d||c.hyperlinks}}}},{"../utils/col-cache":19,"./anchor":2}],9:[function(t,n,i){const s=t("../utils/under-dash");class o{constructor(l){this.note=l}get model(){let l=null;return typeof this.note==="string"?l={type:"note",note:{texts:[{text:this.note}]}}:l={type:"note",note:this.note},s.deepMerge({},o.DEFAULT_CONFIGS,l)}set model(l){const{note:u}=l,{texts:c}=u;c.length===1&&Object.keys(c[0]).length===1?this.note=c[0].text:this.note=u}static fromModel(l){const u=new o;return u.model=l,u}}o.DEFAULT_CONFIGS={note:{margins:{insetmode:"auto",inset:[.13,.13,.25,.25]},protection:{locked:"True",lockText:"True"},editAs:"absolute"}},n.exports=o},{"../utils/under-dash":26}],10:[function(t,n,i){const s=t("../utils/col-cache");class o{constructor(){this.decode(arguments)}setTLBR(l,u,c,d,h){if(arguments.length<4){const f=s.decodeAddress(l),m=s.decodeAddress(u);this.model={top:Math.min(f.row,m.row),left:Math.min(f.col,m.col),bottom:Math.max(f.row,m.row),right:Math.max(f.col,m.col),sheetName:c},this.setTLBR(f.row,f.col,m.row,m.col,h)}else this.model={top:Math.min(l,c),left:Math.min(u,d),bottom:Math.max(l,c),right:Math.max(u,d),sheetName:h}}decode(l){switch(l.length){case 5:this.setTLBR(l[0],l[1],l[2],l[3],l[4]);break;case 4:this.setTLBR(l[0],l[1],l[2],l[3]);break;case 3:this.setTLBR(l[0],l[1],l[2]);break;case 2:this.setTLBR(l[0],l[1]);break;case 1:{const u=l[0];if(u instanceof o)this.model={top:u.model.top,left:u.model.left,bottom:u.model.bottom,right:u.model.right,sheetName:u.sheetName};else if(u instanceof Array)this.decode(u);else if(u.top&&u.left&&u.bottom&&u.right)this.model={top:u.top,left:u.left,bottom:u.bottom,right:u.right,sheetName:u.sheetName};else{const c=s.decodeEx(u);c.top?this.model={top:c.top,left:c.left,bottom:c.bottom,right:c.right,sheetName:c.sheetName}:this.model={top:c.row,left:c.col,bottom:c.row,right:c.col,sheetName:c.sheetName}}break}case 0:this.model={top:0,left:0,bottom:0,right:0};break;default:throw new Error("Invalid number of arguments to _getDimensions() - "+l.length)}}get top(){return this.model.top||1}set top(l){this.model.top=l}get left(){return this.model.left||1}set left(l){this.model.left=l}get bottom(){return this.model.bottom||1}set bottom(l){this.model.bottom=l}get right(){return this.model.right||1}set right(l){this.model.right=l}get sheetName(){return this.model.sheetName}set sheetName(l){this.model.sheetName=l}get _serialisedSheetName(){const{sheetName:l}=this.model;return l?/^[a-zA-Z0-9]*$/.test(l)?l+"!":`'${l}'!`:""}expand(l,u,c,d){(!this.model.top||l<this.top)&&(this.top=l),(!this.model.left||u<this.left)&&(this.left=u),(!this.model.bottom||c>this.bottom)&&(this.bottom=c),(!this.model.right||d>this.right)&&(this.right=d)}expandRow(l){if(l){const{dimensions:u,number:c}=l;u&&this.expand(c,u.min,c,u.max)}}expandToAddress(l){const u=s.decodeEx(l);this.expand(u.row,u.col,u.row,u.col)}get tl(){return s.n2l(this.left)+this.top}get $t$l(){return`$${s.n2l(this.left)}$${this.top}`}get br(){return s.n2l(this.right)+this.bottom}get $b$r(){return`$${s.n2l(this.right)}$${this.bottom}`}get range(){return`${this._serialisedSheetName+this.tl}:${this.br}`}get $range(){return`${this._serialisedSheetName+this.$t$l}:${this.$b$r}`}get shortRange(){return this.count>1?this.range:this._serialisedSheetName+this.tl}get $shortRange(){return this.count>1?this.$range:this._serialisedSheetName+this.$t$l}get count(){return(1+this.bottom-this.top)*(1+this.right-this.left)}toString(){return this.range}intersects(l){return(!l.sheetName||!this.sheetName||l.sheetName===this.sheetName)&&!(l.bottom<this.top)&&!(l.top>this.bottom)&&!(l.right<this.left)&&!(l.left>this.right)}contains(l){const u=s.decodeEx(l);return this.containsEx(u)}containsEx(l){return(!l.sheetName||!this.sheetName||l.sheetName===this.sheetName)&&l.row>=this.top&&l.row<=this.bottom&&l.col>=this.left&&l.col<=this.right}forEachAddress(l){for(let u=this.left;u<=this.right;u++)for(let c=this.top;c<=this.bottom;c++)l(s.encodeAddress(c,u),c,u)}}n.exports=o},{"../utils/col-cache":19}],11:[function(t,n,i){const s=t("../utils/under-dash"),o=t("./enums"),a=t("../utils/col-cache"),l=t("./cell");n.exports=class{constructor(u,c){this._worksheet=u,this._number=c,this._cells=[],this.style={},this.outlineLevel=0}get number(){return this._number}get worksheet(){return this._worksheet}commit(){this._worksheet._commitRow(this)}destroy(){delete this._worksheet,delete this._cells,delete this.style}findCell(u){return this._cells[u-1]}getCellEx(u){let c=this._cells[u.col-1];if(!c){const d=this._worksheet.getColumn(u.col);c=new l(this,d,u.address),this._cells[u.col-1]=c}return c}getCell(u){if(typeof u=="string"){const c=this._worksheet.getColumnKey(u);u=c?c.number:a.l2n(u)}return this._cells[u-1]||this.getCellEx({address:a.encodeAddress(this._number,u),row:this._number,col:u})}splice(u,c){const d=u+c;for(var h=arguments.length,f=new Array(h>2?h-2:0),m=2;m<h;m++)f[m-2]=arguments[m];const p=f.length-c,g=this._cells.length;let v,y,b;if(p<0)for(v=u+f.length;v<=g;v++)b=this._cells[v-1],y=this._cells[v-p-1],y?(b=this.getCell(v),b.value=y.value,b.style=y.style,b._comment=y._comment):b&&(b.value=null,b.style={},b._comment=void 0);else if(p>0)for(v=g;v>=d;v--)y=this._cells[v-1],y?(b=this.getCell(v+p),b.value=y.value,b.style=y.style,b._comment=y._comment):this._cells[v+p-1]=void 0;for(v=0;v<f.length;v++)b=this.getCell(u+v),b.value=f[v],b.style={},b._comment=void 0}eachCell(u,c){if(c||(c=u,u=null),u&&u.includeEmpty){const d=this._cells.length;for(let h=1;h<=d;h++)c(this.getCell(h),h)}else this._cells.forEach((d,h)=>{d&&d.type!==o.ValueType.Null&&c(d,h+1)})}addPageBreak(u,c){const d=this._worksheet,h=Math.max(0,u-1)||0,f=Math.max(0,c-1)||16838,m={id:this._number,max:f,man:1};h&&(m.min=h),d.rowBreaks.push(m)}get values(){const u=[];return this._cells.forEach(c=>{c&&c.type!==o.ValueType.Null&&(u[c.col]=c.value)}),u}set values(u){if(this._cells=[],u)if(u instanceof Array){let c=0;u.hasOwnProperty("0")&&(c=1),u.forEach((d,h)=>{d!==void 0&&(this.getCellEx({address:a.encodeAddress(this._number,h+c),row:this._number,col:h+c}).value=d)})}else this._worksheet.eachColumnKey((c,d)=>{u[d]!==void 0&&(this.getCellEx({address:a.encodeAddress(this._number,c.number),row:this._number,col:c.number}).value=u[d])})}get hasValues(){return s.some(this._cells,u=>u&&u.type!==o.ValueType.Null)}get cellCount(){return this._cells.length}get actualCellCount(){let u=0;return this.eachCell(()=>{u++}),u}get dimensions(){let u=0,c=0;return this._cells.forEach(d=>{d&&d.type!==o.ValueType.Null&&((!u||u>d.col)&&(u=d.col),c<d.col&&(c=d.col))}),u>0?{min:u,max:c}:null}_applyStyle(u,c){return this.style[u]=c,this._cells.forEach(d=>{d&&(d[u]=c)}),c}get numFmt(){return this.style.numFmt}set numFmt(u){this._applyStyle("numFmt",u)}get font(){return this.style.font}set font(u){this._applyStyle("font",u)}get alignment(){return this.style.alignment}set alignment(u){this._applyStyle("alignment",u)}get protection(){return this.style.protection}set protection(u){this._applyStyle("protection",u)}get border(){return this.style.border}set border(u){this._applyStyle("border",u)}get fill(){return this.style.fill}set fill(u){this._applyStyle("fill",u)}get hidden(){return!!this._hidden}set hidden(u){this._hidden=u}get outlineLevel(){return this._outlineLevel||0}set outlineLevel(u){this._outlineLevel=u}get collapsed(){return!!(this._outlineLevel&&this._outlineLevel>=this._worksheet.properties.outlineLevelRow)}get model(){const u=[];let c=0,d=0;return this._cells.forEach(h=>{if(h){const f=h.model;f&&((!c||c>h.col)&&(c=h.col),d<h.col&&(d=h.col),u.push(f))}}),this.height||u.length?{cells:u,number:this.number,min:c,max:d,height:this.height,style:this.style,hidden:this.hidden,outlineLevel:this.outlineLevel,collapsed:this.collapsed}:null}set model(u){if(u.number!==this._number)throw new Error("Invalid row number in model");let c;this._cells=[],u.cells.forEach(d=>{switch(d.type){case l.Types.Merge:break;default:{let h;if(d.address)h=a.decodeAddress(d.address);else if(c){const{row:f}=c,m=c.col+1;h={row:f,col:m,address:a.encodeAddress(f,m),$col$row:`$${a.n2l(m)}$${f}`}}c=h,this.getCellEx(h).model=d;break}}}),u.height?this.height=u.height:delete this.height,this.hidden=u.hidden,this.outlineLevel=u.outlineLevel||0,this.style=u.style&&JSON.parse(JSON.stringify(u.style))||{}}}},{"../utils/col-cache":19,"../utils/under-dash":26,"./cell":3,"./enums":7}],12:[function(t,n,i){const s=t("../utils/col-cache");class o{constructor(l,u,c){this.table=l,this.column=u,this.index=c}_set(l,u){this.table.cacheState(),this.column[l]=u}get name(){return this.column.name}set name(l){this._set("name",l)}get filterButton(){return this.column.filterButton}set filterButton(l){this.column.filterButton=l}get style(){return this.column.style}set style(l){this.column.style=l}get totalsRowLabel(){return this.column.totalsRowLabel}set totalsRowLabel(l){this._set("totalsRowLabel",l)}get totalsRowFunction(){return this.column.totalsRowFunction}set totalsRowFunction(l){this._set("totalsRowFunction",l)}get totalsRowResult(){return this.column.totalsRowResult}set totalsRowResult(l){this._set("totalsRowResult",l)}get totalsRowFormula(){return this.column.totalsRowFormula}set totalsRowFormula(l){this._set("totalsRowFormula",l)}}n.exports=class{constructor(a,l){this.worksheet=a,l&&(this.table=l,this.validate(),this.store())}getFormula(a){switch(a.totalsRowFunction){case"none":return null;case"average":return`SUBTOTAL(101,${this.table.name}[${a.name}])`;case"countNums":return`SUBTOTAL(102,${this.table.name}[${a.name}])`;case"count":return`SUBTOTAL(103,${this.table.name}[${a.name}])`;case"max":return`SUBTOTAL(104,${this.table.name}[${a.name}])`;case"min":return`SUBTOTAL(105,${this.table.name}[${a.name}])`;case"stdDev":return`SUBTOTAL(106,${this.table.name}[${a.name}])`;case"var":return`SUBTOTAL(107,${this.table.name}[${a.name}])`;case"sum":return`SUBTOTAL(109,${this.table.name}[${a.name}])`;case"custom":return a.totalsRowFormula;default:throw new Error("Invalid Totals Row Function: "+a.totalsRowFunction)}}get width(){return this.table.columns.length}get height(){return this.table.rows.length}get filterHeight(){return this.height+(this.table.headerRow?1:0)}get tableHeight(){return this.filterHeight+(this.table.totalsRow?1:0)}validate(){const{table:a}=this,l=(p,g,v)=>{p[g]===void 0&&(p[g]=v)};l(a,"headerRow",!0),l(a,"totalsRow",!1),l(a,"style",{}),l(a.style,"theme","TableStyleMedium2"),l(a.style,"showFirstColumn",!1),l(a.style,"showLastColumn",!1),l(a.style,"showRowStripes",!1),l(a.style,"showColumnStripes",!1);const u=(p,g)=>{if(!p)throw new Error(g)};u(a.ref,"Table must have ref"),u(a.columns,"Table must have column definitions"),u(a.rows,"Table must have row definitions"),a.tl=s.decodeAddress(a.ref);const{row:c,col:d}=a.tl;u(c>0,"Table must be on valid row"),u(d>0,"Table must be on valid col");const{width:h,filterHeight:f,tableHeight:m}=this;a.autoFilterRef=s.encode(c,d,c+f-1,d+h-1),a.tableRef=s.encode(c,d,c+m-1,d+h-1),a.columns.forEach((p,g)=>{u(p.name,`Column ${g} must have a name`),g===0?l(p,"totalsRowLabel","Total"):(l(p,"totalsRowFunction","none"),p.totalsRowFormula=this.getFormula(p))})}store(){const a=(f,m)=>{m&&Object.keys(m).forEach(p=>{f[p]=m[p]})},{worksheet:l,table:u}=this,{row:c,col:d}=u.tl;let h=0;if(u.headerRow){const f=l.getRow(c+h++);u.columns.forEach((m,p)=>{const{style:g,name:v}=m,y=f.getCell(d+p);y.value=v,a(y,g)})}if(u.rows.forEach(f=>{const m=l.getRow(c+h++);f.forEach((p,g)=>{const v=m.getCell(d+g);v.value=p,a(v,u.columns[g].style)})}),u.totalsRow){const f=l.getRow(c+h++);u.columns.forEach((m,p)=>{const g=f.getCell(d+p);if(p===0)g.value=m.totalsRowLabel;else{const v=this.getFormula(m);g.value=v?{formula:m.totalsRowFormula,result:m.totalsRowResult}:null}a(g,m.style)})}}load(a){const{table:l}=this,{row:u,col:c}=l.tl;let d=0;if(l.headerRow){const h=a.getRow(u+d++);l.columns.forEach((f,m)=>{h.getCell(c+m).value=f.name})}if(l.rows.forEach(h=>{const f=a.getRow(u+d++);h.forEach((m,p)=>{f.getCell(c+p).value=m})}),l.totalsRow){const h=a.getRow(u+d++);l.columns.forEach((f,m)=>{const p=h.getCell(c+m);m===0?p.value=f.totalsRowLabel:this.getFormula(f)&&(p.value={formula:f.totalsRowFormula,result:f.totalsRowResult})})}}get model(){return this.table}set model(a){this.table=a}cacheState(){this._cache||(this._cache={ref:this.ref,width:this.width,tableHeight:this.tableHeight})}commit(){if(!this._cache)return;this.validate();const a=s.decodeAddress(this._cache.ref);if(this.ref!==this._cache.ref)for(let l=0;l<this._cache.tableHeight;l++){const u=this.worksheet.getRow(a.row+l);for(let c=0;c<this._cache.width;c++)u.getCell(a.col+c).value=null}else{for(let l=this.tableHeight;l<this._cache.tableHeight;l++){const u=this.worksheet.getRow(a.row+l);for(let c=0;c<this._cache.width;c++)u.getCell(a.col+c).value=null}for(let l=0;l<this.tableHeight;l++){const u=this.worksheet.getRow(a.row+l);for(let c=this.width;c<this._cache.width;c++)u.getCell(a.col+c).value=null}}this.store()}addRow(a,l){this.cacheState(),l===void 0?this.table.rows.push(a):this.table.rows.splice(l,0,a)}removeRows(a){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cacheState(),this.table.rows.splice(a,l)}getColumn(a){const l=this.table.columns[a];return new o(this,l,a)}addColumn(a,l,u){this.cacheState(),u===void 0?(this.table.columns.push(a),this.table.rows.forEach((c,d)=>{c.push(l[d])})):(this.table.columns.splice(u,0,a),this.table.rows.forEach((c,d)=>{c.splice(u,0,l[d])}))}removeColumns(a){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cacheState(),this.table.columns.splice(a,l),this.table.rows.forEach(u=>{u.splice(a,l)})}_assign(a,l,u){this.cacheState(),a[l]=u}get ref(){return this.table.ref}set ref(a){this._assign(this.table,"ref",a)}get name(){return this.table.name}set name(a){this.table.name=a}get displayName(){return this.table.displyName||this.table.name}set displayNamename(a){this.table.displayName=a}get headerRow(){return this.table.headerRow}set headerRow(a){this._assign(this.table,"headerRow",a)}get totalsRow(){return this.table.totalsRow}set totalsRow(a){this._assign(this.table,"totalsRow",a)}get theme(){return this.table.style.name}set theme(a){this.table.style.name=a}get showFirstColumn(){return this.table.style.showFirstColumn}set showFirstColumn(a){this.table.style.showFirstColumn=a}get showLastColumn(){return this.table.style.showLastColumn}set showLastColumn(a){this.table.style.showLastColumn=a}get showRowStripes(){return this.table.style.showRowStripes}set showRowStripes(a){this.table.style.showRowStripes=a}get showColumnStripes(){return this.table.style.showColumnStripes}set showColumnStripes(a){this.table.style.showColumnStripes=a}}},{"../utils/col-cache":19}],13:[function(t,n,i){const s=t("./worksheet"),o=t("./defined-names"),a=t("../xlsx/xlsx"),l=t("../csv/csv");n.exports=class{constructor(){this.category="",this.company="",this.created=new Date,this.description="",this.keywords="",this.manager="",this.modified=this.created,this.properties={},this.calcProperties={},this._worksheets=[],this.subject="",this.title="",this.views=[],this.media=[],this._definedNames=new o}get xlsx(){return this._xlsx||(this._xlsx=new a(this)),this._xlsx}get csv(){return this._csv||(this._csv=new l(this)),this._csv}get nextId(){for(let u=1;u<this._worksheets.length;u++)if(!this._worksheets[u])return u;return this._worksheets.length||1}addWorksheet(u,c){const d=this.nextId;c&&(typeof c=="string"?(console.trace('tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { argb: "rbg value" } }'),c={properties:{tabColor:{argb:c}}}):(c.argb||c.theme||c.indexed)&&(console.trace("tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { ... } }"),c={properties:{tabColor:c}}));const h=this._worksheets.reduce((p,g)=>(g&&g.orderNo)>p?g.orderNo:p,0),f=Object.assign({},c,{id:d,name:u,orderNo:h+1,workbook:this}),m=new s(f);return this._worksheets[d]=m,m}removeWorksheetEx(u){delete this._worksheets[u.id]}removeWorksheet(u){const c=this.getWorksheet(u);c&&c.destroy()}getWorksheet(u){return u===void 0?this._worksheets.find(Boolean):typeof u=="number"?this._worksheets[u]:typeof u=="string"?this._worksheets.find(c=>c&&c.name===u):void 0}get worksheets(){return this._worksheets.slice(1).sort((u,c)=>u.orderNo-c.orderNo).filter(Boolean)}eachSheet(u){this.worksheets.forEach(c=>{u(c,c.id)})}get definedNames(){return this._definedNames}clearThemes(){this._themes=void 0}addImage(u){const c=this.media.length;return this.media.push(Object.assign({},u,{type:"image"})),c}getImage(u){return this.media[u]}get model(){return{creator:this.creator||"Unknown",lastModifiedBy:this.lastModifiedBy||"Unknown",lastPrinted:this.lastPrinted,created:this.created,modified:this.modified,properties:this.properties,worksheets:this.worksheets.map(u=>u.model),sheets:this.worksheets.map(u=>u.model).filter(Boolean),definedNames:this._definedNames.model,views:this.views,company:this.company,manager:this.manager,title:this.title,subject:this.subject,keywords:this.keywords,category:this.category,description:this.description,language:this.language,revision:this.revision,contentStatus:this.contentStatus,themes:this._themes,media:this.media,calcProperties:this.calcProperties}}set model(u){this.creator=u.creator,this.lastModifiedBy=u.lastModifiedBy,this.lastPrinted=u.lastPrinted,this.created=u.created,this.modified=u.modified,this.company=u.company,this.manager=u.manager,this.title=u.title,this.subject=u.subject,this.keywords=u.keywords,this.category=u.category,this.description=u.description,this.language=u.language,this.revision=u.revision,this.contentStatus=u.contentStatus,this.properties=u.properties,this.calcProperties=u.calcProperties,this._worksheets=[],u.worksheets.forEach(c=>{const{id:d,name:h,state:f}=c,m=u.sheets&&u.sheets.findIndex(p=>p.id===d);(this._worksheets[d]=new s({id:d,name:h,orderNo:m,state:f,workbook:this})).model=c}),this._definedNames.model=u.definedNames,this.views=u.views,this._themes=u.themes,this.media=u.media||[]}}},{"../csv/csv":1,"../xlsx/xlsx":144,"./defined-names":6,"./worksheet":14}],14:[function(t,n,i){const s=t("../utils/under-dash"),o=t("../utils/col-cache"),a=t("./range"),l=t("./row"),u=t("./column"),c=t("./enums"),d=t("./image"),h=t("./table"),f=t("./data-validations"),m=t("../utils/encryptor"),{copyStyle:p}=t("../utils/copy-style");n.exports=class{constructor(g){g=g||{},this._workbook=g.workbook,this.id=g.id,this.orderNo=g.orderNo,this.name=g.name,this.state=g.state||"visible",this._rows=[],this._columns=null,this._keys={},this._merges={},this.rowBreaks=[],this.properties=Object.assign({},{defaultRowHeight:15,dyDescent:55,outlineLevelCol:0,outlineLevelRow:0},g.properties),this.pageSetup=Object.assign({},{margins:{left:.7,right:.7,top:.75,bottom:.75,header:.3,footer:.3},orientation:"portrait",horizontalDpi:4294967295,verticalDpi:4294967295,fitToPage:!(!g.pageSetup||!g.pageSetup.fitToWidth&&!g.pageSetup.fitToHeight||g.pageSetup.scale),pageOrder:"downThenOver",blackAndWhite:!1,draft:!1,cellComments:"None",errors:"displayed",scale:100,fitToWidth:1,fitToHeight:1,paperSize:void 0,showRowColHeaders:!1,showGridLines:!1,firstPageNumber:void 0,horizontalCentered:!1,verticalCentered:!1,rowBreaks:null,colBreaks:null},g.pageSetup),this.headerFooter=Object.assign({},{differentFirst:!1,differentOddEven:!1,oddHeader:null,oddFooter:null,evenHeader:null,evenFooter:null,firstHeader:null,firstFooter:null},g.headerFooter),this.dataValidations=new f,this.views=g.views||[],this.autoFilter=g.autoFilter||null,this._media=[],this.sheetProtection=null,this.tables={},this.conditionalFormattings=[]}get name(){return this._name}set name(g){if(g===void 0&&(g="sheet"+this.id),this._name!==g){if(typeof g!="string")throw new Error("The name has to be a string.");if(g==="")throw new Error("The name can't be empty.");if(g==="History")throw new Error('The name "History" is protected. Please use a different name.');if(/[*?:/\\[\]]/.test(g))throw new Error(`Worksheet name ${g} cannot include any of the following characters: * ? : \\ / [ ]`);if(/(^')|('$)/.test(g))throw new Error("The first or last character of worksheet name cannot be a single quotation mark: "+g);if(g&&g.length>31&&(console.warn(`Worksheet name ${g} exceeds 31 chars. This will be truncated`),g=g.substring(0,31)),this._workbook._worksheets.find(v=>v&&v.name.toLowerCase()===g.toLowerCase()))throw new Error("Worksheet name already exists: "+g);this._name=g}}get workbook(){return this._workbook}destroy(){this._workbook.removeWorksheetEx(this)}get dimensions(){const g=new a;return this._rows.forEach(v=>{if(v){const y=v.dimensions;y&&g.expand(v.number,y.min,v.number,y.max)}}),g}get columns(){return this._columns}set columns(g){this._headerRowCount=g.reduce((b,E)=>{const A=(E.header?1:E.headers&&E.headers.length)||0;return Math.max(b,A)},0);let v=1;const y=this._columns=[];g.forEach(b=>{const E=new u(this,v++,!1);y.push(E),E.defn=b})}getColumnKey(g){return this._keys[g]}setColumnKey(g,v){this._keys[g]=v}deleteColumnKey(g){delete this._keys[g]}eachColumnKey(g){s.each(this._keys,g)}getColumn(g){if(typeof g=="string"){const v=this._keys[g];if(v)return v;g=o.l2n(g)}if(this._columns||(this._columns=[]),g>this._columns.length){let v=this._columns.length+1;for(;v<=g;)this._columns.push(new u(this,v++))}return this._columns[g-1]}spliceColumns(g,v){const y=this._rows.length;for(var b=arguments.length,E=new Array(b>2?b-2:0),A=2;A<b;A++)E[A-2]=arguments[A];if(E.length>0)for(let P=0;P<y;P++){const U=[g,v];E.forEach(V=>{U.push(V[P]||null)});const $=this.getRow(P+1);$.splice.apply($,U)}else this._rows.forEach(P=>{P&&P.splice(g,v)});const M=E.length-v,L=g+v,k=this._columns.length;if(M<0)for(let P=g+E.length;P<=k;P++)this.getColumn(P).defn=this.getColumn(P-M).defn;else if(M>0)for(let P=k;P>=L;P--)this.getColumn(P+M).defn=this.getColumn(P).defn;for(let P=g;P<g+E.length;P++)this.getColumn(P).defn=null;this.workbook.definedNames.spliceColumns(this.name,g,v,E.length)}get lastColumn(){return this.getColumn(this.columnCount)}get columnCount(){let g=0;return this.eachRow(v=>{g=Math.max(g,v.cellCount)}),g}get actualColumnCount(){const g=[];let v=0;return this.eachRow(y=>{y.eachCell(b=>{let{col:E}=b;g[E]||(g[E]=!0,v++)})}),v}_commitRow(){}get _lastRowNumber(){const g=this._rows;let v=g.length;for(;v>0&&g[v-1]===void 0;)v--;return v}get _nextRow(){return this._lastRowNumber+1}get lastRow(){if(this._rows.length)return this._rows[this._rows.length-1]}findRow(g){return this._rows[g-1]}findRows(g,v){return this._rows.slice(g-1,g-1+v)}get rowCount(){return this._lastRowNumber}get actualRowCount(){let g=0;return this.eachRow(()=>{g++}),g}getRow(g){let v=this._rows[g-1];return v||(v=this._rows[g-1]=new l(this,g)),v}getRows(g,v){if(v<1)return;const y=[];for(let b=g;b<g+v;b++)y.push(this.getRow(b));return y}addRow(g){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"n";const y=this._nextRow,b=this.getRow(y);return b.values=g,this._setStyleOption(y,v[0]==="i"?v:"n"),b}addRows(g){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"n";const y=[];return g.forEach(b=>{y.push(this.addRow(b,v))}),y}insertRow(g,v){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"n";return this.spliceRows(g,0,v),this._setStyleOption(g,y),this.getRow(g)}insertRows(g,v){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"n";if(this.spliceRows(g,0,...v),y!=="n")for(let b=0;b<v.length;b++)y[0]==="o"&&this.findRow(v.length+g+b)!==void 0?this._copyStyle(v.length+g+b,g+b,y[1]==="+"):y[0]==="i"&&this.findRow(g-1)!==void 0&&this._copyStyle(g-1,g+b,y[1]==="+");return this.getRows(g,v.length)}_setStyleOption(g){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"n";v[0]==="o"&&this.findRow(g+1)!==void 0?this._copyStyle(g+1,g,v[1]==="+"):v[0]==="i"&&this.findRow(g-1)!==void 0&&this._copyStyle(g-1,g,v[1]==="+")}_copyStyle(g,v){let y=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const b=this.getRow(g),E=this.getRow(v);E.style=p(b.style),b.eachCell({includeEmpty:y},(A,M)=>{E.getCell(M).style=p(A.style)}),E.height=b.height}duplicateRow(g,v){let y=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const b=this._rows[g-1],E=new Array(v).fill(b.values);this.spliceRows(g+1,y?0:v,...E);for(let A=0;A<v;A++){const M=this._rows[g+A];M.style=b.style,M.height=b.height,b.eachCell({includeEmpty:!0},(L,k)=>{M.getCell(k).style=L.style})}}spliceRows(g,v){const y=g+v;for(var b=arguments.length,E=new Array(b>2?b-2:0),A=2;A<b;A++)E[A-2]=arguments[A];const M=E.length,L=M-v,k=this._rows.length;let P,U;if(L<0)for(g===k&&(this._rows[k-1]=void 0),P=y;P<=k;P++)if(U=this._rows[P-1],U){const $=this.getRow(P+L);$.values=U.values,$.style=U.style,$.height=U.height,U.eachCell({includeEmpty:!0},(V,R)=>{$.getCell(R).style=V.style}),this._rows[P-1]=void 0}else this._rows[P+L-1]=void 0;else if(L>0)for(P=k;P>=y;P--)if(U=this._rows[P-1],U){const $=this.getRow(P+L);$.values=U.values,$.style=U.style,$.height=U.height,U.eachCell({includeEmpty:!0},(V,R)=>{if($.getCell(R).style=V.style,V._value.constructor.name==="MergeValue"){const O=this.getRow(V._row._number+M).getCell(R),T=V._value._master,w=this.getRow(T._row._number+M).getCell(T._column._number);O.merge(w)}})}else this._rows[P+L-1]=void 0;for(P=0;P<M;P++){const $=this.getRow(g+P);$.style={},$.values=E[P]}this.workbook.definedNames.spliceRows(this.name,g,v,M)}eachRow(g,v){if(v||(v=g,g=void 0),g&&g.includeEmpty){const y=this._rows.length;for(let b=1;b<=y;b++)v(this.getRow(b),b)}else this._rows.forEach(y=>{y&&y.hasValues&&v(y,y.number)})}getSheetValues(){const g=[];return this._rows.forEach(v=>{v&&(g[v.number]=v.values)}),g}findCell(g,v){const y=o.getAddress(g,v),b=this._rows[y.row-1];return b?b.findCell(y.col):void 0}getCell(g,v){const y=o.getAddress(g,v);return this.getRow(y.row).getCellEx(y)}mergeCells(){for(var g=arguments.length,v=new Array(g),y=0;y<g;y++)v[y]=arguments[y];const b=new a(v);this._mergeCellsInternal(b)}mergeCellsWithoutStyle(){for(var g=arguments.length,v=new Array(g),y=0;y<g;y++)v[y]=arguments[y];const b=new a(v);this._mergeCellsInternal(b,!0)}_mergeCellsInternal(g,v){s.each(this._merges,b=>{if(b.intersects(g))throw new Error("Cannot merge already merged cells")});const y=this.getCell(g.top,g.left);for(let b=g.top;b<=g.bottom;b++)for(let E=g.left;E<=g.right;E++)(b>g.top||E>g.left)&&this.getCell(b,E).merge(y,v);this._merges[y.address]=g}_unMergeMaster(g){const v=this._merges[g.address];if(v){for(let y=v.top;y<=v.bottom;y++)for(let b=v.left;b<=v.right;b++)this.getCell(y,b).unmerge();delete this._merges[g.address]}}get hasMerges(){return s.some(this._merges,Boolean)}unMergeCells(){for(var g=arguments.length,v=new Array(g),y=0;y<g;y++)v[y]=arguments[y];const b=new a(v);for(let E=b.top;E<=b.bottom;E++)for(let A=b.left;A<=b.right;A++){const M=this.findCell(E,A);M&&(M.type===c.ValueType.Merge?this._unMergeMaster(M.master):this._merges[M.address]&&this._unMergeMaster(M))}}fillFormula(g,v,y){let b=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"shared";const E=o.decode(g),{top:A,left:M,bottom:L,right:k}=E,P=k-M+1,U=o.encodeAddress(A,M),$=b==="shared";let V;V=typeof y=="function"?y:Array.isArray(y)?Array.isArray(y[0])?(O,T)=>y[O-A][T-M]:(O,T)=>y[(O-A)*P+(T-M)]:()=>{};let R=!0;for(let O=A;O<=L;O++)for(let T=M;T<=k;T++)R?(this.getCell(O,T).value={shareType:b,formula:v,ref:g,result:V(O,T)},R=!1):this.getCell(O,T).value=$?{sharedFormula:U,result:V(O,T)}:V(O,T)}addImage(g,v){const y={type:"image",imageId:g,range:v};this._media.push(new d(this,y))}getImages(){return this._media.filter(g=>g.type==="image")}addBackgroundImage(g){const v={type:"background",imageId:g};this._media.push(new d(this,v))}getBackgroundImageId(){const g=this._media.find(v=>v.type==="background");return g&&g.imageId}protect(g,v){return new Promise(y=>{this.sheetProtection={sheet:!0},v&&"spinCount"in v&&(v.spinCount=Number.isFinite(v.spinCount)?Math.round(Math.max(0,v.spinCount)):1e5),g&&(this.sheetProtection.algorithmName="SHA-512",this.sheetProtection.saltValue=m.randomBytes(16).toString("base64"),this.sheetProtection.spinCount=v&&"spinCount"in v?v.spinCount:1e5,this.sheetProtection.hashValue=m.convertPasswordToHash(g,"SHA512",this.sheetProtection.saltValue,this.sheetProtection.spinCount)),v&&(this.sheetProtection=Object.assign(this.sheetProtection,v),!g&&"spinCount"in v&&delete this.sheetProtection.spinCount),y()})}unprotect(){this.sheetProtection=null}addTable(g){const v=new h(this,g);return this.tables[g.name]=v,v}getTable(g){return this.tables[g]}removeTable(g){delete this.tables[g]}getTables(){return Object.values(this.tables)}addConditionalFormatting(g){this.conditionalFormattings.push(g)}removeConditionalFormatting(g){typeof g=="number"?this.conditionalFormattings.splice(g,1):this.conditionalFormattings=g instanceof Function?this.conditionalFormattings.filter(g):[]}get tabColor(){return console.trace("worksheet.tabColor property is now deprecated. Please use worksheet.properties.tabColor"),this.properties.tabColor}set tabColor(g){console.trace("worksheet.tabColor property is now deprecated. Please use worksheet.properties.tabColor"),this.properties.tabColor=g}get model(){const g={id:this.id,name:this.name,dataValidations:this.dataValidations.model,properties:this.properties,state:this.state,pageSetup:this.pageSetup,headerFooter:this.headerFooter,rowBreaks:this.rowBreaks,views:this.views,autoFilter:this.autoFilter,media:this._media.map(b=>b.model),sheetProtection:this.sheetProtection,tables:Object.values(this.tables).map(b=>b.model),conditionalFormattings:this.conditionalFormattings};g.cols=u.toModel(this.columns);const v=g.rows=[],y=g.dimensions=new a;return this._rows.forEach(b=>{const E=b&&b.model;E&&(y.expand(E.number,E.min,E.number,E.max),v.push(E))}),g.merges=[],s.each(this._merges,b=>{g.merges.push(b.range)}),g}_parseRows(g){this._rows=[],g.rows.forEach(v=>{const y=new l(this,v.number);this._rows[y.number-1]=y,y.model=v})}_parseMergeCells(g){s.each(g.mergeCells,v=>{this.mergeCellsWithoutStyle(v)})}set model(g){this.name=g.name,this._columns=u.fromModel(this,g.cols),this._parseRows(g),this._parseMergeCells(g),this.dataValidations=new f(g.dataValidations),this.properties=g.properties,this.pageSetup=g.pageSetup,this.headerFooter=g.headerFooter,this.views=g.views,this.autoFilter=g.autoFilter,this._media=g.media.map(v=>new d(this,v)),this.sheetProtection=g.sheetProtection,this.tables=g.tables.reduce((v,y)=>{const b=new h;return b.model=y,v[y.name]=b,v},{}),this.conditionalFormattings=g.conditionalFormattings}}},{"../utils/col-cache":19,"../utils/copy-style":20,"../utils/encryptor":21,"../utils/under-dash":26,"./column":4,"./data-validations":5,"./enums":7,"./image":8,"./range":10,"./row":11,"./table":12}],15:[function(t,n,i){t("core-js/modules/es.promise"),t("core-js/modules/es.promise.finally"),t("core-js/modules/es.object.assign"),t("core-js/modules/es.object.keys"),t("core-js/modules/es.object.values"),t("core-js/modules/es.symbol"),t("core-js/modules/es.symbol.async-iterator"),t("core-js/modules/es.array.iterator"),t("core-js/modules/es.array.includes"),t("core-js/modules/es.array.find-index"),t("core-js/modules/es.array.find"),t("core-js/modules/es.string.from-code-point"),t("core-js/modules/es.string.includes"),t("core-js/modules/es.number.is-nan"),t("regenerator-runtime/runtime");const s={Workbook:t("./doc/workbook")},o=t("./doc/enums");Object.keys(o).forEach(a=>{s[a]=o[a]}),n.exports=s},{"./doc/enums":7,"./doc/workbook":13,"core-js/modules/es.array.find":359,"core-js/modules/es.array.find-index":358,"core-js/modules/es.array.includes":360,"core-js/modules/es.array.iterator":361,"core-js/modules/es.number.is-nan":363,"core-js/modules/es.object.assign":364,"core-js/modules/es.object.keys":366,"core-js/modules/es.object.values":367,"core-js/modules/es.promise":372,"core-js/modules/es.promise.finally":371,"core-js/modules/es.string.from-code-point":376,"core-js/modules/es.string.includes":377,"core-js/modules/es.symbol":381,"core-js/modules/es.symbol.async-iterator":378,"regenerator-runtime/runtime":492}],16:[function(t,n,i){const s=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");i.bufferToString=function(o){return typeof o=="string"?o:s?s.decode(o):o.toString()}},{}],17:[function(t,n,i){const s=typeof TextEncoder>"u"?null:new TextEncoder("utf-8"),{Buffer:o}=t("buffer");i.stringToBuffer=function(a){return typeof a!="string"?a:s?o.from(s.encode(a).buffer):o.from(a)}},{buffer:220}],18:[function(t,n,i){const s=t("./under-dash"),o=t("./col-cache");n.exports=class{constructor(a){this.template=a,this.sheets={}}addCell(a){this.addCellEx(o.decodeEx(a))}getCell(a){return this.findCellEx(o.decodeEx(a),!0)}findCell(a){return this.findCellEx(o.decodeEx(a),!1)}findCellAt(a,l,u){const c=this.sheets[a],d=c&&c[l];return d&&d[u]}addCellEx(a){if(a.top)for(let l=a.top;l<=a.bottom;l++)for(let u=a.left;u<=a.right;u++)this.getCellAt(a.sheetName,l,u);else this.findCellEx(a,!0)}getCellEx(a){return this.findCellEx(a,!0)}findCellEx(a,l){const u=this.findSheet(a,l),c=this.findSheetRow(u,a,l);return this.findRowCell(c,a,l)}getCellAt(a,l,u){const c=this.sheets[a]||(this.sheets[a]=[]),d=c[l]||(c[l]=[]);return d[u]||(d[u]={sheetName:a,address:o.n2l(u)+l,row:l,col:u})}removeCellEx(a){const l=this.findSheet(a);if(!l)return;const u=this.findSheetRow(l,a);u&&delete u[a.col]}forEachInSheet(a,l){const u=this.sheets[a];u&&u.forEach((c,d)=>{c&&c.forEach((h,f)=>{h&&l(h,d,f)})})}forEach(a){s.each(this.sheets,(l,u)=>{this.forEachInSheet(u,a)})}map(a){const l=[];return this.forEach(u=>{l.push(a(u))}),l}findSheet(a,l){const u=a.sheetName;return this.sheets[u]?this.sheets[u]:l?this.sheets[u]=[]:void 0}findSheetRow(a,l,u){const{row:c}=l;return a&&a[c]?a[c]:u?a[c]=[]:void 0}findRowCell(a,l,u){const{col:c}=l;return a&&a[c]?a[c]:u?a[c]=this.template?Object.assign(l,JSON.parse(JSON.stringify(this.template))):l:void 0}spliceRows(a,l,u,c){const d=this.sheets[a];if(d){const h=[];for(let f=0;f<c;f++)h.push([]);d.splice(l,u,...h)}}spliceColumns(a,l,u,c){const d=this.sheets[a];if(d){const h=[];for(let f=0;f<c;f++)h.push(null);s.each(d,f=>{f.splice(l,u,...h)})}}}},{"./col-cache":19,"./under-dash":26}],19:[function(t,n,i){const s=/^[A-Z]+\d+$/,o={_dictionary:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],_l2nFill:0,_l2n:{},_n2l:[],_level:a=>a<=26?1:a<=676?2:3,_fill(a){let l,u,c,d,h,f=1;if(a>=4)throw new Error("Out of bounds. Excel supports columns from 1 to 16384");if(this._l2nFill<1&&a>=1){for(;f<=26;)l=this._dictionary[f-1],this._n2l[f]=l,this._l2n[l]=f,f++;this._l2nFill=1}if(this._l2nFill<2&&a>=2){for(f=27;f<=702;)u=f-27,c=u%26,d=Math.floor(u/26),l=this._dictionary[d]+this._dictionary[c],this._n2l[f]=l,this._l2n[l]=f,f++;this._l2nFill=2}if(this._l2nFill<3&&a>=3){for(f=703;f<=16384;)u=f-703,c=u%26,d=Math.floor(u/26)%26,h=Math.floor(u/676),l=this._dictionary[h]+this._dictionary[d]+this._dictionary[c],this._n2l[f]=l,this._l2n[l]=f,f++;this._l2nFill=3}},l2n(a){if(this._l2n[a]||this._fill(a.length),!this._l2n[a])throw new Error("Out of bounds. Invalid column letter: "+a);return this._l2n[a]},n2l(a){if(a<1||a>16384)throw new Error(a+" is out of bounds. Excel supports columns from 1 to 16384");return this._n2l[a]||this._fill(this._level(a)),this._n2l[a]},_hash:{},validateAddress(a){if(!s.test(a))throw new Error("Invalid Address: "+a);return!0},decodeAddress(a){const l=a.length<5&&this._hash[a];if(l)return l;let u=!1,c="",d=0,h=!1,f="",m=0;for(let g,v=0;v<a.length;v++)if(g=a.charCodeAt(v),!h&&g>=65&&g<=90)u=!0,c+=a[v],d=26*d+g-64;else if(g>=48&&g<=57)h=!0,f+=a[v],m=10*m+g-48;else if(h&&u&&g!==36)break;if(u){if(d>16384)throw new Error("Out of bounds. Invalid column letter: "+c)}else d=void 0;h||(m=void 0);const p={address:a=c+f,col:d,row:m,$col$row:`$${c}$${f}`};return d<=100&&m<=100&&(this._hash[a]=p,this._hash[p.$col$row]=p),p},getAddress(a,l){if(l){const u=this.n2l(l)+a;return this.decodeAddress(u)}return this.decodeAddress(a)},decode(a){const l=a.split(":");if(l.length===2){const u=this.decodeAddress(l[0]),c=this.decodeAddress(l[1]),d={top:Math.min(u.row,c.row),left:Math.min(u.col,c.col),bottom:Math.max(u.row,c.row),right:Math.max(u.col,c.col)};return d.tl=this.n2l(d.left)+d.top,d.br=this.n2l(d.right)+d.bottom,d.dimensions=`${d.tl}:${d.br}`,d}return this.decodeAddress(a)},decodeEx(a){const l=a.match(/(?:(?:(?:'((?:[^']|'')*)')|([^'^ !]*))!)?(.*)/),u=l[1]||l[2],c=l[3],d=c.split(":");if(d.length>1){let f=this.decodeAddress(d[0]),m=this.decodeAddress(d[1]);const p=Math.min(f.row,m.row),g=Math.min(f.col,m.col),v=Math.max(f.row,m.row),y=Math.max(f.col,m.col);return f=this.n2l(g)+p,m=this.n2l(y)+v,{top:p,left:g,bottom:v,right:y,sheetName:u,tl:{address:f,col:g,row:p,$col$row:`$${this.n2l(g)}$${p}`,sheetName:u},br:{address:m,col:y,row:v,$col$row:`$${this.n2l(y)}$${v}`,sheetName:u},dimensions:`${f}:${m}`}}if(c.startsWith("#"))return u?{sheetName:u,error:c}:{error:c};const h=this.decodeAddress(c);return u?{sheetName:u,...h}:h},encodeAddress:(a,l)=>o.n2l(l)+a,encode(){switch(arguments.length){case 2:return o.encodeAddress(arguments[0],arguments[1]);case 4:return`${o.encodeAddress(arguments[0],arguments[1])}:${o.encodeAddress(arguments[2],arguments[3])}`;default:throw new Error("Can only encode with 2 or 4 arguments")}},inRange(a,l){const[u,c,,d,h]=a,[f,m]=l;return f>=u&&f<=d&&m>=c&&m<=h}};n.exports=o},{}],20:[function(t,n,i){const s=(a,l)=>({...a,...l.reduce((u,c)=>(a[c]&&(u[c]={...a[c]}),u),{})}),o=function(a,l,u){let c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[];a[u]&&(l[u]=s(a[u],c))};i.copyStyle=a=>{if(!a)return a;if(l=a,Object.keys(l).length===0)return{};var l;const u={...a};return o(a,u,"font",["color"]),o(a,u,"alignment"),o(a,u,"protection"),a.border&&(o(a,u,"border"),o(a.border,u.border,"top",["color"]),o(a.border,u.border,"left",["color"]),o(a.border,u.border,"bottom",["color"]),o(a.border,u.border,"right",["color"]),o(a.border,u.border,"diagonal",["color"])),a.fill&&(o(a,u,"fill",["fgColor","bgColor","center"]),a.fill.stops&&(u.fill.stops=a.fill.stops.map(c=>s(c,["color"])))),u}},{}],21:[function(t,n,i){(function(s){(function(){const o=t("crypto"),a={hash(l){const u=o.createHash(l);for(var c=arguments.length,d=new Array(c>1?c-1:0),h=1;h<c;h++)d[h-1]=arguments[h];return u.update(s.concat(d)),u.digest()},convertPasswordToHash(l,u,c,d){if(u=u.toLowerCase(),o.getHashes().indexOf(u)<0)throw new Error(`Hash algorithm '${u}' not supported!`);const h=s.from(l,"utf16le");let f=this.hash(u,s.from(c,"base64"),h);for(let m=0;m<d;m++){const p=s.alloc(4);p.writeUInt32LE(m,0),f=this.hash(u,f,p)}return f.toString("base64")},randomBytes:l=>o.randomBytes(l)};n.exports=a}).call(this)}).call(this,t("buffer").Buffer)},{buffer:220,crypto:390}],22:[function(t,n,i){const{SaxesParser:s}=t("saxes"),{PassThrough:o}=t("readable-stream"),{bufferToString:a}=t("./browser-buffer-decode");n.exports=async function*(l){l.pipe&&!l[Symbol.asyncIterator]&&(l=l.pipe(new o));const u=new s;let c;u.on("error",h=>{c=h});let d=[];u.on("opentag",h=>d.push({eventType:"opentag",value:h})),u.on("text",h=>d.push({eventType:"text",value:h})),u.on("closetag",h=>d.push({eventType:"closetag",value:h}));for await(const h of l){if(u.write(a(h)),c)throw c;yield d,d=[]}}},{"./browser-buffer-decode":16,"readable-stream":491,saxes:496}],23:[function(t,n,i){const s=t("./col-cache"),o=/(([a-z_\-0-9]*)!)?([a-z0-9_$]{2,})([(])?/gi,a=/^([$])?([a-z]+)([$])?([1-9][0-9]*)$/i;n.exports={slideFormula:function(l,u,c){const d=s.decode(u),h=s.decode(c);return l.replace(o,(f,m,p,g,v)=>{if(v)return f;const y=a.exec(g);if(y){const b=y[1],E=y[2].toUpperCase(),A=y[3],M=y[4];if(E.length>3||E.length===3&&E>"XFD")return f;let L=s.l2n(E),k=parseInt(M,10);return b||(L+=h.col-d.col),A||(k+=h.row-d.row),(m||"")+(b||"")+s.n2l(L)+(A||"")+k}return f})}}},{"./col-cache":19}],24:[function(t,n,i){(function(s,o){(function(){const a=t("readable-stream"),l=t("./utils"),u=t("./string-buf");class c{constructor(g,v){this._data=g,this._encoding=v}get length(){return this.toBuffer().length}copy(g,v,y,b){return this.toBuffer().copy(g,v,y,b)}toBuffer(){return this._buffer||(this._buffer=o.from(this._data,this._encoding)),this._buffer}}class d{constructor(g){this._data=g}get length(){return this._data.length}copy(g,v,y,b){return this._data._buf.copy(g,v,y,b)}toBuffer(){return this._data.toBuffer()}}class h{constructor(g){this._data=g}get length(){return this._data.length}copy(g,v,y,b){this._data.copy(g,v,y,b)}toBuffer(){return this._data}}class f{constructor(g){this.size=g,this.buffer=o.alloc(g),this.iRead=0,this.iWrite=0}toBuffer(){if(this.iRead===0&&this.iWrite===this.size)return this.buffer;const g=o.alloc(this.iWrite-this.iRead);return this.buffer.copy(g,0,this.iRead,this.iWrite),g}get length(){return this.iWrite-this.iRead}get eod(){return this.iRead===this.iWrite}get full(){return this.iWrite===this.size}read(g){let v;return g===0?null:g===void 0||g>=this.length?(v=this.toBuffer(),this.iRead=this.iWrite,v):(v=o.alloc(g),this.buffer.copy(v,0,this.iRead,g),this.iRead+=g,v)}write(g,v,y){const b=Math.min(y,this.size-this.iWrite);return g.copy(this.buffer,this.iWrite,v,v+b),this.iWrite+=b,b}}const m=function(p){p=p||{},this.bufSize=p.bufSize||1048576,this.buffers=[],this.batch=p.batch||!1,this.corked=!1,this.inPos=0,this.outPos=0,this.pipes=[],this.paused=!1,this.encoding=null};l.inherits(m,a.Duplex,{toBuffer(){switch(this.buffers.length){case 0:return null;case 1:return this.buffers[0].toBuffer();default:return o.concat(this.buffers.map(p=>p.toBuffer()))}},_getWritableBuffer(){if(this.buffers.length){const g=this.buffers[this.buffers.length-1];if(!g.full)return g}const p=new f(this.bufSize);return this.buffers.push(p),p},async _pipe(p){await Promise.all(this.pipes.map((function(g){return new Promise(v=>{g.write(p.toBuffer(),()=>{v()})})})))},_writeToBuffers(p){let g=0;const v=p.length;for(;g<v;)g+=this._getWritableBuffer().write(p,g,v-g)},async write(p,g,v){let y;if(g instanceof Function&&(v=g,g="utf8"),v=v||l.nop,p instanceof u)y=new d(p);else if(p instanceof o)y=new h(p);else{if(!(typeof p=="string"||p instanceof String||p instanceof ArrayBuffer))throw new Error("Chunk must be one of type String, Buffer or StringBuf.");y=new c(p,g)}if(this.pipes.length)if(this.batch)for(this._writeToBuffers(y);!this.corked&&this.buffers.length>1;)this._pipe(this.buffers.shift());else this.corked?(this._writeToBuffers(y),s.nextTick(v)):(await this._pipe(y),v());else this.paused||this.emit("data",y.toBuffer()),this._writeToBuffers(y),this.emit("readable");return!0},cork(){this.corked=!0},_flush(){if(this.pipes.length)for(;this.buffers.length;)this._pipe(this.buffers.shift())},uncork(){this.corked=!1,this._flush()},end(p,g,v){const y=b=>{b?v(b):(this._flush(),this.pipes.forEach(E=>{E.end()}),this.emit("finish"))};p?this.write(p,g,y):y()},read(p){let g;if(p){for(g=[];p&&this.buffers.length&&!this.buffers[0].eod;){const v=this.buffers[0],y=v.read(p);p-=y.length,g.push(y),v.eod&&v.full&&this.buffers.shift()}return o.concat(g)}return g=this.buffers.map(v=>v.toBuffer()).filter(Boolean),this.buffers=[],o.concat(g)},setEncoding(p){this.encoding=p},pause(){this.paused=!0},resume(){this.paused=!1},isPaused(){return!!this.paused},pipe(p){this.pipes.push(p),!this.paused&&this.buffers.length&&this.end()},unpipe(p){this.pipes=this.pipes.filter(g=>g!==p)},unshift(){throw new Error("Not Implemented")},wrap(){throw new Error("Not Implemented")}}),n.exports=m}).call(this)}).call(this,t("_process"),t("buffer").Buffer)},{"./string-buf":25,"./utils":27,_process:467,buffer:220,"readable-stream":491}],25:[function(t,n,i){(function(s){(function(){n.exports=class{constructor(o){this._buf=s.alloc(o&&o.size||16384),this._encoding=o&&o.encoding||"utf8",this._inPos=0,this._buffer=void 0}get length(){return this._inPos}get capacity(){return this._buf.length}get buffer(){return this._buf}toBuffer(){return this._buffer||(this._buffer=s.alloc(this.length),this._buf.copy(this._buffer,0,0,this.length)),this._buffer}reset(o){o=o||0,this._buffer=void 0,this._inPos=o}_grow(o){let a=2*this._buf.length;for(;a<o;)a*=2;const l=s.alloc(a);this._buf.copy(l,0),this._buf=l}addText(o){this._buffer=void 0;let a=this._inPos+this._buf.write(o,this._inPos,this._encoding);for(;a>=this._buf.length-4;)this._grow(this._inPos+o.length),a=this._inPos+this._buf.write(o,this._inPos,this._encoding);this._inPos=a}addStringBuf(o){o.length&&(this._buffer=void 0,this.length+o.length>this.capacity&&this._grow(this.length+o.length),o._buf.copy(this._buf,this._inPos,0,o.length),this._inPos+=o.length)}}}).call(this)}).call(this,t("buffer").Buffer)},{buffer:220}],26:[function(t,n,i){const{toString:s}=Object.prototype,o=/["&<>]/,a={each:function(l,u){l&&(Array.isArray(l)?l.forEach(u):Object.keys(l).forEach(c=>{u(l[c],c)}))},some:function(l,u){return!!l&&(Array.isArray(l)?l.some(u):Object.keys(l).some(c=>u(l[c],c)))},every:function(l,u){return!l||(Array.isArray(l)?l.every(u):Object.keys(l).every(c=>u(l[c],c)))},map:function(l,u){return l?Array.isArray(l)?l.map(u):Object.keys(l).map(c=>u(l[c],c)):[]},keyBy:(l,u)=>l.reduce((c,d)=>(c[d[u]]=d,c),{}),isEqual:function(l,u){const c=typeof l,d=typeof u,h=Array.isArray(l),f=Array.isArray(u);let m;if(c!==d)return!1;switch(typeof l){case"object":if(h||f)return!(!h||!f)&&l.length===u.length&&l.every((p,g)=>{const v=u[g];return a.isEqual(p,v)});if(l===null||u===null)return l===u;if(m=Object.keys(l),Object.keys(u).length!==m.length)return!1;for(const p of m)if(!u.hasOwnProperty(p))return!1;return a.every(l,(p,g)=>{const v=u[g];return a.isEqual(p,v)});default:return l===u}},escapeHtml(l){const u=o.exec(l);if(!u)return l;let c="",d="",h=0,f=u.index;for(;f<l.length;f++){switch(l.charAt(f)){case'"':d="&quot;";break;case"&":d="&amp;";break;case"'":d="&apos;";break;case"<":d="&lt;";break;case">":d="&gt;";break;default:continue}h!==f&&(c+=l.substring(h,f)),h=f+1,c+=d}return h!==f?c+l.substring(h,f):c},strcmp:(l,u)=>l<u?-1:l>u?1:0,isUndefined:l=>s.call(l)==="[object Undefined]",isObject:l=>s.call(l)==="[object Object]",deepMerge(){const l=arguments[0]||{},{length:u}=arguments;let c,d,h;function f(m,p){c=l[p],h=Array.isArray(m),a.isObject(m)||h?(h?(h=!1,d=c&&Array.isArray(c)?c:[]):d=c&&a.isObject(c)?c:{},l[p]=a.deepMerge(d,m)):a.isUndefined(m)||(l[p]=m)}for(let m=0;m<u;m++)a.each(arguments[m],f);return l}};n.exports=a},{}],27:[function(t,n,i){(function(s,o){(function(){const a=t("fs"),l=/[<>&'"\x7F\x00-\x08\x0B-\x0C\x0E-\x1F]/,u={nop(){},promiseImmediate:c=>new Promise(d=>{s.setImmediate?o(()=>{d(c)}):setTimeout(()=>{d(c)},1)}),inherits:function(c,d,h,f){c.super_=d,f||(f=h,h=null),h&&Object.keys(h).forEach(p=>{Object.defineProperty(c,p,Object.getOwnPropertyDescriptor(h,p))});const m={constructor:{value:c,enumerable:!1,writable:!1,configurable:!0}};f&&Object.keys(f).forEach(p=>{m[p]=Object.getOwnPropertyDescriptor(f,p)}),c.prototype=Object.create(d.prototype,m)},dateToExcel:(c,d)=>25569+c.getTime()/864e5-(d?1462:0),excelToDate(c,d){const h=Math.round(24*(c-25569+(d?1462:0))*3600*1e3);return new Date(h)},parsePath(c){const d=c.lastIndexOf("/");return{path:c.substring(0,d),name:c.substring(d+1)}},getRelsPath(c){const d=u.parsePath(c);return`${d.path}/_rels/${d.name}.rels`},xmlEncode(c){const d=l.exec(c);if(!d)return c;let h="",f="",m=0,p=d.index;for(;p<c.length;p++){const g=c.charCodeAt(p);switch(g){case 34:f="&quot;";break;case 38:f="&amp;";break;case 39:f="&apos;";break;case 60:f="&lt;";break;case 62:f="&gt;";break;case 127:f="";break;default:if(g<=31&&(g<=8||g>=11&&g!==13)){f="";break}continue}m!==p&&(h+=c.substring(m,p)),m=p+1,f&&(h+=f)}return m!==p?h+c.substring(m,p):h},xmlDecode:c=>c.replace(/&([a-z]*);/g,d=>{switch(d){case"&lt;":return"<";case"&gt;":return">";case"&amp;":return"&";case"&apos;":return"'";case"&quot;":return'"';default:return d}}),validInt(c){const d=parseInt(c,10);return Number.isNaN(d)?0:d},isDateFmt(c){return c?(c=(c=c.replace(/\[[^\]]*]/g,"")).replace(/"[^"]*"/g,"")).match(/[ymdhMsb]+/)!==null:!1},fs:{exists:c=>new Promise(d=>{a.access(c,a.constants.F_OK,h=>{d(!h)})})},toIsoDateString:c=>c.toIsoString().subsstr(0,10),parseBoolean:c=>c===!0||c==="true"||c===1||c==="1"};n.exports=u}).call(this)}).call(this,typeof Wt<"u"?Wt:typeof self<"u"?self:typeof window<"u"?window:{},t("timers").setImmediate)},{fs:216,timers:523}],28:[function(t,n,i){const s=t("./under-dash"),o=t("./utils");function a(c,d,h){c.push(` ${d}="${o.xmlEncode(h.toString())}"`)}function l(c,d){if(d){const h=[];s.each(d,(f,m)=>{f!==void 0&&a(h,m,f)}),c.push(h.join(""))}}class u{constructor(){this._xml=[],this._stack=[],this._rollbacks=[]}get tos(){return this._stack.length?this._stack[this._stack.length-1]:void 0}get cursor(){return this._xml.length}openXml(d){const h=this._xml;h.push("<?xml"),l(h,d),h.push(`?>
`)}openNode(d,h){const f=this.tos,m=this._xml;f&&this.open&&m.push(">"),this._stack.push(d),m.push("<"),m.push(d),l(m,h),this.leaf=!0,this.open=!0}addAttribute(d,h){if(!this.open)throw new Error("Cannot write attributes to node if it is not open");h!==void 0&&a(this._xml,d,h)}addAttributes(d){if(!this.open)throw new Error("Cannot write attributes to node if it is not open");l(this._xml,d)}writeText(d){const h=this._xml;this.open&&(h.push(">"),this.open=!1),this.leaf=!1,h.push(o.xmlEncode(d.toString()))}writeXml(d){this.open&&(this._xml.push(">"),this.open=!1),this.leaf=!1,this._xml.push(d)}closeNode(){const d=this._stack.pop(),h=this._xml;this.leaf?h.push("/>"):(h.push("</"),h.push(d),h.push(">")),this.open=!1,this.leaf=!1}leafNode(d,h,f){this.openNode(d,h),f!==void 0&&this.writeText(f),this.closeNode()}closeAll(){for(;this._stack.length;)this.closeNode()}addRollback(){return this._rollbacks.push({xml:this._xml.length,stack:this._stack.length,leaf:this.leaf,open:this.open}),this.cursor}commit(){this._rollbacks.pop()}rollback(){const d=this._rollbacks.pop();this._xml.length>d.xml&&this._xml.splice(d.xml,this._xml.length-d.xml),this._stack.length>d.stack&&this._stack.splice(d.stack,this._stack.length-d.stack),this.leaf=d.leaf,this.open=d.open}get xml(){return this.closeAll(),this._xml.join("")}}u.StdDocAttributes={version:"1.0",encoding:"UTF-8",standalone:"yes"},n.exports=u},{"./under-dash":26,"./utils":27}],29:[function(t,n,i){(function(s){(function(){const o=t("events"),a=t("jszip"),l=t("./stream-buf"),{stringToBuffer:u}=t("./browser-buffer-encode");class c extends o.EventEmitter{constructor(h){super(),this.options=Object.assign({type:"nodebuffer",compression:"DEFLATE"},h),this.zip=new a,this.stream=new l}append(h,f){f.hasOwnProperty("base64")&&f.base64?this.zip.file(f.name,h,{base64:!0}):(s.browser&&typeof h=="string"&&(h=u(h)),this.zip.file(f.name,h))}async finalize(){const h=await this.zip.generateAsync(this.options);this.stream.end(h),this.emit("finish")}read(h){return this.stream.read(h)}setEncoding(h){return this.stream.setEncoding(h)}pause(){return this.stream.pause()}resume(){return this.stream.resume()}isPaused(){return this.stream.isPaused()}pipe(h,f){return this.stream.pipe(h,f)}unpipe(h){return this.stream.unpipe(h)}unshift(h){return this.stream.unshift(h)}wrap(h){return this.stream.wrap(h)}}n.exports={ZipWriter:c}}).call(this)}).call(this,t("_process"))},{"./browser-buffer-encode":17,"./stream-buf":24,_process:467,events:422,jszip:441}],30:[function(t,n,i){n.exports={0:{f:"General"},1:{f:"0"},2:{f:"0.00"},3:{f:"#,##0"},4:{f:"#,##0.00"},9:{f:"0%"},10:{f:"0.00%"},11:{f:"0.00E+00"},12:{f:"# ?/?"},13:{f:"# ??/??"},14:{f:"mm-dd-yy"},15:{f:"d-mmm-yy"},16:{f:"d-mmm"},17:{f:"mmm-yy"},18:{f:"h:mm AM/PM"},19:{f:"h:mm:ss AM/PM"},20:{f:"h:mm"},21:{f:"h:mm:ss"},22:{f:'m/d/yy "h":mm'},27:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},28:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},29:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},30:{"zh-tw":"m/d/yy ","zh-cn":"m-d-yy","ja-jp":"m/d/yy","ko-kr":"mm-dd-yy"},31:{"zh-tw":'yyyy""m""d""',"zh-cn":'yyyy""m""d""',"ja-jp":'yyyy""m""d""',"ko-kr":'yyyy"" mm"" dd""'},32:{"zh-tw":'hh""mm""',"zh-cn":'h""mm""',"ja-jp":'h""mm""',"ko-kr":'h"" mm""'},33:{"zh-tw":'hh""mm""ss""',"zh-cn":'h""mm""ss""',"ja-jp":'h""mm""ss""',"ko-kr":'h"" mm"" ss""'},34:{"zh-tw":'/ hh""mm""',"zh-cn":'/ h""mm""',"ja-jp":'yyyy""m""',"ko-kr":"yyyy-mm-dd"},35:{"zh-tw":'/ hh""mm""ss""',"zh-cn":'/ h""mm""ss""',"ja-jp":'m""d""',"ko-kr":"yyyy-mm-dd"},36:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},37:{f:"#,##0 ;(#,##0)"},38:{f:"#,##0 ;[Red](#,##0)"},39:{f:"#,##0.00 ;(#,##0.00)"},40:{f:"#,##0.00 ;[Red](#,##0.00)"},45:{f:"mm:ss"},46:{f:"[h]:mm:ss"},47:{f:"mmss.0"},48:{f:"##0.0E+0"},49:{f:"@"},50:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},51:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},52:{"zh-tw":'/ hh""mm""',"zh-cn":'yyyy""m""',"ja-jp":'yyyy""m""',"ko-kr":"yyyy-mm-dd"},53:{"zh-tw":'/ hh""mm""ss""',"zh-cn":'m""d""',"ja-jp":'m""d""',"ko-kr":"yyyy-mm-dd"},54:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},55:{"zh-tw":'/ hh""mm""',"zh-cn":'/ h""mm""',"ja-jp":'yyyy""m""',"ko-kr":"yyyy-mm-dd"},56:{"zh-tw":'/ hh""mm""ss""',"zh-cn":'/ h""mm""ss""',"ja-jp":'m""d""',"ko-kr":"yyyy-mm-dd"},57:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},58:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},59:{"th-th":"t0"},60:{"th-th":"t0.00"},61:{"th-th":"t#,##0"},62:{"th-th":"t#,##0.00"},67:{"th-th":"t0%"},68:{"th-th":"t0.00%"},69:{"th-th":"t# ?/?"},70:{"th-th":"t# ??/??"},81:{"th-th":"d/m/bb"}}},{}],31:[function(t,n,i){n.exports={OfficeDocument:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",Worksheet:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet",CalcChain:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/calcChain",SharedStrings:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",Styles:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",Theme:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",Hyperlink:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",Image:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",CoreProperties:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",ExtenderProperties:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",Comments:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",VmlDrawing:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",Table:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table"}},{}],32:[function(t,n,i){const s=t("../../utils/parse-sax"),o=t("../../utils/xml-stream");class a{prepare(){}render(){}parseOpen(u){}parseText(u){}parseClose(u){}reconcile(u,c){}reset(){this.model=null,this.map&&Object.values(this.map).forEach(u=>{u instanceof a?u.reset():u.xform&&u.xform.reset()})}mergeModel(u){this.model=Object.assign(this.model||{},u)}async parse(u){for await(const c of u)for(const{eventType:d,value:h}of c)if(d==="opentag")this.parseOpen(h);else if(d==="text")this.parseText(h);else if(d==="closetag"&&!this.parseClose(h.name))return this.model;return this.model}async parseStream(u){return this.parse(s(u))}get xml(){return this.toXml(this.model)}toXml(u){const c=new o;return this.render(c,u),c.xml}static toAttribute(u,c){let d=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(u===void 0){if(d)return c}else if(d||u!==c)return u.toString()}static toStringAttribute(u,c){let d=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return a.toAttribute(u,c,d)}static toStringValue(u,c){return u===void 0?c:u}static toBoolAttribute(u,c){let d=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(u===void 0){if(d)return c}else if(d||u!==c)return u?"1":"0"}static toBoolValue(u,c){return u===void 0?c:u==="1"}static toIntAttribute(u,c){let d=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return a.toAttribute(u,c,d)}static toIntValue(u,c){return u===void 0?c:parseInt(u,10)}static toFloatAttribute(u,c){let d=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return a.toAttribute(u,c,d)}static toFloatValue(u,c){return u===void 0?c:parseFloat(u)}}n.exports=a},{"../../utils/parse-sax":22,"../../utils/xml-stream":28}],33:[function(t,n,i){const s=t("../base-xform"),o=t("../../../utils/col-cache");function a(u){try{return o.decodeEx(u),!0}catch{return!1}}function l(u){const c=[];let d=!1,h="";return u.split(",").forEach(f=>{if(!f)return;const m=(f.match(/'/g)||[]).length;if(!m)return void(d?h+=f+",":a(f)&&c.push(f));const p=m%2==0;!d&&p&&a(f)?c.push(f):d&&!p?(d=!1,a(h+f)&&c.push(h+f),h=""):(d=!0,h+=f+",")}),c}n.exports=class extends s{render(u,c){u.openNode("definedName",{name:c.name,localSheetId:c.localSheetId}),u.writeText(c.ranges.join(",")),u.closeNode()}parseOpen(u){return u.name==="definedName"?(this._parsedName=u.attributes.name,this._parsedLocalSheetId=u.attributes.localSheetId,this._parsedText=[],!0):!1}parseText(u){this._parsedText.push(u)}parseClose(){return this.model={name:this._parsedName,ranges:l(this._parsedText.join(""))},this._parsedLocalSheetId!==void 0&&(this.model.localSheetId=parseInt(this._parsedLocalSheetId,10)),!1}}},{"../../../utils/col-cache":19,"../base-xform":32}],34:[function(t,n,i){const s=t("../../../utils/utils"),o=t("../base-xform");n.exports=class extends o{render(a,l){a.leafNode("sheet",{sheetId:l.id,name:l.name,state:l.state,"r:id":l.rId})}parseOpen(a){return a.name==="sheet"&&(this.model={name:s.xmlDecode(a.attributes.name),id:parseInt(a.attributes.sheetId,10),state:a.attributes.state,rId:a.attributes["r:id"]},!0)}parseText(){}parseClose(){return!1}}},{"../../../utils/utils":27,"../base-xform":32}],35:[function(t,n,i){const s=t("../base-xform");n.exports=class extends s{render(o,a){o.leafNode("calcPr",{calcId:171027,fullCalcOnLoad:a.fullCalcOnLoad?1:void 0})}parseOpen(o){return o.name==="calcPr"&&(this.model={},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],36:[function(t,n,i){const s=t("../base-xform");n.exports=class extends s{render(o,a){o.leafNode("workbookPr",{date1904:a.date1904?1:void 0,defaultThemeVersion:164011,filterPrivacy:1})}parseOpen(o){return o.name==="workbookPr"&&(this.model={date1904:o.attributes.date1904==="1"},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],37:[function(t,n,i){const s=t("../base-xform");n.exports=class extends s{render(o,a){const l={xWindow:a.x||0,yWindow:a.y||0,windowWidth:a.width||12e3,windowHeight:a.height||24e3,firstSheet:a.firstSheet,activeTab:a.activeTab};a.visibility&&a.visibility!=="visible"&&(l.visibility=a.visibility),o.leafNode("workbookView",l)}parseOpen(o){if(o.name==="workbookView"){const a=this.model={},l=function(c,d,h){const f=d!==void 0?a[c]=d:h;f!==void 0&&(a[c]=f)},u=function(c,d,h){const f=d!==void 0?a[c]=parseInt(d,10):h;f!==void 0&&(a[c]=f)};return u("x",o.attributes.xWindow,0),u("y",o.attributes.yWindow,0),u("width",o.attributes.windowWidth,25e3),u("height",o.attributes.windowHeight,1e4),l("visibility",o.attributes.visibility,"visible"),u("activeTab",o.attributes.activeTab,void 0),u("firstSheet",o.attributes.firstSheet,void 0),!0}return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],38:[function(t,n,i){const s=t("../../../utils/under-dash"),o=t("../../../utils/col-cache"),a=t("../../../utils/xml-stream"),l=t("../base-xform"),u=t("../static-xform"),c=t("../list-xform"),d=t("./defined-name-xform"),h=t("./sheet-xform"),f=t("./workbook-view-xform"),m=t("./workbook-properties-xform"),p=t("./workbook-calc-properties-xform");class g extends l{constructor(){super(),this.map={fileVersion:g.STATIC_XFORMS.fileVersion,workbookPr:new m,bookViews:new c({tag:"bookViews",count:!1,childXform:new f}),sheets:new c({tag:"sheets",count:!1,childXform:new h}),definedNames:new c({tag:"definedNames",count:!1,childXform:new d}),calcPr:new p}}prepare(y){y.sheets=y.worksheets;const b=[];let E=0;y.sheets.forEach(A=>{if(A.pageSetup&&A.pageSetup.printArea&&A.pageSetup.printArea.split("&&").forEach(M=>{const L=M.split(":"),k={name:"_xlnm.Print_Area",ranges:[`'${A.name}'!$${L[0]}:$${L[1]}`],localSheetId:E};b.push(k)}),A.pageSetup&&(A.pageSetup.printTitlesRow||A.pageSetup.printTitlesColumn)){const M=[];if(A.pageSetup.printTitlesColumn){const k=A.pageSetup.printTitlesColumn.split(":");M.push(`'${A.name}'!$${k[0]}:$${k[1]}`)}if(A.pageSetup.printTitlesRow){const k=A.pageSetup.printTitlesRow.split(":");M.push(`'${A.name}'!$${k[0]}:$${k[1]}`)}const L={name:"_xlnm.Print_Titles",ranges:M,localSheetId:E};b.push(L)}E++}),b.length&&(y.definedNames=y.definedNames.concat(b)),(y.media||[]).forEach((A,M)=>{A.name=A.type+(M+1)})}render(y,b){y.openXml(a.StdDocAttributes),y.openNode("workbook",g.WORKBOOK_ATTRIBUTES),this.map.fileVersion.render(y),this.map.workbookPr.render(y,b.properties),this.map.bookViews.render(y,b.views),this.map.sheets.render(y,b.sheets),this.map.definedNames.render(y,b.definedNames),this.map.calcPr.render(y,b.calcProperties),y.closeNode()}parseOpen(y){return this.parser?(this.parser.parseOpen(y),!0):(y.name==="workbook"||(this.parser=this.map[y.name],this.parser&&this.parser.parseOpen(y)),!0)}parseText(y){this.parser&&this.parser.parseText(y)}parseClose(y){return this.parser?(this.parser.parseClose(y)||(this.parser=void 0),!0):y==="workbook"?(this.model={sheets:this.map.sheets.model,properties:this.map.workbookPr.model||{},views:this.map.bookViews.model,calcProperties:{}},this.map.definedNames.model&&(this.model.definedNames=this.map.definedNames.model),!1):!0}reconcile(y){const b=(y.workbookRels||[]).reduce((k,P)=>(k[P.Id]=P,k),{}),E=[];let A,M=0;(y.sheets||[]).forEach(k=>{const P=b[k.rId];P&&(A=y.worksheetHash["xl/"+P.Target.replace(/^(\s|\/xl\/)+/,"")],A&&(A.name=k.name,A.id=k.id,A.state=k.state,E[M++]=A))});const L=[];s.each(y.definedNames,k=>{if(k.name==="_xlnm.Print_Area"){if(A=E[k.localSheetId],A){A.pageSetup||(A.pageSetup={});const P=o.decodeEx(k.ranges[0]);A.pageSetup.printArea=A.pageSetup.printArea?`${A.pageSetup.printArea}&&${P.dimensions}`:P.dimensions}}else if(k.name==="_xlnm.Print_Titles"){if(A=E[k.localSheetId],A){A.pageSetup||(A.pageSetup={});const P=k.ranges.join(","),U=/\$/g,$=/\$\d+:\$\d+/,V=P.match($);if(V&&V.length){const T=V[0];A.pageSetup.printTitlesRow=T.replace(U,"")}const R=/\$[A-Z]+:\$[A-Z]+/,O=P.match(R);if(O&&O.length){const T=O[0];A.pageSetup.printTitlesColumn=T.replace(U,"")}}}else L.push(k)}),y.definedNames=L,y.media.forEach((k,P)=>{k.index=P})}}g.WORKBOOK_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x15","xmlns:x15":"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main"},g.STATIC_XFORMS={fileVersion:new u({tag:"fileVersion",$:{appName:"xl",lastEdited:5,lowestEdited:5,rupBuild:9303}})},n.exports=g},{"../../../utils/col-cache":19,"../../../utils/under-dash":26,"../../../utils/xml-stream":28,"../base-xform":32,"../list-xform":71,"../static-xform":120,"./defined-name-xform":33,"./sheet-xform":34,"./workbook-calc-properties-xform":35,"./workbook-properties-xform":36,"./workbook-view-xform":37}],39:[function(t,n,i){const s=t("../strings/rich-text-xform"),o=t("../../../utils/utils"),a=t("../base-xform"),l=n.exports=function(u){this.model=u};o.inherits(l,a,{get tag(){return"r"},get richTextXform(){return this._richTextXform||(this._richTextXform=new s),this._richTextXform},render(u,c){c=c||this.model,u.openNode("comment",{ref:c.ref,authorId:0}),u.openNode("text"),c&&c.note&&c.note.texts&&c.note.texts.forEach(d=>{this.richTextXform.render(u,d)}),u.closeNode(),u.closeNode()},parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case"comment":return this.model={type:"note",note:{texts:[]},...u.attributes},!0;case"r":return this.parser=this.richTextXform,this.parser.parseOpen(u),!0;default:return!1}},parseText(u){this.parser&&this.parser.parseText(u)},parseClose(u){switch(u){case"comment":return!1;case"r":return this.model.note.texts.push(this.parser.model),this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(u),!0}}})},{"../../../utils/utils":27,"../base-xform":32,"../strings/rich-text-xform":122}],40:[function(t,n,i){const s=t("../../../utils/xml-stream"),o=t("../../../utils/utils"),a=t("../base-xform"),l=t("./comment-xform"),u=n.exports=function(){this.map={comment:new l}};o.inherits(u,a,{COMMENTS_ATTRIBUTES:{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main"}},{render(c,d){d=d||this.model,c.openXml(s.StdDocAttributes),c.openNode("comments",u.COMMENTS_ATTRIBUTES),c.openNode("authors"),c.leafNode("author",null,"Author"),c.closeNode(),c.openNode("commentList"),d.comments.forEach(h=>{this.map.comment.render(c,h)}),c.closeNode(),c.closeNode()},parseOpen(c){if(this.parser)return this.parser.parseOpen(c),!0;switch(c.name){case"commentList":return this.model={comments:[]},!0;case"comment":return this.parser=this.map.comment,this.parser.parseOpen(c),!0;default:return!1}},parseText(c){this.parser&&this.parser.parseText(c)},parseClose(c){switch(c){case"commentList":return!1;case"comment":return this.model.comments.push(this.parser.model),this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(c),!0}}})},{"../../../utils/utils":27,"../../../utils/xml-stream":28,"../base-xform":32,"./comment-xform":39}],41:[function(t,n,i){const s=t("../../base-xform");n.exports=class extends s{constructor(o){super(),this._model=o}get tag(){return this._model&&this._model.tag}render(o,a,l){(a===l[2]||this.tag==="x:SizeWithCells"&&a===l[1])&&o.leafNode(this.tag)}parseOpen(o){return o.name===this.tag?(this.model={},this.model[this.tag]=!0,!0):!1}parseText(){}parseClose(){return!1}}},{"../../base-xform":32}],42:[function(t,n,i){const s=t("../../base-xform");n.exports=class extends s{constructor(o){super(),this._model=o}get tag(){return this._model&&this._model.tag}render(o,a){o.leafNode(this.tag,null,a)}parseOpen(o){return o.name===this.tag?(this.text="",!0):!1}parseText(o){this.text=o}parseClose(){return!1}}},{"../../base-xform":32}],43:[function(t,n,i){const s=t("../base-xform");n.exports=class extends s{get tag(){return"x:Anchor"}getAnchorRect(o){const a=Math.floor(o.left),l=Math.floor(68*(o.left-a)),u=Math.floor(o.top),c=Math.floor(18*(o.top-u)),d=Math.floor(o.right),h=Math.floor(68*(o.right-d)),f=Math.floor(o.bottom);return[a,l,u,c,d,h,f,Math.floor(18*(o.bottom-f))]}getDefaultRect(o){const a=o.col,l=Math.max(o.row-2,0);return[a,6,l,14,a+2,2,l+4,16]}render(o,a){const l=a.anchor?this.getAnchorRect(a.anchor):this.getDefaultRect(a.refAddress);o.leafNode("x:Anchor",null,l.join(", "))}parseOpen(o){return o.name===this.tag?(this.text="",!0):!1}parseText(o){this.text=o}parseClose(){return!1}}},{"../base-xform":32}],44:[function(t,n,i){const s=t("../base-xform"),o=t("./vml-anchor-xform"),a=t("./style/vml-protection-xform"),l=t("./style/vml-position-xform"),u=["twoCells","oneCells","absolute"];n.exports=class extends s{constructor(){super(),this.map={"x:Anchor":new o,"x:Locked":new a({tag:"x:Locked"}),"x:LockText":new a({tag:"x:LockText"}),"x:SizeWithCells":new l({tag:"x:SizeWithCells"}),"x:MoveWithCells":new l({tag:"x:MoveWithCells"})}}get tag(){return"x:ClientData"}render(c,d){const{protection:h,editAs:f}=d.note;c.openNode(this.tag,{ObjectType:"Note"}),this.map["x:MoveWithCells"].render(c,f,u),this.map["x:SizeWithCells"].render(c,f,u),this.map["x:Anchor"].render(c,d),this.map["x:Locked"].render(c,h.locked),c.leafNode("x:AutoFill",null,"False"),this.map["x:LockText"].render(c,h.lockText),c.leafNode("x:Row",null,d.refAddress.row-1),c.leafNode("x:Column",null,d.refAddress.col-1),c.closeNode()}parseOpen(c){return c.name===this.tag?(this.reset(),this.model={anchor:[],protection:{},editAs:""}):(this.parser=this.map[c.name],this.parser&&this.parser.parseOpen(c)),!0}parseText(c){this.parser&&this.parser.parseText(c)}parseClose(c){return this.parser?(this.parser.parseClose(c)||(this.parser=void 0),!0):c===this.tag?(this.normalizeModel(),!1):!0}normalizeModel(){const c=Object.assign({},this.map["x:MoveWithCells"].model,this.map["x:SizeWithCells"].model),d=Object.keys(c).length;this.model.editAs=u[d],this.model.anchor=this.map["x:Anchor"].text,this.model.protection.locked=this.map["x:Locked"].text,this.model.protection.lockText=this.map["x:LockText"].text}}},{"../base-xform":32,"./style/vml-position-xform":41,"./style/vml-protection-xform":42,"./vml-anchor-xform":43}],45:[function(t,n,i){const s=t("../../../utils/xml-stream"),o=t("../base-xform"),a=t("./vml-shape-xform");class l extends o{constructor(){super(),this.map={"v:shape":new a}}get tag(){return"xml"}render(c,d){c.openXml(s.StdDocAttributes),c.openNode(this.tag,l.DRAWING_ATTRIBUTES),c.openNode("o:shapelayout",{"v:ext":"edit"}),c.leafNode("o:idmap",{"v:ext":"edit",data:1}),c.closeNode(),c.openNode("v:shapetype",{id:"_x0000_t202",coordsize:"21600,21600","o:spt":202,path:"m,l,21600r21600,l21600,xe"}),c.leafNode("v:stroke",{joinstyle:"miter"}),c.leafNode("v:path",{gradientshapeok:"t","o:connecttype":"rect"}),c.closeNode(),d.comments.forEach((h,f)=>{this.map["v:shape"].render(c,h,f)}),c.closeNode()}parseOpen(c){return this.parser?(this.parser.parseOpen(c),!0):(c.name===this.tag?(this.reset(),this.model={comments:[]}):(this.parser=this.map[c.name],this.parser&&this.parser.parseOpen(c)),!0)}parseText(c){this.parser&&this.parser.parseText(c)}parseClose(c){return this.parser?(this.parser.parseClose(c)||(this.model.comments.push(this.parser.model),this.parser=void 0),!0):c!==this.tag}reconcile(c,d){c.anchors.forEach(h=>{h.br?this.map["xdr:twoCellAnchor"].reconcile(h,d):this.map["xdr:oneCellAnchor"].reconcile(h,d)})}}l.DRAWING_ATTRIBUTES={"xmlns:v":"urn:schemas-microsoft-com:vml","xmlns:o":"urn:schemas-microsoft-com:office:office","xmlns:x":"urn:schemas-microsoft-com:office:excel"},n.exports=l},{"../../../utils/xml-stream":28,"../base-xform":32,"./vml-shape-xform":46}],46:[function(t,n,i){const s=t("../base-xform"),o=t("./vml-textbox-xform"),a=t("./vml-client-data-xform");class l extends s{constructor(){super(),this.map={"v:textbox":new o,"x:ClientData":new a}}get tag(){return"v:shape"}render(c,d,h){c.openNode("v:shape",l.V_SHAPE_ATTRIBUTES(d,h)),c.leafNode("v:fill",{color2:"infoBackground [80]"}),c.leafNode("v:shadow",{color:"none [81]",obscured:"t"}),c.leafNode("v:path",{"o:connecttype":"none"}),this.map["v:textbox"].render(c,d),this.map["x:ClientData"].render(c,d),c.closeNode()}parseOpen(c){return this.parser?(this.parser.parseOpen(c),!0):(c.name===this.tag?(this.reset(),this.model={margins:{insetmode:c.attributes["o:insetmode"]},anchor:"",editAs:"",protection:{}}):(this.parser=this.map[c.name],this.parser&&this.parser.parseOpen(c)),!0)}parseText(c){this.parser&&this.parser.parseText(c)}parseClose(c){return this.parser?(this.parser.parseClose(c)||(this.parser=void 0),!0):c===this.tag?(this.model.margins.inset=this.map["v:textbox"].model&&this.map["v:textbox"].model.inset,this.model.protection=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.protection,this.model.anchor=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.anchor,this.model.editAs=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.editAs,!1):!0}}l.V_SHAPE_ATTRIBUTES=(u,c)=>({id:"_x0000_s"+(1025+c),type:"#_x0000_t202",style:"position:absolute; margin-left:105.3pt;margin-top:10.5pt;width:97.8pt;height:59.1pt;z-index:1;visibility:hidden",fillcolor:"infoBackground [80]",strokecolor:"none [81]","o:insetmode":u.note.margins&&u.note.margins.insetmode}),n.exports=l},{"../base-xform":32,"./vml-client-data-xform":44,"./vml-textbox-xform":47}],47:[function(t,n,i){const s=t("../base-xform");n.exports=class extends s{get tag(){return"v:textbox"}conversionUnit(o,a,l){return`${parseFloat(o)*a.toFixed(2)}${l}`}reverseConversionUnit(o){return(o||"").split(",").map(a=>Number(parseFloat(this.conversionUnit(parseFloat(a),.1,"")).toFixed(2)))}render(o,a){const l={style:"mso-direction-alt:auto"};if(a&&a.note){let{inset:u}=a.note&&a.note.margins;Array.isArray(u)&&(u=u.map(c=>this.conversionUnit(c,10,"mm")).join(",")),u&&(l.inset=u)}o.openNode("v:textbox",l),o.leafNode("div",{style:"text-align:left"}),o.closeNode()}parseOpen(o){return o.name===this.tag&&(this.model={inset:this.reverseConversionUnit(o.attributes.inset)}),!0}parseText(){}parseClose(o){return o!==this.tag}}},{"../base-xform":32}],48:[function(t,n,i){const s=t("./base-xform");n.exports=class extends s{createNewModel(o){return{}}parseOpen(o){return this.parser=this.parser||this.map[o.name],this.parser?(this.parser.parseOpen(o),!0):o.name===this.tag&&(this.model=this.createNewModel(o),!0)}parseText(o){this.parser&&this.parser.parseText(o)}onParserClose(o,a){this.model[o]=a.model}parseClose(o){return this.parser?(this.parser.parseClose(o)||(this.onParserClose(o,this.parser),this.parser=void 0),!0):o!==this.tag}}},{"./base-xform":32}],49:[function(t,n,i){const s=t("../base-xform");n.exports=class extends s{render(o,a){o.openNode("HeadingPairs"),o.openNode("vt:vector",{size:2,baseType:"variant"}),o.openNode("vt:variant"),o.leafNode("vt:lpstr",void 0,"Worksheets"),o.closeNode(),o.openNode("vt:variant"),o.leafNode("vt:i4",void 0,a.length),o.closeNode(),o.closeNode(),o.closeNode()}parseOpen(o){return o.name==="HeadingPairs"}parseText(){}parseClose(o){return o!=="HeadingPairs"}}},{"../base-xform":32}],50:[function(t,n,i){const s=t("../base-xform");n.exports=class extends s{render(o,a){o.openNode("TitlesOfParts"),o.openNode("vt:vector",{size:a.length,baseType:"lpstr"}),a.forEach(l=>{o.leafNode("vt:lpstr",void 0,l.name)}),o.closeNode(),o.closeNode()}parseOpen(o){return o.name==="TitlesOfParts"}parseText(){}parseClose(o){return o!=="TitlesOfParts"}}},{"../base-xform":32}],51:[function(t,n,i){const s=t("../../../utils/xml-stream"),o=t("../base-xform"),a=t("../simple/string-xform"),l=t("./app-heading-pairs-xform"),u=t("./app-titles-of-parts-xform");class c extends o{constructor(){super(),this.map={Company:new a({tag:"Company"}),Manager:new a({tag:"Manager"}),HeadingPairs:new l,TitleOfParts:new u}}render(h,f){h.openXml(s.StdDocAttributes),h.openNode("Properties",c.PROPERTY_ATTRIBUTES),h.leafNode("Application",void 0,"Microsoft Excel"),h.leafNode("DocSecurity",void 0,"0"),h.leafNode("ScaleCrop",void 0,"false"),this.map.HeadingPairs.render(h,f.worksheets),this.map.TitleOfParts.render(h,f.worksheets),this.map.Company.render(h,f.company||""),this.map.Manager.render(h,f.manager),h.leafNode("LinksUpToDate",void 0,"false"),h.leafNode("SharedDoc",void 0,"false"),h.leafNode("HyperlinksChanged",void 0,"false"),h.leafNode("AppVersion",void 0,"16.0300"),h.closeNode()}parseOpen(h){return this.parser?(this.parser.parseOpen(h),!0):h.name==="Properties"?!0:(this.parser=this.map[h.name],!!this.parser&&(this.parser.parseOpen(h),!0))}parseText(h){this.parser&&this.parser.parseText(h)}parseClose(h){return this.parser?(this.parser.parseClose(h)||(this.parser=void 0),!0):h==="Properties"?(this.model={worksheets:this.map.TitleOfParts.model,company:this.map.Company.model,manager:this.map.Manager.model},!1):!0}}c.DateFormat=function(d){return d.toISOString().replace(/[.]\d{3,6}/,"")},c.DateAttrs={"xsi:type":"dcterms:W3CDTF"},c.PROPERTY_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties","xmlns:vt":"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"},n.exports=c},{"../../../utils/xml-stream":28,"../base-xform":32,"../simple/string-xform":119,"./app-heading-pairs-xform":49,"./app-titles-of-parts-xform":50}],52:[function(t,n,i){const s=t("../../../utils/xml-stream"),o=t("../base-xform");class a extends o{render(u,c){u.openXml(s.StdDocAttributes),u.openNode("Types",a.PROPERTY_ATTRIBUTES);const d={};(c.media||[]).forEach(h=>{if(h.type==="image"){const f=h.extension;d[f]||(d[f]=!0,u.leafNode("Default",{Extension:f,ContentType:"image/"+f}))}}),u.leafNode("Default",{Extension:"rels",ContentType:"application/vnd.openxmlformats-package.relationships+xml"}),u.leafNode("Default",{Extension:"xml",ContentType:"application/xml"}),u.leafNode("Override",{PartName:"/xl/workbook.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"}),c.worksheets.forEach(h=>{const f=`/xl/worksheets/sheet${h.id}.xml`;u.leafNode("Override",{PartName:f,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"})}),u.leafNode("Override",{PartName:"/xl/theme/theme1.xml",ContentType:"application/vnd.openxmlformats-officedocument.theme+xml"}),u.leafNode("Override",{PartName:"/xl/styles.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"}),c.sharedStrings&&c.sharedStrings.count&&u.leafNode("Override",{PartName:"/xl/sharedStrings.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"}),c.tables&&c.tables.forEach(h=>{u.leafNode("Override",{PartName:"/xl/tables/"+h.target,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml"})}),c.drawings&&c.drawings.forEach(h=>{u.leafNode("Override",{PartName:`/xl/drawings/${h.name}.xml`,ContentType:"application/vnd.openxmlformats-officedocument.drawing+xml"})}),c.commentRefs&&(u.leafNode("Default",{Extension:"vml",ContentType:"application/vnd.openxmlformats-officedocument.vmlDrawing"}),c.commentRefs.forEach(h=>{let{commentName:f}=h;u.leafNode("Override",{PartName:`/xl/${f}.xml`,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml"})})),u.leafNode("Override",{PartName:"/docProps/core.xml",ContentType:"application/vnd.openxmlformats-package.core-properties+xml"}),u.leafNode("Override",{PartName:"/docProps/app.xml",ContentType:"application/vnd.openxmlformats-officedocument.extended-properties+xml"}),u.closeNode()}parseOpen(){return!1}parseText(){}parseClose(){return!1}}a.PROPERTY_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/package/2006/content-types"},n.exports=a},{"../../../utils/xml-stream":28,"../base-xform":32}],53:[function(t,n,i){const s=t("../../../utils/xml-stream"),o=t("../base-xform"),a=t("../simple/date-xform"),l=t("../simple/string-xform"),u=t("../simple/integer-xform");class c extends o{constructor(){super(),this.map={"dc:creator":new l({tag:"dc:creator"}),"dc:title":new l({tag:"dc:title"}),"dc:subject":new l({tag:"dc:subject"}),"dc:description":new l({tag:"dc:description"}),"dc:identifier":new l({tag:"dc:identifier"}),"dc:language":new l({tag:"dc:language"}),"cp:keywords":new l({tag:"cp:keywords"}),"cp:category":new l({tag:"cp:category"}),"cp:lastModifiedBy":new l({tag:"cp:lastModifiedBy"}),"cp:lastPrinted":new a({tag:"cp:lastPrinted",format:c.DateFormat}),"cp:revision":new u({tag:"cp:revision"}),"cp:version":new l({tag:"cp:version"}),"cp:contentStatus":new l({tag:"cp:contentStatus"}),"cp:contentType":new l({tag:"cp:contentType"}),"dcterms:created":new a({tag:"dcterms:created",attrs:c.DateAttrs,format:c.DateFormat}),"dcterms:modified":new a({tag:"dcterms:modified",attrs:c.DateAttrs,format:c.DateFormat})}}render(h,f){h.openXml(s.StdDocAttributes),h.openNode("cp:coreProperties",c.CORE_PROPERTY_ATTRIBUTES),this.map["dc:creator"].render(h,f.creator),this.map["dc:title"].render(h,f.title),this.map["dc:subject"].render(h,f.subject),this.map["dc:description"].render(h,f.description),this.map["dc:identifier"].render(h,f.identifier),this.map["dc:language"].render(h,f.language),this.map["cp:keywords"].render(h,f.keywords),this.map["cp:category"].render(h,f.category),this.map["cp:lastModifiedBy"].render(h,f.lastModifiedBy),this.map["cp:lastPrinted"].render(h,f.lastPrinted),this.map["cp:revision"].render(h,f.revision),this.map["cp:version"].render(h,f.version),this.map["cp:contentStatus"].render(h,f.contentStatus),this.map["cp:contentType"].render(h,f.contentType),this.map["dcterms:created"].render(h,f.created),this.map["dcterms:modified"].render(h,f.modified),h.closeNode()}parseOpen(h){if(this.parser)return this.parser.parseOpen(h),!0;switch(h.name){case"cp:coreProperties":case"coreProperties":return!0;default:if(this.parser=this.map[h.name],this.parser)return this.parser.parseOpen(h),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(h))}}parseText(h){this.parser&&this.parser.parseText(h)}parseClose(h){if(this.parser)return this.parser.parseClose(h)||(this.parser=void 0),!0;switch(h){case"cp:coreProperties":case"coreProperties":return this.model={creator:this.map["dc:creator"].model,title:this.map["dc:title"].model,subject:this.map["dc:subject"].model,description:this.map["dc:description"].model,identifier:this.map["dc:identifier"].model,language:this.map["dc:language"].model,keywords:this.map["cp:keywords"].model,category:this.map["cp:category"].model,lastModifiedBy:this.map["cp:lastModifiedBy"].model,lastPrinted:this.map["cp:lastPrinted"].model,revision:this.map["cp:revision"].model,contentStatus:this.map["cp:contentStatus"].model,contentType:this.map["cp:contentType"].model,created:this.map["dcterms:created"].model,modified:this.map["dcterms:modified"].model},!1;default:throw new Error("Unexpected xml node in parseClose: "+h)}}}c.DateFormat=function(d){return d.toISOString().replace(/[.]\d{3}/,"")},c.DateAttrs={"xsi:type":"dcterms:W3CDTF"},c.CORE_PROPERTY_ATTRIBUTES={"xmlns:cp":"http://schemas.openxmlformats.org/package/2006/metadata/core-properties","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:dcterms":"http://purl.org/dc/terms/","xmlns:dcmitype":"http://purl.org/dc/dcmitype/","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance"},n.exports=c},{"../../../utils/xml-stream":28,"../base-xform":32,"../simple/date-xform":117,"../simple/integer-xform":118,"../simple/string-xform":119}],54:[function(t,n,i){const s=t("../base-xform");n.exports=class extends s{render(o,a){o.leafNode("Relationship",a)}parseOpen(o){return o.name==="Relationship"?(this.model=o.attributes,!0):!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],55:[function(t,n,i){const s=t("../../../utils/xml-stream"),o=t("../base-xform"),a=t("./relationship-xform");class l extends o{constructor(){super(),this.map={Relationship:new a}}render(c,d){d=d||this._values,c.openXml(s.StdDocAttributes),c.openNode("Relationships",l.RELATIONSHIPS_ATTRIBUTES),d.forEach(h=>{this.map.Relationship.render(c,h)}),c.closeNode()}parseOpen(c){if(this.parser)return this.parser.parseOpen(c),!0;switch(c.name){case"Relationships":return this.model=[],!0;default:if(this.parser=this.map[c.name],this.parser)return this.parser.parseOpen(c),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(c))}}parseText(c){this.parser&&this.parser.parseText(c)}parseClose(c){if(this.parser)return this.parser.parseClose(c)||(this.model.push(this.parser.model),this.parser=void 0),!0;if(c==="Relationships")return!1;throw new Error("Unexpected xml node in parseClose: "+c)}}l.RELATIONSHIPS_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"},n.exports=l},{"../../../utils/xml-stream":28,"../base-xform":32,"./relationship-xform":54}],56:[function(t,n,i){const s=t("../base-xform");n.exports=class extends s{parseOpen(o){return this.parser?(this.parser.parseOpen(o),!0):(o.name===this.tag?(this.reset(),this.model={range:{editAs:o.attributes.editAs||"oneCell"}}):(this.parser=this.map[o.name],this.parser&&this.parser.parseOpen(o)),!0)}parseText(o){this.parser&&this.parser.parseText(o)}reconcilePicture(o,a){if(o&&o.rId){const l=a.rels[o.rId].Target.match(/.*\/media\/(.+[.][a-zA-Z]{3,4})/);if(l){const u=l[1],c=a.mediaIndex[u];return a.media[c]}}}}},{"../base-xform":32}],57:[function(t,n,i){const s=t("../base-xform"),o=t("./blip-xform");n.exports=class extends s{constructor(){super(),this.map={"a:blip":new o}}get tag(){return"xdr:blipFill"}render(a,l){a.openNode(this.tag),this.map["a:blip"].render(a,l),a.openNode("a:stretch"),a.leafNode("a:fillRect"),a.closeNode(),a.closeNode()}parseOpen(a){return this.parser?(this.parser.parseOpen(a),!0):(a.name===this.tag?this.reset():(this.parser=this.map[a.name],this.parser&&this.parser.parseOpen(a)),!0)}parseText(){}parseClose(a){return this.parser?(this.parser.parseClose(a)||(this.parser=void 0),!0):a===this.tag?(this.model=this.map["a:blip"].model,!1):!0}}},{"../base-xform":32,"./blip-xform":58}],58:[function(t,n,i){const s=t("../base-xform");n.exports=class extends s{get tag(){return"a:blip"}render(o,a){o.leafNode(this.tag,{"xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","r:embed":a.rId,cstate:"print"})}parseOpen(o){return o.name===this.tag&&(this.model={rId:o.attributes["r:embed"]}),!0}parseText(){}parseClose(o){return o!==this.tag}}},{"../base-xform":32}],59:[function(t,n,i){const s=t("../base-xform");n.exports=class extends s{get tag(){return"xdr:cNvPicPr"}render(o){o.openNode(this.tag),o.leafNode("a:picLocks",{noChangeAspect:"1"}),o.closeNode()}parseOpen(o){switch(o.name){case this.tag:default:return!0}}parseText(){}parseClose(o){return o!==this.tag}}},{"../base-xform":32}],60:[function(t,n,i){const s=t("../base-xform"),o=t("./hlink-click-xform"),a=t("./ext-lst-xform");n.exports=class extends s{constructor(){super(),this.map={"a:hlinkClick":new o,"a:extLst":new a}}get tag(){return"xdr:cNvPr"}render(l,u){l.openNode(this.tag,{id:u.index,name:"Picture "+u.index}),this.map["a:hlinkClick"].render(l,u),this.map["a:extLst"].render(l,u),l.closeNode()}parseOpen(l){return this.parser?(this.parser.parseOpen(l),!0):(l.name===this.tag?this.reset():(this.parser=this.map[l.name],this.parser&&this.parser.parseOpen(l)),!0)}parseText(){}parseClose(l){return this.parser?(this.parser.parseClose(l)||(this.parser=void 0),!0):l===this.tag?(this.model=this.map["a:hlinkClick"].model,!1):!0}}},{"../base-xform":32,"./ext-lst-xform":63,"./hlink-click-xform":65}],61:[function(t,n,i){const s=t("../base-xform"),o=t("../simple/integer-xform");n.exports=class extends s{constructor(a){super(),this.tag=a.tag,this.map={"xdr:col":new o({tag:"xdr:col",zero:!0}),"xdr:colOff":new o({tag:"xdr:colOff",zero:!0}),"xdr:row":new o({tag:"xdr:row",zero:!0}),"xdr:rowOff":new o({tag:"xdr:rowOff",zero:!0})}}render(a,l){a.openNode(this.tag),this.map["xdr:col"].render(a,l.nativeCol),this.map["xdr:colOff"].render(a,l.nativeColOff),this.map["xdr:row"].render(a,l.nativeRow),this.map["xdr:rowOff"].render(a,l.nativeRowOff),a.closeNode()}parseOpen(a){return this.parser?(this.parser.parseOpen(a),!0):(a.name===this.tag?this.reset():(this.parser=this.map[a.name],this.parser&&this.parser.parseOpen(a)),!0)}parseText(a){this.parser&&this.parser.parseText(a)}parseClose(a){return this.parser?(this.parser.parseClose(a)||(this.parser=void 0),!0):a===this.tag?(this.model={nativeCol:this.map["xdr:col"].model,nativeColOff:this.map["xdr:colOff"].model,nativeRow:this.map["xdr:row"].model,nativeRowOff:this.map["xdr:rowOff"].model},!1):!0}}},{"../base-xform":32,"../simple/integer-xform":118}],62:[function(t,n,i){const s=t("../../../utils/col-cache"),o=t("../../../utils/xml-stream"),a=t("../base-xform"),l=t("./two-cell-anchor-xform"),u=t("./one-cell-anchor-xform");class c extends a{constructor(){super(),this.map={"xdr:twoCellAnchor":new l,"xdr:oneCellAnchor":new u}}prepare(h){h.anchors.forEach((f,m)=>{f.anchorType=(function(p){return(typeof p.range=="string"?s.decode(p.range):p.range).br?"xdr:twoCellAnchor":"xdr:oneCellAnchor"})(f),this.map[f.anchorType].prepare(f,{index:m})})}get tag(){return"xdr:wsDr"}render(h,f){h.openXml(o.StdDocAttributes),h.openNode(this.tag,c.DRAWING_ATTRIBUTES),f.anchors.forEach(m=>{this.map[m.anchorType].render(h,m)}),h.closeNode()}parseOpen(h){return this.parser?(this.parser.parseOpen(h),!0):(h.name===this.tag?(this.reset(),this.model={anchors:[]}):(this.parser=this.map[h.name],this.parser&&this.parser.parseOpen(h)),!0)}parseText(h){this.parser&&this.parser.parseText(h)}parseClose(h){return this.parser?(this.parser.parseClose(h)||(this.model.anchors.push(this.parser.model),this.parser=void 0),!0):h!==this.tag}reconcile(h,f){h.anchors.forEach(m=>{m.br?this.map["xdr:twoCellAnchor"].reconcile(m,f):this.map["xdr:oneCellAnchor"].reconcile(m,f)})}}c.DRAWING_ATTRIBUTES={"xmlns:xdr":"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing","xmlns:a":"http://schemas.openxmlformats.org/drawingml/2006/main"},n.exports=c},{"../../../utils/col-cache":19,"../../../utils/xml-stream":28,"../base-xform":32,"./one-cell-anchor-xform":67,"./two-cell-anchor-xform":70}],63:[function(t,n,i){const s=t("../base-xform");n.exports=class extends s{get tag(){return"a:extLst"}render(o){o.openNode(this.tag),o.openNode("a:ext",{uri:"{FF2B5EF4-FFF2-40B4-BE49-F238E27FC236}"}),o.leafNode("a16:creationId",{"xmlns:a16":"http://schemas.microsoft.com/office/drawing/2014/main",id:"{00000000-0008-0000-0000-000002000000}"}),o.closeNode(),o.closeNode()}parseOpen(o){switch(o.name){case this.tag:default:return!0}}parseText(){}parseClose(o){return o!==this.tag}}},{"../base-xform":32}],64:[function(t,n,i){const s=t("../base-xform");n.exports=class extends s{constructor(o){super(),this.tag=o.tag,this.map={}}render(o,a){o.openNode(this.tag);const l=Math.floor(9525*a.width),u=Math.floor(9525*a.height);o.addAttribute("cx",l),o.addAttribute("cy",u),o.closeNode()}parseOpen(o){return o.name===this.tag&&(this.model={width:parseInt(o.attributes.cx||"0",10)/9525,height:parseInt(o.attributes.cy||"0",10)/9525},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],65:[function(t,n,i){const s=t("../base-xform");n.exports=class extends s{get tag(){return"a:hlinkClick"}render(o,a){a.hyperlinks&&a.hyperlinks.rId&&o.leafNode(this.tag,{"xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","r:id":a.hyperlinks.rId,tooltip:a.hyperlinks.tooltip})}parseOpen(o){return o.name===this.tag&&(this.model={hyperlinks:{rId:o.attributes["r:id"],tooltip:o.attributes.tooltip}}),!0}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],66:[function(t,n,i){const s=t("../base-xform"),o=t("./c-nv-pr-xform"),a=t("./c-nv-pic-pr-xform");n.exports=class extends s{constructor(){super(),this.map={"xdr:cNvPr":new o,"xdr:cNvPicPr":new a}}get tag(){return"xdr:nvPicPr"}render(l,u){l.openNode(this.tag),this.map["xdr:cNvPr"].render(l,u),this.map["xdr:cNvPicPr"].render(l,u),l.closeNode()}parseOpen(l){return this.parser?(this.parser.parseOpen(l),!0):(l.name===this.tag?this.reset():(this.parser=this.map[l.name],this.parser&&this.parser.parseOpen(l)),!0)}parseText(){}parseClose(l){return this.parser?(this.parser.parseClose(l)||(this.parser=void 0),!0):l===this.tag?(this.model=this.map["xdr:cNvPr"].model,!1):!0}}},{"../base-xform":32,"./c-nv-pic-pr-xform":59,"./c-nv-pr-xform":60}],67:[function(t,n,i){const s=t("./base-cell-anchor-xform"),o=t("../static-xform"),a=t("./cell-position-xform"),l=t("./ext-xform"),u=t("./pic-xform");n.exports=class extends s{constructor(){super(),this.map={"xdr:from":new a({tag:"xdr:from"}),"xdr:ext":new l({tag:"xdr:ext"}),"xdr:pic":new u,"xdr:clientData":new o({tag:"xdr:clientData"})}}get tag(){return"xdr:oneCellAnchor"}prepare(c,d){this.map["xdr:pic"].prepare(c.picture,d)}render(c,d){c.openNode(this.tag,{editAs:d.range.editAs||"oneCell"}),this.map["xdr:from"].render(c,d.range.tl),this.map["xdr:ext"].render(c,d.range.ext),this.map["xdr:pic"].render(c,d.picture),this.map["xdr:clientData"].render(c,{}),c.closeNode()}parseClose(c){return this.parser?(this.parser.parseClose(c)||(this.parser=void 0),!0):c===this.tag?(this.model.range.tl=this.map["xdr:from"].model,this.model.range.ext=this.map["xdr:ext"].model,this.model.picture=this.map["xdr:pic"].model,!1):!0}reconcile(c,d){c.medium=this.reconcilePicture(c.picture,d)}}},{"../static-xform":120,"./base-cell-anchor-xform":56,"./cell-position-xform":61,"./ext-xform":64,"./pic-xform":68}],68:[function(t,n,i){const s=t("../base-xform"),o=t("../static-xform"),a=t("./blip-fill-xform"),l=t("./nv-pic-pr-xform"),u=t("./sp-pr");n.exports=class extends s{constructor(){super(),this.map={"xdr:nvPicPr":new l,"xdr:blipFill":new a,"xdr:spPr":new o(u)}}get tag(){return"xdr:pic"}prepare(c,d){c.index=d.index+1}render(c,d){c.openNode(this.tag),this.map["xdr:nvPicPr"].render(c,d),this.map["xdr:blipFill"].render(c,d),this.map["xdr:spPr"].render(c,d),c.closeNode()}parseOpen(c){return this.parser?(this.parser.parseOpen(c),!0):(c.name===this.tag?this.reset():(this.parser=this.map[c.name],this.parser&&this.parser.parseOpen(c)),!0)}parseText(){}parseClose(c){return this.parser?(this.parser.parseClose(c)||(this.mergeModel(this.parser.model),this.parser=void 0),!0):c!==this.tag}}},{"../base-xform":32,"../static-xform":120,"./blip-fill-xform":57,"./nv-pic-pr-xform":66,"./sp-pr":69}],69:[function(t,n,i){n.exports={tag:"xdr:spPr",c:[{tag:"a:xfrm",c:[{tag:"a:off",$:{x:"0",y:"0"}},{tag:"a:ext",$:{cx:"0",cy:"0"}}]},{tag:"a:prstGeom",$:{prst:"rect"},c:[{tag:"a:avLst"}]}]}},{}],70:[function(t,n,i){const s=t("./base-cell-anchor-xform"),o=t("../static-xform"),a=t("./cell-position-xform"),l=t("./pic-xform");n.exports=class extends s{constructor(){super(),this.map={"xdr:from":new a({tag:"xdr:from"}),"xdr:to":new a({tag:"xdr:to"}),"xdr:pic":new l,"xdr:clientData":new o({tag:"xdr:clientData"})}}get tag(){return"xdr:twoCellAnchor"}prepare(u,c){this.map["xdr:pic"].prepare(u.picture,c)}render(u,c){u.openNode(this.tag,{editAs:c.range.editAs||"oneCell"}),this.map["xdr:from"].render(u,c.range.tl),this.map["xdr:to"].render(u,c.range.br),this.map["xdr:pic"].render(u,c.picture),this.map["xdr:clientData"].render(u,{}),u.closeNode()}parseClose(u){return this.parser?(this.parser.parseClose(u)||(this.parser=void 0),!0):u===this.tag?(this.model.range.tl=this.map["xdr:from"].model,this.model.range.br=this.map["xdr:to"].model,this.model.picture=this.map["xdr:pic"].model,!1):!0}reconcile(u,c){u.medium=this.reconcilePicture(u.picture,c)}}},{"../static-xform":120,"./base-cell-anchor-xform":56,"./cell-position-xform":61,"./pic-xform":68}],71:[function(t,n,i){const s=t("./base-xform");n.exports=class extends s{constructor(o){super(),this.tag=o.tag,this.always=!!o.always,this.count=o.count,this.empty=o.empty,this.$count=o.$count||"count",this.$=o.$,this.childXform=o.childXform,this.maxItems=o.maxItems}prepare(o,a){const{childXform:l}=this;o&&o.forEach((u,c)=>{a.index=c,l.prepare(u,a)})}render(o,a){if(this.always||a&&a.length){o.openNode(this.tag,this.$),this.count&&o.addAttribute(this.$count,a&&a.length||0);const{childXform:l}=this;(a||[]).forEach((u,c)=>{l.render(o,u,c)}),o.closeNode()}else this.empty&&o.leafNode(this.tag)}parseOpen(o){return this.parser?(this.parser.parseOpen(o),!0):o.name===this.tag?(this.model=[],!0):!!this.childXform.parseOpen(o)&&(this.parser=this.childXform,!0)}parseText(o){this.parser&&this.parser.parseText(o)}parseClose(o){if(this.parser){if(!this.parser.parseClose(o)&&(this.model.push(this.parser.model),this.parser=void 0,this.maxItems&&this.model.length>this.maxItems))throw new Error(`Max ${this.childXform.tag} count (${this.maxItems}) exceeded`);return!0}return!1}reconcile(o,a){if(o){const{childXform:l}=this;o.forEach(u=>{l.reconcile(u,a)})}}}},{"./base-xform":32}],72:[function(t,n,i){const s=t("../../../utils/col-cache"),o=t("../base-xform");n.exports=class extends o{get tag(){return"autoFilter"}render(a,l){if(l)if(typeof l=="string")a.leafNode("autoFilter",{ref:l});else{const u=function(h){return typeof h=="string"?h:s.getAddress(h.row,h.column).address},c=u(l.from),d=u(l.to);c&&d&&a.leafNode("autoFilter",{ref:`${c}:${d}`})}}parseOpen(a){a.name==="autoFilter"&&(this.model=a.attributes.ref)}}},{"../../../utils/col-cache":19,"../base-xform":32}],73:[function(t,n,i){const s=t("../../../utils/utils"),o=t("../base-xform"),a=t("../../../doc/range"),l=t("../../../doc/enums"),u=t("../strings/rich-text-xform");function c(d){if(d==null)return l.ValueType.Null;if(d instanceof String||typeof d=="string")return l.ValueType.String;if(typeof d=="number")return l.ValueType.Number;if(typeof d=="boolean")return l.ValueType.Boolean;if(d instanceof Date)return l.ValueType.Date;if(d.text&&d.hyperlink)return l.ValueType.Hyperlink;if(d.formula)return l.ValueType.Formula;if(d.error)return l.ValueType.Error;throw new Error("I could not understand type of value")}n.exports=class extends o{constructor(){super(),this.richTextXForm=new u}get tag(){return"c"}prepare(d,h){const f=h.styles.addStyleModel(d.style||{},(function(m){return m.type===l.ValueType.Formula?c(m.result):m.type})(d));switch(f&&(d.styleId=f),d.comment&&h.comments.push({...d.comment,ref:d.address}),d.type){case l.ValueType.String:case l.ValueType.RichText:h.sharedStrings&&(d.ssId=h.sharedStrings.add(d.value));break;case l.ValueType.Date:h.date1904&&(d.date1904=!0);break;case l.ValueType.Hyperlink:h.sharedStrings&&d.text!==void 0&&d.text!==null&&(d.ssId=h.sharedStrings.add(d.text)),h.hyperlinks.push({address:d.address,target:d.hyperlink,tooltip:d.tooltip});break;case l.ValueType.Merge:h.merges.add(d);break;case l.ValueType.Formula:if(h.date1904&&(d.date1904=!0),d.shareType==="shared"&&(d.si=h.siFormulae++),d.formula)h.formulae[d.address]=d;else if(d.sharedFormula){const m=h.formulae[d.sharedFormula];if(!m)throw new Error("Shared Formula master must exist above and or left of clone for cell "+d.address);m.si===void 0?(m.shareType="shared",m.si=h.siFormulae++,m.range=new a(m.address,d.address)):m.range&&m.range.expandToAddress(d.address),d.si=m.si}}}renderFormula(d,h){let f=null;switch(h.shareType){case"shared":f={t:"shared",ref:h.ref||h.range.range,si:h.si};break;case"array":f={t:"array",ref:h.ref};break;default:h.si!==void 0&&(f={t:"shared",si:h.si})}switch(c(h.result)){case l.ValueType.Null:d.leafNode("f",f,h.formula);break;case l.ValueType.String:d.addAttribute("t","str"),d.leafNode("f",f,h.formula),d.leafNode("v",null,h.result);break;case l.ValueType.Number:d.leafNode("f",f,h.formula),d.leafNode("v",null,h.result);break;case l.ValueType.Boolean:d.addAttribute("t","b"),d.leafNode("f",f,h.formula),d.leafNode("v",null,h.result?1:0);break;case l.ValueType.Error:d.addAttribute("t","e"),d.leafNode("f",f,h.formula),d.leafNode("v",null,h.result.error);break;case l.ValueType.Date:d.leafNode("f",f,h.formula),d.leafNode("v",null,s.dateToExcel(h.result,h.date1904));break;default:throw new Error("I could not understand type of value")}}render(d,h){if(h.type!==l.ValueType.Null||h.styleId){switch(d.openNode("c"),d.addAttribute("r",h.address),h.styleId&&d.addAttribute("s",h.styleId),h.type){case l.ValueType.Null:break;case l.ValueType.Number:d.leafNode("v",null,h.value);break;case l.ValueType.Boolean:d.addAttribute("t","b"),d.leafNode("v",null,h.value?"1":"0");break;case l.ValueType.Error:d.addAttribute("t","e"),d.leafNode("v",null,h.value.error);break;case l.ValueType.String:case l.ValueType.RichText:h.ssId!==void 0?(d.addAttribute("t","s"),d.leafNode("v",null,h.ssId)):h.value&&h.value.richText?(d.addAttribute("t","inlineStr"),d.openNode("is"),h.value.richText.forEach(f=>{this.richTextXForm.render(d,f)}),d.closeNode("is")):(d.addAttribute("t","str"),d.leafNode("v",null,h.value));break;case l.ValueType.Date:d.leafNode("v",null,s.dateToExcel(h.value,h.date1904));break;case l.ValueType.Hyperlink:h.ssId!==void 0?(d.addAttribute("t","s"),d.leafNode("v",null,h.ssId)):(d.addAttribute("t","str"),d.leafNode("v",null,h.text));break;case l.ValueType.Formula:this.renderFormula(d,h);break;case l.ValueType.Merge:}d.closeNode()}}parseOpen(d){if(this.parser)return this.parser.parseOpen(d),!0;switch(d.name){case"c":return this.model={address:d.attributes.r},this.t=d.attributes.t,d.attributes.s&&(this.model.styleId=parseInt(d.attributes.s,10)),!0;case"f":return this.currentNode="f",this.model.si=d.attributes.si,this.model.shareType=d.attributes.t,this.model.ref=d.attributes.ref,!0;case"v":return this.currentNode="v",!0;case"t":return this.currentNode="t",!0;case"r":return this.parser=this.richTextXForm,this.parser.parseOpen(d),!0;default:return!1}}parseText(d){if(this.parser)this.parser.parseText(d);else switch(this.currentNode){case"f":this.model.formula=this.model.formula?this.model.formula+d:d;break;case"v":case"t":this.model.value&&this.model.value.richText?this.model.value.richText.text=this.model.value.richText.text?this.model.value.richText.text+d:d:this.model.value=this.model.value?this.model.value+d:d}}parseClose(d){switch(d){case"c":{const{model:h}=this;if(h.formula||h.shareType)h.type=l.ValueType.Formula,h.value&&(this.t==="str"?h.result=s.xmlDecode(h.value):this.t==="b"?h.result=parseInt(h.value,10)!==0:this.t==="e"?h.result={error:h.value}:h.result=parseFloat(h.value),h.value=void 0);else if(h.value!==void 0)switch(this.t){case"s":h.type=l.ValueType.String,h.value=parseInt(h.value,10);break;case"str":h.type=l.ValueType.String,h.value=s.xmlDecode(h.value);break;case"inlineStr":h.type=l.ValueType.String;break;case"b":h.type=l.ValueType.Boolean,h.value=parseInt(h.value,10)!==0;break;case"e":h.type=l.ValueType.Error,h.value={error:h.value};break;default:h.type=l.ValueType.Number,h.value=parseFloat(h.value)}else h.styleId?h.type=l.ValueType.Null:h.type=l.ValueType.Merge;return!1}case"f":case"v":case"is":return this.currentNode=void 0,!0;case"t":return this.parser?(this.parser.parseClose(d),!0):(this.currentNode=void 0,!0);case"r":return this.model.value=this.model.value||{},this.model.value.richText=this.model.value.richText||[],this.model.value.richText.push(this.parser.model),this.parser=void 0,this.currentNode=void 0,!0;default:return!!this.parser&&(this.parser.parseClose(d),!0)}}reconcile(d,h){const f=d.styleId&&h.styles&&h.styles.getStyleModel(d.styleId);switch(f&&(d.style=f),d.styleId!==void 0&&(d.styleId=void 0),d.type){case l.ValueType.String:typeof d.value=="number"&&h.sharedStrings&&(d.value=h.sharedStrings.getString(d.value)),d.value.richText&&(d.type=l.ValueType.RichText);break;case l.ValueType.Number:f&&s.isDateFmt(f.numFmt)&&(d.type=l.ValueType.Date,d.value=s.excelToDate(d.value,h.date1904));break;case l.ValueType.Formula:d.result!==void 0&&f&&s.isDateFmt(f.numFmt)&&(d.result=s.excelToDate(d.result,h.date1904)),d.shareType==="shared"&&(d.ref?h.formulae[d.si]=d.address:(d.sharedFormula=h.formulae[d.si],delete d.shareType),delete d.si)}const m=h.hyperlinkMap[d.address];m&&(d.type===l.ValueType.Formula?(d.text=d.result,d.result=void 0):(d.text=d.value,d.value=void 0),d.type=l.ValueType.Hyperlink,d.hyperlink=m);const p=h.commentsMap&&h.commentsMap[d.address];p&&(d.comment=p)}}},{"../../../doc/enums":7,"../../../doc/range":10,"../../../utils/utils":27,"../base-xform":32,"../strings/rich-text-xform":122}],74:[function(t,n,i){const s=t("../../base-xform");n.exports=class extends s{get tag(){return"x14:cfIcon"}render(o,a){o.leafNode(this.tag,{iconSet:a.iconSet,iconId:a.iconId})}parseOpen(o){let{attributes:a}=o;this.model={iconSet:a.iconSet,iconId:s.toIntValue(a.iconId)}}parseClose(o){return o!==this.tag}}},{"../../base-xform":32}],75:[function(t,n,i){const{v4:s}=t("uuid"),o=t("../../base-xform"),a=t("../../composite-xform"),l=t("./databar-ext-xform"),u=t("./icon-set-ext-xform"),c={"3Triangles":!0,"3Stars":!0,"5Boxes":!0};class d extends a{constructor(){super(),this.map={"x14:dataBar":this.databarXform=new l,"x14:iconSet":this.iconSetXform=new u}}get tag(){return"x14:cfRule"}static isExt(f){return f.type==="dataBar"?l.isExt(f):!(f.type!=="iconSet"||!f.custom&&!c[f.iconSet])}prepare(f){d.isExt(f)&&(f.x14Id=`{${s()}}`.toUpperCase())}render(f,m){if(d.isExt(m))switch(m.type){case"dataBar":this.renderDataBar(f,m);break;case"iconSet":this.renderIconSet(f,m)}}renderDataBar(f,m){f.openNode(this.tag,{type:"dataBar",id:m.x14Id}),this.databarXform.render(f,m),f.closeNode()}renderIconSet(f,m){f.openNode(this.tag,{type:"iconSet",priority:m.priority,id:m.x14Id||`{${s()}}`}),this.iconSetXform.render(f,m),f.closeNode()}createNewModel(f){let{attributes:m}=f;return{type:m.type,x14Id:m.id,priority:o.toIntValue(m.priority)}}onParserClose(f,m){Object.assign(this.model,m.model)}}n.exports=d},{"../../base-xform":32,"../../composite-xform":48,"./databar-ext-xform":79,"./icon-set-ext-xform":81,uuid:528}],76:[function(t,n,i){const s=t("../../composite-xform"),o=t("./f-ext-xform");n.exports=class extends s{constructor(){super(),this.map={"xm:f":this.fExtXform=new o}}get tag(){return"x14:cfvo"}render(a,l){a.openNode(this.tag,{type:l.type}),l.value!==void 0&&this.fExtXform.render(a,l.value),a.closeNode()}createNewModel(a){return{type:a.attributes.type}}onParserClose(a,l){a==="xm:f"&&(this.model.value=l.model?parseFloat(l.model):0)}}},{"../../composite-xform":48,"./f-ext-xform":80}],77:[function(t,n,i){const s=t("../../composite-xform"),o=t("./sqref-ext-xform"),a=t("./cf-rule-ext-xform");n.exports=class extends s{constructor(){super(),this.map={"xm:sqref":this.sqRef=new o,"x14:cfRule":this.cfRule=new a}}get tag(){return"x14:conditionalFormatting"}prepare(l,u){l.rules.forEach(c=>{this.cfRule.prepare(c,u)})}render(l,u){u.rules.some(a.isExt)&&(l.openNode(this.tag,{"xmlns:xm":"http://schemas.microsoft.com/office/excel/2006/main"}),u.rules.filter(a.isExt).forEach(c=>this.cfRule.render(l,c)),this.sqRef.render(l,u.ref),l.closeNode())}createNewModel(){return{rules:[]}}onParserClose(l,u){switch(l){case"xm:sqref":this.model.ref=u.model;break;case"x14:cfRule":this.model.rules.push(u.model)}}}},{"../../composite-xform":48,"./cf-rule-ext-xform":75,"./sqref-ext-xform":82}],78:[function(t,n,i){const s=t("../../composite-xform"),o=t("./cf-rule-ext-xform"),a=t("./conditional-formatting-ext-xform");n.exports=class extends s{constructor(){super(),this.map={"x14:conditionalFormatting":this.cfXform=new a}}get tag(){return"x14:conditionalFormattings"}hasContent(l){return l.hasExtContent===void 0&&(l.hasExtContent=l.some(u=>u.rules.some(o.isExt))),l.hasExtContent}prepare(l,u){l.forEach(c=>{this.cfXform.prepare(c,u)})}render(l,u){this.hasContent(u)&&(l.openNode(this.tag),u.forEach(c=>this.cfXform.render(l,c)),l.closeNode())}createNewModel(){return[]}onParserClose(l,u){this.model.push(u.model)}}},{"../../composite-xform":48,"./cf-rule-ext-xform":75,"./conditional-formatting-ext-xform":77}],79:[function(t,n,i){const s=t("../../base-xform"),o=t("../../composite-xform"),a=t("../../style/color-xform"),l=t("./cfvo-ext-xform");n.exports=class extends o{constructor(){super(),this.map={"x14:cfvo":this.cfvoXform=new l,"x14:borderColor":this.borderColorXform=new a("x14:borderColor"),"x14:negativeBorderColor":this.negativeBorderColorXform=new a("x14:negativeBorderColor"),"x14:negativeFillColor":this.negativeFillColorXform=new a("x14:negativeFillColor"),"x14:axisColor":this.axisColorXform=new a("x14:axisColor")}}static isExt(u){return!u.gradient}get tag(){return"x14:dataBar"}render(u,c){u.openNode(this.tag,{minLength:s.toIntAttribute(c.minLength,0,!0),maxLength:s.toIntAttribute(c.maxLength,100,!0),border:s.toBoolAttribute(c.border,!1),gradient:s.toBoolAttribute(c.gradient,!0),negativeBarColorSameAsPositive:s.toBoolAttribute(c.negativeBarColorSameAsPositive,!0),negativeBarBorderColorSameAsPositive:s.toBoolAttribute(c.negativeBarBorderColorSameAsPositive,!0),axisPosition:s.toAttribute(c.axisPosition,"auto"),direction:s.toAttribute(c.direction,"leftToRight")}),c.cfvo.forEach(d=>{this.cfvoXform.render(u,d)}),this.borderColorXform.render(u,c.borderColor),this.negativeBorderColorXform.render(u,c.negativeBorderColor),this.negativeFillColorXform.render(u,c.negativeFillColor),this.axisColorXform.render(u,c.axisColor),u.closeNode()}createNewModel(u){let{attributes:c}=u;return{cfvo:[],minLength:s.toIntValue(c.minLength,0),maxLength:s.toIntValue(c.maxLength,100),border:s.toBoolValue(c.border,!1),gradient:s.toBoolValue(c.gradient,!0),negativeBarColorSameAsPositive:s.toBoolValue(c.negativeBarColorSameAsPositive,!0),negativeBarBorderColorSameAsPositive:s.toBoolValue(c.negativeBarBorderColorSameAsPositive,!0),axisPosition:s.toStringValue(c.axisPosition,"auto"),direction:s.toStringValue(c.direction,"leftToRight")}}onParserClose(u,c){const[,d]=u.split(":");d==="cfvo"?this.model.cfvo.push(c.model):this.model[d]=c.model}}},{"../../base-xform":32,"../../composite-xform":48,"../../style/color-xform":128,"./cfvo-ext-xform":76}],80:[function(t,n,i){const s=t("../../base-xform");n.exports=class extends s{get tag(){return"xm:f"}render(o,a){o.leafNode(this.tag,null,a)}parseOpen(){this.model=""}parseText(o){this.model+=o}parseClose(o){return o!==this.tag}}},{"../../base-xform":32}],81:[function(t,n,i){const s=t("../../base-xform"),o=t("../../composite-xform"),a=t("./cfvo-ext-xform"),l=t("./cf-icon-ext-xform");n.exports=class extends o{constructor(){super(),this.map={"x14:cfvo":this.cfvoXform=new a,"x14:cfIcon":this.cfIconXform=new l}}get tag(){return"x14:iconSet"}render(u,c){u.openNode(this.tag,{iconSet:s.toStringAttribute(c.iconSet),reverse:s.toBoolAttribute(c.reverse,!1),showValue:s.toBoolAttribute(c.showValue,!0),custom:s.toBoolAttribute(c.icons,!1)}),c.cfvo.forEach(d=>{this.cfvoXform.render(u,d)}),c.icons&&c.icons.forEach((d,h)=>{d.iconId=h,this.cfIconXform.render(u,d)}),u.closeNode()}createNewModel(u){let{attributes:c}=u;return{cfvo:[],iconSet:s.toStringValue(c.iconSet,"3TrafficLights"),reverse:s.toBoolValue(c.reverse,!1),showValue:s.toBoolValue(c.showValue,!0)}}onParserClose(u,c){const[,d]=u.split(":");switch(d){case"cfvo":this.model.cfvo.push(c.model);break;case"cfIcon":this.model.icons||(this.model.icons=[]),this.model.icons.push(c.model);break;default:this.model[d]=c.model}}}},{"../../base-xform":32,"../../composite-xform":48,"./cf-icon-ext-xform":74,"./cfvo-ext-xform":76}],82:[function(t,n,i){const s=t("../../base-xform");n.exports=class extends s{get tag(){return"xm:sqref"}render(o,a){o.leafNode(this.tag,null,a)}parseOpen(){this.model=""}parseText(o){this.model+=o}parseClose(o){return o!==this.tag}}},{"../../base-xform":32}],83:[function(t,n,i){const s=t("../../base-xform"),o=t("../../composite-xform"),a=t("../../../../doc/range"),l=t("./databar-xform"),u=t("./ext-lst-ref-xform"),c=t("./formula-xform"),d=t("./color-scale-xform"),h=t("./icon-set-xform"),f={"3Triangles":!0,"3Stars":!0,"5Boxes":!0},m=g=>{const{type:v,operator:y}=g;switch(v){case"containsText":case"containsBlanks":case"notContainsBlanks":case"containsErrors":case"notContainsErrors":return{type:"containsText",operator:v};default:return{type:v,operator:y}}};class p extends o{constructor(){super(),this.map={dataBar:this.databarXform=new l,extLst:this.extLstRefXform=new u,formula:this.formulaXform=new c,colorScale:this.colorScaleXform=new d,iconSet:this.iconSetXform=new h}}get tag(){return"cfRule"}static isPrimitive(v){return v.type!=="iconSet"||!v.custom&&!f[v.iconSet]}render(v,y){switch(y.type){case"expression":this.renderExpression(v,y);break;case"cellIs":this.renderCellIs(v,y);break;case"top10":this.renderTop10(v,y);break;case"aboveAverage":this.renderAboveAverage(v,y);break;case"dataBar":this.renderDataBar(v,y);break;case"colorScale":this.renderColorScale(v,y);break;case"iconSet":this.renderIconSet(v,y);break;case"containsText":this.renderText(v,y);break;case"timePeriod":this.renderTimePeriod(v,y)}}renderExpression(v,y){v.openNode(this.tag,{type:"expression",dxfId:y.dxfId,priority:y.priority}),this.formulaXform.render(v,y.formulae[0]),v.closeNode()}renderCellIs(v,y){v.openNode(this.tag,{type:"cellIs",dxfId:y.dxfId,priority:y.priority,operator:y.operator}),y.formulae.forEach(b=>{this.formulaXform.render(v,b)}),v.closeNode()}renderTop10(v,y){v.leafNode(this.tag,{type:"top10",dxfId:y.dxfId,priority:y.priority,percent:s.toBoolAttribute(y.percent,!1),bottom:s.toBoolAttribute(y.bottom,!1),rank:s.toIntValue(y.rank,10,!0)})}renderAboveAverage(v,y){v.leafNode(this.tag,{type:"aboveAverage",dxfId:y.dxfId,priority:y.priority,aboveAverage:s.toBoolAttribute(y.aboveAverage,!0)})}renderDataBar(v,y){v.openNode(this.tag,{type:"dataBar",priority:y.priority}),this.databarXform.render(v,y),this.extLstRefXform.render(v,y),v.closeNode()}renderColorScale(v,y){v.openNode(this.tag,{type:"colorScale",priority:y.priority}),this.colorScaleXform.render(v,y),v.closeNode()}renderIconSet(v,y){p.isPrimitive(y)&&(v.openNode(this.tag,{type:"iconSet",priority:y.priority}),this.iconSetXform.render(v,y),v.closeNode())}renderText(v,y){v.openNode(this.tag,{type:y.operator,dxfId:y.dxfId,priority:y.priority,operator:s.toStringAttribute(y.operator,"containsText")});const b=(E=>{if(E.formulae&&E.formulae[0])return E.formulae[0];const A=new a(E.ref),{tl:M}=A;switch(E.operator){case"containsText":return`NOT(ISERROR(SEARCH("${E.text}",${M})))`;case"containsBlanks":return`LEN(TRIM(${M}))=0`;case"notContainsBlanks":return`LEN(TRIM(${M}))>0`;case"containsErrors":return`ISERROR(${M})`;case"notContainsErrors":return`NOT(ISERROR(${M}))`;default:return}})(y);b&&this.formulaXform.render(v,b),v.closeNode()}renderTimePeriod(v,y){v.openNode(this.tag,{type:"timePeriod",dxfId:y.dxfId,priority:y.priority,timePeriod:y.timePeriod});const b=(E=>{if(E.formulae&&E.formulae[0])return E.formulae[0];const A=new a(E.ref),{tl:M}=A;switch(E.timePeriod){case"thisWeek":return`AND(TODAY()-ROUNDDOWN(${M},0)<=WEEKDAY(TODAY())-1,ROUNDDOWN(${M},0)-TODAY()<=7-WEEKDAY(TODAY()))`;case"lastWeek":return`AND(TODAY()-ROUNDDOWN(${M},0)>=(WEEKDAY(TODAY())),TODAY()-ROUNDDOWN(${M},0)<(WEEKDAY(TODAY())+7))`;case"nextWeek":return`AND(ROUNDDOWN(${M},0)-TODAY()>(7-WEEKDAY(TODAY())),ROUNDDOWN(${M},0)-TODAY()<(15-WEEKDAY(TODAY())))`;case"yesterday":return`FLOOR(${M},1)=TODAY()-1`;case"today":return`FLOOR(${M},1)=TODAY()`;case"tomorrow":return`FLOOR(${M},1)=TODAY()+1`;case"last7Days":return`AND(TODAY()-FLOOR(${M},1)<=6,FLOOR(${M},1)<=TODAY())`;case"lastMonth":return`AND(MONTH(${M})=MONTH(EDATE(TODAY(),0-1)),YEAR(${M})=YEAR(EDATE(TODAY(),0-1)))`;case"thisMonth":return`AND(MONTH(${M})=MONTH(TODAY()),YEAR(${M})=YEAR(TODAY()))`;case"nextMonth":return`AND(MONTH(${M})=MONTH(EDATE(TODAY(),0+1)),YEAR(${M})=YEAR(EDATE(TODAY(),0+1)))`;default:return}})(y);b&&this.formulaXform.render(v,b),v.closeNode()}createNewModel(v){let{attributes:y}=v;return{...m(y),dxfId:s.toIntValue(y.dxfId),priority:s.toIntValue(y.priority),timePeriod:y.timePeriod,percent:s.toBoolValue(y.percent),bottom:s.toBoolValue(y.bottom),rank:s.toIntValue(y.rank),aboveAverage:s.toBoolValue(y.aboveAverage)}}onParserClose(v,y){switch(v){case"dataBar":case"extLst":case"colorScale":case"iconSet":Object.assign(this.model,y.model);break;case"formula":this.model.formulae=this.model.formulae||[],this.model.formulae.push(y.model)}}}n.exports=p},{"../../../../doc/range":10,"../../base-xform":32,"../../composite-xform":48,"./color-scale-xform":85,"./databar-xform":88,"./ext-lst-ref-xform":89,"./formula-xform":90,"./icon-set-xform":91}],84:[function(t,n,i){const s=t("../../base-xform");n.exports=class extends s{get tag(){return"cfvo"}render(o,a){o.leafNode(this.tag,{type:a.type,val:a.value})}parseOpen(o){this.model={type:o.attributes.type,value:s.toFloatValue(o.attributes.val)}}parseClose(o){return o!==this.tag}}},{"../../base-xform":32}],85:[function(t,n,i){const s=t("../../composite-xform"),o=t("../../style/color-xform"),a=t("./cfvo-xform");n.exports=class extends s{constructor(){super(),this.map={cfvo:this.cfvoXform=new a,color:this.colorXform=new o}}get tag(){return"colorScale"}render(l,u){l.openNode(this.tag),u.cfvo.forEach(c=>{this.cfvoXform.render(l,c)}),u.color.forEach(c=>{this.colorXform.render(l,c)}),l.closeNode()}createNewModel(l){return{cfvo:[],color:[]}}onParserClose(l,u){this.model[l].push(u.model)}}},{"../../composite-xform":48,"../../style/color-xform":128,"./cfvo-xform":84}],86:[function(t,n,i){const s=t("../../composite-xform"),o=t("./cf-rule-xform");n.exports=class extends s{constructor(){super(),this.map={cfRule:new o}}get tag(){return"conditionalFormatting"}render(a,l){l.rules.some(o.isPrimitive)&&(a.openNode(this.tag,{sqref:l.ref}),l.rules.forEach(u=>{o.isPrimitive(u)&&(u.ref=l.ref,this.map.cfRule.render(a,u))}),a.closeNode())}createNewModel(a){let{attributes:l}=a;return{ref:l.sqref,rules:[]}}onParserClose(a,l){this.model.rules.push(l.model)}}},{"../../composite-xform":48,"./cf-rule-xform":83}],87:[function(t,n,i){const s=t("../../base-xform"),o=t("./conditional-formatting-xform");n.exports=class extends s{constructor(){super(),this.cfXform=new o}get tag(){return"conditionalFormatting"}reset(){this.model=[]}prepare(a,l){let u=a.reduce((c,d)=>Math.max(c,...d.rules.map(h=>h.priority||0)),1);a.forEach(c=>{c.rules.forEach(d=>{d.priority||(d.priority=u++),d.style&&(d.dxfId=l.styles.addDxfStyle(d.style))})})}render(a,l){l.forEach(u=>{this.cfXform.render(a,u)})}parseOpen(a){return this.parser?(this.parser.parseOpen(a),!0):a.name==="conditionalFormatting"?(this.parser=this.cfXform,this.parser.parseOpen(a),!0):!1}parseText(a){this.parser&&this.parser.parseText(a)}parseClose(a){return!!this.parser&&(!!this.parser.parseClose(a)||(this.model.push(this.parser.model),this.parser=void 0,!1))}reconcile(a,l){a.forEach(u=>{u.rules.forEach(c=>{c.dxfId!==void 0&&(c.style=l.styles.getDxfStyle(c.dxfId),delete c.dxfId)})})}}},{"../../base-xform":32,"./conditional-formatting-xform":86}],88:[function(t,n,i){const s=t("../../composite-xform"),o=t("../../style/color-xform"),a=t("./cfvo-xform");n.exports=class extends s{constructor(){super(),this.map={cfvo:this.cfvoXform=new a,color:this.colorXform=new o}}get tag(){return"dataBar"}render(l,u){l.openNode(this.tag),u.cfvo.forEach(c=>{this.cfvoXform.render(l,c)}),this.colorXform.render(l,u.color),l.closeNode()}createNewModel(){return{cfvo:[]}}onParserClose(l,u){switch(l){case"cfvo":this.model.cfvo.push(u.model);break;case"color":this.model.color=u.model}}}},{"../../composite-xform":48,"../../style/color-xform":128,"./cfvo-xform":84}],89:[function(t,n,i){const s=t("../../base-xform"),o=t("../../composite-xform");class a extends s{get tag(){return"x14:id"}render(c,d){c.leafNode(this.tag,null,d)}parseOpen(){this.model=""}parseText(c){this.model+=c}parseClose(c){return c!==this.tag}}class l extends o{constructor(){super(),this.map={"x14:id":this.idXform=new a}}get tag(){return"ext"}render(c,d){c.openNode(this.tag,{uri:"{B025F937-C7B1-47D3-B67F-A62EFF666E3E}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"}),this.idXform.render(c,d.x14Id),c.closeNode()}createNewModel(){return{}}onParserClose(c,d){this.model.x14Id=d.model}}n.exports=class extends o{constructor(){super(),this.map={ext:new l}}get tag(){return"extLst"}render(u,c){u.openNode(this.tag),this.map.ext.render(u,c),u.closeNode()}createNewModel(){return{}}onParserClose(u,c){Object.assign(this.model,c.model)}}},{"../../base-xform":32,"../../composite-xform":48}],90:[function(t,n,i){const s=t("../../base-xform");n.exports=class extends s{get tag(){return"formula"}render(o,a){o.leafNode(this.tag,null,a)}parseOpen(){this.model=""}parseText(o){this.model+=o}parseClose(o){return o!==this.tag}}},{"../../base-xform":32}],91:[function(t,n,i){const s=t("../../base-xform"),o=t("../../composite-xform"),a=t("./cfvo-xform");n.exports=class extends o{constructor(){super(),this.map={cfvo:this.cfvoXform=new a}}get tag(){return"iconSet"}render(l,u){l.openNode(this.tag,{iconSet:s.toStringAttribute(u.iconSet,"3TrafficLights"),reverse:s.toBoolAttribute(u.reverse,!1),showValue:s.toBoolAttribute(u.showValue,!0)}),u.cfvo.forEach(c=>{this.cfvoXform.render(l,c)}),l.closeNode()}createNewModel(l){let{attributes:u}=l;return{iconSet:s.toStringValue(u.iconSet,"3TrafficLights"),reverse:s.toBoolValue(u.reverse),showValue:s.toBoolValue(u.showValue),cfvo:[]}}onParserClose(l,u){this.model[l].push(u.model)}}},{"../../base-xform":32,"../../composite-xform":48,"./cfvo-xform":84}],92:[function(t,n,i){const s=t("../../../utils/utils"),o=t("../base-xform");n.exports=class extends o{get tag(){return"col"}prepare(a,l){const u=l.styles.addStyleModel(a.style||{});u&&(a.styleId=u)}render(a,l){a.openNode("col"),a.addAttribute("min",l.min),a.addAttribute("max",l.max),l.width&&a.addAttribute("width",l.width),l.styleId&&a.addAttribute("style",l.styleId),l.hidden&&a.addAttribute("hidden","1"),l.bestFit&&a.addAttribute("bestFit","1"),l.outlineLevel&&a.addAttribute("outlineLevel",l.outlineLevel),l.collapsed&&a.addAttribute("collapsed","1"),a.addAttribute("customWidth","1"),a.closeNode()}parseOpen(a){if(a.name==="col"){const l=this.model={min:parseInt(a.attributes.min||"0",10),max:parseInt(a.attributes.max||"0",10),width:a.attributes.width===void 0?void 0:parseFloat(a.attributes.width||"0")};return a.attributes.style&&(l.styleId=parseInt(a.attributes.style,10)),s.parseBoolean(a.attributes.hidden)&&(l.hidden=!0),s.parseBoolean(a.attributes.bestFit)&&(l.bestFit=!0),a.attributes.outlineLevel&&(l.outlineLevel=parseInt(a.attributes.outlineLevel,10)),s.parseBoolean(a.attributes.collapsed)&&(l.collapsed=!0),!0}return!1}parseText(){}parseClose(){return!1}reconcile(a,l){a.styleId&&(a.style=l.styles.getStyleModel(a.styleId))}}},{"../../../utils/utils":27,"../base-xform":32}],93:[function(t,n,i){const s=t("../../../utils/under-dash"),o=t("../../../utils/utils"),a=t("../../../utils/col-cache"),l=t("../base-xform"),u=t("../../../doc/range");function c(h,f,m,p){const g=f[m];g!==void 0?h[m]=g:p!==void 0&&(h[m]=p)}function d(h,f,m,p){const g=f[m];g!==void 0&&(h[m]=o.parseBoolean(g))}n.exports=class extends l{get tag(){return"dataValidations"}render(h,f){const m=(function(p){const g=s.map(p,(b,E)=>({address:E,dataValidation:b,marked:!1})).sort((b,E)=>s.strcmp(b.address,E.address)),v=s.keyBy(g,"address"),y=(b,E,A)=>{for(let M=0;M<E;M++){const L=a.encodeAddress(b.row+M,A);if(!p[L]||!s.isEqual(p[b.address],p[L]))return!1}return!0};return g.map(b=>{if(!b.marked){const E=a.decodeEx(b.address);if(E.dimensions)return v[E.dimensions].marked=!0,{...b.dataValidation,sqref:b.address};let A=1,M=a.encodeAddress(E.row+A,E.col);for(;p[M]&&s.isEqual(b.dataValidation,p[M]);)A++,M=a.encodeAddress(E.row+A,E.col);let L=1;for(;y(E,A,E.col+L);)L++;for(let k=0;k<A;k++)for(let P=0;P<L;P++)M=a.encodeAddress(E.row+k,E.col+P),v[M].marked=!0;if(A>1||L>1){const k=E.row+(A-1),P=E.col+(L-1);return{...b.dataValidation,sqref:`${b.address}:${a.encodeAddress(k,P)}`}}return{...b.dataValidation,sqref:b.address}}return null}).filter(Boolean)})(f);m.length&&(h.openNode("dataValidations",{count:m.length}),m.forEach(p=>{h.openNode("dataValidation"),p.type!=="any"&&(h.addAttribute("type",p.type),p.operator&&p.type!=="list"&&p.operator!=="between"&&h.addAttribute("operator",p.operator),p.allowBlank&&h.addAttribute("allowBlank","1")),p.showInputMessage&&h.addAttribute("showInputMessage","1"),p.promptTitle&&h.addAttribute("promptTitle",p.promptTitle),p.prompt&&h.addAttribute("prompt",p.prompt),p.showErrorMessage&&h.addAttribute("showErrorMessage","1"),p.errorStyle&&h.addAttribute("errorStyle",p.errorStyle),p.errorTitle&&h.addAttribute("errorTitle",p.errorTitle),p.error&&h.addAttribute("error",p.error),h.addAttribute("sqref",p.sqref),(p.formulae||[]).forEach((g,v)=>{h.openNode("formula"+(v+1)),p.type==="date"?h.writeText(o.dateToExcel(new Date(g))):h.writeText(g),h.closeNode()}),h.closeNode()}),h.closeNode())}parseOpen(h){switch(h.name){case"dataValidations":return this.model={},!0;case"dataValidation":{this._address=h.attributes.sqref;const f={type:h.attributes.type||"any",formulae:[]};switch(h.attributes.type&&d(f,h.attributes,"allowBlank"),d(f,h.attributes,"showInputMessage"),d(f,h.attributes,"showErrorMessage"),f.type){case"any":case"list":case"custom":break;default:c(f,h.attributes,"operator","between")}return c(f,h.attributes,"promptTitle"),c(f,h.attributes,"prompt"),c(f,h.attributes,"errorStyle"),c(f,h.attributes,"errorTitle"),c(f,h.attributes,"error"),this._dataValidation=f,!0}case"formula1":case"formula2":return this._formula=[],!0;default:return!1}}parseText(h){this._formula&&this._formula.push(h)}parseClose(h){switch(h){case"dataValidations":return!1;case"dataValidation":return this._dataValidation.formulae&&this._dataValidation.formulae.length||(delete this._dataValidation.formulae,delete this._dataValidation.operator),(this._address.split(/\s+/g)||[]).forEach(f=>{f.includes(":")?new u(f).forEachAddress(m=>{this.model[m]=this._dataValidation}):this.model[f]=this._dataValidation}),!0;case"formula1":case"formula2":{let f=this._formula.join("");switch(this._dataValidation.type){case"whole":case"textLength":f=parseInt(f,10);break;case"decimal":f=parseFloat(f);break;case"date":f=o.excelToDate(parseFloat(f))}return this._dataValidation.formulae.push(f),this._formula=void 0,!0}default:return!0}}}},{"../../../doc/range":10,"../../../utils/col-cache":19,"../../../utils/under-dash":26,"../../../utils/utils":27,"../base-xform":32}],94:[function(t,n,i){const s=t("../base-xform");n.exports=class extends s{get tag(){return"dimension"}render(o,a){a&&o.leafNode("dimension",{ref:a})}parseOpen(o){return o.name==="dimension"&&(this.model=o.attributes.ref,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],95:[function(t,n,i){const s=t("../base-xform");n.exports=class extends s{get tag(){return"drawing"}render(o,a){a&&o.leafNode(this.tag,{"r:id":a.rId})}parseOpen(o){return o.name===this.tag?(this.model={rId:o.attributes["r:id"]},!0):!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],96:[function(t,n,i){const s=t("../composite-xform"),o=t("./cf-ext/conditional-formattings-ext-xform");class a extends s{constructor(){super(),this.map={"x14:conditionalFormattings":this.conditionalFormattings=new o}}get tag(){return"ext"}hasContent(u){return this.conditionalFormattings.hasContent(u.conditionalFormattings)}prepare(u,c){this.conditionalFormattings.prepare(u.conditionalFormattings,c)}render(u,c){u.openNode("ext",{uri:"{78C0D931-6437-407d-A8EE-F0AAD7539E65}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"}),this.conditionalFormattings.render(u,c.conditionalFormattings),u.closeNode()}createNewModel(){return{}}onParserClose(u,c){this.model[u]=c.model}}n.exports=class extends s{constructor(){super(),this.map={ext:this.ext=new a}}get tag(){return"extLst"}prepare(l,u){this.ext.prepare(l,u)}hasContent(l){return this.ext.hasContent(l)}render(l,u){this.hasContent(u)&&(l.openNode("extLst"),this.ext.render(l,u),l.closeNode())}createNewModel(){return{}}onParserClose(l,u){Object.assign(this.model,u.model)}}},{"../composite-xform":48,"./cf-ext/conditional-formattings-ext-xform":78}],97:[function(t,n,i){const s=t("../base-xform");n.exports=class extends s{get tag(){return"headerFooter"}render(o,a){if(a){o.addRollback();let l=!1;o.openNode("headerFooter"),a.differentFirst&&(o.addAttribute("differentFirst","1"),l=!0),a.differentOddEven&&(o.addAttribute("differentOddEven","1"),l=!0),a.oddHeader&&typeof a.oddHeader=="string"&&(o.leafNode("oddHeader",null,a.oddHeader),l=!0),a.oddFooter&&typeof a.oddFooter=="string"&&(o.leafNode("oddFooter",null,a.oddFooter),l=!0),a.evenHeader&&typeof a.evenHeader=="string"&&(o.leafNode("evenHeader",null,a.evenHeader),l=!0),a.evenFooter&&typeof a.evenFooter=="string"&&(o.leafNode("evenFooter",null,a.evenFooter),l=!0),a.firstHeader&&typeof a.firstHeader=="string"&&(o.leafNode("firstHeader",null,a.firstHeader),l=!0),a.firstFooter&&typeof a.firstFooter=="string"&&(o.leafNode("firstFooter",null,a.firstFooter),l=!0),l?(o.closeNode(),o.commit()):o.rollback()}}parseOpen(o){switch(o.name){case"headerFooter":return this.model={},o.attributes.differentFirst&&(this.model.differentFirst=parseInt(o.attributes.differentFirst,0)===1),o.attributes.differentOddEven&&(this.model.differentOddEven=parseInt(o.attributes.differentOddEven,0)===1),!0;case"oddHeader":return this.currentNode="oddHeader",!0;case"oddFooter":return this.currentNode="oddFooter",!0;case"evenHeader":return this.currentNode="evenHeader",!0;case"evenFooter":return this.currentNode="evenFooter",!0;case"firstHeader":return this.currentNode="firstHeader",!0;case"firstFooter":return this.currentNode="firstFooter",!0;default:return!1}}parseText(o){switch(this.currentNode){case"oddHeader":this.model.oddHeader=o;break;case"oddFooter":this.model.oddFooter=o;break;case"evenHeader":this.model.evenHeader=o;break;case"evenFooter":this.model.evenFooter=o;break;case"firstHeader":this.model.firstHeader=o;break;case"firstFooter":this.model.firstFooter=o}}parseClose(){switch(this.currentNode){case"oddHeader":case"oddFooter":case"evenHeader":case"evenFooter":case"firstHeader":case"firstFooter":return this.currentNode=void 0,!0;default:return!1}}}},{"../base-xform":32}],98:[function(t,n,i){const s=t("../base-xform");n.exports=class extends s{get tag(){return"hyperlink"}render(o,a){this.isInternalLink(a)?o.leafNode("hyperlink",{ref:a.address,"r:id":a.rId,tooltip:a.tooltip,location:a.target}):o.leafNode("hyperlink",{ref:a.address,"r:id":a.rId,tooltip:a.tooltip})}parseOpen(o){return o.name==="hyperlink"&&(this.model={address:o.attributes.ref,rId:o.attributes["r:id"],tooltip:o.attributes.tooltip},o.attributes.location&&(this.model.target=o.attributes.location),!0)}parseText(){}parseClose(){return!1}isInternalLink(o){return o.target&&/^[^!]+![a-zA-Z]+[\d]+$/.test(o.target)}}},{"../base-xform":32}],99:[function(t,n,i){const s=t("../base-xform");n.exports=class extends s{get tag(){return"mergeCell"}render(o,a){o.leafNode("mergeCell",{ref:a})}parseOpen(o){return o.name==="mergeCell"&&(this.model=o.attributes.ref,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],100:[function(t,n,i){const s=t("../../../utils/under-dash"),o=t("../../../doc/range"),a=t("../../../utils/col-cache"),l=t("../../../doc/enums");n.exports=class{constructor(){this.merges={}}add(u){if(this.merges[u.master])this.merges[u.master].expandToAddress(u.address);else{const c=`${u.master}:${u.address}`;this.merges[u.master]=new o(c)}}get mergeCells(){return s.map(this.merges,u=>u.range)}reconcile(u,c){s.each(u,d=>{const h=a.decode(d);for(let f=h.top;f<=h.bottom;f++){const m=c[f-1];for(let p=h.left;p<=h.right;p++){const g=m.cells[p-1];g?g.type===l.ValueType.Merge&&(g.master=h.tl):m.cells[p]={type:l.ValueType.Null,address:a.encodeAddress(f,p)}}}})}getMasterAddress(u){const c=this.hash[u];return c&&c.tl}}},{"../../../doc/enums":7,"../../../doc/range":10,"../../../utils/col-cache":19,"../../../utils/under-dash":26}],101:[function(t,n,i){const s=t("../base-xform"),o=a=>a!==void 0;n.exports=class extends s{get tag(){return"outlinePr"}render(a,l){return!(!l||!o(l.summaryBelow)&&!o(l.summaryRight))&&(a.leafNode(this.tag,{summaryBelow:o(l.summaryBelow)?Number(l.summaryBelow):void 0,summaryRight:o(l.summaryRight)?Number(l.summaryRight):void 0}),!0)}parseOpen(a){return a.name===this.tag&&(this.model={summaryBelow:o(a.attributes.summaryBelow)?!!Number(a.attributes.summaryBelow):void 0,summaryRight:o(a.attributes.summaryRight)?!!Number(a.attributes.summaryRight):void 0},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],102:[function(t,n,i){const s=t("../base-xform");n.exports=class extends s{get tag(){return"brk"}render(o,a){o.leafNode("brk",a)}parseOpen(o){return o.name==="brk"&&(this.model=o.attributes.ref,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],103:[function(t,n,i){const s=t("../../../utils/under-dash"),o=t("../base-xform");n.exports=class extends o{get tag(){return"pageMargins"}render(a,l){if(l){const u={left:l.left,right:l.right,top:l.top,bottom:l.bottom,header:l.header,footer:l.footer};s.some(u,c=>c!==void 0)&&a.leafNode(this.tag,u)}}parseOpen(a){return a.name===this.tag?(this.model={left:parseFloat(a.attributes.left||.7),right:parseFloat(a.attributes.right||.7),top:parseFloat(a.attributes.top||.75),bottom:parseFloat(a.attributes.bottom||.75),header:parseFloat(a.attributes.header||.3),footer:parseFloat(a.attributes.footer||.3)},!0):!1}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],104:[function(t,n,i){const s=t("../base-xform");n.exports=class extends s{get tag(){return"pageSetUpPr"}render(o,a){return!(!a||!a.fitToPage)&&(o.leafNode(this.tag,{fitToPage:a.fitToPage?"1":void 0}),!0)}parseOpen(o){return o.name===this.tag&&(this.model={fitToPage:o.attributes.fitToPage==="1"},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],105:[function(t,n,i){const s=t("../../../utils/under-dash"),o=t("../base-xform");function a(d){return d?"1":void 0}function l(d){if(d==="overThenDown")return d}function u(d){switch(d){case"atEnd":case"asDisplyed":return d;default:return}}function c(d){switch(d){case"dash":case"blank":case"NA":return d;default:return}}n.exports=class extends o{get tag(){return"pageSetup"}render(d,h){if(h){const f={paperSize:h.paperSize,orientation:h.orientation,horizontalDpi:h.horizontalDpi,verticalDpi:h.verticalDpi,pageOrder:l(h.pageOrder),blackAndWhite:a(h.blackAndWhite),draft:a(h.draft),cellComments:u(h.cellComments),errors:c(h.errors),scale:h.scale,fitToWidth:h.fitToWidth,fitToHeight:h.fitToHeight,firstPageNumber:h.firstPageNumber,useFirstPageNumber:a(h.firstPageNumber),usePrinterDefaults:a(h.usePrinterDefaults),copies:h.copies};s.some(f,m=>m!==void 0)&&d.leafNode(this.tag,f)}}parseOpen(d){if(d.name===this.tag)return this.model={paperSize:(h=d.attributes.paperSize,h!==void 0?parseInt(h,10):void 0),orientation:d.attributes.orientation||"portrait",horizontalDpi:parseInt(d.attributes.horizontalDpi||"4294967295",10),verticalDpi:parseInt(d.attributes.verticalDpi||"4294967295",10),pageOrder:d.attributes.pageOrder||"downThenOver",blackAndWhite:d.attributes.blackAndWhite==="1",draft:d.attributes.draft==="1",cellComments:d.attributes.cellComments||"None",errors:d.attributes.errors||"displayed",scale:parseInt(d.attributes.scale||"100",10),fitToWidth:parseInt(d.attributes.fitToWidth||"1",10),fitToHeight:parseInt(d.attributes.fitToHeight||"1",10),firstPageNumber:parseInt(d.attributes.firstPageNumber||"1",10),useFirstPageNumber:d.attributes.useFirstPageNumber==="1",usePrinterDefaults:d.attributes.usePrinterDefaults==="1",copies:parseInt(d.attributes.copies||"1",10)},!0;return!1;var h}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],106:[function(t,n,i){const s=t("../base-xform");n.exports=class extends s{get tag(){return"picture"}render(o,a){a&&o.leafNode(this.tag,{"r:id":a.rId})}parseOpen(o){return o.name===this.tag?(this.model={rId:o.attributes["r:id"]},!0):!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],107:[function(t,n,i){const s=t("../../../utils/under-dash"),o=t("../base-xform");function a(l){return l?"1":void 0}n.exports=class extends o{get tag(){return"printOptions"}render(l,u){if(u){const c={headings:a(u.showRowColHeaders),gridLines:a(u.showGridLines),horizontalCentered:a(u.horizontalCentered),verticalCentered:a(u.verticalCentered)};s.some(c,d=>d!==void 0)&&l.leafNode(this.tag,c)}}parseOpen(l){return l.name===this.tag?(this.model={showRowColHeaders:l.attributes.headings==="1",showGridLines:l.attributes.gridLines==="1",horizontalCentered:l.attributes.horizontalCentered==="1",verticalCentered:l.attributes.verticalCentered==="1"},!0):!1}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],108:[function(t,n,i){const s=t("./page-breaks-xform"),o=t("../list-xform");n.exports=class extends o{constructor(){super({tag:"rowBreaks",count:!0,childXform:new s})}render(a,l){if(l&&l.length){a.openNode(this.tag,this.$),this.count&&(a.addAttribute(this.$count,l.length),a.addAttribute("manualBreakCount",l.length));const{childXform:u}=this;l.forEach(c=>{u.render(a,c)}),a.closeNode()}else this.empty&&a.leafNode(this.tag)}}},{"../list-xform":71,"./page-breaks-xform":102}],109:[function(t,n,i){const s=t("../base-xform"),o=t("../../../utils/utils"),a=t("./cell-xform");n.exports=class extends s{constructor(l){super(),this.maxItems=l&&l.maxItems,this.map={c:new a}}get tag(){return"row"}prepare(l,u){const c=u.styles.addStyleModel(l.style);c&&(l.styleId=c);const d=this.map.c;l.cells.forEach(h=>{d.prepare(h,u)})}render(l,u,c){l.openNode("row"),l.addAttribute("r",u.number),u.height&&(l.addAttribute("ht",u.height),l.addAttribute("customHeight","1")),u.hidden&&l.addAttribute("hidden","1"),u.min>0&&u.max>0&&u.min<=u.max&&l.addAttribute("spans",`${u.min}:${u.max}`),u.styleId&&(l.addAttribute("s",u.styleId),l.addAttribute("customFormat","1")),l.addAttribute("x14ac:dyDescent","0.25"),u.outlineLevel&&l.addAttribute("outlineLevel",u.outlineLevel),u.collapsed&&l.addAttribute("collapsed","1");const d=this.map.c;u.cells.forEach(h=>{d.render(l,h,c)}),l.closeNode()}parseOpen(l){if(this.parser)return this.parser.parseOpen(l),!0;if(l.name==="row"){this.numRowsSeen+=1;const u=l.attributes.spans?l.attributes.spans.split(":").map(d=>parseInt(d,10)):[void 0,void 0],c=this.model={number:parseInt(l.attributes.r,10),min:u[0],max:u[1],cells:[]};return l.attributes.s&&(c.styleId=parseInt(l.attributes.s,10)),o.parseBoolean(l.attributes.hidden)&&(c.hidden=!0),o.parseBoolean(l.attributes.bestFit)&&(c.bestFit=!0),l.attributes.ht&&(c.height=parseFloat(l.attributes.ht)),l.attributes.outlineLevel&&(c.outlineLevel=parseInt(l.attributes.outlineLevel,10)),o.parseBoolean(l.attributes.collapsed)&&(c.collapsed=!0),!0}return this.parser=this.map[l.name],!!this.parser&&(this.parser.parseOpen(l),!0)}parseText(l){this.parser&&this.parser.parseText(l)}parseClose(l){if(this.parser){if(!this.parser.parseClose(l)){if(this.model.cells.push(this.parser.model),this.maxItems&&this.model.cells.length>this.maxItems)throw new Error(`Max column count (${this.maxItems}) exceeded`);this.parser=void 0}return!0}return!1}reconcile(l,u){l.style=l.styleId?u.styles.getStyleModel(l.styleId):{},l.styleId!==void 0&&(l.styleId=void 0);const c=this.map.c;l.cells.forEach(d=>{c.reconcile(d,u)})}}},{"../../../utils/utils":27,"../base-xform":32,"./cell-xform":73}],110:[function(t,n,i){const s=t("../../../utils/under-dash"),o=t("../base-xform");n.exports=class extends o{get tag(){return"sheetFormatPr"}render(a,l){if(l){const u={defaultRowHeight:l.defaultRowHeight,outlineLevelRow:l.outlineLevelRow,outlineLevelCol:l.outlineLevelCol,"x14ac:dyDescent":l.dyDescent};l.defaultColWidth&&(u.defaultColWidth=l.defaultColWidth),l.defaultRowHeight&&l.defaultRowHeight===15||(u.customHeight="1"),s.some(u,c=>c!==void 0)&&a.leafNode("sheetFormatPr",u)}}parseOpen(a){return a.name==="sheetFormatPr"&&(this.model={defaultRowHeight:parseFloat(a.attributes.defaultRowHeight||"0"),dyDescent:parseFloat(a.attributes["x14ac:dyDescent"]||"0"),outlineLevelRow:parseInt(a.attributes.outlineLevelRow||"0",10),outlineLevelCol:parseInt(a.attributes.outlineLevelCol||"0",10)},a.attributes.defaultColWidth&&(this.model.defaultColWidth=parseFloat(a.attributes.defaultColWidth)),!0)}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],111:[function(t,n,i){const s=t("../base-xform"),o=t("../style/color-xform"),a=t("./page-setup-properties-xform"),l=t("./outline-properties-xform");n.exports=class extends s{constructor(){super(),this.map={tabColor:new o("tabColor"),pageSetUpPr:new a,outlinePr:new l}}get tag(){return"sheetPr"}render(u,c){if(c){u.addRollback(),u.openNode("sheetPr");let d=!1;d=this.map.tabColor.render(u,c.tabColor)||d,d=this.map.pageSetUpPr.render(u,c.pageSetup)||d,d=this.map.outlinePr.render(u,c.outlineProperties)||d,d?(u.closeNode(),u.commit()):u.rollback()}}parseOpen(u){return this.parser?(this.parser.parseOpen(u),!0):u.name===this.tag?(this.reset(),!0):!!this.map[u.name]&&(this.parser=this.map[u.name],this.parser.parseOpen(u),!0)}parseText(u){return!!this.parser&&(this.parser.parseText(u),!0)}parseClose(u){return this.parser?(this.parser.parseClose(u)||(this.parser=void 0),!0):(this.map.tabColor.model||this.map.pageSetUpPr.model||this.map.outlinePr.model?(this.model={},this.map.tabColor.model&&(this.model.tabColor=this.map.tabColor.model),this.map.pageSetUpPr.model&&(this.model.pageSetup=this.map.pageSetUpPr.model),this.map.outlinePr.model&&(this.model.outlineProperties=this.map.outlinePr.model)):this.model=null,!1)}}},{"../base-xform":32,"../style/color-xform":128,"./outline-properties-xform":101,"./page-setup-properties-xform":104}],112:[function(t,n,i){const s=t("../../../utils/under-dash"),o=t("../base-xform");function a(u,c){return u?c:void 0}function l(u,c){return u===c||void 0}n.exports=class extends o{get tag(){return"sheetProtection"}render(u,c){if(c){const d={sheet:a(c.sheet,"1"),selectLockedCells:c.selectLockedCells===!1?"1":void 0,selectUnlockedCells:c.selectUnlockedCells===!1?"1":void 0,formatCells:a(c.formatCells,"0"),formatColumns:a(c.formatColumns,"0"),formatRows:a(c.formatRows,"0"),insertColumns:a(c.insertColumns,"0"),insertRows:a(c.insertRows,"0"),insertHyperlinks:a(c.insertHyperlinks,"0"),deleteColumns:a(c.deleteColumns,"0"),deleteRows:a(c.deleteRows,"0"),sort:a(c.sort,"0"),autoFilter:a(c.autoFilter,"0"),pivotTables:a(c.pivotTables,"0")};c.sheet&&(d.algorithmName=c.algorithmName,d.hashValue=c.hashValue,d.saltValue=c.saltValue,d.spinCount=c.spinCount,d.objects=a(c.objects===!1,"1"),d.scenarios=a(c.scenarios===!1,"1")),s.some(d,h=>h!==void 0)&&u.leafNode(this.tag,d)}}parseOpen(u){return u.name===this.tag?(this.model={sheet:l(u.attributes.sheet,"1"),objects:u.attributes.objects!=="1"&&void 0,scenarios:u.attributes.scenarios!=="1"&&void 0,selectLockedCells:u.attributes.selectLockedCells!=="1"&&void 0,selectUnlockedCells:u.attributes.selectUnlockedCells!=="1"&&void 0,formatCells:l(u.attributes.formatCells,"0"),formatColumns:l(u.attributes.formatColumns,"0"),formatRows:l(u.attributes.formatRows,"0"),insertColumns:l(u.attributes.insertColumns,"0"),insertRows:l(u.attributes.insertRows,"0"),insertHyperlinks:l(u.attributes.insertHyperlinks,"0"),deleteColumns:l(u.attributes.deleteColumns,"0"),deleteRows:l(u.attributes.deleteRows,"0"),sort:l(u.attributes.sort,"0"),autoFilter:l(u.attributes.autoFilter,"0"),pivotTables:l(u.attributes.pivotTables,"0")},u.attributes.algorithmName&&(this.model.algorithmName=u.attributes.algorithmName,this.model.hashValue=u.attributes.hashValue,this.model.saltValue=u.attributes.saltValue,this.model.spinCount=parseInt(u.attributes.spinCount,10)),!0):!1}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],113:[function(t,n,i){const s=t("../../../utils/col-cache"),o=t("../base-xform"),a={frozen:"frozen",frozenSplit:"frozen",split:"split"};n.exports=class extends o{get tag(){return"sheetView"}prepare(l){switch(l.state){case"frozen":case"split":break;default:l.state="normal"}}render(l,u){l.openNode("sheetView",{workbookViewId:u.workbookViewId||0});const c=function(p,g,v){v&&l.addAttribute(p,g)};let d,h,f,m;switch(c("rightToLeft","1",u.rightToLeft===!0),c("tabSelected","1",u.tabSelected),c("showRuler","0",u.showRuler===!1),c("showRowColHeaders","0",u.showRowColHeaders===!1),c("showGridLines","0",u.showGridLines===!1),c("zoomScale",u.zoomScale,u.zoomScale),c("zoomScaleNormal",u.zoomScaleNormal,u.zoomScaleNormal),c("view",u.style,u.style),u.state){case"frozen":h=u.xSplit||0,f=u.ySplit||0,d=u.topLeftCell||s.getAddress(f+1,h+1).address,m=(u.xSplit&&u.ySplit?"bottomRight":u.xSplit&&"topRight")||"bottomLeft",l.leafNode("pane",{xSplit:u.xSplit||void 0,ySplit:u.ySplit||void 0,topLeftCell:d,activePane:m,state:"frozen"}),l.leafNode("selection",{pane:m,activeCell:u.activeCell,sqref:u.activeCell});break;case"split":u.activePane==="topLeft"&&(u.activePane=void 0),l.leafNode("pane",{xSplit:u.xSplit||void 0,ySplit:u.ySplit||void 0,topLeftCell:u.topLeftCell,activePane:u.activePane}),l.leafNode("selection",{pane:u.activePane,activeCell:u.activeCell,sqref:u.activeCell});break;case"normal":u.activeCell&&l.leafNode("selection",{activeCell:u.activeCell,sqref:u.activeCell})}l.closeNode()}parseOpen(l){switch(l.name){case"sheetView":return this.sheetView={workbookViewId:parseInt(l.attributes.workbookViewId,10),rightToLeft:l.attributes.rightToLeft==="1",tabSelected:l.attributes.tabSelected==="1",showRuler:l.attributes.showRuler!=="0",showRowColHeaders:l.attributes.showRowColHeaders!=="0",showGridLines:l.attributes.showGridLines!=="0",zoomScale:parseInt(l.attributes.zoomScale||"100",10),zoomScaleNormal:parseInt(l.attributes.zoomScaleNormal||"100",10),style:l.attributes.view},this.pane=void 0,this.selections={},!0;case"pane":return this.pane={xSplit:parseInt(l.attributes.xSplit||"0",10),ySplit:parseInt(l.attributes.ySplit||"0",10),topLeftCell:l.attributes.topLeftCell,activePane:l.attributes.activePane||"topLeft",state:l.attributes.state},!0;case"selection":{const u=l.attributes.pane||"topLeft";return this.selections[u]={pane:u,activeCell:l.attributes.activeCell},!0}default:return!1}}parseText(){}parseClose(l){let u,c;return l==="sheetView"?(this.sheetView&&this.pane?(u=this.model={workbookViewId:this.sheetView.workbookViewId,rightToLeft:this.sheetView.rightToLeft,state:a[this.pane.state]||"split",xSplit:this.pane.xSplit,ySplit:this.pane.ySplit,topLeftCell:this.pane.topLeftCell,showRuler:this.sheetView.showRuler,showRowColHeaders:this.sheetView.showRowColHeaders,showGridLines:this.sheetView.showGridLines,zoomScale:this.sheetView.zoomScale,zoomScaleNormal:this.sheetView.zoomScaleNormal},this.model.state==="split"&&(u.activePane=this.pane.activePane),c=this.selections[this.pane.activePane],c&&c.activeCell&&(u.activeCell=c.activeCell),this.sheetView.style&&(u.style=this.sheetView.style)):(u=this.model={workbookViewId:this.sheetView.workbookViewId,rightToLeft:this.sheetView.rightToLeft,state:"normal",showRuler:this.sheetView.showRuler,showRowColHeaders:this.sheetView.showRowColHeaders,showGridLines:this.sheetView.showGridLines,zoomScale:this.sheetView.zoomScale,zoomScaleNormal:this.sheetView.zoomScaleNormal},c=this.selections.topLeft,c&&c.activeCell&&(u.activeCell=c.activeCell),this.sheetView.style&&(u.style=this.sheetView.style)),!1):!0}reconcile(){}}},{"../../../utils/col-cache":19,"../base-xform":32}],114:[function(t,n,i){const s=t("../base-xform");n.exports=class extends s{get tag(){return"tablePart"}render(o,a){a&&o.leafNode(this.tag,{"r:id":a.rId})}parseOpen(o){return o.name===this.tag?(this.model={rId:o.attributes["r:id"]},!0):!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],115:[function(t,n,i){const s=t("../../../utils/under-dash"),o=t("../../../utils/col-cache"),a=t("../../../utils/xml-stream"),l=t("../../rel-type"),u=t("./merges"),c=t("../base-xform"),d=t("../list-xform"),h=t("./row-xform"),f=t("./col-xform"),m=t("./dimension-xform"),p=t("./hyperlink-xform"),g=t("./merge-cell-xform"),v=t("./data-validations-xform"),y=t("./sheet-properties-xform"),b=t("./sheet-format-properties-xform"),E=t("./sheet-view-xform"),A=t("./sheet-protection-xform"),M=t("./page-margins-xform"),L=t("./page-setup-xform"),k=t("./print-options-xform"),P=t("./auto-filter-xform"),U=t("./picture-xform"),$=t("./drawing-xform"),V=t("./table-part-xform"),R=t("./row-breaks-xform"),O=t("./header-footer-xform"),T=t("./cf/conditional-formattings-xform"),w=t("./ext-lst-xform"),x=(S,C)=>{if(!C||!C.length)return S;if(!S||!S.length)return C;const F={},D={};return S.forEach(H=>{F[H.ref]=H,H.rules.forEach(G=>{const{x14Id:ee}=G;ee&&(D[ee]=G)})}),C.forEach(H=>{H.rules.forEach(G=>{const ee=D[G.x14Id];ee?((B,X)=>{Object.keys(X).forEach(I=>{const N=B[I],j=X[I];N===void 0&&j!==void 0&&(B[I]=j)})})(ee,G):F[H.ref]?F[H.ref].rules.push(G):S.push({ref:H.ref,rules:[G]})})}),S};class _ extends c{constructor(C){super();const{maxRows:F,maxCols:D,ignoreNodes:H}=C||{};this.ignoreNodes=H||[],this.map={sheetPr:new y,dimension:new m,sheetViews:new d({tag:"sheetViews",count:!1,childXform:new E}),sheetFormatPr:new b,cols:new d({tag:"cols",count:!1,childXform:new f}),sheetData:new d({tag:"sheetData",count:!1,empty:!0,childXform:new h({maxItems:D}),maxItems:F}),autoFilter:new P,mergeCells:new d({tag:"mergeCells",count:!0,childXform:new g}),rowBreaks:new R,hyperlinks:new d({tag:"hyperlinks",count:!1,childXform:new p}),pageMargins:new M,dataValidations:new v,pageSetup:new L,headerFooter:new O,printOptions:new k,picture:new U,drawing:new $,sheetProtection:new A,tableParts:new d({tag:"tableParts",count:!0,childXform:new V}),conditionalFormatting:new T,extLst:new w}}prepare(C,F){F.merges=new u,C.hyperlinks=F.hyperlinks=[],C.comments=F.comments=[],F.formulae={},F.siFormulae=0,this.map.cols.prepare(C.cols,F),this.map.sheetData.prepare(C.rows,F),this.map.conditionalFormatting.prepare(C.conditionalFormattings,F),C.mergeCells=F.merges.mergeCells;const D=C.rels=[];function H(B){return"rId"+(B.length+1)}if(C.hyperlinks.forEach(B=>{const X=H(D);B.rId=X,D.push({Id:X,Type:l.Hyperlink,Target:B.target,TargetMode:"External"})}),C.comments.length>0){const B={Id:H(D),Type:l.Comments,Target:`../comments${C.id}.xml`};D.push(B);const X={Id:H(D),Type:l.VmlDrawing,Target:`../drawings/vmlDrawing${C.id}.vml`};D.push(X),C.comments.forEach(I=>{I.refAddress=o.decodeAddress(I.ref)}),F.commentRefs.push({commentName:"comments"+C.id,vmlDrawing:"vmlDrawing"+C.id})}const G=[];let ee;C.media.forEach(B=>{if(B.type==="background"){const X=H(D);ee=F.media[B.imageId],D.push({Id:X,Type:l.Image,Target:`../media/${ee.name}.${ee.extension}`}),C.background={rId:X},C.image=F.media[B.imageId]}else if(B.type==="image"){let{drawing:X}=C;ee=F.media[B.imageId],X||(X=C.drawing={rId:H(D),name:"drawing"+ ++F.drawingsCount,anchors:[],rels:[]},F.drawings.push(X),D.push({Id:X.rId,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",Target:`../drawings/${X.name}.xml`}));let I=this.preImageId===B.imageId?G[B.imageId]:G[X.rels.length];I||(I=H(X.rels),G[X.rels.length]=I,X.rels.push({Id:I,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",Target:`../media/${ee.name}.${ee.extension}`}));const N={picture:{rId:I},range:B.range};if(B.hyperlinks&&B.hyperlinks.hyperlink){const j=H(X.rels);G[X.rels.length]=j,N.picture.hyperlinks={tooltip:B.hyperlinks.tooltip,rId:j},X.rels.push({Id:j,Type:l.Hyperlink,Target:B.hyperlinks.hyperlink,TargetMode:"External"})}this.preImageId=B.imageId,X.anchors.push(N)}}),C.tables.forEach(B=>{const X=H(D);B.rId=X,D.push({Id:X,Type:l.Table,Target:"../tables/"+B.target}),B.columns.forEach(I=>{const{style:N}=I;N&&(I.dxfId=F.styles.addDxfStyle(N))})}),this.map.extLst.prepare(C,F)}render(C,F){C.openXml(a.StdDocAttributes),C.openNode("worksheet",_.WORKSHEET_ATTRIBUTES);const D=F.properties?{defaultRowHeight:F.properties.defaultRowHeight,dyDescent:F.properties.dyDescent,outlineLevelCol:F.properties.outlineLevelCol,outlineLevelRow:F.properties.outlineLevelRow}:void 0;F.properties&&F.properties.defaultColWidth&&(D.defaultColWidth=F.properties.defaultColWidth);const H={outlineProperties:F.properties&&F.properties.outlineProperties,tabColor:F.properties&&F.properties.tabColor,pageSetup:F.pageSetup&&F.pageSetup.fitToPage?{fitToPage:F.pageSetup.fitToPage}:void 0},G=F.pageSetup&&F.pageSetup.margins,ee={showRowColHeaders:F.pageSetup&&F.pageSetup.showRowColHeaders,showGridLines:F.pageSetup&&F.pageSetup.showGridLines,horizontalCentered:F.pageSetup&&F.pageSetup.horizontalCentered,verticalCentered:F.pageSetup&&F.pageSetup.verticalCentered},B=F.sheetProtection;this.map.sheetPr.render(C,H),this.map.dimension.render(C,F.dimensions),this.map.sheetViews.render(C,F.views),this.map.sheetFormatPr.render(C,D),this.map.cols.render(C,F.cols),this.map.sheetData.render(C,F.rows),this.map.sheetProtection.render(C,B),this.map.autoFilter.render(C,F.autoFilter),this.map.mergeCells.render(C,F.mergeCells),this.map.conditionalFormatting.render(C,F.conditionalFormattings),this.map.dataValidations.render(C,F.dataValidations),this.map.hyperlinks.render(C,F.hyperlinks),this.map.printOptions.render(C,ee),this.map.pageMargins.render(C,G),this.map.pageSetup.render(C,F.pageSetup),this.map.headerFooter.render(C,F.headerFooter),this.map.rowBreaks.render(C,F.rowBreaks),this.map.drawing.render(C,F.drawing),this.map.picture.render(C,F.background),this.map.tableParts.render(C,F.tables),this.map.extLst.render(C,F),F.rels&&F.rels.forEach(X=>{X.Type===l.VmlDrawing&&C.leafNode("legacyDrawing",{"r:id":X.Id})}),C.closeNode()}parseOpen(C){return this.parser?(this.parser.parseOpen(C),!0):C.name==="worksheet"?(s.each(this.map,F=>{F.reset()}),!0):(this.map[C.name]&&!this.ignoreNodes.includes(C.name)&&(this.parser=this.map[C.name],this.parser.parseOpen(C)),!0)}parseText(C){this.parser&&this.parser.parseText(C)}parseClose(C){if(this.parser)return this.parser.parseClose(C)||(this.parser=void 0),!0;if(C==="worksheet"){const F=this.map.sheetFormatPr.model||{};this.map.sheetPr.model&&this.map.sheetPr.model.tabColor&&(F.tabColor=this.map.sheetPr.model.tabColor),this.map.sheetPr.model&&this.map.sheetPr.model.outlineProperties&&(F.outlineProperties=this.map.sheetPr.model.outlineProperties);const D={fitToPage:this.map.sheetPr.model&&this.map.sheetPr.model.pageSetup&&this.map.sheetPr.model.pageSetup.fitToPage||!1,margins:this.map.pageMargins.model},H=Object.assign(D,this.map.pageSetup.model,this.map.printOptions.model),G=x(this.map.conditionalFormatting.model,this.map.extLst.model&&this.map.extLst.model["x14:conditionalFormattings"]);return this.model={dimensions:this.map.dimension.model,cols:this.map.cols.model,rows:this.map.sheetData.model,mergeCells:this.map.mergeCells.model,hyperlinks:this.map.hyperlinks.model,dataValidations:this.map.dataValidations.model,properties:F,views:this.map.sheetViews.model,pageSetup:H,headerFooter:this.map.headerFooter.model,background:this.map.picture.model,drawing:this.map.drawing.model,tables:this.map.tableParts.model,conditionalFormattings:G},this.map.autoFilter.model&&(this.model.autoFilter=this.map.autoFilter.model),this.map.sheetProtection.model&&(this.model.sheetProtection=this.map.sheetProtection.model),!1}else return!0}reconcile(C,F){const D=(C.relationships||[]).reduce((G,ee)=>{if(G[ee.Id]=ee,ee.Type===l.Comments&&(C.comments=F.comments[ee.Target].comments),ee.Type===l.VmlDrawing&&C.comments&&C.comments.length){const B=F.vmlDrawings[ee.Target].comments;C.comments.forEach((X,I)=>{X.note=Object.assign({},X.note,B[I])})}return G},{});if(F.commentsMap=(C.comments||[]).reduce((G,ee)=>(ee.ref&&(G[ee.ref]=ee),G),{}),F.hyperlinkMap=(C.hyperlinks||[]).reduce((G,ee)=>(ee.rId&&(G[ee.address]=D[ee.rId].Target),G),{}),F.formulae={},C.rows=C.rows&&C.rows.filter(Boolean)||[],C.rows.forEach(G=>{G.cells=G.cells&&G.cells.filter(Boolean)||[]}),this.map.cols.reconcile(C.cols,F),this.map.sheetData.reconcile(C.rows,F),this.map.conditionalFormatting.reconcile(C.conditionalFormattings,F),C.media=[],C.drawing){const G=D[C.drawing.rId].Target.match(/\/drawings\/([a-zA-Z0-9]+)[.][a-zA-Z]{3,4}$/);if(G){const ee=G[1];F.drawings[ee].anchors.forEach(B=>{if(B.medium){const X={type:"image",imageId:B.medium.index,range:B.range,hyperlinks:B.picture.hyperlinks};C.media.push(X)}})}}const H=C.background&&D[C.background.rId];if(H){const G=H.Target.split("/media/")[1],ee=F.mediaIndex&&F.mediaIndex[G];ee!==void 0&&C.media.push({type:"background",imageId:ee})}C.tables=(C.tables||[]).map(G=>{const ee=D[G.rId];return F.tables[ee.Target]}),delete C.relationships,delete C.hyperlinks,delete C.comments}}_.WORKSHEET_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x14ac","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"},n.exports=_},{"../../../utils/col-cache":19,"../../../utils/under-dash":26,"../../../utils/xml-stream":28,"../../rel-type":31,"../base-xform":32,"../list-xform":71,"./auto-filter-xform":72,"./cf/conditional-formattings-xform":87,"./col-xform":92,"./data-validations-xform":93,"./dimension-xform":94,"./drawing-xform":95,"./ext-lst-xform":96,"./header-footer-xform":97,"./hyperlink-xform":98,"./merge-cell-xform":99,"./merges":100,"./page-margins-xform":103,"./page-setup-xform":105,"./picture-xform":106,"./print-options-xform":107,"./row-breaks-xform":108,"./row-xform":109,"./sheet-format-properties-xform":110,"./sheet-properties-xform":111,"./sheet-protection-xform":112,"./sheet-view-xform":113,"./table-part-xform":114}],116:[function(t,n,i){const s=t("../base-xform");n.exports=class extends s{constructor(o){super(),this.tag=o.tag,this.attr=o.attr}render(o,a){a&&(o.openNode(this.tag),o.closeNode())}parseOpen(o){o.name===this.tag&&(this.model=!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],117:[function(t,n,i){const s=t("../base-xform");n.exports=class extends s{constructor(o){super(),this.tag=o.tag,this.attr=o.attr,this.attrs=o.attrs,this._format=o.format||function(a){try{return Number.isNaN(a.getTime())?"":a.toISOString()}catch{return""}},this._parse=o.parse||function(a){return new Date(a)}}render(o,a){a&&(o.openNode(this.tag),this.attrs&&o.addAttributes(this.attrs),this.attr?o.addAttribute(this.attr,this._format(a)):o.writeText(this._format(a)),o.closeNode())}parseOpen(o){o.name===this.tag&&(this.attr?this.model=this._parse(o.attributes[this.attr]):this.text=[])}parseText(o){this.attr||this.text.push(o)}parseClose(){return this.attr||(this.model=this._parse(this.text.join(""))),!1}}},{"../base-xform":32}],118:[function(t,n,i){const s=t("../base-xform");n.exports=class extends s{constructor(o){super(),this.tag=o.tag,this.attr=o.attr,this.attrs=o.attrs,this.zero=o.zero}render(o,a){(a||this.zero)&&(o.openNode(this.tag),this.attrs&&o.addAttributes(this.attrs),this.attr?o.addAttribute(this.attr,a):o.writeText(a),o.closeNode())}parseOpen(o){return o.name===this.tag&&(this.attr?this.model=parseInt(o.attributes[this.attr],10):this.text=[],!0)}parseText(o){this.attr||this.text.push(o)}parseClose(){return this.attr||(this.model=parseInt(this.text.join("")||0,10)),!1}}},{"../base-xform":32}],119:[function(t,n,i){const s=t("../base-xform");n.exports=class extends s{constructor(o){super(),this.tag=o.tag,this.attr=o.attr,this.attrs=o.attrs}render(o,a){a!==void 0&&(o.openNode(this.tag),this.attrs&&o.addAttributes(this.attrs),this.attr?o.addAttribute(this.attr,a):o.writeText(a),o.closeNode())}parseOpen(o){o.name===this.tag&&(this.attr?this.model=o.attributes[this.attr]:this.text=[])}parseText(o){this.attr||this.text.push(o)}parseClose(){return this.attr||(this.model=this.text.join("")),!1}}},{"../base-xform":32}],120:[function(t,n,i){const s=t("./base-xform"),o=t("../../utils/xml-stream");n.exports=class extends s{constructor(a){super(),this._model=a}render(a){if(!this._xml){const l=new o;(function u(c,d){c.openNode(d.tag,d.$),d.c&&d.c.forEach(h=>{u(c,h)}),d.t&&c.writeText(d.t),c.closeNode()})(l,this._model),this._xml=l.xml}a.writeXml(this._xml)}parseOpen(){return!0}parseText(){}parseClose(a){return a!==this._model.tag}}},{"../../utils/xml-stream":28,"./base-xform":32}],121:[function(t,n,i){const s=t("./text-xform"),o=t("./rich-text-xform"),a=t("../base-xform");n.exports=class extends a{constructor(){super(),this.map={r:new o,t:new s}}get tag(){return"rPh"}render(l,u){if(l.openNode(this.tag,{sb:u.sb||0,eb:u.eb||0}),u&&u.hasOwnProperty("richText")&&u.richText){const{r:c}=this.map;u.richText.forEach(d=>{c.render(l,d)})}else u&&this.map.t.render(l,u.text);l.closeNode()}parseOpen(l){const{name:u}=l;return this.parser?(this.parser.parseOpen(l),!0):u===this.tag?(this.model={sb:parseInt(l.attributes.sb,10),eb:parseInt(l.attributes.eb,10)},!0):(this.parser=this.map[u],!!this.parser&&(this.parser.parseOpen(l),!0))}parseText(l){this.parser&&this.parser.parseText(l)}parseClose(l){if(this.parser){if(!this.parser.parseClose(l)){switch(l){case"r":{let u=this.model.richText;u||(u=this.model.richText=[]),u.push(this.parser.model);break}case"t":this.model.text=this.parser.model}this.parser=void 0}return!0}return l!==this.tag}}},{"../base-xform":32,"./rich-text-xform":122,"./text-xform":125}],122:[function(t,n,i){const s=t("./text-xform"),o=t("../style/font-xform"),a=t("../base-xform");class l extends a{constructor(c){super(),this.model=c}get tag(){return"r"}get textXform(){return this._textXform||(this._textXform=new s)}get fontXform(){return this._fontXform||(this._fontXform=new o(l.FONT_OPTIONS))}render(c,d){d=d||this.model,c.openNode("r"),d.font&&this.fontXform.render(c,d.font),this.textXform.render(c,d.text),c.closeNode()}parseOpen(c){if(this.parser)return this.parser.parseOpen(c),!0;switch(c.name){case"r":return this.model={},!0;case"t":return this.parser=this.textXform,this.parser.parseOpen(c),!0;case"rPr":return this.parser=this.fontXform,this.parser.parseOpen(c),!0;default:return!1}}parseText(c){this.parser&&this.parser.parseText(c)}parseClose(c){switch(c){case"r":return!1;case"t":return this.model.text=this.parser.model,this.parser=void 0,!0;case"rPr":return this.model.font=this.parser.model,this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(c),!0}}}l.FONT_OPTIONS={tagName:"rPr",fontNameTag:"rFont"},n.exports=l},{"../base-xform":32,"../style/font-xform":131,"./text-xform":125}],123:[function(t,n,i){const s=t("./text-xform"),o=t("./rich-text-xform"),a=t("./phonetic-text-xform"),l=t("../base-xform");n.exports=class extends l{constructor(u){super(),this.model=u,this.map={r:new o,t:new s,rPh:new a}}get tag(){return"si"}render(u,c){u.openNode(this.tag),c&&c.hasOwnProperty("richText")&&c.richText?c.richText.length?c.richText.forEach(d=>{this.map.r.render(u,d)}):this.map.t.render(u,""):c!=null&&this.map.t.render(u,c),u.closeNode()}parseOpen(u){const{name:c}=u;return this.parser?(this.parser.parseOpen(u),!0):c===this.tag?(this.model={},!0):(this.parser=this.map[c],!!this.parser&&(this.parser.parseOpen(u),!0))}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){if(this.parser){if(!this.parser.parseClose(u)){switch(u){case"r":{let c=this.model.richText;c||(c=this.model.richText=[]),c.push(this.parser.model);break}case"t":this.model=this.parser.model}this.parser=void 0}return!0}return u!==this.tag}}},{"../base-xform":32,"./phonetic-text-xform":121,"./rich-text-xform":122,"./text-xform":125}],124:[function(t,n,i){const s=t("../../../utils/xml-stream"),o=t("../base-xform"),a=t("./shared-string-xform");n.exports=class extends o{constructor(l){super(),this.model=l||{values:[],count:0},this.hash=Object.create(null),this.rich=Object.create(null)}get sharedStringXform(){return this._sharedStringXform||(this._sharedStringXform=new a)}get values(){return this.model.values}get uniqueCount(){return this.model.values.length}get count(){return this.model.count}getString(l){return this.model.values[l]}add(l){return l.richText?this.addRichText(l):this.addText(l)}addText(l){let u=this.hash[l];return u===void 0&&(u=this.hash[l]=this.model.values.length,this.model.values.push(l)),this.model.count++,u}addRichText(l){const u=this.sharedStringXform.toXml(l);let c=this.rich[u];return c===void 0&&(c=this.rich[u]=this.model.values.length,this.model.values.push(l)),this.model.count++,c}render(l,u){u=u||this._values,l.openXml(s.StdDocAttributes),l.openNode("sst",{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",count:u.count,uniqueCount:u.values.length});const c=this.sharedStringXform;u.values.forEach(d=>{c.render(l,d)}),l.closeNode()}parseOpen(l){if(this.parser)return this.parser.parseOpen(l),!0;switch(l.name){case"sst":return!0;case"si":return this.parser=this.sharedStringXform,this.parser.parseOpen(l),!0;default:throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(l))}}parseText(l){this.parser&&this.parser.parseText(l)}parseClose(l){if(this.parser)return this.parser.parseClose(l)||(this.model.values.push(this.parser.model),this.model.count++,this.parser=void 0),!0;if(l==="sst")return!1;throw new Error("Unexpected xml node in parseClose: "+l)}}},{"../../../utils/xml-stream":28,"../base-xform":32,"./shared-string-xform":123}],125:[function(t,n,i){const s=t("../base-xform");n.exports=class extends s{get tag(){return"t"}render(o,a){o.openNode("t"),/^\s|\n|\s$/.test(a)&&o.addAttribute("xml:space","preserve"),o.writeText(a),o.closeNode()}get model(){return this._text.join("").replace(/_x([0-9A-F]{4})_/g,(o,a)=>String.fromCharCode(parseInt(a,16)))}parseOpen(o){return o.name==="t"?(this._text=[],!0):!1}parseText(o){this._text.push(o)}parseClose(){return!1}}},{"../base-xform":32}],126:[function(t,n,i){const s=t("../../../doc/enums"),o=t("../../../utils/utils"),a=t("../base-xform"),l={horizontalValues:["left","center","right","fill","centerContinuous","distributed","justify"].reduce((c,d)=>(c[d]=!0,c),{}),horizontal(c){return this.horizontalValues[c]?c:void 0},verticalValues:["top","middle","bottom","distributed","justify"].reduce((c,d)=>(c[d]=!0,c),{}),vertical(c){return c==="middle"?"center":this.verticalValues[c]?c:void 0},wrapText:c=>!!c||void 0,shrinkToFit:c=>!!c||void 0,textRotation(c){return c==="vertical"||(c=o.validInt(c))>=-90&&c<=90?c:void 0},indent:c=>(c=o.validInt(c),Math.max(0,c)),readingOrder(c){switch(c){case"ltr":return s.ReadingOrder.LeftToRight;case"rtl":return s.ReadingOrder.RightToLeft;default:return}}},u={toXml(c){if(c=l.textRotation(c)){if(c==="vertical")return 255;const d=Math.round(c);if(d>=0&&d<=90)return d;if(d<0&&d>=-90)return 90-d}},toModel(c){const d=o.validInt(c);if(d!==void 0){if(d===255)return"vertical";if(d>=0&&d<=90)return d;if(d>90&&d<=180)return 90-d}}};n.exports=class extends a{get tag(){return"alignment"}render(c,d){c.addRollback(),c.openNode("alignment");let h=!1;function f(m,p){p&&(c.addAttribute(m,p),h=!0)}f("horizontal",l.horizontal(d.horizontal)),f("vertical",l.vertical(d.vertical)),f("wrapText",!!l.wrapText(d.wrapText)&&"1"),f("shrinkToFit",!!l.shrinkToFit(d.shrinkToFit)&&"1"),f("indent",l.indent(d.indent)),f("textRotation",u.toXml(d.textRotation)),f("readingOrder",l.readingOrder(d.readingOrder)),c.closeNode(),h?c.commit():c.rollback()}parseOpen(c){const d={};let h=!1;function f(m,p,g){m&&(d[p]=g,h=!0)}f(c.attributes.horizontal,"horizontal",c.attributes.horizontal),f(c.attributes.vertical,"vertical",c.attributes.vertical==="center"?"middle":c.attributes.vertical),f(c.attributes.wrapText,"wrapText",o.parseBoolean(c.attributes.wrapText)),f(c.attributes.shrinkToFit,"shrinkToFit",o.parseBoolean(c.attributes.shrinkToFit)),f(c.attributes.indent,"indent",parseInt(c.attributes.indent,10)),f(c.attributes.textRotation,"textRotation",u.toModel(c.attributes.textRotation)),f(c.attributes.readingOrder,"readingOrder",c.attributes.readingOrder==="2"?"rtl":"ltr"),this.model=h?d:null}parseText(){}parseClose(){return!1}}},{"../../../doc/enums":7,"../../../utils/utils":27,"../base-xform":32}],127:[function(t,n,i){const s=t("../base-xform"),o=t("../../../utils/utils"),a=t("./color-xform");class l extends s{constructor(c){super(),this.name=c,this.map={color:new a}}get tag(){return this.name}render(c,d,h){const f=d&&d.color||h||this.defaultColor;c.openNode(this.name),d&&d.style&&(c.addAttribute("style",d.style),f&&this.map.color.render(c,f)),c.closeNode()}parseOpen(c){if(this.parser)return this.parser.parseOpen(c),!0;switch(c.name){case this.name:{const{style:d}=c.attributes;return this.model=d?{style:d}:void 0,!0}case"color":return this.parser=this.map.color,this.parser.parseOpen(c),!0;default:return!1}}parseText(c){this.parser&&this.parser.parseText(c)}parseClose(c){return this.parser?(this.parser.parseClose(c)||(this.parser=void 0),!0):(c===this.name&&this.map.color.model&&(this.model||(this.model={}),this.model.color=this.map.color.model),!1)}validStyle(c){return l.validStyleValues[c]}}l.validStyleValues=["thin","dashed","dotted","dashDot","hair","dashDotDot","slantDashDot","mediumDashed","mediumDashDotDot","mediumDashDot","medium","double","thick"].reduce((u,c)=>(u[c]=!0,u),{}),n.exports=class extends s{constructor(){super(),this.map={top:new l("top"),left:new l("left"),bottom:new l("bottom"),right:new l("right"),diagonal:new l("diagonal")}}render(u,c){const{color:d}=c;function h(f,m){f&&!f.color&&c.color&&(f={...f,color:c.color}),m.render(u,f,d)}u.openNode("border"),c.diagonal&&c.diagonal.style&&(c.diagonal.up&&u.addAttribute("diagonalUp","1"),c.diagonal.down&&u.addAttribute("diagonalDown","1")),h(c.left,this.map.left),h(c.right,this.map.right),h(c.top,this.map.top),h(c.bottom,this.map.bottom),h(c.diagonal,this.map.diagonal),u.closeNode()}parseOpen(u){return this.parser?(this.parser.parseOpen(u),!0):u.name==="border"?(this.reset(),this.diagonalUp=o.parseBoolean(u.attributes.diagonalUp),this.diagonalDown=o.parseBoolean(u.attributes.diagonalDown),!0):(this.parser=this.map[u.name],!!this.parser&&(this.parser.parseOpen(u),!0))}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.parser=void 0),!0;if(u==="border"){const c=this.model={},d=function(h,f,m){f&&(m&&Object.assign(f,m),c[h]=f)};d("left",this.map.left.model),d("right",this.map.right.model),d("top",this.map.top.model),d("bottom",this.map.bottom.model),d("diagonal",this.map.diagonal.model,{up:this.diagonalUp,down:this.diagonalDown})}return!1}}},{"../../../utils/utils":27,"../base-xform":32,"./color-xform":128}],128:[function(t,n,i){const s=t("../base-xform");n.exports=class extends s{constructor(o){super(),this.name=o||"color"}get tag(){return this.name}render(o,a){return!!a&&(o.openNode(this.name),a.argb?o.addAttribute("rgb",a.argb):a.theme!==void 0?(o.addAttribute("theme",a.theme),a.tint!==void 0&&o.addAttribute("tint",a.tint)):a.indexed!==void 0?o.addAttribute("indexed",a.indexed):o.addAttribute("auto","1"),o.closeNode(),!0)}parseOpen(o){return o.name===this.name&&(o.attributes.rgb?this.model={argb:o.attributes.rgb}:o.attributes.theme?(this.model={theme:parseInt(o.attributes.theme,10)},o.attributes.tint&&(this.model.tint=parseFloat(o.attributes.tint))):o.attributes.indexed?this.model={indexed:parseInt(o.attributes.indexed,10)}:this.model=void 0,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],129:[function(t,n,i){const s=t("../base-xform"),o=t("./alignment-xform"),a=t("./border-xform"),l=t("./fill-xform"),u=t("./font-xform"),c=t("./numfmt-xform"),d=t("./protection-xform");n.exports=class extends s{constructor(){super(),this.map={alignment:new o,border:new a,fill:new l,font:new u,numFmt:new c,protection:new d}}get tag(){return"dxf"}render(h,f){if(h.openNode(this.tag),f.font&&this.map.font.render(h,f.font),f.numFmt&&f.numFmtId){const m={id:f.numFmtId,formatCode:f.numFmt};this.map.numFmt.render(h,m)}f.fill&&this.map.fill.render(h,f.fill),f.alignment&&this.map.alignment.render(h,f.alignment),f.border&&this.map.border.render(h,f.border),f.protection&&this.map.protection.render(h,f.protection),h.closeNode()}parseOpen(h){return this.parser?(this.parser.parseOpen(h),!0):h.name===this.tag?(this.reset(),!0):(this.parser=this.map[h.name],this.parser&&this.parser.parseOpen(h),!0)}parseText(h){this.parser&&this.parser.parseText(h)}parseClose(h){return this.parser?(this.parser.parseClose(h)||(this.parser=void 0),!0):h!==this.tag||(this.model={alignment:this.map.alignment.model,border:this.map.border.model,fill:this.map.fill.model,font:this.map.font.model,numFmt:this.map.numFmt.model,protection:this.map.protection.model},!1)}}},{"../base-xform":32,"./alignment-xform":126,"./border-xform":127,"./fill-xform":130,"./font-xform":131,"./numfmt-xform":132,"./protection-xform":133}],130:[function(t,n,i){const s=t("../base-xform"),o=t("./color-xform");class a extends s{constructor(){super(),this.map={color:new o}}get tag(){return"stop"}render(h,f){h.openNode("stop"),h.addAttribute("position",f.position),this.map.color.render(h,f.color),h.closeNode()}parseOpen(h){if(this.parser)return this.parser.parseOpen(h),!0;switch(h.name){case"stop":return this.model={position:parseFloat(h.attributes.position)},!0;case"color":return this.parser=this.map.color,this.parser.parseOpen(h),!0;default:return!1}}parseText(){}parseClose(h){return!!this.parser&&(this.parser.parseClose(h)||(this.model.color=this.parser.model,this.parser=void 0),!0)}}class l extends s{constructor(){super(),this.map={fgColor:new o("fgColor"),bgColor:new o("bgColor")}}get name(){return"pattern"}get tag(){return"patternFill"}render(h,f){h.openNode("patternFill"),h.addAttribute("patternType",f.pattern),f.fgColor&&this.map.fgColor.render(h,f.fgColor),f.bgColor&&this.map.bgColor.render(h,f.bgColor),h.closeNode()}parseOpen(h){return this.parser?(this.parser.parseOpen(h),!0):h.name==="patternFill"?(this.model={type:"pattern",pattern:h.attributes.patternType},!0):(this.parser=this.map[h.name],!!this.parser&&(this.parser.parseOpen(h),!0))}parseText(h){this.parser&&this.parser.parseText(h)}parseClose(h){return!!this.parser&&(this.parser.parseClose(h)||(this.parser.model&&(this.model[h]=this.parser.model),this.parser=void 0),!0)}}class u extends s{constructor(){super(),this.map={stop:new a}}get name(){return"gradient"}get tag(){return"gradientFill"}render(h,f){switch(h.openNode("gradientFill"),f.gradient){case"angle":h.addAttribute("degree",f.degree);break;case"path":h.addAttribute("type","path"),f.center.left&&(h.addAttribute("left",f.center.left),f.center.right===void 0&&h.addAttribute("right",f.center.left)),f.center.right&&h.addAttribute("right",f.center.right),f.center.top&&(h.addAttribute("top",f.center.top),f.center.bottom===void 0&&h.addAttribute("bottom",f.center.top)),f.center.bottom&&h.addAttribute("bottom",f.center.bottom)}const m=this.map.stop;f.stops.forEach(p=>{m.render(h,p)}),h.closeNode()}parseOpen(h){if(this.parser)return this.parser.parseOpen(h),!0;switch(h.name){case"gradientFill":{const f=this.model={stops:[]};return h.attributes.degree?(f.gradient="angle",f.degree=parseInt(h.attributes.degree,10)):h.attributes.type==="path"&&(f.gradient="path",f.center={left:h.attributes.left?parseFloat(h.attributes.left):0,top:h.attributes.top?parseFloat(h.attributes.top):0},h.attributes.right!==h.attributes.left&&(f.center.right=h.attributes.right?parseFloat(h.attributes.right):0),h.attributes.bottom!==h.attributes.top&&(f.center.bottom=h.attributes.bottom?parseFloat(h.attributes.bottom):0)),!0}case"stop":return this.parser=this.map.stop,this.parser.parseOpen(h),!0;default:return!1}}parseText(h){this.parser&&this.parser.parseText(h)}parseClose(h){return!!this.parser&&(this.parser.parseClose(h)||(this.model.stops.push(this.parser.model),this.parser=void 0),!0)}}class c extends s{constructor(){super(),this.map={patternFill:new l,gradientFill:new u}}get tag(){return"fill"}render(h,f){switch(h.addRollback(),h.openNode("fill"),f.type){case"pattern":this.map.patternFill.render(h,f);break;case"gradient":this.map.gradientFill.render(h,f);break;default:return void h.rollback()}h.closeNode(),h.commit()}parseOpen(h){return this.parser?(this.parser.parseOpen(h),!0):h.name==="fill"?(this.model={},!0):(this.parser=this.map[h.name],!!this.parser&&(this.parser.parseOpen(h),!0))}parseText(h){this.parser&&this.parser.parseText(h)}parseClose(h){return!!this.parser&&(this.parser.parseClose(h)||(this.model=this.parser.model,this.model.type=this.parser.name,this.parser=void 0),!0)}validStyle(h){return c.validPatternValues[h]}}c.validPatternValues=["none","solid","darkVertical","darkGray","mediumGray","lightGray","gray125","gray0625","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","lightGrid"].reduce((d,h)=>(d[h]=!0,d),{}),c.StopXform=a,c.PatternFillXform=l,c.GradientFillXform=u,n.exports=c},{"../base-xform":32,"./color-xform":128}],131:[function(t,n,i){const s=t("./color-xform"),o=t("../simple/boolean-xform"),a=t("../simple/integer-xform"),l=t("../simple/string-xform"),u=t("./underline-xform"),c=t("../../../utils/under-dash"),d=t("../base-xform");class h extends d{constructor(m){super(),this.options=m||h.OPTIONS,this.map={b:{prop:"bold",xform:new o({tag:"b",attr:"val"})},i:{prop:"italic",xform:new o({tag:"i",attr:"val"})},u:{prop:"underline",xform:new u},charset:{prop:"charset",xform:new a({tag:"charset",attr:"val"})},color:{prop:"color",xform:new s},condense:{prop:"condense",xform:new o({tag:"condense",attr:"val"})},extend:{prop:"extend",xform:new o({tag:"extend",attr:"val"})},family:{prop:"family",xform:new a({tag:"family",attr:"val"})},outline:{prop:"outline",xform:new o({tag:"outline",attr:"val"})},vertAlign:{prop:"vertAlign",xform:new l({tag:"vertAlign",attr:"val"})},scheme:{prop:"scheme",xform:new l({tag:"scheme",attr:"val"})},shadow:{prop:"shadow",xform:new o({tag:"shadow",attr:"val"})},strike:{prop:"strike",xform:new o({tag:"strike",attr:"val"})},sz:{prop:"size",xform:new a({tag:"sz",attr:"val"})}},this.map[this.options.fontNameTag]={prop:"name",xform:new l({tag:this.options.fontNameTag,attr:"val"})}}get tag(){return this.options.tagName}render(m,p){const{map:g}=this;m.openNode(this.options.tagName),c.each(this.map,(v,y)=>{g[y].xform.render(m,p[v.prop])}),m.closeNode()}parseOpen(m){return this.parser?(this.parser.parseOpen(m),!0):this.map[m.name]?(this.parser=this.map[m.name].xform,this.parser.parseOpen(m)):m.name===this.options.tagName?(this.model={},!0):!1}parseText(m){this.parser&&this.parser.parseText(m)}parseClose(m){if(this.parser&&!this.parser.parseClose(m)){const p=this.map[m];return this.parser.model&&(this.model[p.prop]=this.parser.model),this.parser=void 0,!0}return m!==this.options.tagName}}h.OPTIONS={tagName:"font",fontNameTag:"name"},n.exports=h},{"../../../utils/under-dash":26,"../base-xform":32,"../simple/boolean-xform":116,"../simple/integer-xform":118,"../simple/string-xform":119,"./color-xform":128,"./underline-xform":136}],132:[function(t,n,i){const s=t("../../../utils/under-dash"),o=t("../../defaultnumformats"),a=t("../base-xform"),l=(function(){const c={};return s.each(o,(d,h)=>{d.f&&(c[d.f]=parseInt(h,10))}),c})();class u extends a{constructor(d,h){super(),this.id=d,this.formatCode=h}get tag(){return"numFmt"}render(d,h){d.leafNode("numFmt",{numFmtId:h.id,formatCode:h.formatCode})}parseOpen(d){return d.name==="numFmt"?(this.model={id:parseInt(d.attributes.numFmtId,10),formatCode:d.attributes.formatCode.replace(/[\\](.)/g,"$1")},!0):!1}parseText(){}parseClose(){return!1}}u.getDefaultFmtId=function(c){return l[c]},u.getDefaultFmtCode=function(c){return o[c]&&o[c].f},n.exports=u},{"../../../utils/under-dash":26,"../../defaultnumformats":30,"../base-xform":32}],133:[function(t,n,i){const s=t("../base-xform"),o={boolean:(a,l)=>a===void 0?l:a};n.exports=class extends s{get tag(){return"protection"}render(a,l){a.addRollback(),a.openNode("protection");let u=!1;function c(d,h){h!==void 0&&(a.addAttribute(d,h),u=!0)}c("locked",o.boolean(l.locked,!0)?void 0:"0"),c("hidden",o.boolean(l.hidden,!1)?"1":void 0),a.closeNode(),u?a.commit():a.rollback()}parseOpen(a){const l={locked:a.attributes.locked!=="0",hidden:a.attributes.hidden==="1"},u=!l.locked||l.hidden;this.model=u?l:null}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],134:[function(t,n,i){const s=t("../base-xform"),o=t("./alignment-xform"),a=t("./protection-xform");n.exports=class extends s{constructor(l){super(),this.xfId=!(!l||!l.xfId),this.map={alignment:new o,protection:new a}}get tag(){return"xf"}render(l,u){l.openNode("xf",{numFmtId:u.numFmtId||0,fontId:u.fontId||0,fillId:u.fillId||0,borderId:u.borderId||0}),this.xfId&&l.addAttribute("xfId",u.xfId||0),u.numFmtId&&l.addAttribute("applyNumberFormat","1"),u.fontId&&l.addAttribute("applyFont","1"),u.fillId&&l.addAttribute("applyFill","1"),u.borderId&&l.addAttribute("applyBorder","1"),u.alignment&&l.addAttribute("applyAlignment","1"),u.protection&&l.addAttribute("applyProtection","1"),u.alignment&&this.map.alignment.render(l,u.alignment),u.protection&&this.map.protection.render(l,u.protection),l.closeNode()}parseOpen(l){if(this.parser)return this.parser.parseOpen(l),!0;switch(l.name){case"xf":return this.model={numFmtId:parseInt(l.attributes.numFmtId,10),fontId:parseInt(l.attributes.fontId,10),fillId:parseInt(l.attributes.fillId,10),borderId:parseInt(l.attributes.borderId,10)},this.xfId&&(this.model.xfId=parseInt(l.attributes.xfId,10)),!0;case"alignment":return this.parser=this.map.alignment,this.parser.parseOpen(l),!0;case"protection":return this.parser=this.map.protection,this.parser.parseOpen(l),!0;default:return!1}}parseText(l){this.parser&&this.parser.parseText(l)}parseClose(l){return this.parser?(this.parser.parseClose(l)||(this.map.protection===this.parser?this.model.protection=this.parser.model:this.model.alignment=this.parser.model,this.parser=void 0),!0):l!=="xf"}}},{"../base-xform":32,"./alignment-xform":126,"./protection-xform":133}],135:[function(t,n,i){const s=t("../../../doc/enums"),o=t("../../../utils/xml-stream"),a=t("../base-xform"),l=t("../static-xform"),u=t("../list-xform"),c=t("./font-xform"),d=t("./fill-xform"),h=t("./border-xform"),f=t("./numfmt-xform"),m=t("./style-xform"),p=t("./dxf-xform");class g extends a{constructor(y){super(),this.map={numFmts:new u({tag:"numFmts",count:!0,childXform:new f}),fonts:new u({tag:"fonts",count:!0,childXform:new c,$:{"x14ac:knownFonts":1}}),fills:new u({tag:"fills",count:!0,childXform:new d}),borders:new u({tag:"borders",count:!0,childXform:new h}),cellStyleXfs:new u({tag:"cellStyleXfs",count:!0,childXform:new m}),cellXfs:new u({tag:"cellXfs",count:!0,childXform:new m({xfId:!0})}),dxfs:new u({tag:"dxfs",always:!0,count:!0,childXform:new p}),numFmt:new f,font:new c,fill:new d,border:new h,style:new m({xfId:!0}),cellStyles:g.STATIC_XFORMS.cellStyles,tableStyles:g.STATIC_XFORMS.tableStyles,extLst:g.STATIC_XFORMS.extLst},y&&this.init()}initIndex(){this.index={style:{},numFmt:{},numFmtNextId:164,font:{},border:{},fill:{}}}init(){this.model={styles:[],numFmts:[],fonts:[],borders:[],fills:[],dxfs:[]},this.initIndex(),this._addBorder({}),this._addStyle({numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}),this._addFill({type:"pattern",pattern:"none"}),this._addFill({type:"pattern",pattern:"gray125"}),this.weakMap=new WeakMap}render(y,b){b=b||this.model,y.openXml(o.StdDocAttributes),y.openNode("styleSheet",g.STYLESHEET_ATTRIBUTES),this.index?(b.numFmts&&b.numFmts.length&&(y.openNode("numFmts",{count:b.numFmts.length}),b.numFmts.forEach(E=>{y.writeXml(E)}),y.closeNode()),b.fonts.length||this._addFont({size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}),y.openNode("fonts",{count:b.fonts.length,"x14ac:knownFonts":1}),b.fonts.forEach(E=>{y.writeXml(E)}),y.closeNode(),y.openNode("fills",{count:b.fills.length}),b.fills.forEach(E=>{y.writeXml(E)}),y.closeNode(),y.openNode("borders",{count:b.borders.length}),b.borders.forEach(E=>{y.writeXml(E)}),y.closeNode(),this.map.cellStyleXfs.render(y,[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}]),y.openNode("cellXfs",{count:b.styles.length}),b.styles.forEach(E=>{y.writeXml(E)}),y.closeNode()):(this.map.numFmts.render(y,b.numFmts),this.map.fonts.render(y,b.fonts),this.map.fills.render(y,b.fills),this.map.borders.render(y,b.borders),this.map.cellStyleXfs.render(y,[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}]),this.map.cellXfs.render(y,b.styles)),g.STATIC_XFORMS.cellStyles.render(y),this.map.dxfs.render(y,b.dxfs),g.STATIC_XFORMS.tableStyles.render(y),g.STATIC_XFORMS.extLst.render(y),y.closeNode()}parseOpen(y){return this.parser?(this.parser.parseOpen(y),!0):y.name==="styleSheet"?(this.initIndex(),!0):(this.parser=this.map[y.name],this.parser&&this.parser.parseOpen(y),!0)}parseText(y){this.parser&&this.parser.parseText(y)}parseClose(y){if(this.parser)return this.parser.parseClose(y)||(this.parser=void 0),!0;switch(y){case"styleSheet":{this.model={};const b=(E,A)=>{A.model&&A.model.length&&(this.model[E]=A.model)};if(b("numFmts",this.map.numFmts),b("fonts",this.map.fonts),b("fills",this.map.fills),b("borders",this.map.borders),b("styles",this.map.cellXfs),b("dxfs",this.map.dxfs),this.index={model:[],numFmt:[]},this.model.numFmts){const E=this.index.numFmt;this.model.numFmts.forEach(A=>{E[A.id]=A.formatCode})}return!1}default:return!0}}addStyleModel(y,b){if(!y)return 0;if(this.model.fonts.length||this._addFont({size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}),this.weakMap&&this.weakMap.has(y))return this.weakMap.get(y);const E={};if(b=b||s.ValueType.Number,y.numFmt)E.numFmtId=this._addNumFmtStr(y.numFmt);else switch(b){case s.ValueType.Number:E.numFmtId=this._addNumFmtStr("General");break;case s.ValueType.Date:E.numFmtId=this._addNumFmtStr("mm-dd-yy")}y.font&&(E.fontId=this._addFont(y.font)),y.border&&(E.borderId=this._addBorder(y.border)),y.fill&&(E.fillId=this._addFill(y.fill)),y.alignment&&(E.alignment=y.alignment),y.protection&&(E.protection=y.protection);const A=this._addStyle(E);return this.weakMap&&this.weakMap.set(y,A),A}getStyleModel(y){const b=this.model.styles[y];if(!b)return null;let E=this.index.model[y];if(E)return E;if(E=this.index.model[y]={},b.numFmtId){const M=this.index.numFmt[b.numFmtId]||f.getDefaultFmtCode(b.numFmtId);M&&(E.numFmt=M)}function A(M,L,k){if(k||k===0){const P=L[k];P&&(E[M]=P)}}return A("font",this.model.fonts,b.fontId),A("border",this.model.borders,b.borderId),A("fill",this.model.fills,b.fillId),b.alignment&&(E.alignment=b.alignment),b.protection&&(E.protection=b.protection),E}addDxfStyle(y){return y.numFmt&&(y.numFmtId=this._addNumFmtStr(y.numFmt)),this.model.dxfs.push(y),this.model.dxfs.length-1}getDxfStyle(y){return this.model.dxfs[y]}_addStyle(y){const b=this.map.style.toXml(y);let E=this.index.style[b];return E===void 0&&(E=this.index.style[b]=this.model.styles.length,this.model.styles.push(b)),E}_addNumFmtStr(y){let b=f.getDefaultFmtId(y);if(b!==void 0||(b=this.index.numFmt[y],b!==void 0))return b;b=this.index.numFmt[y]=164+this.model.numFmts.length;const E=this.map.numFmt.toXml({id:b,formatCode:y});return this.model.numFmts.push(E),b}_addFont(y){const b=this.map.font.toXml(y);let E=this.index.font[b];return E===void 0&&(E=this.index.font[b]=this.model.fonts.length,this.model.fonts.push(b)),E}_addBorder(y){const b=this.map.border.toXml(y);let E=this.index.border[b];return E===void 0&&(E=this.index.border[b]=this.model.borders.length,this.model.borders.push(b)),E}_addFill(y){const b=this.map.fill.toXml(y);let E=this.index.fill[b];return E===void 0&&(E=this.index.fill[b]=this.model.fills.length,this.model.fills.push(b)),E}}g.STYLESHEET_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x14ac x16r2","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac","xmlns:x16r2":"http://schemas.microsoft.com/office/spreadsheetml/2015/02/main"},g.STATIC_XFORMS={cellStyles:new l({tag:"cellStyles",$:{count:1},c:[{tag:"cellStyle",$:{name:"Normal",xfId:0,builtinId:0}}]}),dxfs:new l({tag:"dxfs",$:{count:0}}),tableStyles:new l({tag:"tableStyles",$:{count:0,defaultTableStyle:"TableStyleMedium2",defaultPivotStyle:"PivotStyleLight16"}}),extLst:new l({tag:"extLst",c:[{tag:"ext",$:{uri:"{EB79DEF2-80B8-43e5-95BD-54CBDDF9020C}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"},c:[{tag:"x14:slicerStyles",$:{defaultSlicerStyle:"SlicerStyleLight1"}}]},{tag:"ext",$:{uri:"{9260A510-F301-46a8-8635-F512D64BE5F5}","xmlns:x15":"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main"},c:[{tag:"x15:timelineStyles",$:{defaultTimelineStyle:"TimeSlicerStyleLight1"}}]}]})},g.Mock=class extends g{constructor(){super(),this.model={styles:[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}],numFmts:[],fonts:[{size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}],borders:[{}],fills:[{type:"pattern",pattern:"none"},{type:"pattern",pattern:"gray125"}]}}parseStream(v){return v.autodrain(),Promise.resolve()}addStyleModel(v,y){return y===s.ValueType.Date?this.dateStyleId:0}get dateStyleId(){if(!this._dateStyleId){const v={numFmtId:f.getDefaultFmtId("mm-dd-yy")};this._dateStyleId=this.model.styles.length,this.model.styles.push(v)}return this._dateStyleId}getStyleModel(){return{}}},n.exports=g},{"../../../doc/enums":7,"../../../utils/xml-stream":28,"../base-xform":32,"../list-xform":71,"../static-xform":120,"./border-xform":127,"./dxf-xform":129,"./fill-xform":130,"./font-xform":131,"./numfmt-xform":132,"./style-xform":134}],136:[function(t,n,i){const s=t("../base-xform");class o extends s{constructor(l){super(),this.model=l}get tag(){return"u"}render(l,u){if((u=u||this.model)===!0)l.leafNode("u");else{const c=o.Attributes[u];c&&l.leafNode("u",c)}}parseOpen(l){l.name==="u"&&(this.model=l.attributes.val||!0)}parseText(){}parseClose(){return!1}}o.Attributes={single:{},double:{val:"double"},singleAccounting:{val:"singleAccounting"},doubleAccounting:{val:"doubleAccounting"}},n.exports=o},{"../base-xform":32}],137:[function(t,n,i){const s=t("../base-xform"),o=t("./filter-column-xform");n.exports=class extends s{constructor(){super(),this.map={filterColumn:new o}}get tag(){return"autoFilter"}prepare(a){a.columns.forEach((l,u)=>{this.map.filterColumn.prepare(l,{index:u})})}render(a,l){return a.openNode(this.tag,{ref:l.autoFilterRef}),l.columns.forEach(u=>{this.map.filterColumn.render(a,u)}),a.closeNode(),!0}parseOpen(a){if(this.parser)return this.parser.parseOpen(a),!0;switch(a.name){case this.tag:return this.model={autoFilterRef:a.attributes.ref,columns:[]},!0;default:if(this.parser=this.map[a.name],this.parser)return this.parseOpen(a),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(a))}}parseText(a){this.parser&&this.parser.parseText(a)}parseClose(a){if(this.parser)return this.parser.parseClose(a)||(this.model.columns.push(this.parser.model),this.parser=void 0),!0;if(a===this.tag)return!1;throw new Error("Unexpected xml node in parseClose: "+a)}}},{"../base-xform":32,"./filter-column-xform":139}],138:[function(t,n,i){const s=t("../base-xform");n.exports=class extends s{get tag(){return"customFilter"}render(o,a){o.leafNode(this.tag,{val:a.val,operator:a.operator})}parseOpen(o){return o.name===this.tag&&(this.model={val:o.attributes.val,operator:o.attributes.operator},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],139:[function(t,n,i){const s=t("../base-xform"),o=t("../list-xform"),a=t("./custom-filter-xform"),l=t("./filter-xform");n.exports=class extends s{constructor(){super(),this.map={customFilters:new o({tag:"customFilters",count:!1,empty:!0,childXform:new a}),filters:new o({tag:"filters",count:!1,empty:!0,childXform:new l})}}get tag(){return"filterColumn"}prepare(u,c){u.colId=c.index.toString()}render(u,c){return c.customFilters?(u.openNode(this.tag,{colId:c.colId,hiddenButton:c.filterButton?"0":"1"}),this.map.customFilters.render(u,c.customFilters),u.closeNode(),!0):(u.leafNode(this.tag,{colId:c.colId,hiddenButton:c.filterButton?"0":"1"}),!0)}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;const{attributes:c}=u;switch(u.name){case this.tag:return this.model={filterButton:c.hiddenButton==="0"},!0;default:if(this.parser=this.map[u.name],this.parser)return this.parseOpen(u),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(u))}}parseText(){}parseClose(u){return this.parser?(this.parser.parseClose(u)||(this.parser=void 0),!0):u===this.tag?(this.model.customFilters=this.map.customFilters.model,!1):!0}}},{"../base-xform":32,"../list-xform":71,"./custom-filter-xform":138,"./filter-xform":140}],140:[function(t,n,i){const s=t("../base-xform");n.exports=class extends s{get tag(){return"filter"}render(o,a){o.leafNode(this.tag,{val:a.val})}parseOpen(o){return o.name===this.tag&&(this.model={val:o.attributes.val},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],141:[function(t,n,i){const s=t("../base-xform");n.exports=class extends s{get tag(){return"tableColumn"}prepare(o,a){o.id=a.index+1}render(o,a){return o.leafNode(this.tag,{id:a.id.toString(),name:a.name,totalsRowLabel:a.totalsRowLabel,totalsRowFunction:a.totalsRowFunction,dxfId:a.dxfId}),!0}parseOpen(o){if(o.name===this.tag){const{attributes:a}=o;return this.model={name:a.name,totalsRowLabel:a.totalsRowLabel,totalsRowFunction:a.totalsRowFunction,dxfId:a.dxfId},!0}return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],142:[function(t,n,i){const s=t("../base-xform");n.exports=class extends s{get tag(){return"tableStyleInfo"}render(o,a){return o.leafNode(this.tag,{name:a.theme?a.theme:void 0,showFirstColumn:a.showFirstColumn?"1":"0",showLastColumn:a.showLastColumn?"1":"0",showRowStripes:a.showRowStripes?"1":"0",showColumnStripes:a.showColumnStripes?"1":"0"}),!0}parseOpen(o){if(o.name===this.tag){const{attributes:a}=o;return this.model={theme:a.name?a.name:null,showFirstColumn:a.showFirstColumn==="1",showLastColumn:a.showLastColumn==="1",showRowStripes:a.showRowStripes==="1",showColumnStripes:a.showColumnStripes==="1"},!0}return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],143:[function(t,n,i){const s=t("../../../utils/xml-stream"),o=t("../base-xform"),a=t("../list-xform"),l=t("./auto-filter-xform"),u=t("./table-column-xform"),c=t("./table-style-info-xform");class d extends o{constructor(){super(),this.map={autoFilter:new l,tableColumns:new a({tag:"tableColumns",count:!0,empty:!0,childXform:new u}),tableStyleInfo:new c}}prepare(f,m){this.map.autoFilter.prepare(f),this.map.tableColumns.prepare(f.columns,m)}get tag(){return"table"}render(f,m){f.openXml(s.StdDocAttributes),f.openNode(this.tag,{...d.TABLE_ATTRIBUTES,id:m.id,name:m.name,displayName:m.displayName||m.name,ref:m.tableRef,totalsRowCount:m.totalsRow?"1":void 0,totalsRowShown:m.totalsRow?void 0:"1",headerRowCount:m.headerRow?"1":"0"}),this.map.autoFilter.render(f,m),this.map.tableColumns.render(f,m.columns),this.map.tableStyleInfo.render(f,m.style),f.closeNode()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;const{name:m,attributes:p}=f;return m===this.tag?(this.reset(),this.model={name:p.name,displayName:p.displayName||p.name,tableRef:p.ref,totalsRow:p.totalsRowCount==="1",headerRow:p.headerRowCount==="1"}):(this.parser=this.map[f.name],this.parser&&this.parser.parseOpen(f)),!0}parseText(f){this.parser&&this.parser.parseText(f)}parseClose(f){return this.parser?(this.parser.parseClose(f)||(this.parser=void 0),!0):f===this.tag?(this.model.columns=this.map.tableColumns.model,this.map.autoFilter.model&&(this.model.autoFilterRef=this.map.autoFilter.model.autoFilterRef,this.map.autoFilter.model.columns.forEach((m,p)=>{this.model.columns[p].filterButton=m.filterButton})),this.model.style=this.map.tableStyleInfo.model,!1):!0}reconcile(f,m){f.columns.forEach(p=>{p.dxfId!==void 0&&(p.style=m.styles.getDxfStyle(p.dxfId))})}}d.TABLE_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"xr xr3","xmlns:xr":"http://schemas.microsoft.com/office/spreadsheetml/2014/revision","xmlns:xr3":"http://schemas.microsoft.com/office/spreadsheetml/2016/revision3"},n.exports=d},{"../../../utils/xml-stream":28,"../base-xform":32,"../list-xform":71,"./auto-filter-xform":137,"./table-column-xform":141,"./table-style-info-xform":142}],144:[function(t,n,i){(function(s,o){(function(){const a=t("fs"),l=t("jszip"),{PassThrough:u}=t("readable-stream"),c=t("../utils/zip-stream"),d=t("../utils/stream-buf"),h=t("../utils/utils"),f=t("../utils/xml-stream"),{bufferToString:m}=t("../utils/browser-buffer-decode"),p=t("./xform/style/styles-xform"),g=t("./xform/core/core-xform"),v=t("./xform/strings/shared-strings-xform"),y=t("./xform/core/relationships-xform"),b=t("./xform/core/content-types-xform"),E=t("./xform/core/app-xform"),A=t("./xform/book/workbook-xform"),M=t("./xform/sheet/worksheet-xform"),L=t("./xform/drawing/drawing-xform"),k=t("./xform/table/table-xform"),P=t("./xform/comment/comments-xform"),U=t("./xform/comment/vml-notes-xform"),$=t("./xml/theme1");class V{constructor(O){this.workbook=O}async readFile(O,T){if(!await h.fs.exists(O))throw new Error("File not found: "+O);const w=a.createReadStream(O);try{const x=await this.read(w,T);return w.close(),x}catch(x){throw w.close(),x}}parseRels(O){return new y().parseStream(O)}parseWorkbook(O){return new A().parseStream(O)}parseSharedStrings(O){return new v().parseStream(O)}reconcile(O,T){const w=new A,x=new M(T),_=new L,S=new k;w.reconcile(O);const C={media:O.media,mediaIndex:O.mediaIndex};Object.keys(O.drawings).forEach(H=>{const G=O.drawings[H],ee=O.drawingRels[H];ee&&(C.rels=ee.reduce((B,X)=>(B[X.Id]=X,B),{}),(G.anchors||[]).forEach(B=>{const X=B.picture&&B.picture.hyperlinks;X&&C.rels[X.rId]&&(X.hyperlink=C.rels[X.rId].Target,delete X.rId)}),_.reconcile(G,C))});const F={styles:O.styles};Object.values(O.tables).forEach(H=>{S.reconcile(H,F)});const D={styles:O.styles,sharedStrings:O.sharedStrings,media:O.media,mediaIndex:O.mediaIndex,date1904:O.properties&&O.properties.date1904,drawings:O.drawings,comments:O.comments,tables:O.tables,vmlDrawings:O.vmlDrawings};O.worksheets.forEach(H=>{H.relationships=O.worksheetRels[H.sheetNo],x.reconcile(H,D)}),delete O.worksheetHash,delete O.worksheetRels,delete O.globalRels,delete O.sharedStrings,delete O.workbookRels,delete O.sheetDefs,delete O.styles,delete O.mediaIndex,delete O.drawings,delete O.drawingRels,delete O.vmlDrawings}async _processWorksheetEntry(O,T,w,x,_){const S=new M(x),C=await S.parseStream(O);C.sheetNo=w,T.worksheetHash[_]=C,T.worksheets.push(C)}async _processCommentEntry(O,T,w){const x=new P,_=await x.parseStream(O);T.comments[`../${w}.xml`]=_}async _processTableEntry(O,T,w){const x=new k,_=await x.parseStream(O);T.tables[`../tables/${w}.xml`]=_}async _processWorksheetRelsEntry(O,T,w){const x=new y,_=await x.parseStream(O);T.worksheetRels[w]=_}async _processMediaEntry(O,T,w){const x=w.lastIndexOf(".");if(x>=1){const _=w.substr(x+1),S=w.substr(0,x);await new Promise((C,F)=>{const D=new d;D.on("finish",()=>{T.mediaIndex[w]=T.media.length,T.mediaIndex[S]=T.media.length;const H={type:"image",name:S,extension:_,buffer:D.toBuffer()};T.media.push(H),C()}),O.on("error",H=>{F(H)}),O.pipe(D)})}}async _processDrawingEntry(O,T,w){const x=new L,_=await x.parseStream(O);T.drawings[w]=_}async _processDrawingRelsEntry(O,T,w){const x=new y,_=await x.parseStream(O);T.drawingRels[w]=_}async _processVmlDrawingEntry(O,T,w){const x=new U,_=await x.parseStream(O);T.vmlDrawings[`../drawings/${w}.vml`]=_}async _processThemeEntry(O,T,w){await new Promise((x,_)=>{const S=new d;O.on("error",_),S.on("error",_),S.on("finish",()=>{T.themes[w]=S.read().toString(),x()}),O.pipe(S)})}createInputStream(){throw new Error("`XLSX#createInputStream` is deprecated. You should use `XLSX#read` instead. This method will be removed in version 5.0. Please follow upgrade instruction: https://github.com/exceljs/exceljs/blob/master/UPGRADE-4.0.md")}async read(O,T){!O[Symbol.asyncIterator]&&O.pipe&&(O=O.pipe(new u));const w=[];for await(const x of O)w.push(x);return this.load(o.concat(w),T)}async load(O,T){let w;w=T&&T.base64?o.from(O.toString(),"base64"):O;const x={worksheets:[],worksheetHash:{},worksheetRels:[],themes:{},media:[],mediaIndex:{},drawings:{},drawingRels:{},comments:{},tables:{},vmlDrawings:{}},_=await l.loadAsync(w);for(const S of Object.values(_.files))if(!S.dir){let C,F=S.name;if(F[0]==="/"&&(F=F.substr(1)),F.match(/xl\/media\//)||F.match(/xl\/theme\/([a-zA-Z0-9]+)[.]xml/))C=new u,C.write(await S.async("nodebuffer"));else{let D;C=new u({writableObjectMode:!0,readableObjectMode:!0}),D=s.browser?m(await S.async("nodebuffer")):await S.async("string");const H=16384;for(let G=0;G<D.length;G+=H)C.write(D.substring(G,G+H))}switch(C.end(),F){case"_rels/.rels":x.globalRels=await this.parseRels(C);break;case"xl/workbook.xml":{const D=await this.parseWorkbook(C);x.sheets=D.sheets,x.definedNames=D.definedNames,x.views=D.views,x.properties=D.properties,x.calcProperties=D.calcProperties;break}case"xl/_rels/workbook.xml.rels":x.workbookRels=await this.parseRels(C);break;case"xl/sharedStrings.xml":x.sharedStrings=new v,await x.sharedStrings.parseStream(C);break;case"xl/styles.xml":x.styles=new p,await x.styles.parseStream(C);break;case"docProps/app.xml":{const D=new E,H=await D.parseStream(C);x.company=H.company,x.manager=H.manager;break}case"docProps/core.xml":{const D=new g,H=await D.parseStream(C);Object.assign(x,H);break}default:{let D=F.match(/xl\/worksheets\/sheet(\d+)[.]xml/);if(D){await this._processWorksheetEntry(C,x,D[1],T,F);break}if(D=F.match(/xl\/worksheets\/_rels\/sheet(\d+)[.]xml.rels/),D){await this._processWorksheetRelsEntry(C,x,D[1]);break}if(D=F.match(/xl\/theme\/([a-zA-Z0-9]+)[.]xml/),D){await this._processThemeEntry(C,x,D[1]);break}if(D=F.match(/xl\/media\/([a-zA-Z0-9]+[.][a-zA-Z0-9]{3,4})$/),D){await this._processMediaEntry(C,x,D[1]);break}if(D=F.match(/xl\/drawings\/([a-zA-Z0-9]+)[.]xml/),D){await this._processDrawingEntry(C,x,D[1]);break}if(D=F.match(/xl\/(comments\d+)[.]xml/),D){await this._processCommentEntry(C,x,D[1]);break}if(D=F.match(/xl\/tables\/(table\d+)[.]xml/),D){await this._processTableEntry(C,x,D[1]);break}if(D=F.match(/xl\/drawings\/_rels\/([a-zA-Z0-9]+)[.]xml[.]rels/),D){await this._processDrawingRelsEntry(C,x,D[1]);break}if(D=F.match(/xl\/drawings\/(vmlDrawing\d+)[.]vml/),D){await this._processVmlDrawingEntry(C,x,D[1]);break}}}}return this.reconcile(x,T),this.workbook.model=x,this.workbook}async addMedia(O,T){await Promise.all(T.media.map(async w=>{if(w.type==="image"){const x=`xl/media/${w.name}.${w.extension}`;if(w.filename){const _=await(function(S,C){return new Promise((F,D)=>{a.readFile(S,C,(H,G)=>{H?D(H):F(G)})})})(w.filename);return O.append(_,{name:x})}if(w.buffer)return O.append(w.buffer,{name:x});if(w.base64){const _=w.base64,S=_.substring(_.indexOf(",")+1);return O.append(S,{name:x,base64:!0})}}throw new Error("Unsupported media")}))}addDrawings(O,T){const w=new L,x=new y;T.worksheets.forEach(_=>{const{drawing:S}=_;if(S){w.prepare(S,{});let C=w.toXml(S);O.append(C,{name:`xl/drawings/${S.name}.xml`}),C=x.toXml(S.rels),O.append(C,{name:`xl/drawings/_rels/${S.name}.xml.rels`})}})}addTables(O,T){const w=new k;T.worksheets.forEach(x=>{const{tables:_}=x;_.forEach(S=>{w.prepare(S,{});const C=w.toXml(S);O.append(C,{name:"xl/tables/"+S.target})})})}async addContentTypes(O,T){const w=new b().toXml(T);O.append(w,{name:"[Content_Types].xml"})}async addApp(O,T){const w=new E().toXml(T);O.append(w,{name:"docProps/app.xml"})}async addCore(O,T){const w=new g;O.append(w.toXml(T),{name:"docProps/core.xml"})}async addThemes(O,T){const w=T.themes||{theme1:$};Object.keys(w).forEach(x=>{const _=w[x],S=`xl/theme/${x}.xml`;O.append(_,{name:S})})}async addOfficeRels(O){const T=new y().toXml([{Id:"rId1",Type:V.RelType.OfficeDocument,Target:"xl/workbook.xml"},{Id:"rId2",Type:V.RelType.CoreProperties,Target:"docProps/core.xml"},{Id:"rId3",Type:V.RelType.ExtenderProperties,Target:"docProps/app.xml"}]);O.append(T,{name:"_rels/.rels"})}async addWorkbookRels(O,T){let w=1;const x=[{Id:"rId"+w++,Type:V.RelType.Styles,Target:"styles.xml"},{Id:"rId"+w++,Type:V.RelType.Theme,Target:"theme/theme1.xml"}];T.sharedStrings.count&&x.push({Id:"rId"+w++,Type:V.RelType.SharedStrings,Target:"sharedStrings.xml"}),T.worksheets.forEach(S=>{S.rId="rId"+w++,x.push({Id:S.rId,Type:V.RelType.Worksheet,Target:`worksheets/sheet${S.id}.xml`})});const _=new y().toXml(x);O.append(_,{name:"xl/_rels/workbook.xml.rels"})}async addSharedStrings(O,T){T.sharedStrings&&T.sharedStrings.count&&O.append(T.sharedStrings.xml,{name:"xl/sharedStrings.xml"})}async addStyles(O,T){const{xml:w}=T.styles;w&&O.append(w,{name:"xl/styles.xml"})}async addWorkbook(O,T){const w=new A;O.append(w.toXml(T),{name:"xl/workbook.xml"})}async addWorksheets(O,T){const w=new M,x=new y,_=new P,S=new U;T.worksheets.forEach(C=>{let F=new f;w.render(F,C),O.append(F.xml,{name:`xl/worksheets/sheet${C.id}.xml`}),C.rels&&C.rels.length&&(F=new f,x.render(F,C.rels),O.append(F.xml,{name:`xl/worksheets/_rels/sheet${C.id}.xml.rels`})),C.comments.length>0&&(F=new f,_.render(F,C),O.append(F.xml,{name:`xl/comments${C.id}.xml`}),F=new f,S.render(F,C),O.append(F.xml,{name:`xl/drawings/vmlDrawing${C.id}.vml`}))})}_finalize(O){return new Promise((T,w)=>{O.on("finish",()=>{T(this)}),O.on("error",w),O.finalize()})}prepareModel(O,T){O.creator=O.creator||"ExcelJS",O.lastModifiedBy=O.lastModifiedBy||"ExcelJS",O.created=O.created||new Date,O.modified=O.modified||new Date,O.useSharedStrings=T.useSharedStrings===void 0||T.useSharedStrings,O.useStyles=T.useStyles===void 0||T.useStyles,O.sharedStrings=new v,O.styles=O.useStyles?new p(!0):new p.Mock;const w=new A,x=new M;w.prepare(O);const _={sharedStrings:O.sharedStrings,styles:O.styles,date1904:O.properties.date1904,drawingsCount:0,media:O.media};_.drawings=O.drawings=[],_.commentRefs=O.commentRefs=[];let S=0;O.tables=[],O.worksheets.forEach(C=>{C.tables.forEach(F=>{S++,F.target=`table${S}.xml`,F.id=S,O.tables.push(F)}),x.prepare(C,_)})}async write(O,T){T=T||{};const{model:w}=this.workbook,x=new c.ZipWriter(T.zip);return x.pipe(O),this.prepareModel(w,T),await this.addContentTypes(x,w),await this.addOfficeRels(x,w),await this.addWorkbookRels(x,w),await this.addWorksheets(x,w),await this.addSharedStrings(x,w),await this.addDrawings(x,w),await this.addTables(x,w),await Promise.all([this.addThemes(x,w),this.addStyles(x,w)]),await this.addMedia(x,w),await Promise.all([this.addApp(x,w),this.addCore(x,w)]),await this.addWorkbook(x,w),this._finalize(x)}writeFile(O,T){const w=a.createWriteStream(O);return new Promise((x,_)=>{w.on("finish",()=>{x()}),w.on("error",S=>{_(S)}),this.write(w,T).then(()=>{w.end()}).catch(S=>{_(S)})})}async writeBuffer(O){const T=new d;return await this.write(T,O),T.read()}}V.RelType=t("./rel-type"),n.exports=V}).call(this)}).call(this,t("_process"),t("buffer").Buffer)},{"../utils/browser-buffer-decode":16,"../utils/stream-buf":24,"../utils/utils":27,"../utils/xml-stream":28,"../utils/zip-stream":29,"./rel-type":31,"./xform/book/workbook-xform":38,"./xform/comment/comments-xform":40,"./xform/comment/vml-notes-xform":45,"./xform/core/app-xform":51,"./xform/core/content-types-xform":52,"./xform/core/core-xform":53,"./xform/core/relationships-xform":55,"./xform/drawing/drawing-xform":62,"./xform/sheet/worksheet-xform":115,"./xform/strings/shared-strings-xform":124,"./xform/style/styles-xform":135,"./xform/table/table-xform":143,"./xml/theme1":145,_process:467,buffer:220,fs:216,jszip:441,"readable-stream":491}],145:[function(t,n,i){n.exports=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme"> <a:themeElements> <a:clrScheme name="Office"> <a:dk1> <a:sysClr val="windowText" lastClr="000000"/> </a:dk1> <a:lt1> <a:sysClr val="window" lastClr="FFFFFF"/> </a:lt1> <a:dk2> <a:srgbClr val="1F497D"/> </a:dk2> <a:lt2> <a:srgbClr val="EEECE1"/> </a:lt2> <a:accent1> <a:srgbClr val="4F81BD"/> </a:accent1> <a:accent2> <a:srgbClr val="C0504D"/> </a:accent2> <a:accent3> <a:srgbClr val="9BBB59"/> </a:accent3> <a:accent4> <a:srgbClr val="8064A2"/> </a:accent4> <a:accent5> <a:srgbClr val="4BACC6"/> </a:accent5> <a:accent6> <a:srgbClr val="F79646"/> </a:accent6> <a:hlink> <a:srgbClr val="0000FF"/> </a:hlink> <a:folHlink> <a:srgbClr val="800080"/> </a:folHlink> </a:clrScheme> <a:fontScheme name="Office"> <a:majorFont> <a:latin typeface="Cambria"/> <a:ea typeface=""/> <a:cs typeface=""/> <a:font script="Jpan" typeface=" "/> <a:font script="Hang" typeface=" "/> <a:font script="Hans" typeface=""/> <a:font script="Hant" typeface=""/> <a:font script="Arab" typeface="Times New Roman"/> <a:font script="Hebr" typeface="Times New Roman"/> <a:font script="Thai" typeface="Tahoma"/> <a:font script="Ethi" typeface="Nyala"/> <a:font script="Beng" typeface="Vrinda"/> <a:font script="Gujr" typeface="Shruti"/> <a:font script="Khmr" typeface="MoolBoran"/> <a:font script="Knda" typeface="Tunga"/> <a:font script="Guru" typeface="Raavi"/> <a:font script="Cans" typeface="Euphemia"/> <a:font script="Cher" typeface="Plantagenet Cherokee"/> <a:font script="Yiii" typeface="Microsoft Yi Baiti"/> <a:font script="Tibt" typeface="Microsoft Himalaya"/> <a:font script="Thaa" typeface="MV Boli"/> <a:font script="Deva" typeface="Mangal"/> <a:font script="Telu" typeface="Gautami"/> <a:font script="Taml" typeface="Latha"/> <a:font script="Syrc" typeface="Estrangelo Edessa"/> <a:font script="Orya" typeface="Kalinga"/> <a:font script="Mlym" typeface="Kartika"/> <a:font script="Laoo" typeface="DokChampa"/> <a:font script="Sinh" typeface="Iskoola Pota"/> <a:font script="Mong" typeface="Mongolian Baiti"/> <a:font script="Viet" typeface="Times New Roman"/> <a:font script="Uigh" typeface="Microsoft Uighur"/> <a:font script="Geor" typeface="Sylfaen"/> </a:majorFont> <a:minorFont> <a:latin typeface="Calibri"/> <a:ea typeface=""/> <a:cs typeface=""/> <a:font script="Jpan" typeface=" "/> <a:font script="Hang" typeface=" "/> <a:font script="Hans" typeface=""/> <a:font script="Hant" typeface=""/> <a:font script="Arab" typeface="Arial"/> <a:font script="Hebr" typeface="Arial"/> <a:font script="Thai" typeface="Tahoma"/> <a:font script="Ethi" typeface="Nyala"/> <a:font script="Beng" typeface="Vrinda"/> <a:font script="Gujr" typeface="Shruti"/> <a:font script="Khmr" typeface="DaunPenh"/> <a:font script="Knda" typeface="Tunga"/> <a:font script="Guru" typeface="Raavi"/> <a:font script="Cans" typeface="Euphemia"/> <a:font script="Cher" typeface="Plantagenet Cherokee"/> <a:font script="Yiii" typeface="Microsoft Yi Baiti"/> <a:font script="Tibt" typeface="Microsoft Himalaya"/> <a:font script="Thaa" typeface="MV Boli"/> <a:font script="Deva" typeface="Mangal"/> <a:font script="Telu" typeface="Gautami"/> <a:font script="Taml" typeface="Latha"/> <a:font script="Syrc" typeface="Estrangelo Edessa"/> <a:font script="Orya" typeface="Kalinga"/> <a:font script="Mlym" typeface="Kartika"/> <a:font script="Laoo" typeface="DokChampa"/> <a:font script="Sinh" typeface="Iskoola Pota"/> <a:font script="Mong" typeface="Mongolian Baiti"/> <a:font script="Viet" typeface="Arial"/> <a:font script="Uigh" typeface="Microsoft Uighur"/> <a:font script="Geor" typeface="Sylfaen"/> </a:minorFont> </a:fontScheme> <a:fmtScheme name="Office"> <a:fillStyleLst> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="50000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="35000"> <a:schemeClr val="phClr"> <a:tint val="37000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:tint val="15000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:lin ang="16200000" scaled="1"/> </a:gradFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="100000"/> <a:shade val="100000"/> <a:satMod val="130000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:tint val="50000"/> <a:shade val="100000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:lin ang="16200000" scaled="0"/> </a:gradFill> </a:fillStyleLst> <a:lnStyleLst> <a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"> <a:shade val="95000"/> <a:satMod val="105000"/> </a:schemeClr> </a:solidFill> <a:prstDash val="solid"/> </a:ln> <a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:prstDash val="solid"/> </a:ln> <a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:prstDash val="solid"/> </a:ln> </a:lnStyleLst> <a:effectStyleLst> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="38000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> </a:effectStyle> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="35000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> </a:effectStyle> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="35000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> <a:scene3d> <a:camera prst="orthographicFront"> <a:rot lat="0" lon="0" rev="0"/> </a:camera> <a:lightRig rig="threePt" dir="t"> <a:rot lat="0" lon="0" rev="1200000"/> </a:lightRig> </a:scene3d> <a:sp3d> <a:bevelT w="63500" h="25400"/> </a:sp3d> </a:effectStyle> </a:effectStyleLst> <a:bgFillStyleLst> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="40000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> <a:gs pos="40000"> <a:schemeClr val="phClr"> <a:tint val="45000"/> <a:shade val="99000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:shade val="20000"/> <a:satMod val="255000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:path path="circle"> <a:fillToRect l="50000" t="-80000" r="50000" b="180000"/> </a:path> </a:gradFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="80000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:shade val="30000"/> <a:satMod val="200000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:path path="circle"> <a:fillToRect l="50000" t="50000" r="50000" b="50000"/> </a:path> </a:gradFill> </a:bgFillStyleLst> </a:fmtScheme> </a:themeElements> <a:objectDefaults> <a:spDef> <a:spPr/> <a:bodyPr/> <a:lstStyle/> <a:style> <a:lnRef idx="1"> <a:schemeClr val="accent1"/> </a:lnRef> <a:fillRef idx="3"> <a:schemeClr val="accent1"/> </a:fillRef> <a:effectRef idx="2"> <a:schemeClr val="accent1"/> </a:effectRef> <a:fontRef idx="minor"> <a:schemeClr val="lt1"/> </a:fontRef> </a:style> </a:spDef> <a:lnDef> <a:spPr/> <a:bodyPr/> <a:lstStyle/> <a:style> <a:lnRef idx="2"> <a:schemeClr val="accent1"/> </a:lnRef> <a:fillRef idx="0"> <a:schemeClr val="accent1"/> </a:fillRef> <a:effectRef idx="1"> <a:schemeClr val="accent1"/> </a:effectRef> <a:fontRef idx="minor"> <a:schemeClr val="tx1"/> </a:fontRef> </a:style> </a:lnDef> </a:objectDefaults> <a:extraClrSchemeLst/> </a:theme>`},{}],146:[function(t,n,i){(function(s){(function(){Object.defineProperty(i,"__esModule",{value:!0}),i.CsvFormatterStream=void 0;const o=t("stream"),a=t("./formatter");class l extends o.Transform{constructor(c){super({writableObjectMode:c.objectMode}),this.hasWrittenBOM=!1,this.formatterOptions=c,this.rowFormatter=new a.RowFormatter(c),this.hasWrittenBOM=!c.writeBOM}transform(c){return this.rowFormatter.rowTransform=c,this}_transform(c,d,h){let f=!1;try{this.hasWrittenBOM||(this.push(this.formatterOptions.BOM),this.hasWrittenBOM=!0),this.rowFormatter.format(c,(m,p)=>m?(f=!0,h(m)):(p&&p.forEach(g=>{this.push(s.from(g,"utf8"))}),f=!0,h()))}catch(m){if(f)throw m;h(m)}}_flush(c){this.rowFormatter.finish((d,h)=>d?c(d):(h&&h.forEach(f=>{this.push(s.from(f,"utf8"))}),c()))}}i.CsvFormatterStream=l}).call(this)}).call(this,t("buffer").Buffer)},{"./formatter":150,buffer:220,stream:505}],147:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FormatterOptions=void 0,i.FormatterOptions=class{constructor(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};var o;this.objectMode=!0,this.delimiter=",",this.rowDelimiter=`
`,this.quote='"',this.escape=this.quote,this.quoteColumns=!1,this.quoteHeaders=this.quoteColumns,this.headers=null,this.includeEndRowDelimiter=!1,this.writeBOM=!1,this.BOM="\uFEFF",this.alwaysWriteHeaders=!1,Object.assign(this,s||{}),s?.quoteHeaders===void 0&&(this.quoteHeaders=this.quoteColumns),s?.quote===!0?this.quote='"':s?.quote===!1&&(this.quote=""),typeof s?.escape!="string"&&(this.escape=this.quote),this.shouldWriteHeaders=!!this.headers&&((o=s.writeHeaders)===null||o===void 0||o),this.headers=Array.isArray(this.headers)?this.headers:null,this.escapedQuote=`${this.escape}${this.quote}`}}},{}],148:[function(t,n,i){var s=function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(i,"__esModule",{value:!0}),i.FieldFormatter=void 0;const o=s(t("lodash.isboolean")),a=s(t("lodash.isnil")),l=s(t("lodash.escaperegexp"));i.FieldFormatter=class{constructor(u){this._headers=null,this.formatterOptions=u,u.headers!==null&&(this.headers=u.headers),this.REPLACE_REGEXP=new RegExp(u.quote,"g");const c=`[${u.delimiter}${l.default(u.rowDelimiter)}|\r|
]`;this.ESCAPE_REGEXP=new RegExp(c)}set headers(u){this._headers=u}shouldQuote(u,c){const d=c?this.formatterOptions.quoteHeaders:this.formatterOptions.quoteColumns;return o.default(d)?d:Array.isArray(d)?d[u]:this._headers!==null&&d[this._headers[u]]}format(u,c,d){const h=(""+(a.default(u)?"":u)).replace(/\0/g,""),{formatterOptions:f}=this;return f.quote!==""&&h.indexOf(f.quote)!==-1?this.quoteField(h.replace(this.REPLACE_REGEXP,f.escapedQuote)):h.search(this.ESCAPE_REGEXP)!==-1||this.shouldQuote(c,d)?this.quoteField(h):h}quoteField(u){const{quote:c}=this.formatterOptions;return`${c}${u}${c}`}}},{"lodash.escaperegexp":442,"lodash.isboolean":444,"lodash.isnil":447}],149:[function(t,n,i){var s=function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(i,"__esModule",{value:!0}),i.RowFormatter=void 0;const o=s(t("lodash.isfunction")),a=s(t("lodash.isequal")),l=t("./FieldFormatter"),u=t("../types");class c{constructor(h){this.rowCount=0,this.formatterOptions=h,this.fieldFormatter=new l.FieldFormatter(h),this.headers=h.headers,this.shouldWriteHeaders=h.shouldWriteHeaders,this.hasWrittenHeaders=!1,this.headers!==null&&(this.fieldFormatter.headers=this.headers),h.transform&&(this.rowTransform=h.transform)}static isRowHashArray(h){return!!Array.isArray(h)&&Array.isArray(h[0])&&h[0].length===2}static isRowArray(h){return Array.isArray(h)&&!this.isRowHashArray(h)}static gatherHeaders(h){return c.isRowHashArray(h)?h.map(f=>f[0]):Array.isArray(h)?h:Object.keys(h)}static createTransform(h){return u.isSyncTransform(h)?(f,m)=>{let p=null;try{p=h(f)}catch(g){return m(g)}return m(null,p)}:(f,m)=>{h(f,m)}}set rowTransform(h){if(!o.default(h))throw new TypeError("The transform should be a function");this._rowTransform=c.createTransform(h)}format(h,f){this.callTransformer(h,(m,p)=>{if(m)return f(m);if(!h)return f(null);const g=[];if(p){const{shouldFormatColumns:v,headers:y}=this.checkHeaders(p);if(this.shouldWriteHeaders&&y&&!this.hasWrittenHeaders&&(g.push(this.formatColumns(y,!0)),this.hasWrittenHeaders=!0),v){const b=this.gatherColumns(p);g.push(this.formatColumns(b,!1))}}return f(null,g)})}finish(h){const f=[];if(this.formatterOptions.alwaysWriteHeaders&&this.rowCount===0){if(!this.headers)return h(new Error("`alwaysWriteHeaders` option is set to true but `headers` option not provided."));f.push(this.formatColumns(this.headers,!0))}return this.formatterOptions.includeEndRowDelimiter&&f.push(this.formatterOptions.rowDelimiter),h(null,f)}checkHeaders(h){if(this.headers)return{shouldFormatColumns:!0,headers:this.headers};const f=c.gatherHeaders(h);return this.headers=f,this.fieldFormatter.headers=f,this.shouldWriteHeaders?{shouldFormatColumns:!a.default(f,h),headers:f}:{shouldFormatColumns:!0,headers:null}}gatherColumns(h){if(this.headers===null)throw new Error("Headers is currently null");return Array.isArray(h)?c.isRowHashArray(h)?this.headers.map((f,m)=>{const p=h[m];return p?p[1]:""}):c.isRowArray(h)&&!this.shouldWriteHeaders?h:this.headers.map((f,m)=>h[m]):this.headers.map(f=>h[f])}callTransformer(h,f){return this._rowTransform?this._rowTransform(h,f):f(null,h)}formatColumns(h,f){const m=h.map((g,v)=>this.fieldFormatter.format(g,v,f)).join(this.formatterOptions.delimiter),{rowCount:p}=this;return this.rowCount+=1,p?[this.formatterOptions.rowDelimiter,m].join(""):m}}i.RowFormatter=c},{"../types":152,"./FieldFormatter":148,"lodash.isequal":445,"lodash.isfunction":446}],150:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FieldFormatter=i.RowFormatter=void 0;var s=t("./RowFormatter");Object.defineProperty(i,"RowFormatter",{enumerable:!0,get:function(){return s.RowFormatter}});var o=t("./FieldFormatter");Object.defineProperty(i,"FieldFormatter",{enumerable:!0,get:function(){return o.FieldFormatter}})},{"./FieldFormatter":148,"./RowFormatter":149}],151:[function(t,n,i){(function(s){(function(){var o=Object.create?function(v,y,b,E){E===void 0&&(E=b),Object.defineProperty(v,E,{enumerable:!0,get:function(){return y[b]}})}:function(v,y,b,E){E===void 0&&(E=b),v[E]=y[b]},a=Object.create?function(v,y){Object.defineProperty(v,"default",{enumerable:!0,value:y})}:function(v,y){v.default=y},l=function(v){if(v&&v.__esModule)return v;var y={};if(v!=null)for(var b in v)b!=="default"&&Object.prototype.hasOwnProperty.call(v,b)&&o(y,v,b);return a(y,v),y},u=function(v,y){for(var b in v)b==="default"||Object.prototype.hasOwnProperty.call(y,b)||o(y,v,b)};Object.defineProperty(i,"__esModule",{value:!0}),i.writeToPath=i.writeToString=i.writeToBuffer=i.writeToStream=i.write=i.format=i.FormatterOptions=i.CsvFormatterStream=void 0;const c=t("util"),d=t("stream"),h=l(t("fs")),f=t("./FormatterOptions"),m=t("./CsvFormatterStream");u(t("./types"),i);var p=t("./CsvFormatterStream");Object.defineProperty(i,"CsvFormatterStream",{enumerable:!0,get:function(){return p.CsvFormatterStream}});var g=t("./FormatterOptions");Object.defineProperty(i,"FormatterOptions",{enumerable:!0,get:function(){return g.FormatterOptions}}),i.format=v=>new m.CsvFormatterStream(new f.FormatterOptions(v)),i.write=(v,y)=>{const b=i.format(y),E=c.promisify((A,M)=>{b.write(A,void 0,M)});return v.reduce((A,M)=>A.then(()=>E(M)),Promise.resolve()).then(()=>b.end()).catch(A=>{b.emit("error",A)}),b},i.writeToStream=(v,y,b)=>i.write(y,b).pipe(v),i.writeToBuffer=function(v){let y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const b=[],E=new d.Writable({write(A,M,L){b.push(A),L()}});return new Promise((A,M)=>{E.on("error",M).on("finish",()=>A(s.concat(b))),i.write(v,y).pipe(E)})},i.writeToString=(v,y)=>i.writeToBuffer(v,y).then(b=>b.toString()),i.writeToPath=(v,y,b)=>{const E=h.createWriteStream(v,{encoding:"utf8"});return i.write(y,b).pipe(E)}}).call(this)}).call(this,t("buffer").Buffer)},{"./CsvFormatterStream":146,"./FormatterOptions":147,"./types":152,buffer:220,fs:216,stream:505,util:527}],152:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.isSyncTransform=void 0,i.isSyncTransform=s=>s.length===1},{}],153:[function(t,n,i){(function(s){(function(){Object.defineProperty(i,"__esModule",{value:!0}),i.CsvParserStream=void 0;const o=t("string_decoder"),a=t("stream"),l=t("./transforms"),u=t("./parser");class c extends a.Transform{constructor(h){super({objectMode:h.objectMode}),this.lines="",this.rowCount=0,this.parsedRowCount=0,this.parsedLineCount=0,this.endEmitted=!1,this.headersEmitted=!1,this.parserOptions=h,this.parser=new u.Parser(h),this.headerTransformer=new l.HeaderTransformer(h),this.decoder=new o.StringDecoder(h.encoding),this.rowTransformerValidator=new l.RowTransformerValidator}get hasHitRowLimit(){return this.parserOptions.limitRows&&this.rowCount>=this.parserOptions.maxRows}get shouldEmitRows(){return this.parsedRowCount>this.parserOptions.skipRows}get shouldSkipLine(){return this.parsedLineCount<=this.parserOptions.skipLines}transform(h){return this.rowTransformerValidator.rowTransform=h,this}validate(h){return this.rowTransformerValidator.rowValidator=h,this}emit(h){if(h==="end")return this.endEmitted||(this.endEmitted=!0,super.emit("end",this.rowCount)),!1;for(var f=arguments.length,m=new Array(f>1?f-1:0),p=1;p<f;p++)m[p-1]=arguments[p];return super.emit(h,...m)}_transform(h,f,m){if(this.hasHitRowLimit)return m();const p=c.wrapDoneCallback(m);try{const{lines:g}=this,v=g+this.decoder.write(h),y=this.parse(v,!0);return this.processRows(y,p)}catch(g){return p(g)}}_flush(h){const f=c.wrapDoneCallback(h);if(this.hasHitRowLimit)return f();try{const m=this.lines+this.decoder.end(),p=this.parse(m,!1);return this.processRows(p,f)}catch(m){return f(m)}}parse(h,f){if(!h)return[];const{line:m,rows:p}=this.parser.parse(h,f);return this.lines=m,p}processRows(h,f){const m=h.length,p=g=>{const v=E=>E?f(E):g%100!=0?p(g+1):void s(()=>p(g+1));if(this.checkAndEmitHeaders(),g>=m||this.hasHitRowLimit)return f();if(this.parsedLineCount+=1,this.shouldSkipLine)return v();const y=h[g];this.rowCount+=1,this.parsedRowCount+=1;const b=this.rowCount;return this.transformRow(y,(E,A)=>{if(E)return this.rowCount-=1,v(E);if(!A)return v(new Error("expected transform result"));if(A.isValid){if(A.row)return this.pushRow(A.row,v)}else this.emit("data-invalid",A.row,b,A.reason);return v()})};p(0)}transformRow(h,f){try{this.headerTransformer.transform(h,(m,p)=>m?f(m):p?p.isValid?p.row?this.shouldEmitRows?this.rowTransformerValidator.transformAndValidate(p.row,f):this.skipRow(f):(this.rowCount-=1,this.parsedRowCount-=1,f(null,{row:null,isValid:!0})):this.shouldEmitRows?f(null,{isValid:!1,row:h}):this.skipRow(f):f(new Error("Expected result from header transform")))}catch(m){f(m)}}checkAndEmitHeaders(){!this.headersEmitted&&this.headerTransformer.headers&&(this.headersEmitted=!0,this.emit("headers",this.headerTransformer.headers))}skipRow(h){return this.rowCount-=1,h(null,{row:null,isValid:!0})}pushRow(h,f){try{this.parserOptions.objectMode?this.push(h):this.push(JSON.stringify(h)),f()}catch(m){f(m)}}static wrapDoneCallback(h){let f=!1;return function(m){if(m){if(f)throw m;return f=!0,void h(m)}for(var p=arguments.length,g=new Array(p>1?p-1:0),v=1;v<p;v++)g[v-1]=arguments[v];h(...g)}}}i.CsvParserStream=c}).call(this)}).call(this,t("timers").setImmediate)},{"./parser":165,"./transforms":168,stream:505,string_decoder:218,timers:523}],154:[function(t,n,i){var s=function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(i,"__esModule",{value:!0}),i.ParserOptions=void 0;const o=s(t("lodash.escaperegexp")),a=s(t("lodash.isnil"));i.ParserOptions=class{constructor(l){var u;if(this.objectMode=!0,this.delimiter=",",this.ignoreEmpty=!1,this.quote='"',this.escape=null,this.escapeChar=this.quote,this.comment=null,this.supportsComments=!1,this.ltrim=!1,this.rtrim=!1,this.trim=!1,this.headers=null,this.renameHeaders=!1,this.strictColumnHandling=!1,this.discardUnmappedColumns=!1,this.carriageReturn="\r",this.encoding="utf8",this.limitRows=!1,this.maxRows=0,this.skipLines=0,this.skipRows=0,Object.assign(this,l||{}),this.delimiter.length>1)throw new Error("delimiter option must be one character long");this.escapedDelimiter=o.default(this.delimiter),this.escapeChar=(u=this.escape)!==null&&u!==void 0?u:this.quote,this.supportsComments=!a.default(this.comment),this.NEXT_TOKEN_REGEXP=new RegExp(`([^\\s]|\\r\\n|\\n|\\r|${this.escapedDelimiter})`),this.maxRows>0&&(this.limitRows=!0)}}},{"lodash.escaperegexp":442,"lodash.isnil":447}],155:[function(t,n,i){var s=Object.create?function(p,g,v,y){y===void 0&&(y=v),Object.defineProperty(p,y,{enumerable:!0,get:function(){return g[v]}})}:function(p,g,v,y){y===void 0&&(y=v),p[y]=g[v]},o=Object.create?function(p,g){Object.defineProperty(p,"default",{enumerable:!0,value:g})}:function(p,g){p.default=g},a=function(p){if(p&&p.__esModule)return p;var g={};if(p!=null)for(var v in p)v!=="default"&&Object.prototype.hasOwnProperty.call(p,v)&&s(g,p,v);return o(g,p),g},l=function(p,g){for(var v in p)v==="default"||Object.prototype.hasOwnProperty.call(g,v)||s(g,p,v)};Object.defineProperty(i,"__esModule",{value:!0}),i.parseString=i.parseFile=i.parseStream=i.parse=i.ParserOptions=i.CsvParserStream=void 0;const u=a(t("fs")),c=t("stream"),d=t("./ParserOptions"),h=t("./CsvParserStream");l(t("./types"),i);var f=t("./CsvParserStream");Object.defineProperty(i,"CsvParserStream",{enumerable:!0,get:function(){return f.CsvParserStream}});var m=t("./ParserOptions");Object.defineProperty(i,"ParserOptions",{enumerable:!0,get:function(){return m.ParserOptions}}),i.parse=p=>new h.CsvParserStream(new d.ParserOptions(p)),i.parseStream=(p,g)=>p.pipe(new h.CsvParserStream(new d.ParserOptions(g))),i.parseFile=function(p){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return u.createReadStream(p).pipe(new h.CsvParserStream(new d.ParserOptions(g)))},i.parseString=(p,g)=>{const v=new c.Readable;return v.push(p),v.push(null),v.pipe(new h.CsvParserStream(new d.ParserOptions(g)))}},{"./CsvParserStream":153,"./ParserOptions":154,"./types":169,fs:216,stream:505}],156:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.Parser=void 0;const s=t("./Scanner"),o=t("./RowParser"),a=t("./Token");class l{constructor(c){this.parserOptions=c,this.rowParser=new o.RowParser(this.parserOptions)}static removeBOM(c){return c&&c.charCodeAt(0)===65279?c.slice(1):c}parse(c,d){const h=new s.Scanner({line:l.removeBOM(c),parserOptions:this.parserOptions,hasMoreData:d});return this.parserOptions.supportsComments?this.parseWithComments(h):this.parseWithoutComments(h)}parseWithoutComments(c){const d=[];let h=!0;for(;h;)h=this.parseRow(c,d);return{line:c.line,rows:d}}parseWithComments(c){const{parserOptions:d}=this,h=[];for(let f=c.nextCharacterToken;f!==null;f=c.nextCharacterToken)if(a.Token.isTokenComment(f,d)){if(c.advancePastLine()===null)return{line:c.lineFromCursor,rows:h};if(!c.hasMoreCharacters)return{line:c.lineFromCursor,rows:h};c.truncateToCursor()}else if(!this.parseRow(c,h))break;return{line:c.line,rows:h}}parseRow(c,d){if(!c.nextNonSpaceToken)return!1;const h=this.rowParser.parse(c);return h!==null&&(this.parserOptions.ignoreEmpty&&o.RowParser.isEmptyRow(h)||d.push(h),!0)}}i.Parser=l},{"./RowParser":157,"./Scanner":158,"./Token":159}],157:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.RowParser=void 0;const s=t("./column"),o=t("./Token");i.RowParser=class{constructor(a){this.parserOptions=a,this.columnParser=new s.ColumnParser(a)}static isEmptyRow(a){return a.join("").replace(/\s+/g,"")===""}parse(a){const{parserOptions:l}=this,{hasMoreData:u}=a,c=a,d=[];let h=this.getStartToken(c,d);for(;h;){if(o.Token.isTokenRowDelimiter(h))return c.advancePastToken(h),!c.hasMoreCharacters&&o.Token.isTokenCarriageReturn(h,l)&&u?null:(c.truncateToCursor(),d);if(!this.shouldSkipColumnParse(c,h,d)){const f=this.columnParser.parse(c);if(f===null)return null;d.push(f)}h=c.nextNonSpaceToken}return u?null:(c.truncateToCursor(),d)}getStartToken(a,l){const u=a.nextNonSpaceToken;return u!==null&&o.Token.isTokenDelimiter(u,this.parserOptions)?(l.push(""),a.nextNonSpaceToken):u}shouldSkipColumnParse(a,l,u){const{parserOptions:c}=this;if(o.Token.isTokenDelimiter(l,c)){a.advancePastToken(l);const d=a.nextCharacterToken;if(!a.hasMoreCharacters||d!==null&&o.Token.isTokenRowDelimiter(d)||d!==null&&o.Token.isTokenDelimiter(d,c))return u.push(""),!0}return!1}}},{"./Token":159,"./column":164}],158:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.Scanner=void 0;const s=t("./Token"),o=/((?:\r\n)|\n|\r)/;i.Scanner=class{constructor(a){this.cursor=0,this.line=a.line,this.lineLength=this.line.length,this.parserOptions=a.parserOptions,this.hasMoreData=a.hasMoreData,this.cursor=a.cursor||0}get hasMoreCharacters(){return this.lineLength>this.cursor}get nextNonSpaceToken(){const{lineFromCursor:a}=this,l=this.parserOptions.NEXT_TOKEN_REGEXP;if(a.search(l)===-1)return null;const u=l.exec(a);if(u==null)return null;const c=u[1],d=this.cursor+(u.index||0);return new s.Token({token:c,startCursor:d,endCursor:d+c.length-1})}get nextCharacterToken(){const{cursor:a,lineLength:l}=this;return l<=a?null:new s.Token({token:this.line[a],startCursor:a,endCursor:a})}get lineFromCursor(){return this.line.substr(this.cursor)}advancePastLine(){const a=o.exec(this.lineFromCursor);return a?(this.cursor+=(a.index||0)+a[0].length,this):this.hasMoreData?null:(this.cursor=this.lineLength,this)}advanceTo(a){return this.cursor=a,this}advanceToToken(a){return this.cursor=a.startCursor,this}advancePastToken(a){return this.cursor=a.endCursor+1,this}truncateToCursor(){return this.line=this.lineFromCursor,this.lineLength=this.line.length,this.cursor=0,this}}},{"./Token":159}],159:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.Token=void 0,i.Token=class{constructor(s){this.token=s.token,this.startCursor=s.startCursor,this.endCursor=s.endCursor}static isTokenRowDelimiter(s){const o=s.token;return o==="\r"||o===`
`||o===`\r
`}static isTokenCarriageReturn(s,o){return s.token===o.carriageReturn}static isTokenComment(s,o){return o.supportsComments&&!!s&&s.token===o.comment}static isTokenEscapeCharacter(s,o){return s.token===o.escapeChar}static isTokenQuote(s,o){return s.token===o.quote}static isTokenDelimiter(s,o){return s.token===o.delimiter}}},{}],160:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.ColumnFormatter=void 0,i.ColumnFormatter=class{constructor(s){s.trim?this.format=o=>o.trim():s.ltrim?this.format=o=>o.trimLeft():s.rtrim?this.format=o=>o.trimRight():this.format=o=>o}}},{}],161:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.ColumnParser=void 0;const s=t("./NonQuotedColumnParser"),o=t("./QuotedColumnParser"),a=t("../Token");i.ColumnParser=class{constructor(l){this.parserOptions=l,this.quotedColumnParser=new o.QuotedColumnParser(l),this.nonQuotedColumnParser=new s.NonQuotedColumnParser(l)}parse(l){const{nextNonSpaceToken:u}=l;return u!==null&&a.Token.isTokenQuote(u,this.parserOptions)?(l.advanceToToken(u),this.quotedColumnParser.parse(l)):this.nonQuotedColumnParser.parse(l)}}},{"../Token":159,"./NonQuotedColumnParser":162,"./QuotedColumnParser":163}],162:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.NonQuotedColumnParser=void 0;const s=t("./ColumnFormatter"),o=t("../Token");i.NonQuotedColumnParser=class{constructor(a){this.parserOptions=a,this.columnFormatter=new s.ColumnFormatter(a)}parse(a){if(!a.hasMoreCharacters)return null;const{parserOptions:l}=this,u=[];let c=a.nextCharacterToken;for(;c&&!o.Token.isTokenDelimiter(c,l)&&!o.Token.isTokenRowDelimiter(c);c=a.nextCharacterToken)u.push(c.token),a.advancePastToken(c);return this.columnFormatter.format(u.join(""))}}},{"../Token":159,"./ColumnFormatter":160}],163:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.QuotedColumnParser=void 0;const s=t("./ColumnFormatter"),o=t("../Token");i.QuotedColumnParser=class{constructor(a){this.parserOptions=a,this.columnFormatter=new s.ColumnFormatter(a)}parse(a){if(!a.hasMoreCharacters)return null;const l=a.cursor,{foundClosingQuote:u,col:c}=this.gatherDataBetweenQuotes(a);if(!u){if(a.advanceTo(l),!a.hasMoreData)throw new Error(`Parse Error: missing closing: '${this.parserOptions.quote||""}' in line: at '${a.lineFromCursor.replace(/[\r\n]/g,"\\n'")}'`);return null}return this.checkForMalformedColumn(a),c}gatherDataBetweenQuotes(a){const{parserOptions:l}=this;let u=!1,c=!1;const d=[];let h=a.nextCharacterToken;for(;!c&&h!==null;h=a.nextCharacterToken){const f=o.Token.isTokenQuote(h,l);if(!u&&f)u=!0;else if(u)if(o.Token.isTokenEscapeCharacter(h,l)){a.advancePastToken(h);const m=a.nextCharacterToken;m!==null&&(o.Token.isTokenQuote(m,l)||o.Token.isTokenEscapeCharacter(m,l))?(d.push(m.token),h=m):f?c=!0:d.push(h.token)}else f?c=!0:d.push(h.token);a.advancePastToken(h)}return{col:this.columnFormatter.format(d.join("")),foundClosingQuote:c}}checkForMalformedColumn(a){const{parserOptions:l}=this,{nextNonSpaceToken:u}=a;if(u){const c=o.Token.isTokenDelimiter(u,l),d=o.Token.isTokenRowDelimiter(u);if(!c&&!d){const h=a.lineFromCursor.substr(0,10).replace(/[\r\n]/g,"\\n'");throw new Error(`Parse Error: expected: '${l.escapedDelimiter}' OR new line got: '${u.token}'. at '${h}`)}a.advanceToToken(u)}else a.hasMoreData||a.advancePastLine()}}},{"../Token":159,"./ColumnFormatter":160}],164:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.ColumnFormatter=i.QuotedColumnParser=i.NonQuotedColumnParser=i.ColumnParser=void 0;var s=t("./ColumnParser");Object.defineProperty(i,"ColumnParser",{enumerable:!0,get:function(){return s.ColumnParser}});var o=t("./NonQuotedColumnParser");Object.defineProperty(i,"NonQuotedColumnParser",{enumerable:!0,get:function(){return o.NonQuotedColumnParser}});var a=t("./QuotedColumnParser");Object.defineProperty(i,"QuotedColumnParser",{enumerable:!0,get:function(){return a.QuotedColumnParser}});var l=t("./ColumnFormatter");Object.defineProperty(i,"ColumnFormatter",{enumerable:!0,get:function(){return l.ColumnFormatter}})},{"./ColumnFormatter":160,"./ColumnParser":161,"./NonQuotedColumnParser":162,"./QuotedColumnParser":163}],165:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.QuotedColumnParser=i.NonQuotedColumnParser=i.ColumnParser=i.Token=i.Scanner=i.RowParser=i.Parser=void 0;var s=t("./Parser");Object.defineProperty(i,"Parser",{enumerable:!0,get:function(){return s.Parser}});var o=t("./RowParser");Object.defineProperty(i,"RowParser",{enumerable:!0,get:function(){return o.RowParser}});var a=t("./Scanner");Object.defineProperty(i,"Scanner",{enumerable:!0,get:function(){return a.Scanner}});var l=t("./Token");Object.defineProperty(i,"Token",{enumerable:!0,get:function(){return l.Token}});var u=t("./column");Object.defineProperty(i,"ColumnParser",{enumerable:!0,get:function(){return u.ColumnParser}}),Object.defineProperty(i,"NonQuotedColumnParser",{enumerable:!0,get:function(){return u.NonQuotedColumnParser}}),Object.defineProperty(i,"QuotedColumnParser",{enumerable:!0,get:function(){return u.QuotedColumnParser}})},{"./Parser":156,"./RowParser":157,"./Scanner":158,"./Token":159,"./column":164}],166:[function(t,n,i){var s=function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(i,"__esModule",{value:!0}),i.HeaderTransformer=void 0;const o=s(t("lodash.isundefined")),a=s(t("lodash.isfunction")),l=s(t("lodash.uniq")),u=s(t("lodash.groupby"));i.HeaderTransformer=class{constructor(c){this.headers=null,this.receivedHeaders=!1,this.shouldUseFirstRow=!1,this.processedFirstRow=!1,this.headersLength=0,this.parserOptions=c,c.headers===!0?this.shouldUseFirstRow=!0:Array.isArray(c.headers)?this.setHeaders(c.headers):a.default(c.headers)&&(this.headersTransform=c.headers)}transform(c,d){return this.shouldMapRow(c)?d(null,this.processRow(c)):d(null,{row:null,isValid:!0})}shouldMapRow(c){const{parserOptions:d}=this;if(!this.headersTransform&&d.renameHeaders&&!this.processedFirstRow){if(!this.receivedHeaders)throw new Error("Error renaming headers: new headers must be provided in an array");return this.processedFirstRow=!0,!1}if(!this.receivedHeaders&&Array.isArray(c)){if(this.headersTransform)this.setHeaders(this.headersTransform(c));else{if(!this.shouldUseFirstRow)return!0;this.setHeaders(c)}return!1}return!0}processRow(c){if(!this.headers)return{row:c,isValid:!0};const{parserOptions:d}=this;if(!d.discardUnmappedColumns&&c.length>this.headersLength){if(!d.strictColumnHandling)throw new Error(`Unexpected Error: column header mismatch expected: ${this.headersLength} columns got: ${c.length}`);return{row:c,isValid:!1,reason:`Column header mismatch expected: ${this.headersLength} columns got: ${c.length}`}}return d.strictColumnHandling&&c.length<this.headersLength?{row:c,isValid:!1,reason:`Column header mismatch expected: ${this.headersLength} columns got: ${c.length}`}:{row:this.mapHeaders(c),isValid:!0}}mapHeaders(c){const d={},{headers:h,headersLength:f}=this;for(let m=0;m<f;m+=1){const p=h[m];if(!o.default(p)){const g=c[m];o.default(g)?d[p]="":d[p]=g}}return d}setHeaders(c){var d;const h=c.filter(f=>!!f);if(l.default(h).length!==h.length){const f=u.default(h),m=Object.keys(f).filter(p=>f[p].length>1);throw new Error("Duplicate headers found "+JSON.stringify(m))}this.headers=c,this.receivedHeaders=!0,this.headersLength=((d=this.headers)===null||d===void 0?void 0:d.length)||0}}},{"lodash.groupby":443,"lodash.isfunction":446,"lodash.isundefined":448,"lodash.uniq":449}],167:[function(t,n,i){var s=function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(i,"__esModule",{value:!0}),i.RowTransformerValidator=void 0;const o=s(t("lodash.isfunction")),a=t("../types");class l{constructor(){this._rowTransform=null,this._rowValidator=null}static createTransform(c){return a.isSyncTransform(c)?(d,h)=>{let f=null;try{f=c(d)}catch(m){return h(m)}return h(null,f)}:c}static createValidator(c){return a.isSyncValidate(c)?(d,h)=>{h(null,{row:d,isValid:c(d)})}:(d,h)=>{c(d,(f,m,p)=>f?h(f):h(null,m?{row:d,isValid:m,reason:p}:{row:d,isValid:!1,reason:p}))}}set rowTransform(c){if(!o.default(c))throw new TypeError("The transform should be a function");this._rowTransform=l.createTransform(c)}set rowValidator(c){if(!o.default(c))throw new TypeError("The validate should be a function");this._rowValidator=l.createValidator(c)}transformAndValidate(c,d){return this.callTransformer(c,(h,f)=>h?d(h):f?this.callValidator(f,(m,p)=>m?d(m):p&&!p.isValid?d(null,{row:f,isValid:!1,reason:p.reason}):d(null,{row:f,isValid:!0})):d(null,{row:null,isValid:!0}))}callTransformer(c,d){return this._rowTransform?this._rowTransform(c,d):d(null,c)}callValidator(c,d){return this._rowValidator?this._rowValidator(c,d):d(null,{row:c,isValid:!0})}}i.RowTransformerValidator=l},{"../types":169,"lodash.isfunction":446}],168:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.HeaderTransformer=i.RowTransformerValidator=void 0;var s=t("./RowTransformerValidator");Object.defineProperty(i,"RowTransformerValidator",{enumerable:!0,get:function(){return s.RowTransformerValidator}});var o=t("./HeaderTransformer");Object.defineProperty(i,"HeaderTransformer",{enumerable:!0,get:function(){return o.HeaderTransformer}})},{"./HeaderTransformer":166,"./RowTransformerValidator":167}],169:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.isSyncValidate=i.isSyncTransform=void 0,i.isSyncTransform=s=>s.length===1,i.isSyncValidate=s=>s.length===1},{}],170:[function(t,n,i){const s=i;s.bignum=t("bn.js"),s.define=t("./asn1/api").define,s.base=t("./asn1/base"),s.constants=t("./asn1/constants"),s.decoders=t("./asn1/decoders"),s.encoders=t("./asn1/encoders")},{"./asn1/api":171,"./asn1/base":173,"./asn1/constants":177,"./asn1/decoders":179,"./asn1/encoders":182,"bn.js":184}],171:[function(t,n,i){const s=t("./encoders"),o=t("./decoders"),a=t("inherits");function l(u,c){this.name=u,this.body=c,this.decoders={},this.encoders={}}i.define=function(u,c){return new l(u,c)},l.prototype._createNamed=function(u){const c=this.name;function d(h){this._initNamed(h,c)}return a(d,u),d.prototype._initNamed=function(h,f){u.call(this,h,f)},new d(this)},l.prototype._getDecoder=function(u){return u=u||"der",this.decoders.hasOwnProperty(u)||(this.decoders[u]=this._createNamed(o[u])),this.decoders[u]},l.prototype.decode=function(u,c,d){return this._getDecoder(c).decode(u,d)},l.prototype._getEncoder=function(u){return u=u||"der",this.encoders.hasOwnProperty(u)||(this.encoders[u]=this._createNamed(s[u])),this.encoders[u]},l.prototype.encode=function(u,c,d){return this._getEncoder(c).encode(u,d)}},{"./decoders":179,"./encoders":182,inherits:440}],172:[function(t,n,i){const s=t("inherits"),o=t("../base/reporter").Reporter,a=t("safer-buffer").Buffer;function l(c,d){o.call(this,d),a.isBuffer(c)?(this.base=c,this.offset=0,this.length=c.length):this.error("Input not Buffer")}function u(c,d){if(Array.isArray(c))this.length=0,this.value=c.map((function(h){return u.isEncoderBuffer(h)||(h=new u(h,d)),this.length+=h.length,h}),this);else if(typeof c=="number"){if(!(0<=c&&c<=255))return d.error("non-byte EncoderBuffer value");this.value=c,this.length=1}else if(typeof c=="string")this.value=c,this.length=a.byteLength(c);else{if(!a.isBuffer(c))return d.error("Unsupported type: "+typeof c);this.value=c,this.length=c.length}}s(l,o),i.DecoderBuffer=l,l.isDecoderBuffer=function(c){return c instanceof l?!0:typeof c=="object"&&a.isBuffer(c.base)&&c.constructor.name==="DecoderBuffer"&&typeof c.offset=="number"&&typeof c.length=="number"&&typeof c.save=="function"&&typeof c.restore=="function"&&typeof c.isEmpty=="function"&&typeof c.readUInt8=="function"&&typeof c.skip=="function"&&typeof c.raw=="function"},l.prototype.save=function(){return{offset:this.offset,reporter:o.prototype.save.call(this)}},l.prototype.restore=function(c){const d=new l(this.base);return d.offset=c.offset,d.length=this.offset,this.offset=c.offset,o.prototype.restore.call(this,c.reporter),d},l.prototype.isEmpty=function(){return this.offset===this.length},l.prototype.readUInt8=function(c){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(c||"DecoderBuffer overrun")},l.prototype.skip=function(c,d){if(!(this.offset+c<=this.length))return this.error(d||"DecoderBuffer overrun");const h=new l(this.base);return h._reporterState=this._reporterState,h.offset=this.offset,h.length=this.offset+c,this.offset+=c,h},l.prototype.raw=function(c){return this.base.slice(c?c.offset:this.offset,this.length)},i.EncoderBuffer=u,u.isEncoderBuffer=function(c){return c instanceof u?!0:typeof c=="object"&&c.constructor.name==="EncoderBuffer"&&typeof c.length=="number"&&typeof c.join=="function"},u.prototype.join=function(c,d){return c||(c=a.alloc(this.length)),d||(d=0),this.length===0||(Array.isArray(this.value)?this.value.forEach((function(h){h.join(c,d),d+=h.length})):(typeof this.value=="number"?c[d]=this.value:typeof this.value=="string"?c.write(this.value,d):a.isBuffer(this.value)&&this.value.copy(c,d),d+=this.length)),c}},{"../base/reporter":175,inherits:440,"safer-buffer":495}],173:[function(t,n,i){const s=i;s.Reporter=t("./reporter").Reporter,s.DecoderBuffer=t("./buffer").DecoderBuffer,s.EncoderBuffer=t("./buffer").EncoderBuffer,s.Node=t("./node")},{"./buffer":172,"./node":174,"./reporter":175}],174:[function(t,n,i){const s=t("../base/reporter").Reporter,o=t("../base/buffer").EncoderBuffer,a=t("../base/buffer").DecoderBuffer,l=t("minimalistic-assert"),u=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],c=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(u);function d(f,m,p){const g={};this._baseState=g,g.name=p,g.enc=f,g.parent=m||null,g.children=null,g.tag=null,g.args=null,g.reverseArgs=null,g.choice=null,g.optional=!1,g.any=!1,g.obj=!1,g.use=null,g.useDecoder=null,g.key=null,g.default=null,g.explicit=null,g.implicit=null,g.contains=null,g.parent||(g.children=[],this._wrap())}n.exports=d;const h=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];d.prototype.clone=function(){const f=this._baseState,m={};h.forEach((function(g){m[g]=f[g]}));const p=new this.constructor(m.parent);return p._baseState=m,p},d.prototype._wrap=function(){const f=this._baseState;c.forEach((function(m){this[m]=function(){const p=new this.constructor(this);return f.children.push(p),p[m].apply(p,arguments)}}),this)},d.prototype._init=function(f){const m=this._baseState;l(m.parent===null),f.call(this),m.children=m.children.filter((function(p){return p._baseState.parent===this}),this),l.equal(m.children.length,1,"Root node can have only one child")},d.prototype._useArgs=function(f){const m=this._baseState,p=f.filter((function(g){return g instanceof this.constructor}),this);f=f.filter((function(g){return!(g instanceof this.constructor)}),this),p.length!==0&&(l(m.children===null),m.children=p,p.forEach((function(g){g._baseState.parent=this}),this)),f.length!==0&&(l(m.args===null),m.args=f,m.reverseArgs=f.map((function(g){if(typeof g!="object"||g.constructor!==Object)return g;const v={};return Object.keys(g).forEach((function(y){y==(0|y)&&(y|=0);const b=g[y];v[b]=y})),v})))},["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"].forEach((function(f){d.prototype[f]=function(){const m=this._baseState;throw new Error(f+" not implemented for encoding: "+m.enc)}})),u.forEach((function(f){d.prototype[f]=function(){const m=this._baseState,p=Array.prototype.slice.call(arguments);return l(m.tag===null),m.tag=f,this._useArgs(p),this}})),d.prototype.use=function(f){l(f);const m=this._baseState;return l(m.use===null),m.use=f,this},d.prototype.optional=function(){return this._baseState.optional=!0,this},d.prototype.def=function(f){const m=this._baseState;return l(m.default===null),m.default=f,m.optional=!0,this},d.prototype.explicit=function(f){const m=this._baseState;return l(m.explicit===null&&m.implicit===null),m.explicit=f,this},d.prototype.implicit=function(f){const m=this._baseState;return l(m.explicit===null&&m.implicit===null),m.implicit=f,this},d.prototype.obj=function(){const f=this._baseState,m=Array.prototype.slice.call(arguments);return f.obj=!0,m.length!==0&&this._useArgs(m),this},d.prototype.key=function(f){const m=this._baseState;return l(m.key===null),m.key=f,this},d.prototype.any=function(){return this._baseState.any=!0,this},d.prototype.choice=function(f){const m=this._baseState;return l(m.choice===null),m.choice=f,this._useArgs(Object.keys(f).map((function(p){return f[p]}))),this},d.prototype.contains=function(f){const m=this._baseState;return l(m.use===null),m.contains=f,this},d.prototype._decode=function(f,m){const p=this._baseState;if(p.parent===null)return f.wrapResult(p.children[0]._decode(f,m));let g,v=p.default,y=!0,b=null;if(p.key!==null&&(b=f.enterKey(p.key)),p.optional){let E=null;if(p.explicit!==null?E=p.explicit:p.implicit!==null?E=p.implicit:p.tag!==null&&(E=p.tag),E!==null||p.any){if(y=this._peekTag(f,E,p.any),f.isError(y))return y}else{const A=f.save();try{p.choice===null?this._decodeGeneric(p.tag,f,m):this._decodeChoice(f,m),y=!0}catch{y=!1}f.restore(A)}}if(p.obj&&y&&(g=f.enterObject()),y){if(p.explicit!==null){const A=this._decodeTag(f,p.explicit);if(f.isError(A))return A;f=A}const E=f.offset;if(p.use===null&&p.choice===null){let A;p.any&&(A=f.save());const M=this._decodeTag(f,p.implicit!==null?p.implicit:p.tag,p.any);if(f.isError(M))return M;p.any?v=f.raw(A):f=M}if(m&&m.track&&p.tag!==null&&m.track(f.path(),E,f.length,"tagged"),m&&m.track&&p.tag!==null&&m.track(f.path(),f.offset,f.length,"content"),p.any||(v=p.choice===null?this._decodeGeneric(p.tag,f,m):this._decodeChoice(f,m)),f.isError(v))return v;if(p.any||p.choice!==null||p.children===null||p.children.forEach((function(A){A._decode(f,m)})),p.contains&&(p.tag==="octstr"||p.tag==="bitstr")){const A=new a(v);v=this._getUse(p.contains,f._reporterState.obj)._decode(A,m)}}return p.obj&&y&&(v=f.leaveObject(g)),p.key===null||v===null&&y!==!0?b!==null&&f.exitKey(b):f.leaveKey(b,p.key,v),v},d.prototype._decodeGeneric=function(f,m,p){const g=this._baseState;return f==="seq"||f==="set"?null:f==="seqof"||f==="setof"?this._decodeList(m,f,g.args[0],p):/str$/.test(f)?this._decodeStr(m,f,p):f==="objid"&&g.args?this._decodeObjid(m,g.args[0],g.args[1],p):f==="objid"?this._decodeObjid(m,null,null,p):f==="gentime"||f==="utctime"?this._decodeTime(m,f,p):f==="null_"?this._decodeNull(m,p):f==="bool"?this._decodeBool(m,p):f==="objDesc"?this._decodeStr(m,f,p):f==="int"||f==="enum"?this._decodeInt(m,g.args&&g.args[0],p):g.use!==null?this._getUse(g.use,m._reporterState.obj)._decode(m,p):m.error("unknown tag: "+f)},d.prototype._getUse=function(f,m){const p=this._baseState;return p.useDecoder=this._use(f,m),l(p.useDecoder._baseState.parent===null),p.useDecoder=p.useDecoder._baseState.children[0],p.implicit!==p.useDecoder._baseState.implicit&&(p.useDecoder=p.useDecoder.clone(),p.useDecoder._baseState.implicit=p.implicit),p.useDecoder},d.prototype._decodeChoice=function(f,m){const p=this._baseState;let g=null,v=!1;return Object.keys(p.choice).some((function(y){const b=f.save(),E=p.choice[y];try{const A=E._decode(f,m);if(f.isError(A))return!1;g={type:y,value:A},v=!0}catch{return f.restore(b),!1}return!0}),this),v?g:f.error("Choice not matched")},d.prototype._createEncoderBuffer=function(f){return new o(f,this.reporter)},d.prototype._encode=function(f,m,p){const g=this._baseState;if(g.default!==null&&g.default===f)return;const v=this._encodeValue(f,m,p);return v===void 0||this._skipDefault(v,m,p)?void 0:v},d.prototype._encodeValue=function(f,m,p){const g=this._baseState;if(g.parent===null)return g.children[0]._encode(f,m||new s);let v=null;if(this.reporter=m,g.optional&&f===void 0){if(g.default===null)return;f=g.default}let y=null,b=!1;if(g.any)v=this._createEncoderBuffer(f);else if(g.choice)v=this._encodeChoice(f,m);else if(g.contains)y=this._getUse(g.contains,p)._encode(f,m),b=!0;else if(g.children)y=g.children.map((function(E){if(E._baseState.tag==="null_")return E._encode(null,m,f);if(E._baseState.key===null)return m.error("Child should have a key");const A=m.enterKey(E._baseState.key);if(typeof f!="object")return m.error("Child expected, but input is not object");const M=E._encode(f[E._baseState.key],m,f);return m.leaveKey(A),M}),this).filter((function(E){return E})),y=this._createEncoderBuffer(y);else if(g.tag==="seqof"||g.tag==="setof"){if(!g.args||g.args.length!==1)return m.error("Too many args for : "+g.tag);if(!Array.isArray(f))return m.error("seqof/setof, but data is not Array");const E=this.clone();E._baseState.implicit=null,y=this._createEncoderBuffer(f.map((function(A){const M=this._baseState;return this._getUse(M.args[0],f)._encode(A,m)}),E))}else g.use!==null?v=this._getUse(g.use,p)._encode(f,m):(y=this._encodePrimitive(g.tag,f),b=!0);if(!g.any&&g.choice===null){const E=g.implicit!==null?g.implicit:g.tag,A=g.implicit===null?"universal":"context";E===null?g.use===null&&m.error("Tag could be omitted only for .use()"):g.use===null&&(v=this._encodeComposite(E,b,A,y))}return g.explicit!==null&&(v=this._encodeComposite(g.explicit,!1,"context",v)),v},d.prototype._encodeChoice=function(f,m){const p=this._baseState,g=p.choice[f.type];return g||l(!1,f.type+" not found in "+JSON.stringify(Object.keys(p.choice))),g._encode(f.value,m)},d.prototype._encodePrimitive=function(f,m){const p=this._baseState;if(/str$/.test(f))return this._encodeStr(m,f);if(f==="objid"&&p.args)return this._encodeObjid(m,p.reverseArgs[0],p.args[1]);if(f==="objid")return this._encodeObjid(m,null,null);if(f==="gentime"||f==="utctime")return this._encodeTime(m,f);if(f==="null_")return this._encodeNull();if(f==="int"||f==="enum")return this._encodeInt(m,p.args&&p.reverseArgs[0]);if(f==="bool")return this._encodeBool(m);if(f==="objDesc")return this._encodeStr(m,f);throw new Error("Unsupported tag: "+f)},d.prototype._isNumstr=function(f){return/^[0-9 ]*$/.test(f)},d.prototype._isPrintstr=function(f){return/^[A-Za-z0-9 '()+,-./:=?]*$/.test(f)}},{"../base/buffer":172,"../base/reporter":175,"minimalistic-assert":453}],175:[function(t,n,i){const s=t("inherits");function o(l){this._reporterState={obj:null,path:[],options:l||{},errors:[]}}function a(l,u){this.path=l,this.rethrow(u)}i.Reporter=o,o.prototype.isError=function(l){return l instanceof a},o.prototype.save=function(){const l=this._reporterState;return{obj:l.obj,pathLen:l.path.length}},o.prototype.restore=function(l){const u=this._reporterState;u.obj=l.obj,u.path=u.path.slice(0,l.pathLen)},o.prototype.enterKey=function(l){return this._reporterState.path.push(l)},o.prototype.exitKey=function(l){const u=this._reporterState;u.path=u.path.slice(0,l-1)},o.prototype.leaveKey=function(l,u,c){const d=this._reporterState;this.exitKey(l),d.obj!==null&&(d.obj[u]=c)},o.prototype.path=function(){return this._reporterState.path.join("/")},o.prototype.enterObject=function(){const l=this._reporterState,u=l.obj;return l.obj={},u},o.prototype.leaveObject=function(l){const u=this._reporterState,c=u.obj;return u.obj=l,c},o.prototype.error=function(l){let u;const c=this._reporterState,d=l instanceof a;if(u=d?l:new a(c.path.map((function(h){return"["+JSON.stringify(h)+"]"})).join(""),l.message||l,l.stack),!c.options.partial)throw u;return d||c.errors.push(u),u},o.prototype.wrapResult=function(l){const u=this._reporterState;return u.options.partial?{result:this.isError(l)?null:l,errors:u.errors}:l},s(a,Error),a.prototype.rethrow=function(l){if(this.message=l+" at: "+(this.path||"(shallow)"),Error.captureStackTrace&&Error.captureStackTrace(this,a),!this.stack)try{throw new Error(this.message)}catch(u){this.stack=u.stack}return this}},{inherits:440}],176:[function(t,n,i){function s(o){const a={};return Object.keys(o).forEach((function(l){(0|l)==l&&(l|=0);const u=o[l];a[u]=l})),a}i.tagClass={0:"universal",1:"application",2:"context",3:"private"},i.tagClassByName=s(i.tagClass),i.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"},i.tagByName=s(i.tag)},{}],177:[function(t,n,i){const s=i;s._reverse=function(o){const a={};return Object.keys(o).forEach((function(l){(0|l)==l&&(l|=0);const u=o[l];a[u]=l})),a},s.der=t("./der")},{"./der":176}],178:[function(t,n,i){const s=t("inherits"),o=t("bn.js"),a=t("../base/buffer").DecoderBuffer,l=t("../base/node"),u=t("../constants/der");function c(m){this.enc="der",this.name=m.name,this.entity=m,this.tree=new d,this.tree._init(m.body)}function d(m){l.call(this,"der",m)}function h(m,p){let g=m.readUInt8(p);if(m.isError(g))return g;const v=u.tagClass[g>>6],y=(32&g)==0;if((31&g)==31){let b=g;for(g=0;(128&b)==128;){if(b=m.readUInt8(p),m.isError(b))return b;g<<=7,g|=127&b}}else g&=31;return{cls:v,primitive:y,tag:g,tagStr:u.tag[g]}}function f(m,p,g){let v=m.readUInt8(g);if(m.isError(v))return v;if(!p&&v===128)return null;if((128&v)==0)return v;const y=127&v;if(y>4)return m.error("length octect is too long");v=0;for(let b=0;b<y;b++){v<<=8;const E=m.readUInt8(g);if(m.isError(E))return E;v|=E}return v}n.exports=c,c.prototype.decode=function(m,p){return a.isDecoderBuffer(m)||(m=new a(m,p)),this.tree._decode(m,p)},s(d,l),d.prototype._peekTag=function(m,p,g){if(m.isEmpty())return!1;const v=m.save(),y=h(m,'Failed to peek tag: "'+p+'"');return m.isError(y)?y:(m.restore(v),y.tag===p||y.tagStr===p||y.tagStr+"of"===p||g)},d.prototype._decodeTag=function(m,p,g){const v=h(m,'Failed to decode tag of "'+p+'"');if(m.isError(v))return v;let y=f(m,v.primitive,'Failed to get length of "'+p+'"');if(m.isError(y))return y;if(!g&&v.tag!==p&&v.tagStr!==p&&v.tagStr+"of"!==p)return m.error('Failed to match tag: "'+p+'"');if(v.primitive||y!==null)return m.skip(y,'Failed to match body of: "'+p+'"');const b=m.save(),E=this._skipUntilEnd(m,'Failed to skip indefinite length body: "'+this.tag+'"');return m.isError(E)?E:(y=m.offset-b.offset,m.restore(b),m.skip(y,'Failed to match body of: "'+p+'"'))},d.prototype._skipUntilEnd=function(m,p){for(;;){const g=h(m,p);if(m.isError(g))return g;const v=f(m,g.primitive,p);if(m.isError(v))return v;let y;if(y=g.primitive||v!==null?m.skip(v):this._skipUntilEnd(m,p),m.isError(y))return y;if(g.tagStr==="end")break}},d.prototype._decodeList=function(m,p,g,v){const y=[];for(;!m.isEmpty();){const b=this._peekTag(m,"end");if(m.isError(b))return b;const E=g.decode(m,"der",v);if(m.isError(E)&&b)break;y.push(E)}return y},d.prototype._decodeStr=function(m,p){if(p==="bitstr"){const g=m.readUInt8();return m.isError(g)?g:{unused:g,data:m.raw()}}if(p==="bmpstr"){const g=m.raw();if(g.length%2==1)return m.error("Decoding of string type: bmpstr length mismatch");let v="";for(let y=0;y<g.length/2;y++)v+=String.fromCharCode(g.readUInt16BE(2*y));return v}if(p==="numstr"){const g=m.raw().toString("ascii");return this._isNumstr(g)?g:m.error("Decoding of string type: numstr unsupported characters")}if(p==="octstr"||p==="objDesc")return m.raw();if(p==="printstr"){const g=m.raw().toString("ascii");return this._isPrintstr(g)?g:m.error("Decoding of string type: printstr unsupported characters")}return/str$/.test(p)?m.raw().toString():m.error("Decoding of string type: "+p+" unsupported")},d.prototype._decodeObjid=function(m,p,g){let v;const y=[];let b=0,E=0;for(;!m.isEmpty();)E=m.readUInt8(),b<<=7,b|=127&E,(128&E)==0&&(y.push(b),b=0);128&E&&y.push(b);const A=y[0]/40|0,M=y[0]%40;if(v=g?y:[A,M].concat(y.slice(1)),p){let L=p[v.join(" ")];L===void 0&&(L=p[v.join(".")]),L!==void 0&&(v=L)}return v},d.prototype._decodeTime=function(m,p){const g=m.raw().toString();let v,y,b,E,A,M;if(p==="gentime")v=0|g.slice(0,4),y=0|g.slice(4,6),b=0|g.slice(6,8),E=0|g.slice(8,10),A=0|g.slice(10,12),M=0|g.slice(12,14);else{if(p!=="utctime")return m.error("Decoding "+p+" time is not supported yet");v=0|g.slice(0,2),y=0|g.slice(2,4),b=0|g.slice(4,6),E=0|g.slice(6,8),A=0|g.slice(8,10),M=0|g.slice(10,12),v=v<70?2e3+v:1900+v}return Date.UTC(v,y-1,b,E,A,M,0)},d.prototype._decodeNull=function(){return null},d.prototype._decodeBool=function(m){const p=m.readUInt8();return m.isError(p)?p:p!==0},d.prototype._decodeInt=function(m,p){const g=m.raw();let v=new o(g);return p&&(v=p[v.toString(10)]||v),v},d.prototype._use=function(m,p){return typeof m=="function"&&(m=m(p)),m._getDecoder("der").tree}},{"../base/buffer":172,"../base/node":174,"../constants/der":176,"bn.js":184,inherits:440}],179:[function(t,n,i){const s=i;s.der=t("./der"),s.pem=t("./pem")},{"./der":178,"./pem":180}],180:[function(t,n,i){const s=t("inherits"),o=t("safer-buffer").Buffer,a=t("./der");function l(u){a.call(this,u),this.enc="pem"}s(l,a),n.exports=l,l.prototype.decode=function(u,c){const d=u.toString().split(/[\r\n]+/g),h=c.label.toUpperCase(),f=/^-----(BEGIN|END) ([^-]+)-----$/;let m=-1,p=-1;for(let y=0;y<d.length;y++){const b=d[y].match(f);if(b!==null&&b[2]===h){if(m!==-1){if(b[1]!=="END")break;p=y;break}if(b[1]!=="BEGIN")break;m=y}}if(m===-1||p===-1)throw new Error("PEM section not found for: "+h);const g=d.slice(m+1,p).join("");g.replace(/[^a-z0-9+/=]+/gi,"");const v=o.from(g,"base64");return a.prototype.decode.call(this,v,c)}},{"./der":178,inherits:440,"safer-buffer":495}],181:[function(t,n,i){const s=t("inherits"),o=t("safer-buffer").Buffer,a=t("../base/node"),l=t("../constants/der");function u(h){this.enc="der",this.name=h.name,this.entity=h,this.tree=new c,this.tree._init(h.body)}function c(h){a.call(this,"der",h)}function d(h){return h<10?"0"+h:h}n.exports=u,u.prototype.encode=function(h,f){return this.tree._encode(h,f).join()},s(c,a),c.prototype._encodeComposite=function(h,f,m,p){const g=(function(b,E,A,M){let L;if(b==="seqof"?b="seq":b==="setof"&&(b="set"),l.tagByName.hasOwnProperty(b))L=l.tagByName[b];else{if(typeof b!="number"||(0|b)!==b)return M.error("Unknown tag: "+b);L=b}return L>=31?M.error("Multi-octet tag encoding unsupported"):(E||(L|=32),L|=l.tagClassByName[A||"universal"]<<6,L)})(h,f,m,this.reporter);if(p.length<128){const b=o.alloc(2);return b[0]=g,b[1]=p.length,this._createEncoderBuffer([b,p])}let v=1;for(let b=p.length;b>=256;b>>=8)v++;const y=o.alloc(2+v);y[0]=g,y[1]=128|v;for(let b=1+v,E=p.length;E>0;b--,E>>=8)y[b]=255&E;return this._createEncoderBuffer([y,p])},c.prototype._encodeStr=function(h,f){if(f==="bitstr")return this._createEncoderBuffer([0|h.unused,h.data]);if(f==="bmpstr"){const m=o.alloc(2*h.length);for(let p=0;p<h.length;p++)m.writeUInt16BE(h.charCodeAt(p),2*p);return this._createEncoderBuffer(m)}return f==="numstr"?this._isNumstr(h)?this._createEncoderBuffer(h):this.reporter.error("Encoding of string type: numstr supports only digits and space"):f==="printstr"?this._isPrintstr(h)?this._createEncoderBuffer(h):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(f)||f==="objDesc"?this._createEncoderBuffer(h):this.reporter.error("Encoding of string type: "+f+" unsupported")},c.prototype._encodeObjid=function(h,f,m){if(typeof h=="string"){if(!f)return this.reporter.error("string objid given, but no values map found");if(!f.hasOwnProperty(h))return this.reporter.error("objid not found in values map");h=f[h].split(/[\s.]+/g);for(let y=0;y<h.length;y++)h[y]|=0}else if(Array.isArray(h)){h=h.slice();for(let y=0;y<h.length;y++)h[y]|=0}if(!Array.isArray(h))return this.reporter.error("objid() should be either array or string, got: "+JSON.stringify(h));if(!m){if(h[1]>=40)return this.reporter.error("Second objid identifier OOB");h.splice(0,2,40*h[0]+h[1])}let p=0;for(let y=0;y<h.length;y++){let b=h[y];for(p++;b>=128;b>>=7)p++}const g=o.alloc(p);let v=g.length-1;for(let y=h.length-1;y>=0;y--){let b=h[y];for(g[v--]=127&b;(b>>=7)>0;)g[v--]=128|127&b}return this._createEncoderBuffer(g)},c.prototype._encodeTime=function(h,f){let m;const p=new Date(h);return f==="gentime"?m=[d(p.getUTCFullYear()),d(p.getUTCMonth()+1),d(p.getUTCDate()),d(p.getUTCHours()),d(p.getUTCMinutes()),d(p.getUTCSeconds()),"Z"].join(""):f==="utctime"?m=[d(p.getUTCFullYear()%100),d(p.getUTCMonth()+1),d(p.getUTCDate()),d(p.getUTCHours()),d(p.getUTCMinutes()),d(p.getUTCSeconds()),"Z"].join(""):this.reporter.error("Encoding "+f+" time is not supported yet"),this._encodeStr(m,"octstr")},c.prototype._encodeNull=function(){return this._createEncoderBuffer("")},c.prototype._encodeInt=function(h,f){if(typeof h=="string"){if(!f)return this.reporter.error("String int or enum given, but no values map");if(!f.hasOwnProperty(h))return this.reporter.error("Values map doesn't contain: "+JSON.stringify(h));h=f[h]}if(typeof h!="number"&&!o.isBuffer(h)){const g=h.toArray();!h.sign&&128&g[0]&&g.unshift(0),h=o.from(g)}if(o.isBuffer(h)){let g=h.length;h.length===0&&g++;const v=o.alloc(g);return h.copy(v),h.length===0&&(v[0]=0),this._createEncoderBuffer(v)}if(h<128)return this._createEncoderBuffer(h);if(h<256)return this._createEncoderBuffer([0,h]);let m=1;for(let g=h;g>=256;g>>=8)m++;const p=new Array(m);for(let g=p.length-1;g>=0;g--)p[g]=255&h,h>>=8;return 128&p[0]&&p.unshift(0),this._createEncoderBuffer(o.from(p))},c.prototype._encodeBool=function(h){return this._createEncoderBuffer(h?255:0)},c.prototype._use=function(h,f){return typeof h=="function"&&(h=h(f)),h._getEncoder("der").tree},c.prototype._skipDefault=function(h,f,m){const p=this._baseState;let g;if(p.default===null)return!1;const v=h.join();if(p.defaultBuffer===void 0&&(p.defaultBuffer=this._encodeValue(p.default,f,m).join()),v.length!==p.defaultBuffer.length)return!1;for(g=0;g<v.length;g++)if(v[g]!==p.defaultBuffer[g])return!1;return!0}},{"../base/node":174,"../constants/der":176,inherits:440,"safer-buffer":495}],182:[function(t,n,i){const s=i;s.der=t("./der"),s.pem=t("./pem")},{"./der":181,"./pem":183}],183:[function(t,n,i){const s=t("inherits"),o=t("./der");function a(l){o.call(this,l),this.enc="pem"}s(a,o),n.exports=a,a.prototype.encode=function(l,u){const c=o.prototype.encode.call(this,l).toString("base64"),d=["-----BEGIN "+u.label+"-----"];for(let h=0;h<c.length;h+=64)d.push(c.slice(h,h+64));return d.push("-----END "+u.label+"-----"),d.join(`
`)}},{"./der":181,inherits:440}],184:[function(t,n,i){(function(s,o){function a(R,O){if(!R)throw new Error(O||"Assertion failed")}function l(R,O){R.super_=O;var T=function(){};T.prototype=O.prototype,R.prototype=new T,R.prototype.constructor=R}function u(R,O,T){if(u.isBN(R))return R;this.negative=0,this.words=null,this.length=0,this.red=null,R!==null&&(O!=="le"&&O!=="be"||(T=O,O=10),this._init(R||0,O||10,T||"be"))}var c;typeof s=="object"?s.exports=u:(void 0).BN=u,u.BN=u,u.wordSize=26;try{c=typeof window<"u"&&window.Buffer!==void 0?window.Buffer:t("buffer").Buffer}catch{}function d(R,O){var T=R.charCodeAt(O);return T>=65&&T<=70?T-55:T>=97&&T<=102?T-87:T-48&15}function h(R,O,T){var w=d(R,T);return T-1>=O&&(w|=d(R,T-1)<<4),w}function f(R,O,T,w){for(var x=0,_=Math.min(R.length,T),S=O;S<_;S++){var C=R.charCodeAt(S)-48;x*=w,x+=C>=49?C-49+10:C>=17?C-17+10:C}return x}u.isBN=function(R){return R instanceof u||R!==null&&typeof R=="object"&&R.constructor.wordSize===u.wordSize&&Array.isArray(R.words)},u.max=function(R,O){return R.cmp(O)>0?R:O},u.min=function(R,O){return R.cmp(O)<0?R:O},u.prototype._init=function(R,O,T){if(typeof R=="number")return this._initNumber(R,O,T);if(typeof R=="object")return this._initArray(R,O,T);O==="hex"&&(O=16),a(O===(0|O)&&O>=2&&O<=36);var w=0;(R=R.toString().replace(/\s+/g,""))[0]==="-"&&(w++,this.negative=1),w<R.length&&(O===16?this._parseHex(R,w,T):(this._parseBase(R,O,w),T==="le"&&this._initArray(this.toArray(),O,T)))},u.prototype._initNumber=function(R,O,T){R<0&&(this.negative=1,R=-R),R<67108864?(this.words=[67108863&R],this.length=1):R<4503599627370496?(this.words=[67108863&R,R/67108864&67108863],this.length=2):(a(R<9007199254740992),this.words=[67108863&R,R/67108864&67108863,1],this.length=3),T==="le"&&this._initArray(this.toArray(),O,T)},u.prototype._initArray=function(R,O,T){if(a(typeof R.length=="number"),R.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(R.length/3),this.words=new Array(this.length);for(var w=0;w<this.length;w++)this.words[w]=0;var x,_,S=0;if(T==="be")for(w=R.length-1,x=0;w>=0;w-=3)_=R[w]|R[w-1]<<8|R[w-2]<<16,this.words[x]|=_<<S&67108863,this.words[x+1]=_>>>26-S&67108863,(S+=24)>=26&&(S-=26,x++);else if(T==="le")for(w=0,x=0;w<R.length;w+=3)_=R[w]|R[w+1]<<8|R[w+2]<<16,this.words[x]|=_<<S&67108863,this.words[x+1]=_>>>26-S&67108863,(S+=24)>=26&&(S-=26,x++);return this.strip()},u.prototype._parseHex=function(R,O,T){this.length=Math.ceil((R.length-O)/6),this.words=new Array(this.length);for(var w=0;w<this.length;w++)this.words[w]=0;var x,_=0,S=0;if(T==="be")for(w=R.length-1;w>=O;w-=2)x=h(R,O,w)<<_,this.words[S]|=67108863&x,_>=18?(_-=18,S+=1,this.words[S]|=x>>>26):_+=8;else for(w=(R.length-O)%2==0?O+1:O;w<R.length;w+=2)x=h(R,O,w)<<_,this.words[S]|=67108863&x,_>=18?(_-=18,S+=1,this.words[S]|=x>>>26):_+=8;this.strip()},u.prototype._parseBase=function(R,O,T){this.words=[0],this.length=1;for(var w=0,x=1;x<=67108863;x*=O)w++;w--,x=x/O|0;for(var _=R.length-T,S=_%w,C=Math.min(_,_-S)+T,F=0,D=T;D<C;D+=w)F=f(R,D,D+w,O),this.imuln(x),this.words[0]+F<67108864?this.words[0]+=F:this._iaddn(F);if(S!==0){var H=1;for(F=f(R,D,R.length,O),D=0;D<S;D++)H*=O;this.imuln(H),this.words[0]+F<67108864?this.words[0]+=F:this._iaddn(F)}this.strip()},u.prototype.copy=function(R){R.words=new Array(this.length);for(var O=0;O<this.length;O++)R.words[O]=this.words[O];R.length=this.length,R.negative=this.negative,R.red=this.red},u.prototype.clone=function(){var R=new u(null);return this.copy(R),R},u.prototype._expand=function(R){for(;this.length<R;)this.words[this.length++]=0;return this},u.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},u.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},u.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var m=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],p=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],g=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function v(R,O,T){T.negative=O.negative^R.negative;var w=R.length+O.length|0;T.length=w,w=w-1|0;var x=0|R.words[0],_=0|O.words[0],S=x*_,C=67108863&S,F=S/67108864|0;T.words[0]=C;for(var D=1;D<w;D++){for(var H=F>>>26,G=67108863&F,ee=Math.min(D,O.length-1),B=Math.max(0,D-R.length+1);B<=ee;B++){var X=D-B|0;H+=(S=(x=0|R.words[X])*(_=0|O.words[B])+G)/67108864|0,G=67108863&S}T.words[D]=0|G,F=0|H}return F!==0?T.words[D]=0|F:T.length--,T.strip()}u.prototype.toString=function(R,O){var T;if(O=0|O||1,(R=R||10)===16||R==="hex"){T="";for(var w=0,x=0,_=0;_<this.length;_++){var S=this.words[_],C=(16777215&(S<<w|x)).toString(16);T=(x=S>>>24-w&16777215)!==0||_!==this.length-1?m[6-C.length]+C+T:C+T,(w+=2)>=26&&(w-=26,_--)}for(x!==0&&(T=x.toString(16)+T);T.length%O!=0;)T="0"+T;return this.negative!==0&&(T="-"+T),T}if(R===(0|R)&&R>=2&&R<=36){var F=p[R],D=g[R];T="";var H=this.clone();for(H.negative=0;!H.isZero();){var G=H.modn(D).toString(R);T=(H=H.idivn(D)).isZero()?G+T:m[F-G.length]+G+T}for(this.isZero()&&(T="0"+T);T.length%O!=0;)T="0"+T;return this.negative!==0&&(T="-"+T),T}a(!1,"Base should be between 2 and 36")},u.prototype.toNumber=function(){var R=this.words[0];return this.length===2?R+=67108864*this.words[1]:this.length===3&&this.words[2]===1?R+=4503599627370496+67108864*this.words[1]:this.length>2&&a(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-R:R},u.prototype.toJSON=function(){return this.toString(16)},u.prototype.toBuffer=function(R,O){return a(c!==void 0),this.toArrayLike(c,R,O)},u.prototype.toArray=function(R,O){return this.toArrayLike(Array,R,O)},u.prototype.toArrayLike=function(R,O,T){var w=this.byteLength(),x=T||Math.max(1,w);a(w<=x,"byte array longer than desired length"),a(x>0,"Requested array length <= 0"),this.strip();var _,S,C=O==="le",F=new R(x),D=this.clone();if(C){for(S=0;!D.isZero();S++)_=D.andln(255),D.iushrn(8),F[S]=_;for(;S<x;S++)F[S]=0}else{for(S=0;S<x-w;S++)F[S]=0;for(S=0;!D.isZero();S++)_=D.andln(255),D.iushrn(8),F[x-S-1]=_}return F},Math.clz32?u.prototype._countBits=function(R){return 32-Math.clz32(R)}:u.prototype._countBits=function(R){var O=R,T=0;return O>=4096&&(T+=13,O>>>=13),O>=64&&(T+=7,O>>>=7),O>=8&&(T+=4,O>>>=4),O>=2&&(T+=2,O>>>=2),T+O},u.prototype._zeroBits=function(R){if(R===0)return 26;var O=R,T=0;return(8191&O)==0&&(T+=13,O>>>=13),(127&O)==0&&(T+=7,O>>>=7),(15&O)==0&&(T+=4,O>>>=4),(3&O)==0&&(T+=2,O>>>=2),(1&O)==0&&T++,T},u.prototype.bitLength=function(){var R=this.words[this.length-1],O=this._countBits(R);return 26*(this.length-1)+O},u.prototype.zeroBits=function(){if(this.isZero())return 0;for(var R=0,O=0;O<this.length;O++){var T=this._zeroBits(this.words[O]);if(R+=T,T!==26)break}return R},u.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},u.prototype.toTwos=function(R){return this.negative!==0?this.abs().inotn(R).iaddn(1):this.clone()},u.prototype.fromTwos=function(R){return this.testn(R-1)?this.notn(R).iaddn(1).ineg():this.clone()},u.prototype.isNeg=function(){return this.negative!==0},u.prototype.neg=function(){return this.clone().ineg()},u.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},u.prototype.iuor=function(R){for(;this.length<R.length;)this.words[this.length++]=0;for(var O=0;O<R.length;O++)this.words[O]=this.words[O]|R.words[O];return this.strip()},u.prototype.ior=function(R){return a((this.negative|R.negative)==0),this.iuor(R)},u.prototype.or=function(R){return this.length>R.length?this.clone().ior(R):R.clone().ior(this)},u.prototype.uor=function(R){return this.length>R.length?this.clone().iuor(R):R.clone().iuor(this)},u.prototype.iuand=function(R){var O;O=this.length>R.length?R:this;for(var T=0;T<O.length;T++)this.words[T]=this.words[T]&R.words[T];return this.length=O.length,this.strip()},u.prototype.iand=function(R){return a((this.negative|R.negative)==0),this.iuand(R)},u.prototype.and=function(R){return this.length>R.length?this.clone().iand(R):R.clone().iand(this)},u.prototype.uand=function(R){return this.length>R.length?this.clone().iuand(R):R.clone().iuand(this)},u.prototype.iuxor=function(R){var O,T;this.length>R.length?(O=this,T=R):(O=R,T=this);for(var w=0;w<T.length;w++)this.words[w]=O.words[w]^T.words[w];if(this!==O)for(;w<O.length;w++)this.words[w]=O.words[w];return this.length=O.length,this.strip()},u.prototype.ixor=function(R){return a((this.negative|R.negative)==0),this.iuxor(R)},u.prototype.xor=function(R){return this.length>R.length?this.clone().ixor(R):R.clone().ixor(this)},u.prototype.uxor=function(R){return this.length>R.length?this.clone().iuxor(R):R.clone().iuxor(this)},u.prototype.inotn=function(R){a(typeof R=="number"&&R>=0);var O=0|Math.ceil(R/26),T=R%26;this._expand(O),T>0&&O--;for(var w=0;w<O;w++)this.words[w]=67108863&~this.words[w];return T>0&&(this.words[w]=~this.words[w]&67108863>>26-T),this.strip()},u.prototype.notn=function(R){return this.clone().inotn(R)},u.prototype.setn=function(R,O){a(typeof R=="number"&&R>=0);var T=R/26|0,w=R%26;return this._expand(T+1),this.words[T]=O?this.words[T]|1<<w:this.words[T]&~(1<<w),this.strip()},u.prototype.iadd=function(R){var O,T,w;if(this.negative!==0&&R.negative===0)return this.negative=0,O=this.isub(R),this.negative^=1,this._normSign();if(this.negative===0&&R.negative!==0)return R.negative=0,O=this.isub(R),R.negative=1,O._normSign();this.length>R.length?(T=this,w=R):(T=R,w=this);for(var x=0,_=0;_<w.length;_++)O=(0|T.words[_])+(0|w.words[_])+x,this.words[_]=67108863&O,x=O>>>26;for(;x!==0&&_<T.length;_++)O=(0|T.words[_])+x,this.words[_]=67108863&O,x=O>>>26;if(this.length=T.length,x!==0)this.words[this.length]=x,this.length++;else if(T!==this)for(;_<T.length;_++)this.words[_]=T.words[_];return this},u.prototype.add=function(R){var O;return R.negative!==0&&this.negative===0?(R.negative=0,O=this.sub(R),R.negative^=1,O):R.negative===0&&this.negative!==0?(this.negative=0,O=R.sub(this),this.negative=1,O):this.length>R.length?this.clone().iadd(R):R.clone().iadd(this)},u.prototype.isub=function(R){if(R.negative!==0){R.negative=0;var O=this.iadd(R);return R.negative=1,O._normSign()}if(this.negative!==0)return this.negative=0,this.iadd(R),this.negative=1,this._normSign();var T,w,x=this.cmp(R);if(x===0)return this.negative=0,this.length=1,this.words[0]=0,this;x>0?(T=this,w=R):(T=R,w=this);for(var _=0,S=0;S<w.length;S++)_=(O=(0|T.words[S])-(0|w.words[S])+_)>>26,this.words[S]=67108863&O;for(;_!==0&&S<T.length;S++)_=(O=(0|T.words[S])+_)>>26,this.words[S]=67108863&O;if(_===0&&S<T.length&&T!==this)for(;S<T.length;S++)this.words[S]=T.words[S];return this.length=Math.max(this.length,S),T!==this&&(this.negative=1),this.strip()},u.prototype.sub=function(R){return this.clone().isub(R)};var y=function(R,O,T){var w,x,_,S=R.words,C=O.words,F=T.words,D=0,H=0|S[0],G=8191&H,ee=H>>>13,B=0|S[1],X=8191&B,I=B>>>13,N=0|S[2],j=8191&N,Q=N>>>13,W=0|S[3],Y=8191&W,Z=W>>>13,se=0|S[4],re=8191&se,K=se>>>13,ie=0|S[5],ne=8191&ie,le=ie>>>13,ae=0|S[6],fe=8191&ae,pe=ae>>>13,ye=0|S[7],xe=8191&ye,Ne=ye>>>13,Oe=0|S[8],Me=8191&Oe,qe=Oe>>>13,We=0|S[9],Ke=8191&We,Je=We>>>13,Ve=0|C[0],Pe=8191&Ve,Le=Ve>>>13,Ye=0|C[1],Ze=8191&Ye,Ft=Ye>>>13,ir=0|C[2],ct=8191&ir,Jt=ir>>>13,Vt=0|C[3],_t=8191&Vt,yr=Vt>>>13,er=0|C[4],gt=8191&er,Yt=er>>>13,fr=0|C[5],yt=8191&fr,rr=fr>>>13,pr=0|C[6],Rt=8191&pr,me=pr>>>13,ve=0|C[7],Se=8191&ve,Be=ve>>>13,dt=0|C[8],je=8191&dt,vt=dt>>>13,ft=0|C[9],at=8191&ft,Et=ft>>>13;T.negative=R.negative^O.negative,T.length=19;var bt=(D+(w=Math.imul(G,Pe))|0)+((8191&(x=(x=Math.imul(G,Le))+Math.imul(ee,Pe)|0))<<13)|0;D=((_=Math.imul(ee,Le))+(x>>>13)|0)+(bt>>>26)|0,bt&=67108863,w=Math.imul(X,Pe),x=(x=Math.imul(X,Le))+Math.imul(I,Pe)|0,_=Math.imul(I,Le);var Lt=(D+(w=w+Math.imul(G,Ze)|0)|0)+((8191&(x=(x=x+Math.imul(G,Ft)|0)+Math.imul(ee,Ze)|0))<<13)|0;D=((_=_+Math.imul(ee,Ft)|0)+(x>>>13)|0)+(Lt>>>26)|0,Lt&=67108863,w=Math.imul(j,Pe),x=(x=Math.imul(j,Le))+Math.imul(Q,Pe)|0,_=Math.imul(Q,Le),w=w+Math.imul(X,Ze)|0,x=(x=x+Math.imul(X,Ft)|0)+Math.imul(I,Ze)|0,_=_+Math.imul(I,Ft)|0;var Br=(D+(w=w+Math.imul(G,ct)|0)|0)+((8191&(x=(x=x+Math.imul(G,Jt)|0)+Math.imul(ee,ct)|0))<<13)|0;D=((_=_+Math.imul(ee,Jt)|0)+(x>>>13)|0)+(Br>>>26)|0,Br&=67108863,w=Math.imul(Y,Pe),x=(x=Math.imul(Y,Le))+Math.imul(Z,Pe)|0,_=Math.imul(Z,Le),w=w+Math.imul(j,Ze)|0,x=(x=x+Math.imul(j,Ft)|0)+Math.imul(Q,Ze)|0,_=_+Math.imul(Q,Ft)|0,w=w+Math.imul(X,ct)|0,x=(x=x+Math.imul(X,Jt)|0)+Math.imul(I,ct)|0,_=_+Math.imul(I,Jt)|0;var _r=(D+(w=w+Math.imul(G,_t)|0)|0)+((8191&(x=(x=x+Math.imul(G,yr)|0)+Math.imul(ee,_t)|0))<<13)|0;D=((_=_+Math.imul(ee,yr)|0)+(x>>>13)|0)+(_r>>>26)|0,_r&=67108863,w=Math.imul(re,Pe),x=(x=Math.imul(re,Le))+Math.imul(K,Pe)|0,_=Math.imul(K,Le),w=w+Math.imul(Y,Ze)|0,x=(x=x+Math.imul(Y,Ft)|0)+Math.imul(Z,Ze)|0,_=_+Math.imul(Z,Ft)|0,w=w+Math.imul(j,ct)|0,x=(x=x+Math.imul(j,Jt)|0)+Math.imul(Q,ct)|0,_=_+Math.imul(Q,Jt)|0,w=w+Math.imul(X,_t)|0,x=(x=x+Math.imul(X,yr)|0)+Math.imul(I,_t)|0,_=_+Math.imul(I,yr)|0;var rn=(D+(w=w+Math.imul(G,gt)|0)|0)+((8191&(x=(x=x+Math.imul(G,Yt)|0)+Math.imul(ee,gt)|0))<<13)|0;D=((_=_+Math.imul(ee,Yt)|0)+(x>>>13)|0)+(rn>>>26)|0,rn&=67108863,w=Math.imul(ne,Pe),x=(x=Math.imul(ne,Le))+Math.imul(le,Pe)|0,_=Math.imul(le,Le),w=w+Math.imul(re,Ze)|0,x=(x=x+Math.imul(re,Ft)|0)+Math.imul(K,Ze)|0,_=_+Math.imul(K,Ft)|0,w=w+Math.imul(Y,ct)|0,x=(x=x+Math.imul(Y,Jt)|0)+Math.imul(Z,ct)|0,_=_+Math.imul(Z,Jt)|0,w=w+Math.imul(j,_t)|0,x=(x=x+Math.imul(j,yr)|0)+Math.imul(Q,_t)|0,_=_+Math.imul(Q,yr)|0,w=w+Math.imul(X,gt)|0,x=(x=x+Math.imul(X,Yt)|0)+Math.imul(I,gt)|0,_=_+Math.imul(I,Yt)|0;var nn=(D+(w=w+Math.imul(G,yt)|0)|0)+((8191&(x=(x=x+Math.imul(G,rr)|0)+Math.imul(ee,yt)|0))<<13)|0;D=((_=_+Math.imul(ee,rr)|0)+(x>>>13)|0)+(nn>>>26)|0,nn&=67108863,w=Math.imul(fe,Pe),x=(x=Math.imul(fe,Le))+Math.imul(pe,Pe)|0,_=Math.imul(pe,Le),w=w+Math.imul(ne,Ze)|0,x=(x=x+Math.imul(ne,Ft)|0)+Math.imul(le,Ze)|0,_=_+Math.imul(le,Ft)|0,w=w+Math.imul(re,ct)|0,x=(x=x+Math.imul(re,Jt)|0)+Math.imul(K,ct)|0,_=_+Math.imul(K,Jt)|0,w=w+Math.imul(Y,_t)|0,x=(x=x+Math.imul(Y,yr)|0)+Math.imul(Z,_t)|0,_=_+Math.imul(Z,yr)|0,w=w+Math.imul(j,gt)|0,x=(x=x+Math.imul(j,Yt)|0)+Math.imul(Q,gt)|0,_=_+Math.imul(Q,Yt)|0,w=w+Math.imul(X,yt)|0,x=(x=x+Math.imul(X,rr)|0)+Math.imul(I,yt)|0,_=_+Math.imul(I,rr)|0;var Qn=(D+(w=w+Math.imul(G,Rt)|0)|0)+((8191&(x=(x=x+Math.imul(G,me)|0)+Math.imul(ee,Rt)|0))<<13)|0;D=((_=_+Math.imul(ee,me)|0)+(x>>>13)|0)+(Qn>>>26)|0,Qn&=67108863,w=Math.imul(xe,Pe),x=(x=Math.imul(xe,Le))+Math.imul(Ne,Pe)|0,_=Math.imul(Ne,Le),w=w+Math.imul(fe,Ze)|0,x=(x=x+Math.imul(fe,Ft)|0)+Math.imul(pe,Ze)|0,_=_+Math.imul(pe,Ft)|0,w=w+Math.imul(ne,ct)|0,x=(x=x+Math.imul(ne,Jt)|0)+Math.imul(le,ct)|0,_=_+Math.imul(le,Jt)|0,w=w+Math.imul(re,_t)|0,x=(x=x+Math.imul(re,yr)|0)+Math.imul(K,_t)|0,_=_+Math.imul(K,yr)|0,w=w+Math.imul(Y,gt)|0,x=(x=x+Math.imul(Y,Yt)|0)+Math.imul(Z,gt)|0,_=_+Math.imul(Z,Yt)|0,w=w+Math.imul(j,yt)|0,x=(x=x+Math.imul(j,rr)|0)+Math.imul(Q,yt)|0,_=_+Math.imul(Q,rr)|0,w=w+Math.imul(X,Rt)|0,x=(x=x+Math.imul(X,me)|0)+Math.imul(I,Rt)|0,_=_+Math.imul(I,me)|0;var ce=(D+(w=w+Math.imul(G,Se)|0)|0)+((8191&(x=(x=x+Math.imul(G,Be)|0)+Math.imul(ee,Se)|0))<<13)|0;D=((_=_+Math.imul(ee,Be)|0)+(x>>>13)|0)+(ce>>>26)|0,ce&=67108863,w=Math.imul(Me,Pe),x=(x=Math.imul(Me,Le))+Math.imul(qe,Pe)|0,_=Math.imul(qe,Le),w=w+Math.imul(xe,Ze)|0,x=(x=x+Math.imul(xe,Ft)|0)+Math.imul(Ne,Ze)|0,_=_+Math.imul(Ne,Ft)|0,w=w+Math.imul(fe,ct)|0,x=(x=x+Math.imul(fe,Jt)|0)+Math.imul(pe,ct)|0,_=_+Math.imul(pe,Jt)|0,w=w+Math.imul(ne,_t)|0,x=(x=x+Math.imul(ne,yr)|0)+Math.imul(le,_t)|0,_=_+Math.imul(le,yr)|0,w=w+Math.imul(re,gt)|0,x=(x=x+Math.imul(re,Yt)|0)+Math.imul(K,gt)|0,_=_+Math.imul(K,Yt)|0,w=w+Math.imul(Y,yt)|0,x=(x=x+Math.imul(Y,rr)|0)+Math.imul(Z,yt)|0,_=_+Math.imul(Z,rr)|0,w=w+Math.imul(j,Rt)|0,x=(x=x+Math.imul(j,me)|0)+Math.imul(Q,Rt)|0,_=_+Math.imul(Q,me)|0,w=w+Math.imul(X,Se)|0,x=(x=x+Math.imul(X,Be)|0)+Math.imul(I,Se)|0,_=_+Math.imul(I,Be)|0;var be=(D+(w=w+Math.imul(G,je)|0)|0)+((8191&(x=(x=x+Math.imul(G,vt)|0)+Math.imul(ee,je)|0))<<13)|0;D=((_=_+Math.imul(ee,vt)|0)+(x>>>13)|0)+(be>>>26)|0,be&=67108863,w=Math.imul(Ke,Pe),x=(x=Math.imul(Ke,Le))+Math.imul(Je,Pe)|0,_=Math.imul(Je,Le),w=w+Math.imul(Me,Ze)|0,x=(x=x+Math.imul(Me,Ft)|0)+Math.imul(qe,Ze)|0,_=_+Math.imul(qe,Ft)|0,w=w+Math.imul(xe,ct)|0,x=(x=x+Math.imul(xe,Jt)|0)+Math.imul(Ne,ct)|0,_=_+Math.imul(Ne,Jt)|0,w=w+Math.imul(fe,_t)|0,x=(x=x+Math.imul(fe,yr)|0)+Math.imul(pe,_t)|0,_=_+Math.imul(pe,yr)|0,w=w+Math.imul(ne,gt)|0,x=(x=x+Math.imul(ne,Yt)|0)+Math.imul(le,gt)|0,_=_+Math.imul(le,Yt)|0,w=w+Math.imul(re,yt)|0,x=(x=x+Math.imul(re,rr)|0)+Math.imul(K,yt)|0,_=_+Math.imul(K,rr)|0,w=w+Math.imul(Y,Rt)|0,x=(x=x+Math.imul(Y,me)|0)+Math.imul(Z,Rt)|0,_=_+Math.imul(Z,me)|0,w=w+Math.imul(j,Se)|0,x=(x=x+Math.imul(j,Be)|0)+Math.imul(Q,Se)|0,_=_+Math.imul(Q,Be)|0,w=w+Math.imul(X,je)|0,x=(x=x+Math.imul(X,vt)|0)+Math.imul(I,je)|0,_=_+Math.imul(I,vt)|0;var Ae=(D+(w=w+Math.imul(G,at)|0)|0)+((8191&(x=(x=x+Math.imul(G,Et)|0)+Math.imul(ee,at)|0))<<13)|0;D=((_=_+Math.imul(ee,Et)|0)+(x>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,w=Math.imul(Ke,Ze),x=(x=Math.imul(Ke,Ft))+Math.imul(Je,Ze)|0,_=Math.imul(Je,Ft),w=w+Math.imul(Me,ct)|0,x=(x=x+Math.imul(Me,Jt)|0)+Math.imul(qe,ct)|0,_=_+Math.imul(qe,Jt)|0,w=w+Math.imul(xe,_t)|0,x=(x=x+Math.imul(xe,yr)|0)+Math.imul(Ne,_t)|0,_=_+Math.imul(Ne,yr)|0,w=w+Math.imul(fe,gt)|0,x=(x=x+Math.imul(fe,Yt)|0)+Math.imul(pe,gt)|0,_=_+Math.imul(pe,Yt)|0,w=w+Math.imul(ne,yt)|0,x=(x=x+Math.imul(ne,rr)|0)+Math.imul(le,yt)|0,_=_+Math.imul(le,rr)|0,w=w+Math.imul(re,Rt)|0,x=(x=x+Math.imul(re,me)|0)+Math.imul(K,Rt)|0,_=_+Math.imul(K,me)|0,w=w+Math.imul(Y,Se)|0,x=(x=x+Math.imul(Y,Be)|0)+Math.imul(Z,Se)|0,_=_+Math.imul(Z,Be)|0,w=w+Math.imul(j,je)|0,x=(x=x+Math.imul(j,vt)|0)+Math.imul(Q,je)|0,_=_+Math.imul(Q,vt)|0;var Ie=(D+(w=w+Math.imul(X,at)|0)|0)+((8191&(x=(x=x+Math.imul(X,Et)|0)+Math.imul(I,at)|0))<<13)|0;D=((_=_+Math.imul(I,Et)|0)+(x>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,w=Math.imul(Ke,ct),x=(x=Math.imul(Ke,Jt))+Math.imul(Je,ct)|0,_=Math.imul(Je,Jt),w=w+Math.imul(Me,_t)|0,x=(x=x+Math.imul(Me,yr)|0)+Math.imul(qe,_t)|0,_=_+Math.imul(qe,yr)|0,w=w+Math.imul(xe,gt)|0,x=(x=x+Math.imul(xe,Yt)|0)+Math.imul(Ne,gt)|0,_=_+Math.imul(Ne,Yt)|0,w=w+Math.imul(fe,yt)|0,x=(x=x+Math.imul(fe,rr)|0)+Math.imul(pe,yt)|0,_=_+Math.imul(pe,rr)|0,w=w+Math.imul(ne,Rt)|0,x=(x=x+Math.imul(ne,me)|0)+Math.imul(le,Rt)|0,_=_+Math.imul(le,me)|0,w=w+Math.imul(re,Se)|0,x=(x=x+Math.imul(re,Be)|0)+Math.imul(K,Se)|0,_=_+Math.imul(K,Be)|0,w=w+Math.imul(Y,je)|0,x=(x=x+Math.imul(Y,vt)|0)+Math.imul(Z,je)|0,_=_+Math.imul(Z,vt)|0;var st=(D+(w=w+Math.imul(j,at)|0)|0)+((8191&(x=(x=x+Math.imul(j,Et)|0)+Math.imul(Q,at)|0))<<13)|0;D=((_=_+Math.imul(Q,Et)|0)+(x>>>13)|0)+(st>>>26)|0,st&=67108863,w=Math.imul(Ke,_t),x=(x=Math.imul(Ke,yr))+Math.imul(Je,_t)|0,_=Math.imul(Je,yr),w=w+Math.imul(Me,gt)|0,x=(x=x+Math.imul(Me,Yt)|0)+Math.imul(qe,gt)|0,_=_+Math.imul(qe,Yt)|0,w=w+Math.imul(xe,yt)|0,x=(x=x+Math.imul(xe,rr)|0)+Math.imul(Ne,yt)|0,_=_+Math.imul(Ne,rr)|0,w=w+Math.imul(fe,Rt)|0,x=(x=x+Math.imul(fe,me)|0)+Math.imul(pe,Rt)|0,_=_+Math.imul(pe,me)|0,w=w+Math.imul(ne,Se)|0,x=(x=x+Math.imul(ne,Be)|0)+Math.imul(le,Se)|0,_=_+Math.imul(le,Be)|0,w=w+Math.imul(re,je)|0,x=(x=x+Math.imul(re,vt)|0)+Math.imul(K,je)|0,_=_+Math.imul(K,vt)|0;var De=(D+(w=w+Math.imul(Y,at)|0)|0)+((8191&(x=(x=x+Math.imul(Y,Et)|0)+Math.imul(Z,at)|0))<<13)|0;D=((_=_+Math.imul(Z,Et)|0)+(x>>>13)|0)+(De>>>26)|0,De&=67108863,w=Math.imul(Ke,gt),x=(x=Math.imul(Ke,Yt))+Math.imul(Je,gt)|0,_=Math.imul(Je,Yt),w=w+Math.imul(Me,yt)|0,x=(x=x+Math.imul(Me,rr)|0)+Math.imul(qe,yt)|0,_=_+Math.imul(qe,rr)|0,w=w+Math.imul(xe,Rt)|0,x=(x=x+Math.imul(xe,me)|0)+Math.imul(Ne,Rt)|0,_=_+Math.imul(Ne,me)|0,w=w+Math.imul(fe,Se)|0,x=(x=x+Math.imul(fe,Be)|0)+Math.imul(pe,Se)|0,_=_+Math.imul(pe,Be)|0,w=w+Math.imul(ne,je)|0,x=(x=x+Math.imul(ne,vt)|0)+Math.imul(le,je)|0,_=_+Math.imul(le,vt)|0;var Ue=(D+(w=w+Math.imul(re,at)|0)|0)+((8191&(x=(x=x+Math.imul(re,Et)|0)+Math.imul(K,at)|0))<<13)|0;D=((_=_+Math.imul(K,Et)|0)+(x>>>13)|0)+(Ue>>>26)|0,Ue&=67108863,w=Math.imul(Ke,yt),x=(x=Math.imul(Ke,rr))+Math.imul(Je,yt)|0,_=Math.imul(Je,rr),w=w+Math.imul(Me,Rt)|0,x=(x=x+Math.imul(Me,me)|0)+Math.imul(qe,Rt)|0,_=_+Math.imul(qe,me)|0,w=w+Math.imul(xe,Se)|0,x=(x=x+Math.imul(xe,Be)|0)+Math.imul(Ne,Se)|0,_=_+Math.imul(Ne,Be)|0,w=w+Math.imul(fe,je)|0,x=(x=x+Math.imul(fe,vt)|0)+Math.imul(pe,je)|0,_=_+Math.imul(pe,vt)|0;var Ht=(D+(w=w+Math.imul(ne,at)|0)|0)+((8191&(x=(x=x+Math.imul(ne,Et)|0)+Math.imul(le,at)|0))<<13)|0;D=((_=_+Math.imul(le,Et)|0)+(x>>>13)|0)+(Ht>>>26)|0,Ht&=67108863,w=Math.imul(Ke,Rt),x=(x=Math.imul(Ke,me))+Math.imul(Je,Rt)|0,_=Math.imul(Je,me),w=w+Math.imul(Me,Se)|0,x=(x=x+Math.imul(Me,Be)|0)+Math.imul(qe,Se)|0,_=_+Math.imul(qe,Be)|0,w=w+Math.imul(xe,je)|0,x=(x=x+Math.imul(xe,vt)|0)+Math.imul(Ne,je)|0,_=_+Math.imul(Ne,vt)|0;var Mt=(D+(w=w+Math.imul(fe,at)|0)|0)+((8191&(x=(x=x+Math.imul(fe,Et)|0)+Math.imul(pe,at)|0))<<13)|0;D=((_=_+Math.imul(pe,Et)|0)+(x>>>13)|0)+(Mt>>>26)|0,Mt&=67108863,w=Math.imul(Ke,Se),x=(x=Math.imul(Ke,Be))+Math.imul(Je,Se)|0,_=Math.imul(Je,Be),w=w+Math.imul(Me,je)|0,x=(x=x+Math.imul(Me,vt)|0)+Math.imul(qe,je)|0,_=_+Math.imul(qe,vt)|0;var Dt=(D+(w=w+Math.imul(xe,at)|0)|0)+((8191&(x=(x=x+Math.imul(xe,Et)|0)+Math.imul(Ne,at)|0))<<13)|0;D=((_=_+Math.imul(Ne,Et)|0)+(x>>>13)|0)+(Dt>>>26)|0,Dt&=67108863,w=Math.imul(Ke,je),x=(x=Math.imul(Ke,vt))+Math.imul(Je,je)|0,_=Math.imul(Je,vt);var pt=(D+(w=w+Math.imul(Me,at)|0)|0)+((8191&(x=(x=x+Math.imul(Me,Et)|0)+Math.imul(qe,at)|0))<<13)|0;D=((_=_+Math.imul(qe,Et)|0)+(x>>>13)|0)+(pt>>>26)|0,pt&=67108863;var lr=(D+(w=Math.imul(Ke,at))|0)+((8191&(x=(x=Math.imul(Ke,Et))+Math.imul(Je,at)|0))<<13)|0;return D=((_=Math.imul(Je,Et))+(x>>>13)|0)+(lr>>>26)|0,lr&=67108863,F[0]=bt,F[1]=Lt,F[2]=Br,F[3]=_r,F[4]=rn,F[5]=nn,F[6]=Qn,F[7]=ce,F[8]=be,F[9]=Ae,F[10]=Ie,F[11]=st,F[12]=De,F[13]=Ue,F[14]=Ht,F[15]=Mt,F[16]=Dt,F[17]=pt,F[18]=lr,D!==0&&(F[19]=D,T.length++),T};function b(R,O,T){return new E().mulp(R,O,T)}function E(R,O){this.x=R,this.y=O}Math.imul||(y=v),u.prototype.mulTo=function(R,O){var T=this.length+R.length;return this.length===10&&R.length===10?y(this,R,O):T<63?v(this,R,O):T<1024?(function(w,x,_){_.negative=x.negative^w.negative,_.length=w.length+x.length;for(var S=0,C=0,F=0;F<_.length-1;F++){var D=C;C=0;for(var H=67108863&S,G=Math.min(F,x.length-1),ee=Math.max(0,F-w.length+1);ee<=G;ee++){var B=F-ee,X=(0|w.words[B])*(0|x.words[ee]),I=67108863&X;H=67108863&(I=I+H|0),C+=(D=(D=D+(X/67108864|0)|0)+(I>>>26)|0)>>>26,D&=67108863}_.words[F]=H,S=D,D=C}return S!==0?_.words[F]=S:_.length--,_.strip()})(this,R,O):b(this,R,O)},E.prototype.makeRBT=function(R){for(var O=new Array(R),T=u.prototype._countBits(R)-1,w=0;w<R;w++)O[w]=this.revBin(w,T,R);return O},E.prototype.revBin=function(R,O,T){if(R===0||R===T-1)return R;for(var w=0,x=0;x<O;x++)w|=(1&R)<<O-x-1,R>>=1;return w},E.prototype.permute=function(R,O,T,w,x,_){for(var S=0;S<_;S++)w[S]=O[R[S]],x[S]=T[R[S]]},E.prototype.transform=function(R,O,T,w,x,_){this.permute(_,R,O,T,w,x);for(var S=1;S<x;S<<=1)for(var C=S<<1,F=Math.cos(2*Math.PI/C),D=Math.sin(2*Math.PI/C),H=0;H<x;H+=C)for(var G=F,ee=D,B=0;B<S;B++){var X=T[H+B],I=w[H+B],N=T[H+B+S],j=w[H+B+S],Q=G*N-ee*j;j=G*j+ee*N,N=Q,T[H+B]=X+N,w[H+B]=I+j,T[H+B+S]=X-N,w[H+B+S]=I-j,B!==C&&(Q=F*G-D*ee,ee=F*ee+D*G,G=Q)}},E.prototype.guessLen13b=function(R,O){var T=1|Math.max(O,R),w=1&T,x=0;for(T=T/2|0;T;T>>>=1)x++;return 1<<x+1+w},E.prototype.conjugate=function(R,O,T){if(!(T<=1))for(var w=0;w<T/2;w++){var x=R[w];R[w]=R[T-w-1],R[T-w-1]=x,x=O[w],O[w]=-O[T-w-1],O[T-w-1]=-x}},E.prototype.normalize13b=function(R,O){for(var T=0,w=0;w<O/2;w++){var x=8192*Math.round(R[2*w+1]/O)+Math.round(R[2*w]/O)+T;R[w]=67108863&x,T=x<67108864?0:x/67108864|0}return R},E.prototype.convert13b=function(R,O,T,w){for(var x=0,_=0;_<O;_++)x+=0|R[_],T[2*_]=8191&x,x>>>=13,T[2*_+1]=8191&x,x>>>=13;for(_=2*O;_<w;++_)T[_]=0;a(x===0),a((-8192&x)==0)},E.prototype.stub=function(R){for(var O=new Array(R),T=0;T<R;T++)O[T]=0;return O},E.prototype.mulp=function(R,O,T){var w=2*this.guessLen13b(R.length,O.length),x=this.makeRBT(w),_=this.stub(w),S=new Array(w),C=new Array(w),F=new Array(w),D=new Array(w),H=new Array(w),G=new Array(w),ee=T.words;ee.length=w,this.convert13b(R.words,R.length,S,w),this.convert13b(O.words,O.length,D,w),this.transform(S,_,C,F,w,x),this.transform(D,_,H,G,w,x);for(var B=0;B<w;B++){var X=C[B]*H[B]-F[B]*G[B];F[B]=C[B]*G[B]+F[B]*H[B],C[B]=X}return this.conjugate(C,F,w),this.transform(C,F,ee,_,w,x),this.conjugate(ee,_,w),this.normalize13b(ee,w),T.negative=R.negative^O.negative,T.length=R.length+O.length,T.strip()},u.prototype.mul=function(R){var O=new u(null);return O.words=new Array(this.length+R.length),this.mulTo(R,O)},u.prototype.mulf=function(R){var O=new u(null);return O.words=new Array(this.length+R.length),b(this,R,O)},u.prototype.imul=function(R){return this.clone().mulTo(R,this)},u.prototype.imuln=function(R){a(typeof R=="number"),a(R<67108864);for(var O=0,T=0;T<this.length;T++){var w=(0|this.words[T])*R,x=(67108863&w)+(67108863&O);O>>=26,O+=w/67108864|0,O+=x>>>26,this.words[T]=67108863&x}return O!==0&&(this.words[T]=O,this.length++),this},u.prototype.muln=function(R){return this.clone().imuln(R)},u.prototype.sqr=function(){return this.mul(this)},u.prototype.isqr=function(){return this.imul(this.clone())},u.prototype.pow=function(R){var O=(function(_){for(var S=new Array(_.bitLength()),C=0;C<S.length;C++){var F=C/26|0,D=C%26;S[C]=(_.words[F]&1<<D)>>>D}return S})(R);if(O.length===0)return new u(1);for(var T=this,w=0;w<O.length&&O[w]===0;w++,T=T.sqr());if(++w<O.length)for(var x=T.sqr();w<O.length;w++,x=x.sqr())O[w]!==0&&(T=T.mul(x));return T},u.prototype.iushln=function(R){a(typeof R=="number"&&R>=0);var O,T=R%26,w=(R-T)/26,x=67108863>>>26-T<<26-T;if(T!==0){var _=0;for(O=0;O<this.length;O++){var S=this.words[O]&x,C=(0|this.words[O])-S<<T;this.words[O]=C|_,_=S>>>26-T}_&&(this.words[O]=_,this.length++)}if(w!==0){for(O=this.length-1;O>=0;O--)this.words[O+w]=this.words[O];for(O=0;O<w;O++)this.words[O]=0;this.length+=w}return this.strip()},u.prototype.ishln=function(R){return a(this.negative===0),this.iushln(R)},u.prototype.iushrn=function(R,O,T){var w;a(typeof R=="number"&&R>=0),w=O?(O-O%26)/26:0;var x=R%26,_=Math.min((R-x)/26,this.length),S=67108863^67108863>>>x<<x,C=T;if(w-=_,w=Math.max(0,w),C){for(var F=0;F<_;F++)C.words[F]=this.words[F];C.length=_}if(_!==0)if(this.length>_)for(this.length-=_,F=0;F<this.length;F++)this.words[F]=this.words[F+_];else this.words[0]=0,this.length=1;var D=0;for(F=this.length-1;F>=0&&(D!==0||F>=w);F--){var H=0|this.words[F];this.words[F]=D<<26-x|H>>>x,D=H&S}return C&&D!==0&&(C.words[C.length++]=D),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},u.prototype.ishrn=function(R,O,T){return a(this.negative===0),this.iushrn(R,O,T)},u.prototype.shln=function(R){return this.clone().ishln(R)},u.prototype.ushln=function(R){return this.clone().iushln(R)},u.prototype.shrn=function(R){return this.clone().ishrn(R)},u.prototype.ushrn=function(R){return this.clone().iushrn(R)},u.prototype.testn=function(R){a(typeof R=="number"&&R>=0);var O=R%26,T=(R-O)/26,w=1<<O;return!(this.length<=T)&&!!(this.words[T]&w)},u.prototype.imaskn=function(R){a(typeof R=="number"&&R>=0);var O=R%26,T=(R-O)/26;if(a(this.negative===0,"imaskn works only with positive numbers"),this.length<=T)return this;if(O!==0&&T++,this.length=Math.min(T,this.length),O!==0){var w=67108863^67108863>>>O<<O;this.words[this.length-1]&=w}return this.strip()},u.prototype.maskn=function(R){return this.clone().imaskn(R)},u.prototype.iaddn=function(R){return a(typeof R=="number"),a(R<67108864),R<0?this.isubn(-R):this.negative!==0?this.length===1&&(0|this.words[0])<R?(this.words[0]=R-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(R),this.negative=1,this):this._iaddn(R)},u.prototype._iaddn=function(R){this.words[0]+=R;for(var O=0;O<this.length&&this.words[O]>=67108864;O++)this.words[O]-=67108864,O===this.length-1?this.words[O+1]=1:this.words[O+1]++;return this.length=Math.max(this.length,O+1),this},u.prototype.isubn=function(R){if(a(typeof R=="number"),a(R<67108864),R<0)return this.iaddn(-R);if(this.negative!==0)return this.negative=0,this.iaddn(R),this.negative=1,this;if(this.words[0]-=R,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var O=0;O<this.length&&this.words[O]<0;O++)this.words[O]+=67108864,this.words[O+1]-=1;return this.strip()},u.prototype.addn=function(R){return this.clone().iaddn(R)},u.prototype.subn=function(R){return this.clone().isubn(R)},u.prototype.iabs=function(){return this.negative=0,this},u.prototype.abs=function(){return this.clone().iabs()},u.prototype._ishlnsubmul=function(R,O,T){var w,x,_=R.length+T;this._expand(_);var S=0;for(w=0;w<R.length;w++){x=(0|this.words[w+T])+S;var C=(0|R.words[w])*O;S=((x-=67108863&C)>>26)-(C/67108864|0),this.words[w+T]=67108863&x}for(;w<this.length-T;w++)S=(x=(0|this.words[w+T])+S)>>26,this.words[w+T]=67108863&x;if(S===0)return this.strip();for(a(S===-1),S=0,w=0;w<this.length;w++)S=(x=-(0|this.words[w])+S)>>26,this.words[w]=67108863&x;return this.negative=1,this.strip()},u.prototype._wordDiv=function(R,O){var T=(this.length,R.length),w=this.clone(),x=R,_=0|x.words[x.length-1];(T=26-this._countBits(_))!==0&&(x=x.ushln(T),w.iushln(T),_=0|x.words[x.length-1]);var S,C=w.length-x.length;if(O!=="mod"){(S=new u(null)).length=C+1,S.words=new Array(S.length);for(var F=0;F<S.length;F++)S.words[F]=0}var D=w.clone()._ishlnsubmul(x,1,C);D.negative===0&&(w=D,S&&(S.words[C]=1));for(var H=C-1;H>=0;H--){var G=67108864*(0|w.words[x.length+H])+(0|w.words[x.length+H-1]);for(G=Math.min(G/_|0,67108863),w._ishlnsubmul(x,G,H);w.negative!==0;)G--,w.negative=0,w._ishlnsubmul(x,1,H),w.isZero()||(w.negative^=1);S&&(S.words[H]=G)}return S&&S.strip(),w.strip(),O!=="div"&&T!==0&&w.iushrn(T),{div:S||null,mod:w}},u.prototype.divmod=function(R,O,T){return a(!R.isZero()),this.isZero()?{div:new u(0),mod:new u(0)}:this.negative!==0&&R.negative===0?(_=this.neg().divmod(R,O),O!=="mod"&&(w=_.div.neg()),O!=="div"&&(x=_.mod.neg(),T&&x.negative!==0&&x.iadd(R)),{div:w,mod:x}):this.negative===0&&R.negative!==0?(_=this.divmod(R.neg(),O),O!=="mod"&&(w=_.div.neg()),{div:w,mod:_.mod}):(this.negative&R.negative)!=0?(_=this.neg().divmod(R.neg(),O),O!=="div"&&(x=_.mod.neg(),T&&x.negative!==0&&x.isub(R)),{div:_.div,mod:x}):R.length>this.length||this.cmp(R)<0?{div:new u(0),mod:this}:R.length===1?O==="div"?{div:this.divn(R.words[0]),mod:null}:O==="mod"?{div:null,mod:new u(this.modn(R.words[0]))}:{div:this.divn(R.words[0]),mod:new u(this.modn(R.words[0]))}:this._wordDiv(R,O);var w,x,_},u.prototype.div=function(R){return this.divmod(R,"div",!1).div},u.prototype.mod=function(R){return this.divmod(R,"mod",!1).mod},u.prototype.umod=function(R){return this.divmod(R,"mod",!0).mod},u.prototype.divRound=function(R){var O=this.divmod(R);if(O.mod.isZero())return O.div;var T=O.div.negative!==0?O.mod.isub(R):O.mod,w=R.ushrn(1),x=R.andln(1),_=T.cmp(w);return _<0||x===1&&_===0?O.div:O.div.negative!==0?O.div.isubn(1):O.div.iaddn(1)},u.prototype.modn=function(R){a(R<=67108863);for(var O=(1<<26)%R,T=0,w=this.length-1;w>=0;w--)T=(O*T+(0|this.words[w]))%R;return T},u.prototype.idivn=function(R){a(R<=67108863);for(var O=0,T=this.length-1;T>=0;T--){var w=(0|this.words[T])+67108864*O;this.words[T]=w/R|0,O=w%R}return this.strip()},u.prototype.divn=function(R){return this.clone().idivn(R)},u.prototype.egcd=function(R){a(R.negative===0),a(!R.isZero());var O=this,T=R.clone();O=O.negative!==0?O.umod(R):O.clone();for(var w=new u(1),x=new u(0),_=new u(0),S=new u(1),C=0;O.isEven()&&T.isEven();)O.iushrn(1),T.iushrn(1),++C;for(var F=T.clone(),D=O.clone();!O.isZero();){for(var H=0,G=1;(O.words[0]&G)==0&&H<26;++H,G<<=1);if(H>0)for(O.iushrn(H);H-- >0;)(w.isOdd()||x.isOdd())&&(w.iadd(F),x.isub(D)),w.iushrn(1),x.iushrn(1);for(var ee=0,B=1;(T.words[0]&B)==0&&ee<26;++ee,B<<=1);if(ee>0)for(T.iushrn(ee);ee-- >0;)(_.isOdd()||S.isOdd())&&(_.iadd(F),S.isub(D)),_.iushrn(1),S.iushrn(1);O.cmp(T)>=0?(O.isub(T),w.isub(_),x.isub(S)):(T.isub(O),_.isub(w),S.isub(x))}return{a:_,b:S,gcd:T.iushln(C)}},u.prototype._invmp=function(R){a(R.negative===0),a(!R.isZero());var O=this,T=R.clone();O=O.negative!==0?O.umod(R):O.clone();for(var w,x=new u(1),_=new u(0),S=T.clone();O.cmpn(1)>0&&T.cmpn(1)>0;){for(var C=0,F=1;(O.words[0]&F)==0&&C<26;++C,F<<=1);if(C>0)for(O.iushrn(C);C-- >0;)x.isOdd()&&x.iadd(S),x.iushrn(1);for(var D=0,H=1;(T.words[0]&H)==0&&D<26;++D,H<<=1);if(D>0)for(T.iushrn(D);D-- >0;)_.isOdd()&&_.iadd(S),_.iushrn(1);O.cmp(T)>=0?(O.isub(T),x.isub(_)):(T.isub(O),_.isub(x))}return(w=O.cmpn(1)===0?x:_).cmpn(0)<0&&w.iadd(R),w},u.prototype.gcd=function(R){if(this.isZero())return R.abs();if(R.isZero())return this.abs();var O=this.clone(),T=R.clone();O.negative=0,T.negative=0;for(var w=0;O.isEven()&&T.isEven();w++)O.iushrn(1),T.iushrn(1);for(;;){for(;O.isEven();)O.iushrn(1);for(;T.isEven();)T.iushrn(1);var x=O.cmp(T);if(x<0){var _=O;O=T,T=_}else if(x===0||T.cmpn(1)===0)break;O.isub(T)}return T.iushln(w)},u.prototype.invm=function(R){return this.egcd(R).a.umod(R)},u.prototype.isEven=function(){return(1&this.words[0])==0},u.prototype.isOdd=function(){return(1&this.words[0])==1},u.prototype.andln=function(R){return this.words[0]&R},u.prototype.bincn=function(R){a(typeof R=="number");var O=R%26,T=(R-O)/26,w=1<<O;if(this.length<=T)return this._expand(T+1),this.words[T]|=w,this;for(var x=w,_=T;x!==0&&_<this.length;_++){var S=0|this.words[_];x=(S+=x)>>>26,S&=67108863,this.words[_]=S}return x!==0&&(this.words[_]=x,this.length++),this},u.prototype.isZero=function(){return this.length===1&&this.words[0]===0},u.prototype.cmpn=function(R){var O,T=R<0;if(this.negative!==0&&!T)return-1;if(this.negative===0&&T)return 1;if(this.strip(),this.length>1)O=1;else{T&&(R=-R),a(R<=67108863,"Number is too big");var w=0|this.words[0];O=w===R?0:w<R?-1:1}return this.negative!==0?0|-O:O},u.prototype.cmp=function(R){if(this.negative!==0&&R.negative===0)return-1;if(this.negative===0&&R.negative!==0)return 1;var O=this.ucmp(R);return this.negative!==0?0|-O:O},u.prototype.ucmp=function(R){if(this.length>R.length)return 1;if(this.length<R.length)return-1;for(var O=0,T=this.length-1;T>=0;T--){var w=0|this.words[T],x=0|R.words[T];if(w!==x){w<x?O=-1:w>x&&(O=1);break}}return O},u.prototype.gtn=function(R){return this.cmpn(R)===1},u.prototype.gt=function(R){return this.cmp(R)===1},u.prototype.gten=function(R){return this.cmpn(R)>=0},u.prototype.gte=function(R){return this.cmp(R)>=0},u.prototype.ltn=function(R){return this.cmpn(R)===-1},u.prototype.lt=function(R){return this.cmp(R)===-1},u.prototype.lten=function(R){return this.cmpn(R)<=0},u.prototype.lte=function(R){return this.cmp(R)<=0},u.prototype.eqn=function(R){return this.cmpn(R)===0},u.prototype.eq=function(R){return this.cmp(R)===0},u.red=function(R){return new $(R)},u.prototype.toRed=function(R){return a(!this.red,"Already a number in reduction context"),a(this.negative===0,"red works only with positives"),R.convertTo(this)._forceRed(R)},u.prototype.fromRed=function(){return a(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},u.prototype._forceRed=function(R){return this.red=R,this},u.prototype.forceRed=function(R){return a(!this.red,"Already a number in reduction context"),this._forceRed(R)},u.prototype.redAdd=function(R){return a(this.red,"redAdd works only with red numbers"),this.red.add(this,R)},u.prototype.redIAdd=function(R){return a(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,R)},u.prototype.redSub=function(R){return a(this.red,"redSub works only with red numbers"),this.red.sub(this,R)},u.prototype.redISub=function(R){return a(this.red,"redISub works only with red numbers"),this.red.isub(this,R)},u.prototype.redShl=function(R){return a(this.red,"redShl works only with red numbers"),this.red.shl(this,R)},u.prototype.redMul=function(R){return a(this.red,"redMul works only with red numbers"),this.red._verify2(this,R),this.red.mul(this,R)},u.prototype.redIMul=function(R){return a(this.red,"redMul works only with red numbers"),this.red._verify2(this,R),this.red.imul(this,R)},u.prototype.redSqr=function(){return a(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},u.prototype.redISqr=function(){return a(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},u.prototype.redSqrt=function(){return a(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},u.prototype.redInvm=function(){return a(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},u.prototype.redNeg=function(){return a(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},u.prototype.redPow=function(R){return a(this.red&&!R.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,R)};var A={k256:null,p224:null,p192:null,p25519:null};function M(R,O){this.name=R,this.p=new u(O,16),this.n=this.p.bitLength(),this.k=new u(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function L(){M.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function k(){M.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function P(){M.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function U(){M.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function $(R){if(typeof R=="string"){var O=u._prime(R);this.m=O.p,this.prime=O}else a(R.gtn(1),"modulus must be greater than 1"),this.m=R,this.prime=null}function V(R){$.call(this,R),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new u(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}M.prototype._tmp=function(){var R=new u(null);return R.words=new Array(Math.ceil(this.n/13)),R},M.prototype.ireduce=function(R){var O,T=R;do this.split(T,this.tmp),O=(T=(T=this.imulK(T)).iadd(this.tmp)).bitLength();while(O>this.n);var w=O<this.n?-1:T.ucmp(this.p);return w===0?(T.words[0]=0,T.length=1):w>0?T.isub(this.p):T.strip!==void 0?T.strip():T._strip(),T},M.prototype.split=function(R,O){R.iushrn(this.n,0,O)},M.prototype.imulK=function(R){return R.imul(this.k)},l(L,M),L.prototype.split=function(R,O){for(var T=Math.min(R.length,9),w=0;w<T;w++)O.words[w]=R.words[w];if(O.length=T,R.length<=9)return R.words[0]=0,void(R.length=1);var x=R.words[9];for(O.words[O.length++]=4194303&x,w=10;w<R.length;w++){var _=0|R.words[w];R.words[w-10]=(4194303&_)<<4|x>>>22,x=_}x>>>=22,R.words[w-10]=x,x===0&&R.length>10?R.length-=10:R.length-=9},L.prototype.imulK=function(R){R.words[R.length]=0,R.words[R.length+1]=0,R.length+=2;for(var O=0,T=0;T<R.length;T++){var w=0|R.words[T];O+=977*w,R.words[T]=67108863&O,O=64*w+(O/67108864|0)}return R.words[R.length-1]===0&&(R.length--,R.words[R.length-1]===0&&R.length--),R},l(k,M),l(P,M),l(U,M),U.prototype.imulK=function(R){for(var O=0,T=0;T<R.length;T++){var w=19*(0|R.words[T])+O,x=67108863&w;w>>>=26,R.words[T]=x,O=w}return O!==0&&(R.words[R.length++]=O),R},u._prime=function(R){if(A[R])return A[R];var O;if(R==="k256")O=new L;else if(R==="p224")O=new k;else if(R==="p192")O=new P;else{if(R!=="p25519")throw new Error("Unknown prime "+R);O=new U}return A[R]=O,O},$.prototype._verify1=function(R){a(R.negative===0,"red works only with positives"),a(R.red,"red works only with red numbers")},$.prototype._verify2=function(R,O){a((R.negative|O.negative)==0,"red works only with positives"),a(R.red&&R.red===O.red,"red works only with red numbers")},$.prototype.imod=function(R){return this.prime?this.prime.ireduce(R)._forceRed(this):R.umod(this.m)._forceRed(this)},$.prototype.neg=function(R){return R.isZero()?R.clone():this.m.sub(R)._forceRed(this)},$.prototype.add=function(R,O){this._verify2(R,O);var T=R.add(O);return T.cmp(this.m)>=0&&T.isub(this.m),T._forceRed(this)},$.prototype.iadd=function(R,O){this._verify2(R,O);var T=R.iadd(O);return T.cmp(this.m)>=0&&T.isub(this.m),T},$.prototype.sub=function(R,O){this._verify2(R,O);var T=R.sub(O);return T.cmpn(0)<0&&T.iadd(this.m),T._forceRed(this)},$.prototype.isub=function(R,O){this._verify2(R,O);var T=R.isub(O);return T.cmpn(0)<0&&T.iadd(this.m),T},$.prototype.shl=function(R,O){return this._verify1(R),this.imod(R.ushln(O))},$.prototype.imul=function(R,O){return this._verify2(R,O),this.imod(R.imul(O))},$.prototype.mul=function(R,O){return this._verify2(R,O),this.imod(R.mul(O))},$.prototype.isqr=function(R){return this.imul(R,R.clone())},$.prototype.sqr=function(R){return this.mul(R,R)},$.prototype.sqrt=function(R){if(R.isZero())return R.clone();var O=this.m.andln(3);if(a(O%2==1),O===3){var T=this.m.add(new u(1)).iushrn(2);return this.pow(R,T)}for(var w=this.m.subn(1),x=0;!w.isZero()&&w.andln(1)===0;)x++,w.iushrn(1);a(!w.isZero());var _=new u(1).toRed(this),S=_.redNeg(),C=this.m.subn(1).iushrn(1),F=this.m.bitLength();for(F=new u(2*F*F).toRed(this);this.pow(F,C).cmp(S)!==0;)F.redIAdd(S);for(var D=this.pow(F,w),H=this.pow(R,w.addn(1).iushrn(1)),G=this.pow(R,w),ee=x;G.cmp(_)!==0;){for(var B=G,X=0;B.cmp(_)!==0;X++)B=B.redSqr();a(X<ee);var I=this.pow(D,new u(1).iushln(ee-X-1));H=H.redMul(I),D=I.redSqr(),G=G.redMul(D),ee=X}return H},$.prototype.invm=function(R){var O=R._invmp(this.m);return O.negative!==0?(O.negative=0,this.imod(O).redNeg()):this.imod(O)},$.prototype.pow=function(R,O){if(O.isZero())return new u(1).toRed(this);if(O.cmpn(1)===0)return R.clone();var T=new Array(16);T[0]=new u(1).toRed(this),T[1]=R;for(var w=2;w<T.length;w++)T[w]=this.mul(T[w-1],R);var x=T[0],_=0,S=0,C=O.bitLength()%26;for(C===0&&(C=26),w=O.length-1;w>=0;w--){for(var F=O.words[w],D=C-1;D>=0;D--){var H=F>>D&1;x!==T[0]&&(x=this.sqr(x)),H!==0||_!==0?(_<<=1,_|=H,(++S===4||w===0&&D===0)&&(x=this.mul(x,T[_]),S=0,_=0)):S=0}C=26}return x},$.prototype.convertTo=function(R){var O=R.umod(this.m);return O===R?O.clone():O},$.prototype.convertFrom=function(R){var O=R.clone();return O.red=null,O},u.mont=function(R){return new V(R)},l(V,$),V.prototype.convertTo=function(R){return this.imod(R.ushln(this.shift))},V.prototype.convertFrom=function(R){var O=this.imod(R.mul(this.rinv));return O.red=null,O},V.prototype.imul=function(R,O){if(R.isZero()||O.isZero())return R.words[0]=0,R.length=1,R;var T=R.imul(O),w=T.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),x=T.isub(w).iushrn(this.shift),_=x;return x.cmp(this.m)>=0?_=x.isub(this.m):x.cmpn(0)<0&&(_=x.iadd(this.m)),_._forceRed(this)},V.prototype.mul=function(R,O){if(R.isZero()||O.isZero())return new u(0)._forceRed(this);var T=R.mul(O),w=T.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),x=T.isub(w).iushrn(this.shift),_=x;return x.cmp(this.m)>=0?_=x.isub(this.m):x.cmpn(0)<0&&(_=x.iadd(this.m)),_._forceRed(this)},V.prototype.invm=function(R){return this.imod(R._invmp(this.m).mul(this.r2))._forceRed(this)}})(n===void 0||n)},{buffer:188}],185:[function(t,n,i){i.byteLength=function(f){var m=d(f),p=m[0],g=m[1];return 3*(p+g)/4-g},i.toByteArray=function(f){var m,p,g=d(f),v=g[0],y=g[1],b=new a((function(M,L,k){return 3*(L+k)/4-k})(0,v,y)),E=0,A=y>0?v-4:v;for(p=0;p<A;p+=4)m=o[f.charCodeAt(p)]<<18|o[f.charCodeAt(p+1)]<<12|o[f.charCodeAt(p+2)]<<6|o[f.charCodeAt(p+3)],b[E++]=m>>16&255,b[E++]=m>>8&255,b[E++]=255&m;return y===2&&(m=o[f.charCodeAt(p)]<<2|o[f.charCodeAt(p+1)]>>4,b[E++]=255&m),y===1&&(m=o[f.charCodeAt(p)]<<10|o[f.charCodeAt(p+1)]<<4|o[f.charCodeAt(p+2)]>>2,b[E++]=m>>8&255,b[E++]=255&m),b},i.fromByteArray=function(f){for(var m,p=f.length,g=p%3,v=[],y=0,b=p-g;y<b;y+=16383)v.push(h(f,y,y+16383>b?b:y+16383));return g===1?(m=f[p-1],v.push(s[m>>2]+s[m<<4&63]+"==")):g===2&&(m=(f[p-2]<<8)+f[p-1],v.push(s[m>>10]+s[m>>4&63]+s[m<<2&63]+"=")),v.join("")};for(var s=[],o=[],a=typeof Uint8Array<"u"?Uint8Array:Array,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u=0,c=l.length;u<c;++u)s[u]=l[u],o[l.charCodeAt(u)]=u;function d(f){var m=f.length;if(m%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var p=f.indexOf("=");return p===-1&&(p=m),[p,p===m?0:4-p%4]}function h(f,m,p){for(var g,v,y=[],b=m;b<p;b+=3)g=(f[b]<<16&16711680)+(f[b+1]<<8&65280)+(255&f[b+2]),y.push(s[(v=g)>>18&63]+s[v>>12&63]+s[v>>6&63]+s[63&v]);return y.join("")}o[45]=62,o[95]=63},{}],186:[function(t,n,i){(function(s,o){function a(T,w){if(!T)throw new Error(w||"Assertion failed")}function l(T,w){T.super_=w;var x=function(){};x.prototype=w.prototype,T.prototype=new x,T.prototype.constructor=T}function u(T,w,x){if(u.isBN(T))return T;this.negative=0,this.words=null,this.length=0,this.red=null,T!==null&&(w!=="le"&&w!=="be"||(x=w,w=10),this._init(T||0,w||10,x||"be"))}var c;typeof s=="object"?s.exports=u:(void 0).BN=u,u.BN=u,u.wordSize=26;try{c=typeof window<"u"&&window.Buffer!==void 0?window.Buffer:t("buffer").Buffer}catch{}function d(T,w){var x=T.charCodeAt(w);return x>=48&&x<=57?x-48:x>=65&&x<=70?x-55:x>=97&&x<=102?x-87:void a(!1,"Invalid character in "+T)}function h(T,w,x){var _=d(T,x);return x-1>=w&&(_|=d(T,x-1)<<4),_}function f(T,w,x,_){for(var S=0,C=0,F=Math.min(T.length,x),D=w;D<F;D++){var H=T.charCodeAt(D)-48;S*=_,C=H>=49?H-49+10:H>=17?H-17+10:H,a(H>=0&&C<_,"Invalid character"),S+=C}return S}function m(T,w){T.words=w.words,T.length=w.length,T.negative=w.negative,T.red=w.red}if(u.isBN=function(T){return T instanceof u||T!==null&&typeof T=="object"&&T.constructor.wordSize===u.wordSize&&Array.isArray(T.words)},u.max=function(T,w){return T.cmp(w)>0?T:w},u.min=function(T,w){return T.cmp(w)<0?T:w},u.prototype._init=function(T,w,x){if(typeof T=="number")return this._initNumber(T,w,x);if(typeof T=="object")return this._initArray(T,w,x);w==="hex"&&(w=16),a(w===(0|w)&&w>=2&&w<=36);var _=0;(T=T.toString().replace(/\s+/g,""))[0]==="-"&&(_++,this.negative=1),_<T.length&&(w===16?this._parseHex(T,_,x):(this._parseBase(T,w,_),x==="le"&&this._initArray(this.toArray(),w,x)))},u.prototype._initNumber=function(T,w,x){T<0&&(this.negative=1,T=-T),T<67108864?(this.words=[67108863&T],this.length=1):T<4503599627370496?(this.words=[67108863&T,T/67108864&67108863],this.length=2):(a(T<9007199254740992),this.words=[67108863&T,T/67108864&67108863,1],this.length=3),x==="le"&&this._initArray(this.toArray(),w,x)},u.prototype._initArray=function(T,w,x){if(a(typeof T.length=="number"),T.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(T.length/3),this.words=new Array(this.length);for(var _=0;_<this.length;_++)this.words[_]=0;var S,C,F=0;if(x==="be")for(_=T.length-1,S=0;_>=0;_-=3)C=T[_]|T[_-1]<<8|T[_-2]<<16,this.words[S]|=C<<F&67108863,this.words[S+1]=C>>>26-F&67108863,(F+=24)>=26&&(F-=26,S++);else if(x==="le")for(_=0,S=0;_<T.length;_+=3)C=T[_]|T[_+1]<<8|T[_+2]<<16,this.words[S]|=C<<F&67108863,this.words[S+1]=C>>>26-F&67108863,(F+=24)>=26&&(F-=26,S++);return this._strip()},u.prototype._parseHex=function(T,w,x){this.length=Math.ceil((T.length-w)/6),this.words=new Array(this.length);for(var _=0;_<this.length;_++)this.words[_]=0;var S,C=0,F=0;if(x==="be")for(_=T.length-1;_>=w;_-=2)S=h(T,w,_)<<C,this.words[F]|=67108863&S,C>=18?(C-=18,F+=1,this.words[F]|=S>>>26):C+=8;else for(_=(T.length-w)%2==0?w+1:w;_<T.length;_+=2)S=h(T,w,_)<<C,this.words[F]|=67108863&S,C>=18?(C-=18,F+=1,this.words[F]|=S>>>26):C+=8;this._strip()},u.prototype._parseBase=function(T,w,x){this.words=[0],this.length=1;for(var _=0,S=1;S<=67108863;S*=w)_++;_--,S=S/w|0;for(var C=T.length-x,F=C%_,D=Math.min(C,C-F)+x,H=0,G=x;G<D;G+=_)H=f(T,G,G+_,w),this.imuln(S),this.words[0]+H<67108864?this.words[0]+=H:this._iaddn(H);if(F!==0){var ee=1;for(H=f(T,G,T.length,w),G=0;G<F;G++)ee*=w;this.imuln(ee),this.words[0]+H<67108864?this.words[0]+=H:this._iaddn(H)}this._strip()},u.prototype.copy=function(T){T.words=new Array(this.length);for(var w=0;w<this.length;w++)T.words[w]=this.words[w];T.length=this.length,T.negative=this.negative,T.red=this.red},u.prototype._move=function(T){m(T,this)},u.prototype.clone=function(){var T=new u(null);return this.copy(T),T},u.prototype._expand=function(T){for(;this.length<T;)this.words[this.length++]=0;return this},u.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},u.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{u.prototype[Symbol.for("nodejs.util.inspect.custom")]=p}catch{u.prototype.inspect=p}else u.prototype.inspect=p;function p(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var g=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],v=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],y=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];u.prototype.toString=function(T,w){var x;if(w=0|w||1,(T=T||10)===16||T==="hex"){x="";for(var _=0,S=0,C=0;C<this.length;C++){var F=this.words[C],D=(16777215&(F<<_|S)).toString(16);S=F>>>24-_&16777215,(_+=2)>=26&&(_-=26,C--),x=S!==0||C!==this.length-1?g[6-D.length]+D+x:D+x}for(S!==0&&(x=S.toString(16)+x);x.length%w!=0;)x="0"+x;return this.negative!==0&&(x="-"+x),x}if(T===(0|T)&&T>=2&&T<=36){var H=v[T],G=y[T];x="";var ee=this.clone();for(ee.negative=0;!ee.isZero();){var B=ee.modrn(G).toString(T);x=(ee=ee.idivn(G)).isZero()?B+x:g[H-B.length]+B+x}for(this.isZero()&&(x="0"+x);x.length%w!=0;)x="0"+x;return this.negative!==0&&(x="-"+x),x}a(!1,"Base should be between 2 and 36")},u.prototype.toNumber=function(){var T=this.words[0];return this.length===2?T+=67108864*this.words[1]:this.length===3&&this.words[2]===1?T+=4503599627370496+67108864*this.words[1]:this.length>2&&a(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-T:T},u.prototype.toJSON=function(){return this.toString(16,2)},c&&(u.prototype.toBuffer=function(T,w){return this.toArrayLike(c,T,w)}),u.prototype.toArray=function(T,w){return this.toArrayLike(Array,T,w)};function b(T,w,x){x.negative=w.negative^T.negative;var _=T.length+w.length|0;x.length=_,_=_-1|0;var S=0|T.words[0],C=0|w.words[0],F=S*C,D=67108863&F,H=F/67108864|0;x.words[0]=D;for(var G=1;G<_;G++){for(var ee=H>>>26,B=67108863&H,X=Math.min(G,w.length-1),I=Math.max(0,G-T.length+1);I<=X;I++){var N=G-I|0;ee+=(F=(S=0|T.words[N])*(C=0|w.words[I])+B)/67108864|0,B=67108863&F}x.words[G]=0|B,H=0|ee}return H!==0?x.words[G]=0|H:x.length--,x._strip()}u.prototype.toArrayLike=function(T,w,x){this._strip();var _=this.byteLength(),S=x||Math.max(1,_);a(_<=S,"byte array longer than desired length"),a(S>0,"Requested array length <= 0");var C=(function(F,D){return F.allocUnsafe?F.allocUnsafe(D):new F(D)})(T,S);return this["_toArrayLike"+(w==="le"?"LE":"BE")](C,_),C},u.prototype._toArrayLikeLE=function(T,w){for(var x=0,_=0,S=0,C=0;S<this.length;S++){var F=this.words[S]<<C|_;T[x++]=255&F,x<T.length&&(T[x++]=F>>8&255),x<T.length&&(T[x++]=F>>16&255),C===6?(x<T.length&&(T[x++]=F>>24&255),_=0,C=0):(_=F>>>24,C+=2)}if(x<T.length)for(T[x++]=_;x<T.length;)T[x++]=0},u.prototype._toArrayLikeBE=function(T,w){for(var x=T.length-1,_=0,S=0,C=0;S<this.length;S++){var F=this.words[S]<<C|_;T[x--]=255&F,x>=0&&(T[x--]=F>>8&255),x>=0&&(T[x--]=F>>16&255),C===6?(x>=0&&(T[x--]=F>>24&255),_=0,C=0):(_=F>>>24,C+=2)}if(x>=0)for(T[x--]=_;x>=0;)T[x--]=0},Math.clz32?u.prototype._countBits=function(T){return 32-Math.clz32(T)}:u.prototype._countBits=function(T){var w=T,x=0;return w>=4096&&(x+=13,w>>>=13),w>=64&&(x+=7,w>>>=7),w>=8&&(x+=4,w>>>=4),w>=2&&(x+=2,w>>>=2),x+w},u.prototype._zeroBits=function(T){if(T===0)return 26;var w=T,x=0;return(8191&w)==0&&(x+=13,w>>>=13),(127&w)==0&&(x+=7,w>>>=7),(15&w)==0&&(x+=4,w>>>=4),(3&w)==0&&(x+=2,w>>>=2),(1&w)==0&&x++,x},u.prototype.bitLength=function(){var T=this.words[this.length-1],w=this._countBits(T);return 26*(this.length-1)+w},u.prototype.zeroBits=function(){if(this.isZero())return 0;for(var T=0,w=0;w<this.length;w++){var x=this._zeroBits(this.words[w]);if(T+=x,x!==26)break}return T},u.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},u.prototype.toTwos=function(T){return this.negative!==0?this.abs().inotn(T).iaddn(1):this.clone()},u.prototype.fromTwos=function(T){return this.testn(T-1)?this.notn(T).iaddn(1).ineg():this.clone()},u.prototype.isNeg=function(){return this.negative!==0},u.prototype.neg=function(){return this.clone().ineg()},u.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},u.prototype.iuor=function(T){for(;this.length<T.length;)this.words[this.length++]=0;for(var w=0;w<T.length;w++)this.words[w]=this.words[w]|T.words[w];return this._strip()},u.prototype.ior=function(T){return a((this.negative|T.negative)==0),this.iuor(T)},u.prototype.or=function(T){return this.length>T.length?this.clone().ior(T):T.clone().ior(this)},u.prototype.uor=function(T){return this.length>T.length?this.clone().iuor(T):T.clone().iuor(this)},u.prototype.iuand=function(T){var w;w=this.length>T.length?T:this;for(var x=0;x<w.length;x++)this.words[x]=this.words[x]&T.words[x];return this.length=w.length,this._strip()},u.prototype.iand=function(T){return a((this.negative|T.negative)==0),this.iuand(T)},u.prototype.and=function(T){return this.length>T.length?this.clone().iand(T):T.clone().iand(this)},u.prototype.uand=function(T){return this.length>T.length?this.clone().iuand(T):T.clone().iuand(this)},u.prototype.iuxor=function(T){var w,x;this.length>T.length?(w=this,x=T):(w=T,x=this);for(var _=0;_<x.length;_++)this.words[_]=w.words[_]^x.words[_];if(this!==w)for(;_<w.length;_++)this.words[_]=w.words[_];return this.length=w.length,this._strip()},u.prototype.ixor=function(T){return a((this.negative|T.negative)==0),this.iuxor(T)},u.prototype.xor=function(T){return this.length>T.length?this.clone().ixor(T):T.clone().ixor(this)},u.prototype.uxor=function(T){return this.length>T.length?this.clone().iuxor(T):T.clone().iuxor(this)},u.prototype.inotn=function(T){a(typeof T=="number"&&T>=0);var w=0|Math.ceil(T/26),x=T%26;this._expand(w),x>0&&w--;for(var _=0;_<w;_++)this.words[_]=67108863&~this.words[_];return x>0&&(this.words[_]=~this.words[_]&67108863>>26-x),this._strip()},u.prototype.notn=function(T){return this.clone().inotn(T)},u.prototype.setn=function(T,w){a(typeof T=="number"&&T>=0);var x=T/26|0,_=T%26;return this._expand(x+1),this.words[x]=w?this.words[x]|1<<_:this.words[x]&~(1<<_),this._strip()},u.prototype.iadd=function(T){var w,x,_;if(this.negative!==0&&T.negative===0)return this.negative=0,w=this.isub(T),this.negative^=1,this._normSign();if(this.negative===0&&T.negative!==0)return T.negative=0,w=this.isub(T),T.negative=1,w._normSign();this.length>T.length?(x=this,_=T):(x=T,_=this);for(var S=0,C=0;C<_.length;C++)w=(0|x.words[C])+(0|_.words[C])+S,this.words[C]=67108863&w,S=w>>>26;for(;S!==0&&C<x.length;C++)w=(0|x.words[C])+S,this.words[C]=67108863&w,S=w>>>26;if(this.length=x.length,S!==0)this.words[this.length]=S,this.length++;else if(x!==this)for(;C<x.length;C++)this.words[C]=x.words[C];return this},u.prototype.add=function(T){var w;return T.negative!==0&&this.negative===0?(T.negative=0,w=this.sub(T),T.negative^=1,w):T.negative===0&&this.negative!==0?(this.negative=0,w=T.sub(this),this.negative=1,w):this.length>T.length?this.clone().iadd(T):T.clone().iadd(this)},u.prototype.isub=function(T){if(T.negative!==0){T.negative=0;var w=this.iadd(T);return T.negative=1,w._normSign()}if(this.negative!==0)return this.negative=0,this.iadd(T),this.negative=1,this._normSign();var x,_,S=this.cmp(T);if(S===0)return this.negative=0,this.length=1,this.words[0]=0,this;S>0?(x=this,_=T):(x=T,_=this);for(var C=0,F=0;F<_.length;F++)C=(w=(0|x.words[F])-(0|_.words[F])+C)>>26,this.words[F]=67108863&w;for(;C!==0&&F<x.length;F++)C=(w=(0|x.words[F])+C)>>26,this.words[F]=67108863&w;if(C===0&&F<x.length&&x!==this)for(;F<x.length;F++)this.words[F]=x.words[F];return this.length=Math.max(this.length,F),x!==this&&(this.negative=1),this._strip()},u.prototype.sub=function(T){return this.clone().isub(T)};var E=function(T,w,x){var _,S,C,F=T.words,D=w.words,H=x.words,G=0,ee=0|F[0],B=8191&ee,X=ee>>>13,I=0|F[1],N=8191&I,j=I>>>13,Q=0|F[2],W=8191&Q,Y=Q>>>13,Z=0|F[3],se=8191&Z,re=Z>>>13,K=0|F[4],ie=8191&K,ne=K>>>13,le=0|F[5],ae=8191&le,fe=le>>>13,pe=0|F[6],ye=8191&pe,xe=pe>>>13,Ne=0|F[7],Oe=8191&Ne,Me=Ne>>>13,qe=0|F[8],We=8191&qe,Ke=qe>>>13,Je=0|F[9],Ve=8191&Je,Pe=Je>>>13,Le=0|D[0],Ye=8191&Le,Ze=Le>>>13,Ft=0|D[1],ir=8191&Ft,ct=Ft>>>13,Jt=0|D[2],Vt=8191&Jt,_t=Jt>>>13,yr=0|D[3],er=8191&yr,gt=yr>>>13,Yt=0|D[4],fr=8191&Yt,yt=Yt>>>13,rr=0|D[5],pr=8191&rr,Rt=rr>>>13,me=0|D[6],ve=8191&me,Se=me>>>13,Be=0|D[7],dt=8191&Be,je=Be>>>13,vt=0|D[8],ft=8191&vt,at=vt>>>13,Et=0|D[9],bt=8191&Et,Lt=Et>>>13;x.negative=T.negative^w.negative,x.length=19;var Br=(G+(_=Math.imul(B,Ye))|0)+((8191&(S=(S=Math.imul(B,Ze))+Math.imul(X,Ye)|0))<<13)|0;G=((C=Math.imul(X,Ze))+(S>>>13)|0)+(Br>>>26)|0,Br&=67108863,_=Math.imul(N,Ye),S=(S=Math.imul(N,Ze))+Math.imul(j,Ye)|0,C=Math.imul(j,Ze);var _r=(G+(_=_+Math.imul(B,ir)|0)|0)+((8191&(S=(S=S+Math.imul(B,ct)|0)+Math.imul(X,ir)|0))<<13)|0;G=((C=C+Math.imul(X,ct)|0)+(S>>>13)|0)+(_r>>>26)|0,_r&=67108863,_=Math.imul(W,Ye),S=(S=Math.imul(W,Ze))+Math.imul(Y,Ye)|0,C=Math.imul(Y,Ze),_=_+Math.imul(N,ir)|0,S=(S=S+Math.imul(N,ct)|0)+Math.imul(j,ir)|0,C=C+Math.imul(j,ct)|0;var rn=(G+(_=_+Math.imul(B,Vt)|0)|0)+((8191&(S=(S=S+Math.imul(B,_t)|0)+Math.imul(X,Vt)|0))<<13)|0;G=((C=C+Math.imul(X,_t)|0)+(S>>>13)|0)+(rn>>>26)|0,rn&=67108863,_=Math.imul(se,Ye),S=(S=Math.imul(se,Ze))+Math.imul(re,Ye)|0,C=Math.imul(re,Ze),_=_+Math.imul(W,ir)|0,S=(S=S+Math.imul(W,ct)|0)+Math.imul(Y,ir)|0,C=C+Math.imul(Y,ct)|0,_=_+Math.imul(N,Vt)|0,S=(S=S+Math.imul(N,_t)|0)+Math.imul(j,Vt)|0,C=C+Math.imul(j,_t)|0;var nn=(G+(_=_+Math.imul(B,er)|0)|0)+((8191&(S=(S=S+Math.imul(B,gt)|0)+Math.imul(X,er)|0))<<13)|0;G=((C=C+Math.imul(X,gt)|0)+(S>>>13)|0)+(nn>>>26)|0,nn&=67108863,_=Math.imul(ie,Ye),S=(S=Math.imul(ie,Ze))+Math.imul(ne,Ye)|0,C=Math.imul(ne,Ze),_=_+Math.imul(se,ir)|0,S=(S=S+Math.imul(se,ct)|0)+Math.imul(re,ir)|0,C=C+Math.imul(re,ct)|0,_=_+Math.imul(W,Vt)|0,S=(S=S+Math.imul(W,_t)|0)+Math.imul(Y,Vt)|0,C=C+Math.imul(Y,_t)|0,_=_+Math.imul(N,er)|0,S=(S=S+Math.imul(N,gt)|0)+Math.imul(j,er)|0,C=C+Math.imul(j,gt)|0;var Qn=(G+(_=_+Math.imul(B,fr)|0)|0)+((8191&(S=(S=S+Math.imul(B,yt)|0)+Math.imul(X,fr)|0))<<13)|0;G=((C=C+Math.imul(X,yt)|0)+(S>>>13)|0)+(Qn>>>26)|0,Qn&=67108863,_=Math.imul(ae,Ye),S=(S=Math.imul(ae,Ze))+Math.imul(fe,Ye)|0,C=Math.imul(fe,Ze),_=_+Math.imul(ie,ir)|0,S=(S=S+Math.imul(ie,ct)|0)+Math.imul(ne,ir)|0,C=C+Math.imul(ne,ct)|0,_=_+Math.imul(se,Vt)|0,S=(S=S+Math.imul(se,_t)|0)+Math.imul(re,Vt)|0,C=C+Math.imul(re,_t)|0,_=_+Math.imul(W,er)|0,S=(S=S+Math.imul(W,gt)|0)+Math.imul(Y,er)|0,C=C+Math.imul(Y,gt)|0,_=_+Math.imul(N,fr)|0,S=(S=S+Math.imul(N,yt)|0)+Math.imul(j,fr)|0,C=C+Math.imul(j,yt)|0;var ce=(G+(_=_+Math.imul(B,pr)|0)|0)+((8191&(S=(S=S+Math.imul(B,Rt)|0)+Math.imul(X,pr)|0))<<13)|0;G=((C=C+Math.imul(X,Rt)|0)+(S>>>13)|0)+(ce>>>26)|0,ce&=67108863,_=Math.imul(ye,Ye),S=(S=Math.imul(ye,Ze))+Math.imul(xe,Ye)|0,C=Math.imul(xe,Ze),_=_+Math.imul(ae,ir)|0,S=(S=S+Math.imul(ae,ct)|0)+Math.imul(fe,ir)|0,C=C+Math.imul(fe,ct)|0,_=_+Math.imul(ie,Vt)|0,S=(S=S+Math.imul(ie,_t)|0)+Math.imul(ne,Vt)|0,C=C+Math.imul(ne,_t)|0,_=_+Math.imul(se,er)|0,S=(S=S+Math.imul(se,gt)|0)+Math.imul(re,er)|0,C=C+Math.imul(re,gt)|0,_=_+Math.imul(W,fr)|0,S=(S=S+Math.imul(W,yt)|0)+Math.imul(Y,fr)|0,C=C+Math.imul(Y,yt)|0,_=_+Math.imul(N,pr)|0,S=(S=S+Math.imul(N,Rt)|0)+Math.imul(j,pr)|0,C=C+Math.imul(j,Rt)|0;var be=(G+(_=_+Math.imul(B,ve)|0)|0)+((8191&(S=(S=S+Math.imul(B,Se)|0)+Math.imul(X,ve)|0))<<13)|0;G=((C=C+Math.imul(X,Se)|0)+(S>>>13)|0)+(be>>>26)|0,be&=67108863,_=Math.imul(Oe,Ye),S=(S=Math.imul(Oe,Ze))+Math.imul(Me,Ye)|0,C=Math.imul(Me,Ze),_=_+Math.imul(ye,ir)|0,S=(S=S+Math.imul(ye,ct)|0)+Math.imul(xe,ir)|0,C=C+Math.imul(xe,ct)|0,_=_+Math.imul(ae,Vt)|0,S=(S=S+Math.imul(ae,_t)|0)+Math.imul(fe,Vt)|0,C=C+Math.imul(fe,_t)|0,_=_+Math.imul(ie,er)|0,S=(S=S+Math.imul(ie,gt)|0)+Math.imul(ne,er)|0,C=C+Math.imul(ne,gt)|0,_=_+Math.imul(se,fr)|0,S=(S=S+Math.imul(se,yt)|0)+Math.imul(re,fr)|0,C=C+Math.imul(re,yt)|0,_=_+Math.imul(W,pr)|0,S=(S=S+Math.imul(W,Rt)|0)+Math.imul(Y,pr)|0,C=C+Math.imul(Y,Rt)|0,_=_+Math.imul(N,ve)|0,S=(S=S+Math.imul(N,Se)|0)+Math.imul(j,ve)|0,C=C+Math.imul(j,Se)|0;var Ae=(G+(_=_+Math.imul(B,dt)|0)|0)+((8191&(S=(S=S+Math.imul(B,je)|0)+Math.imul(X,dt)|0))<<13)|0;G=((C=C+Math.imul(X,je)|0)+(S>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,_=Math.imul(We,Ye),S=(S=Math.imul(We,Ze))+Math.imul(Ke,Ye)|0,C=Math.imul(Ke,Ze),_=_+Math.imul(Oe,ir)|0,S=(S=S+Math.imul(Oe,ct)|0)+Math.imul(Me,ir)|0,C=C+Math.imul(Me,ct)|0,_=_+Math.imul(ye,Vt)|0,S=(S=S+Math.imul(ye,_t)|0)+Math.imul(xe,Vt)|0,C=C+Math.imul(xe,_t)|0,_=_+Math.imul(ae,er)|0,S=(S=S+Math.imul(ae,gt)|0)+Math.imul(fe,er)|0,C=C+Math.imul(fe,gt)|0,_=_+Math.imul(ie,fr)|0,S=(S=S+Math.imul(ie,yt)|0)+Math.imul(ne,fr)|0,C=C+Math.imul(ne,yt)|0,_=_+Math.imul(se,pr)|0,S=(S=S+Math.imul(se,Rt)|0)+Math.imul(re,pr)|0,C=C+Math.imul(re,Rt)|0,_=_+Math.imul(W,ve)|0,S=(S=S+Math.imul(W,Se)|0)+Math.imul(Y,ve)|0,C=C+Math.imul(Y,Se)|0,_=_+Math.imul(N,dt)|0,S=(S=S+Math.imul(N,je)|0)+Math.imul(j,dt)|0,C=C+Math.imul(j,je)|0;var Ie=(G+(_=_+Math.imul(B,ft)|0)|0)+((8191&(S=(S=S+Math.imul(B,at)|0)+Math.imul(X,ft)|0))<<13)|0;G=((C=C+Math.imul(X,at)|0)+(S>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,_=Math.imul(Ve,Ye),S=(S=Math.imul(Ve,Ze))+Math.imul(Pe,Ye)|0,C=Math.imul(Pe,Ze),_=_+Math.imul(We,ir)|0,S=(S=S+Math.imul(We,ct)|0)+Math.imul(Ke,ir)|0,C=C+Math.imul(Ke,ct)|0,_=_+Math.imul(Oe,Vt)|0,S=(S=S+Math.imul(Oe,_t)|0)+Math.imul(Me,Vt)|0,C=C+Math.imul(Me,_t)|0,_=_+Math.imul(ye,er)|0,S=(S=S+Math.imul(ye,gt)|0)+Math.imul(xe,er)|0,C=C+Math.imul(xe,gt)|0,_=_+Math.imul(ae,fr)|0,S=(S=S+Math.imul(ae,yt)|0)+Math.imul(fe,fr)|0,C=C+Math.imul(fe,yt)|0,_=_+Math.imul(ie,pr)|0,S=(S=S+Math.imul(ie,Rt)|0)+Math.imul(ne,pr)|0,C=C+Math.imul(ne,Rt)|0,_=_+Math.imul(se,ve)|0,S=(S=S+Math.imul(se,Se)|0)+Math.imul(re,ve)|0,C=C+Math.imul(re,Se)|0,_=_+Math.imul(W,dt)|0,S=(S=S+Math.imul(W,je)|0)+Math.imul(Y,dt)|0,C=C+Math.imul(Y,je)|0,_=_+Math.imul(N,ft)|0,S=(S=S+Math.imul(N,at)|0)+Math.imul(j,ft)|0,C=C+Math.imul(j,at)|0;var st=(G+(_=_+Math.imul(B,bt)|0)|0)+((8191&(S=(S=S+Math.imul(B,Lt)|0)+Math.imul(X,bt)|0))<<13)|0;G=((C=C+Math.imul(X,Lt)|0)+(S>>>13)|0)+(st>>>26)|0,st&=67108863,_=Math.imul(Ve,ir),S=(S=Math.imul(Ve,ct))+Math.imul(Pe,ir)|0,C=Math.imul(Pe,ct),_=_+Math.imul(We,Vt)|0,S=(S=S+Math.imul(We,_t)|0)+Math.imul(Ke,Vt)|0,C=C+Math.imul(Ke,_t)|0,_=_+Math.imul(Oe,er)|0,S=(S=S+Math.imul(Oe,gt)|0)+Math.imul(Me,er)|0,C=C+Math.imul(Me,gt)|0,_=_+Math.imul(ye,fr)|0,S=(S=S+Math.imul(ye,yt)|0)+Math.imul(xe,fr)|0,C=C+Math.imul(xe,yt)|0,_=_+Math.imul(ae,pr)|0,S=(S=S+Math.imul(ae,Rt)|0)+Math.imul(fe,pr)|0,C=C+Math.imul(fe,Rt)|0,_=_+Math.imul(ie,ve)|0,S=(S=S+Math.imul(ie,Se)|0)+Math.imul(ne,ve)|0,C=C+Math.imul(ne,Se)|0,_=_+Math.imul(se,dt)|0,S=(S=S+Math.imul(se,je)|0)+Math.imul(re,dt)|0,C=C+Math.imul(re,je)|0,_=_+Math.imul(W,ft)|0,S=(S=S+Math.imul(W,at)|0)+Math.imul(Y,ft)|0,C=C+Math.imul(Y,at)|0;var De=(G+(_=_+Math.imul(N,bt)|0)|0)+((8191&(S=(S=S+Math.imul(N,Lt)|0)+Math.imul(j,bt)|0))<<13)|0;G=((C=C+Math.imul(j,Lt)|0)+(S>>>13)|0)+(De>>>26)|0,De&=67108863,_=Math.imul(Ve,Vt),S=(S=Math.imul(Ve,_t))+Math.imul(Pe,Vt)|0,C=Math.imul(Pe,_t),_=_+Math.imul(We,er)|0,S=(S=S+Math.imul(We,gt)|0)+Math.imul(Ke,er)|0,C=C+Math.imul(Ke,gt)|0,_=_+Math.imul(Oe,fr)|0,S=(S=S+Math.imul(Oe,yt)|0)+Math.imul(Me,fr)|0,C=C+Math.imul(Me,yt)|0,_=_+Math.imul(ye,pr)|0,S=(S=S+Math.imul(ye,Rt)|0)+Math.imul(xe,pr)|0,C=C+Math.imul(xe,Rt)|0,_=_+Math.imul(ae,ve)|0,S=(S=S+Math.imul(ae,Se)|0)+Math.imul(fe,ve)|0,C=C+Math.imul(fe,Se)|0,_=_+Math.imul(ie,dt)|0,S=(S=S+Math.imul(ie,je)|0)+Math.imul(ne,dt)|0,C=C+Math.imul(ne,je)|0,_=_+Math.imul(se,ft)|0,S=(S=S+Math.imul(se,at)|0)+Math.imul(re,ft)|0,C=C+Math.imul(re,at)|0;var Ue=(G+(_=_+Math.imul(W,bt)|0)|0)+((8191&(S=(S=S+Math.imul(W,Lt)|0)+Math.imul(Y,bt)|0))<<13)|0;G=((C=C+Math.imul(Y,Lt)|0)+(S>>>13)|0)+(Ue>>>26)|0,Ue&=67108863,_=Math.imul(Ve,er),S=(S=Math.imul(Ve,gt))+Math.imul(Pe,er)|0,C=Math.imul(Pe,gt),_=_+Math.imul(We,fr)|0,S=(S=S+Math.imul(We,yt)|0)+Math.imul(Ke,fr)|0,C=C+Math.imul(Ke,yt)|0,_=_+Math.imul(Oe,pr)|0,S=(S=S+Math.imul(Oe,Rt)|0)+Math.imul(Me,pr)|0,C=C+Math.imul(Me,Rt)|0,_=_+Math.imul(ye,ve)|0,S=(S=S+Math.imul(ye,Se)|0)+Math.imul(xe,ve)|0,C=C+Math.imul(xe,Se)|0,_=_+Math.imul(ae,dt)|0,S=(S=S+Math.imul(ae,je)|0)+Math.imul(fe,dt)|0,C=C+Math.imul(fe,je)|0,_=_+Math.imul(ie,ft)|0,S=(S=S+Math.imul(ie,at)|0)+Math.imul(ne,ft)|0,C=C+Math.imul(ne,at)|0;var Ht=(G+(_=_+Math.imul(se,bt)|0)|0)+((8191&(S=(S=S+Math.imul(se,Lt)|0)+Math.imul(re,bt)|0))<<13)|0;G=((C=C+Math.imul(re,Lt)|0)+(S>>>13)|0)+(Ht>>>26)|0,Ht&=67108863,_=Math.imul(Ve,fr),S=(S=Math.imul(Ve,yt))+Math.imul(Pe,fr)|0,C=Math.imul(Pe,yt),_=_+Math.imul(We,pr)|0,S=(S=S+Math.imul(We,Rt)|0)+Math.imul(Ke,pr)|0,C=C+Math.imul(Ke,Rt)|0,_=_+Math.imul(Oe,ve)|0,S=(S=S+Math.imul(Oe,Se)|0)+Math.imul(Me,ve)|0,C=C+Math.imul(Me,Se)|0,_=_+Math.imul(ye,dt)|0,S=(S=S+Math.imul(ye,je)|0)+Math.imul(xe,dt)|0,C=C+Math.imul(xe,je)|0,_=_+Math.imul(ae,ft)|0,S=(S=S+Math.imul(ae,at)|0)+Math.imul(fe,ft)|0,C=C+Math.imul(fe,at)|0;var Mt=(G+(_=_+Math.imul(ie,bt)|0)|0)+((8191&(S=(S=S+Math.imul(ie,Lt)|0)+Math.imul(ne,bt)|0))<<13)|0;G=((C=C+Math.imul(ne,Lt)|0)+(S>>>13)|0)+(Mt>>>26)|0,Mt&=67108863,_=Math.imul(Ve,pr),S=(S=Math.imul(Ve,Rt))+Math.imul(Pe,pr)|0,C=Math.imul(Pe,Rt),_=_+Math.imul(We,ve)|0,S=(S=S+Math.imul(We,Se)|0)+Math.imul(Ke,ve)|0,C=C+Math.imul(Ke,Se)|0,_=_+Math.imul(Oe,dt)|0,S=(S=S+Math.imul(Oe,je)|0)+Math.imul(Me,dt)|0,C=C+Math.imul(Me,je)|0,_=_+Math.imul(ye,ft)|0,S=(S=S+Math.imul(ye,at)|0)+Math.imul(xe,ft)|0,C=C+Math.imul(xe,at)|0;var Dt=(G+(_=_+Math.imul(ae,bt)|0)|0)+((8191&(S=(S=S+Math.imul(ae,Lt)|0)+Math.imul(fe,bt)|0))<<13)|0;G=((C=C+Math.imul(fe,Lt)|0)+(S>>>13)|0)+(Dt>>>26)|0,Dt&=67108863,_=Math.imul(Ve,ve),S=(S=Math.imul(Ve,Se))+Math.imul(Pe,ve)|0,C=Math.imul(Pe,Se),_=_+Math.imul(We,dt)|0,S=(S=S+Math.imul(We,je)|0)+Math.imul(Ke,dt)|0,C=C+Math.imul(Ke,je)|0,_=_+Math.imul(Oe,ft)|0,S=(S=S+Math.imul(Oe,at)|0)+Math.imul(Me,ft)|0,C=C+Math.imul(Me,at)|0;var pt=(G+(_=_+Math.imul(ye,bt)|0)|0)+((8191&(S=(S=S+Math.imul(ye,Lt)|0)+Math.imul(xe,bt)|0))<<13)|0;G=((C=C+Math.imul(xe,Lt)|0)+(S>>>13)|0)+(pt>>>26)|0,pt&=67108863,_=Math.imul(Ve,dt),S=(S=Math.imul(Ve,je))+Math.imul(Pe,dt)|0,C=Math.imul(Pe,je),_=_+Math.imul(We,ft)|0,S=(S=S+Math.imul(We,at)|0)+Math.imul(Ke,ft)|0,C=C+Math.imul(Ke,at)|0;var lr=(G+(_=_+Math.imul(Oe,bt)|0)|0)+((8191&(S=(S=S+Math.imul(Oe,Lt)|0)+Math.imul(Me,bt)|0))<<13)|0;G=((C=C+Math.imul(Me,Lt)|0)+(S>>>13)|0)+(lr>>>26)|0,lr&=67108863,_=Math.imul(Ve,ft),S=(S=Math.imul(Ve,at))+Math.imul(Pe,ft)|0,C=Math.imul(Pe,at);var ur=(G+(_=_+Math.imul(We,bt)|0)|0)+((8191&(S=(S=S+Math.imul(We,Lt)|0)+Math.imul(Ke,bt)|0))<<13)|0;G=((C=C+Math.imul(Ke,Lt)|0)+(S>>>13)|0)+(ur>>>26)|0,ur&=67108863;var mr=(G+(_=Math.imul(Ve,bt))|0)+((8191&(S=(S=Math.imul(Ve,Lt))+Math.imul(Pe,bt)|0))<<13)|0;return G=((C=Math.imul(Pe,Lt))+(S>>>13)|0)+(mr>>>26)|0,mr&=67108863,H[0]=Br,H[1]=_r,H[2]=rn,H[3]=nn,H[4]=Qn,H[5]=ce,H[6]=be,H[7]=Ae,H[8]=Ie,H[9]=st,H[10]=De,H[11]=Ue,H[12]=Ht,H[13]=Mt,H[14]=Dt,H[15]=pt,H[16]=lr,H[17]=ur,H[18]=mr,G!==0&&(H[19]=G,x.length++),x};function A(T,w,x){x.negative=w.negative^T.negative,x.length=T.length+w.length;for(var _=0,S=0,C=0;C<x.length-1;C++){var F=S;S=0;for(var D=67108863&_,H=Math.min(C,w.length-1),G=Math.max(0,C-T.length+1);G<=H;G++){var ee=C-G,B=(0|T.words[ee])*(0|w.words[G]),X=67108863&B;D=67108863&(X=X+D|0),S+=(F=(F=F+(B/67108864|0)|0)+(X>>>26)|0)>>>26,F&=67108863}x.words[C]=D,_=F,F=S}return _!==0?x.words[C]=_:x.length--,x._strip()}function M(T,w,x){return A(T,w,x)}Math.imul||(E=b),u.prototype.mulTo=function(T,w){var x=this.length+T.length;return this.length===10&&T.length===10?E(this,T,w):x<63?b(this,T,w):x<1024?A(this,T,w):M(this,T,w)},u.prototype.mul=function(T){var w=new u(null);return w.words=new Array(this.length+T.length),this.mulTo(T,w)},u.prototype.mulf=function(T){var w=new u(null);return w.words=new Array(this.length+T.length),M(this,T,w)},u.prototype.imul=function(T){return this.clone().mulTo(T,this)},u.prototype.imuln=function(T){var w=T<0;w&&(T=-T),a(typeof T=="number"),a(T<67108864);for(var x=0,_=0;_<this.length;_++){var S=(0|this.words[_])*T,C=(67108863&S)+(67108863&x);x>>=26,x+=S/67108864|0,x+=C>>>26,this.words[_]=67108863&C}return x!==0&&(this.words[_]=x,this.length++),w?this.ineg():this},u.prototype.muln=function(T){return this.clone().imuln(T)},u.prototype.sqr=function(){return this.mul(this)},u.prototype.isqr=function(){return this.imul(this.clone())},u.prototype.pow=function(T){var w=(function(C){for(var F=new Array(C.bitLength()),D=0;D<F.length;D++){var H=D/26|0,G=D%26;F[D]=C.words[H]>>>G&1}return F})(T);if(w.length===0)return new u(1);for(var x=this,_=0;_<w.length&&w[_]===0;_++,x=x.sqr());if(++_<w.length)for(var S=x.sqr();_<w.length;_++,S=S.sqr())w[_]!==0&&(x=x.mul(S));return x},u.prototype.iushln=function(T){a(typeof T=="number"&&T>=0);var w,x=T%26,_=(T-x)/26,S=67108863>>>26-x<<26-x;if(x!==0){var C=0;for(w=0;w<this.length;w++){var F=this.words[w]&S,D=(0|this.words[w])-F<<x;this.words[w]=D|C,C=F>>>26-x}C&&(this.words[w]=C,this.length++)}if(_!==0){for(w=this.length-1;w>=0;w--)this.words[w+_]=this.words[w];for(w=0;w<_;w++)this.words[w]=0;this.length+=_}return this._strip()},u.prototype.ishln=function(T){return a(this.negative===0),this.iushln(T)},u.prototype.iushrn=function(T,w,x){var _;a(typeof T=="number"&&T>=0),_=w?(w-w%26)/26:0;var S=T%26,C=Math.min((T-S)/26,this.length),F=67108863^67108863>>>S<<S,D=x;if(_-=C,_=Math.max(0,_),D){for(var H=0;H<C;H++)D.words[H]=this.words[H];D.length=C}if(C!==0)if(this.length>C)for(this.length-=C,H=0;H<this.length;H++)this.words[H]=this.words[H+C];else this.words[0]=0,this.length=1;var G=0;for(H=this.length-1;H>=0&&(G!==0||H>=_);H--){var ee=0|this.words[H];this.words[H]=G<<26-S|ee>>>S,G=ee&F}return D&&G!==0&&(D.words[D.length++]=G),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},u.prototype.ishrn=function(T,w,x){return a(this.negative===0),this.iushrn(T,w,x)},u.prototype.shln=function(T){return this.clone().ishln(T)},u.prototype.ushln=function(T){return this.clone().iushln(T)},u.prototype.shrn=function(T){return this.clone().ishrn(T)},u.prototype.ushrn=function(T){return this.clone().iushrn(T)},u.prototype.testn=function(T){a(typeof T=="number"&&T>=0);var w=T%26,x=(T-w)/26,_=1<<w;return!(this.length<=x)&&!!(this.words[x]&_)},u.prototype.imaskn=function(T){a(typeof T=="number"&&T>=0);var w=T%26,x=(T-w)/26;if(a(this.negative===0,"imaskn works only with positive numbers"),this.length<=x)return this;if(w!==0&&x++,this.length=Math.min(x,this.length),w!==0){var _=67108863^67108863>>>w<<w;this.words[this.length-1]&=_}return this._strip()},u.prototype.maskn=function(T){return this.clone().imaskn(T)},u.prototype.iaddn=function(T){return a(typeof T=="number"),a(T<67108864),T<0?this.isubn(-T):this.negative!==0?this.length===1&&(0|this.words[0])<=T?(this.words[0]=T-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(T),this.negative=1,this):this._iaddn(T)},u.prototype._iaddn=function(T){this.words[0]+=T;for(var w=0;w<this.length&&this.words[w]>=67108864;w++)this.words[w]-=67108864,w===this.length-1?this.words[w+1]=1:this.words[w+1]++;return this.length=Math.max(this.length,w+1),this},u.prototype.isubn=function(T){if(a(typeof T=="number"),a(T<67108864),T<0)return this.iaddn(-T);if(this.negative!==0)return this.negative=0,this.iaddn(T),this.negative=1,this;if(this.words[0]-=T,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var w=0;w<this.length&&this.words[w]<0;w++)this.words[w]+=67108864,this.words[w+1]-=1;return this._strip()},u.prototype.addn=function(T){return this.clone().iaddn(T)},u.prototype.subn=function(T){return this.clone().isubn(T)},u.prototype.iabs=function(){return this.negative=0,this},u.prototype.abs=function(){return this.clone().iabs()},u.prototype._ishlnsubmul=function(T,w,x){var _,S,C=T.length+x;this._expand(C);var F=0;for(_=0;_<T.length;_++){S=(0|this.words[_+x])+F;var D=(0|T.words[_])*w;F=((S-=67108863&D)>>26)-(D/67108864|0),this.words[_+x]=67108863&S}for(;_<this.length-x;_++)F=(S=(0|this.words[_+x])+F)>>26,this.words[_+x]=67108863&S;if(F===0)return this._strip();for(a(F===-1),F=0,_=0;_<this.length;_++)F=(S=-(0|this.words[_])+F)>>26,this.words[_]=67108863&S;return this.negative=1,this._strip()},u.prototype._wordDiv=function(T,w){var x=(this.length,T.length),_=this.clone(),S=T,C=0|S.words[S.length-1];(x=26-this._countBits(C))!==0&&(S=S.ushln(x),_.iushln(x),C=0|S.words[S.length-1]);var F,D=_.length-S.length;if(w!=="mod"){(F=new u(null)).length=D+1,F.words=new Array(F.length);for(var H=0;H<F.length;H++)F.words[H]=0}var G=_.clone()._ishlnsubmul(S,1,D);G.negative===0&&(_=G,F&&(F.words[D]=1));for(var ee=D-1;ee>=0;ee--){var B=67108864*(0|_.words[S.length+ee])+(0|_.words[S.length+ee-1]);for(B=Math.min(B/C|0,67108863),_._ishlnsubmul(S,B,ee);_.negative!==0;)B--,_.negative=0,_._ishlnsubmul(S,1,ee),_.isZero()||(_.negative^=1);F&&(F.words[ee]=B)}return F&&F._strip(),_._strip(),w!=="div"&&x!==0&&_.iushrn(x),{div:F||null,mod:_}},u.prototype.divmod=function(T,w,x){return a(!T.isZero()),this.isZero()?{div:new u(0),mod:new u(0)}:this.negative!==0&&T.negative===0?(C=this.neg().divmod(T,w),w!=="mod"&&(_=C.div.neg()),w!=="div"&&(S=C.mod.neg(),x&&S.negative!==0&&S.iadd(T)),{div:_,mod:S}):this.negative===0&&T.negative!==0?(C=this.divmod(T.neg(),w),w!=="mod"&&(_=C.div.neg()),{div:_,mod:C.mod}):(this.negative&T.negative)!=0?(C=this.neg().divmod(T.neg(),w),w!=="div"&&(S=C.mod.neg(),x&&S.negative!==0&&S.isub(T)),{div:C.div,mod:S}):T.length>this.length||this.cmp(T)<0?{div:new u(0),mod:this}:T.length===1?w==="div"?{div:this.divn(T.words[0]),mod:null}:w==="mod"?{div:null,mod:new u(this.modrn(T.words[0]))}:{div:this.divn(T.words[0]),mod:new u(this.modrn(T.words[0]))}:this._wordDiv(T,w);var _,S,C},u.prototype.div=function(T){return this.divmod(T,"div",!1).div},u.prototype.mod=function(T){return this.divmod(T,"mod",!1).mod},u.prototype.umod=function(T){return this.divmod(T,"mod",!0).mod},u.prototype.divRound=function(T){var w=this.divmod(T);if(w.mod.isZero())return w.div;var x=w.div.negative!==0?w.mod.isub(T):w.mod,_=T.ushrn(1),S=T.andln(1),C=x.cmp(_);return C<0||S===1&&C===0?w.div:w.div.negative!==0?w.div.isubn(1):w.div.iaddn(1)},u.prototype.modrn=function(T){var w=T<0;w&&(T=-T),a(T<=67108863);for(var x=(1<<26)%T,_=0,S=this.length-1;S>=0;S--)_=(x*_+(0|this.words[S]))%T;return w?-_:_},u.prototype.modn=function(T){return this.modrn(T)},u.prototype.idivn=function(T){var w=T<0;w&&(T=-T),a(T<=67108863);for(var x=0,_=this.length-1;_>=0;_--){var S=(0|this.words[_])+67108864*x;this.words[_]=S/T|0,x=S%T}return this._strip(),w?this.ineg():this},u.prototype.divn=function(T){return this.clone().idivn(T)},u.prototype.egcd=function(T){a(T.negative===0),a(!T.isZero());var w=this,x=T.clone();w=w.negative!==0?w.umod(T):w.clone();for(var _=new u(1),S=new u(0),C=new u(0),F=new u(1),D=0;w.isEven()&&x.isEven();)w.iushrn(1),x.iushrn(1),++D;for(var H=x.clone(),G=w.clone();!w.isZero();){for(var ee=0,B=1;(w.words[0]&B)==0&&ee<26;++ee,B<<=1);if(ee>0)for(w.iushrn(ee);ee-- >0;)(_.isOdd()||S.isOdd())&&(_.iadd(H),S.isub(G)),_.iushrn(1),S.iushrn(1);for(var X=0,I=1;(x.words[0]&I)==0&&X<26;++X,I<<=1);if(X>0)for(x.iushrn(X);X-- >0;)(C.isOdd()||F.isOdd())&&(C.iadd(H),F.isub(G)),C.iushrn(1),F.iushrn(1);w.cmp(x)>=0?(w.isub(x),_.isub(C),S.isub(F)):(x.isub(w),C.isub(_),F.isub(S))}return{a:C,b:F,gcd:x.iushln(D)}},u.prototype._invmp=function(T){a(T.negative===0),a(!T.isZero());var w=this,x=T.clone();w=w.negative!==0?w.umod(T):w.clone();for(var _,S=new u(1),C=new u(0),F=x.clone();w.cmpn(1)>0&&x.cmpn(1)>0;){for(var D=0,H=1;(w.words[0]&H)==0&&D<26;++D,H<<=1);if(D>0)for(w.iushrn(D);D-- >0;)S.isOdd()&&S.iadd(F),S.iushrn(1);for(var G=0,ee=1;(x.words[0]&ee)==0&&G<26;++G,ee<<=1);if(G>0)for(x.iushrn(G);G-- >0;)C.isOdd()&&C.iadd(F),C.iushrn(1);w.cmp(x)>=0?(w.isub(x),S.isub(C)):(x.isub(w),C.isub(S))}return(_=w.cmpn(1)===0?S:C).cmpn(0)<0&&_.iadd(T),_},u.prototype.gcd=function(T){if(this.isZero())return T.abs();if(T.isZero())return this.abs();var w=this.clone(),x=T.clone();w.negative=0,x.negative=0;for(var _=0;w.isEven()&&x.isEven();_++)w.iushrn(1),x.iushrn(1);for(;;){for(;w.isEven();)w.iushrn(1);for(;x.isEven();)x.iushrn(1);var S=w.cmp(x);if(S<0){var C=w;w=x,x=C}else if(S===0||x.cmpn(1)===0)break;w.isub(x)}return x.iushln(_)},u.prototype.invm=function(T){return this.egcd(T).a.umod(T)},u.prototype.isEven=function(){return(1&this.words[0])==0},u.prototype.isOdd=function(){return(1&this.words[0])==1},u.prototype.andln=function(T){return this.words[0]&T},u.prototype.bincn=function(T){a(typeof T=="number");var w=T%26,x=(T-w)/26,_=1<<w;if(this.length<=x)return this._expand(x+1),this.words[x]|=_,this;for(var S=_,C=x;S!==0&&C<this.length;C++){var F=0|this.words[C];S=(F+=S)>>>26,F&=67108863,this.words[C]=F}return S!==0&&(this.words[C]=S,this.length++),this},u.prototype.isZero=function(){return this.length===1&&this.words[0]===0},u.prototype.cmpn=function(T){var w,x=T<0;if(this.negative!==0&&!x)return-1;if(this.negative===0&&x)return 1;if(this._strip(),this.length>1)w=1;else{x&&(T=-T),a(T<=67108863,"Number is too big");var _=0|this.words[0];w=_===T?0:_<T?-1:1}return this.negative!==0?0|-w:w},u.prototype.cmp=function(T){if(this.negative!==0&&T.negative===0)return-1;if(this.negative===0&&T.negative!==0)return 1;var w=this.ucmp(T);return this.negative!==0?0|-w:w},u.prototype.ucmp=function(T){if(this.length>T.length)return 1;if(this.length<T.length)return-1;for(var w=0,x=this.length-1;x>=0;x--){var _=0|this.words[x],S=0|T.words[x];if(_!==S){_<S?w=-1:_>S&&(w=1);break}}return w},u.prototype.gtn=function(T){return this.cmpn(T)===1},u.prototype.gt=function(T){return this.cmp(T)===1},u.prototype.gten=function(T){return this.cmpn(T)>=0},u.prototype.gte=function(T){return this.cmp(T)>=0},u.prototype.ltn=function(T){return this.cmpn(T)===-1},u.prototype.lt=function(T){return this.cmp(T)===-1},u.prototype.lten=function(T){return this.cmpn(T)<=0},u.prototype.lte=function(T){return this.cmp(T)<=0},u.prototype.eqn=function(T){return this.cmpn(T)===0},u.prototype.eq=function(T){return this.cmp(T)===0},u.red=function(T){return new R(T)},u.prototype.toRed=function(T){return a(!this.red,"Already a number in reduction context"),a(this.negative===0,"red works only with positives"),T.convertTo(this)._forceRed(T)},u.prototype.fromRed=function(){return a(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},u.prototype._forceRed=function(T){return this.red=T,this},u.prototype.forceRed=function(T){return a(!this.red,"Already a number in reduction context"),this._forceRed(T)},u.prototype.redAdd=function(T){return a(this.red,"redAdd works only with red numbers"),this.red.add(this,T)},u.prototype.redIAdd=function(T){return a(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,T)},u.prototype.redSub=function(T){return a(this.red,"redSub works only with red numbers"),this.red.sub(this,T)},u.prototype.redISub=function(T){return a(this.red,"redISub works only with red numbers"),this.red.isub(this,T)},u.prototype.redShl=function(T){return a(this.red,"redShl works only with red numbers"),this.red.shl(this,T)},u.prototype.redMul=function(T){return a(this.red,"redMul works only with red numbers"),this.red._verify2(this,T),this.red.mul(this,T)},u.prototype.redIMul=function(T){return a(this.red,"redMul works only with red numbers"),this.red._verify2(this,T),this.red.imul(this,T)},u.prototype.redSqr=function(){return a(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},u.prototype.redISqr=function(){return a(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},u.prototype.redSqrt=function(){return a(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},u.prototype.redInvm=function(){return a(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},u.prototype.redNeg=function(){return a(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},u.prototype.redPow=function(T){return a(this.red&&!T.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,T)};var L={k256:null,p224:null,p192:null,p25519:null};function k(T,w){this.name=T,this.p=new u(w,16),this.n=this.p.bitLength(),this.k=new u(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function P(){k.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function U(){k.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function $(){k.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function V(){k.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function R(T){if(typeof T=="string"){var w=u._prime(T);this.m=w.p,this.prime=w}else a(T.gtn(1),"modulus must be greater than 1"),this.m=T,this.prime=null}function O(T){R.call(this,T),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new u(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}k.prototype._tmp=function(){var T=new u(null);return T.words=new Array(Math.ceil(this.n/13)),T},k.prototype.ireduce=function(T){var w,x=T;do this.split(x,this.tmp),w=(x=(x=this.imulK(x)).iadd(this.tmp)).bitLength();while(w>this.n);var _=w<this.n?-1:x.ucmp(this.p);return _===0?(x.words[0]=0,x.length=1):_>0?x.isub(this.p):x.strip!==void 0?x.strip():x._strip(),x},k.prototype.split=function(T,w){T.iushrn(this.n,0,w)},k.prototype.imulK=function(T){return T.imul(this.k)},l(P,k),P.prototype.split=function(T,w){for(var x=Math.min(T.length,9),_=0;_<x;_++)w.words[_]=T.words[_];if(w.length=x,T.length<=9)return T.words[0]=0,void(T.length=1);var S=T.words[9];for(w.words[w.length++]=4194303&S,_=10;_<T.length;_++){var C=0|T.words[_];T.words[_-10]=(4194303&C)<<4|S>>>22,S=C}S>>>=22,T.words[_-10]=S,S===0&&T.length>10?T.length-=10:T.length-=9},P.prototype.imulK=function(T){T.words[T.length]=0,T.words[T.length+1]=0,T.length+=2;for(var w=0,x=0;x<T.length;x++){var _=0|T.words[x];w+=977*_,T.words[x]=67108863&w,w=64*_+(w/67108864|0)}return T.words[T.length-1]===0&&(T.length--,T.words[T.length-1]===0&&T.length--),T},l(U,k),l($,k),l(V,k),V.prototype.imulK=function(T){for(var w=0,x=0;x<T.length;x++){var _=19*(0|T.words[x])+w,S=67108863&_;_>>>=26,T.words[x]=S,w=_}return w!==0&&(T.words[T.length++]=w),T},u._prime=function(T){if(L[T])return L[T];var w;if(T==="k256")w=new P;else if(T==="p224")w=new U;else if(T==="p192")w=new $;else{if(T!=="p25519")throw new Error("Unknown prime "+T);w=new V}return L[T]=w,w},R.prototype._verify1=function(T){a(T.negative===0,"red works only with positives"),a(T.red,"red works only with red numbers")},R.prototype._verify2=function(T,w){a((T.negative|w.negative)==0,"red works only with positives"),a(T.red&&T.red===w.red,"red works only with red numbers")},R.prototype.imod=function(T){return this.prime?this.prime.ireduce(T)._forceRed(this):(m(T,T.umod(this.m)._forceRed(this)),T)},R.prototype.neg=function(T){return T.isZero()?T.clone():this.m.sub(T)._forceRed(this)},R.prototype.add=function(T,w){this._verify2(T,w);var x=T.add(w);return x.cmp(this.m)>=0&&x.isub(this.m),x._forceRed(this)},R.prototype.iadd=function(T,w){this._verify2(T,w);var x=T.iadd(w);return x.cmp(this.m)>=0&&x.isub(this.m),x},R.prototype.sub=function(T,w){this._verify2(T,w);var x=T.sub(w);return x.cmpn(0)<0&&x.iadd(this.m),x._forceRed(this)},R.prototype.isub=function(T,w){this._verify2(T,w);var x=T.isub(w);return x.cmpn(0)<0&&x.iadd(this.m),x},R.prototype.shl=function(T,w){return this._verify1(T),this.imod(T.ushln(w))},R.prototype.imul=function(T,w){return this._verify2(T,w),this.imod(T.imul(w))},R.prototype.mul=function(T,w){return this._verify2(T,w),this.imod(T.mul(w))},R.prototype.isqr=function(T){return this.imul(T,T.clone())},R.prototype.sqr=function(T){return this.mul(T,T)},R.prototype.sqrt=function(T){if(T.isZero())return T.clone();var w=this.m.andln(3);if(a(w%2==1),w===3){var x=this.m.add(new u(1)).iushrn(2);return this.pow(T,x)}for(var _=this.m.subn(1),S=0;!_.isZero()&&_.andln(1)===0;)S++,_.iushrn(1);a(!_.isZero());var C=new u(1).toRed(this),F=C.redNeg(),D=this.m.subn(1).iushrn(1),H=this.m.bitLength();for(H=new u(2*H*H).toRed(this);this.pow(H,D).cmp(F)!==0;)H.redIAdd(F);for(var G=this.pow(H,_),ee=this.pow(T,_.addn(1).iushrn(1)),B=this.pow(T,_),X=S;B.cmp(C)!==0;){for(var I=B,N=0;I.cmp(C)!==0;N++)I=I.redSqr();a(N<X);var j=this.pow(G,new u(1).iushln(X-N-1));ee=ee.redMul(j),G=j.redSqr(),B=B.redMul(G),X=N}return ee},R.prototype.invm=function(T){var w=T._invmp(this.m);return w.negative!==0?(w.negative=0,this.imod(w).redNeg()):this.imod(w)},R.prototype.pow=function(T,w){if(w.isZero())return new u(1).toRed(this);if(w.cmpn(1)===0)return T.clone();var x=new Array(16);x[0]=new u(1).toRed(this),x[1]=T;for(var _=2;_<x.length;_++)x[_]=this.mul(x[_-1],T);var S=x[0],C=0,F=0,D=w.bitLength()%26;for(D===0&&(D=26),_=w.length-1;_>=0;_--){for(var H=w.words[_],G=D-1;G>=0;G--){var ee=H>>G&1;S!==x[0]&&(S=this.sqr(S)),ee!==0||C!==0?(C<<=1,C|=ee,(++F===4||_===0&&G===0)&&(S=this.mul(S,x[C]),F=0,C=0)):F=0}D=26}return S},R.prototype.convertTo=function(T){var w=T.umod(this.m);return w===T?w.clone():w},R.prototype.convertFrom=function(T){var w=T.clone();return w.red=null,w},u.mont=function(T){return new O(T)},l(O,R),O.prototype.convertTo=function(T){return this.imod(T.ushln(this.shift))},O.prototype.convertFrom=function(T){var w=this.imod(T.mul(this.rinv));return w.red=null,w},O.prototype.imul=function(T,w){if(T.isZero()||w.isZero())return T.words[0]=0,T.length=1,T;var x=T.imul(w),_=x.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),S=x.isub(_).iushrn(this.shift),C=S;return S.cmp(this.m)>=0?C=S.isub(this.m):S.cmpn(0)<0&&(C=S.iadd(this.m)),C._forceRed(this)},O.prototype.mul=function(T,w){if(T.isZero()||w.isZero())return new u(0)._forceRed(this);var x=T.mul(w),_=x.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),S=x.isub(_).iushrn(this.shift),C=S;return S.cmp(this.m)>=0?C=S.isub(this.m):S.cmpn(0)<0&&(C=S.iadd(this.m)),C._forceRed(this)},O.prototype.invm=function(T){return this.imod(T._invmp(this.m).mul(this.r2))._forceRed(this)}})(n===void 0||n)},{buffer:188}],187:[function(t,n,i){var s;function o(l){this.rand=l}if(n.exports=function(l){return s||(s=new o(null)),s.generate(l)},n.exports.Rand=o,o.prototype.generate=function(l){return this._rand(l)},o.prototype._rand=function(l){if(this.rand.getBytes)return this.rand.getBytes(l);for(var u=new Uint8Array(l),c=0;c<u.length;c++)u[c]=this.rand.getByte();return u},typeof self=="object")self.crypto&&self.crypto.getRandomValues?o.prototype._rand=function(l){var u=new Uint8Array(l);return self.crypto.getRandomValues(u),u}:self.msCrypto&&self.msCrypto.getRandomValues?o.prototype._rand=function(l){var u=new Uint8Array(l);return self.msCrypto.getRandomValues(u),u}:typeof window=="object"&&(o.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var a=t("crypto");if(typeof a.randomBytes!="function")throw new Error("Not supported");o.prototype._rand=function(l){return a.randomBytes(l)}}catch{}},{crypto:188}],188:[function(t,n,i){},{}],189:[function(t,n,i){var s=t("safe-buffer").Buffer;function o(h){s.isBuffer(h)||(h=s.from(h));for(var f=h.length/4|0,m=new Array(f),p=0;p<f;p++)m[p]=h.readUInt32BE(4*p);return m}function a(h){for(;0<h.length;h++)h[0]=0}function l(h,f,m,p,g){for(var v,y,b,E,A=m[0],M=m[1],L=m[2],k=m[3],P=h[0]^f[0],U=h[1]^f[1],$=h[2]^f[2],V=h[3]^f[3],R=4,O=1;O<g;O++)v=A[P>>>24]^M[U>>>16&255]^L[$>>>8&255]^k[255&V]^f[R++],y=A[U>>>24]^M[$>>>16&255]^L[V>>>8&255]^k[255&P]^f[R++],b=A[$>>>24]^M[V>>>16&255]^L[P>>>8&255]^k[255&U]^f[R++],E=A[V>>>24]^M[P>>>16&255]^L[U>>>8&255]^k[255&$]^f[R++],P=v,U=y,$=b,V=E;return v=(p[P>>>24]<<24|p[U>>>16&255]<<16|p[$>>>8&255]<<8|p[255&V])^f[R++],y=(p[U>>>24]<<24|p[$>>>16&255]<<16|p[V>>>8&255]<<8|p[255&P])^f[R++],b=(p[$>>>24]<<24|p[V>>>16&255]<<16|p[P>>>8&255]<<8|p[255&U])^f[R++],E=(p[V>>>24]<<24|p[P>>>16&255]<<16|p[U>>>8&255]<<8|p[255&$])^f[R++],[v>>>=0,y>>>=0,b>>>=0,E>>>=0]}var u=[0,1,2,4,8,16,32,64,128,27,54],c=(function(){for(var h=new Array(256),f=0;f<256;f++)h[f]=f<128?f<<1:f<<1^283;for(var m=[],p=[],g=[[],[],[],[]],v=[[],[],[],[]],y=0,b=0,E=0;E<256;++E){var A=b^b<<1^b<<2^b<<3^b<<4;A=A>>>8^255&A^99,m[y]=A,p[A]=y;var M=h[y],L=h[M],k=h[L],P=257*h[A]^16843008*A;g[0][y]=P<<24|P>>>8,g[1][y]=P<<16|P>>>16,g[2][y]=P<<8|P>>>24,g[3][y]=P,P=16843009*k^65537*L^257*M^16843008*y,v[0][A]=P<<24|P>>>8,v[1][A]=P<<16|P>>>16,v[2][A]=P<<8|P>>>24,v[3][A]=P,y===0?y=b=1:(y=M^h[h[h[k^M]]],b^=h[h[b]])}return{SBOX:m,INV_SBOX:p,SUB_MIX:g,INV_SUB_MIX:v}})();function d(h){this._key=o(h),this._reset()}d.blockSize=16,d.keySize=32,d.prototype.blockSize=d.blockSize,d.prototype.keySize=d.keySize,d.prototype._reset=function(){for(var h=this._key,f=h.length,m=f+6,p=4*(m+1),g=[],v=0;v<f;v++)g[v]=h[v];for(v=f;v<p;v++){var y=g[v-1];v%f==0?(y=y<<8|y>>>24,y=c.SBOX[y>>>24]<<24|c.SBOX[y>>>16&255]<<16|c.SBOX[y>>>8&255]<<8|c.SBOX[255&y],y^=u[v/f|0]<<24):f>6&&v%f==4&&(y=c.SBOX[y>>>24]<<24|c.SBOX[y>>>16&255]<<16|c.SBOX[y>>>8&255]<<8|c.SBOX[255&y]),g[v]=g[v-f]^y}for(var b=[],E=0;E<p;E++){var A=p-E,M=g[A-(E%4?0:4)];b[E]=E<4||A<=4?M:c.INV_SUB_MIX[0][c.SBOX[M>>>24]]^c.INV_SUB_MIX[1][c.SBOX[M>>>16&255]]^c.INV_SUB_MIX[2][c.SBOX[M>>>8&255]]^c.INV_SUB_MIX[3][c.SBOX[255&M]]}this._nRounds=m,this._keySchedule=g,this._invKeySchedule=b},d.prototype.encryptBlockRaw=function(h){return l(h=o(h),this._keySchedule,c.SUB_MIX,c.SBOX,this._nRounds)},d.prototype.encryptBlock=function(h){var f=this.encryptBlockRaw(h),m=s.allocUnsafe(16);return m.writeUInt32BE(f[0],0),m.writeUInt32BE(f[1],4),m.writeUInt32BE(f[2],8),m.writeUInt32BE(f[3],12),m},d.prototype.decryptBlock=function(h){var f=(h=o(h))[1];h[1]=h[3],h[3]=f;var m=l(h,this._invKeySchedule,c.INV_SUB_MIX,c.INV_SBOX,this._nRounds),p=s.allocUnsafe(16);return p.writeUInt32BE(m[0],0),p.writeUInt32BE(m[3],4),p.writeUInt32BE(m[2],8),p.writeUInt32BE(m[1],12),p},d.prototype.scrub=function(){a(this._keySchedule),a(this._invKeySchedule),a(this._key)},n.exports.AES=d},{"safe-buffer":494}],190:[function(t,n,i){var s=t("./aes"),o=t("safe-buffer").Buffer,a=t("cipher-base"),l=t("inherits"),u=t("./ghash"),c=t("buffer-xor"),d=t("./incr32");function h(f,m,p,g){a.call(this);var v=o.alloc(4,0);this._cipher=new s.AES(m);var y=this._cipher.encryptBlock(v);this._ghash=new u(y),p=(function(b,E,A){if(E.length===12)return b._finID=o.concat([E,o.from([0,0,0,1])]),o.concat([E,o.from([0,0,0,2])]);var M=new u(A),L=E.length,k=L%16;M.update(E),k&&(k=16-k,M.update(o.alloc(k,0))),M.update(o.alloc(8,0));var P=8*L,U=o.alloc(8);U.writeUIntBE(P,0,8),M.update(U),b._finID=M.state;var $=o.from(b._finID);return d($),$})(this,p,y),this._prev=o.from(p),this._cache=o.allocUnsafe(0),this._secCache=o.allocUnsafe(0),this._decrypt=g,this._alen=0,this._len=0,this._mode=f,this._authTag=null,this._called=!1}l(h,a),h.prototype._update=function(f){if(!this._called&&this._alen){var m=16-this._alen%16;m<16&&(m=o.alloc(m,0),this._ghash.update(m))}this._called=!0;var p=this._mode.encrypt(this,f);return this._decrypt?this._ghash.update(f):this._ghash.update(p),this._len+=f.length,p},h.prototype._final=function(){if(this._decrypt&&!this._authTag)throw new Error("Unsupported state or unable to authenticate data");var f=c(this._ghash.final(8*this._alen,8*this._len),this._cipher.encryptBlock(this._finID));if(this._decrypt&&(function(m,p){var g=0;m.length!==p.length&&g++;for(var v=Math.min(m.length,p.length),y=0;y<v;++y)g+=m[y]^p[y];return g})(f,this._authTag))throw new Error("Unsupported state or unable to authenticate data");this._authTag=f,this._cipher.scrub()},h.prototype.getAuthTag=function(){if(this._decrypt||!o.isBuffer(this._authTag))throw new Error("Attempting to get auth tag in unsupported state");return this._authTag},h.prototype.setAuthTag=function(f){if(!this._decrypt)throw new Error("Attempting to set auth tag in unsupported state");this._authTag=f},h.prototype.setAAD=function(f){if(this._called)throw new Error("Attempting to set AAD in unsupported state");this._ghash.update(f),this._alen+=f.length},n.exports=h},{"./aes":189,"./ghash":194,"./incr32":195,"buffer-xor":219,"cipher-base":221,inherits:440,"safe-buffer":494}],191:[function(t,n,i){var s=t("./encrypter"),o=t("./decrypter"),a=t("./modes/list.json");i.createCipher=i.Cipher=s.createCipher,i.createCipheriv=i.Cipheriv=s.createCipheriv,i.createDecipher=i.Decipher=o.createDecipher,i.createDecipheriv=i.Decipheriv=o.createDecipheriv,i.listCiphers=i.getCiphers=function(){return Object.keys(a)}},{"./decrypter":192,"./encrypter":193,"./modes/list.json":203}],192:[function(t,n,i){var s=t("./authCipher"),o=t("safe-buffer").Buffer,a=t("./modes"),l=t("./streamCipher"),u=t("cipher-base"),c=t("./aes"),d=t("evp_bytestokey");function h(p,g,v){u.call(this),this._cache=new f,this._last=void 0,this._cipher=new c.AES(g),this._prev=o.from(v),this._mode=p,this._autopadding=!0}function f(){this.cache=o.allocUnsafe(0)}function m(p,g,v){var y=a[p.toLowerCase()];if(!y)throw new TypeError("invalid suite type");if(typeof v=="string"&&(v=o.from(v)),y.mode!=="GCM"&&v.length!==y.iv)throw new TypeError("invalid iv length "+v.length);if(typeof g=="string"&&(g=o.from(g)),g.length!==y.key/8)throw new TypeError("invalid key length "+g.length);return y.type==="stream"?new l(y.module,g,v,!0):y.type==="auth"?new s(y.module,g,v,!0):new h(y.module,g,v)}t("inherits")(h,u),h.prototype._update=function(p){var g,v;this._cache.add(p);for(var y=[];g=this._cache.get(this._autopadding);)v=this._mode.decrypt(this,g),y.push(v);return o.concat(y)},h.prototype._final=function(){var p=this._cache.flush();if(this._autopadding)return(function(g){var v=g[15];if(v<1||v>16)throw new Error("unable to decrypt data");for(var y=-1;++y<v;)if(g[y+(16-v)]!==v)throw new Error("unable to decrypt data");if(v!==16)return g.slice(0,16-v)})(this._mode.decrypt(this,p));if(p)throw new Error("data not multiple of block length")},h.prototype.setAutoPadding=function(p){return this._autopadding=!!p,this},f.prototype.add=function(p){this.cache=o.concat([this.cache,p])},f.prototype.get=function(p){var g;if(p){if(this.cache.length>16)return g=this.cache.slice(0,16),this.cache=this.cache.slice(16),g}else if(this.cache.length>=16)return g=this.cache.slice(0,16),this.cache=this.cache.slice(16),g;return null},f.prototype.flush=function(){if(this.cache.length)return this.cache},i.createDecipher=function(p,g){var v=a[p.toLowerCase()];if(!v)throw new TypeError("invalid suite type");var y=d(g,!1,v.key,v.iv);return m(p,y.key,y.iv)},i.createDecipheriv=m},{"./aes":189,"./authCipher":190,"./modes":202,"./streamCipher":205,"cipher-base":221,evp_bytestokey:423,inherits:440,"safe-buffer":494}],193:[function(t,n,i){var s=t("./modes"),o=t("./authCipher"),a=t("safe-buffer").Buffer,l=t("./streamCipher"),u=t("cipher-base"),c=t("./aes"),d=t("evp_bytestokey");function h(g,v,y){u.call(this),this._cache=new m,this._cipher=new c.AES(v),this._prev=a.from(y),this._mode=g,this._autopadding=!0}t("inherits")(h,u),h.prototype._update=function(g){var v,y;this._cache.add(g);for(var b=[];v=this._cache.get();)y=this._mode.encrypt(this,v),b.push(y);return a.concat(b)};var f=a.alloc(16,16);function m(){this.cache=a.allocUnsafe(0)}function p(g,v,y){var b=s[g.toLowerCase()];if(!b)throw new TypeError("invalid suite type");if(typeof v=="string"&&(v=a.from(v)),v.length!==b.key/8)throw new TypeError("invalid key length "+v.length);if(typeof y=="string"&&(y=a.from(y)),b.mode!=="GCM"&&y.length!==b.iv)throw new TypeError("invalid iv length "+y.length);return b.type==="stream"?new l(b.module,v,y):b.type==="auth"?new o(b.module,v,y):new h(b.module,v,y)}h.prototype._final=function(){var g=this._cache.flush();if(this._autopadding)return g=this._mode.encrypt(this,g),this._cipher.scrub(),g;if(!g.equals(f))throw this._cipher.scrub(),new Error("data not multiple of block length")},h.prototype.setAutoPadding=function(g){return this._autopadding=!!g,this},m.prototype.add=function(g){this.cache=a.concat([this.cache,g])},m.prototype.get=function(){if(this.cache.length>15){var g=this.cache.slice(0,16);return this.cache=this.cache.slice(16),g}return null},m.prototype.flush=function(){for(var g=16-this.cache.length,v=a.allocUnsafe(g),y=-1;++y<g;)v.writeUInt8(g,y);return a.concat([this.cache,v])},i.createCipheriv=p,i.createCipher=function(g,v){var y=s[g.toLowerCase()];if(!y)throw new TypeError("invalid suite type");var b=d(v,!1,y.key,y.iv);return p(g,b.key,b.iv)}},{"./aes":189,"./authCipher":190,"./modes":202,"./streamCipher":205,"cipher-base":221,evp_bytestokey:423,inherits:440,"safe-buffer":494}],194:[function(t,n,i){var s=t("safe-buffer").Buffer,o=s.alloc(16,0);function a(u){var c=s.allocUnsafe(16);return c.writeUInt32BE(u[0]>>>0,0),c.writeUInt32BE(u[1]>>>0,4),c.writeUInt32BE(u[2]>>>0,8),c.writeUInt32BE(u[3]>>>0,12),c}function l(u){this.h=u,this.state=s.alloc(16,0),this.cache=s.allocUnsafe(0)}l.prototype.ghash=function(u){for(var c=-1;++c<u.length;)this.state[c]^=u[c];this._multiply()},l.prototype._multiply=function(){for(var u,c,d,h=[(u=this.h).readUInt32BE(0),u.readUInt32BE(4),u.readUInt32BE(8),u.readUInt32BE(12)],f=[0,0,0,0],m=-1;++m<128;){for((this.state[~~(m/8)]&1<<7-m%8)!=0&&(f[0]^=h[0],f[1]^=h[1],f[2]^=h[2],f[3]^=h[3]),d=(1&h[3])!=0,c=3;c>0;c--)h[c]=h[c]>>>1|(1&h[c-1])<<31;h[0]=h[0]>>>1,d&&(h[0]=h[0]^225<<24)}this.state=a(f)},l.prototype.update=function(u){var c;for(this.cache=s.concat([this.cache,u]);this.cache.length>=16;)c=this.cache.slice(0,16),this.cache=this.cache.slice(16),this.ghash(c)},l.prototype.final=function(u,c){return this.cache.length&&this.ghash(s.concat([this.cache,o],16)),this.ghash(a([0,u,0,c])),this.state},n.exports=l},{"safe-buffer":494}],195:[function(t,n,i){n.exports=function(s){for(var o,a=s.length;a--;){if((o=s.readUInt8(a))!==255){o++,s.writeUInt8(o,a);break}s.writeUInt8(0,a)}}},{}],196:[function(t,n,i){var s=t("buffer-xor");i.encrypt=function(o,a){var l=s(a,o._prev);return o._prev=o._cipher.encryptBlock(l),o._prev},i.decrypt=function(o,a){var l=o._prev;o._prev=a;var u=o._cipher.decryptBlock(a);return s(u,l)}},{"buffer-xor":219}],197:[function(t,n,i){var s=t("safe-buffer").Buffer,o=t("buffer-xor");function a(l,u,c){var d=u.length,h=o(u,l._cache);return l._cache=l._cache.slice(d),l._prev=s.concat([l._prev,c?u:h]),h}i.encrypt=function(l,u,c){for(var d,h=s.allocUnsafe(0);u.length;){if(l._cache.length===0&&(l._cache=l._cipher.encryptBlock(l._prev),l._prev=s.allocUnsafe(0)),!(l._cache.length<=u.length)){h=s.concat([h,a(l,u,c)]);break}d=l._cache.length,h=s.concat([h,a(l,u.slice(0,d),c)]),u=u.slice(d)}return h}},{"buffer-xor":219,"safe-buffer":494}],198:[function(t,n,i){var s=t("safe-buffer").Buffer;function o(l,u,c){for(var d,h,f=-1,m=0;++f<8;)d=u&1<<7-f?128:0,m+=(128&(h=l._cipher.encryptBlock(l._prev)[0]^d))>>f%8,l._prev=a(l._prev,c?d:h);return m}function a(l,u){var c=l.length,d=-1,h=s.allocUnsafe(l.length);for(l=s.concat([l,s.from([u])]);++d<c;)h[d]=l[d]<<1|l[d+1]>>7;return h}i.encrypt=function(l,u,c){for(var d=u.length,h=s.allocUnsafe(d),f=-1;++f<d;)h[f]=o(l,u[f],c);return h}},{"safe-buffer":494}],199:[function(t,n,i){var s=t("safe-buffer").Buffer;function o(a,l,u){var c=a._cipher.encryptBlock(a._prev)[0]^l;return a._prev=s.concat([a._prev.slice(1),s.from([u?l:c])]),c}i.encrypt=function(a,l,u){for(var c=l.length,d=s.allocUnsafe(c),h=-1;++h<c;)d[h]=o(a,l[h],u);return d}},{"safe-buffer":494}],200:[function(t,n,i){var s=t("buffer-xor"),o=t("safe-buffer").Buffer,a=t("../incr32");function l(u){var c=u._cipher.encryptBlockRaw(u._prev);return a(u._prev),c}i.encrypt=function(u,c){var d=Math.ceil(c.length/16),h=u._cache.length;u._cache=o.concat([u._cache,o.allocUnsafe(16*d)]);for(var f=0;f<d;f++){var m=l(u),p=h+16*f;u._cache.writeUInt32BE(m[0],p+0),u._cache.writeUInt32BE(m[1],p+4),u._cache.writeUInt32BE(m[2],p+8),u._cache.writeUInt32BE(m[3],p+12)}var g=u._cache.slice(0,c.length);return u._cache=u._cache.slice(c.length),s(c,g)}},{"../incr32":195,"buffer-xor":219,"safe-buffer":494}],201:[function(t,n,i){i.encrypt=function(s,o){return s._cipher.encryptBlock(o)},i.decrypt=function(s,o){return s._cipher.decryptBlock(o)}},{}],202:[function(t,n,i){var s={ECB:t("./ecb"),CBC:t("./cbc"),CFB:t("./cfb"),CFB8:t("./cfb8"),CFB1:t("./cfb1"),OFB:t("./ofb"),CTR:t("./ctr"),GCM:t("./ctr")},o=t("./list.json");for(var a in o)o[a].module=s[o[a].mode];n.exports=o},{"./cbc":196,"./cfb":197,"./cfb1":198,"./cfb8":199,"./ctr":200,"./ecb":201,"./list.json":203,"./ofb":204}],203:[function(t,n,i){n.exports={"aes-128-ecb":{cipher:"AES",key:128,iv:0,mode:"ECB",type:"block"},"aes-192-ecb":{cipher:"AES",key:192,iv:0,mode:"ECB",type:"block"},"aes-256-ecb":{cipher:"AES",key:256,iv:0,mode:"ECB",type:"block"},"aes-128-cbc":{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},"aes-192-cbc":{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},"aes-256-cbc":{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},aes128:{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},aes192:{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},aes256:{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},"aes-128-cfb":{cipher:"AES",key:128,iv:16,mode:"CFB",type:"stream"},"aes-192-cfb":{cipher:"AES",key:192,iv:16,mode:"CFB",type:"stream"},"aes-256-cfb":{cipher:"AES",key:256,iv:16,mode:"CFB",type:"stream"},"aes-128-cfb8":{cipher:"AES",key:128,iv:16,mode:"CFB8",type:"stream"},"aes-192-cfb8":{cipher:"AES",key:192,iv:16,mode:"CFB8",type:"stream"},"aes-256-cfb8":{cipher:"AES",key:256,iv:16,mode:"CFB8",type:"stream"},"aes-128-cfb1":{cipher:"AES",key:128,iv:16,mode:"CFB1",type:"stream"},"aes-192-cfb1":{cipher:"AES",key:192,iv:16,mode:"CFB1",type:"stream"},"aes-256-cfb1":{cipher:"AES",key:256,iv:16,mode:"CFB1",type:"stream"},"aes-128-ofb":{cipher:"AES",key:128,iv:16,mode:"OFB",type:"stream"},"aes-192-ofb":{cipher:"AES",key:192,iv:16,mode:"OFB",type:"stream"},"aes-256-ofb":{cipher:"AES",key:256,iv:16,mode:"OFB",type:"stream"},"aes-128-ctr":{cipher:"AES",key:128,iv:16,mode:"CTR",type:"stream"},"aes-192-ctr":{cipher:"AES",key:192,iv:16,mode:"CTR",type:"stream"},"aes-256-ctr":{cipher:"AES",key:256,iv:16,mode:"CTR",type:"stream"},"aes-128-gcm":{cipher:"AES",key:128,iv:12,mode:"GCM",type:"auth"},"aes-192-gcm":{cipher:"AES",key:192,iv:12,mode:"GCM",type:"auth"},"aes-256-gcm":{cipher:"AES",key:256,iv:12,mode:"GCM",type:"auth"}}},{}],204:[function(t,n,i){(function(s){(function(){var o=t("buffer-xor");function a(l){return l._prev=l._cipher.encryptBlock(l._prev),l._prev}i.encrypt=function(l,u){for(;l._cache.length<u.length;)l._cache=s.concat([l._cache,a(l)]);var c=l._cache.slice(0,u.length);return l._cache=l._cache.slice(u.length),o(u,c)}}).call(this)}).call(this,t("buffer").Buffer)},{buffer:220,"buffer-xor":219}],205:[function(t,n,i){var s=t("./aes"),o=t("safe-buffer").Buffer,a=t("cipher-base");function l(u,c,d,h){a.call(this),this._cipher=new s.AES(c),this._prev=o.from(d),this._cache=o.allocUnsafe(0),this._secCache=o.allocUnsafe(0),this._decrypt=h,this._mode=u}t("inherits")(l,a),l.prototype._update=function(u){return this._mode.encrypt(this,u,this._decrypt)},l.prototype._final=function(){this._cipher.scrub()},n.exports=l},{"./aes":189,"cipher-base":221,inherits:440,"safe-buffer":494}],206:[function(t,n,i){var s=t("browserify-des"),o=t("browserify-aes/browser"),a=t("browserify-aes/modes"),l=t("browserify-des/modes"),u=t("evp_bytestokey");function c(h,f,m){if(h=h.toLowerCase(),a[h])return o.createCipheriv(h,f,m);if(l[h])return new s({key:f,iv:m,mode:h});throw new TypeError("invalid suite type")}function d(h,f,m){if(h=h.toLowerCase(),a[h])return o.createDecipheriv(h,f,m);if(l[h])return new s({key:f,iv:m,mode:h,decrypt:!0});throw new TypeError("invalid suite type")}i.createCipher=i.Cipher=function(h,f){var m,p;if(h=h.toLowerCase(),a[h])m=a[h].key,p=a[h].iv;else{if(!l[h])throw new TypeError("invalid suite type");m=8*l[h].key,p=l[h].iv}var g=u(f,!1,m,p);return c(h,g.key,g.iv)},i.createCipheriv=i.Cipheriv=c,i.createDecipher=i.Decipher=function(h,f){var m,p;if(h=h.toLowerCase(),a[h])m=a[h].key,p=a[h].iv;else{if(!l[h])throw new TypeError("invalid suite type");m=8*l[h].key,p=l[h].iv}var g=u(f,!1,m,p);return d(h,g.key,g.iv)},i.createDecipheriv=i.Decipheriv=d,i.listCiphers=i.getCiphers=function(){return Object.keys(l).concat(o.getCiphers())}},{"browserify-aes/browser":191,"browserify-aes/modes":202,"browserify-des":207,"browserify-des/modes":208,evp_bytestokey:423}],207:[function(t,n,i){var s=t("cipher-base"),o=t("des.js"),a=t("inherits"),l=t("safe-buffer").Buffer,u={"des-ede3-cbc":o.CBC.instantiate(o.EDE),"des-ede3":o.EDE,"des-ede-cbc":o.CBC.instantiate(o.EDE),"des-ede":o.EDE,"des-cbc":o.CBC.instantiate(o.DES),"des-ecb":o.DES};function c(d){s.call(this);var h,f=d.mode.toLowerCase(),m=u[f];h=d.decrypt?"decrypt":"encrypt";var p=d.key;l.isBuffer(p)||(p=l.from(p)),f!=="des-ede"&&f!=="des-ede-cbc"||(p=l.concat([p,p.slice(0,8)]));var g=d.iv;l.isBuffer(g)||(g=l.from(g)),this._des=m.create({key:p,iv:g,type:h})}u.des=u["des-cbc"],u.des3=u["des-ede3-cbc"],n.exports=c,a(c,s),c.prototype._update=function(d){return l.from(this._des.update(d))},c.prototype._final=function(){return l.from(this._des.final())}},{"cipher-base":221,"des.js":394,inherits:440,"safe-buffer":494}],208:[function(t,n,i){i["des-ecb"]={key:8,iv:0},i["des-cbc"]=i.des={key:8,iv:8},i["des-ede3-cbc"]=i.des3={key:24,iv:8},i["des-ede3"]={key:24,iv:0},i["des-ede-cbc"]={key:16,iv:8},i["des-ede"]={key:16,iv:0}},{}],209:[function(t,n,i){(function(s){(function(){var o=t("bn.js"),a=t("randombytes");function l(c){var d,h=c.modulus.byteLength();do d=new o(a(h));while(d.cmp(c.modulus)>=0||!d.umod(c.prime1)||!d.umod(c.prime2));return d}function u(c,d){var h=(function(L){var k=l(L);return{blinder:k.toRed(o.mont(L.modulus)).redPow(new o(L.publicExponent)).fromRed(),unblinder:k.invm(L.modulus)}})(d),f=d.modulus.byteLength(),m=new o(c).mul(h.blinder).umod(d.modulus),p=m.toRed(o.mont(d.prime1)),g=m.toRed(o.mont(d.prime2)),v=d.coefficient,y=d.prime1,b=d.prime2,E=p.redPow(d.exponent1).fromRed(),A=g.redPow(d.exponent2).fromRed(),M=E.isub(A).imul(v).umod(y).imul(b);return A.iadd(M).imul(h.unblinder).umod(d.modulus).toArrayLike(s,"be",f)}u.getr=l,n.exports=u}).call(this)}).call(this,t("buffer").Buffer)},{"bn.js":186,buffer:220,randombytes:475}],210:[function(t,n,i){n.exports=t("./browser/algorithms.json")},{"./browser/algorithms.json":211}],211:[function(t,n,i){n.exports={sha224WithRSAEncryption:{sign:"rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},"RSA-SHA224":{sign:"ecdsa/rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},sha256WithRSAEncryption:{sign:"rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},"RSA-SHA256":{sign:"ecdsa/rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},sha384WithRSAEncryption:{sign:"rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},"RSA-SHA384":{sign:"ecdsa/rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},sha512WithRSAEncryption:{sign:"rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA512":{sign:"ecdsa/rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA1":{sign:"rsa",hash:"sha1",id:"3021300906052b0e03021a05000414"},"ecdsa-with-SHA1":{sign:"ecdsa",hash:"sha1",id:""},sha256:{sign:"ecdsa",hash:"sha256",id:""},sha224:{sign:"ecdsa",hash:"sha224",id:""},sha384:{sign:"ecdsa",hash:"sha384",id:""},sha512:{sign:"ecdsa",hash:"sha512",id:""},"DSA-SHA":{sign:"dsa",hash:"sha1",id:""},"DSA-SHA1":{sign:"dsa",hash:"sha1",id:""},DSA:{sign:"dsa",hash:"sha1",id:""},"DSA-WITH-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-WITH-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-WITH-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-WITH-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-RIPEMD160":{sign:"dsa",hash:"rmd160",id:""},ripemd160WithRSA:{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},"RSA-RIPEMD160":{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},md5WithRSAEncryption:{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"},"RSA-MD5":{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"}}},{}],212:[function(t,n,i){n.exports={"1.3.132.0.10":"secp256k1","1.3.132.0.33":"p224","1.2.840.10045.3.1.1":"p192","1.2.840.10045.3.1.7":"p256","1.3.132.0.34":"p384","1.3.132.0.35":"p521"}},{}],213:[function(t,n,i){var s=t("safe-buffer").Buffer,o=t("create-hash"),a=t("readable-stream"),l=t("inherits"),u=t("./sign"),c=t("./verify"),d=t("./algorithms.json");function h(g){a.Writable.call(this);var v=d[g];if(!v)throw new Error("Unknown message digest");this._hashType=v.hash,this._hash=o(v.hash),this._tag=v.id,this._signType=v.sign}function f(g){a.Writable.call(this);var v=d[g];if(!v)throw new Error("Unknown message digest");this._hash=o(v.hash),this._tag=v.id,this._signType=v.sign}function m(g){return new h(g)}function p(g){return new f(g)}Object.keys(d).forEach((function(g){d[g].id=s.from(d[g].id,"hex"),d[g.toLowerCase()]=d[g]})),l(h,a.Writable),h.prototype._write=function(g,v,y){this._hash.update(g),y()},h.prototype.update=function(g,v){return typeof g=="string"&&(g=s.from(g,v)),this._hash.update(g),this},h.prototype.sign=function(g,v){this.end();var y=this._hash.digest(),b=u(y,g,this._hashType,this._signType,this._tag);return v?b.toString(v):b},l(f,a.Writable),f.prototype._write=function(g,v,y){this._hash.update(g),y()},f.prototype.update=function(g,v){return typeof g=="string"&&(g=s.from(g,v)),this._hash.update(g),this},f.prototype.verify=function(g,v,y){typeof v=="string"&&(v=s.from(v,y)),this.end();var b=this._hash.digest();return c(v,b,g,this._signType,this._tag)},n.exports={Sign:m,Verify:p,createSign:m,createVerify:p}},{"./algorithms.json":211,"./sign":214,"./verify":215,"create-hash":386,inherits:440,"readable-stream":491,"safe-buffer":494}],214:[function(t,n,i){var s=t("safe-buffer").Buffer,o=t("create-hmac"),a=t("browserify-rsa"),l=t("elliptic").ec,u=t("bn.js"),c=t("parse-asn1"),d=t("./curves.json");function h(g,v,y,b){if((g=s.from(g.toArray())).length<v.byteLength()){var E=s.alloc(v.byteLength()-g.length);g=s.concat([E,g])}var A=y.length,M=(function(P,U){P=(P=f(P,U)).mod(U);var $=s.from(P.toArray());if($.length<U.byteLength()){var V=s.alloc(U.byteLength()-$.length);$=s.concat([V,$])}return $})(y,v),L=s.alloc(A);L.fill(1);var k=s.alloc(A);return k=o(b,k).update(L).update(s.from([0])).update(g).update(M).digest(),L=o(b,k).update(L).digest(),{k:k=o(b,k).update(L).update(s.from([1])).update(g).update(M).digest(),v:L=o(b,k).update(L).digest()}}function f(g,v){var y=new u(g),b=(g.length<<3)-v.bitLength();return b>0&&y.ishrn(b),y}function m(g,v,y){var b,E;do{for(b=s.alloc(0);8*b.length<g.bitLength();)v.v=o(y,v.k).update(v.v).digest(),b=s.concat([b,v.v]);E=f(b,g),v.k=o(y,v.k).update(v.v).update(s.from([0])).digest(),v.v=o(y,v.k).update(v.v).digest()}while(E.cmp(g)!==-1);return E}function p(g,v,y,b){return g.toRed(u.mont(y)).redPow(v).fromRed().mod(b)}n.exports=function(g,v,y,b,E){var A=c(v);if(A.curve){if(b!=="ecdsa"&&b!=="ecdsa/rsa")throw new Error("wrong private key type");return(function(P,U){var $=d[U.curve.join(".")];if(!$)throw new Error("unknown curve "+U.curve.join("."));var V=new l($).keyFromPrivate(U.privateKey).sign(P);return s.from(V.toDER())})(g,A)}if(A.type==="dsa"){if(b!=="dsa")throw new Error("wrong private key type");return(function(P,U,$){for(var V,R=U.params.priv_key,O=U.params.p,T=U.params.q,w=U.params.g,x=new u(0),_=f(P,T).mod(T),S=!1,C=h(R,T,P,$);S===!1;)V=m(T,C,$),x=p(w,V,O,T),(S=V.invm(T).imul(_.add(R.mul(x))).mod(T)).cmpn(0)===0&&(S=!1,x=new u(0));return(function(F,D){F=F.toArray(),D=D.toArray(),128&F[0]&&(F=[0].concat(F)),128&D[0]&&(D=[0].concat(D));var H=[48,F.length+D.length+4,2,F.length];return H=H.concat(F,[2,D.length],D),s.from(H)})(x,S)})(g,A,y)}if(b!=="rsa"&&b!=="ecdsa/rsa")throw new Error("wrong private key type");g=s.concat([E,g]);for(var M=A.modulus.byteLength(),L=[0,1];g.length+L.length+1<M;)L.push(255);L.push(0);for(var k=-1;++k<g.length;)L.push(g[k]);return a(L,A)},n.exports.getKey=h,n.exports.makeKey=m},{"./curves.json":212,"bn.js":186,"browserify-rsa":209,"create-hmac":388,elliptic:405,"parse-asn1":459,"safe-buffer":494}],215:[function(t,n,i){var s=t("safe-buffer").Buffer,o=t("bn.js"),a=t("elliptic").ec,l=t("parse-asn1"),u=t("./curves.json");function c(d,h){if(d.cmpn(0)<=0)throw new Error("invalid sig");if(d.cmp(h)>=h)throw new Error("invalid sig")}n.exports=function(d,h,f,m,p){var g=l(f);if(g.type==="ec"){if(m!=="ecdsa"&&m!=="ecdsa/rsa")throw new Error("wrong public key type");return(function(L,k,P){var U=u[P.data.algorithm.curve.join(".")];if(!U)throw new Error("unknown curve "+P.data.algorithm.curve.join("."));var $=new a(U),V=P.data.subjectPrivateKey.data;return $.verify(k,L,V)})(d,h,g)}if(g.type==="dsa"){if(m!=="dsa")throw new Error("wrong public key type");return(function(L,k,P){var U=P.data.p,$=P.data.q,V=P.data.g,R=P.data.pub_key,O=l.signature.decode(L,"der"),T=O.s,w=O.r;c(T,$),c(w,$);var x=o.mont(U),_=T.invm($);return V.toRed(x).redPow(new o(k).mul(_).mod($)).fromRed().mul(R.toRed(x).redPow(w.mul(_).mod($)).fromRed()).mod(U).mod($).cmp(w)===0})(d,h,g)}if(m!=="rsa"&&m!=="ecdsa/rsa")throw new Error("wrong public key type");h=s.concat([p,h]);for(var v=g.modulus.byteLength(),y=[1],b=0;h.length+y.length+2<v;)y.push(255),b++;y.push(0);for(var E=-1;++E<h.length;)y.push(h[E]);y=s.from(y);var A=o.mont(g.modulus);d=(d=new o(d).toRed(A)).redPow(new o(g.publicExponent)),d=s.from(d.fromRed().toArray());var M=b<8?1:0;for(v=Math.min(d.length,y.length),d.length!==y.length&&(M=1),E=-1;++E<v;)M|=d[E]^y[E];return M===0}},{"./curves.json":212,"bn.js":186,elliptic:405,"parse-asn1":459,"safe-buffer":494}],216:[function(t,n,i){},{}],217:[function(t,n,i){var s=t("buffer"),o=s.Buffer;function a(u,c){for(var d in u)c[d]=u[d]}function l(u,c,d){return o(u,c,d)}o.from&&o.alloc&&o.allocUnsafe&&o.allocUnsafeSlow?n.exports=s:(a(s,i),i.Buffer=l),a(o,l),l.from=function(u,c,d){if(typeof u=="number")throw new TypeError("Argument must not be a number");return o(u,c,d)},l.alloc=function(u,c,d){if(typeof u!="number")throw new TypeError("Argument must be a number");var h=o(u);return c!==void 0?typeof d=="string"?h.fill(c,d):h.fill(c):h.fill(0),h},l.allocUnsafe=function(u){if(typeof u!="number")throw new TypeError("Argument must be a number");return o(u)},l.allocUnsafeSlow=function(u){if(typeof u!="number")throw new TypeError("Argument must be a number");return s.SlowBuffer(u)}},{buffer:220}],218:[function(t,n,i){var s=t("safe-buffer").Buffer,o=s.isEncoding||function(g){switch((g=""+g)&&g.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function a(g){var v;switch(this.encoding=(function(y){var b=(function(E){if(!E)return"utf8";for(var A;;)switch(E){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return E;default:if(A)return;E=(""+E).toLowerCase(),A=!0}})(y);if(typeof b!="string"&&(s.isEncoding===o||!o(y)))throw new Error("Unknown encoding: "+y);return b||y})(g),this.encoding){case"utf16le":this.text=c,this.end=d,v=4;break;case"utf8":this.fillLast=u,v=4;break;case"base64":this.text=h,this.end=f,v=3;break;default:return this.write=m,void(this.end=p)}this.lastNeed=0,this.lastTotal=0,this.lastChar=s.allocUnsafe(v)}function l(g){return g<=127?0:g>>5==6?2:g>>4==14?3:g>>3==30?4:g>>6==2?-1:-2}function u(g){var v=this.lastTotal-this.lastNeed,y=(function(b,E,A){if((192&E[0])!=128)return b.lastNeed=0,"";if(b.lastNeed>1&&E.length>1){if((192&E[1])!=128)return b.lastNeed=1,"";if(b.lastNeed>2&&E.length>2&&(192&E[2])!=128)return b.lastNeed=2,""}})(this,g);return y!==void 0?y:this.lastNeed<=g.length?(g.copy(this.lastChar,v,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(g.copy(this.lastChar,v,0,g.length),void(this.lastNeed-=g.length))}function c(g,v){if((g.length-v)%2==0){var y=g.toString("utf16le",v);if(y){var b=y.charCodeAt(y.length-1);if(b>=55296&&b<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=g[g.length-2],this.lastChar[1]=g[g.length-1],y.slice(0,-1)}return y}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=g[g.length-1],g.toString("utf16le",v,g.length-1)}function d(g){var v=g&&g.length?this.write(g):"";if(this.lastNeed){var y=this.lastTotal-this.lastNeed;return v+this.lastChar.toString("utf16le",0,y)}return v}function h(g,v){var y=(g.length-v)%3;return y===0?g.toString("base64",v):(this.lastNeed=3-y,this.lastTotal=3,y===1?this.lastChar[0]=g[g.length-1]:(this.lastChar[0]=g[g.length-2],this.lastChar[1]=g[g.length-1]),g.toString("base64",v,g.length-y))}function f(g){var v=g&&g.length?this.write(g):"";return this.lastNeed?v+this.lastChar.toString("base64",0,3-this.lastNeed):v}function m(g){return g.toString(this.encoding)}function p(g){return g&&g.length?this.write(g):""}i.StringDecoder=a,a.prototype.write=function(g){if(g.length===0)return"";var v,y;if(this.lastNeed){if((v=this.fillLast(g))===void 0)return"";y=this.lastNeed,this.lastNeed=0}else y=0;return y<g.length?v?v+this.text(g,y):this.text(g,y):v||""},a.prototype.end=function(g){var v=g&&g.length?this.write(g):"";return this.lastNeed?v+"":v},a.prototype.text=function(g,v){var y=(function(E,A,M){var L=A.length-1;if(L<M)return 0;var k=l(A[L]);return k>=0?(k>0&&(E.lastNeed=k-1),k):--L<M||k===-2?0:(k=l(A[L]))>=0?(k>0&&(E.lastNeed=k-2),k):--L<M||k===-2?0:(k=l(A[L]))>=0?(k>0&&(k===2?k=0:E.lastNeed=k-3),k):0})(this,g,v);if(!this.lastNeed)return g.toString("utf8",v);this.lastTotal=y;var b=g.length-(y-this.lastNeed);return g.copy(this.lastChar,0,b),g.toString("utf8",v,b)},a.prototype.fillLast=function(g){if(this.lastNeed<=g.length)return g.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);g.copy(this.lastChar,this.lastTotal-this.lastNeed,0,g.length),this.lastNeed-=g.length}},{"safe-buffer":217}],219:[function(t,n,i){(function(s){(function(){n.exports=function(o,a){for(var l=Math.min(o.length,a.length),u=new s(l),c=0;c<l;++c)u[c]=o[c]^a[c];return u}}).call(this)}).call(this,t("buffer").Buffer)},{buffer:220}],220:[function(t,n,i){(function(s){(function(){var o=t("base64-js"),a=t("ieee754");i.Buffer=u,i.SlowBuffer=function(I){return+I!=I&&(I=0),u.alloc(+I)},i.INSPECT_MAX_BYTES=50;function l(I){if(I>2147483647)throw new RangeError('The value "'+I+'" is invalid for option "size"');var N=new Uint8Array(I);return N.__proto__=u.prototype,N}function u(I,N,j){if(typeof I=="number"){if(typeof N=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return h(I)}return c(I,N,j)}function c(I,N,j){if(typeof I=="string")return(function(Y,Z){if(typeof Z=="string"&&Z!==""||(Z="utf8"),!u.isEncoding(Z))throw new TypeError("Unknown encoding: "+Z);var se=0|p(Y,Z),re=l(se),K=re.write(Y,Z);return K!==se&&(re=re.slice(0,K)),re})(I,N);if(ArrayBuffer.isView(I))return f(I);if(I==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof I);if(B(I,ArrayBuffer)||I&&B(I.buffer,ArrayBuffer))return(function(Y,Z,se){if(Z<0||Y.byteLength<Z)throw new RangeError('"offset" is outside of buffer bounds');if(Y.byteLength<Z+(se||0))throw new RangeError('"length" is outside of buffer bounds');var re;return re=Z===void 0&&se===void 0?new Uint8Array(Y):se===void 0?new Uint8Array(Y,Z):new Uint8Array(Y,Z,se),re.__proto__=u.prototype,re})(I,N,j);if(typeof I=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var Q=I.valueOf&&I.valueOf();if(Q!=null&&Q!==I)return u.from(Q,N,j);var W=(function(Y){if(u.isBuffer(Y)){var Z=0|m(Y.length),se=l(Z);return se.length===0||Y.copy(se,0,0,Z),se}if(Y.length!==void 0)return typeof Y.length!="number"||X(Y.length)?l(0):f(Y);if(Y.type==="Buffer"&&Array.isArray(Y.data))return f(Y.data)})(I);if(W)return W;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof I[Symbol.toPrimitive]=="function")return u.from(I[Symbol.toPrimitive]("string"),N,j);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof I)}function d(I){if(typeof I!="number")throw new TypeError('"size" argument must be of type number');if(I<0)throw new RangeError('The value "'+I+'" is invalid for option "size"')}function h(I){return d(I),l(I<0?0:0|m(I))}function f(I){for(var N=I.length<0?0:0|m(I.length),j=l(N),Q=0;Q<N;Q+=1)j[Q]=255&I[Q];return j}function m(I){if(I>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|I}function p(I,N){if(u.isBuffer(I))return I.length;if(ArrayBuffer.isView(I)||B(I,ArrayBuffer))return I.byteLength;if(typeof I!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof I);var j=I.length,Q=arguments.length>2&&arguments[2]===!0;if(!Q&&j===0)return 0;for(var W=!1;;)switch(N){case"ascii":case"latin1":case"binary":return j;case"utf8":case"utf-8":return H(I).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*j;case"hex":return j>>>1;case"base64":return G(I).length;default:if(W)return Q?-1:H(I).length;N=(""+N).toLowerCase(),W=!0}}function g(I,N,j){var Q=!1;if((N===void 0||N<0)&&(N=0),N>this.length||((j===void 0||j>this.length)&&(j=this.length),j<=0)||(j>>>=0)<=(N>>>=0))return"";for(I||(I="utf8");;)switch(I){case"hex":return O(this,N,j);case"utf8":case"utf-8":return $(this,N,j);case"ascii":return V(this,N,j);case"latin1":case"binary":return R(this,N,j);case"base64":return U(this,N,j);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,N,j);default:if(Q)throw new TypeError("Unknown encoding: "+I);I=(I+"").toLowerCase(),Q=!0}}function v(I,N,j){var Q=I[N];I[N]=I[j],I[j]=Q}function y(I,N,j,Q,W){if(I.length===0)return-1;if(typeof j=="string"?(Q=j,j=0):j>2147483647?j=2147483647:j<-2147483648&&(j=-2147483648),X(j=+j)&&(j=W?0:I.length-1),j<0&&(j=I.length+j),j>=I.length){if(W)return-1;j=I.length-1}else if(j<0){if(!W)return-1;j=0}if(typeof N=="string"&&(N=u.from(N,Q)),u.isBuffer(N))return N.length===0?-1:b(I,N,j,Q,W);if(typeof N=="number")return N&=255,typeof Uint8Array.prototype.indexOf=="function"?W?Uint8Array.prototype.indexOf.call(I,N,j):Uint8Array.prototype.lastIndexOf.call(I,N,j):b(I,[N],j,Q,W);throw new TypeError("val must be string, number or Buffer")}function b(I,N,j,Q,W){var Y,Z=1,se=I.length,re=N.length;if(Q!==void 0&&((Q=String(Q).toLowerCase())==="ucs2"||Q==="ucs-2"||Q==="utf16le"||Q==="utf-16le")){if(I.length<2||N.length<2)return-1;Z=2,se/=2,re/=2,j/=2}function K(ae,fe){return Z===1?ae[fe]:ae.readUInt16BE(fe*Z)}if(W){var ie=-1;for(Y=j;Y<se;Y++)if(K(I,Y)===K(N,ie===-1?0:Y-ie)){if(ie===-1&&(ie=Y),Y-ie+1===re)return ie*Z}else ie!==-1&&(Y-=Y-ie),ie=-1}else for(j+re>se&&(j=se-re),Y=j;Y>=0;Y--){for(var ne=!0,le=0;le<re;le++)if(K(I,Y+le)!==K(N,le)){ne=!1;break}if(ne)return Y}return-1}function E(I,N,j,Q){j=Number(j)||0;var W=I.length-j;Q?(Q=Number(Q))>W&&(Q=W):Q=W;var Y=N.length;Q>Y/2&&(Q=Y/2);for(var Z=0;Z<Q;++Z){var se=parseInt(N.substr(2*Z,2),16);if(X(se))return Z;I[j+Z]=se}return Z}function A(I,N,j,Q){return ee(H(N,I.length-j),I,j,Q)}function M(I,N,j,Q){return ee((function(W){for(var Y=[],Z=0;Z<W.length;++Z)Y.push(255&W.charCodeAt(Z));return Y})(N),I,j,Q)}function L(I,N,j,Q){return M(I,N,j,Q)}function k(I,N,j,Q){return ee(G(N),I,j,Q)}function P(I,N,j,Q){return ee((function(W,Y){for(var Z,se,re,K=[],ie=0;ie<W.length&&!((Y-=2)<0);++ie)Z=W.charCodeAt(ie),se=Z>>8,re=Z%256,K.push(re),K.push(se);return K})(N,I.length-j),I,j,Q)}function U(I,N,j){return N===0&&j===I.length?o.fromByteArray(I):o.fromByteArray(I.slice(N,j))}function $(I,N,j){j=Math.min(I.length,j);for(var Q=[],W=N;W<j;){var Y,Z,se,re,K=I[W],ie=null,ne=K>239?4:K>223?3:K>191?2:1;if(W+ne<=j)switch(ne){case 1:K<128&&(ie=K);break;case 2:(192&(Y=I[W+1]))==128&&(re=(31&K)<<6|63&Y)>127&&(ie=re);break;case 3:Y=I[W+1],Z=I[W+2],(192&Y)==128&&(192&Z)==128&&(re=(15&K)<<12|(63&Y)<<6|63&Z)>2047&&(re<55296||re>57343)&&(ie=re);break;case 4:Y=I[W+1],Z=I[W+2],se=I[W+3],(192&Y)==128&&(192&Z)==128&&(192&se)==128&&(re=(15&K)<<18|(63&Y)<<12|(63&Z)<<6|63&se)>65535&&re<1114112&&(ie=re)}ie===null?(ie=65533,ne=1):ie>65535&&(ie-=65536,Q.push(ie>>>10&1023|55296),ie=56320|1023&ie),Q.push(ie),W+=ne}return(function(le){var ae=le.length;if(ae<=4096)return String.fromCharCode.apply(String,le);for(var fe="",pe=0;pe<ae;)fe+=String.fromCharCode.apply(String,le.slice(pe,pe+=4096));return fe})(Q)}i.kMaxLength=2147483647,u.TYPED_ARRAY_SUPPORT=(function(){try{var I=new Uint8Array(1);return I.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},I.foo()===42}catch{return!1}})(),u.TYPED_ARRAY_SUPPORT||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.byteOffset}}),typeof Symbol<"u"&&Symbol.species!=null&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),u.poolSize=8192,u.from=function(I,N,j){return c(I,N,j)},u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,u.alloc=function(I,N,j){return(function(Q,W,Y){return d(Q),Q<=0?l(Q):W!==void 0?typeof Y=="string"?l(Q).fill(W,Y):l(Q).fill(W):l(Q)})(I,N,j)},u.allocUnsafe=function(I){return h(I)},u.allocUnsafeSlow=function(I){return h(I)},u.isBuffer=function(I){return I!=null&&I._isBuffer===!0&&I!==u.prototype},u.compare=function(I,N){if(B(I,Uint8Array)&&(I=u.from(I,I.offset,I.byteLength)),B(N,Uint8Array)&&(N=u.from(N,N.offset,N.byteLength)),!u.isBuffer(I)||!u.isBuffer(N))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(I===N)return 0;for(var j=I.length,Q=N.length,W=0,Y=Math.min(j,Q);W<Y;++W)if(I[W]!==N[W]){j=I[W],Q=N[W];break}return j<Q?-1:Q<j?1:0},u.isEncoding=function(I){switch(String(I).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(I,N){if(!Array.isArray(I))throw new TypeError('"list" argument must be an Array of Buffers');if(I.length===0)return u.alloc(0);var j;if(N===void 0)for(N=0,j=0;j<I.length;++j)N+=I[j].length;var Q=u.allocUnsafe(N),W=0;for(j=0;j<I.length;++j){var Y=I[j];if(B(Y,Uint8Array)&&(Y=u.from(Y)),!u.isBuffer(Y))throw new TypeError('"list" argument must be an Array of Buffers');Y.copy(Q,W),W+=Y.length}return Q},u.byteLength=p,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var I=this.length;if(I%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var N=0;N<I;N+=2)v(this,N,N+1);return this},u.prototype.swap32=function(){var I=this.length;if(I%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var N=0;N<I;N+=4)v(this,N,N+3),v(this,N+1,N+2);return this},u.prototype.swap64=function(){var I=this.length;if(I%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var N=0;N<I;N+=8)v(this,N,N+7),v(this,N+1,N+6),v(this,N+2,N+5),v(this,N+3,N+4);return this},u.prototype.toString=function(){var I=this.length;return I===0?"":arguments.length===0?$(this,0,I):g.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(I){if(!u.isBuffer(I))throw new TypeError("Argument must be a Buffer");return this===I||u.compare(this,I)===0},u.prototype.inspect=function(){var I="",N=i.INSPECT_MAX_BYTES;return I=this.toString("hex",0,N).replace(/(.{2})/g,"$1 ").trim(),this.length>N&&(I+=" ... "),"<Buffer "+I+">"},u.prototype.compare=function(I,N,j,Q,W){if(B(I,Uint8Array)&&(I=u.from(I,I.offset,I.byteLength)),!u.isBuffer(I))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof I);if(N===void 0&&(N=0),j===void 0&&(j=I?I.length:0),Q===void 0&&(Q=0),W===void 0&&(W=this.length),N<0||j>I.length||Q<0||W>this.length)throw new RangeError("out of range index");if(Q>=W&&N>=j)return 0;if(Q>=W)return-1;if(N>=j)return 1;if(this===I)return 0;for(var Y=(W>>>=0)-(Q>>>=0),Z=(j>>>=0)-(N>>>=0),se=Math.min(Y,Z),re=this.slice(Q,W),K=I.slice(N,j),ie=0;ie<se;++ie)if(re[ie]!==K[ie]){Y=re[ie],Z=K[ie];break}return Y<Z?-1:Z<Y?1:0},u.prototype.includes=function(I,N,j){return this.indexOf(I,N,j)!==-1},u.prototype.indexOf=function(I,N,j){return y(this,I,N,j,!0)},u.prototype.lastIndexOf=function(I,N,j){return y(this,I,N,j,!1)},u.prototype.write=function(I,N,j,Q){if(N===void 0)Q="utf8",j=this.length,N=0;else if(j===void 0&&typeof N=="string")Q=N,j=this.length,N=0;else{if(!isFinite(N))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");N>>>=0,isFinite(j)?(j>>>=0,Q===void 0&&(Q="utf8")):(Q=j,j=void 0)}var W=this.length-N;if((j===void 0||j>W)&&(j=W),I.length>0&&(j<0||N<0)||N>this.length)throw new RangeError("Attempt to write outside buffer bounds");Q||(Q="utf8");for(var Y=!1;;)switch(Q){case"hex":return E(this,I,N,j);case"utf8":case"utf-8":return A(this,I,N,j);case"ascii":return M(this,I,N,j);case"latin1":case"binary":return L(this,I,N,j);case"base64":return k(this,I,N,j);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,I,N,j);default:if(Y)throw new TypeError("Unknown encoding: "+Q);Q=(""+Q).toLowerCase(),Y=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function V(I,N,j){var Q="";j=Math.min(I.length,j);for(var W=N;W<j;++W)Q+=String.fromCharCode(127&I[W]);return Q}function R(I,N,j){var Q="";j=Math.min(I.length,j);for(var W=N;W<j;++W)Q+=String.fromCharCode(I[W]);return Q}function O(I,N,j){var Q=I.length;(!N||N<0)&&(N=0),(!j||j<0||j>Q)&&(j=Q);for(var W="",Y=N;Y<j;++Y)W+=D(I[Y]);return W}function T(I,N,j){for(var Q=I.slice(N,j),W="",Y=0;Y<Q.length;Y+=2)W+=String.fromCharCode(Q[Y]+256*Q[Y+1]);return W}function w(I,N,j){if(I%1!=0||I<0)throw new RangeError("offset is not uint");if(I+N>j)throw new RangeError("Trying to access beyond buffer length")}function x(I,N,j,Q,W,Y){if(!u.isBuffer(I))throw new TypeError('"buffer" argument must be a Buffer instance');if(N>W||N<Y)throw new RangeError('"value" argument is out of bounds');if(j+Q>I.length)throw new RangeError("Index out of range")}function _(I,N,j,Q,W,Y){if(j+Q>I.length)throw new RangeError("Index out of range");if(j<0)throw new RangeError("Index out of range")}function S(I,N,j,Q,W){return N=+N,j>>>=0,W||_(I,0,j,4),a.write(I,N,j,Q,23,4),j+4}function C(I,N,j,Q,W){return N=+N,j>>>=0,W||_(I,0,j,8),a.write(I,N,j,Q,52,8),j+8}u.prototype.slice=function(I,N){var j=this.length;(I=~~I)<0?(I+=j)<0&&(I=0):I>j&&(I=j),(N=N===void 0?j:~~N)<0?(N+=j)<0&&(N=0):N>j&&(N=j),N<I&&(N=I);var Q=this.subarray(I,N);return Q.__proto__=u.prototype,Q},u.prototype.readUIntLE=function(I,N,j){I>>>=0,N>>>=0,j||w(I,N,this.length);for(var Q=this[I],W=1,Y=0;++Y<N&&(W*=256);)Q+=this[I+Y]*W;return Q},u.prototype.readUIntBE=function(I,N,j){I>>>=0,N>>>=0,j||w(I,N,this.length);for(var Q=this[I+--N],W=1;N>0&&(W*=256);)Q+=this[I+--N]*W;return Q},u.prototype.readUInt8=function(I,N){return I>>>=0,N||w(I,1,this.length),this[I]},u.prototype.readUInt16LE=function(I,N){return I>>>=0,N||w(I,2,this.length),this[I]|this[I+1]<<8},u.prototype.readUInt16BE=function(I,N){return I>>>=0,N||w(I,2,this.length),this[I]<<8|this[I+1]},u.prototype.readUInt32LE=function(I,N){return I>>>=0,N||w(I,4,this.length),(this[I]|this[I+1]<<8|this[I+2]<<16)+16777216*this[I+3]},u.prototype.readUInt32BE=function(I,N){return I>>>=0,N||w(I,4,this.length),16777216*this[I]+(this[I+1]<<16|this[I+2]<<8|this[I+3])},u.prototype.readIntLE=function(I,N,j){I>>>=0,N>>>=0,j||w(I,N,this.length);for(var Q=this[I],W=1,Y=0;++Y<N&&(W*=256);)Q+=this[I+Y]*W;return Q>=(W*=128)&&(Q-=Math.pow(2,8*N)),Q},u.prototype.readIntBE=function(I,N,j){I>>>=0,N>>>=0,j||w(I,N,this.length);for(var Q=N,W=1,Y=this[I+--Q];Q>0&&(W*=256);)Y+=this[I+--Q]*W;return Y>=(W*=128)&&(Y-=Math.pow(2,8*N)),Y},u.prototype.readInt8=function(I,N){return I>>>=0,N||w(I,1,this.length),128&this[I]?-1*(255-this[I]+1):this[I]},u.prototype.readInt16LE=function(I,N){I>>>=0,N||w(I,2,this.length);var j=this[I]|this[I+1]<<8;return 32768&j?4294901760|j:j},u.prototype.readInt16BE=function(I,N){I>>>=0,N||w(I,2,this.length);var j=this[I+1]|this[I]<<8;return 32768&j?4294901760|j:j},u.prototype.readInt32LE=function(I,N){return I>>>=0,N||w(I,4,this.length),this[I]|this[I+1]<<8|this[I+2]<<16|this[I+3]<<24},u.prototype.readInt32BE=function(I,N){return I>>>=0,N||w(I,4,this.length),this[I]<<24|this[I+1]<<16|this[I+2]<<8|this[I+3]},u.prototype.readFloatLE=function(I,N){return I>>>=0,N||w(I,4,this.length),a.read(this,I,!0,23,4)},u.prototype.readFloatBE=function(I,N){return I>>>=0,N||w(I,4,this.length),a.read(this,I,!1,23,4)},u.prototype.readDoubleLE=function(I,N){return I>>>=0,N||w(I,8,this.length),a.read(this,I,!0,52,8)},u.prototype.readDoubleBE=function(I,N){return I>>>=0,N||w(I,8,this.length),a.read(this,I,!1,52,8)},u.prototype.writeUIntLE=function(I,N,j,Q){I=+I,N>>>=0,j>>>=0,Q||x(this,I,N,j,Math.pow(2,8*j)-1,0);var W=1,Y=0;for(this[N]=255&I;++Y<j&&(W*=256);)this[N+Y]=I/W&255;return N+j},u.prototype.writeUIntBE=function(I,N,j,Q){I=+I,N>>>=0,j>>>=0,Q||x(this,I,N,j,Math.pow(2,8*j)-1,0);var W=j-1,Y=1;for(this[N+W]=255&I;--W>=0&&(Y*=256);)this[N+W]=I/Y&255;return N+j},u.prototype.writeUInt8=function(I,N,j){return I=+I,N>>>=0,j||x(this,I,N,1,255,0),this[N]=255&I,N+1},u.prototype.writeUInt16LE=function(I,N,j){return I=+I,N>>>=0,j||x(this,I,N,2,65535,0),this[N]=255&I,this[N+1]=I>>>8,N+2},u.prototype.writeUInt16BE=function(I,N,j){return I=+I,N>>>=0,j||x(this,I,N,2,65535,0),this[N]=I>>>8,this[N+1]=255&I,N+2},u.prototype.writeUInt32LE=function(I,N,j){return I=+I,N>>>=0,j||x(this,I,N,4,4294967295,0),this[N+3]=I>>>24,this[N+2]=I>>>16,this[N+1]=I>>>8,this[N]=255&I,N+4},u.prototype.writeUInt32BE=function(I,N,j){return I=+I,N>>>=0,j||x(this,I,N,4,4294967295,0),this[N]=I>>>24,this[N+1]=I>>>16,this[N+2]=I>>>8,this[N+3]=255&I,N+4},u.prototype.writeIntLE=function(I,N,j,Q){if(I=+I,N>>>=0,!Q){var W=Math.pow(2,8*j-1);x(this,I,N,j,W-1,-W)}var Y=0,Z=1,se=0;for(this[N]=255&I;++Y<j&&(Z*=256);)I<0&&se===0&&this[N+Y-1]!==0&&(se=1),this[N+Y]=(I/Z>>0)-se&255;return N+j},u.prototype.writeIntBE=function(I,N,j,Q){if(I=+I,N>>>=0,!Q){var W=Math.pow(2,8*j-1);x(this,I,N,j,W-1,-W)}var Y=j-1,Z=1,se=0;for(this[N+Y]=255&I;--Y>=0&&(Z*=256);)I<0&&se===0&&this[N+Y+1]!==0&&(se=1),this[N+Y]=(I/Z>>0)-se&255;return N+j},u.prototype.writeInt8=function(I,N,j){return I=+I,N>>>=0,j||x(this,I,N,1,127,-128),I<0&&(I=255+I+1),this[N]=255&I,N+1},u.prototype.writeInt16LE=function(I,N,j){return I=+I,N>>>=0,j||x(this,I,N,2,32767,-32768),this[N]=255&I,this[N+1]=I>>>8,N+2},u.prototype.writeInt16BE=function(I,N,j){return I=+I,N>>>=0,j||x(this,I,N,2,32767,-32768),this[N]=I>>>8,this[N+1]=255&I,N+2},u.prototype.writeInt32LE=function(I,N,j){return I=+I,N>>>=0,j||x(this,I,N,4,2147483647,-2147483648),this[N]=255&I,this[N+1]=I>>>8,this[N+2]=I>>>16,this[N+3]=I>>>24,N+4},u.prototype.writeInt32BE=function(I,N,j){return I=+I,N>>>=0,j||x(this,I,N,4,2147483647,-2147483648),I<0&&(I=4294967295+I+1),this[N]=I>>>24,this[N+1]=I>>>16,this[N+2]=I>>>8,this[N+3]=255&I,N+4},u.prototype.writeFloatLE=function(I,N,j){return S(this,I,N,!0,j)},u.prototype.writeFloatBE=function(I,N,j){return S(this,I,N,!1,j)},u.prototype.writeDoubleLE=function(I,N,j){return C(this,I,N,!0,j)},u.prototype.writeDoubleBE=function(I,N,j){return C(this,I,N,!1,j)},u.prototype.copy=function(I,N,j,Q){if(!u.isBuffer(I))throw new TypeError("argument should be a Buffer");if(j||(j=0),Q||Q===0||(Q=this.length),N>=I.length&&(N=I.length),N||(N=0),Q>0&&Q<j&&(Q=j),Q===j||I.length===0||this.length===0)return 0;if(N<0)throw new RangeError("targetStart out of bounds");if(j<0||j>=this.length)throw new RangeError("Index out of range");if(Q<0)throw new RangeError("sourceEnd out of bounds");Q>this.length&&(Q=this.length),I.length-N<Q-j&&(Q=I.length-N+j);var W=Q-j;if(this===I&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(N,j,Q);else if(this===I&&j<N&&N<Q)for(var Y=W-1;Y>=0;--Y)I[Y+N]=this[Y+j];else Uint8Array.prototype.set.call(I,this.subarray(j,Q),N);return W},u.prototype.fill=function(I,N,j,Q){if(typeof I=="string"){if(typeof N=="string"?(Q=N,N=0,j=this.length):typeof j=="string"&&(Q=j,j=this.length),Q!==void 0&&typeof Q!="string")throw new TypeError("encoding must be a string");if(typeof Q=="string"&&!u.isEncoding(Q))throw new TypeError("Unknown encoding: "+Q);if(I.length===1){var W=I.charCodeAt(0);(Q==="utf8"&&W<128||Q==="latin1")&&(I=W)}}else typeof I=="number"&&(I&=255);if(N<0||this.length<N||this.length<j)throw new RangeError("Out of range index");if(j<=N)return this;var Y;if(N>>>=0,j=j===void 0?this.length:j>>>0,I||(I=0),typeof I=="number")for(Y=N;Y<j;++Y)this[Y]=I;else{var Z=u.isBuffer(I)?I:u.from(I,Q),se=Z.length;if(se===0)throw new TypeError('The value "'+I+'" is invalid for argument "value"');for(Y=0;Y<j-N;++Y)this[Y+N]=Z[Y%se]}return this};var F=/[^+/0-9A-Za-z-_]/g;function D(I){return I<16?"0"+I.toString(16):I.toString(16)}function H(I,N){var j;N=N||1/0;for(var Q=I.length,W=null,Y=[],Z=0;Z<Q;++Z){if((j=I.charCodeAt(Z))>55295&&j<57344){if(!W){if(j>56319){(N-=3)>-1&&Y.push(239,191,189);continue}if(Z+1===Q){(N-=3)>-1&&Y.push(239,191,189);continue}W=j;continue}if(j<56320){(N-=3)>-1&&Y.push(239,191,189),W=j;continue}j=65536+(W-55296<<10|j-56320)}else W&&(N-=3)>-1&&Y.push(239,191,189);if(W=null,j<128){if((N-=1)<0)break;Y.push(j)}else if(j<2048){if((N-=2)<0)break;Y.push(j>>6|192,63&j|128)}else if(j<65536){if((N-=3)<0)break;Y.push(j>>12|224,j>>6&63|128,63&j|128)}else{if(!(j<1114112))throw new Error("Invalid code point");if((N-=4)<0)break;Y.push(j>>18|240,j>>12&63|128,j>>6&63|128,63&j|128)}}return Y}function G(I){return o.toByteArray((function(N){if((N=(N=N.split("=")[0]).trim().replace(F,"")).length<2)return"";for(;N.length%4!=0;)N+="=";return N})(I))}function ee(I,N,j,Q){for(var W=0;W<Q&&!(W+j>=N.length||W>=I.length);++W)N[W+j]=I[W];return W}function B(I,N){return I instanceof N||I!=null&&I.constructor!=null&&I.constructor.name!=null&&I.constructor.name===N.name}function X(I){return I!=I}}).call(this)}).call(this,t("buffer").Buffer)},{"base64-js":185,buffer:220,ieee754:439}],221:[function(t,n,i){var s=t("safe-buffer").Buffer,o=t("stream").Transform,a=t("string_decoder").StringDecoder;function l(u){o.call(this),this.hashMode=typeof u=="string",this.hashMode?this[u]=this._finalOrDigest:this.final=this._finalOrDigest,this._final&&(this.__final=this._final,this._final=null),this._decoder=null,this._encoding=null}t("inherits")(l,o),l.prototype.update=function(u,c,d){typeof u=="string"&&(u=s.from(u,c));var h=this._update(u);return this.hashMode?this:(d&&(h=this._toString(h,d)),h)},l.prototype.setAutoPadding=function(){},l.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")},l.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")},l.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")},l.prototype._transform=function(u,c,d){var h;try{this.hashMode?this._update(u):this.push(this._update(u))}catch(f){h=f}finally{d(h)}},l.prototype._flush=function(u){var c;try{this.push(this.__final())}catch(d){c=d}u(c)},l.prototype._finalOrDigest=function(u){var c=this.__final()||s.alloc(0);return u&&(c=this._toString(c,u,!0)),c},l.prototype._toString=function(u,c,d){if(this._decoder||(this._decoder=new a(c),this._encoding=c),this._encoding!==c)throw new Error("can't switch encodings");var h=this._decoder.write(u);return d&&(h+=this._decoder.end()),h},n.exports=l},{inherits:440,"safe-buffer":494,stream:505,string_decoder:218}],222:[function(t,n,i){var s=t("../internals/is-callable"),o=t("../internals/try-to-string"),a=TypeError;n.exports=function(l){if(s(l))return l;throw new a(o(l)+" is not a function")}},{"../internals/is-callable":285,"../internals/try-to-string":349}],223:[function(t,n,i){var s=t("../internals/is-constructor"),o=t("../internals/try-to-string"),a=TypeError;n.exports=function(l){if(s(l))return l;throw new a(o(l)+" is not a constructor")}},{"../internals/is-constructor":286,"../internals/try-to-string":349}],224:[function(t,n,i){var s=t("../internals/is-callable"),o=String,a=TypeError;n.exports=function(l){if(typeof l=="object"||s(l))return l;throw new a("Can't set "+o(l)+" as a prototype")}},{"../internals/is-callable":285}],225:[function(t,n,i){var s=t("../internals/well-known-symbol"),o=t("../internals/object-create"),a=t("../internals/object-define-property").f,l=s("unscopables"),u=Array.prototype;u[l]===void 0&&a(u,l,{configurable:!0,value:o(null)}),n.exports=function(c){u[l][c]=!0}},{"../internals/object-create":306,"../internals/object-define-property":308,"../internals/well-known-symbol":357}],226:[function(t,n,i){var s=t("../internals/object-is-prototype-of"),o=TypeError;n.exports=function(a,l){if(s(l,a))return a;throw new o("Incorrect invocation")}},{"../internals/object-is-prototype-of":314}],227:[function(t,n,i){var s=t("../internals/is-object"),o=String,a=TypeError;n.exports=function(l){if(s(l))return l;throw new a(o(l)+" is not an object")}},{"../internals/is-object":289}],228:[function(t,n,i){var s=t("../internals/to-indexed-object"),o=t("../internals/to-absolute-index"),a=t("../internals/length-of-array-like"),l=function(u){return function(c,d,h){var f,m=s(c),p=a(m),g=o(h,p);if(u&&d!=d){for(;p>g;)if((f=m[g++])!=f)return!0}else for(;p>g;g++)if((u||g in m)&&m[g]===d)return u||g||0;return!u&&-1}};n.exports={includes:l(!0),indexOf:l(!1)}},{"../internals/length-of-array-like":299,"../internals/to-absolute-index":340,"../internals/to-indexed-object":341}],229:[function(t,n,i){var s=t("../internals/function-bind-context"),o=t("../internals/function-uncurry-this"),a=t("../internals/indexed-object"),l=t("../internals/to-object"),u=t("../internals/length-of-array-like"),c=t("../internals/array-species-create"),d=o([].push),h=function(f){var m=f===1,p=f===2,g=f===3,v=f===4,y=f===6,b=f===7,E=f===5||y;return function(A,M,L,k){for(var P,U,$=l(A),V=a($),R=s(M,L),O=u(V),T=0,w=k||c,x=m?w(A,O):p||b?w(A,0):void 0;O>T;T++)if((E||T in V)&&(U=R(P=V[T],T,$),f))if(m)x[T]=U;else if(U)switch(f){case 3:return!0;case 5:return P;case 6:return T;case 2:d(x,P)}else switch(f){case 4:return!1;case 7:d(x,P)}return y?-1:g||v?v:x}};n.exports={forEach:h(0),map:h(1),filter:h(2),some:h(3),every:h(4),find:h(5),findIndex:h(6),filterReject:h(7)}},{"../internals/array-species-create":233,"../internals/function-bind-context":262,"../internals/function-uncurry-this":268,"../internals/indexed-object":280,"../internals/length-of-array-like":299,"../internals/to-object":344}],230:[function(t,n,i){var s=t("../internals/to-absolute-index"),o=t("../internals/length-of-array-like"),a=t("../internals/create-property"),l=Array,u=Math.max;n.exports=function(c,d,h){for(var f=o(c),m=s(d,f),p=s(h===void 0?f:h,f),g=l(u(p-m,0)),v=0;m<p;m++,v++)a(g,v,c[m]);return g.length=v,g}},{"../internals/create-property":243,"../internals/length-of-array-like":299,"../internals/to-absolute-index":340}],231:[function(t,n,i){var s=t("../internals/function-uncurry-this");n.exports=s([].slice)},{"../internals/function-uncurry-this":268}],232:[function(t,n,i){var s=t("../internals/is-array"),o=t("../internals/is-constructor"),a=t("../internals/is-object"),l=t("../internals/well-known-symbol")("species"),u=Array;n.exports=function(c){var d;return s(c)&&(d=c.constructor,(o(d)&&(d===u||s(d.prototype))||a(d)&&(d=d[l])===null)&&(d=void 0)),d===void 0?u:d}},{"../internals/is-array":284,"../internals/is-constructor":286,"../internals/is-object":289,"../internals/well-known-symbol":357}],233:[function(t,n,i){var s=t("../internals/array-species-constructor");n.exports=function(o,a){return new(s(o))(a===0?0:a)}},{"../internals/array-species-constructor":232}],234:[function(t,n,i){var s=t("../internals/well-known-symbol")("iterator"),o=!1;try{var a=0,l={next:function(){return{done:!!a++}},return:function(){o=!0}};l[s]=function(){return this},Array.from(l,(function(){throw 2}))}catch{}n.exports=function(u,c){try{if(!c&&!o)return!1}catch{return!1}var d=!1;try{var h={};h[s]=function(){return{next:function(){return{done:d=!0}}}},u(h)}catch{}return d}},{"../internals/well-known-symbol":357}],235:[function(t,n,i){var s=t("../internals/function-uncurry-this"),o=s({}.toString),a=s("".slice);n.exports=function(l){return a(o(l),8,-1)}},{"../internals/function-uncurry-this":268}],236:[function(t,n,i){var s=t("../internals/to-string-tag-support"),o=t("../internals/is-callable"),a=t("../internals/classof-raw"),l=t("../internals/well-known-symbol")("toStringTag"),u=Object,c=a((function(){return arguments})())==="Arguments";n.exports=s?a:function(d){var h,f,m;return d===void 0?"Undefined":d===null?"Null":typeof(f=(function(p,g){try{return p[g]}catch{}})(h=u(d),l))=="string"?f:c?a(h):(m=a(h))==="Object"&&o(h.callee)?"Arguments":m}},{"../internals/classof-raw":235,"../internals/is-callable":285,"../internals/to-string-tag-support":347,"../internals/well-known-symbol":357}],237:[function(t,n,i){var s=t("../internals/has-own-property"),o=t("../internals/own-keys"),a=t("../internals/object-get-own-property-descriptor"),l=t("../internals/object-define-property");n.exports=function(u,c,d){for(var h=o(c),f=l.f,m=a.f,p=0;p<h.length;p++){var g=h[p];s(u,g)||d&&s(d,g)||f(u,g,m(c,g))}}},{"../internals/has-own-property":275,"../internals/object-define-property":308,"../internals/object-get-own-property-descriptor":309,"../internals/own-keys":321}],238:[function(t,n,i){var s=t("../internals/well-known-symbol")("match");n.exports=function(o){var a=/./;try{"/./"[o](a)}catch{try{return a[s]=!1,"/./"[o](a)}catch{}}return!1}},{"../internals/well-known-symbol":357}],239:[function(t,n,i){var s=t("../internals/fails");n.exports=!s((function(){function o(){}return o.prototype.constructor=null,Object.getPrototypeOf(new o)!==o.prototype}))},{"../internals/fails":260}],240:[function(t,n,i){n.exports=function(s,o){return{value:s,done:o}}},{}],241:[function(t,n,i){var s=t("../internals/descriptors"),o=t("../internals/object-define-property"),a=t("../internals/create-property-descriptor");n.exports=s?function(l,u,c){return o.f(l,u,a(1,c))}:function(l,u,c){return l[u]=c,l}},{"../internals/create-property-descriptor":242,"../internals/descriptors":247,"../internals/object-define-property":308}],242:[function(t,n,i){n.exports=function(s,o){return{enumerable:!(1&s),configurable:!(2&s),writable:!(4&s),value:o}}},{}],243:[function(t,n,i){var s=t("../internals/to-property-key"),o=t("../internals/object-define-property"),a=t("../internals/create-property-descriptor");n.exports=function(l,u,c){var d=s(u);d in l?o.f(l,d,a(0,c)):l[d]=c}},{"../internals/create-property-descriptor":242,"../internals/object-define-property":308,"../internals/to-property-key":346}],244:[function(t,n,i){var s=t("../internals/make-built-in"),o=t("../internals/object-define-property");n.exports=function(a,l,u){return u.get&&s(u.get,l,{getter:!0}),u.set&&s(u.set,l,{setter:!0}),o.f(a,l,u)}},{"../internals/make-built-in":300,"../internals/object-define-property":308}],245:[function(t,n,i){var s=t("../internals/is-callable"),o=t("../internals/object-define-property"),a=t("../internals/make-built-in"),l=t("../internals/define-global-property");n.exports=function(u,c,d,h){h||(h={});var f=h.enumerable,m=h.name!==void 0?h.name:c;if(s(d)&&a(d,m,h),h.global)f?u[c]=d:l(c,d);else{try{h.unsafe?u[c]&&(f=!0):delete u[c]}catch{}f?u[c]=d:o.f(u,c,{value:d,enumerable:!1,configurable:!h.nonConfigurable,writable:!h.nonWritable})}return u}},{"../internals/define-global-property":246,"../internals/is-callable":285,"../internals/make-built-in":300,"../internals/object-define-property":308}],246:[function(t,n,i){var s=t("../internals/global"),o=Object.defineProperty;n.exports=function(a,l){try{o(s,a,{value:l,configurable:!0,writable:!0})}catch{s[a]=l}return l}},{"../internals/global":274}],247:[function(t,n,i){var s=t("../internals/fails");n.exports=!s((function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}))},{"../internals/fails":260}],248:[function(t,n,i){var s=typeof document=="object"&&document.all,o=s===void 0&&s!==void 0;n.exports={all:s,IS_HTMLDDA:o}},{}],249:[function(t,n,i){var s=t("../internals/global"),o=t("../internals/is-object"),a=s.document,l=o(a)&&o(a.createElement);n.exports=function(u){return l?a.createElement(u):{}}},{"../internals/global":274,"../internals/is-object":289}],250:[function(t,n,i){var s=t("../internals/engine-is-deno"),o=t("../internals/engine-is-node");n.exports=!s&&!o&&typeof window=="object"&&typeof document=="object"},{"../internals/engine-is-deno":251,"../internals/engine-is-node":254}],251:[function(t,n,i){n.exports=typeof Deno=="object"&&Deno&&typeof Deno.version=="object"},{}],252:[function(t,n,i){var s=t("../internals/engine-user-agent");n.exports=/ipad|iphone|ipod/i.test(s)&&typeof Pebble<"u"},{"../internals/engine-user-agent":256}],253:[function(t,n,i){var s=t("../internals/engine-user-agent");n.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(s)},{"../internals/engine-user-agent":256}],254:[function(t,n,i){var s=t("../internals/global"),o=t("../internals/classof-raw");n.exports=o(s.process)==="process"},{"../internals/classof-raw":235,"../internals/global":274}],255:[function(t,n,i){var s=t("../internals/engine-user-agent");n.exports=/web0s(?!.*chrome)/i.test(s)},{"../internals/engine-user-agent":256}],256:[function(t,n,i){n.exports=typeof navigator<"u"&&String(navigator.userAgent)||""},{}],257:[function(t,n,i){var s,o,a=t("../internals/global"),l=t("../internals/engine-user-agent"),u=a.process,c=a.Deno,d=u&&u.versions||c&&c.version,h=d&&d.v8;h&&(o=(s=h.split("."))[0]>0&&s[0]<4?1:+(s[0]+s[1])),!o&&l&&(!(s=l.match(/Edge\/(\d+)/))||s[1]>=74)&&(s=l.match(/Chrome\/(\d+)/))&&(o=+s[1]),n.exports=o},{"../internals/engine-user-agent":256,"../internals/global":274}],258:[function(t,n,i){n.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},{}],259:[function(t,n,i){var s=t("../internals/global"),o=t("../internals/object-get-own-property-descriptor").f,a=t("../internals/create-non-enumerable-property"),l=t("../internals/define-built-in"),u=t("../internals/define-global-property"),c=t("../internals/copy-constructor-properties"),d=t("../internals/is-forced");n.exports=function(h,f){var m,p,g,v,y,b=h.target,E=h.global,A=h.stat;if(m=E?s:A?s[b]||u(b,{}):(s[b]||{}).prototype)for(p in f){if(v=f[p],g=h.dontCallGetSet?(y=o(m,p))&&y.value:m[p],!d(E?p:b+(A?".":"#")+p,h.forced)&&g!==void 0){if(typeof v==typeof g)continue;c(v,g)}(h.sham||g&&g.sham)&&a(v,"sham",!0),l(m,p,v,h)}}},{"../internals/copy-constructor-properties":237,"../internals/create-non-enumerable-property":241,"../internals/define-built-in":245,"../internals/define-global-property":246,"../internals/global":274,"../internals/is-forced":287,"../internals/object-get-own-property-descriptor":309}],260:[function(t,n,i){n.exports=function(s){try{return!!s()}catch{return!0}}},{}],261:[function(t,n,i){var s=t("../internals/function-bind-native"),o=Function.prototype,a=o.apply,l=o.call;n.exports=typeof Reflect=="object"&&Reflect.apply||(s?l.bind(a):function(){return l.apply(a,arguments)})},{"../internals/function-bind-native":263}],262:[function(t,n,i){var s=t("../internals/function-uncurry-this-clause"),o=t("../internals/a-callable"),a=t("../internals/function-bind-native"),l=s(s.bind);n.exports=function(u,c){return o(u),c===void 0?u:a?l(u,c):function(){return u.apply(c,arguments)}}},{"../internals/a-callable":222,"../internals/function-bind-native":263,"../internals/function-uncurry-this-clause":267}],263:[function(t,n,i){var s=t("../internals/fails");n.exports=!s((function(){var o=(function(){}).bind();return typeof o!="function"||o.hasOwnProperty("prototype")}))},{"../internals/fails":260}],264:[function(t,n,i){var s=t("../internals/function-bind-native"),o=Function.prototype.call;n.exports=s?o.bind(o):function(){return o.apply(o,arguments)}},{"../internals/function-bind-native":263}],265:[function(t,n,i){var s=t("../internals/descriptors"),o=t("../internals/has-own-property"),a=Function.prototype,l=s&&Object.getOwnPropertyDescriptor,u=o(a,"name"),c=u&&(function(){}).name==="something",d=u&&(!s||s&&l(a,"name").configurable);n.exports={EXISTS:u,PROPER:c,CONFIGURABLE:d}},{"../internals/descriptors":247,"../internals/has-own-property":275}],266:[function(t,n,i){var s=t("../internals/function-uncurry-this"),o=t("../internals/a-callable");n.exports=function(a,l,u){try{return s(o(Object.getOwnPropertyDescriptor(a,l)[u]))}catch{}}},{"../internals/a-callable":222,"../internals/function-uncurry-this":268}],267:[function(t,n,i){var s=t("../internals/classof-raw"),o=t("../internals/function-uncurry-this");n.exports=function(a){if(s(a)==="Function")return o(a)}},{"../internals/classof-raw":235,"../internals/function-uncurry-this":268}],268:[function(t,n,i){var s=t("../internals/function-bind-native"),o=Function.prototype,a=o.call,l=s&&o.bind.bind(a,a);n.exports=s?l:function(u){return function(){return a.apply(u,arguments)}}},{"../internals/function-bind-native":263}],269:[function(t,n,i){var s=t("../internals/global"),o=t("../internals/is-callable"),a=function(l){return o(l)?l:void 0};n.exports=function(l,u){return arguments.length<2?a(s[l]):s[l]&&s[l][u]}},{"../internals/global":274,"../internals/is-callable":285}],270:[function(t,n,i){var s=t("../internals/classof"),o=t("../internals/get-method"),a=t("../internals/is-null-or-undefined"),l=t("../internals/iterators"),u=t("../internals/well-known-symbol")("iterator");n.exports=function(c){if(!a(c))return o(c,u)||o(c,"@@iterator")||l[s(c)]}},{"../internals/classof":236,"../internals/get-method":273,"../internals/is-null-or-undefined":288,"../internals/iterators":298,"../internals/well-known-symbol":357}],271:[function(t,n,i){var s=t("../internals/function-call"),o=t("../internals/a-callable"),a=t("../internals/an-object"),l=t("../internals/try-to-string"),u=t("../internals/get-iterator-method"),c=TypeError;n.exports=function(d,h){var f=arguments.length<2?u(d):h;if(o(f))return a(s(f,d));throw new c(l(d)+" is not iterable")}},{"../internals/a-callable":222,"../internals/an-object":227,"../internals/function-call":264,"../internals/get-iterator-method":270,"../internals/try-to-string":349}],272:[function(t,n,i){var s=t("../internals/function-uncurry-this"),o=t("../internals/is-array"),a=t("../internals/is-callable"),l=t("../internals/classof-raw"),u=t("../internals/to-string"),c=s([].push);n.exports=function(d){if(a(d))return d;if(o(d)){for(var h=d.length,f=[],m=0;m<h;m++){var p=d[m];typeof p=="string"?c(f,p):typeof p!="number"&&l(p)!=="Number"&&l(p)!=="String"||c(f,u(p))}var g=f.length,v=!0;return function(y,b){if(v)return v=!1,b;if(o(this))return b;for(var E=0;E<g;E++)if(f[E]===y)return b}}}},{"../internals/classof-raw":235,"../internals/function-uncurry-this":268,"../internals/is-array":284,"../internals/is-callable":285,"../internals/to-string":348}],273:[function(t,n,i){var s=t("../internals/a-callable"),o=t("../internals/is-null-or-undefined");n.exports=function(a,l){var u=a[l];return o(u)?void 0:s(u)}},{"../internals/a-callable":222,"../internals/is-null-or-undefined":288}],274:[function(t,n,i){(function(s){(function(){var o=function(a){return a&&a.Math===Math&&a};n.exports=o(typeof globalThis=="object"&&globalThis)||o(typeof window=="object"&&window)||o(typeof self=="object"&&self)||o(typeof s=="object"&&s)||(function(){return this})()||this||Function("return this")()}).call(this)}).call(this,typeof Wt<"u"?Wt:typeof self<"u"?self:typeof window<"u"?window:{})},{}],275:[function(t,n,i){var s=t("../internals/function-uncurry-this"),o=t("../internals/to-object"),a=s({}.hasOwnProperty);n.exports=Object.hasOwn||function(l,u){return a(o(l),u)}},{"../internals/function-uncurry-this":268,"../internals/to-object":344}],276:[function(t,n,i){n.exports={}},{}],277:[function(t,n,i){n.exports=function(s,o){try{arguments.length===1?console.error(s):console.error(s,o)}catch{}}},{}],278:[function(t,n,i){var s=t("../internals/get-built-in");n.exports=s("document","documentElement")},{"../internals/get-built-in":269}],279:[function(t,n,i){var s=t("../internals/descriptors"),o=t("../internals/fails"),a=t("../internals/document-create-element");n.exports=!s&&!o((function(){return Object.defineProperty(a("div"),"a",{get:function(){return 7}}).a!==7}))},{"../internals/descriptors":247,"../internals/document-create-element":249,"../internals/fails":260}],280:[function(t,n,i){var s=t("../internals/function-uncurry-this"),o=t("../internals/fails"),a=t("../internals/classof-raw"),l=Object,u=s("".split);n.exports=o((function(){return!l("z").propertyIsEnumerable(0)}))?function(c){return a(c)==="String"?u(c,""):l(c)}:l},{"../internals/classof-raw":235,"../internals/fails":260,"../internals/function-uncurry-this":268}],281:[function(t,n,i){var s=t("../internals/function-uncurry-this"),o=t("../internals/is-callable"),a=t("../internals/shared-store"),l=s(Function.toString);o(a.inspectSource)||(a.inspectSource=function(u){return l(u)}),n.exports=a.inspectSource},{"../internals/function-uncurry-this":268,"../internals/is-callable":285,"../internals/shared-store":333}],282:[function(t,n,i){var s,o,a,l=t("../internals/weak-map-basic-detection"),u=t("../internals/global"),c=t("../internals/is-object"),d=t("../internals/create-non-enumerable-property"),h=t("../internals/has-own-property"),f=t("../internals/shared-store"),m=t("../internals/shared-key"),p=t("../internals/hidden-keys"),g=u.TypeError,v=u.WeakMap;if(l||f.state){var y=f.state||(f.state=new v);y.get=y.get,y.has=y.has,y.set=y.set,s=function(E,A){if(y.has(E))throw new g("Object already initialized");return A.facade=E,y.set(E,A),A},o=function(E){return y.get(E)||{}},a=function(E){return y.has(E)}}else{var b=m("state");p[b]=!0,s=function(E,A){if(h(E,b))throw new g("Object already initialized");return A.facade=E,d(E,b,A),A},o=function(E){return h(E,b)?E[b]:{}},a=function(E){return h(E,b)}}n.exports={set:s,get:o,has:a,enforce:function(E){return a(E)?o(E):s(E,{})},getterFor:function(E){return function(A){var M;if(!c(A)||(M=o(A)).type!==E)throw new g("Incompatible receiver, "+E+" required");return M}}}},{"../internals/create-non-enumerable-property":241,"../internals/global":274,"../internals/has-own-property":275,"../internals/hidden-keys":276,"../internals/is-object":289,"../internals/shared-key":332,"../internals/shared-store":333,"../internals/weak-map-basic-detection":354}],283:[function(t,n,i){var s=t("../internals/well-known-symbol"),o=t("../internals/iterators"),a=s("iterator"),l=Array.prototype;n.exports=function(u){return u!==void 0&&(o.Array===u||l[a]===u)}},{"../internals/iterators":298,"../internals/well-known-symbol":357}],284:[function(t,n,i){var s=t("../internals/classof-raw");n.exports=Array.isArray||function(o){return s(o)==="Array"}},{"../internals/classof-raw":235}],285:[function(t,n,i){var s=t("../internals/document-all"),o=s.all;n.exports=s.IS_HTMLDDA?function(a){return typeof a=="function"||a===o}:function(a){return typeof a=="function"}},{"../internals/document-all":248}],286:[function(t,n,i){var s=t("../internals/function-uncurry-this"),o=t("../internals/fails"),a=t("../internals/is-callable"),l=t("../internals/classof"),u=t("../internals/get-built-in"),c=t("../internals/inspect-source"),d=function(){},h=[],f=u("Reflect","construct"),m=/^\s*(?:class|function)\b/,p=s(m.exec),g=!m.test(d),v=function(b){if(!a(b))return!1;try{return f(d,h,b),!0}catch{return!1}},y=function(b){if(!a(b))return!1;switch(l(b)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return g||!!p(m,c(b))}catch{return!0}};y.sham=!0,n.exports=!f||o((function(){var b;return v(v.call)||!v(Object)||!v((function(){b=!0}))||b}))?y:v},{"../internals/classof":236,"../internals/fails":260,"../internals/function-uncurry-this":268,"../internals/get-built-in":269,"../internals/inspect-source":281,"../internals/is-callable":285}],287:[function(t,n,i){var s=t("../internals/fails"),o=t("../internals/is-callable"),a=/#|\.prototype\./,l=function(f,m){var p=c[u(f)];return p===h||p!==d&&(o(m)?s(m):!!m)},u=l.normalize=function(f){return String(f).replace(a,".").toLowerCase()},c=l.data={},d=l.NATIVE="N",h=l.POLYFILL="P";n.exports=l},{"../internals/fails":260,"../internals/is-callable":285}],288:[function(t,n,i){n.exports=function(s){return s==null}},{}],289:[function(t,n,i){var s=t("../internals/is-callable"),o=t("../internals/document-all"),a=o.all;n.exports=o.IS_HTMLDDA?function(l){return typeof l=="object"?l!==null:s(l)||l===a}:function(l){return typeof l=="object"?l!==null:s(l)}},{"../internals/document-all":248,"../internals/is-callable":285}],290:[function(t,n,i){n.exports=!1},{}],291:[function(t,n,i){var s=t("../internals/is-object"),o=t("../internals/classof-raw"),a=t("../internals/well-known-symbol")("match");n.exports=function(l){var u;return s(l)&&((u=l[a])!==void 0?!!u:o(l)==="RegExp")}},{"../internals/classof-raw":235,"../internals/is-object":289,"../internals/well-known-symbol":357}],292:[function(t,n,i){var s=t("../internals/get-built-in"),o=t("../internals/is-callable"),a=t("../internals/object-is-prototype-of"),l=t("../internals/use-symbol-as-uid"),u=Object;n.exports=l?function(c){return typeof c=="symbol"}:function(c){var d=s("Symbol");return o(d)&&a(d.prototype,u(c))}},{"../internals/get-built-in":269,"../internals/is-callable":285,"../internals/object-is-prototype-of":314,"../internals/use-symbol-as-uid":351}],293:[function(t,n,i){var s=t("../internals/function-bind-context"),o=t("../internals/function-call"),a=t("../internals/an-object"),l=t("../internals/try-to-string"),u=t("../internals/is-array-iterator-method"),c=t("../internals/length-of-array-like"),d=t("../internals/object-is-prototype-of"),h=t("../internals/get-iterator"),f=t("../internals/get-iterator-method"),m=t("../internals/iterator-close"),p=TypeError,g=function(y,b){this.stopped=y,this.result=b},v=g.prototype;n.exports=function(y,b,E){var A,M,L,k,P,U,$,V=E&&E.that,R=!(!E||!E.AS_ENTRIES),O=!(!E||!E.IS_RECORD),T=!(!E||!E.IS_ITERATOR),w=!(!E||!E.INTERRUPTED),x=s(b,V),_=function(C){return A&&m(A,"normal",C),new g(!0,C)},S=function(C){return R?(a(C),w?x(C[0],C[1],_):x(C[0],C[1])):w?x(C,_):x(C)};if(O)A=y.iterator;else if(T)A=y;else{if(!(M=f(y)))throw new p(l(y)+" is not iterable");if(u(M)){for(L=0,k=c(y);k>L;L++)if((P=S(y[L]))&&d(v,P))return P;return new g(!1)}A=h(y,M)}for(U=O?y.next:A.next;!($=o(U,A)).done;){try{P=S($.value)}catch(C){m(A,"throw",C)}if(typeof P=="object"&&P&&d(v,P))return P}return new g(!1)}},{"../internals/an-object":227,"../internals/function-bind-context":262,"../internals/function-call":264,"../internals/get-iterator":271,"../internals/get-iterator-method":270,"../internals/is-array-iterator-method":283,"../internals/iterator-close":294,"../internals/length-of-array-like":299,"../internals/object-is-prototype-of":314,"../internals/try-to-string":349}],294:[function(t,n,i){var s=t("../internals/function-call"),o=t("../internals/an-object"),a=t("../internals/get-method");n.exports=function(l,u,c){var d,h;o(l);try{if(!(d=a(l,"return"))){if(u==="throw")throw c;return c}d=s(d,l)}catch(f){h=!0,d=f}if(u==="throw")throw c;if(h)throw d;return o(d),c}},{"../internals/an-object":227,"../internals/function-call":264,"../internals/get-method":273}],295:[function(t,n,i){var s=t("../internals/iterators-core").IteratorPrototype,o=t("../internals/object-create"),a=t("../internals/create-property-descriptor"),l=t("../internals/set-to-string-tag"),u=t("../internals/iterators"),c=function(){return this};n.exports=function(d,h,f,m){var p=h+" Iterator";return d.prototype=o(s,{next:a(+!m,f)}),l(d,p,!1,!0),u[p]=c,d}},{"../internals/create-property-descriptor":242,"../internals/iterators":298,"../internals/iterators-core":297,"../internals/object-create":306,"../internals/set-to-string-tag":331}],296:[function(t,n,i){var s=t("../internals/export"),o=t("../internals/function-call"),a=t("../internals/is-pure"),l=t("../internals/function-name"),u=t("../internals/is-callable"),c=t("../internals/iterator-create-constructor"),d=t("../internals/object-get-prototype-of"),h=t("../internals/object-set-prototype-of"),f=t("../internals/set-to-string-tag"),m=t("../internals/create-non-enumerable-property"),p=t("../internals/define-built-in"),g=t("../internals/well-known-symbol"),v=t("../internals/iterators"),y=t("../internals/iterators-core"),b=l.PROPER,E=l.CONFIGURABLE,A=y.IteratorPrototype,M=y.BUGGY_SAFARI_ITERATORS,L=g("iterator"),k=function(){return this};n.exports=function(P,U,$,V,R,O,T){c($,U,V);var w,x,_,S=function(B){if(B===R&&G)return G;if(!M&&B&&B in D)return D[B];switch(B){case"keys":case"values":case"entries":return function(){return new $(this,B)}}return function(){return new $(this)}},C=U+" Iterator",F=!1,D=P.prototype,H=D[L]||D["@@iterator"]||R&&D[R],G=!M&&H||S(R),ee=U==="Array"&&D.entries||H;if(ee&&(w=d(ee.call(new P)))!==Object.prototype&&w.next&&(a||d(w)===A||(h?h(w,A):u(w[L])||p(w,L,k)),f(w,C,!0,!0),a&&(v[C]=k)),b&&R==="values"&&H&&H.name!=="values"&&(!a&&E?m(D,"name","values"):(F=!0,G=function(){return o(H,this)})),R)if(x={values:S("values"),keys:O?G:S("keys"),entries:S("entries")},T)for(_ in x)(M||F||!(_ in D))&&p(D,_,x[_]);else s({target:U,proto:!0,forced:M||F},x);return a&&!T||D[L]===G||p(D,L,G,{name:R}),v[U]=G,x}},{"../internals/create-non-enumerable-property":241,"../internals/define-built-in":245,"../internals/export":259,"../internals/function-call":264,"../internals/function-name":265,"../internals/is-callable":285,"../internals/is-pure":290,"../internals/iterator-create-constructor":295,"../internals/iterators":298,"../internals/iterators-core":297,"../internals/object-get-prototype-of":313,"../internals/object-set-prototype-of":318,"../internals/set-to-string-tag":331,"../internals/well-known-symbol":357}],297:[function(t,n,i){var s,o,a,l=t("../internals/fails"),u=t("../internals/is-callable"),c=t("../internals/is-object"),d=t("../internals/object-create"),h=t("../internals/object-get-prototype-of"),f=t("../internals/define-built-in"),m=t("../internals/well-known-symbol"),p=t("../internals/is-pure"),g=m("iterator"),v=!1;[].keys&&("next"in(a=[].keys())?(o=h(h(a)))!==Object.prototype&&(s=o):v=!0),!c(s)||l((function(){var y={};return s[g].call(y)!==y}))?s={}:p&&(s=d(s)),u(s[g])||f(s,g,(function(){return this})),n.exports={IteratorPrototype:s,BUGGY_SAFARI_ITERATORS:v}},{"../internals/define-built-in":245,"../internals/fails":260,"../internals/is-callable":285,"../internals/is-object":289,"../internals/is-pure":290,"../internals/object-create":306,"../internals/object-get-prototype-of":313,"../internals/well-known-symbol":357}],298:[function(t,n,i){arguments[4][276][0].apply(i,arguments)},{dup:276}],299:[function(t,n,i){var s=t("../internals/to-length");n.exports=function(o){return s(o.length)}},{"../internals/to-length":343}],300:[function(t,n,i){var s=t("../internals/function-uncurry-this"),o=t("../internals/fails"),a=t("../internals/is-callable"),l=t("../internals/has-own-property"),u=t("../internals/descriptors"),c=t("../internals/function-name").CONFIGURABLE,d=t("../internals/inspect-source"),h=t("../internals/internal-state"),f=h.enforce,m=h.get,p=String,g=Object.defineProperty,v=s("".slice),y=s("".replace),b=s([].join),E=u&&!o((function(){return g((function(){}),"length",{value:8}).length!==8})),A=String(String).split("String"),M=n.exports=function(L,k,P){v(p(k),0,7)==="Symbol("&&(k="["+y(p(k),/^Symbol\(([^)]*)\)/,"$1")+"]"),P&&P.getter&&(k="get "+k),P&&P.setter&&(k="set "+k),(!l(L,"name")||c&&L.name!==k)&&(u?g(L,"name",{value:k,configurable:!0}):L.name=k),E&&P&&l(P,"arity")&&L.length!==P.arity&&g(L,"length",{value:P.arity});try{P&&l(P,"constructor")&&P.constructor?u&&g(L,"prototype",{writable:!1}):L.prototype&&(L.prototype=void 0)}catch{}var U=f(L);return l(U,"source")||(U.source=b(A,typeof k=="string"?k:"")),L};Function.prototype.toString=M((function(){return a(this)&&m(this).source||d(this)}),"toString")},{"../internals/descriptors":247,"../internals/fails":260,"../internals/function-name":265,"../internals/function-uncurry-this":268,"../internals/has-own-property":275,"../internals/inspect-source":281,"../internals/internal-state":282,"../internals/is-callable":285}],301:[function(t,n,i){var s=Math.ceil,o=Math.floor;n.exports=Math.trunc||function(a){var l=+a;return(l>0?o:s)(l)}},{}],302:[function(t,n,i){var s,o,a,l,u,c=t("../internals/global"),d=t("../internals/function-bind-context"),h=t("../internals/object-get-own-property-descriptor").f,f=t("../internals/task").set,m=t("../internals/queue"),p=t("../internals/engine-is-ios"),g=t("../internals/engine-is-ios-pebble"),v=t("../internals/engine-is-webos-webkit"),y=t("../internals/engine-is-node"),b=c.MutationObserver||c.WebKitMutationObserver,E=c.document,A=c.process,M=c.Promise,L=h(c,"queueMicrotask"),k=L&&L.value;if(!k){var P=new m,U=function(){var $,V;for(y&&($=A.domain)&&$.exit();V=P.get();)try{V()}catch(R){throw P.head&&s(),R}$&&$.enter()};p||y||v||!b||!E?!g&&M&&M.resolve?((l=M.resolve(void 0)).constructor=M,u=d(l.then,l),s=function(){u(U)}):y?s=function(){A.nextTick(U)}:(f=d(f,c),s=function(){f(U)}):(o=!0,a=E.createTextNode(""),new b(U).observe(a,{characterData:!0}),s=function(){a.data=o=!o}),k=function($){P.head||s(),P.add($)}}n.exports=k},{"../internals/engine-is-ios":253,"../internals/engine-is-ios-pebble":252,"../internals/engine-is-node":254,"../internals/engine-is-webos-webkit":255,"../internals/function-bind-context":262,"../internals/global":274,"../internals/object-get-own-property-descriptor":309,"../internals/queue":328,"../internals/task":339}],303:[function(t,n,i){var s=t("../internals/a-callable"),o=TypeError,a=function(l){var u,c;this.promise=new l((function(d,h){if(u!==void 0||c!==void 0)throw new o("Bad Promise constructor");u=d,c=h})),this.resolve=s(u),this.reject=s(c)};n.exports.f=function(l){return new a(l)}},{"../internals/a-callable":222}],304:[function(t,n,i){var s=t("../internals/is-regexp"),o=TypeError;n.exports=function(a){if(s(a))throw new o("The method doesn't accept regular expressions");return a}},{"../internals/is-regexp":291}],305:[function(t,n,i){var s=t("../internals/descriptors"),o=t("../internals/function-uncurry-this"),a=t("../internals/function-call"),l=t("../internals/fails"),u=t("../internals/object-keys"),c=t("../internals/object-get-own-property-symbols"),d=t("../internals/object-property-is-enumerable"),h=t("../internals/to-object"),f=t("../internals/indexed-object"),m=Object.assign,p=Object.defineProperty,g=o([].concat);n.exports=!m||l((function(){if(s&&m({b:1},m(p({},"a",{enumerable:!0,get:function(){p(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var v={},y={},b=Symbol("assign detection");return v[b]=7,"abcdefghijklmnopqrst".split("").forEach((function(E){y[E]=E})),m({},v)[b]!==7||u(m({},y)).join("")!=="abcdefghijklmnopqrst"}))?function(v,y){for(var b=h(v),E=arguments.length,A=1,M=c.f,L=d.f;E>A;)for(var k,P=f(arguments[A++]),U=M?g(u(P),M(P)):u(P),$=U.length,V=0;$>V;)k=U[V++],s&&!a(L,P,k)||(b[k]=P[k]);return b}:m},{"../internals/descriptors":247,"../internals/fails":260,"../internals/function-call":264,"../internals/function-uncurry-this":268,"../internals/indexed-object":280,"../internals/object-get-own-property-symbols":312,"../internals/object-keys":316,"../internals/object-property-is-enumerable":317,"../internals/to-object":344}],306:[function(t,n,i){var s,o=t("../internals/an-object"),a=t("../internals/object-define-properties"),l=t("../internals/enum-bug-keys"),u=t("../internals/hidden-keys"),c=t("../internals/html"),d=t("../internals/document-create-element"),h=t("../internals/shared-key"),f=h("IE_PROTO"),m=function(){},p=function(y){return"<script>"+y+"<\/script>"},g=function(y){y.write(p("")),y.close();var b=y.parentWindow.Object;return y=null,b},v=function(){try{s=new ActiveXObject("htmlfile")}catch{}var y,b;v=typeof document<"u"?document.domain&&s?g(s):((b=d("iframe")).style.display="none",c.appendChild(b),b.src="javascript:",(y=b.contentWindow.document).open(),y.write(p("document.F=Object")),y.close(),y.F):g(s);for(var E=l.length;E--;)delete v.prototype[l[E]];return v()};u[f]=!0,n.exports=Object.create||function(y,b){var E;return y!==null?(m.prototype=o(y),E=new m,m.prototype=null,E[f]=y):E=v(),b===void 0?E:a.f(E,b)}},{"../internals/an-object":227,"../internals/document-create-element":249,"../internals/enum-bug-keys":258,"../internals/hidden-keys":276,"../internals/html":278,"../internals/object-define-properties":307,"../internals/shared-key":332}],307:[function(t,n,i){var s=t("../internals/descriptors"),o=t("../internals/v8-prototype-define-bug"),a=t("../internals/object-define-property"),l=t("../internals/an-object"),u=t("../internals/to-indexed-object"),c=t("../internals/object-keys");i.f=s&&!o?Object.defineProperties:function(d,h){l(d);for(var f,m=u(h),p=c(h),g=p.length,v=0;g>v;)a.f(d,f=p[v++],m[f]);return d}},{"../internals/an-object":227,"../internals/descriptors":247,"../internals/object-define-property":308,"../internals/object-keys":316,"../internals/to-indexed-object":341,"../internals/v8-prototype-define-bug":352}],308:[function(t,n,i){var s=t("../internals/descriptors"),o=t("../internals/ie8-dom-define"),a=t("../internals/v8-prototype-define-bug"),l=t("../internals/an-object"),u=t("../internals/to-property-key"),c=TypeError,d=Object.defineProperty,h=Object.getOwnPropertyDescriptor;i.f=s?a?function(f,m,p){if(l(f),m=u(m),l(p),typeof f=="function"&&m==="prototype"&&"value"in p&&"writable"in p&&!p.writable){var g=h(f,m);g&&g.writable&&(f[m]=p.value,p={configurable:"configurable"in p?p.configurable:g.configurable,enumerable:"enumerable"in p?p.enumerable:g.enumerable,writable:!1})}return d(f,m,p)}:d:function(f,m,p){if(l(f),m=u(m),l(p),o)try{return d(f,m,p)}catch{}if("get"in p||"set"in p)throw new c("Accessors not supported");return"value"in p&&(f[m]=p.value),f}},{"../internals/an-object":227,"../internals/descriptors":247,"../internals/ie8-dom-define":279,"../internals/to-property-key":346,"../internals/v8-prototype-define-bug":352}],309:[function(t,n,i){var s=t("../internals/descriptors"),o=t("../internals/function-call"),a=t("../internals/object-property-is-enumerable"),l=t("../internals/create-property-descriptor"),u=t("../internals/to-indexed-object"),c=t("../internals/to-property-key"),d=t("../internals/has-own-property"),h=t("../internals/ie8-dom-define"),f=Object.getOwnPropertyDescriptor;i.f=s?f:function(m,p){if(m=u(m),p=c(p),h)try{return f(m,p)}catch{}if(d(m,p))return l(!o(a.f,m,p),m[p])}},{"../internals/create-property-descriptor":242,"../internals/descriptors":247,"../internals/function-call":264,"../internals/has-own-property":275,"../internals/ie8-dom-define":279,"../internals/object-property-is-enumerable":317,"../internals/to-indexed-object":341,"../internals/to-property-key":346}],310:[function(t,n,i){var s=t("../internals/classof-raw"),o=t("../internals/to-indexed-object"),a=t("../internals/object-get-own-property-names").f,l=t("../internals/array-slice-simple"),u=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];n.exports.f=function(c){return u&&s(c)==="Window"?(function(d){try{return a(d)}catch{return l(u)}})(c):a(o(c))}},{"../internals/array-slice-simple":230,"../internals/classof-raw":235,"../internals/object-get-own-property-names":311,"../internals/to-indexed-object":341}],311:[function(t,n,i){var s=t("../internals/object-keys-internal"),o=t("../internals/enum-bug-keys").concat("length","prototype");i.f=Object.getOwnPropertyNames||function(a){return s(a,o)}},{"../internals/enum-bug-keys":258,"../internals/object-keys-internal":315}],312:[function(t,n,i){i.f=Object.getOwnPropertySymbols},{}],313:[function(t,n,i){var s=t("../internals/has-own-property"),o=t("../internals/is-callable"),a=t("../internals/to-object"),l=t("../internals/shared-key"),u=t("../internals/correct-prototype-getter"),c=l("IE_PROTO"),d=Object,h=d.prototype;n.exports=u?d.getPrototypeOf:function(f){var m=a(f);if(s(m,c))return m[c];var p=m.constructor;return o(p)&&m instanceof p?p.prototype:m instanceof d?h:null}},{"../internals/correct-prototype-getter":239,"../internals/has-own-property":275,"../internals/is-callable":285,"../internals/shared-key":332,"../internals/to-object":344}],314:[function(t,n,i){var s=t("../internals/function-uncurry-this");n.exports=s({}.isPrototypeOf)},{"../internals/function-uncurry-this":268}],315:[function(t,n,i){var s=t("../internals/function-uncurry-this"),o=t("../internals/has-own-property"),a=t("../internals/to-indexed-object"),l=t("../internals/array-includes").indexOf,u=t("../internals/hidden-keys"),c=s([].push);n.exports=function(d,h){var f,m=a(d),p=0,g=[];for(f in m)!o(u,f)&&o(m,f)&&c(g,f);for(;h.length>p;)o(m,f=h[p++])&&(~l(g,f)||c(g,f));return g}},{"../internals/array-includes":228,"../internals/function-uncurry-this":268,"../internals/has-own-property":275,"../internals/hidden-keys":276,"../internals/to-indexed-object":341}],316:[function(t,n,i){var s=t("../internals/object-keys-internal"),o=t("../internals/enum-bug-keys");n.exports=Object.keys||function(a){return s(a,o)}},{"../internals/enum-bug-keys":258,"../internals/object-keys-internal":315}],317:[function(t,n,i){var s={}.propertyIsEnumerable,o=Object.getOwnPropertyDescriptor,a=o&&!s.call({1:2},1);i.f=a?function(l){var u=o(this,l);return!!u&&u.enumerable}:s},{}],318:[function(t,n,i){var s=t("../internals/function-uncurry-this-accessor"),o=t("../internals/an-object"),a=t("../internals/a-possible-prototype");n.exports=Object.setPrototypeOf||("__proto__"in{}?(function(){var l,u=!1,c={};try{(l=s(Object.prototype,"__proto__","set"))(c,[]),u=c instanceof Array}catch{}return function(d,h){return o(d),a(h),u?l(d,h):d.__proto__=h,d}})():void 0)},{"../internals/a-possible-prototype":224,"../internals/an-object":227,"../internals/function-uncurry-this-accessor":266}],319:[function(t,n,i){var s=t("../internals/descriptors"),o=t("../internals/fails"),a=t("../internals/function-uncurry-this"),l=t("../internals/object-get-prototype-of"),u=t("../internals/object-keys"),c=t("../internals/to-indexed-object"),d=a(t("../internals/object-property-is-enumerable").f),h=a([].push),f=s&&o((function(){var p=Object.create(null);return p[2]=2,!d(p,2)})),m=function(p){return function(g){for(var v,y=c(g),b=u(y),E=f&&l(y)===null,A=b.length,M=0,L=[];A>M;)v=b[M++],s&&!(E?v in y:d(y,v))||h(L,p?[v,y[v]]:y[v]);return L}};n.exports={entries:m(!0),values:m(!1)}},{"../internals/descriptors":247,"../internals/fails":260,"../internals/function-uncurry-this":268,"../internals/object-get-prototype-of":313,"../internals/object-keys":316,"../internals/object-property-is-enumerable":317,"../internals/to-indexed-object":341}],320:[function(t,n,i){var s=t("../internals/function-call"),o=t("../internals/is-callable"),a=t("../internals/is-object"),l=TypeError;n.exports=function(u,c){var d,h;if(c==="string"&&o(d=u.toString)&&!a(h=s(d,u))||o(d=u.valueOf)&&!a(h=s(d,u))||c!=="string"&&o(d=u.toString)&&!a(h=s(d,u)))return h;throw new l("Can't convert object to primitive value")}},{"../internals/function-call":264,"../internals/is-callable":285,"../internals/is-object":289}],321:[function(t,n,i){var s=t("../internals/get-built-in"),o=t("../internals/function-uncurry-this"),a=t("../internals/object-get-own-property-names"),l=t("../internals/object-get-own-property-symbols"),u=t("../internals/an-object"),c=o([].concat);n.exports=s("Reflect","ownKeys")||function(d){var h=a.f(u(d)),f=l.f;return f?c(h,f(d)):h}},{"../internals/an-object":227,"../internals/function-uncurry-this":268,"../internals/get-built-in":269,"../internals/object-get-own-property-names":311,"../internals/object-get-own-property-symbols":312}],322:[function(t,n,i){var s=t("../internals/global");n.exports=s},{"../internals/global":274}],323:[function(t,n,i){n.exports=function(s){try{return{error:!1,value:s()}}catch(o){return{error:!0,value:o}}}},{}],324:[function(t,n,i){var s=t("../internals/global"),o=t("../internals/promise-native-constructor"),a=t("../internals/is-callable"),l=t("../internals/is-forced"),u=t("../internals/inspect-source"),c=t("../internals/well-known-symbol"),d=t("../internals/engine-is-browser"),h=t("../internals/engine-is-deno"),f=t("../internals/is-pure"),m=t("../internals/engine-v8-version"),p=o&&o.prototype,g=c("species"),v=!1,y=a(s.PromiseRejectionEvent),b=l("Promise",(function(){var E=u(o),A=E!==String(o);if(!A&&m===66||f&&(!p.catch||!p.finally))return!0;if(!m||m<51||!/native code/.test(E)){var M=new o((function(k){k(1)})),L=function(k){k((function(){}),(function(){}))};if((M.constructor={})[g]=L,!(v=M.then((function(){}))instanceof L))return!0}return!A&&(d||h)&&!y}));n.exports={CONSTRUCTOR:b,REJECTION_EVENT:y,SUBCLASSING:v}},{"../internals/engine-is-browser":250,"../internals/engine-is-deno":251,"../internals/engine-v8-version":257,"../internals/global":274,"../internals/inspect-source":281,"../internals/is-callable":285,"../internals/is-forced":287,"../internals/is-pure":290,"../internals/promise-native-constructor":325,"../internals/well-known-symbol":357}],325:[function(t,n,i){var s=t("../internals/global");n.exports=s.Promise},{"../internals/global":274}],326:[function(t,n,i){var s=t("../internals/an-object"),o=t("../internals/is-object"),a=t("../internals/new-promise-capability");n.exports=function(l,u){if(s(l),o(u)&&u.constructor===l)return u;var c=a.f(l);return(0,c.resolve)(u),c.promise}},{"../internals/an-object":227,"../internals/is-object":289,"../internals/new-promise-capability":303}],327:[function(t,n,i){var s=t("../internals/promise-native-constructor"),o=t("../internals/check-correctness-of-iteration"),a=t("../internals/promise-constructor-detection").CONSTRUCTOR;n.exports=a||!o((function(l){s.all(l).then(void 0,(function(){}))}))},{"../internals/check-correctness-of-iteration":234,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325}],328:[function(t,n,i){var s=function(){this.head=null,this.tail=null};s.prototype={add:function(o){var a={item:o,next:null},l=this.tail;l?l.next=a:this.head=a,this.tail=a},get:function(){var o=this.head;if(o)return(this.head=o.next)===null&&(this.tail=null),o.item}},n.exports=s},{}],329:[function(t,n,i){var s=t("../internals/is-null-or-undefined"),o=TypeError;n.exports=function(a){if(s(a))throw new o("Can't call method on "+a);return a}},{"../internals/is-null-or-undefined":288}],330:[function(t,n,i){var s=t("../internals/get-built-in"),o=t("../internals/define-built-in-accessor"),a=t("../internals/well-known-symbol"),l=t("../internals/descriptors"),u=a("species");n.exports=function(c){var d=s(c);l&&d&&!d[u]&&o(d,u,{configurable:!0,get:function(){return this}})}},{"../internals/define-built-in-accessor":244,"../internals/descriptors":247,"../internals/get-built-in":269,"../internals/well-known-symbol":357}],331:[function(t,n,i){var s=t("../internals/object-define-property").f,o=t("../internals/has-own-property"),a=t("../internals/well-known-symbol")("toStringTag");n.exports=function(l,u,c){l&&!c&&(l=l.prototype),l&&!o(l,a)&&s(l,a,{configurable:!0,value:u})}},{"../internals/has-own-property":275,"../internals/object-define-property":308,"../internals/well-known-symbol":357}],332:[function(t,n,i){var s=t("../internals/shared"),o=t("../internals/uid"),a=s("keys");n.exports=function(l){return a[l]||(a[l]=o(l))}},{"../internals/shared":334,"../internals/uid":350}],333:[function(t,n,i){var s=t("../internals/global"),o=t("../internals/define-global-property"),a=s["__core-js_shared__"]||o("__core-js_shared__",{});n.exports=a},{"../internals/define-global-property":246,"../internals/global":274}],334:[function(t,n,i){var s=t("../internals/is-pure"),o=t("../internals/shared-store");(n.exports=function(a,l){return o[a]||(o[a]=l!==void 0?l:{})})("versions",[]).push({version:"3.33.0",mode:s?"pure":"global",copyright:" 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.33.0/LICENSE",source:"https://github.com/zloirock/core-js"})},{"../internals/is-pure":290,"../internals/shared-store":333}],335:[function(t,n,i){var s=t("../internals/an-object"),o=t("../internals/a-constructor"),a=t("../internals/is-null-or-undefined"),l=t("../internals/well-known-symbol")("species");n.exports=function(u,c){var d,h=s(u).constructor;return h===void 0||a(d=s(h)[l])?c:o(d)}},{"../internals/a-constructor":223,"../internals/an-object":227,"../internals/is-null-or-undefined":288,"../internals/well-known-symbol":357}],336:[function(t,n,i){var s=t("../internals/engine-v8-version"),o=t("../internals/fails"),a=t("../internals/global").String;n.exports=!!Object.getOwnPropertySymbols&&!o((function(){var l=Symbol("symbol detection");return!a(l)||!(Object(l)instanceof Symbol)||!Symbol.sham&&s&&s<41}))},{"../internals/engine-v8-version":257,"../internals/fails":260,"../internals/global":274}],337:[function(t,n,i){var s=t("../internals/function-call"),o=t("../internals/get-built-in"),a=t("../internals/well-known-symbol"),l=t("../internals/define-built-in");n.exports=function(){var u=o("Symbol"),c=u&&u.prototype,d=c&&c.valueOf,h=a("toPrimitive");c&&!c[h]&&l(c,h,(function(f){return s(d,this)}),{arity:1})}},{"../internals/define-built-in":245,"../internals/function-call":264,"../internals/get-built-in":269,"../internals/well-known-symbol":357}],338:[function(t,n,i){var s=t("../internals/symbol-constructor-detection");n.exports=s&&!!Symbol.for&&!!Symbol.keyFor},{"../internals/symbol-constructor-detection":336}],339:[function(t,n,i){var s,o,a,l,u=t("../internals/global"),c=t("../internals/function-apply"),d=t("../internals/function-bind-context"),h=t("../internals/is-callable"),f=t("../internals/has-own-property"),m=t("../internals/fails"),p=t("../internals/html"),g=t("../internals/array-slice"),v=t("../internals/document-create-element"),y=t("../internals/validate-arguments-length"),b=t("../internals/engine-is-ios"),E=t("../internals/engine-is-node"),A=u.setImmediate,M=u.clearImmediate,L=u.process,k=u.Dispatch,P=u.Function,U=u.MessageChannel,$=u.String,V=0,R={};m((function(){s=u.location}));var O=function(_){if(f(R,_)){var S=R[_];delete R[_],S()}},T=function(_){return function(){O(_)}},w=function(_){O(_.data)},x=function(_){u.postMessage($(_),s.protocol+"//"+s.host)};A&&M||(A=function(_){y(arguments.length,1);var S=h(_)?_:P(_),C=g(arguments,1);return R[++V]=function(){c(S,void 0,C)},o(V),V},M=function(_){delete R[_]},E?o=function(_){L.nextTick(T(_))}:k&&k.now?o=function(_){k.now(T(_))}:U&&!b?(l=(a=new U).port2,a.port1.onmessage=w,o=d(l.postMessage,l)):u.addEventListener&&h(u.postMessage)&&!u.importScripts&&s&&s.protocol!=="file:"&&!m(x)?(o=x,u.addEventListener("message",w,!1)):o="onreadystatechange"in v("script")?function(_){p.appendChild(v("script")).onreadystatechange=function(){p.removeChild(this),O(_)}}:function(_){setTimeout(T(_),0)}),n.exports={set:A,clear:M}},{"../internals/array-slice":231,"../internals/document-create-element":249,"../internals/engine-is-ios":253,"../internals/engine-is-node":254,"../internals/fails":260,"../internals/function-apply":261,"../internals/function-bind-context":262,"../internals/global":274,"../internals/has-own-property":275,"../internals/html":278,"../internals/is-callable":285,"../internals/validate-arguments-length":353}],340:[function(t,n,i){var s=t("../internals/to-integer-or-infinity"),o=Math.max,a=Math.min;n.exports=function(l,u){var c=s(l);return c<0?o(c+u,0):a(c,u)}},{"../internals/to-integer-or-infinity":342}],341:[function(t,n,i){var s=t("../internals/indexed-object"),o=t("../internals/require-object-coercible");n.exports=function(a){return s(o(a))}},{"../internals/indexed-object":280,"../internals/require-object-coercible":329}],342:[function(t,n,i){var s=t("../internals/math-trunc");n.exports=function(o){var a=+o;return a!=a||a===0?0:s(a)}},{"../internals/math-trunc":301}],343:[function(t,n,i){var s=t("../internals/to-integer-or-infinity"),o=Math.min;n.exports=function(a){return a>0?o(s(a),9007199254740991):0}},{"../internals/to-integer-or-infinity":342}],344:[function(t,n,i){var s=t("../internals/require-object-coercible"),o=Object;n.exports=function(a){return o(s(a))}},{"../internals/require-object-coercible":329}],345:[function(t,n,i){var s=t("../internals/function-call"),o=t("../internals/is-object"),a=t("../internals/is-symbol"),l=t("../internals/get-method"),u=t("../internals/ordinary-to-primitive"),c=t("../internals/well-known-symbol"),d=TypeError,h=c("toPrimitive");n.exports=function(f,m){if(!o(f)||a(f))return f;var p,g=l(f,h);if(g){if(m===void 0&&(m="default"),p=s(g,f,m),!o(p)||a(p))return p;throw new d("Can't convert object to primitive value")}return m===void 0&&(m="number"),u(f,m)}},{"../internals/function-call":264,"../internals/get-method":273,"../internals/is-object":289,"../internals/is-symbol":292,"../internals/ordinary-to-primitive":320,"../internals/well-known-symbol":357}],346:[function(t,n,i){var s=t("../internals/to-primitive"),o=t("../internals/is-symbol");n.exports=function(a){var l=s(a,"string");return o(l)?l:l+""}},{"../internals/is-symbol":292,"../internals/to-primitive":345}],347:[function(t,n,i){var s={};s[t("../internals/well-known-symbol")("toStringTag")]="z",n.exports=String(s)==="[object z]"},{"../internals/well-known-symbol":357}],348:[function(t,n,i){var s=t("../internals/classof"),o=String;n.exports=function(a){if(s(a)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return o(a)}},{"../internals/classof":236}],349:[function(t,n,i){var s=String;n.exports=function(o){try{return s(o)}catch{return"Object"}}},{}],350:[function(t,n,i){var s=t("../internals/function-uncurry-this"),o=0,a=Math.random(),l=s(1 .toString);n.exports=function(u){return"Symbol("+(u===void 0?"":u)+")_"+l(++o+a,36)}},{"../internals/function-uncurry-this":268}],351:[function(t,n,i){var s=t("../internals/symbol-constructor-detection");n.exports=s&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},{"../internals/symbol-constructor-detection":336}],352:[function(t,n,i){var s=t("../internals/descriptors"),o=t("../internals/fails");n.exports=s&&o((function(){return Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype!==42}))},{"../internals/descriptors":247,"../internals/fails":260}],353:[function(t,n,i){var s=TypeError;n.exports=function(o,a){if(o<a)throw new s("Not enough arguments");return o}},{}],354:[function(t,n,i){var s=t("../internals/global"),o=t("../internals/is-callable"),a=s.WeakMap;n.exports=o(a)&&/native code/.test(String(a))},{"../internals/global":274,"../internals/is-callable":285}],355:[function(t,n,i){var s=t("../internals/path"),o=t("../internals/has-own-property"),a=t("../internals/well-known-symbol-wrapped"),l=t("../internals/object-define-property").f;n.exports=function(u){var c=s.Symbol||(s.Symbol={});o(c,u)||l(c,u,{value:a.f(u)})}},{"../internals/has-own-property":275,"../internals/object-define-property":308,"../internals/path":322,"../internals/well-known-symbol-wrapped":356}],356:[function(t,n,i){var s=t("../internals/well-known-symbol");i.f=s},{"../internals/well-known-symbol":357}],357:[function(t,n,i){var s=t("../internals/global"),o=t("../internals/shared"),a=t("../internals/has-own-property"),l=t("../internals/uid"),u=t("../internals/symbol-constructor-detection"),c=t("../internals/use-symbol-as-uid"),d=s.Symbol,h=o("wks"),f=c?d.for||d:d&&d.withoutSetter||l;n.exports=function(m){return a(h,m)||(h[m]=u&&a(d,m)?d[m]:f("Symbol."+m)),h[m]}},{"../internals/global":274,"../internals/has-own-property":275,"../internals/shared":334,"../internals/symbol-constructor-detection":336,"../internals/uid":350,"../internals/use-symbol-as-uid":351}],358:[function(t,n,i){var s=t("../internals/export"),o=t("../internals/array-iteration").findIndex,a=t("../internals/add-to-unscopables"),l=!0;"findIndex"in[]&&Array(1).findIndex((function(){l=!1})),s({target:"Array",proto:!0,forced:l},{findIndex:function(u){return o(this,u,arguments.length>1?arguments[1]:void 0)}}),a("findIndex")},{"../internals/add-to-unscopables":225,"../internals/array-iteration":229,"../internals/export":259}],359:[function(t,n,i){var s=t("../internals/export"),o=t("../internals/array-iteration").find,a=t("../internals/add-to-unscopables"),l=!0;"find"in[]&&Array(1).find((function(){l=!1})),s({target:"Array",proto:!0,forced:l},{find:function(u){return o(this,u,arguments.length>1?arguments[1]:void 0)}}),a("find")},{"../internals/add-to-unscopables":225,"../internals/array-iteration":229,"../internals/export":259}],360:[function(t,n,i){var s=t("../internals/export"),o=t("../internals/array-includes").includes,a=t("../internals/fails"),l=t("../internals/add-to-unscopables");s({target:"Array",proto:!0,forced:a((function(){return!Array(1).includes()}))},{includes:function(u){return o(this,u,arguments.length>1?arguments[1]:void 0)}}),l("includes")},{"../internals/add-to-unscopables":225,"../internals/array-includes":228,"../internals/export":259,"../internals/fails":260}],361:[function(t,n,i){var s=t("../internals/to-indexed-object"),o=t("../internals/add-to-unscopables"),a=t("../internals/iterators"),l=t("../internals/internal-state"),u=t("../internals/object-define-property").f,c=t("../internals/iterator-define"),d=t("../internals/create-iter-result-object"),h=t("../internals/is-pure"),f=t("../internals/descriptors"),m=l.set,p=l.getterFor("Array Iterator");n.exports=c(Array,"Array",(function(v,y){m(this,{type:"Array Iterator",target:s(v),index:0,kind:y})}),(function(){var v=p(this),y=v.target,b=v.kind,E=v.index++;if(!y||E>=y.length)return v.target=void 0,d(void 0,!0);switch(b){case"keys":return d(E,!1);case"values":return d(y[E],!1)}return d([E,y[E]],!1)}),"values");var g=a.Arguments=a.Array;if(o("keys"),o("values"),o("entries"),!h&&f&&g.name!=="values")try{u(g,"name",{value:"values"})}catch{}},{"../internals/add-to-unscopables":225,"../internals/create-iter-result-object":240,"../internals/descriptors":247,"../internals/internal-state":282,"../internals/is-pure":290,"../internals/iterator-define":296,"../internals/iterators":298,"../internals/object-define-property":308,"../internals/to-indexed-object":341}],362:[function(t,n,i){var s=t("../internals/export"),o=t("../internals/get-built-in"),a=t("../internals/function-apply"),l=t("../internals/function-call"),u=t("../internals/function-uncurry-this"),c=t("../internals/fails"),d=t("../internals/is-callable"),h=t("../internals/is-symbol"),f=t("../internals/array-slice"),m=t("../internals/get-json-replacer-function"),p=t("../internals/symbol-constructor-detection"),g=String,v=o("JSON","stringify"),y=u(/./.exec),b=u("".charAt),E=u("".charCodeAt),A=u("".replace),M=u(1 .toString),L=/[\uD800-\uDFFF]/g,k=/^[\uD800-\uDBFF]$/,P=/^[\uDC00-\uDFFF]$/,U=!p||c((function(){var O=o("Symbol")("stringify detection");return v([O])!=="[null]"||v({a:O})!=="{}"||v(Object(O))!=="{}"})),$=c((function(){return v("\uDF06\uD834")!=='"\\udf06\\ud834"'||v("\uDEAD")!=='"\\udead"'})),V=function(O,T){var w=f(arguments),x=m(T);if(d(x)||O!==void 0&&!h(O))return w[1]=function(_,S){if(d(x)&&(S=l(x,this,g(_),S)),!h(S))return S},a(v,null,w)},R=function(O,T,w){var x=b(w,T-1),_=b(w,T+1);return y(k,O)&&!y(P,_)||y(P,O)&&!y(k,x)?"\\u"+M(E(O,0),16):O};v&&s({target:"JSON",stat:!0,arity:3,forced:U||$},{stringify:function(O,T,w){var x=f(arguments),_=a(U?V:v,null,x);return $&&typeof _=="string"?A(_,L,R):_}})},{"../internals/array-slice":231,"../internals/export":259,"../internals/fails":260,"../internals/function-apply":261,"../internals/function-call":264,"../internals/function-uncurry-this":268,"../internals/get-built-in":269,"../internals/get-json-replacer-function":272,"../internals/is-callable":285,"../internals/is-symbol":292,"../internals/symbol-constructor-detection":336}],363:[function(t,n,i){t("../internals/export")({target:"Number",stat:!0},{isNaN:function(s){return s!=s}})},{"../internals/export":259}],364:[function(t,n,i){var s=t("../internals/export"),o=t("../internals/object-assign");s({target:"Object",stat:!0,arity:2,forced:Object.assign!==o},{assign:o})},{"../internals/export":259,"../internals/object-assign":305}],365:[function(t,n,i){var s=t("../internals/export"),o=t("../internals/symbol-constructor-detection"),a=t("../internals/fails"),l=t("../internals/object-get-own-property-symbols"),u=t("../internals/to-object");s({target:"Object",stat:!0,forced:!o||a((function(){l.f(1)}))},{getOwnPropertySymbols:function(c){var d=l.f;return d?d(u(c)):[]}})},{"../internals/export":259,"../internals/fails":260,"../internals/object-get-own-property-symbols":312,"../internals/symbol-constructor-detection":336,"../internals/to-object":344}],366:[function(t,n,i){var s=t("../internals/export"),o=t("../internals/to-object"),a=t("../internals/object-keys");s({target:"Object",stat:!0,forced:t("../internals/fails")((function(){a(1)}))},{keys:function(l){return a(o(l))}})},{"../internals/export":259,"../internals/fails":260,"../internals/object-keys":316,"../internals/to-object":344}],367:[function(t,n,i){var s=t("../internals/export"),o=t("../internals/object-to-array").values;s({target:"Object",stat:!0},{values:function(a){return o(a)}})},{"../internals/export":259,"../internals/object-to-array":319}],368:[function(t,n,i){var s=t("../internals/export"),o=t("../internals/function-call"),a=t("../internals/a-callable"),l=t("../internals/new-promise-capability"),u=t("../internals/perform"),c=t("../internals/iterate");s({target:"Promise",stat:!0,forced:t("../internals/promise-statics-incorrect-iteration")},{all:function(d){var h=this,f=l.f(h),m=f.resolve,p=f.reject,g=u((function(){var v=a(h.resolve),y=[],b=0,E=1;c(d,(function(A){var M=b++,L=!1;E++,o(v,h,A).then((function(k){L||(L=!0,y[M]=k,--E||m(y))}),p)})),--E||m(y)}));return g.error&&p(g.value),f.promise}})},{"../internals/a-callable":222,"../internals/export":259,"../internals/function-call":264,"../internals/iterate":293,"../internals/new-promise-capability":303,"../internals/perform":323,"../internals/promise-statics-incorrect-iteration":327}],369:[function(t,n,i){var s=t("../internals/export"),o=t("../internals/is-pure"),a=t("../internals/promise-constructor-detection").CONSTRUCTOR,l=t("../internals/promise-native-constructor"),u=t("../internals/get-built-in"),c=t("../internals/is-callable"),d=t("../internals/define-built-in"),h=l&&l.prototype;if(s({target:"Promise",proto:!0,forced:a,real:!0},{catch:function(m){return this.then(void 0,m)}}),!o&&c(l)){var f=u("Promise").prototype.catch;h.catch!==f&&d(h,"catch",f,{unsafe:!0})}},{"../internals/define-built-in":245,"../internals/export":259,"../internals/get-built-in":269,"../internals/is-callable":285,"../internals/is-pure":290,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325}],370:[function(t,n,i){var s,o,a,l=t("../internals/export"),u=t("../internals/is-pure"),c=t("../internals/engine-is-node"),d=t("../internals/global"),h=t("../internals/function-call"),f=t("../internals/define-built-in"),m=t("../internals/object-set-prototype-of"),p=t("../internals/set-to-string-tag"),g=t("../internals/set-species"),v=t("../internals/a-callable"),y=t("../internals/is-callable"),b=t("../internals/is-object"),E=t("../internals/an-instance"),A=t("../internals/species-constructor"),M=t("../internals/task").set,L=t("../internals/microtask"),k=t("../internals/host-report-errors"),P=t("../internals/perform"),U=t("../internals/queue"),$=t("../internals/internal-state"),V=t("../internals/promise-native-constructor"),R=t("../internals/promise-constructor-detection"),O=t("../internals/new-promise-capability"),T=R.CONSTRUCTOR,w=R.REJECTION_EVENT,x=R.SUBCLASSING,_=$.getterFor("Promise"),S=$.set,C=V&&V.prototype,F=V,D=C,H=d.TypeError,G=d.document,ee=d.process,B=O.f,X=B,I=!!(G&&G.createEvent&&d.dispatchEvent),N=function(ne){var le;return!(!b(ne)||!y(le=ne.then))&&le},j=function(ne,le){var ae,fe,pe,ye=le.value,xe=le.state===1,Ne=xe?ne.ok:ne.fail,Oe=ne.resolve,Me=ne.reject,qe=ne.domain;try{Ne?(xe||(le.rejection===2&&se(le),le.rejection=1),Ne===!0?ae=ye:(qe&&qe.enter(),ae=Ne(ye),qe&&(qe.exit(),pe=!0)),ae===ne.promise?Me(new H("Promise-chain cycle")):(fe=N(ae))?h(fe,ae,Oe,Me):Oe(ae)):Me(ye)}catch(We){qe&&!pe&&qe.exit(),Me(We)}},Q=function(ne,le){ne.notified||(ne.notified=!0,L((function(){for(var ae,fe=ne.reactions;ae=fe.get();)j(ae,ne);ne.notified=!1,le&&!ne.rejection&&Y(ne)})))},W=function(ne,le,ae){var fe,pe;I?((fe=G.createEvent("Event")).promise=le,fe.reason=ae,fe.initEvent(ne,!1,!0),d.dispatchEvent(fe)):fe={promise:le,reason:ae},!w&&(pe=d["on"+ne])?pe(fe):ne==="unhandledrejection"&&k("Unhandled promise rejection",ae)},Y=function(ne){h(M,d,(function(){var le,ae=ne.facade,fe=ne.value;if(Z(ne)&&(le=P((function(){c?ee.emit("unhandledRejection",fe,ae):W("unhandledrejection",ae,fe)})),ne.rejection=c||Z(ne)?2:1,le.error))throw le.value}))},Z=function(ne){return ne.rejection!==1&&!ne.parent},se=function(ne){h(M,d,(function(){var le=ne.facade;c?ee.emit("rejectionHandled",le):W("rejectionhandled",le,ne.value)}))},re=function(ne,le,ae){return function(fe){ne(le,fe,ae)}},K=function(ne,le,ae){ne.done||(ne.done=!0,ae&&(ne=ae),ne.value=le,ne.state=2,Q(ne,!0))},ie=function(ne,le,ae){if(!ne.done){ne.done=!0,ae&&(ne=ae);try{if(ne.facade===le)throw new H("Promise can't be resolved itself");var fe=N(le);fe?L((function(){var pe={done:!1};try{h(fe,le,re(ie,pe,ne),re(K,pe,ne))}catch(ye){K(pe,ye,ne)}})):(ne.value=le,ne.state=1,Q(ne,!1))}catch(pe){K({done:!1},pe,ne)}}};if(T&&(D=(F=function(ne){E(this,D),v(ne),h(s,this);var le=_(this);try{ne(re(ie,le),re(K,le))}catch(ae){K(le,ae)}}).prototype,(s=function(ne){S(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:new U,rejection:!1,state:0,value:void 0})}).prototype=f(D,"then",(function(ne,le){var ae=_(this),fe=B(A(this,F));return ae.parent=!0,fe.ok=!y(ne)||ne,fe.fail=y(le)&&le,fe.domain=c?ee.domain:void 0,ae.state===0?ae.reactions.add(fe):L((function(){j(fe,ae)})),fe.promise})),o=function(){var ne=new s,le=_(ne);this.promise=ne,this.resolve=re(ie,le),this.reject=re(K,le)},O.f=B=function(ne){return ne===F||ne===void 0?new o(ne):X(ne)},!u&&y(V)&&C!==Object.prototype)){a=C.then,x||f(C,"then",(function(ne,le){var ae=this;return new F((function(fe,pe){h(a,ae,fe,pe)})).then(ne,le)}),{unsafe:!0});try{delete C.constructor}catch{}m&&m(C,D)}l({global:!0,constructor:!0,wrap:!0,forced:T},{Promise:F}),p(F,"Promise",!1,!0),g("Promise")},{"../internals/a-callable":222,"../internals/an-instance":226,"../internals/define-built-in":245,"../internals/engine-is-node":254,"../internals/export":259,"../internals/function-call":264,"../internals/global":274,"../internals/host-report-errors":277,"../internals/internal-state":282,"../internals/is-callable":285,"../internals/is-object":289,"../internals/is-pure":290,"../internals/microtask":302,"../internals/new-promise-capability":303,"../internals/object-set-prototype-of":318,"../internals/perform":323,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325,"../internals/queue":328,"../internals/set-species":330,"../internals/set-to-string-tag":331,"../internals/species-constructor":335,"../internals/task":339}],371:[function(t,n,i){var s=t("../internals/export"),o=t("../internals/is-pure"),a=t("../internals/promise-native-constructor"),l=t("../internals/fails"),u=t("../internals/get-built-in"),c=t("../internals/is-callable"),d=t("../internals/species-constructor"),h=t("../internals/promise-resolve"),f=t("../internals/define-built-in"),m=a&&a.prototype;if(s({target:"Promise",proto:!0,real:!0,forced:!!a&&l((function(){m.finally.call({then:function(){}},(function(){}))}))},{finally:function(g){var v=d(this,u("Promise")),y=c(g);return this.then(y?function(b){return h(v,g()).then((function(){return b}))}:g,y?function(b){return h(v,g()).then((function(){throw b}))}:g)}}),!o&&c(a)){var p=u("Promise").prototype.finally;m.finally!==p&&f(m,"finally",p,{unsafe:!0})}},{"../internals/define-built-in":245,"../internals/export":259,"../internals/fails":260,"../internals/get-built-in":269,"../internals/is-callable":285,"../internals/is-pure":290,"../internals/promise-native-constructor":325,"../internals/promise-resolve":326,"../internals/species-constructor":335}],372:[function(t,n,i){t("../modules/es.promise.constructor"),t("../modules/es.promise.all"),t("../modules/es.promise.catch"),t("../modules/es.promise.race"),t("../modules/es.promise.reject"),t("../modules/es.promise.resolve")},{"../modules/es.promise.all":368,"../modules/es.promise.catch":369,"../modules/es.promise.constructor":370,"../modules/es.promise.race":373,"../modules/es.promise.reject":374,"../modules/es.promise.resolve":375}],373:[function(t,n,i){var s=t("../internals/export"),o=t("../internals/function-call"),a=t("../internals/a-callable"),l=t("../internals/new-promise-capability"),u=t("../internals/perform"),c=t("../internals/iterate");s({target:"Promise",stat:!0,forced:t("../internals/promise-statics-incorrect-iteration")},{race:function(d){var h=this,f=l.f(h),m=f.reject,p=u((function(){var g=a(h.resolve);c(d,(function(v){o(g,h,v).then(f.resolve,m)}))}));return p.error&&m(p.value),f.promise}})},{"../internals/a-callable":222,"../internals/export":259,"../internals/function-call":264,"../internals/iterate":293,"../internals/new-promise-capability":303,"../internals/perform":323,"../internals/promise-statics-incorrect-iteration":327}],374:[function(t,n,i){var s=t("../internals/export"),o=t("../internals/function-call"),a=t("../internals/new-promise-capability");s({target:"Promise",stat:!0,forced:t("../internals/promise-constructor-detection").CONSTRUCTOR},{reject:function(l){var u=a.f(this);return o(u.reject,void 0,l),u.promise}})},{"../internals/export":259,"../internals/function-call":264,"../internals/new-promise-capability":303,"../internals/promise-constructor-detection":324}],375:[function(t,n,i){var s=t("../internals/export"),o=t("../internals/get-built-in"),a=t("../internals/is-pure"),l=t("../internals/promise-native-constructor"),u=t("../internals/promise-constructor-detection").CONSTRUCTOR,c=t("../internals/promise-resolve"),d=o("Promise"),h=a&&!u;s({target:"Promise",stat:!0,forced:a||u},{resolve:function(f){return c(h&&this===d?l:this,f)}})},{"../internals/export":259,"../internals/get-built-in":269,"../internals/is-pure":290,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325,"../internals/promise-resolve":326}],376:[function(t,n,i){var s=t("../internals/export"),o=t("../internals/function-uncurry-this"),a=t("../internals/to-absolute-index"),l=RangeError,u=String.fromCharCode,c=String.fromCodePoint,d=o([].join);s({target:"String",stat:!0,arity:1,forced:!!c&&c.length!==1},{fromCodePoint:function(h){for(var f,m=[],p=arguments.length,g=0;p>g;){if(f=+arguments[g++],a(f,1114111)!==f)throw new l(f+" is not a valid code point");m[g]=f<65536?u(f):u(55296+((f-=65536)>>10),f%1024+56320)}return d(m,"")}})},{"../internals/export":259,"../internals/function-uncurry-this":268,"../internals/to-absolute-index":340}],377:[function(t,n,i){var s=t("../internals/export"),o=t("../internals/function-uncurry-this"),a=t("../internals/not-a-regexp"),l=t("../internals/require-object-coercible"),u=t("../internals/to-string"),c=t("../internals/correct-is-regexp-logic"),d=o("".indexOf);s({target:"String",proto:!0,forced:!c("includes")},{includes:function(h){return!!~d(u(l(this)),u(a(h)),arguments.length>1?arguments[1]:void 0)}})},{"../internals/correct-is-regexp-logic":238,"../internals/export":259,"../internals/function-uncurry-this":268,"../internals/not-a-regexp":304,"../internals/require-object-coercible":329,"../internals/to-string":348}],378:[function(t,n,i){t("../internals/well-known-symbol-define")("asyncIterator")},{"../internals/well-known-symbol-define":355}],379:[function(t,n,i){var s=t("../internals/export"),o=t("../internals/global"),a=t("../internals/function-call"),l=t("../internals/function-uncurry-this"),u=t("../internals/is-pure"),c=t("../internals/descriptors"),d=t("../internals/symbol-constructor-detection"),h=t("../internals/fails"),f=t("../internals/has-own-property"),m=t("../internals/object-is-prototype-of"),p=t("../internals/an-object"),g=t("../internals/to-indexed-object"),v=t("../internals/to-property-key"),y=t("../internals/to-string"),b=t("../internals/create-property-descriptor"),E=t("../internals/object-create"),A=t("../internals/object-keys"),M=t("../internals/object-get-own-property-names"),L=t("../internals/object-get-own-property-names-external"),k=t("../internals/object-get-own-property-symbols"),P=t("../internals/object-get-own-property-descriptor"),U=t("../internals/object-define-property"),$=t("../internals/object-define-properties"),V=t("../internals/object-property-is-enumerable"),R=t("../internals/define-built-in"),O=t("../internals/define-built-in-accessor"),T=t("../internals/shared"),w=t("../internals/shared-key"),x=t("../internals/hidden-keys"),_=t("../internals/uid"),S=t("../internals/well-known-symbol"),C=t("../internals/well-known-symbol-wrapped"),F=t("../internals/well-known-symbol-define"),D=t("../internals/symbol-define-to-primitive"),H=t("../internals/set-to-string-tag"),G=t("../internals/internal-state"),ee=t("../internals/array-iteration").forEach,B=w("hidden"),X=G.set,I=G.getterFor("Symbol"),N=Object.prototype,j=o.Symbol,Q=j&&j.prototype,W=o.RangeError,Y=o.TypeError,Z=o.QObject,se=P.f,re=U.f,K=L.f,ie=V.f,ne=l([].push),le=T("symbols"),ae=T("op-symbols"),fe=T("wks"),pe=!Z||!Z.prototype||!Z.prototype.findChild,ye=function(Ve,Pe,Le){var Ye=se(N,Pe);Ye&&delete N[Pe],re(Ve,Pe,Le),Ye&&Ve!==N&&re(N,Pe,Ye)},xe=c&&h((function(){return E(re({},"a",{get:function(){return re(this,"a",{value:7}).a}})).a!==7}))?ye:re,Ne=function(Ve,Pe){var Le=le[Ve]=E(Q);return X(Le,{type:"Symbol",tag:Ve,description:Pe}),c||(Le.description=Pe),Le},Oe=function(Ve,Pe,Le){Ve===N&&Oe(ae,Pe,Le),p(Ve);var Ye=v(Pe);return p(Le),f(le,Ye)?(Le.enumerable?(f(Ve,B)&&Ve[B][Ye]&&(Ve[B][Ye]=!1),Le=E(Le,{enumerable:b(0,!1)})):(f(Ve,B)||re(Ve,B,b(1,{})),Ve[B][Ye]=!0),xe(Ve,Ye,Le)):re(Ve,Ye,Le)},Me=function(Ve,Pe){p(Ve);var Le=g(Pe),Ye=A(Le).concat(Je(Le));return ee(Ye,(function(Ze){c&&!a(qe,Le,Ze)||Oe(Ve,Ze,Le[Ze])})),Ve},qe=function(Ve){var Pe=v(Ve),Le=a(ie,this,Pe);return!(this===N&&f(le,Pe)&&!f(ae,Pe))&&(!(Le||!f(this,Pe)||!f(le,Pe)||f(this,B)&&this[B][Pe])||Le)},We=function(Ve,Pe){var Le=g(Ve),Ye=v(Pe);if(Le!==N||!f(le,Ye)||f(ae,Ye)){var Ze=se(Le,Ye);return!Ze||!f(le,Ye)||f(Le,B)&&Le[B][Ye]||(Ze.enumerable=!0),Ze}},Ke=function(Ve){var Pe=K(g(Ve)),Le=[];return ee(Pe,(function(Ye){f(le,Ye)||f(x,Ye)||ne(Le,Ye)})),Le},Je=function(Ve){var Pe=Ve===N,Le=K(Pe?ae:g(Ve)),Ye=[];return ee(Le,(function(Ze){!f(le,Ze)||Pe&&!f(N,Ze)||ne(Ye,le[Ze])})),Ye};d||(R(Q=(j=function(){if(m(Q,this))throw new Y("Symbol is not a constructor");var Ve=arguments.length&&arguments[0]!==void 0?y(arguments[0]):void 0,Pe=_(Ve),Le=function(Ye){this===N&&a(Le,ae,Ye),f(this,B)&&f(this[B],Pe)&&(this[B][Pe]=!1);var Ze=b(1,Ye);try{xe(this,Pe,Ze)}catch(Ft){if(!(Ft instanceof W))throw Ft;ye(this,Pe,Ze)}};return c&&pe&&xe(N,Pe,{configurable:!0,set:Le}),Ne(Pe,Ve)}).prototype,"toString",(function(){return I(this).tag})),R(j,"withoutSetter",(function(Ve){return Ne(_(Ve),Ve)})),V.f=qe,U.f=Oe,$.f=Me,P.f=We,M.f=L.f=Ke,k.f=Je,C.f=function(Ve){return Ne(S(Ve),Ve)},c&&(O(Q,"description",{configurable:!0,get:function(){return I(this).description}}),u||R(N,"propertyIsEnumerable",qe,{unsafe:!0}))),s({global:!0,constructor:!0,wrap:!0,forced:!d,sham:!d},{Symbol:j}),ee(A(fe),(function(Ve){F(Ve)})),s({target:"Symbol",stat:!0,forced:!d},{useSetter:function(){pe=!0},useSimple:function(){pe=!1}}),s({target:"Object",stat:!0,forced:!d,sham:!c},{create:function(Ve,Pe){return Pe===void 0?E(Ve):Me(E(Ve),Pe)},defineProperty:Oe,defineProperties:Me,getOwnPropertyDescriptor:We}),s({target:"Object",stat:!0,forced:!d},{getOwnPropertyNames:Ke}),D(),H(j,"Symbol"),x[B]=!0},{"../internals/an-object":227,"../internals/array-iteration":229,"../internals/create-property-descriptor":242,"../internals/define-built-in":245,"../internals/define-built-in-accessor":244,"../internals/descriptors":247,"../internals/export":259,"../internals/fails":260,"../internals/function-call":264,"../internals/function-uncurry-this":268,"../internals/global":274,"../internals/has-own-property":275,"../internals/hidden-keys":276,"../internals/internal-state":282,"../internals/is-pure":290,"../internals/object-create":306,"../internals/object-define-properties":307,"../internals/object-define-property":308,"../internals/object-get-own-property-descriptor":309,"../internals/object-get-own-property-names":311,"../internals/object-get-own-property-names-external":310,"../internals/object-get-own-property-symbols":312,"../internals/object-is-prototype-of":314,"../internals/object-keys":316,"../internals/object-property-is-enumerable":317,"../internals/set-to-string-tag":331,"../internals/shared":334,"../internals/shared-key":332,"../internals/symbol-constructor-detection":336,"../internals/symbol-define-to-primitive":337,"../internals/to-indexed-object":341,"../internals/to-property-key":346,"../internals/to-string":348,"../internals/uid":350,"../internals/well-known-symbol":357,"../internals/well-known-symbol-define":355,"../internals/well-known-symbol-wrapped":356}],380:[function(t,n,i){var s=t("../internals/export"),o=t("../internals/get-built-in"),a=t("../internals/has-own-property"),l=t("../internals/to-string"),u=t("../internals/shared"),c=t("../internals/symbol-registry-detection"),d=u("string-to-symbol-registry"),h=u("symbol-to-string-registry");s({target:"Symbol",stat:!0,forced:!c},{for:function(f){var m=l(f);if(a(d,m))return d[m];var p=o("Symbol")(m);return d[m]=p,h[p]=m,p}})},{"../internals/export":259,"../internals/get-built-in":269,"../internals/has-own-property":275,"../internals/shared":334,"../internals/symbol-registry-detection":338,"../internals/to-string":348}],381:[function(t,n,i){t("../modules/es.symbol.constructor"),t("../modules/es.symbol.for"),t("../modules/es.symbol.key-for"),t("../modules/es.json.stringify"),t("../modules/es.object.get-own-property-symbols")},{"../modules/es.json.stringify":362,"../modules/es.object.get-own-property-symbols":365,"../modules/es.symbol.constructor":379,"../modules/es.symbol.for":380,"../modules/es.symbol.key-for":382}],382:[function(t,n,i){var s=t("../internals/export"),o=t("../internals/has-own-property"),a=t("../internals/is-symbol"),l=t("../internals/try-to-string"),u=t("../internals/shared"),c=t("../internals/symbol-registry-detection"),d=u("symbol-to-string-registry");s({target:"Symbol",stat:!0,forced:!c},{keyFor:function(h){if(!a(h))throw new TypeError(l(h)+" is not a symbol");if(o(d,h))return d[h]}})},{"../internals/export":259,"../internals/has-own-property":275,"../internals/is-symbol":292,"../internals/shared":334,"../internals/symbol-registry-detection":338,"../internals/try-to-string":349}],383:[function(t,n,i){function s(o){return Object.prototype.toString.call(o)}i.isArray=function(o){return Array.isArray?Array.isArray(o):s(o)==="[object Array]"},i.isBoolean=function(o){return typeof o=="boolean"},i.isNull=function(o){return o===null},i.isNullOrUndefined=function(o){return o==null},i.isNumber=function(o){return typeof o=="number"},i.isString=function(o){return typeof o=="string"},i.isSymbol=function(o){return typeof o=="symbol"},i.isUndefined=function(o){return o===void 0},i.isRegExp=function(o){return s(o)==="[object RegExp]"},i.isObject=function(o){return typeof o=="object"&&o!==null},i.isDate=function(o){return s(o)==="[object Date]"},i.isError=function(o){return s(o)==="[object Error]"||o instanceof Error},i.isFunction=function(o){return typeof o=="function"},i.isPrimitive=function(o){return o===null||typeof o=="boolean"||typeof o=="number"||typeof o=="string"||typeof o=="symbol"||o===void 0},i.isBuffer=t("buffer").Buffer.isBuffer},{buffer:220}],384:[function(t,n,i){(function(s){(function(){var o=t("elliptic"),a=t("bn.js");n.exports=function(d){return new u(d)};var l={secp256k1:{name:"secp256k1",byteLength:32},secp224r1:{name:"p224",byteLength:28},prime256v1:{name:"p256",byteLength:32},prime192v1:{name:"p192",byteLength:24},ed25519:{name:"ed25519",byteLength:32},secp384r1:{name:"p384",byteLength:48},secp521r1:{name:"p521",byteLength:66}};function u(d){this.curveType=l[d],this.curveType||(this.curveType={name:d}),this.curve=new o.ec(this.curveType.name),this.keys=void 0}function c(d,h,f){Array.isArray(d)||(d=d.toArray());var m=new s(d);if(f&&m.length<f){var p=new s(f-m.length);p.fill(0),m=s.concat([p,m])}return h?m.toString(h):m}l.p224=l.secp224r1,l.p256=l.secp256r1=l.prime256v1,l.p192=l.secp192r1=l.prime192v1,l.p384=l.secp384r1,l.p521=l.secp521r1,u.prototype.generateKeys=function(d,h){return this.keys=this.curve.genKeyPair(),this.getPublicKey(d,h)},u.prototype.computeSecret=function(d,h,f){return h=h||"utf8",s.isBuffer(d)||(d=new s(d,h)),c(this.curve.keyFromPublic(d).getPublic().mul(this.keys.getPrivate()).getX(),f,this.curveType.byteLength)},u.prototype.getPublicKey=function(d,h){var f=this.keys.getPublic(h==="compressed",!0);return h==="hybrid"&&(f[f.length-1]%2?f[0]=7:f[0]=6),c(f,d)},u.prototype.getPrivateKey=function(d){return c(this.keys.getPrivate(),d)},u.prototype.setPublicKey=function(d,h){return h=h||"utf8",s.isBuffer(d)||(d=new s(d,h)),this.keys._importPublic(d),this},u.prototype.setPrivateKey=function(d,h){h=h||"utf8",s.isBuffer(d)||(d=new s(d,h));var f=new a(d);return f=f.toString(16),this.keys=this.curve.genKeyPair(),this.keys._importPrivate(f),this}}).call(this)}).call(this,t("buffer").Buffer)},{"bn.js":385,buffer:220,elliptic:405}],385:[function(t,n,i){arguments[4][184][0].apply(i,arguments)},{buffer:188,dup:184}],386:[function(t,n,i){var s=t("inherits"),o=t("md5.js"),a=t("ripemd160"),l=t("sha.js"),u=t("cipher-base");function c(d){u.call(this,"digest"),this._hash=d}s(c,u),c.prototype._update=function(d){this._hash.update(d)},c.prototype._final=function(){return this._hash.digest()},n.exports=function(d){return(d=d.toLowerCase())==="md5"?new o:d==="rmd160"||d==="ripemd160"?new a:new c(l(d))}},{"cipher-base":221,inherits:440,"md5.js":450,ripemd160:493,"sha.js":498}],387:[function(t,n,i){var s=t("md5.js");n.exports=function(o){return new s().update(o).digest()}},{"md5.js":450}],388:[function(t,n,i){var s=t("inherits"),o=t("./legacy"),a=t("cipher-base"),l=t("safe-buffer").Buffer,u=t("create-hash/md5"),c=t("ripemd160"),d=t("sha.js"),h=l.alloc(128);function f(m,p){a.call(this,"digest"),typeof p=="string"&&(p=l.from(p));var g=m==="sha512"||m==="sha384"?128:64;this._alg=m,this._key=p,p.length>g?p=(m==="rmd160"?new c:d(m)).update(p).digest():p.length<g&&(p=l.concat([p,h],g));for(var v=this._ipad=l.allocUnsafe(g),y=this._opad=l.allocUnsafe(g),b=0;b<g;b++)v[b]=54^p[b],y[b]=92^p[b];this._hash=m==="rmd160"?new c:d(m),this._hash.update(v)}s(f,a),f.prototype._update=function(m){this._hash.update(m)},f.prototype._final=function(){var m=this._hash.digest();return(this._alg==="rmd160"?new c:d(this._alg)).update(this._opad).update(m).digest()},n.exports=function(m,p){return(m=m.toLowerCase())==="rmd160"||m==="ripemd160"?new f("rmd160",p):m==="md5"?new o(u,p):new f(m,p)}},{"./legacy":389,"cipher-base":221,"create-hash/md5":387,inherits:440,ripemd160:493,"safe-buffer":494,"sha.js":498}],389:[function(t,n,i){var s=t("inherits"),o=t("safe-buffer").Buffer,a=t("cipher-base"),l=o.alloc(128);function u(c,d){a.call(this,"digest"),typeof d=="string"&&(d=o.from(d)),this._alg=c,this._key=d,d.length>64?d=c(d):d.length<64&&(d=o.concat([d,l],64));for(var h=this._ipad=o.allocUnsafe(64),f=this._opad=o.allocUnsafe(64),m=0;m<64;m++)h[m]=54^d[m],f[m]=92^d[m];this._hash=[h]}s(u,a),u.prototype._update=function(c){this._hash.push(c)},u.prototype._final=function(){var c=this._alg(o.concat(this._hash));return this._alg(o.concat([this._opad,c]))},n.exports=u},{"cipher-base":221,inherits:440,"safe-buffer":494}],390:[function(t,n,i){i.randomBytes=i.rng=i.pseudoRandomBytes=i.prng=t("randombytes"),i.createHash=i.Hash=t("create-hash"),i.createHmac=i.Hmac=t("create-hmac");var s=t("browserify-sign/algos"),o=Object.keys(s),a=["sha1","sha224","sha256","sha384","sha512","md5","rmd160"].concat(o);i.getHashes=function(){return a};var l=t("pbkdf2");i.pbkdf2=l.pbkdf2,i.pbkdf2Sync=l.pbkdf2Sync;var u=t("browserify-cipher");i.Cipher=u.Cipher,i.createCipher=u.createCipher,i.Cipheriv=u.Cipheriv,i.createCipheriv=u.createCipheriv,i.Decipher=u.Decipher,i.createDecipher=u.createDecipher,i.Decipheriv=u.Decipheriv,i.createDecipheriv=u.createDecipheriv,i.getCiphers=u.getCiphers,i.listCiphers=u.listCiphers;var c=t("diffie-hellman");i.DiffieHellmanGroup=c.DiffieHellmanGroup,i.createDiffieHellmanGroup=c.createDiffieHellmanGroup,i.getDiffieHellman=c.getDiffieHellman,i.createDiffieHellman=c.createDiffieHellman,i.DiffieHellman=c.DiffieHellman;var d=t("browserify-sign");i.createSign=d.createSign,i.Sign=d.Sign,i.createVerify=d.createVerify,i.Verify=d.Verify,i.createECDH=t("create-ecdh");var h=t("public-encrypt");i.publicEncrypt=h.publicEncrypt,i.privateEncrypt=h.privateEncrypt,i.publicDecrypt=h.publicDecrypt,i.privateDecrypt=h.privateDecrypt;var f=t("randomfill");i.randomFill=f.randomFill,i.randomFillSync=f.randomFillSync,i.createCredentials=function(){throw new Error(["sorry, createCredentials is not implemented yet","we accept pull requests","https://github.com/crypto-browserify/crypto-browserify"].join(`
`))},i.constants={DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,NPN_ENABLED:1,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6}},{"browserify-cipher":206,"browserify-sign":213,"browserify-sign/algos":210,"create-ecdh":384,"create-hash":386,"create-hmac":388,"diffie-hellman":400,pbkdf2:460,"public-encrypt":468,randombytes:475,randomfill:476}],391:[function(t,n,i){(function(s,o){typeof i=="object"&&n!==void 0?n.exports=o():(s=typeof globalThis<"u"?globalThis:s||self).dayjs=o()})(void 0,(function(){var s=6e4,o=36e5,a="millisecond",l="second",u="minute",c="hour",d="day",h="week",f="month",m="quarter",p="year",g="date",v="Invalid Date",y=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,b=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,E={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(w){var x=["th","st","nd","rd"],_=w%100;return"["+w+(x[(_-20)%10]||x[_]||x[0])+"]"}},A=function(w,x,_){var S=String(w);return!S||S.length>=x?w:""+Array(x+1-S.length).join(_)+w},M={s:A,z:function(w){var x=-w.utcOffset(),_=Math.abs(x),S=Math.floor(_/60),C=_%60;return(x<=0?"+":"-")+A(S,2,"0")+":"+A(C,2,"0")},m:function w(x,_){if(x.date()<_.date())return-w(_,x);var S=12*(_.year()-x.year())+(_.month()-x.month()),C=x.clone().add(S,f),F=_-C<0,D=x.clone().add(S+(F?-1:1),f);return+(-(S+(_-C)/(F?C-D:D-C))||0)},a:function(w){return w<0?Math.ceil(w)||0:Math.floor(w)},p:function(w){return{M:f,y:p,w:h,d,D:g,h:c,m:u,s:l,ms:a,Q:m}[w]||String(w||"").toLowerCase().replace(/s$/,"")},u:function(w){return w===void 0}},L="en",k={};k[L]=E;var P="$isDayjsObject",U=function(w){return w instanceof O||!(!w||!w[P])},$=function w(x,_,S){var C;if(!x)return L;if(typeof x=="string"){var F=x.toLowerCase();k[F]&&(C=F),_&&(k[F]=_,C=F);var D=x.split("-");if(!C&&D.length>1)return w(D[0])}else{var H=x.name;k[H]=x,C=H}return!S&&C&&(L=C),C||!S&&L},V=function(w,x){if(U(w))return w.clone();var _=typeof x=="object"?x:{};return _.date=w,_.args=arguments,new O(_)},R=M;R.l=$,R.i=U,R.w=function(w,x){return V(w,{locale:x.$L,utc:x.$u,x:x.$x,$offset:x.$offset})};var O=(function(){function w(_){this.$L=$(_.locale,null,!0),this.parse(_),this.$x=this.$x||_.x||{},this[P]=!0}var x=w.prototype;return x.parse=function(_){this.$d=(function(S){var C=S.date,F=S.utc;if(C===null)return new Date(NaN);if(R.u(C))return new Date;if(C instanceof Date)return new Date(C);if(typeof C=="string"&&!/Z$/i.test(C)){var D=C.match(y);if(D){var H=D[2]-1||0,G=(D[7]||"0").substring(0,3);return F?new Date(Date.UTC(D[1],H,D[3]||1,D[4]||0,D[5]||0,D[6]||0,G)):new Date(D[1],H,D[3]||1,D[4]||0,D[5]||0,D[6]||0,G)}}return new Date(C)})(_),this.init()},x.init=function(){var _=this.$d;this.$y=_.getFullYear(),this.$M=_.getMonth(),this.$D=_.getDate(),this.$W=_.getDay(),this.$H=_.getHours(),this.$m=_.getMinutes(),this.$s=_.getSeconds(),this.$ms=_.getMilliseconds()},x.$utils=function(){return R},x.isValid=function(){return this.$d.toString()!==v},x.isSame=function(_,S){var C=V(_);return this.startOf(S)<=C&&C<=this.endOf(S)},x.isAfter=function(_,S){return V(_)<this.startOf(S)},x.isBefore=function(_,S){return this.endOf(S)<V(_)},x.$g=function(_,S,C){return R.u(_)?this[S]:this.set(C,_)},x.unix=function(){return Math.floor(this.valueOf()/1e3)},x.valueOf=function(){return this.$d.getTime()},x.startOf=function(_,S){var C=this,F=!!R.u(S)||S,D=R.p(_),H=function(Q,W){var Y=R.w(C.$u?Date.UTC(C.$y,W,Q):new Date(C.$y,W,Q),C);return F?Y:Y.endOf(d)},G=function(Q,W){return R.w(C.toDate()[Q].apply(C.toDate("s"),(F?[0,0,0,0]:[23,59,59,999]).slice(W)),C)},ee=this.$W,B=this.$M,X=this.$D,I="set"+(this.$u?"UTC":"");switch(D){case p:return F?H(1,0):H(31,11);case f:return F?H(1,B):H(0,B+1);case h:var N=this.$locale().weekStart||0,j=(ee<N?ee+7:ee)-N;return H(F?X-j:X+(6-j),B);case d:case g:return G(I+"Hours",0);case c:return G(I+"Minutes",1);case u:return G(I+"Seconds",2);case l:return G(I+"Milliseconds",3);default:return this.clone()}},x.endOf=function(_){return this.startOf(_,!1)},x.$set=function(_,S){var C,F=R.p(_),D="set"+(this.$u?"UTC":""),H=(C={},C[d]=D+"Date",C[g]=D+"Date",C[f]=D+"Month",C[p]=D+"FullYear",C[c]=D+"Hours",C[u]=D+"Minutes",C[l]=D+"Seconds",C[a]=D+"Milliseconds",C)[F],G=F===d?this.$D+(S-this.$W):S;if(F===f||F===p){var ee=this.clone().set(g,1);ee.$d[H](G),ee.init(),this.$d=ee.set(g,Math.min(this.$D,ee.daysInMonth())).$d}else H&&this.$d[H](G);return this.init(),this},x.set=function(_,S){return this.clone().$set(_,S)},x.get=function(_){return this[R.p(_)]()},x.add=function(_,S){var C,F=this;_=Number(_);var D=R.p(S),H=function(B){var X=V(F);return R.w(X.date(X.date()+Math.round(B*_)),F)};if(D===f)return this.set(f,this.$M+_);if(D===p)return this.set(p,this.$y+_);if(D===d)return H(1);if(D===h)return H(7);var G=(C={},C[u]=s,C[c]=o,C[l]=1e3,C)[D]||1,ee=this.$d.getTime()+_*G;return R.w(ee,this)},x.subtract=function(_,S){return this.add(-1*_,S)},x.format=function(_){var S=this,C=this.$locale();if(!this.isValid())return C.invalidDate||v;var F=_||"YYYY-MM-DDTHH:mm:ssZ",D=R.z(this),H=this.$H,G=this.$m,ee=this.$M,B=C.weekdays,X=C.months,I=C.meridiem,N=function(W,Y,Z,se){return W&&(W[Y]||W(S,F))||Z[Y].slice(0,se)},j=function(W){return R.s(H%12||12,W,"0")},Q=I||function(W,Y,Z){var se=W<12?"AM":"PM";return Z?se.toLowerCase():se};return F.replace(b,(function(W,Y){return Y||(function(Z){switch(Z){case"YY":return String(S.$y).slice(-2);case"YYYY":return R.s(S.$y,4,"0");case"M":return ee+1;case"MM":return R.s(ee+1,2,"0");case"MMM":return N(C.monthsShort,ee,X,3);case"MMMM":return N(X,ee);case"D":return S.$D;case"DD":return R.s(S.$D,2,"0");case"d":return String(S.$W);case"dd":return N(C.weekdaysMin,S.$W,B,2);case"ddd":return N(C.weekdaysShort,S.$W,B,3);case"dddd":return B[S.$W];case"H":return String(H);case"HH":return R.s(H,2,"0");case"h":return j(1);case"hh":return j(2);case"a":return Q(H,G,!0);case"A":return Q(H,G,!1);case"m":return String(G);case"mm":return R.s(G,2,"0");case"s":return String(S.$s);case"ss":return R.s(S.$s,2,"0");case"SSS":return R.s(S.$ms,3,"0");case"Z":return D}return null})(W)||D.replace(":","")}))},x.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},x.diff=function(_,S,C){var F,D=this,H=R.p(S),G=V(_),ee=(G.utcOffset()-this.utcOffset())*s,B=this-G,X=function(){return R.m(D,G)};switch(H){case p:F=X()/12;break;case f:F=X();break;case m:F=X()/3;break;case h:F=(B-ee)/6048e5;break;case d:F=(B-ee)/864e5;break;case c:F=B/o;break;case u:F=B/s;break;case l:F=B/1e3;break;default:F=B}return C?F:R.a(F)},x.daysInMonth=function(){return this.endOf(f).$D},x.$locale=function(){return k[this.$L]},x.locale=function(_,S){if(!_)return this.$L;var C=this.clone(),F=$(_,S,!0);return F&&(C.$L=F),C},x.clone=function(){return R.w(this.$d,this)},x.toDate=function(){return new Date(this.valueOf())},x.toJSON=function(){return this.isValid()?this.toISOString():null},x.toISOString=function(){return this.$d.toISOString()},x.toString=function(){return this.$d.toUTCString()},w})(),T=O.prototype;return V.prototype=T,[["$ms",a],["$s",l],["$m",u],["$H",c],["$W",d],["$M",f],["$y",p],["$D",g]].forEach((function(w){T[w[1]]=function(x){return this.$g(x,w[0],w[1])}})),V.extend=function(w,x){return w.$i||(w(x,O,V),w.$i=!0),V},V.locale=$,V.isDayjs=U,V.unix=function(w){return V(1e3*w)},V.en=k[L],V.Ls=k,V.p={},V}))},{}],392:[function(t,n,i){(function(s,o){typeof i=="object"&&n!==void 0?n.exports=o():(s=typeof globalThis<"u"?globalThis:s||self).dayjs_plugin_customParseFormat=o()})(void 0,(function(){var s={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},o=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,a=/\d\d/,l=/\d\d?/,u=/\d*[^-_:/,()\s\d]+/,c={},d=function(y){return(y=+y)+(y>68?1900:2e3)},h=function(y){return function(b){this[y]=+b}},f=[/[+-]\d\d:?(\d\d)?|Z/,function(y){(this.zone||(this.zone={})).offset=(function(b){if(!b||b==="Z")return 0;var E=b.match(/([+-]|\d\d)/g),A=60*E[1]+(+E[2]||0);return A===0?0:E[0]==="+"?-A:A})(y)}],m=function(y){var b=c[y];return b&&(b.indexOf?b:b.s.concat(b.f))},p=function(y,b){var E,A=c.meridiem;if(A){for(var M=1;M<=24;M+=1)if(y.indexOf(A(M,0,b))>-1){E=M>12;break}}else E=y===(b?"pm":"PM");return E},g={A:[u,function(y){this.afternoon=p(y,!1)}],a:[u,function(y){this.afternoon=p(y,!0)}],S:[/\d/,function(y){this.milliseconds=100*+y}],SS:[a,function(y){this.milliseconds=10*+y}],SSS:[/\d{3}/,function(y){this.milliseconds=+y}],s:[l,h("seconds")],ss:[l,h("seconds")],m:[l,h("minutes")],mm:[l,h("minutes")],H:[l,h("hours")],h:[l,h("hours")],HH:[l,h("hours")],hh:[l,h("hours")],D:[l,h("day")],DD:[a,h("day")],Do:[u,function(y){var b=c.ordinal,E=y.match(/\d+/);if(this.day=E[0],b)for(var A=1;A<=31;A+=1)b(A).replace(/\[|\]/g,"")===y&&(this.day=A)}],M:[l,h("month")],MM:[a,h("month")],MMM:[u,function(y){var b=m("months"),E=(m("monthsShort")||b.map((function(A){return A.slice(0,3)}))).indexOf(y)+1;if(E<1)throw new Error;this.month=E%12||E}],MMMM:[u,function(y){var b=m("months").indexOf(y)+1;if(b<1)throw new Error;this.month=b%12||b}],Y:[/[+-]?\d+/,h("year")],YY:[a,function(y){this.year=d(y)}],YYYY:[/\d{4}/,h("year")],Z:f,ZZ:f};function v(y){var b,E;b=y,E=c&&c.formats;for(var A=(y=b.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,(function(V,R,O){var T=O&&O.toUpperCase();return R||E[O]||s[O]||E[T].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(w,x,_){return x||_.slice(1)}))}))).match(o),M=A.length,L=0;L<M;L+=1){var k=A[L],P=g[k],U=P&&P[0],$=P&&P[1];A[L]=$?{regex:U,parser:$}:k.replace(/^\[|\]$/g,"")}return function(V){for(var R={},O=0,T=0;O<M;O+=1){var w=A[O];if(typeof w=="string")T+=w.length;else{var x=w.regex,_=w.parser,S=V.slice(T),C=x.exec(S)[0];_.call(R,C),V=V.replace(C,"")}}return(function(F){var D=F.afternoon;if(D!==void 0){var H=F.hours;D?H<12&&(F.hours+=12):H===12&&(F.hours=0),delete F.afternoon}})(R),R}}return function(y,b,E){E.p.customParseFormat=!0,y&&y.parseTwoDigitYear&&(d=y.parseTwoDigitYear);var A=b.prototype,M=A.parse;A.parse=function(L){var k=L.date,P=L.utc,U=L.args;this.$u=P;var $=U[1];if(typeof $=="string"){var V=U[2]===!0,R=U[3]===!0,O=V||R,T=U[2];R&&(T=U[2]),c=this.$locale(),!V&&T&&(c=E.Ls[T]),this.$d=(function(S,C,F){try{if(["x","X"].indexOf(C)>-1)return new Date((C==="X"?1e3:1)*S);var D=v(C)(S),H=D.year,G=D.month,ee=D.day,B=D.hours,X=D.minutes,I=D.seconds,N=D.milliseconds,j=D.zone,Q=new Date,W=ee||(H||G?1:Q.getDate()),Y=H||Q.getFullYear(),Z=0;H&&!G||(Z=G>0?G-1:Q.getMonth());var se=B||0,re=X||0,K=I||0,ie=N||0;return j?new Date(Date.UTC(Y,Z,W,se,re,K,ie+60*j.offset*1e3)):F?new Date(Date.UTC(Y,Z,W,se,re,K,ie)):new Date(Y,Z,W,se,re,K,ie)}catch{return new Date("")}})(k,$,P),this.init(),T&&T!==!0&&(this.$L=this.locale(T).$L),O&&k!=this.format($)&&(this.$d=new Date("")),c={}}else if($ instanceof Array)for(var w=$.length,x=1;x<=w;x+=1){U[1]=$[x-1];var _=E.apply(this,U);if(_.isValid()){this.$d=_.$d,this.$L=_.$L,this.init();break}x===w&&(this.$d=new Date(""))}else M.call(this,L)}}}))},{}],393:[function(t,n,i){(function(s,o){typeof i=="object"&&n!==void 0?n.exports=o():(s=typeof globalThis<"u"?globalThis:s||self).dayjs_plugin_utc=o()})(void 0,(function(){var s="minute",o=/[+-]\d\d(?::?\d\d)?/g,a=/([+-]|\d\d)/g;return function(l,u,c){var d=u.prototype;c.utc=function(y){var b={date:y,utc:!0,args:arguments};return new u(b)},d.utc=function(y){var b=c(this.toDate(),{locale:this.$L,utc:!0});return y?b.add(this.utcOffset(),s):b},d.local=function(){return c(this.toDate(),{locale:this.$L,utc:!1})};var h=d.parse;d.parse=function(y){y.utc&&(this.$u=!0),this.$utils().u(y.$offset)||(this.$offset=y.$offset),h.call(this,y)};var f=d.init;d.init=function(){if(this.$u){var y=this.$d;this.$y=y.getUTCFullYear(),this.$M=y.getUTCMonth(),this.$D=y.getUTCDate(),this.$W=y.getUTCDay(),this.$H=y.getUTCHours(),this.$m=y.getUTCMinutes(),this.$s=y.getUTCSeconds(),this.$ms=y.getUTCMilliseconds()}else f.call(this)};var m=d.utcOffset;d.utcOffset=function(y,b){var E=this.$utils().u;if(E(y))return this.$u?0:E(this.$offset)?m.call(this):this.$offset;if(typeof y=="string"&&(y=(function(k){k===void 0&&(k="");var P=k.match(o);if(!P)return null;var U=(""+P[0]).match(a)||["-",0,0],$=U[0],V=60*+U[1]+ +U[2];return V===0?0:$==="+"?V:-V})(y))===null)return this;var A=Math.abs(y)<=16?60*y:y,M=this;if(b)return M.$offset=A,M.$u=y===0,M;if(y!==0){var L=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(M=this.local().add(A+L,s)).$offset=A,M.$x.$localOffset=L}else M=this.utc();return M};var p=d.format;d.format=function(y){var b=y||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return p.call(this,b)},d.valueOf=function(){var y=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*y},d.isUTC=function(){return!!this.$u},d.toISOString=function(){return this.toDate().toISOString()},d.toString=function(){return this.toDate().toUTCString()};var g=d.toDate;d.toDate=function(y){return y==="s"&&this.$offset?c(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():g.call(this)};var v=d.diff;d.diff=function(y,b,E){if(y&&this.$u===y.$u)return v.call(this,y,b,E);var A=this.local(),M=c(y).local();return v.call(A,M,b,E)}}}))},{}],394:[function(t,n,i){i.utils=t("./des/utils"),i.Cipher=t("./des/cipher"),i.DES=t("./des/des"),i.CBC=t("./des/cbc"),i.EDE=t("./des/ede")},{"./des/cbc":395,"./des/cipher":396,"./des/des":397,"./des/ede":398,"./des/utils":399}],395:[function(t,n,i){var s=t("minimalistic-assert"),o=t("inherits"),a={};function l(u){s.equal(u.length,8,"Invalid IV length"),this.iv=new Array(8);for(var c=0;c<this.iv.length;c++)this.iv[c]=u[c]}i.instantiate=function(u){function c(m){u.call(this,m),this._cbcInit()}o(c,u);for(var d=Object.keys(a),h=0;h<d.length;h++){var f=d[h];c.prototype[f]=a[f]}return c.create=function(m){return new c(m)},c},a._cbcInit=function(){var u=new l(this.options.iv);this._cbcState=u},a._update=function(u,c,d,h){var f=this._cbcState,m=this.constructor.super_.prototype,p=f.iv;if(this.type==="encrypt"){for(var g=0;g<this.blockSize;g++)p[g]^=u[c+g];for(m._update.call(this,p,0,d,h),g=0;g<this.blockSize;g++)p[g]=d[h+g]}else{for(m._update.call(this,u,c,d,h),g=0;g<this.blockSize;g++)d[h+g]^=p[g];for(g=0;g<this.blockSize;g++)p[g]=u[c+g]}}},{inherits:440,"minimalistic-assert":453}],396:[function(t,n,i){var s=t("minimalistic-assert");function o(a){this.options=a,this.type=this.options.type,this.blockSize=8,this._init(),this.buffer=new Array(this.blockSize),this.bufferOff=0,this.padding=a.padding!==!1}n.exports=o,o.prototype._init=function(){},o.prototype.update=function(a){return a.length===0?[]:this.type==="decrypt"?this._updateDecrypt(a):this._updateEncrypt(a)},o.prototype._buffer=function(a,l){for(var u=Math.min(this.buffer.length-this.bufferOff,a.length-l),c=0;c<u;c++)this.buffer[this.bufferOff+c]=a[l+c];return this.bufferOff+=u,u},o.prototype._flushBuffer=function(a,l){return this._update(this.buffer,0,a,l),this.bufferOff=0,this.blockSize},o.prototype._updateEncrypt=function(a){var l=0,u=0,c=(this.bufferOff+a.length)/this.blockSize|0,d=new Array(c*this.blockSize);this.bufferOff!==0&&(l+=this._buffer(a,l),this.bufferOff===this.buffer.length&&(u+=this._flushBuffer(d,u)));for(var h=a.length-(a.length-l)%this.blockSize;l<h;l+=this.blockSize)this._update(a,l,d,u),u+=this.blockSize;for(;l<a.length;l++,this.bufferOff++)this.buffer[this.bufferOff]=a[l];return d},o.prototype._updateDecrypt=function(a){for(var l=0,u=0,c=Math.ceil((this.bufferOff+a.length)/this.blockSize)-1,d=new Array(c*this.blockSize);c>0;c--)l+=this._buffer(a,l),u+=this._flushBuffer(d,u);return l+=this._buffer(a,l),d},o.prototype.final=function(a){var l,u;return a&&(l=this.update(a)),u=this.type==="encrypt"?this._finalEncrypt():this._finalDecrypt(),l?l.concat(u):u},o.prototype._pad=function(a,l){if(l===0)return!1;for(;l<a.length;)a[l++]=0;return!0},o.prototype._finalEncrypt=function(){if(!this._pad(this.buffer,this.bufferOff))return[];var a=new Array(this.blockSize);return this._update(this.buffer,0,a,0),a},o.prototype._unpad=function(a){return a},o.prototype._finalDecrypt=function(){s.equal(this.bufferOff,this.blockSize,"Not enough data to decrypt");var a=new Array(this.blockSize);return this._flushBuffer(a,0),this._unpad(a)}},{"minimalistic-assert":453}],397:[function(t,n,i){var s=t("minimalistic-assert"),o=t("inherits"),a=t("./utils"),l=t("./cipher");function u(){this.tmp=new Array(2),this.keys=null}function c(h){l.call(this,h);var f=new u;this._desState=f,this.deriveKeys(f,h.key)}o(c,l),n.exports=c,c.create=function(h){return new c(h)};var d=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];c.prototype.deriveKeys=function(h,f){h.keys=new Array(32),s.equal(f.length,this.blockSize,"Invalid key length");var m=a.readUInt32BE(f,0),p=a.readUInt32BE(f,4);a.pc1(m,p,h.tmp,0),m=h.tmp[0],p=h.tmp[1];for(var g=0;g<h.keys.length;g+=2){var v=d[g>>>1];m=a.r28shl(m,v),p=a.r28shl(p,v),a.pc2(m,p,h.keys,g)}},c.prototype._update=function(h,f,m,p){var g=this._desState,v=a.readUInt32BE(h,f),y=a.readUInt32BE(h,f+4);a.ip(v,y,g.tmp,0),v=g.tmp[0],y=g.tmp[1],this.type==="encrypt"?this._encrypt(g,v,y,g.tmp,0):this._decrypt(g,v,y,g.tmp,0),v=g.tmp[0],y=g.tmp[1],a.writeUInt32BE(m,v,p),a.writeUInt32BE(m,y,p+4)},c.prototype._pad=function(h,f){if(this.padding===!1)return!1;for(var m=h.length-f,p=f;p<h.length;p++)h[p]=m;return!0},c.prototype._unpad=function(h){if(this.padding===!1)return h;for(var f=h[h.length-1],m=h.length-f;m<h.length;m++)s.equal(h[m],f);return h.slice(0,h.length-f)},c.prototype._encrypt=function(h,f,m,p,g){for(var v=f,y=m,b=0;b<h.keys.length;b+=2){var E=h.keys[b],A=h.keys[b+1];a.expand(y,h.tmp,0),E^=h.tmp[0],A^=h.tmp[1];var M=a.substitute(E,A),L=y;y=(v^a.permute(M))>>>0,v=L}a.rip(y,v,p,g)},c.prototype._decrypt=function(h,f,m,p,g){for(var v=m,y=f,b=h.keys.length-2;b>=0;b-=2){var E=h.keys[b],A=h.keys[b+1];a.expand(v,h.tmp,0),E^=h.tmp[0],A^=h.tmp[1];var M=a.substitute(E,A),L=v;v=(y^a.permute(M))>>>0,y=L}a.rip(v,y,p,g)}},{"./cipher":396,"./utils":399,inherits:440,"minimalistic-assert":453}],398:[function(t,n,i){var s=t("minimalistic-assert"),o=t("inherits"),a=t("./cipher"),l=t("./des");function u(d,h){s.equal(h.length,24,"Invalid key length");var f=h.slice(0,8),m=h.slice(8,16),p=h.slice(16,24);this.ciphers=d==="encrypt"?[l.create({type:"encrypt",key:f}),l.create({type:"decrypt",key:m}),l.create({type:"encrypt",key:p})]:[l.create({type:"decrypt",key:p}),l.create({type:"encrypt",key:m}),l.create({type:"decrypt",key:f})]}function c(d){a.call(this,d);var h=new u(this.type,this.options.key);this._edeState=h}o(c,a),n.exports=c,c.create=function(d){return new c(d)},c.prototype._update=function(d,h,f,m){var p=this._edeState;p.ciphers[0]._update(d,h,f,m),p.ciphers[1]._update(f,m,f,m),p.ciphers[2]._update(f,m,f,m)},c.prototype._pad=l.prototype._pad,c.prototype._unpad=l.prototype._unpad},{"./cipher":396,"./des":397,inherits:440,"minimalistic-assert":453}],399:[function(t,n,i){i.readUInt32BE=function(l,u){return(l[0+u]<<24|l[1+u]<<16|l[2+u]<<8|l[3+u])>>>0},i.writeUInt32BE=function(l,u,c){l[0+c]=u>>>24,l[1+c]=u>>>16&255,l[2+c]=u>>>8&255,l[3+c]=255&u},i.ip=function(l,u,c,d){for(var h=0,f=0,m=6;m>=0;m-=2){for(var p=0;p<=24;p+=8)h<<=1,h|=u>>>p+m&1;for(p=0;p<=24;p+=8)h<<=1,h|=l>>>p+m&1}for(m=6;m>=0;m-=2){for(p=1;p<=25;p+=8)f<<=1,f|=u>>>p+m&1;for(p=1;p<=25;p+=8)f<<=1,f|=l>>>p+m&1}c[d+0]=h>>>0,c[d+1]=f>>>0},i.rip=function(l,u,c,d){for(var h=0,f=0,m=0;m<4;m++)for(var p=24;p>=0;p-=8)h<<=1,h|=u>>>p+m&1,h<<=1,h|=l>>>p+m&1;for(m=4;m<8;m++)for(p=24;p>=0;p-=8)f<<=1,f|=u>>>p+m&1,f<<=1,f|=l>>>p+m&1;c[d+0]=h>>>0,c[d+1]=f>>>0},i.pc1=function(l,u,c,d){for(var h=0,f=0,m=7;m>=5;m--){for(var p=0;p<=24;p+=8)h<<=1,h|=u>>p+m&1;for(p=0;p<=24;p+=8)h<<=1,h|=l>>p+m&1}for(p=0;p<=24;p+=8)h<<=1,h|=u>>p+m&1;for(m=1;m<=3;m++){for(p=0;p<=24;p+=8)f<<=1,f|=u>>p+m&1;for(p=0;p<=24;p+=8)f<<=1,f|=l>>p+m&1}for(p=0;p<=24;p+=8)f<<=1,f|=l>>p+m&1;c[d+0]=h>>>0,c[d+1]=f>>>0},i.r28shl=function(l,u){return l<<u&268435455|l>>>28-u};var s=[14,11,17,4,27,23,25,0,13,22,7,18,5,9,16,24,2,20,12,21,1,8,15,26,15,4,25,19,9,1,26,16,5,11,23,8,12,7,17,0,22,3,10,14,6,20,27,24];i.pc2=function(l,u,c,d){for(var h=0,f=0,m=s.length>>>1,p=0;p<m;p++)h<<=1,h|=l>>>s[p]&1;for(p=m;p<s.length;p++)f<<=1,f|=u>>>s[p]&1;c[d+0]=h>>>0,c[d+1]=f>>>0},i.expand=function(l,u,c){var d=0,h=0;d=(1&l)<<5|l>>>27;for(var f=23;f>=15;f-=4)d<<=6,d|=l>>>f&63;for(f=11;f>=3;f-=4)h|=l>>>f&63,h<<=6;h|=(31&l)<<1|l>>>31,u[c+0]=d>>>0,u[c+1]=h>>>0};var o=[14,0,4,15,13,7,1,4,2,14,15,2,11,13,8,1,3,10,10,6,6,12,12,11,5,9,9,5,0,3,7,8,4,15,1,12,14,8,8,2,13,4,6,9,2,1,11,7,15,5,12,11,9,3,7,14,3,10,10,0,5,6,0,13,15,3,1,13,8,4,14,7,6,15,11,2,3,8,4,14,9,12,7,0,2,1,13,10,12,6,0,9,5,11,10,5,0,13,14,8,7,10,11,1,10,3,4,15,13,4,1,2,5,11,8,6,12,7,6,12,9,0,3,5,2,14,15,9,10,13,0,7,9,0,14,9,6,3,3,4,15,6,5,10,1,2,13,8,12,5,7,14,11,12,4,11,2,15,8,1,13,1,6,10,4,13,9,0,8,6,15,9,3,8,0,7,11,4,1,15,2,14,12,3,5,11,10,5,14,2,7,12,7,13,13,8,14,11,3,5,0,6,6,15,9,0,10,3,1,4,2,7,8,2,5,12,11,1,12,10,4,14,15,9,10,3,6,15,9,0,0,6,12,10,11,1,7,13,13,8,15,9,1,4,3,5,14,11,5,12,2,7,8,2,4,14,2,14,12,11,4,2,1,12,7,4,10,7,11,13,6,1,8,5,5,0,3,15,15,10,13,3,0,9,14,8,9,6,4,11,2,8,1,12,11,7,10,1,13,14,7,2,8,13,15,6,9,15,12,0,5,9,6,10,3,4,0,5,14,3,12,10,1,15,10,4,15,2,9,7,2,12,6,9,8,5,0,6,13,1,3,13,4,14,14,0,7,11,5,3,11,8,9,4,14,3,15,2,5,12,2,9,8,5,12,15,3,10,7,11,0,14,4,1,10,7,1,6,13,0,11,8,6,13,4,13,11,0,2,11,14,7,15,4,0,9,8,1,13,10,3,14,12,3,9,5,7,12,5,2,10,15,6,8,1,6,1,6,4,11,11,13,13,8,12,1,3,4,7,10,14,7,10,9,15,5,6,0,8,15,0,14,5,2,9,3,2,12,13,1,2,15,8,13,4,8,6,10,15,3,11,7,1,4,10,12,9,5,3,6,14,11,5,0,0,14,12,9,7,2,7,2,11,1,4,14,1,7,9,4,12,10,14,8,2,13,0,15,6,12,10,9,13,0,15,3,3,5,5,6,8,11];i.substitute=function(l,u){for(var c=0,d=0;d<4;d++)c<<=4,c|=o[64*d+(l>>>18-6*d&63)];for(d=0;d<4;d++)c<<=4,c|=o[256+64*d+(u>>>18-6*d&63)];return c>>>0};var a=[16,25,12,11,3,20,4,15,31,17,9,6,27,14,1,22,30,24,8,18,0,5,29,23,13,19,2,26,10,21,28,7];i.permute=function(l){for(var u=0,c=0;c<a.length;c++)u<<=1,u|=l>>>a[c]&1;return u>>>0},i.padSplit=function(l,u,c){for(var d=l.toString(2);d.length<u;)d="0"+d;for(var h=[],f=0;f<u;f+=c)h.push(d.slice(f,f+c));return h.join(" ")}},{}],400:[function(t,n,i){(function(s){(function(){var o=t("./lib/generatePrime"),a=t("./lib/primes.json"),l=t("./lib/dh"),u={binary:!0,hex:!0,base64:!0};i.DiffieHellmanGroup=i.createDiffieHellmanGroup=i.getDiffieHellman=function(c){var d=new s(a[c].prime,"hex"),h=new s(a[c].gen,"hex");return new l(d,h)},i.createDiffieHellman=i.DiffieHellman=function c(d,h,f,m){return s.isBuffer(h)||u[h]===void 0?c(d,"binary",h,f):(h=h||"binary",m=m||"binary",f=f||new s([2]),s.isBuffer(f)||(f=new s(f,m)),typeof d=="number"?new l(o(d,f),f,!0):(s.isBuffer(d)||(d=new s(d,h)),new l(d,f,!0)))}}).call(this)}).call(this,t("buffer").Buffer)},{"./lib/dh":401,"./lib/generatePrime":402,"./lib/primes.json":403,buffer:220}],401:[function(t,n,i){(function(s){(function(){var o=t("bn.js"),a=new(t("miller-rabin")),l=new o(24),u=new o(11),c=new o(10),d=new o(3),h=new o(7),f=t("./generatePrime"),m=t("randombytes");function p(E,A){return A=A||"utf8",s.isBuffer(E)||(E=new s(E,A)),this._pub=new o(E),this}function g(E,A){return A=A||"utf8",s.isBuffer(E)||(E=new s(E,A)),this._priv=new o(E),this}n.exports=y;var v={};function y(E,A,M){this.setGenerator(A),this.__prime=new o(E),this._prime=o.mont(this.__prime),this._primeLen=E.length,this._pub=void 0,this._priv=void 0,this._primeCode=void 0,M?(this.setPublicKey=p,this.setPrivateKey=g):this._primeCode=8}function b(E,A){var M=new s(E.toArray());return A?M.toString(A):M}Object.defineProperty(y.prototype,"verifyError",{enumerable:!0,get:function(){return typeof this._primeCode!="number"&&(this._primeCode=(function(E,A){var M=A.toString("hex"),L=[M,E.toString(16)].join("_");if(L in v)return v[L];var k,P=0;if(E.isEven()||!f.simpleSieve||!f.fermatTest(E)||!a.test(E))return P+=1,P+=M==="02"||M==="05"?8:4,v[L]=P,P;switch(a.test(E.shrn(1))||(P+=2),M){case"02":E.mod(l).cmp(u)&&(P+=8);break;case"05":(k=E.mod(c)).cmp(d)&&k.cmp(h)&&(P+=8);break;default:P+=4}return v[L]=P,P})(this.__prime,this.__gen)),this._primeCode}}),y.prototype.generateKeys=function(){return this._priv||(this._priv=new o(m(this._primeLen))),this._pub=this._gen.toRed(this._prime).redPow(this._priv).fromRed(),this.getPublicKey()},y.prototype.computeSecret=function(E){var A=(E=(E=new o(E)).toRed(this._prime)).redPow(this._priv).fromRed(),M=new s(A.toArray()),L=this.getPrime();if(M.length<L.length){var k=new s(L.length-M.length);k.fill(0),M=s.concat([k,M])}return M},y.prototype.getPublicKey=function(E){return b(this._pub,E)},y.prototype.getPrivateKey=function(E){return b(this._priv,E)},y.prototype.getPrime=function(E){return b(this.__prime,E)},y.prototype.getGenerator=function(E){return b(this._gen,E)},y.prototype.setGenerator=function(E,A){return A=A||"utf8",s.isBuffer(E)||(E=new s(E,A)),this.__gen=E,this._gen=new o(E),this}}).call(this)}).call(this,t("buffer").Buffer)},{"./generatePrime":402,"bn.js":404,buffer:220,"miller-rabin":451,randombytes:475}],402:[function(t,n,i){var s=t("randombytes");n.exports=E,E.simpleSieve=y,E.fermatTest=b;var o=t("bn.js"),a=new o(24),l=new(t("miller-rabin")),u=new o(1),c=new o(2),d=new o(5),h=(new o(16),new o(8),new o(10)),f=new o(3),m=(new o(7),new o(11)),p=new o(4),g=(new o(12),null);function v(){if(g!==null)return g;var A=[];A[0]=2;for(var M=1,L=3;L<1048576;L+=2){for(var k=Math.ceil(Math.sqrt(L)),P=0;P<M&&A[P]<=k&&L%A[P]!=0;P++);M!==P&&A[P]<=k||(A[M++]=L)}return g=A,A}function y(A){for(var M=v(),L=0;L<M.length;L++)if(A.modn(M[L])===0)return A.cmpn(M[L])===0;return!0}function b(A){var M=o.mont(A);return c.toRed(M).redPow(A.subn(1)).fromRed().cmpn(1)===0}function E(A,M){if(A<16)return new o(M===2||M===5?[140,123]:[140,39]);var L,k;for(M=new o(M);;){for(L=new o(s(Math.ceil(A/8)));L.bitLength()>A;)L.ishrn(1);if(L.isEven()&&L.iadd(u),L.testn(1)||L.iadd(c),M.cmp(c)){if(!M.cmp(d))for(;L.mod(h).cmp(f);)L.iadd(p)}else for(;L.mod(a).cmp(m);)L.iadd(p);if(y(k=L.shrn(1))&&y(L)&&b(k)&&b(L)&&l.test(k)&&l.test(L))return L}}},{"bn.js":404,"miller-rabin":451,randombytes:475}],403:[function(t,n,i){n.exports={modp1:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a63a3620ffffffffffffffff"},modp2:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece65381ffffffffffffffff"},modp5:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff"},modp14:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff"},modp15:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a93ad2caffffffffffffffff"},modp16:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c934063199ffffffffffffffff"},modp17:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dcc4024ffffffffffffffff"},modp18:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dbe115974a3926f12fee5e438777cb6a932df8cd8bec4d073b931ba3bc832b68d9dd300741fa7bf8afc47ed2576f6936ba424663aab639c5ae4f5683423b4742bf1c978238f16cbe39d652de3fdb8befc848ad922222e04a4037c0713eb57a81a23f0c73473fc646cea306b4bcbc8862f8385ddfa9d4b7fa2c087e879683303ed5bdd3a062b3cf5b3a278a66d2a13f83f44f82ddf310ee074ab6a364597e899a0255dc164f31cc50846851df9ab48195ded7ea1b1d510bd7ee74d73faf36bc31ecfa268359046f4eb879f924009438b481c6cd7889a002ed5ee382bc9190da6fc026e479558e4475677e9aa9e3050e2765694dfc81f56e880b96e7160c980dd98edd3dfffffffffffffffff"}}},{}],404:[function(t,n,i){arguments[4][184][0].apply(i,arguments)},{buffer:188,dup:184}],405:[function(t,n,i){var s=i;s.version=t("../package.json").version,s.utils=t("./elliptic/utils"),s.rand=t("brorand"),s.curve=t("./elliptic/curve"),s.curves=t("./elliptic/curves"),s.ec=t("./elliptic/ec"),s.eddsa=t("./elliptic/eddsa")},{"../package.json":421,"./elliptic/curve":408,"./elliptic/curves":411,"./elliptic/ec":412,"./elliptic/eddsa":415,"./elliptic/utils":419,brorand:187}],406:[function(t,n,i){var s=t("bn.js"),o=t("../utils"),a=o.getNAF,l=o.getJSF,u=o.assert;function c(h,f){this.type=h,this.p=new s(f.p,16),this.red=f.prime?s.red(f.prime):s.mont(this.p),this.zero=new s(0).toRed(this.red),this.one=new s(1).toRed(this.red),this.two=new s(2).toRed(this.red),this.n=f.n&&new s(f.n,16),this.g=f.g&&this.pointFromJSON(f.g,f.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var m=this.n&&this.p.div(this.n);!m||m.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}function d(h,f){this.curve=h,this.type=f,this.precomputed=null}n.exports=c,c.prototype.point=function(){throw new Error("Not implemented")},c.prototype.validate=function(){throw new Error("Not implemented")},c.prototype._fixedNafMul=function(h,f){u(h.precomputed);var m=h._getDoubles(),p=a(f,1,this._bitLength),g=(1<<m.step+1)-(m.step%2==0?2:1);g/=3;var v,y,b=[];for(v=0;v<p.length;v+=m.step){y=0;for(var E=v+m.step-1;E>=v;E--)y=(y<<1)+p[E];b.push(y)}for(var A=this.jpoint(null,null,null),M=this.jpoint(null,null,null),L=g;L>0;L--){for(v=0;v<b.length;v++)(y=b[v])===L?M=M.mixedAdd(m.points[v]):y===-L&&(M=M.mixedAdd(m.points[v].neg()));A=A.add(M)}return A.toP()},c.prototype._wnafMul=function(h,f){var m=4,p=h._getNAFPoints(m);m=p.wnd;for(var g=p.points,v=a(f,m,this._bitLength),y=this.jpoint(null,null,null),b=v.length-1;b>=0;b--){for(var E=0;b>=0&&v[b]===0;b--)E++;if(b>=0&&E++,y=y.dblp(E),b<0)break;var A=v[b];u(A!==0),y=h.type==="affine"?A>0?y.mixedAdd(g[A-1>>1]):y.mixedAdd(g[-A-1>>1].neg()):A>0?y.add(g[A-1>>1]):y.add(g[-A-1>>1].neg())}return h.type==="affine"?y.toP():y},c.prototype._wnafMulAdd=function(h,f,m,p,g){var v,y,b,E=this._wnafT1,A=this._wnafT2,M=this._wnafT3,L=0;for(v=0;v<p;v++){var k=(b=f[v])._getNAFPoints(h);E[v]=k.wnd,A[v]=k.points}for(v=p-1;v>=1;v-=2){var P=v-1,U=v;if(E[P]===1&&E[U]===1){var $=[f[P],null,null,f[U]];f[P].y.cmp(f[U].y)===0?($[1]=f[P].add(f[U]),$[2]=f[P].toJ().mixedAdd(f[U].neg())):f[P].y.cmp(f[U].y.redNeg())===0?($[1]=f[P].toJ().mixedAdd(f[U]),$[2]=f[P].add(f[U].neg())):($[1]=f[P].toJ().mixedAdd(f[U]),$[2]=f[P].toJ().mixedAdd(f[U].neg()));var V=[-3,-1,-5,-7,0,7,5,1,3],R=l(m[P],m[U]);for(L=Math.max(R[0].length,L),M[P]=new Array(L),M[U]=new Array(L),y=0;y<L;y++){var O=0|R[0][y],T=0|R[1][y];M[P][y]=V[3*(O+1)+(T+1)],M[U][y]=0,A[P]=$}}else M[P]=a(m[P],E[P],this._bitLength),M[U]=a(m[U],E[U],this._bitLength),L=Math.max(M[P].length,L),L=Math.max(M[U].length,L)}var w=this.jpoint(null,null,null),x=this._wnafT4;for(v=L;v>=0;v--){for(var _=0;v>=0;){var S=!0;for(y=0;y<p;y++)x[y]=0|M[y][v],x[y]!==0&&(S=!1);if(!S)break;_++,v--}if(v>=0&&_++,w=w.dblp(_),v<0)break;for(y=0;y<p;y++){var C=x[y];C!==0&&(C>0?b=A[y][C-1>>1]:C<0&&(b=A[y][-C-1>>1].neg()),w=b.type==="affine"?w.mixedAdd(b):w.add(b))}}for(v=0;v<p;v++)A[v]=null;return g?w:w.toP()},c.BasePoint=d,d.prototype.eq=function(){throw new Error("Not implemented")},d.prototype.validate=function(){return this.curve.validate(this)},c.prototype.decodePoint=function(h,f){h=o.toArray(h,f);var m=this.p.byteLength();if((h[0]===4||h[0]===6||h[0]===7)&&h.length-1==2*m)return h[0]===6?u(h[h.length-1]%2==0):h[0]===7&&u(h[h.length-1]%2==1),this.point(h.slice(1,1+m),h.slice(1+m,1+2*m));if((h[0]===2||h[0]===3)&&h.length-1===m)return this.pointFromX(h.slice(1,1+m),h[0]===3);throw new Error("Unknown point format")},d.prototype.encodeCompressed=function(h){return this.encode(h,!0)},d.prototype._encode=function(h){var f=this.curve.p.byteLength(),m=this.getX().toArray("be",f);return h?[this.getY().isEven()?2:3].concat(m):[4].concat(m,this.getY().toArray("be",f))},d.prototype.encode=function(h,f){return o.encode(this._encode(f),h)},d.prototype.precompute=function(h){if(this.precomputed)return this;var f={doubles:null,naf:null,beta:null};return f.naf=this._getNAFPoints(8),f.doubles=this._getDoubles(4,h),f.beta=this._getBeta(),this.precomputed=f,this},d.prototype._hasDoubles=function(h){if(!this.precomputed)return!1;var f=this.precomputed.doubles;return!!f&&f.points.length>=Math.ceil((h.bitLength()+1)/f.step)},d.prototype._getDoubles=function(h,f){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var m=[this],p=this,g=0;g<f;g+=h){for(var v=0;v<h;v++)p=p.dbl();m.push(p)}return{step:h,points:m}},d.prototype._getNAFPoints=function(h){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var f=[this],m=(1<<h)-1,p=m===1?null:this.dbl(),g=1;g<m;g++)f[g]=f[g-1].add(p);return{wnd:h,points:f}},d.prototype._getBeta=function(){return null},d.prototype.dblp=function(h){for(var f=this,m=0;m<h;m++)f=f.dbl();return f}},{"../utils":419,"bn.js":420}],407:[function(t,n,i){var s=t("../utils"),o=t("bn.js"),a=t("inherits"),l=t("./base"),u=s.assert;function c(h){this.twisted=(0|h.a)!=1,this.mOneA=this.twisted&&(0|h.a)==-1,this.extended=this.mOneA,l.call(this,"edwards",h),this.a=new o(h.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new o(h.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new o(h.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),u(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(0|h.c)==1}function d(h,f,m,p,g){l.BasePoint.call(this,h,"projective"),f===null&&m===null&&p===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new o(f,16),this.y=new o(m,16),this.z=p?new o(p,16):this.curve.one,this.t=g&&new o(g,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}a(c,l),n.exports=c,c.prototype._mulA=function(h){return this.mOneA?h.redNeg():this.a.redMul(h)},c.prototype._mulC=function(h){return this.oneC?h:this.c.redMul(h)},c.prototype.jpoint=function(h,f,m,p){return this.point(h,f,m,p)},c.prototype.pointFromX=function(h,f){(h=new o(h,16)).red||(h=h.toRed(this.red));var m=h.redSqr(),p=this.c2.redSub(this.a.redMul(m)),g=this.one.redSub(this.c2.redMul(this.d).redMul(m)),v=p.redMul(g.redInvm()),y=v.redSqrt();if(y.redSqr().redSub(v).cmp(this.zero)!==0)throw new Error("invalid point");var b=y.fromRed().isOdd();return(f&&!b||!f&&b)&&(y=y.redNeg()),this.point(h,y)},c.prototype.pointFromY=function(h,f){(h=new o(h,16)).red||(h=h.toRed(this.red));var m=h.redSqr(),p=m.redSub(this.c2),g=m.redMul(this.d).redMul(this.c2).redSub(this.a),v=p.redMul(g.redInvm());if(v.cmp(this.zero)===0){if(f)throw new Error("invalid point");return this.point(this.zero,h)}var y=v.redSqrt();if(y.redSqr().redSub(v).cmp(this.zero)!==0)throw new Error("invalid point");return y.fromRed().isOdd()!==f&&(y=y.redNeg()),this.point(y,h)},c.prototype.validate=function(h){if(h.isInfinity())return!0;h.normalize();var f=h.x.redSqr(),m=h.y.redSqr(),p=f.redMul(this.a).redAdd(m),g=this.c2.redMul(this.one.redAdd(this.d.redMul(f).redMul(m)));return p.cmp(g)===0},a(d,l.BasePoint),c.prototype.pointFromJSON=function(h){return d.fromJSON(this,h)},c.prototype.point=function(h,f,m,p){return new d(this,h,f,m,p)},d.fromJSON=function(h,f){return new d(h,f[0],f[1],f[2])},d.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},d.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)},d.prototype._extDbl=function(){var h=this.x.redSqr(),f=this.y.redSqr(),m=this.z.redSqr();m=m.redIAdd(m);var p=this.curve._mulA(h),g=this.x.redAdd(this.y).redSqr().redISub(h).redISub(f),v=p.redAdd(f),y=v.redSub(m),b=p.redSub(f),E=g.redMul(y),A=v.redMul(b),M=g.redMul(b),L=y.redMul(v);return this.curve.point(E,A,L,M)},d.prototype._projDbl=function(){var h,f,m,p,g,v,y=this.x.redAdd(this.y).redSqr(),b=this.x.redSqr(),E=this.y.redSqr();if(this.curve.twisted){var A=(p=this.curve._mulA(b)).redAdd(E);this.zOne?(h=y.redSub(b).redSub(E).redMul(A.redSub(this.curve.two)),f=A.redMul(p.redSub(E)),m=A.redSqr().redSub(A).redSub(A)):(g=this.z.redSqr(),v=A.redSub(g).redISub(g),h=y.redSub(b).redISub(E).redMul(v),f=A.redMul(p.redSub(E)),m=A.redMul(v))}else p=b.redAdd(E),g=this.curve._mulC(this.z).redSqr(),v=p.redSub(g).redSub(g),h=this.curve._mulC(y.redISub(p)).redMul(v),f=this.curve._mulC(p).redMul(b.redISub(E)),m=p.redMul(v);return this.curve.point(h,f,m)},d.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},d.prototype._extAdd=function(h){var f=this.y.redSub(this.x).redMul(h.y.redSub(h.x)),m=this.y.redAdd(this.x).redMul(h.y.redAdd(h.x)),p=this.t.redMul(this.curve.dd).redMul(h.t),g=this.z.redMul(h.z.redAdd(h.z)),v=m.redSub(f),y=g.redSub(p),b=g.redAdd(p),E=m.redAdd(f),A=v.redMul(y),M=b.redMul(E),L=v.redMul(E),k=y.redMul(b);return this.curve.point(A,M,k,L)},d.prototype._projAdd=function(h){var f,m,p=this.z.redMul(h.z),g=p.redSqr(),v=this.x.redMul(h.x),y=this.y.redMul(h.y),b=this.curve.d.redMul(v).redMul(y),E=g.redSub(b),A=g.redAdd(b),M=this.x.redAdd(this.y).redMul(h.x.redAdd(h.y)).redISub(v).redISub(y),L=p.redMul(E).redMul(M);return this.curve.twisted?(f=p.redMul(A).redMul(y.redSub(this.curve._mulA(v))),m=E.redMul(A)):(f=p.redMul(A).redMul(y.redSub(v)),m=this.curve._mulC(E).redMul(A)),this.curve.point(L,f,m)},d.prototype.add=function(h){return this.isInfinity()?h:h.isInfinity()?this:this.curve.extended?this._extAdd(h):this._projAdd(h)},d.prototype.mul=function(h){return this._hasDoubles(h)?this.curve._fixedNafMul(this,h):this.curve._wnafMul(this,h)},d.prototype.mulAdd=function(h,f,m){return this.curve._wnafMulAdd(1,[this,f],[h,m],2,!1)},d.prototype.jmulAdd=function(h,f,m){return this.curve._wnafMulAdd(1,[this,f],[h,m],2,!0)},d.prototype.normalize=function(){if(this.zOne)return this;var h=this.z.redInvm();return this.x=this.x.redMul(h),this.y=this.y.redMul(h),this.t&&(this.t=this.t.redMul(h)),this.z=this.curve.one,this.zOne=!0,this},d.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},d.prototype.getX=function(){return this.normalize(),this.x.fromRed()},d.prototype.getY=function(){return this.normalize(),this.y.fromRed()},d.prototype.eq=function(h){return this===h||this.getX().cmp(h.getX())===0&&this.getY().cmp(h.getY())===0},d.prototype.eqXToP=function(h){var f=h.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(f)===0)return!0;for(var m=h.clone(),p=this.curve.redN.redMul(this.z);;){if(m.iadd(this.curve.n),m.cmp(this.curve.p)>=0)return!1;if(f.redIAdd(p),this.x.cmp(f)===0)return!0}},d.prototype.toP=d.prototype.normalize,d.prototype.mixedAdd=d.prototype.add},{"../utils":419,"./base":406,"bn.js":420,inherits:440}],408:[function(t,n,i){var s=i;s.base=t("./base"),s.short=t("./short"),s.mont=t("./mont"),s.edwards=t("./edwards")},{"./base":406,"./edwards":407,"./mont":409,"./short":410}],409:[function(t,n,i){var s=t("bn.js"),o=t("inherits"),a=t("./base"),l=t("../utils");function u(d){a.call(this,"mont",d),this.a=new s(d.a,16).toRed(this.red),this.b=new s(d.b,16).toRed(this.red),this.i4=new s(4).toRed(this.red).redInvm(),this.two=new s(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}function c(d,h,f){a.BasePoint.call(this,d,"projective"),h===null&&f===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new s(h,16),this.z=new s(f,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}o(u,a),n.exports=u,u.prototype.validate=function(d){var h=d.normalize().x,f=h.redSqr(),m=f.redMul(h).redAdd(f.redMul(this.a)).redAdd(h);return m.redSqrt().redSqr().cmp(m)===0},o(c,a.BasePoint),u.prototype.decodePoint=function(d,h){return this.point(l.toArray(d,h),1)},u.prototype.point=function(d,h){return new c(this,d,h)},u.prototype.pointFromJSON=function(d){return c.fromJSON(this,d)},c.prototype.precompute=function(){},c.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},c.fromJSON=function(d,h){return new c(d,h[0],h[1]||d.one)},c.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},c.prototype.isInfinity=function(){return this.z.cmpn(0)===0},c.prototype.dbl=function(){var d=this.x.redAdd(this.z).redSqr(),h=this.x.redSub(this.z).redSqr(),f=d.redSub(h),m=d.redMul(h),p=f.redMul(h.redAdd(this.curve.a24.redMul(f)));return this.curve.point(m,p)},c.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},c.prototype.diffAdd=function(d,h){var f=this.x.redAdd(this.z),m=this.x.redSub(this.z),p=d.x.redAdd(d.z),g=d.x.redSub(d.z).redMul(f),v=p.redMul(m),y=h.z.redMul(g.redAdd(v).redSqr()),b=h.x.redMul(g.redISub(v).redSqr());return this.curve.point(y,b)},c.prototype.mul=function(d){for(var h=d.clone(),f=this,m=this.curve.point(null,null),p=[];h.cmpn(0)!==0;h.iushrn(1))p.push(h.andln(1));for(var g=p.length-1;g>=0;g--)p[g]===0?(f=f.diffAdd(m,this),m=m.dbl()):(m=f.diffAdd(m,this),f=f.dbl());return m},c.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},c.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},c.prototype.eq=function(d){return this.getX().cmp(d.getX())===0},c.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},c.prototype.getX=function(){return this.normalize(),this.x.fromRed()}},{"../utils":419,"./base":406,"bn.js":420,inherits:440}],410:[function(t,n,i){var s=t("../utils"),o=t("bn.js"),a=t("inherits"),l=t("./base"),u=s.assert;function c(f){l.call(this,"short",f),this.a=new o(f.a,16).toRed(this.red),this.b=new o(f.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(f),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}function d(f,m,p,g){l.BasePoint.call(this,f,"affine"),m===null&&p===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new o(m,16),this.y=new o(p,16),g&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function h(f,m,p,g){l.BasePoint.call(this,f,"jacobian"),m===null&&p===null&&g===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new o(0)):(this.x=new o(m,16),this.y=new o(p,16),this.z=new o(g,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}a(c,l),n.exports=c,c.prototype._getEndomorphism=function(f){if(this.zeroA&&this.g&&this.n&&this.p.modn(3)===1){var m,p;if(f.beta)m=new o(f.beta,16).toRed(this.red);else{var g=this._getEndoRoots(this.p);m=(m=g[0].cmp(g[1])<0?g[0]:g[1]).toRed(this.red)}if(f.lambda)p=new o(f.lambda,16);else{var v=this._getEndoRoots(this.n);this.g.mul(v[0]).x.cmp(this.g.x.redMul(m))===0?p=v[0]:(p=v[1],u(this.g.mul(p).x.cmp(this.g.x.redMul(m))===0))}return{beta:m,lambda:p,basis:f.basis?f.basis.map((function(y){return{a:new o(y.a,16),b:new o(y.b,16)}})):this._getEndoBasis(p)}}},c.prototype._getEndoRoots=function(f){var m=f===this.p?this.red:o.mont(f),p=new o(2).toRed(m).redInvm(),g=p.redNeg(),v=new o(3).toRed(m).redNeg().redSqrt().redMul(p);return[g.redAdd(v).fromRed(),g.redSub(v).fromRed()]},c.prototype._getEndoBasis=function(f){for(var m,p,g,v,y,b,E,A,M,L=this.n.ushrn(Math.floor(this.n.bitLength()/2)),k=f,P=this.n.clone(),U=new o(1),$=new o(0),V=new o(0),R=new o(1),O=0;k.cmpn(0)!==0;){var T=P.div(k);A=P.sub(T.mul(k)),M=V.sub(T.mul(U));var w=R.sub(T.mul($));if(!g&&A.cmp(L)<0)m=E.neg(),p=U,g=A.neg(),v=M;else if(g&&++O==2)break;E=A,P=k,k=A,V=U,U=M,R=$,$=w}y=A.neg(),b=M;var x=g.sqr().add(v.sqr());return y.sqr().add(b.sqr()).cmp(x)>=0&&(y=m,b=p),g.negative&&(g=g.neg(),v=v.neg()),y.negative&&(y=y.neg(),b=b.neg()),[{a:g,b:v},{a:y,b}]},c.prototype._endoSplit=function(f){var m=this.endo.basis,p=m[0],g=m[1],v=g.b.mul(f).divRound(this.n),y=p.b.neg().mul(f).divRound(this.n),b=v.mul(p.a),E=y.mul(g.a),A=v.mul(p.b),M=y.mul(g.b);return{k1:f.sub(b).sub(E),k2:A.add(M).neg()}},c.prototype.pointFromX=function(f,m){(f=new o(f,16)).red||(f=f.toRed(this.red));var p=f.redSqr().redMul(f).redIAdd(f.redMul(this.a)).redIAdd(this.b),g=p.redSqrt();if(g.redSqr().redSub(p).cmp(this.zero)!==0)throw new Error("invalid point");var v=g.fromRed().isOdd();return(m&&!v||!m&&v)&&(g=g.redNeg()),this.point(f,g)},c.prototype.validate=function(f){if(f.inf)return!0;var m=f.x,p=f.y,g=this.a.redMul(m),v=m.redSqr().redMul(m).redIAdd(g).redIAdd(this.b);return p.redSqr().redISub(v).cmpn(0)===0},c.prototype._endoWnafMulAdd=function(f,m,p){for(var g=this._endoWnafT1,v=this._endoWnafT2,y=0;y<f.length;y++){var b=this._endoSplit(m[y]),E=f[y],A=E._getBeta();b.k1.negative&&(b.k1.ineg(),E=E.neg(!0)),b.k2.negative&&(b.k2.ineg(),A=A.neg(!0)),g[2*y]=E,g[2*y+1]=A,v[2*y]=b.k1,v[2*y+1]=b.k2}for(var M=this._wnafMulAdd(1,g,v,2*y,p),L=0;L<2*y;L++)g[L]=null,v[L]=null;return M},a(d,l.BasePoint),c.prototype.point=function(f,m,p){return new d(this,f,m,p)},c.prototype.pointFromJSON=function(f,m){return d.fromJSON(this,f,m)},d.prototype._getBeta=function(){if(this.curve.endo){var f=this.precomputed;if(f&&f.beta)return f.beta;var m=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(f){var p=this.curve,g=function(v){return p.point(v.x.redMul(p.endo.beta),v.y)};f.beta=m,m.precomputed={beta:null,naf:f.naf&&{wnd:f.naf.wnd,points:f.naf.points.map(g)},doubles:f.doubles&&{step:f.doubles.step,points:f.doubles.points.map(g)}}}return m}},d.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},d.fromJSON=function(f,m,p){typeof m=="string"&&(m=JSON.parse(m));var g=f.point(m[0],m[1],p);if(!m[2])return g;function v(b){return f.point(b[0],b[1],p)}var y=m[2];return g.precomputed={beta:null,doubles:y.doubles&&{step:y.doubles.step,points:[g].concat(y.doubles.points.map(v))},naf:y.naf&&{wnd:y.naf.wnd,points:[g].concat(y.naf.points.map(v))}},g},d.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},d.prototype.isInfinity=function(){return this.inf},d.prototype.add=function(f){if(this.inf)return f;if(f.inf)return this;if(this.eq(f))return this.dbl();if(this.neg().eq(f))return this.curve.point(null,null);if(this.x.cmp(f.x)===0)return this.curve.point(null,null);var m=this.y.redSub(f.y);m.cmpn(0)!==0&&(m=m.redMul(this.x.redSub(f.x).redInvm()));var p=m.redSqr().redISub(this.x).redISub(f.x),g=m.redMul(this.x.redSub(p)).redISub(this.y);return this.curve.point(p,g)},d.prototype.dbl=function(){if(this.inf)return this;var f=this.y.redAdd(this.y);if(f.cmpn(0)===0)return this.curve.point(null,null);var m=this.curve.a,p=this.x.redSqr(),g=f.redInvm(),v=p.redAdd(p).redIAdd(p).redIAdd(m).redMul(g),y=v.redSqr().redISub(this.x.redAdd(this.x)),b=v.redMul(this.x.redSub(y)).redISub(this.y);return this.curve.point(y,b)},d.prototype.getX=function(){return this.x.fromRed()},d.prototype.getY=function(){return this.y.fromRed()},d.prototype.mul=function(f){return f=new o(f,16),this.isInfinity()?this:this._hasDoubles(f)?this.curve._fixedNafMul(this,f):this.curve.endo?this.curve._endoWnafMulAdd([this],[f]):this.curve._wnafMul(this,f)},d.prototype.mulAdd=function(f,m,p){var g=[this,m],v=[f,p];return this.curve.endo?this.curve._endoWnafMulAdd(g,v):this.curve._wnafMulAdd(1,g,v,2)},d.prototype.jmulAdd=function(f,m,p){var g=[this,m],v=[f,p];return this.curve.endo?this.curve._endoWnafMulAdd(g,v,!0):this.curve._wnafMulAdd(1,g,v,2,!0)},d.prototype.eq=function(f){return this===f||this.inf===f.inf&&(this.inf||this.x.cmp(f.x)===0&&this.y.cmp(f.y)===0)},d.prototype.neg=function(f){if(this.inf)return this;var m=this.curve.point(this.x,this.y.redNeg());if(f&&this.precomputed){var p=this.precomputed,g=function(v){return v.neg()};m.precomputed={naf:p.naf&&{wnd:p.naf.wnd,points:p.naf.points.map(g)},doubles:p.doubles&&{step:p.doubles.step,points:p.doubles.points.map(g)}}}return m},d.prototype.toJ=function(){return this.inf?this.curve.jpoint(null,null,null):this.curve.jpoint(this.x,this.y,this.curve.one)},a(h,l.BasePoint),c.prototype.jpoint=function(f,m,p){return new h(this,f,m,p)},h.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var f=this.z.redInvm(),m=f.redSqr(),p=this.x.redMul(m),g=this.y.redMul(m).redMul(f);return this.curve.point(p,g)},h.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},h.prototype.add=function(f){if(this.isInfinity())return f;if(f.isInfinity())return this;var m=f.z.redSqr(),p=this.z.redSqr(),g=this.x.redMul(m),v=f.x.redMul(p),y=this.y.redMul(m.redMul(f.z)),b=f.y.redMul(p.redMul(this.z)),E=g.redSub(v),A=y.redSub(b);if(E.cmpn(0)===0)return A.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var M=E.redSqr(),L=M.redMul(E),k=g.redMul(M),P=A.redSqr().redIAdd(L).redISub(k).redISub(k),U=A.redMul(k.redISub(P)).redISub(y.redMul(L)),$=this.z.redMul(f.z).redMul(E);return this.curve.jpoint(P,U,$)},h.prototype.mixedAdd=function(f){if(this.isInfinity())return f.toJ();if(f.isInfinity())return this;var m=this.z.redSqr(),p=this.x,g=f.x.redMul(m),v=this.y,y=f.y.redMul(m).redMul(this.z),b=p.redSub(g),E=v.redSub(y);if(b.cmpn(0)===0)return E.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var A=b.redSqr(),M=A.redMul(b),L=p.redMul(A),k=E.redSqr().redIAdd(M).redISub(L).redISub(L),P=E.redMul(L.redISub(k)).redISub(v.redMul(M)),U=this.z.redMul(b);return this.curve.jpoint(k,P,U)},h.prototype.dblp=function(f){if(f===0)return this;if(this.isInfinity())return this;if(!f)return this.dbl();var m;if(this.curve.zeroA||this.curve.threeA){var p=this;for(m=0;m<f;m++)p=p.dbl();return p}var g=this.curve.a,v=this.curve.tinv,y=this.x,b=this.y,E=this.z,A=E.redSqr().redSqr(),M=b.redAdd(b);for(m=0;m<f;m++){var L=y.redSqr(),k=M.redSqr(),P=k.redSqr(),U=L.redAdd(L).redIAdd(L).redIAdd(g.redMul(A)),$=y.redMul(k),V=U.redSqr().redISub($.redAdd($)),R=$.redISub(V),O=U.redMul(R);O=O.redIAdd(O).redISub(P);var T=M.redMul(E);m+1<f&&(A=A.redMul(P)),y=V,E=T,M=O}return this.curve.jpoint(y,M.redMul(v),E)},h.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},h.prototype._zeroDbl=function(){var f,m,p;if(this.zOne){var g=this.x.redSqr(),v=this.y.redSqr(),y=v.redSqr(),b=this.x.redAdd(v).redSqr().redISub(g).redISub(y);b=b.redIAdd(b);var E=g.redAdd(g).redIAdd(g),A=E.redSqr().redISub(b).redISub(b),M=y.redIAdd(y);M=(M=M.redIAdd(M)).redIAdd(M),f=A,m=E.redMul(b.redISub(A)).redISub(M),p=this.y.redAdd(this.y)}else{var L=this.x.redSqr(),k=this.y.redSqr(),P=k.redSqr(),U=this.x.redAdd(k).redSqr().redISub(L).redISub(P);U=U.redIAdd(U);var $=L.redAdd(L).redIAdd(L),V=$.redSqr(),R=P.redIAdd(P);R=(R=R.redIAdd(R)).redIAdd(R),f=V.redISub(U).redISub(U),m=$.redMul(U.redISub(f)).redISub(R),p=(p=this.y.redMul(this.z)).redIAdd(p)}return this.curve.jpoint(f,m,p)},h.prototype._threeDbl=function(){var f,m,p;if(this.zOne){var g=this.x.redSqr(),v=this.y.redSqr(),y=v.redSqr(),b=this.x.redAdd(v).redSqr().redISub(g).redISub(y);b=b.redIAdd(b);var E=g.redAdd(g).redIAdd(g).redIAdd(this.curve.a),A=E.redSqr().redISub(b).redISub(b);f=A;var M=y.redIAdd(y);M=(M=M.redIAdd(M)).redIAdd(M),m=E.redMul(b.redISub(A)).redISub(M),p=this.y.redAdd(this.y)}else{var L=this.z.redSqr(),k=this.y.redSqr(),P=this.x.redMul(k),U=this.x.redSub(L).redMul(this.x.redAdd(L));U=U.redAdd(U).redIAdd(U);var $=P.redIAdd(P),V=($=$.redIAdd($)).redAdd($);f=U.redSqr().redISub(V),p=this.y.redAdd(this.z).redSqr().redISub(k).redISub(L);var R=k.redSqr();R=(R=(R=R.redIAdd(R)).redIAdd(R)).redIAdd(R),m=U.redMul($.redISub(f)).redISub(R)}return this.curve.jpoint(f,m,p)},h.prototype._dbl=function(){var f=this.curve.a,m=this.x,p=this.y,g=this.z,v=g.redSqr().redSqr(),y=m.redSqr(),b=p.redSqr(),E=y.redAdd(y).redIAdd(y).redIAdd(f.redMul(v)),A=m.redAdd(m),M=(A=A.redIAdd(A)).redMul(b),L=E.redSqr().redISub(M.redAdd(M)),k=M.redISub(L),P=b.redSqr();P=(P=(P=P.redIAdd(P)).redIAdd(P)).redIAdd(P);var U=E.redMul(k).redISub(P),$=p.redAdd(p).redMul(g);return this.curve.jpoint(L,U,$)},h.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var f=this.x.redSqr(),m=this.y.redSqr(),p=this.z.redSqr(),g=m.redSqr(),v=f.redAdd(f).redIAdd(f),y=v.redSqr(),b=this.x.redAdd(m).redSqr().redISub(f).redISub(g),E=(b=(b=(b=b.redIAdd(b)).redAdd(b).redIAdd(b)).redISub(y)).redSqr(),A=g.redIAdd(g);A=(A=(A=A.redIAdd(A)).redIAdd(A)).redIAdd(A);var M=v.redIAdd(b).redSqr().redISub(y).redISub(E).redISub(A),L=m.redMul(M);L=(L=L.redIAdd(L)).redIAdd(L);var k=this.x.redMul(E).redISub(L);k=(k=k.redIAdd(k)).redIAdd(k);var P=this.y.redMul(M.redMul(A.redISub(M)).redISub(b.redMul(E)));P=(P=(P=P.redIAdd(P)).redIAdd(P)).redIAdd(P);var U=this.z.redAdd(b).redSqr().redISub(p).redISub(E);return this.curve.jpoint(k,P,U)},h.prototype.mul=function(f,m){return f=new o(f,m),this.curve._wnafMul(this,f)},h.prototype.eq=function(f){if(f.type==="affine")return this.eq(f.toJ());if(this===f)return!0;var m=this.z.redSqr(),p=f.z.redSqr();if(this.x.redMul(p).redISub(f.x.redMul(m)).cmpn(0)!==0)return!1;var g=m.redMul(this.z),v=p.redMul(f.z);return this.y.redMul(v).redISub(f.y.redMul(g)).cmpn(0)===0},h.prototype.eqXToP=function(f){var m=this.z.redSqr(),p=f.toRed(this.curve.red).redMul(m);if(this.x.cmp(p)===0)return!0;for(var g=f.clone(),v=this.curve.redN.redMul(m);;){if(g.iadd(this.curve.n),g.cmp(this.curve.p)>=0)return!1;if(p.redIAdd(v),this.x.cmp(p)===0)return!0}},h.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},h.prototype.isInfinity=function(){return this.z.cmpn(0)===0}},{"../utils":419,"./base":406,"bn.js":420,inherits:440}],411:[function(t,n,i){var s,o=i,a=t("hash.js"),l=t("./curve"),u=t("./utils").assert;function c(h){h.type==="short"?this.curve=new l.short(h):h.type==="edwards"?this.curve=new l.edwards(h):this.curve=new l.mont(h),this.g=this.curve.g,this.n=this.curve.n,this.hash=h.hash,u(this.g.validate(),"Invalid curve"),u(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function d(h,f){Object.defineProperty(o,h,{configurable:!0,enumerable:!0,get:function(){var m=new c(f);return Object.defineProperty(o,h,{configurable:!0,enumerable:!0,value:m}),m}})}o.PresetCurve=c,d("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:a.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),d("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:a.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),d("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:a.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),d("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:a.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),d("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:a.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),d("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:a.sha256,gRed:!1,g:["9"]}),d("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:a.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});try{s=t("./precomputed/secp256k1")}catch{s=void 0}d("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:a.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",s]})},{"./curve":408,"./precomputed/secp256k1":418,"./utils":419,"hash.js":426}],412:[function(t,n,i){var s=t("bn.js"),o=t("hmac-drbg"),a=t("../utils"),l=t("../curves"),u=t("brorand"),c=a.assert,d=t("./key"),h=t("./signature");function f(m){if(!(this instanceof f))return new f(m);typeof m=="string"&&(c(Object.prototype.hasOwnProperty.call(l,m),"Unknown curve "+m),m=l[m]),m instanceof l.PresetCurve&&(m={curve:m}),this.curve=m.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=m.curve.g,this.g.precompute(m.curve.n.bitLength()+1),this.hash=m.hash||m.curve.hash}n.exports=f,f.prototype.keyPair=function(m){return new d(this,m)},f.prototype.keyFromPrivate=function(m,p){return d.fromPrivate(this,m,p)},f.prototype.keyFromPublic=function(m,p){return d.fromPublic(this,m,p)},f.prototype.genKeyPair=function(m){m||(m={});for(var p=new o({hash:this.hash,pers:m.pers,persEnc:m.persEnc||"utf8",entropy:m.entropy||u(this.hash.hmacStrength),entropyEnc:m.entropy&&m.entropyEnc||"utf8",nonce:this.n.toArray()}),g=this.n.byteLength(),v=this.n.sub(new s(2));;){var y=new s(p.generate(g));if(!(y.cmp(v)>0))return y.iaddn(1),this.keyFromPrivate(y)}},f.prototype._truncateToN=function(m,p){var g=8*m.byteLength()-this.n.bitLength();return g>0&&(m=m.ushrn(g)),!p&&m.cmp(this.n)>=0?m.sub(this.n):m},f.prototype.sign=function(m,p,g,v){typeof g=="object"&&(v=g,g=null),v||(v={}),p=this.keyFromPrivate(p,g),m=this._truncateToN(new s(m,16));for(var y=this.n.byteLength(),b=p.getPrivate().toArray("be",y),E=m.toArray("be",y),A=new o({hash:this.hash,entropy:b,nonce:E,pers:v.pers,persEnc:v.persEnc||"utf8"}),M=this.n.sub(new s(1)),L=0;;L++){var k=v.k?v.k(L):new s(A.generate(this.n.byteLength()));if(!((k=this._truncateToN(k,!0)).cmpn(1)<=0||k.cmp(M)>=0)){var P=this.g.mul(k);if(!P.isInfinity()){var U=P.getX(),$=U.umod(this.n);if($.cmpn(0)!==0){var V=k.invm(this.n).mul($.mul(p.getPrivate()).iadd(m));if((V=V.umod(this.n)).cmpn(0)!==0){var R=(P.getY().isOdd()?1:0)|(U.cmp($)!==0?2:0);return v.canonical&&V.cmp(this.nh)>0&&(V=this.n.sub(V),R^=1),new h({r:$,s:V,recoveryParam:R})}}}}}},f.prototype.verify=function(m,p,g,v){m=this._truncateToN(new s(m,16)),g=this.keyFromPublic(g,v);var y=(p=new h(p,"hex")).r,b=p.s;if(y.cmpn(1)<0||y.cmp(this.n)>=0||b.cmpn(1)<0||b.cmp(this.n)>=0)return!1;var E,A=b.invm(this.n),M=A.mul(m).umod(this.n),L=A.mul(y).umod(this.n);return this.curve._maxwellTrick?!(E=this.g.jmulAdd(M,g.getPublic(),L)).isInfinity()&&E.eqXToP(y):!(E=this.g.mulAdd(M,g.getPublic(),L)).isInfinity()&&E.getX().umod(this.n).cmp(y)===0},f.prototype.recoverPubKey=function(m,p,g,v){c((3&g)===g,"The recovery param is more than two bits"),p=new h(p,v);var y=this.n,b=new s(m),E=p.r,A=p.s,M=1&g,L=g>>1;if(E.cmp(this.curve.p.umod(this.curve.n))>=0&&L)throw new Error("Unable to find sencond key candinate");E=L?this.curve.pointFromX(E.add(this.curve.n),M):this.curve.pointFromX(E,M);var k=p.r.invm(y),P=y.sub(b).mul(k).umod(y),U=A.mul(k).umod(y);return this.g.mulAdd(P,E,U)},f.prototype.getKeyRecoveryParam=function(m,p,g,v){if((p=new h(p,v)).recoveryParam!==null)return p.recoveryParam;for(var y=0;y<4;y++){var b;try{b=this.recoverPubKey(m,p,y)}catch{continue}if(b.eq(g))return y}throw new Error("Unable to find valid recovery factor")}},{"../curves":411,"../utils":419,"./key":413,"./signature":414,"bn.js":420,brorand:187,"hmac-drbg":438}],413:[function(t,n,i){var s=t("bn.js"),o=t("../utils").assert;function a(l,u){this.ec=l,this.priv=null,this.pub=null,u.priv&&this._importPrivate(u.priv,u.privEnc),u.pub&&this._importPublic(u.pub,u.pubEnc)}n.exports=a,a.fromPublic=function(l,u,c){return u instanceof a?u:new a(l,{pub:u,pubEnc:c})},a.fromPrivate=function(l,u,c){return u instanceof a?u:new a(l,{priv:u,privEnc:c})},a.prototype.validate=function(){var l=this.getPublic();return l.isInfinity()?{result:!1,reason:"Invalid public key"}:l.validate()?l.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},a.prototype.getPublic=function(l,u){return typeof l=="string"&&(u=l,l=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),u?this.pub.encode(u,l):this.pub},a.prototype.getPrivate=function(l){return l==="hex"?this.priv.toString(16,2):this.priv},a.prototype._importPrivate=function(l,u){this.priv=new s(l,u||16),this.priv=this.priv.umod(this.ec.curve.n)},a.prototype._importPublic=function(l,u){if(l.x||l.y)return this.ec.curve.type==="mont"?o(l.x,"Need x coordinate"):this.ec.curve.type!=="short"&&this.ec.curve.type!=="edwards"||o(l.x&&l.y,"Need both x and y coordinate"),void(this.pub=this.ec.curve.point(l.x,l.y));this.pub=this.ec.curve.decodePoint(l,u)},a.prototype.derive=function(l){return l.validate()||o(l.validate(),"public point not validated"),l.mul(this.priv).getX()},a.prototype.sign=function(l,u,c){return this.ec.sign(l,this,u,c)},a.prototype.verify=function(l,u){return this.ec.verify(l,u,this)},a.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}},{"../utils":419,"bn.js":420}],414:[function(t,n,i){var s=t("bn.js"),o=t("../utils"),a=o.assert;function l(f,m){if(f instanceof l)return f;this._importDER(f,m)||(a(f.r&&f.s,"Signature without r or s"),this.r=new s(f.r,16),this.s=new s(f.s,16),f.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=f.recoveryParam)}function u(){this.place=0}function c(f,m){var p=f[m.place++];if(!(128&p))return p;var g=15&p;if(g===0||g>4)return!1;for(var v=0,y=0,b=m.place;y<g;y++,b++)v<<=8,v|=f[b],v>>>=0;return!(v<=127)&&(m.place=b,v)}function d(f){for(var m=0,p=f.length-1;!f[m]&&!(128&f[m+1])&&m<p;)m++;return m===0?f:f.slice(m)}function h(f,m){if(m<128)f.push(m);else{var p=1+(Math.log(m)/Math.LN2>>>3);for(f.push(128|p);--p;)f.push(m>>>(p<<3)&255);f.push(m)}}n.exports=l,l.prototype._importDER=function(f,m){f=o.toArray(f,m);var p=new u;if(f[p.place++]!==48)return!1;var g=c(f,p);if(g===!1||g+p.place!==f.length||f[p.place++]!==2)return!1;var v=c(f,p);if(v===!1)return!1;var y=f.slice(p.place,v+p.place);if(p.place+=v,f[p.place++]!==2)return!1;var b=c(f,p);if(b===!1||f.length!==b+p.place)return!1;var E=f.slice(p.place,b+p.place);if(y[0]===0){if(!(128&y[1]))return!1;y=y.slice(1)}if(E[0]===0){if(!(128&E[1]))return!1;E=E.slice(1)}return this.r=new s(y),this.s=new s(E),this.recoveryParam=null,!0},l.prototype.toDER=function(f){var m=this.r.toArray(),p=this.s.toArray();for(128&m[0]&&(m=[0].concat(m)),128&p[0]&&(p=[0].concat(p)),m=d(m),p=d(p);!(p[0]||128&p[1]);)p=p.slice(1);var g=[2];h(g,m.length),(g=g.concat(m)).push(2),h(g,p.length);var v=g.concat(p),y=[48];return h(y,v.length),y=y.concat(v),o.encode(y,f)}},{"../utils":419,"bn.js":420}],415:[function(t,n,i){var s=t("hash.js"),o=t("../curves"),a=t("../utils"),l=a.assert,u=a.parseBytes,c=t("./key"),d=t("./signature");function h(f){if(l(f==="ed25519","only tested with ed25519 so far"),!(this instanceof h))return new h(f);f=o[f].curve,this.curve=f,this.g=f.g,this.g.precompute(f.n.bitLength()+1),this.pointClass=f.point().constructor,this.encodingLength=Math.ceil(f.n.bitLength()/8),this.hash=s.sha512}n.exports=h,h.prototype.sign=function(f,m){f=u(f);var p=this.keyFromSecret(m),g=this.hashInt(p.messagePrefix(),f),v=this.g.mul(g),y=this.encodePoint(v),b=this.hashInt(y,p.pubBytes(),f).mul(p.priv()),E=g.add(b).umod(this.curve.n);return this.makeSignature({R:v,S:E,Rencoded:y})},h.prototype.verify=function(f,m,p){f=u(f),m=this.makeSignature(m);var g=this.keyFromPublic(p),v=this.hashInt(m.Rencoded(),g.pubBytes(),f),y=this.g.mul(m.S());return m.R().add(g.pub().mul(v)).eq(y)},h.prototype.hashInt=function(){for(var f=this.hash(),m=0;m<arguments.length;m++)f.update(arguments[m]);return a.intFromLE(f.digest()).umod(this.curve.n)},h.prototype.keyFromPublic=function(f){return c.fromPublic(this,f)},h.prototype.keyFromSecret=function(f){return c.fromSecret(this,f)},h.prototype.makeSignature=function(f){return f instanceof d?f:new d(this,f)},h.prototype.encodePoint=function(f){var m=f.getY().toArray("le",this.encodingLength);return m[this.encodingLength-1]|=f.getX().isOdd()?128:0,m},h.prototype.decodePoint=function(f){var m=(f=a.parseBytes(f)).length-1,p=f.slice(0,m).concat(-129&f[m]),g=(128&f[m])!=0,v=a.intFromLE(p);return this.curve.pointFromY(v,g)},h.prototype.encodeInt=function(f){return f.toArray("le",this.encodingLength)},h.prototype.decodeInt=function(f){return a.intFromLE(f)},h.prototype.isPoint=function(f){return f instanceof this.pointClass}},{"../curves":411,"../utils":419,"./key":416,"./signature":417,"hash.js":426}],416:[function(t,n,i){var s=t("../utils"),o=s.assert,a=s.parseBytes,l=s.cachedProperty;function u(c,d){this.eddsa=c,this._secret=a(d.secret),c.isPoint(d.pub)?this._pub=d.pub:this._pubBytes=a(d.pub)}u.fromPublic=function(c,d){return d instanceof u?d:new u(c,{pub:d})},u.fromSecret=function(c,d){return d instanceof u?d:new u(c,{secret:d})},u.prototype.secret=function(){return this._secret},l(u,"pubBytes",(function(){return this.eddsa.encodePoint(this.pub())})),l(u,"pub",(function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())})),l(u,"privBytes",(function(){var c=this.eddsa,d=this.hash(),h=c.encodingLength-1,f=d.slice(0,c.encodingLength);return f[0]&=248,f[h]&=127,f[h]|=64,f})),l(u,"priv",(function(){return this.eddsa.decodeInt(this.privBytes())})),l(u,"hash",(function(){return this.eddsa.hash().update(this.secret()).digest()})),l(u,"messagePrefix",(function(){return this.hash().slice(this.eddsa.encodingLength)})),u.prototype.sign=function(c){return o(this._secret,"KeyPair can only verify"),this.eddsa.sign(c,this)},u.prototype.verify=function(c,d){return this.eddsa.verify(c,d,this)},u.prototype.getSecret=function(c){return o(this._secret,"KeyPair is public only"),s.encode(this.secret(),c)},u.prototype.getPublic=function(c){return s.encode(this.pubBytes(),c)},n.exports=u},{"../utils":419}],417:[function(t,n,i){var s=t("bn.js"),o=t("../utils"),a=o.assert,l=o.cachedProperty,u=o.parseBytes;function c(d,h){this.eddsa=d,typeof h!="object"&&(h=u(h)),Array.isArray(h)&&(h={R:h.slice(0,d.encodingLength),S:h.slice(d.encodingLength)}),a(h.R&&h.S,"Signature without R or S"),d.isPoint(h.R)&&(this._R=h.R),h.S instanceof s&&(this._S=h.S),this._Rencoded=Array.isArray(h.R)?h.R:h.Rencoded,this._Sencoded=Array.isArray(h.S)?h.S:h.Sencoded}l(c,"S",(function(){return this.eddsa.decodeInt(this.Sencoded())})),l(c,"R",(function(){return this.eddsa.decodePoint(this.Rencoded())})),l(c,"Rencoded",(function(){return this.eddsa.encodePoint(this.R())})),l(c,"Sencoded",(function(){return this.eddsa.encodeInt(this.S())})),c.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},c.prototype.toHex=function(){return o.encode(this.toBytes(),"hex").toUpperCase()},n.exports=c},{"../utils":419,"bn.js":420}],418:[function(t,n,i){n.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}},{}],419:[function(t,n,i){var s=i,o=t("bn.js"),a=t("minimalistic-assert"),l=t("minimalistic-crypto-utils");s.assert=a,s.toArray=l.toArray,s.zero2=l.zero2,s.toHex=l.toHex,s.encode=l.encode,s.getNAF=function(u,c,d){var h=new Array(Math.max(u.bitLength(),d)+1);h.fill(0);for(var f=1<<c+1,m=u.clone(),p=0;p<h.length;p++){var g,v=m.andln(f-1);m.isOdd()?(g=v>(f>>1)-1?(f>>1)-v:v,m.isubn(g)):g=0,h[p]=g,m.iushrn(1)}return h},s.getJSF=function(u,c){var d=[[],[]];u=u.clone(),c=c.clone();for(var h,f=0,m=0;u.cmpn(-f)>0||c.cmpn(-m)>0;){var p,g,v=u.andln(3)+f&3,y=c.andln(3)+m&3;v===3&&(v=-1),y===3&&(y=-1),p=(1&v)==0?0:(h=u.andln(7)+f&7)!==3&&h!==5||y!==2?v:-v,d[0].push(p),g=(1&y)==0?0:(h=c.andln(7)+m&7)!==3&&h!==5||v!==2?y:-y,d[1].push(g),2*f===p+1&&(f=1-f),2*m===g+1&&(m=1-m),u.iushrn(1),c.iushrn(1)}return d},s.cachedProperty=function(u,c,d){var h="_"+c;u.prototype[c]=function(){return this[h]!==void 0?this[h]:this[h]=d.call(this)}},s.parseBytes=function(u){return typeof u=="string"?s.toArray(u,"hex"):u},s.intFromLE=function(u){return new o(u,"hex","le")}},{"bn.js":420,"minimalistic-assert":453,"minimalistic-crypto-utils":454}],420:[function(t,n,i){arguments[4][184][0].apply(i,arguments)},{buffer:188,dup:184}],421:[function(t,n,i){n.exports={name:"elliptic",version:"6.5.4",description:"EC cryptography",main:"lib/elliptic.js",files:["lib"],scripts:{lint:"eslint lib test","lint:fix":"npm run lint -- --fix",unit:"istanbul test _mocha --reporter=spec test/index.js",test:"npm run lint && npm run unit",version:"grunt dist && git add dist/"},repository:{type:"git",url:"git@github.com:indutny/elliptic"},keywords:["EC","Elliptic","curve","Cryptography"],author:"Fedor Indutny <fedor@indutny.com>",license:"MIT",bugs:{url:"https://github.com/indutny/elliptic/issues"},homepage:"https://github.com/indutny/elliptic",devDependencies:{brfs:"^2.0.2",coveralls:"^3.1.0",eslint:"^7.6.0",grunt:"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.5",mocha:"^8.0.1"},dependencies:{"bn.js":"^4.11.9",brorand:"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1",inherits:"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"}}},{}],422:[function(t,n,i){var s=Object.create||function(k){var P=function(){};return P.prototype=k,new P},o=Object.keys||function(k){var P=[];for(var U in k)Object.prototype.hasOwnProperty.call(k,U)&&P.push(U);return U},a=Function.prototype.bind||function(k){var P=this;return function(){return P.apply(k,arguments)}};function l(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=s(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}n.exports=l,l.EventEmitter=l,l.prototype._events=void 0,l.prototype._maxListeners=void 0;var u,c=10;try{var d={};Object.defineProperty&&Object.defineProperty(d,"x",{value:0}),u=d.x===0}catch{u=!1}function h(k){return k._maxListeners===void 0?l.defaultMaxListeners:k._maxListeners}function f(k,P,U){if(P)k.call(U);else for(var $=k.length,V=L(k,$),R=0;R<$;++R)V[R].call(U)}function m(k,P,U,$){if(P)k.call(U,$);else for(var V=k.length,R=L(k,V),O=0;O<V;++O)R[O].call(U,$)}function p(k,P,U,$,V){if(P)k.call(U,$,V);else for(var R=k.length,O=L(k,R),T=0;T<R;++T)O[T].call(U,$,V)}function g(k,P,U,$,V,R){if(P)k.call(U,$,V,R);else for(var O=k.length,T=L(k,O),w=0;w<O;++w)T[w].call(U,$,V,R)}function v(k,P,U,$){if(P)k.apply(U,$);else for(var V=k.length,R=L(k,V),O=0;O<V;++O)R[O].apply(U,$)}function y(k,P,U,$){var V,R,O;if(typeof U!="function")throw new TypeError('"listener" argument must be a function');if((R=k._events)?(R.newListener&&(k.emit("newListener",P,U.listener?U.listener:U),R=k._events),O=R[P]):(R=k._events=s(null),k._eventsCount=0),O){if(typeof O=="function"?O=R[P]=$?[U,O]:[O,U]:$?O.unshift(U):O.push(U),!O.warned&&(V=h(k))&&V>0&&O.length>V){O.warned=!0;var T=new Error("Possible EventEmitter memory leak detected. "+O.length+' "'+String(P)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');T.name="MaxListenersExceededWarning",T.emitter=k,T.type=P,T.count=O.length,typeof console=="object"&&console.warn&&console.warn("%s: %s",T.name,T.message)}}else O=R[P]=U,++k._eventsCount;return k}function b(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var k=new Array(arguments.length),P=0;P<k.length;++P)k[P]=arguments[P];this.listener.apply(this.target,k)}}function E(k,P,U){var $={fired:!1,wrapFn:void 0,target:k,type:P,listener:U},V=a.call(b,$);return V.listener=U,$.wrapFn=V,V}function A(k,P,U){var $=k._events;if(!$)return[];var V=$[P];return V?typeof V=="function"?U?[V.listener||V]:[V]:U?(function(R){for(var O=new Array(R.length),T=0;T<O.length;++T)O[T]=R[T].listener||R[T];return O})(V):L(V,V.length):[]}function M(k){var P=this._events;if(P){var U=P[k];if(typeof U=="function")return 1;if(U)return U.length}return 0}function L(k,P){for(var U=new Array(P),$=0;$<P;++$)U[$]=k[$];return U}u?Object.defineProperty(l,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(k){if(typeof k!="number"||k<0||k!=k)throw new TypeError('"defaultMaxListeners" must be a positive number');c=k}}):l.defaultMaxListeners=c,l.prototype.setMaxListeners=function(k){if(typeof k!="number"||k<0||isNaN(k))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=k,this},l.prototype.getMaxListeners=function(){return h(this)},l.prototype.emit=function(k){var P,U,$,V,R,O,T=k==="error";if(O=this._events)T=T&&O.error==null;else if(!T)return!1;if(T){if(arguments.length>1&&(P=arguments[1]),P instanceof Error)throw P;var w=new Error('Unhandled "error" event. ('+P+")");throw w.context=P,w}if(!(U=O[k]))return!1;var x=typeof U=="function";switch($=arguments.length){case 1:f(U,x,this);break;case 2:m(U,x,this,arguments[1]);break;case 3:p(U,x,this,arguments[1],arguments[2]);break;case 4:g(U,x,this,arguments[1],arguments[2],arguments[3]);break;default:for(V=new Array($-1),R=1;R<$;R++)V[R-1]=arguments[R];v(U,x,this,V)}return!0},l.prototype.addListener=function(k,P){return y(this,k,P,!1)},l.prototype.on=l.prototype.addListener,l.prototype.prependListener=function(k,P){return y(this,k,P,!0)},l.prototype.once=function(k,P){if(typeof P!="function")throw new TypeError('"listener" argument must be a function');return this.on(k,E(this,k,P)),this},l.prototype.prependOnceListener=function(k,P){if(typeof P!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(k,E(this,k,P)),this},l.prototype.removeListener=function(k,P){var U,$,V,R,O;if(typeof P!="function")throw new TypeError('"listener" argument must be a function');if(!($=this._events))return this;if(!(U=$[k]))return this;if(U===P||U.listener===P)--this._eventsCount==0?this._events=s(null):(delete $[k],$.removeListener&&this.emit("removeListener",k,U.listener||P));else if(typeof U!="function"){for(V=-1,R=U.length-1;R>=0;R--)if(U[R]===P||U[R].listener===P){O=U[R].listener,V=R;break}if(V<0)return this;V===0?U.shift():(function(T,w){for(var x=w,_=x+1,S=T.length;_<S;x+=1,_+=1)T[x]=T[_];T.pop()})(U,V),U.length===1&&($[k]=U[0]),$.removeListener&&this.emit("removeListener",k,O||P)}return this},l.prototype.removeAllListeners=function(k){var P,U,$;if(!(U=this._events))return this;if(!U.removeListener)return arguments.length===0?(this._events=s(null),this._eventsCount=0):U[k]&&(--this._eventsCount==0?this._events=s(null):delete U[k]),this;if(arguments.length===0){var V,R=o(U);for($=0;$<R.length;++$)(V=R[$])!=="removeListener"&&this.removeAllListeners(V);return this.removeAllListeners("removeListener"),this._events=s(null),this._eventsCount=0,this}if(typeof(P=U[k])=="function")this.removeListener(k,P);else if(P)for($=P.length-1;$>=0;$--)this.removeListener(k,P[$]);return this},l.prototype.listeners=function(k){return A(this,k,!0)},l.prototype.rawListeners=function(k){return A(this,k,!1)},l.listenerCount=function(k,P){return typeof k.listenerCount=="function"?k.listenerCount(P):M.call(k,P)},l.prototype.listenerCount=M,l.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]}},{}],423:[function(t,n,i){var s=t("safe-buffer").Buffer,o=t("md5.js");n.exports=function(a,l,u,c){if(s.isBuffer(a)||(a=s.from(a,"binary")),l&&(s.isBuffer(l)||(l=s.from(l,"binary")),l.length!==8))throw new RangeError("salt should be Buffer with 8 byte length");for(var d=u/8,h=s.alloc(d),f=s.alloc(c||0),m=s.alloc(0);d>0||c>0;){var p=new o;p.update(m),p.update(a),l&&p.update(l),m=p.digest();var g=0;if(d>0){var v=h.length-d;g=Math.min(d,m.length),m.copy(h,v,0,g),d-=g}if(g<m.length&&c>0){var y=f.length-c,b=Math.min(c,m.length-g);m.copy(f,y,g,g+b),c-=b}}return m.fill(0),{key:h,iv:f}}},{"md5.js":450,"safe-buffer":494}],424:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.CsvParserStream=i.ParserOptions=i.parseFile=i.parseStream=i.parseString=i.parse=i.FormatterOptions=i.CsvFormatterStream=i.writeToPath=i.writeToString=i.writeToBuffer=i.writeToStream=i.write=i.format=void 0;var s=t("@fast-csv/format");Object.defineProperty(i,"format",{enumerable:!0,get:function(){return s.format}}),Object.defineProperty(i,"write",{enumerable:!0,get:function(){return s.write}}),Object.defineProperty(i,"writeToStream",{enumerable:!0,get:function(){return s.writeToStream}}),Object.defineProperty(i,"writeToBuffer",{enumerable:!0,get:function(){return s.writeToBuffer}}),Object.defineProperty(i,"writeToString",{enumerable:!0,get:function(){return s.writeToString}}),Object.defineProperty(i,"writeToPath",{enumerable:!0,get:function(){return s.writeToPath}}),Object.defineProperty(i,"CsvFormatterStream",{enumerable:!0,get:function(){return s.CsvFormatterStream}}),Object.defineProperty(i,"FormatterOptions",{enumerable:!0,get:function(){return s.FormatterOptions}});var o=t("@fast-csv/parse");Object.defineProperty(i,"parse",{enumerable:!0,get:function(){return o.parse}}),Object.defineProperty(i,"parseString",{enumerable:!0,get:function(){return o.parseString}}),Object.defineProperty(i,"parseStream",{enumerable:!0,get:function(){return o.parseStream}}),Object.defineProperty(i,"parseFile",{enumerable:!0,get:function(){return o.parseFile}}),Object.defineProperty(i,"ParserOptions",{enumerable:!0,get:function(){return o.ParserOptions}}),Object.defineProperty(i,"CsvParserStream",{enumerable:!0,get:function(){return o.CsvParserStream}})},{"@fast-csv/format":151,"@fast-csv/parse":155}],425:[function(t,n,i){var s=t("safe-buffer").Buffer,o=t("readable-stream").Transform;function a(l){o.call(this),this._block=s.allocUnsafe(l),this._blockSize=l,this._blockOffset=0,this._length=[0,0,0,0],this._finalized=!1}t("inherits")(a,o),a.prototype._transform=function(l,u,c){var d=null;try{this.update(l,u)}catch(h){d=h}c(d)},a.prototype._flush=function(l){var u=null;try{this.push(this.digest())}catch(c){u=c}l(u)},a.prototype.update=function(l,u){if((function(p,g){if(!s.isBuffer(p)&&typeof p!="string")throw new TypeError(g+" must be a string or a buffer")})(l,"Data"),this._finalized)throw new Error("Digest already called");s.isBuffer(l)||(l=s.from(l,u));for(var c=this._block,d=0;this._blockOffset+l.length-d>=this._blockSize;){for(var h=this._blockOffset;h<this._blockSize;)c[h++]=l[d++];this._update(),this._blockOffset=0}for(;d<l.length;)c[this._blockOffset++]=l[d++];for(var f=0,m=8*l.length;m>0;++f)this._length[f]+=m,(m=this._length[f]/4294967296|0)>0&&(this._length[f]-=4294967296*m);return this},a.prototype._update=function(){throw new Error("_update is not implemented")},a.prototype.digest=function(l){if(this._finalized)throw new Error("Digest already called");this._finalized=!0;var u=this._digest();l!==void 0&&(u=u.toString(l)),this._block.fill(0),this._blockOffset=0;for(var c=0;c<4;++c)this._length[c]=0;return u},a.prototype._digest=function(){throw new Error("_digest is not implemented")},n.exports=a},{inherits:440,"readable-stream":491,"safe-buffer":494}],426:[function(t,n,i){var s=i;s.utils=t("./hash/utils"),s.common=t("./hash/common"),s.sha=t("./hash/sha"),s.ripemd=t("./hash/ripemd"),s.hmac=t("./hash/hmac"),s.sha1=s.sha.sha1,s.sha256=s.sha.sha256,s.sha224=s.sha.sha224,s.sha384=s.sha.sha384,s.sha512=s.sha.sha512,s.ripemd160=s.ripemd.ripemd160},{"./hash/common":427,"./hash/hmac":428,"./hash/ripemd":429,"./hash/sha":430,"./hash/utils":437}],427:[function(t,n,i){var s=t("./utils"),o=t("minimalistic-assert");function a(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}i.BlockHash=a,a.prototype.update=function(l,u){if(l=s.toArray(l,u),this.pending?this.pending=this.pending.concat(l):this.pending=l,this.pendingTotal+=l.length,this.pending.length>=this._delta8){var c=(l=this.pending).length%this._delta8;this.pending=l.slice(l.length-c,l.length),this.pending.length===0&&(this.pending=null),l=s.join32(l,0,l.length-c,this.endian);for(var d=0;d<l.length;d+=this._delta32)this._update(l,d,d+this._delta32)}return this},a.prototype.digest=function(l){return this.update(this._pad()),o(this.pending===null),this._digest(l)},a.prototype._pad=function(){var l=this.pendingTotal,u=this._delta8,c=u-(l+this.padLength)%u,d=new Array(c+this.padLength);d[0]=128;for(var h=1;h<c;h++)d[h]=0;if(l<<=3,this.endian==="big"){for(var f=8;f<this.padLength;f++)d[h++]=0;d[h++]=0,d[h++]=0,d[h++]=0,d[h++]=0,d[h++]=l>>>24&255,d[h++]=l>>>16&255,d[h++]=l>>>8&255,d[h++]=255&l}else for(d[h++]=255&l,d[h++]=l>>>8&255,d[h++]=l>>>16&255,d[h++]=l>>>24&255,d[h++]=0,d[h++]=0,d[h++]=0,d[h++]=0,f=8;f<this.padLength;f++)d[h++]=0;return d}},{"./utils":437,"minimalistic-assert":453}],428:[function(t,n,i){var s=t("./utils"),o=t("minimalistic-assert");function a(l,u,c){if(!(this instanceof a))return new a(l,u,c);this.Hash=l,this.blockSize=l.blockSize/8,this.outSize=l.outSize/8,this.inner=null,this.outer=null,this._init(s.toArray(u,c))}n.exports=a,a.prototype._init=function(l){l.length>this.blockSize&&(l=new this.Hash().update(l).digest()),o(l.length<=this.blockSize);for(var u=l.length;u<this.blockSize;u++)l.push(0);for(u=0;u<l.length;u++)l[u]^=54;for(this.inner=new this.Hash().update(l),u=0;u<l.length;u++)l[u]^=106;this.outer=new this.Hash().update(l)},a.prototype.update=function(l,u){return this.inner.update(l,u),this},a.prototype.digest=function(l){return this.outer.update(this.inner.digest()),this.outer.digest(l)}},{"./utils":437,"minimalistic-assert":453}],429:[function(t,n,i){var s=t("./utils"),o=t("./common"),a=s.rotl32,l=s.sum32,u=s.sum32_3,c=s.sum32_4,d=o.BlockHash;function h(){if(!(this instanceof h))return new h;d.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}function f(E,A,M,L){return E<=15?A^M^L:E<=31?A&M|~A&L:E<=47?(A|~M)^L:E<=63?A&L|M&~L:A^(M|~L)}function m(E){return E<=15?0:E<=31?1518500249:E<=47?1859775393:E<=63?2400959708:2840853838}function p(E){return E<=15?1352829926:E<=31?1548603684:E<=47?1836072691:E<=63?2053994217:0}s.inherits(h,d),i.ripemd160=h,h.blockSize=512,h.outSize=160,h.hmacStrength=192,h.padLength=64,h.prototype._update=function(E,A){for(var M=this.h[0],L=this.h[1],k=this.h[2],P=this.h[3],U=this.h[4],$=M,V=L,R=k,O=P,T=U,w=0;w<80;w++){var x=l(a(c(M,f(w,L,k,P),E[g[w]+A],m(w)),y[w]),U);M=U,U=P,P=a(k,10),k=L,L=x,x=l(a(c($,f(79-w,V,R,O),E[v[w]+A],p(w)),b[w]),T),$=T,T=O,O=a(R,10),R=V,V=x}x=u(this.h[1],k,O),this.h[1]=u(this.h[2],P,T),this.h[2]=u(this.h[3],U,$),this.h[3]=u(this.h[4],M,V),this.h[4]=u(this.h[0],L,R),this.h[0]=x},h.prototype._digest=function(E){return E==="hex"?s.toHex32(this.h,"little"):s.split32(this.h,"little")};var g=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],v=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],y=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],b=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},{"./common":427,"./utils":437}],430:[function(t,n,i){i.sha1=t("./sha/1"),i.sha224=t("./sha/224"),i.sha256=t("./sha/256"),i.sha384=t("./sha/384"),i.sha512=t("./sha/512")},{"./sha/1":431,"./sha/224":432,"./sha/256":433,"./sha/384":434,"./sha/512":435}],431:[function(t,n,i){var s=t("../utils"),o=t("../common"),a=t("./common"),l=s.rotl32,u=s.sum32,c=s.sum32_5,d=a.ft_1,h=o.BlockHash,f=[1518500249,1859775393,2400959708,3395469782];function m(){if(!(this instanceof m))return new m;h.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}s.inherits(m,h),n.exports=m,m.blockSize=512,m.outSize=160,m.hmacStrength=80,m.padLength=64,m.prototype._update=function(p,g){for(var v=this.W,y=0;y<16;y++)v[y]=p[g+y];for(;y<v.length;y++)v[y]=l(v[y-3]^v[y-8]^v[y-14]^v[y-16],1);var b=this.h[0],E=this.h[1],A=this.h[2],M=this.h[3],L=this.h[4];for(y=0;y<v.length;y++){var k=~~(y/20),P=c(l(b,5),d(k,E,A,M),L,v[y],f[k]);L=M,M=A,A=l(E,30),E=b,b=P}this.h[0]=u(this.h[0],b),this.h[1]=u(this.h[1],E),this.h[2]=u(this.h[2],A),this.h[3]=u(this.h[3],M),this.h[4]=u(this.h[4],L)},m.prototype._digest=function(p){return p==="hex"?s.toHex32(this.h,"big"):s.split32(this.h,"big")}},{"../common":427,"../utils":437,"./common":436}],432:[function(t,n,i){var s=t("../utils"),o=t("./256");function a(){if(!(this instanceof a))return new a;o.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}s.inherits(a,o),n.exports=a,a.blockSize=512,a.outSize=224,a.hmacStrength=192,a.padLength=64,a.prototype._digest=function(l){return l==="hex"?s.toHex32(this.h.slice(0,7),"big"):s.split32(this.h.slice(0,7),"big")}},{"../utils":437,"./256":433}],433:[function(t,n,i){var s=t("../utils"),o=t("../common"),a=t("./common"),l=t("minimalistic-assert"),u=s.sum32,c=s.sum32_4,d=s.sum32_5,h=a.ch32,f=a.maj32,m=a.s0_256,p=a.s1_256,g=a.g0_256,v=a.g1_256,y=o.BlockHash,b=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function E(){if(!(this instanceof E))return new E;y.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=b,this.W=new Array(64)}s.inherits(E,y),n.exports=E,E.blockSize=512,E.outSize=256,E.hmacStrength=192,E.padLength=64,E.prototype._update=function(A,M){for(var L=this.W,k=0;k<16;k++)L[k]=A[M+k];for(;k<L.length;k++)L[k]=c(v(L[k-2]),L[k-7],g(L[k-15]),L[k-16]);var P=this.h[0],U=this.h[1],$=this.h[2],V=this.h[3],R=this.h[4],O=this.h[5],T=this.h[6],w=this.h[7];for(l(this.k.length===L.length),k=0;k<L.length;k++){var x=d(w,p(R),h(R,O,T),this.k[k],L[k]),_=u(m(P),f(P,U,$));w=T,T=O,O=R,R=u(V,x),V=$,$=U,U=P,P=u(x,_)}this.h[0]=u(this.h[0],P),this.h[1]=u(this.h[1],U),this.h[2]=u(this.h[2],$),this.h[3]=u(this.h[3],V),this.h[4]=u(this.h[4],R),this.h[5]=u(this.h[5],O),this.h[6]=u(this.h[6],T),this.h[7]=u(this.h[7],w)},E.prototype._digest=function(A){return A==="hex"?s.toHex32(this.h,"big"):s.split32(this.h,"big")}},{"../common":427,"../utils":437,"./common":436,"minimalistic-assert":453}],434:[function(t,n,i){var s=t("../utils"),o=t("./512");function a(){if(!(this instanceof a))return new a;o.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}s.inherits(a,o),n.exports=a,a.blockSize=1024,a.outSize=384,a.hmacStrength=192,a.padLength=128,a.prototype._digest=function(l){return l==="hex"?s.toHex32(this.h.slice(0,12),"big"):s.split32(this.h.slice(0,12),"big")}},{"../utils":437,"./512":435}],435:[function(t,n,i){var s=t("../utils"),o=t("../common"),a=t("minimalistic-assert"),l=s.rotr64_hi,u=s.rotr64_lo,c=s.shr64_hi,d=s.shr64_lo,h=s.sum64,f=s.sum64_hi,m=s.sum64_lo,p=s.sum64_4_hi,g=s.sum64_4_lo,v=s.sum64_5_hi,y=s.sum64_5_lo,b=o.BlockHash,E=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function A(){if(!(this instanceof A))return new A;b.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=E,this.W=new Array(160)}function M(_,S,C,F,D){var H=_&C^~_&D;return H<0&&(H+=4294967296),H}function L(_,S,C,F,D,H){var G=S&F^~S&H;return G<0&&(G+=4294967296),G}function k(_,S,C,F,D){var H=_&C^_&D^C&D;return H<0&&(H+=4294967296),H}function P(_,S,C,F,D,H){var G=S&F^S&H^F&H;return G<0&&(G+=4294967296),G}function U(_,S){var C=l(_,S,28)^l(S,_,2)^l(S,_,7);return C<0&&(C+=4294967296),C}function $(_,S){var C=u(_,S,28)^u(S,_,2)^u(S,_,7);return C<0&&(C+=4294967296),C}function V(_,S){var C=l(_,S,14)^l(_,S,18)^l(S,_,9);return C<0&&(C+=4294967296),C}function R(_,S){var C=u(_,S,14)^u(_,S,18)^u(S,_,9);return C<0&&(C+=4294967296),C}function O(_,S){var C=l(_,S,1)^l(_,S,8)^c(_,S,7);return C<0&&(C+=4294967296),C}function T(_,S){var C=u(_,S,1)^u(_,S,8)^d(_,S,7);return C<0&&(C+=4294967296),C}function w(_,S){var C=l(_,S,19)^l(S,_,29)^c(_,S,6);return C<0&&(C+=4294967296),C}function x(_,S){var C=u(_,S,19)^u(S,_,29)^d(_,S,6);return C<0&&(C+=4294967296),C}s.inherits(A,b),n.exports=A,A.blockSize=1024,A.outSize=512,A.hmacStrength=192,A.padLength=128,A.prototype._prepareBlock=function(_,S){for(var C=this.W,F=0;F<32;F++)C[F]=_[S+F];for(;F<C.length;F+=2){var D=w(C[F-4],C[F-3]),H=x(C[F-4],C[F-3]),G=C[F-14],ee=C[F-13],B=O(C[F-30],C[F-29]),X=T(C[F-30],C[F-29]),I=C[F-32],N=C[F-31];C[F]=p(D,H,G,ee,B,X,I,N),C[F+1]=g(D,H,G,ee,B,X,I,N)}},A.prototype._update=function(_,S){this._prepareBlock(_,S);var C=this.W,F=this.h[0],D=this.h[1],H=this.h[2],G=this.h[3],ee=this.h[4],B=this.h[5],X=this.h[6],I=this.h[7],N=this.h[8],j=this.h[9],Q=this.h[10],W=this.h[11],Y=this.h[12],Z=this.h[13],se=this.h[14],re=this.h[15];a(this.k.length===C.length);for(var K=0;K<C.length;K+=2){var ie=se,ne=re,le=V(N,j),ae=R(N,j),fe=M(N,j,Q,W,Y),pe=L(N,j,Q,W,Y,Z),ye=this.k[K],xe=this.k[K+1],Ne=C[K],Oe=C[K+1],Me=v(ie,ne,le,ae,fe,pe,ye,xe,Ne,Oe),qe=y(ie,ne,le,ae,fe,pe,ye,xe,Ne,Oe);ie=U(F,D),ne=$(F,D),le=k(F,D,H,G,ee),ae=P(F,D,H,G,ee,B);var We=f(ie,ne,le,ae),Ke=m(ie,ne,le,ae);se=Y,re=Z,Y=Q,Z=W,Q=N,W=j,N=f(X,I,Me,qe),j=m(I,I,Me,qe),X=ee,I=B,ee=H,B=G,H=F,G=D,F=f(Me,qe,We,Ke),D=m(Me,qe,We,Ke)}h(this.h,0,F,D),h(this.h,2,H,G),h(this.h,4,ee,B),h(this.h,6,X,I),h(this.h,8,N,j),h(this.h,10,Q,W),h(this.h,12,Y,Z),h(this.h,14,se,re)},A.prototype._digest=function(_){return _==="hex"?s.toHex32(this.h,"big"):s.split32(this.h,"big")}},{"../common":427,"../utils":437,"minimalistic-assert":453}],436:[function(t,n,i){var s=t("../utils").rotr32;function o(u,c,d){return u&c^~u&d}function a(u,c,d){return u&c^u&d^c&d}function l(u,c,d){return u^c^d}i.ft_1=function(u,c,d,h){return u===0?o(c,d,h):u===1||u===3?l(c,d,h):u===2?a(c,d,h):void 0},i.ch32=o,i.maj32=a,i.p32=l,i.s0_256=function(u){return s(u,2)^s(u,13)^s(u,22)},i.s1_256=function(u){return s(u,6)^s(u,11)^s(u,25)},i.g0_256=function(u){return s(u,7)^s(u,18)^u>>>3},i.g1_256=function(u){return s(u,17)^s(u,19)^u>>>10}},{"../utils":437}],437:[function(t,n,i){var s=t("minimalistic-assert"),o=t("inherits");function a(d,h){return(64512&d.charCodeAt(h))==55296&&!(h<0||h+1>=d.length)&&(64512&d.charCodeAt(h+1))==56320}function l(d){return(d>>>24|d>>>8&65280|d<<8&16711680|(255&d)<<24)>>>0}function u(d){return d.length===1?"0"+d:d}function c(d){return d.length===7?"0"+d:d.length===6?"00"+d:d.length===5?"000"+d:d.length===4?"0000"+d:d.length===3?"00000"+d:d.length===2?"000000"+d:d.length===1?"0000000"+d:d}i.inherits=o,i.toArray=function(d,h){if(Array.isArray(d))return d.slice();if(!d)return[];var f=[];if(typeof d=="string")if(h){if(h==="hex")for((d=d.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(d="0"+d),p=0;p<d.length;p+=2)f.push(parseInt(d[p]+d[p+1],16))}else for(var m=0,p=0;p<d.length;p++){var g=d.charCodeAt(p);g<128?f[m++]=g:g<2048?(f[m++]=g>>6|192,f[m++]=63&g|128):a(d,p)?(g=65536+((1023&g)<<10)+(1023&d.charCodeAt(++p)),f[m++]=g>>18|240,f[m++]=g>>12&63|128,f[m++]=g>>6&63|128,f[m++]=63&g|128):(f[m++]=g>>12|224,f[m++]=g>>6&63|128,f[m++]=63&g|128)}else for(p=0;p<d.length;p++)f[p]=0|d[p];return f},i.toHex=function(d){for(var h="",f=0;f<d.length;f++)h+=u(d[f].toString(16));return h},i.htonl=l,i.toHex32=function(d,h){for(var f="",m=0;m<d.length;m++){var p=d[m];h==="little"&&(p=l(p)),f+=c(p.toString(16))}return f},i.zero2=u,i.zero8=c,i.join32=function(d,h,f,m){var p=f-h;s(p%4==0);for(var g=new Array(p/4),v=0,y=h;v<g.length;v++,y+=4){var b;b=m==="big"?d[y]<<24|d[y+1]<<16|d[y+2]<<8|d[y+3]:d[y+3]<<24|d[y+2]<<16|d[y+1]<<8|d[y],g[v]=b>>>0}return g},i.split32=function(d,h){for(var f=new Array(4*d.length),m=0,p=0;m<d.length;m++,p+=4){var g=d[m];h==="big"?(f[p]=g>>>24,f[p+1]=g>>>16&255,f[p+2]=g>>>8&255,f[p+3]=255&g):(f[p+3]=g>>>24,f[p+2]=g>>>16&255,f[p+1]=g>>>8&255,f[p]=255&g)}return f},i.rotr32=function(d,h){return d>>>h|d<<32-h},i.rotl32=function(d,h){return d<<h|d>>>32-h},i.sum32=function(d,h){return d+h>>>0},i.sum32_3=function(d,h,f){return d+h+f>>>0},i.sum32_4=function(d,h,f,m){return d+h+f+m>>>0},i.sum32_5=function(d,h,f,m,p){return d+h+f+m+p>>>0},i.sum64=function(d,h,f,m){var p=d[h],g=m+d[h+1]>>>0,v=(g<m?1:0)+f+p;d[h]=v>>>0,d[h+1]=g},i.sum64_hi=function(d,h,f,m){return(h+m>>>0<h?1:0)+d+f>>>0},i.sum64_lo=function(d,h,f,m){return h+m>>>0},i.sum64_4_hi=function(d,h,f,m,p,g,v,y){var b=0,E=h;return b+=(E=E+m>>>0)<h?1:0,b+=(E=E+g>>>0)<g?1:0,d+f+p+v+(b+=(E=E+y>>>0)<y?1:0)>>>0},i.sum64_4_lo=function(d,h,f,m,p,g,v,y){return h+m+g+y>>>0},i.sum64_5_hi=function(d,h,f,m,p,g,v,y,b,E){var A=0,M=h;return A+=(M=M+m>>>0)<h?1:0,A+=(M=M+g>>>0)<g?1:0,A+=(M=M+y>>>0)<y?1:0,d+f+p+v+b+(A+=(M=M+E>>>0)<E?1:0)>>>0},i.sum64_5_lo=function(d,h,f,m,p,g,v,y,b,E){return h+m+g+y+E>>>0},i.rotr64_hi=function(d,h,f){return(h<<32-f|d>>>f)>>>0},i.rotr64_lo=function(d,h,f){return(d<<32-f|h>>>f)>>>0},i.shr64_hi=function(d,h,f){return d>>>f},i.shr64_lo=function(d,h,f){return(d<<32-f|h>>>f)>>>0}},{inherits:440,"minimalistic-assert":453}],438:[function(t,n,i){var s=t("hash.js"),o=t("minimalistic-crypto-utils"),a=t("minimalistic-assert");function l(u){if(!(this instanceof l))return new l(u);this.hash=u.hash,this.predResist=!!u.predResist,this.outLen=this.hash.outSize,this.minEntropy=u.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var c=o.toArray(u.entropy,u.entropyEnc||"hex"),d=o.toArray(u.nonce,u.nonceEnc||"hex"),h=o.toArray(u.pers,u.persEnc||"hex");a(c.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(c,d,h)}n.exports=l,l.prototype._init=function(u,c,d){var h=u.concat(c).concat(d);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var f=0;f<this.V.length;f++)this.K[f]=0,this.V[f]=1;this._update(h),this._reseed=1,this.reseedInterval=281474976710656},l.prototype._hmac=function(){return new s.hmac(this.hash,this.K)},l.prototype._update=function(u){var c=this._hmac().update(this.V).update([0]);u&&(c=c.update(u)),this.K=c.digest(),this.V=this._hmac().update(this.V).digest(),u&&(this.K=this._hmac().update(this.V).update([1]).update(u).digest(),this.V=this._hmac().update(this.V).digest())},l.prototype.reseed=function(u,c,d,h){typeof c!="string"&&(h=d,d=c,c=null),u=o.toArray(u,c),d=o.toArray(d,h),a(u.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(u.concat(d||[])),this._reseed=1},l.prototype.generate=function(u,c,d,h){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof c!="string"&&(h=d,d=c,c=null),d&&(d=o.toArray(d,h||"hex"),this._update(d));for(var f=[];f.length<u;)this.V=this._hmac().update(this.V).digest(),f=f.concat(this.V);var m=f.slice(0,u);return this._update(d),this._reseed++,o.encode(m,c)}},{"hash.js":426,"minimalistic-assert":453,"minimalistic-crypto-utils":454}],439:[function(t,n,i){i.read=function(s,o,a,l,u){var c,d,h=8*u-l-1,f=(1<<h)-1,m=f>>1,p=-7,g=a?u-1:0,v=a?-1:1,y=s[o+g];for(g+=v,c=y&(1<<-p)-1,y>>=-p,p+=h;p>0;c=256*c+s[o+g],g+=v,p-=8);for(d=c&(1<<-p)-1,c>>=-p,p+=l;p>0;d=256*d+s[o+g],g+=v,p-=8);if(c===0)c=1-m;else{if(c===f)return d?NaN:1/0*(y?-1:1);d+=Math.pow(2,l),c-=m}return(y?-1:1)*d*Math.pow(2,c-l)},i.write=function(s,o,a,l,u,c){var d,h,f,m=8*c-u-1,p=(1<<m)-1,g=p>>1,v=u===23?Math.pow(2,-24)-Math.pow(2,-77):0,y=l?0:c-1,b=l?1:-1,E=o<0||o===0&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(h=isNaN(o)?1:0,d=p):(d=Math.floor(Math.log(o)/Math.LN2),o*(f=Math.pow(2,-d))<1&&(d--,f*=2),(o+=d+g>=1?v/f:v*Math.pow(2,1-g))*f>=2&&(d++,f/=2),d+g>=p?(h=0,d=p):d+g>=1?(h=(o*f-1)*Math.pow(2,u),d+=g):(h=o*Math.pow(2,g-1)*Math.pow(2,u),d=0));u>=8;s[a+y]=255&h,y+=b,h/=256,u-=8);for(d=d<<u|h,m+=u;m>0;s[a+y]=255&d,y+=b,d/=256,m-=8);s[a+y-b]|=128*E}},{}],440:[function(t,n,i){typeof Object.create=="function"?n.exports=function(s,o){o&&(s.super_=o,s.prototype=Object.create(o.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}))}:n.exports=function(s,o){if(o){s.super_=o;var a=function(){};a.prototype=o.prototype,s.prototype=new a,s.prototype.constructor=s}}},{}],441:[function(t,n,i){(function(s,o,a,l,u,c,d,h){(function(){(function(f){typeof i=="object"&&n!==void 0?n.exports=f():(typeof window<"u"?window:o!==void 0?o:typeof self<"u"?self:this).JSZip=f()})((function(){return(function f(m,p,g){function v(E,A){if(!p[E]){if(!m[E]){var M=typeof t=="function"&&t;if(!A&&M)return M(E,!0);if(y)return y(E,!0);var L=new Error("Cannot find module '"+E+"'");throw L.code="MODULE_NOT_FOUND",L}var k=p[E]={exports:{}};m[E][0].call(k.exports,(function(P){return v(m[E][1][P]||P)}),k,k.exports,f,m,p,g)}return p[E].exports}for(var y=typeof t=="function"&&t,b=0;b<g.length;b++)v(g[b]);return v})({1:[function(f,m,p){var g=f("./utils"),v=f("./support"),y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";p.encode=function(b){for(var E,A,M,L,k,P,U,$=[],V=0,R=b.length,O=R,T=g.getTypeOf(b)!=="string";V<b.length;)O=R-V,M=T?(E=b[V++],A=V<R?b[V++]:0,V<R?b[V++]:0):(E=b.charCodeAt(V++),A=V<R?b.charCodeAt(V++):0,V<R?b.charCodeAt(V++):0),L=E>>2,k=(3&E)<<4|A>>4,P=1<O?(15&A)<<2|M>>6:64,U=2<O?63&M:64,$.push(y.charAt(L)+y.charAt(k)+y.charAt(P)+y.charAt(U));return $.join("")},p.decode=function(b){var E,A,M,L,k,P,U=0,$=0,V="data:";if(b.substr(0,V.length)===V)throw new Error("Invalid base64 input, it looks like a data url.");var R,O=3*(b=b.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(b.charAt(b.length-1)===y.charAt(64)&&O--,b.charAt(b.length-2)===y.charAt(64)&&O--,O%1!=0)throw new Error("Invalid base64 input, bad content length.");for(R=v.uint8array?new Uint8Array(0|O):new Array(0|O);U<b.length;)E=y.indexOf(b.charAt(U++))<<2|(L=y.indexOf(b.charAt(U++)))>>4,A=(15&L)<<4|(k=y.indexOf(b.charAt(U++)))>>2,M=(3&k)<<6|(P=y.indexOf(b.charAt(U++))),R[$++]=E,k!==64&&(R[$++]=A),P!==64&&(R[$++]=M);return R}},{"./support":30,"./utils":32}],2:[function(f,m,p){var g=f("./external"),v=f("./stream/DataWorker"),y=f("./stream/Crc32Probe"),b=f("./stream/DataLengthProbe");function E(A,M,L,k,P){this.compressedSize=A,this.uncompressedSize=M,this.crc32=L,this.compression=k,this.compressedContent=P}E.prototype={getContentWorker:function(){var A=new v(g.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new b("data_length")),M=this;return A.on("end",(function(){if(this.streamInfo.data_length!==M.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")})),A},getCompressedWorker:function(){return new v(g.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},E.createWorkerFrom=function(A,M,L){return A.pipe(new y).pipe(new b("uncompressedSize")).pipe(M.compressWorker(L)).pipe(new b("compressedSize")).withStreamInfo("compression",M)},m.exports=E},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(f,m,p){var g=f("./stream/GenericWorker");p.STORE={magic:"\0\0",compressWorker:function(){return new g("STORE compression")},uncompressWorker:function(){return new g("STORE decompression")}},p.DEFLATE=f("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(f,m,p){var g=f("./utils"),v=(function(){for(var y,b=[],E=0;E<256;E++){y=E;for(var A=0;A<8;A++)y=1&y?3988292384^y>>>1:y>>>1;b[E]=y}return b})();m.exports=function(y,b){return y!==void 0&&y.length?g.getTypeOf(y)!=="string"?(function(E,A,M,L){var k=v,P=0+M;E^=-1;for(var U=0;U<P;U++)E=E>>>8^k[255&(E^A[U])];return-1^E})(0|b,y,y.length):(function(E,A,M,L){var k=v,P=0+M;E^=-1;for(var U=0;U<P;U++)E=E>>>8^k[255&(E^A.charCodeAt(U))];return-1^E})(0|b,y,y.length):0}},{"./utils":32}],5:[function(f,m,p){p.base64=!1,p.binary=!1,p.dir=!1,p.createFolders=!0,p.date=null,p.compression=null,p.compressionOptions=null,p.comment=null,p.unixPermissions=null,p.dosPermissions=null},{}],6:[function(f,m,p){var g;g=typeof Promise<"u"?Promise:f("lie"),m.exports={Promise:g}},{lie:37}],7:[function(f,m,p){var g=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",v=f("pako"),y=f("./utils"),b=f("./stream/GenericWorker"),E=g?"uint8array":"array";function A(M,L){b.call(this,"FlateWorker/"+M),this._pako=null,this._pakoAction=M,this._pakoOptions=L,this.meta={}}p.magic="\b\0",y.inherits(A,b),A.prototype.processChunk=function(M){this.meta=M.meta,this._pako===null&&this._createPako(),this._pako.push(y.transformTo(E,M.data),!1)},A.prototype.flush=function(){b.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},A.prototype.cleanUp=function(){b.prototype.cleanUp.call(this),this._pako=null},A.prototype._createPako=function(){this._pako=new v[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var M=this;this._pako.onData=function(L){M.push({data:L,meta:M.meta})}},p.compressWorker=function(M){return new A("Deflate",M)},p.uncompressWorker=function(){return new A("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(f,m,p){function g(k,P){var U,$="";for(U=0;U<P;U++)$+=String.fromCharCode(255&k),k>>>=8;return $}function v(k,P,U,$,V,R){var O,T,w=k.file,x=k.compression,_=R!==E.utf8encode,S=y.transformTo("string",R(w.name)),C=y.transformTo("string",E.utf8encode(w.name)),F=w.comment,D=y.transformTo("string",R(F)),H=y.transformTo("string",E.utf8encode(F)),G=C.length!==w.name.length,ee=H.length!==F.length,B="",X="",I="",N=w.dir,j=w.date,Q={crc32:0,compressedSize:0,uncompressedSize:0};P&&!U||(Q.crc32=k.crc32,Q.compressedSize=k.compressedSize,Q.uncompressedSize=k.uncompressedSize);var W=0;P&&(W|=8),_||!G&&!ee||(W|=2048);var Y=0,Z=0;N&&(Y|=16),V==="UNIX"?(Z=798,Y|=(function(re,K){var ie=re;return re||(ie=K?16893:33204),(65535&ie)<<16})(w.unixPermissions,N)):(Z=20,Y|=(function(re){return 63&(re||0)})(w.dosPermissions)),O=j.getUTCHours(),O<<=6,O|=j.getUTCMinutes(),O<<=5,O|=j.getUTCSeconds()/2,T=j.getUTCFullYear()-1980,T<<=4,T|=j.getUTCMonth()+1,T<<=5,T|=j.getUTCDate(),G&&(X=g(1,1)+g(A(S),4)+C,B+="up"+g(X.length,2)+X),ee&&(I=g(1,1)+g(A(D),4)+H,B+="uc"+g(I.length,2)+I);var se="";return se+=`
\0`,se+=g(W,2),se+=x.magic,se+=g(O,2),se+=g(T,2),se+=g(Q.crc32,4),se+=g(Q.compressedSize,4),se+=g(Q.uncompressedSize,4),se+=g(S.length,2),se+=g(B.length,2),{fileRecord:M.LOCAL_FILE_HEADER+se+S+B,dirRecord:M.CENTRAL_FILE_HEADER+g(Z,2)+se+g(D.length,2)+"\0\0\0\0"+g(Y,4)+g($,4)+S+B+D}}var y=f("../utils"),b=f("../stream/GenericWorker"),E=f("../utf8"),A=f("../crc32"),M=f("../signature");function L(k,P,U,$){b.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=P,this.zipPlatform=U,this.encodeFileName=$,this.streamFiles=k,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}y.inherits(L,b),L.prototype.push=function(k){var P=k.meta.percent||0,U=this.entriesCount,$=this._sources.length;this.accumulate?this.contentBuffer.push(k):(this.bytesWritten+=k.data.length,b.prototype.push.call(this,{data:k.data,meta:{currentFile:this.currentFile,percent:U?(P+100*(U-$-1))/U:100}}))},L.prototype.openedSource=function(k){this.currentSourceOffset=this.bytesWritten,this.currentFile=k.file.name;var P=this.streamFiles&&!k.file.dir;if(P){var U=v(k,P,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:U.fileRecord,meta:{percent:0}})}else this.accumulate=!0},L.prototype.closedSource=function(k){this.accumulate=!1;var P=this.streamFiles&&!k.file.dir,U=v(k,P,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(U.dirRecord),P)this.push({data:(function($){return M.DATA_DESCRIPTOR+g($.crc32,4)+g($.compressedSize,4)+g($.uncompressedSize,4)})(k),meta:{percent:100}});else for(this.push({data:U.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},L.prototype.flush=function(){for(var k=this.bytesWritten,P=0;P<this.dirRecords.length;P++)this.push({data:this.dirRecords[P],meta:{percent:100}});var U=this.bytesWritten-k,$=(function(V,R,O,T,w){var x=y.transformTo("string",w(T));return M.CENTRAL_DIRECTORY_END+"\0\0\0\0"+g(V,2)+g(V,2)+g(R,4)+g(O,4)+g(x.length,2)+x})(this.dirRecords.length,U,k,this.zipComment,this.encodeFileName);this.push({data:$,meta:{percent:100}})},L.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},L.prototype.registerPrevious=function(k){this._sources.push(k);var P=this;return k.on("data",(function(U){P.processChunk(U)})),k.on("end",(function(){P.closedSource(P.previous.streamInfo),P._sources.length?P.prepareNextSource():P.end()})),k.on("error",(function(U){P.error(U)})),this},L.prototype.resume=function(){return!!b.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},L.prototype.error=function(k){var P=this._sources;if(!b.prototype.error.call(this,k))return!1;for(var U=0;U<P.length;U++)try{P[U].error(k)}catch{}return!0},L.prototype.lock=function(){b.prototype.lock.call(this);for(var k=this._sources,P=0;P<k.length;P++)k[P].lock()},m.exports=L},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(f,m,p){var g=f("../compressions"),v=f("./ZipFileWorker");p.generateWorker=function(y,b,E){var A=new v(b.streamFiles,E,b.platform,b.encodeFileName),M=0;try{y.forEach((function(L,k){M++;var P=(function(R,O){var T=R||O,w=g[T];if(!w)throw new Error(T+" is not a valid compression method !");return w})(k.options.compression,b.compression),U=k.options.compressionOptions||b.compressionOptions||{},$=k.dir,V=k.date;k._compressWorker(P,U).withStreamInfo("file",{name:L,dir:$,date:V,comment:k.comment||"",unixPermissions:k.unixPermissions,dosPermissions:k.dosPermissions}).pipe(A)})),A.entriesCount=M}catch(L){A.error(L)}return A}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(f,m,p){function g(){if(!(this instanceof g))return new g;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var v=new g;for(var y in this)typeof this[y]!="function"&&(v[y]=this[y]);return v}}(g.prototype=f("./object")).loadAsync=f("./load"),g.support=f("./support"),g.defaults=f("./defaults"),g.version="3.10.1",g.loadAsync=function(v,y){return new g().loadAsync(v,y)},g.external=f("./external"),m.exports=g},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(f,m,p){var g=f("./utils"),v=f("./external"),y=f("./utf8"),b=f("./zipEntries"),E=f("./stream/Crc32Probe"),A=f("./nodejsUtils");function M(L){return new v.Promise((function(k,P){var U=L.decompressed.getContentWorker().pipe(new E);U.on("error",(function($){P($)})).on("end",(function(){U.streamInfo.crc32!==L.decompressed.crc32?P(new Error("Corrupted zip : CRC32 mismatch")):k()})).resume()}))}m.exports=function(L,k){var P=this;return k=g.extend(k||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:y.utf8decode}),A.isNode&&A.isStream(L)?v.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):g.prepareContent("the loaded zip file",L,!0,k.optimizedBinaryString,k.base64).then((function(U){var $=new b(k);return $.load(U),$})).then((function(U){var $=[v.Promise.resolve(U)],V=U.files;if(k.checkCRC32)for(var R=0;R<V.length;R++)$.push(M(V[R]));return v.Promise.all($)})).then((function(U){for(var $=U.shift(),V=$.files,R=0;R<V.length;R++){var O=V[R],T=O.fileNameStr,w=g.resolve(O.fileNameStr);P.file(w,O.decompressed,{binary:!0,optimizedBinaryString:!0,date:O.date,dir:O.dir,comment:O.fileCommentStr.length?O.fileCommentStr:null,unixPermissions:O.unixPermissions,dosPermissions:O.dosPermissions,createFolders:k.createFolders}),O.dir||(P.file(w).unsafeOriginalName=T)}return $.zipComment.length&&(P.comment=$.zipComment),P}))}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(f,m,p){var g=f("../utils"),v=f("../stream/GenericWorker");function y(b,E){v.call(this,"Nodejs stream input adapter for "+b),this._upstreamEnded=!1,this._bindStream(E)}g.inherits(y,v),y.prototype._bindStream=function(b){var E=this;(this._stream=b).pause(),b.on("data",(function(A){E.push({data:A,meta:{percent:0}})})).on("error",(function(A){E.isPaused?this.generatedError=A:E.error(A)})).on("end",(function(){E.isPaused?E._upstreamEnded=!0:E.end()}))},y.prototype.pause=function(){return!!v.prototype.pause.call(this)&&(this._stream.pause(),!0)},y.prototype.resume=function(){return!!v.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},m.exports=y},{"../stream/GenericWorker":28,"../utils":32}],13:[function(f,m,p){var g=f("readable-stream").Readable;function v(y,b,E){g.call(this,b),this._helper=y;var A=this;y.on("data",(function(M,L){A.push(M)||A._helper.pause(),E&&E(L)})).on("error",(function(M){A.emit("error",M)})).on("end",(function(){A.push(null)}))}f("../utils").inherits(v,g),v.prototype._read=function(){this._helper.resume()},m.exports=v},{"../utils":32,"readable-stream":16}],14:[function(f,m,p){m.exports={isNode:a!==void 0,newBufferFrom:function(g,v){if(a.from&&a.from!==Uint8Array.from)return a.from(g,v);if(typeof g=="number")throw new Error('The "data" argument must not be a number');return new a(g,v)},allocBuffer:function(g){if(a.alloc)return a.alloc(g);var v=new a(g);return v.fill(0),v},isBuffer:function(g){return a.isBuffer(g)},isStream:function(g){return g&&typeof g.on=="function"&&typeof g.pause=="function"&&typeof g.resume=="function"}}},{}],15:[function(f,m,p){function g(w,x,_){var S,C=y.getTypeOf(x),F=y.extend(_||{},A);F.date=F.date||new Date,F.compression!==null&&(F.compression=F.compression.toUpperCase()),typeof F.unixPermissions=="string"&&(F.unixPermissions=parseInt(F.unixPermissions,8)),F.unixPermissions&&16384&F.unixPermissions&&(F.dir=!0),F.dosPermissions&&16&F.dosPermissions&&(F.dir=!0),F.dir&&(w=V(w)),F.createFolders&&(S=$(w))&&R.call(this,S,!0);var D=C==="string"&&F.binary===!1&&F.base64===!1;_&&_.binary!==void 0||(F.binary=!D),(x instanceof M&&x.uncompressedSize===0||F.dir||!x||x.length===0)&&(F.base64=!1,F.binary=!0,x="",F.compression="STORE",C="string");var H;H=x instanceof M||x instanceof b?x:P.isNode&&P.isStream(x)?new U(w,x):y.prepareContent(w,x,F.binary,F.optimizedBinaryString,F.base64);var G=new L(w,H,F);this.files[w]=G}var v=f("./utf8"),y=f("./utils"),b=f("./stream/GenericWorker"),E=f("./stream/StreamHelper"),A=f("./defaults"),M=f("./compressedObject"),L=f("./zipObject"),k=f("./generate"),P=f("./nodejsUtils"),U=f("./nodejs/NodejsStreamInputAdapter"),$=function(w){w.slice(-1)==="/"&&(w=w.substring(0,w.length-1));var x=w.lastIndexOf("/");return 0<x?w.substring(0,x):""},V=function(w){return w.slice(-1)!=="/"&&(w+="/"),w},R=function(w,x){return x=x!==void 0?x:A.createFolders,w=V(w),this.files[w]||g.call(this,w,null,{dir:!0,createFolders:x}),this.files[w]};function O(w){return Object.prototype.toString.call(w)==="[object RegExp]"}var T={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(w){var x,_,S;for(x in this.files)S=this.files[x],(_=x.slice(this.root.length,x.length))&&x.slice(0,this.root.length)===this.root&&w(_,S)},filter:function(w){var x=[];return this.forEach((function(_,S){w(_,S)&&x.push(S)})),x},file:function(w,x,_){if(arguments.length!==1)return w=this.root+w,g.call(this,w,x,_),this;if(O(w)){var S=w;return this.filter((function(F,D){return!D.dir&&S.test(F)}))}var C=this.files[this.root+w];return C&&!C.dir?C:null},folder:function(w){if(!w)return this;if(O(w))return this.filter((function(C,F){return F.dir&&w.test(C)}));var x=this.root+w,_=R.call(this,x),S=this.clone();return S.root=_.name,S},remove:function(w){w=this.root+w;var x=this.files[w];if(x||(w.slice(-1)!=="/"&&(w+="/"),x=this.files[w]),x&&!x.dir)delete this.files[w];else for(var _=this.filter((function(C,F){return F.name.slice(0,w.length)===w})),S=0;S<_.length;S++)delete this.files[_[S].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(w){var x,_={};try{if((_=y.extend(w||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:v.utf8encode})).type=_.type.toLowerCase(),_.compression=_.compression.toUpperCase(),_.type==="binarystring"&&(_.type="string"),!_.type)throw new Error("No output type specified.");y.checkSupport(_.type),_.platform!=="darwin"&&_.platform!=="freebsd"&&_.platform!=="linux"&&_.platform!=="sunos"||(_.platform="UNIX"),_.platform==="win32"&&(_.platform="DOS");var S=_.comment||this.comment||"";x=k.generateWorker(this,_,S)}catch(C){(x=new b("error")).error(C)}return new E(x,_.type||"string",_.mimeType)},generateAsync:function(w,x){return this.generateInternalStream(w).accumulate(x)},generateNodeStream:function(w,x){return(w=w||{}).type||(w.type="nodebuffer"),this.generateInternalStream(w).toNodejsStream(x)}};m.exports=T},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(f,m,p){m.exports=f("stream")},{stream:void 0}],17:[function(f,m,p){var g=f("./DataReader");function v(y){g.call(this,y);for(var b=0;b<this.data.length;b++)y[b]=255&y[b]}f("../utils").inherits(v,g),v.prototype.byteAt=function(y){return this.data[this.zero+y]},v.prototype.lastIndexOfSignature=function(y){for(var b=y.charCodeAt(0),E=y.charCodeAt(1),A=y.charCodeAt(2),M=y.charCodeAt(3),L=this.length-4;0<=L;--L)if(this.data[L]===b&&this.data[L+1]===E&&this.data[L+2]===A&&this.data[L+3]===M)return L-this.zero;return-1},v.prototype.readAndCheckSignature=function(y){var b=y.charCodeAt(0),E=y.charCodeAt(1),A=y.charCodeAt(2),M=y.charCodeAt(3),L=this.readData(4);return b===L[0]&&E===L[1]&&A===L[2]&&M===L[3]},v.prototype.readData=function(y){if(this.checkOffset(y),y===0)return[];var b=this.data.slice(this.zero+this.index,this.zero+this.index+y);return this.index+=y,b},m.exports=v},{"../utils":32,"./DataReader":18}],18:[function(f,m,p){var g=f("../utils");function v(y){this.data=y,this.length=y.length,this.index=0,this.zero=0}v.prototype={checkOffset:function(y){this.checkIndex(this.index+y)},checkIndex:function(y){if(this.length<this.zero+y||y<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+y+"). Corrupted zip ?")},setIndex:function(y){this.checkIndex(y),this.index=y},skip:function(y){this.setIndex(this.index+y)},byteAt:function(){},readInt:function(y){var b,E=0;for(this.checkOffset(y),b=this.index+y-1;b>=this.index;b--)E=(E<<8)+this.byteAt(b);return this.index+=y,E},readString:function(y){return g.transformTo("string",this.readData(y))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var y=this.readInt(4);return new Date(Date.UTC(1980+(y>>25&127),(y>>21&15)-1,y>>16&31,y>>11&31,y>>5&63,(31&y)<<1))}},m.exports=v},{"../utils":32}],19:[function(f,m,p){var g=f("./Uint8ArrayReader");function v(y){g.call(this,y)}f("../utils").inherits(v,g),v.prototype.readData=function(y){this.checkOffset(y);var b=this.data.slice(this.zero+this.index,this.zero+this.index+y);return this.index+=y,b},m.exports=v},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(f,m,p){var g=f("./DataReader");function v(y){g.call(this,y)}f("../utils").inherits(v,g),v.prototype.byteAt=function(y){return this.data.charCodeAt(this.zero+y)},v.prototype.lastIndexOfSignature=function(y){return this.data.lastIndexOf(y)-this.zero},v.prototype.readAndCheckSignature=function(y){return y===this.readData(4)},v.prototype.readData=function(y){this.checkOffset(y);var b=this.data.slice(this.zero+this.index,this.zero+this.index+y);return this.index+=y,b},m.exports=v},{"../utils":32,"./DataReader":18}],21:[function(f,m,p){var g=f("./ArrayReader");function v(y){g.call(this,y)}f("../utils").inherits(v,g),v.prototype.readData=function(y){if(this.checkOffset(y),y===0)return new Uint8Array(0);var b=this.data.subarray(this.zero+this.index,this.zero+this.index+y);return this.index+=y,b},m.exports=v},{"../utils":32,"./ArrayReader":17}],22:[function(f,m,p){var g=f("../utils"),v=f("../support"),y=f("./ArrayReader"),b=f("./StringReader"),E=f("./NodeBufferReader"),A=f("./Uint8ArrayReader");m.exports=function(M){var L=g.getTypeOf(M);return g.checkSupport(L),L!=="string"||v.uint8array?L==="nodebuffer"?new E(M):v.uint8array?new A(g.transformTo("uint8array",M)):new y(g.transformTo("array",M)):new b(M)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(f,m,p){p.LOCAL_FILE_HEADER="PK",p.CENTRAL_FILE_HEADER="PK",p.CENTRAL_DIRECTORY_END="PK",p.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",p.ZIP64_CENTRAL_DIRECTORY_END="PK",p.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(f,m,p){var g=f("./GenericWorker"),v=f("../utils");function y(b){g.call(this,"ConvertWorker to "+b),this.destType=b}v.inherits(y,g),y.prototype.processChunk=function(b){this.push({data:v.transformTo(this.destType,b.data),meta:b.meta})},m.exports=y},{"../utils":32,"./GenericWorker":28}],25:[function(f,m,p){var g=f("./GenericWorker"),v=f("../crc32");function y(){g.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}f("../utils").inherits(y,g),y.prototype.processChunk=function(b){this.streamInfo.crc32=v(b.data,this.streamInfo.crc32||0),this.push(b)},m.exports=y},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(f,m,p){var g=f("../utils"),v=f("./GenericWorker");function y(b){v.call(this,"DataLengthProbe for "+b),this.propName=b,this.withStreamInfo(b,0)}g.inherits(y,v),y.prototype.processChunk=function(b){if(b){var E=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=E+b.data.length}v.prototype.processChunk.call(this,b)},m.exports=y},{"../utils":32,"./GenericWorker":28}],27:[function(f,m,p){var g=f("../utils"),v=f("./GenericWorker");function y(b){v.call(this,"DataWorker");var E=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,b.then((function(A){E.dataIsReady=!0,E.data=A,E.max=A&&A.length||0,E.type=g.getTypeOf(A),E.isPaused||E._tickAndRepeat()}),(function(A){E.error(A)}))}g.inherits(y,v),y.prototype.cleanUp=function(){v.prototype.cleanUp.call(this),this.data=null},y.prototype.resume=function(){return!!v.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,g.delay(this._tickAndRepeat,[],this)),!0)},y.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(g.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},y.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var b=null,E=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":b=this.data.substring(this.index,E);break;case"uint8array":b=this.data.subarray(this.index,E);break;case"array":case"nodebuffer":b=this.data.slice(this.index,E)}return this.index=E,this.push({data:b,meta:{percent:this.max?this.index/this.max*100:0}})},m.exports=y},{"../utils":32,"./GenericWorker":28}],28:[function(f,m,p){function g(v){this.name=v||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}g.prototype={push:function(v){this.emit("data",v)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(v){this.emit("error",v)}return!0},error:function(v){return!this.isFinished&&(this.isPaused?this.generatedError=v:(this.isFinished=!0,this.emit("error",v),this.previous&&this.previous.error(v),this.cleanUp()),!0)},on:function(v,y){return this._listeners[v].push(y),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(v,y){if(this._listeners[v])for(var b=0;b<this._listeners[v].length;b++)this._listeners[v][b].call(this,y)},pipe:function(v){return v.registerPrevious(this)},registerPrevious:function(v){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=v.streamInfo,this.mergeStreamInfo(),this.previous=v;var y=this;return v.on("data",(function(b){y.processChunk(b)})),v.on("end",(function(){y.end()})),v.on("error",(function(b){y.error(b)})),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var v=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),v=!0),this.previous&&this.previous.resume(),!v},flush:function(){},processChunk:function(v){this.push(v)},withStreamInfo:function(v,y){return this.extraStreamInfo[v]=y,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var v in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,v)&&(this.streamInfo[v]=this.extraStreamInfo[v])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var v="Worker "+this.name;return this.previous?this.previous+" -> "+v:v}},m.exports=g},{}],29:[function(f,m,p){var g=f("../utils"),v=f("./ConvertWorker"),y=f("./GenericWorker"),b=f("../base64"),E=f("../support"),A=f("../external"),M=null;if(E.nodestream)try{M=f("../nodejs/NodejsStreamOutputAdapter")}catch{}function L(k,P,U){var $=P;switch(P){case"blob":case"arraybuffer":$="uint8array";break;case"base64":$="string"}try{this._internalType=$,this._outputType=P,this._mimeType=U,g.checkSupport($),this._worker=k.pipe(new v($)),k.lock()}catch(V){this._worker=new y("error"),this._worker.error(V)}}L.prototype={accumulate:function(k){return(function(P,U){return new A.Promise((function($,V){var R=[],O=P._internalType,T=P._outputType,w=P._mimeType;P.on("data",(function(x,_){R.push(x),U&&U(_)})).on("error",(function(x){R=[],V(x)})).on("end",(function(){try{var x=(function(_,S,C){switch(_){case"blob":return g.newBlob(g.transformTo("arraybuffer",S),C);case"base64":return b.encode(S);default:return g.transformTo(_,S)}})(T,(function(_,S){var C,F=0,D=null,H=0;for(C=0;C<S.length;C++)H+=S[C].length;switch(_){case"string":return S.join("");case"array":return Array.prototype.concat.apply([],S);case"uint8array":for(D=new Uint8Array(H),C=0;C<S.length;C++)D.set(S[C],F),F+=S[C].length;return D;case"nodebuffer":return a.concat(S);default:throw new Error("concat : unsupported type '"+_+"'")}})(O,R),w);$(x)}catch(_){V(_)}R=[]})).resume()}))})(this,k)},on:function(k,P){var U=this;return k==="data"?this._worker.on(k,(function($){P.call(U,$.data,$.meta)})):this._worker.on(k,(function(){g.delay(P,arguments,U)})),this},resume:function(){return g.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(k){if(g.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new M(this,{objectMode:this._outputType!=="nodebuffer"},k)}},m.exports=L},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(f,m,p){if(p.base64=!0,p.array=!0,p.string=!0,p.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",p.nodebuffer=a!==void 0,p.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")p.blob=!1;else{var g=new ArrayBuffer(0);try{p.blob=new Blob([g],{type:"application/zip"}).size===0}catch{try{var v=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);v.append(g),p.blob=v.getBlob("application/zip").size===0}catch{p.blob=!1}}}try{p.nodestream=!!f("readable-stream").Readable}catch{p.nodestream=!1}},{"readable-stream":16}],31:[function(f,m,p){for(var g=f("./utils"),v=f("./support"),y=f("./nodejsUtils"),b=f("./stream/GenericWorker"),E=new Array(256),A=0;A<256;A++)E[A]=252<=A?6:248<=A?5:240<=A?4:224<=A?3:192<=A?2:1;function M(){b.call(this,"utf-8 decode"),this.leftOver=null}function L(){b.call(this,"utf-8 encode")}E[254]=E[254]=1,p.utf8encode=function(k){return v.nodebuffer?y.newBufferFrom(k,"utf-8"):(function(P){var U,$,V,R,O,T=P.length,w=0;for(R=0;R<T;R++)(64512&($=P.charCodeAt(R)))==55296&&R+1<T&&(64512&(V=P.charCodeAt(R+1)))==56320&&($=65536+($-55296<<10)+(V-56320),R++),w+=$<128?1:$<2048?2:$<65536?3:4;for(U=v.uint8array?new Uint8Array(w):new Array(w),R=O=0;O<w;R++)(64512&($=P.charCodeAt(R)))==55296&&R+1<T&&(64512&(V=P.charCodeAt(R+1)))==56320&&($=65536+($-55296<<10)+(V-56320),R++),$<128?U[O++]=$:($<2048?U[O++]=192|$>>>6:($<65536?U[O++]=224|$>>>12:(U[O++]=240|$>>>18,U[O++]=128|$>>>12&63),U[O++]=128|$>>>6&63),U[O++]=128|63&$);return U})(k)},p.utf8decode=function(k){return v.nodebuffer?g.transformTo("nodebuffer",k).toString("utf-8"):(function(P){var U,$,V,R,O=P.length,T=new Array(2*O);for(U=$=0;U<O;)if((V=P[U++])<128)T[$++]=V;else if(4<(R=E[V]))T[$++]=65533,U+=R-1;else{for(V&=R===2?31:R===3?15:7;1<R&&U<O;)V=V<<6|63&P[U++],R--;1<R?T[$++]=65533:V<65536?T[$++]=V:(V-=65536,T[$++]=55296|V>>10&1023,T[$++]=56320|1023&V)}return T.length!==$&&(T.subarray?T=T.subarray(0,$):T.length=$),g.applyFromCharCode(T)})(k=g.transformTo(v.uint8array?"uint8array":"array",k))},g.inherits(M,b),M.prototype.processChunk=function(k){var P=g.transformTo(v.uint8array?"uint8array":"array",k.data);if(this.leftOver&&this.leftOver.length){if(v.uint8array){var U=P;(P=new Uint8Array(U.length+this.leftOver.length)).set(this.leftOver,0),P.set(U,this.leftOver.length)}else P=this.leftOver.concat(P);this.leftOver=null}var $=(function(R,O){var T;for((O=O||R.length)>R.length&&(O=R.length),T=O-1;0<=T&&(192&R[T])==128;)T--;return T<0||T===0?O:T+E[R[T]]>O?T:O})(P),V=P;$!==P.length&&(v.uint8array?(V=P.subarray(0,$),this.leftOver=P.subarray($,P.length)):(V=P.slice(0,$),this.leftOver=P.slice($,P.length))),this.push({data:p.utf8decode(V),meta:k.meta})},M.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:p.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},p.Utf8DecodeWorker=M,g.inherits(L,b),L.prototype.processChunk=function(k){this.push({data:p.utf8encode(k.data),meta:k.meta})},p.Utf8EncodeWorker=L},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(f,m,p){var g=f("./support"),v=f("./base64"),y=f("./nodejsUtils"),b=f("./external");function E(U){return U}function A(U,$){for(var V=0;V<U.length;++V)$[V]=255&U.charCodeAt(V);return $}f("setimmediate"),p.newBlob=function(U,$){p.checkSupport("blob");try{return new Blob([U],{type:$})}catch{try{var V=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return V.append(U),V.getBlob($)}catch{throw new Error("Bug : can't construct the Blob.")}}};var M={stringifyByChunk:function(U,$,V){var R=[],O=0,T=U.length;if(T<=V)return String.fromCharCode.apply(null,U);for(;O<T;)$==="array"||$==="nodebuffer"?R.push(String.fromCharCode.apply(null,U.slice(O,Math.min(O+V,T)))):R.push(String.fromCharCode.apply(null,U.subarray(O,Math.min(O+V,T)))),O+=V;return R.join("")},stringifyByChar:function(U){for(var $="",V=0;V<U.length;V++)$+=String.fromCharCode(U[V]);return $},applyCanBeUsed:{uint8array:(function(){try{return g.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return g.nodebuffer&&String.fromCharCode.apply(null,y.allocBuffer(1)).length===1}catch{return!1}})()}};function L(U){var $=65536,V=p.getTypeOf(U),R=!0;if(V==="uint8array"?R=M.applyCanBeUsed.uint8array:V==="nodebuffer"&&(R=M.applyCanBeUsed.nodebuffer),R)for(;1<$;)try{return M.stringifyByChunk(U,V,$)}catch{$=Math.floor($/2)}return M.stringifyByChar(U)}function k(U,$){for(var V=0;V<U.length;V++)$[V]=U[V];return $}p.applyFromCharCode=L;var P={};P.string={string:E,array:function(U){return A(U,new Array(U.length))},arraybuffer:function(U){return P.string.uint8array(U).buffer},uint8array:function(U){return A(U,new Uint8Array(U.length))},nodebuffer:function(U){return A(U,y.allocBuffer(U.length))}},P.array={string:L,array:E,arraybuffer:function(U){return new Uint8Array(U).buffer},uint8array:function(U){return new Uint8Array(U)},nodebuffer:function(U){return y.newBufferFrom(U)}},P.arraybuffer={string:function(U){return L(new Uint8Array(U))},array:function(U){return k(new Uint8Array(U),new Array(U.byteLength))},arraybuffer:E,uint8array:function(U){return new Uint8Array(U)},nodebuffer:function(U){return y.newBufferFrom(new Uint8Array(U))}},P.uint8array={string:L,array:function(U){return k(U,new Array(U.length))},arraybuffer:function(U){return U.buffer},uint8array:E,nodebuffer:function(U){return y.newBufferFrom(U)}},P.nodebuffer={string:L,array:function(U){return k(U,new Array(U.length))},arraybuffer:function(U){return P.nodebuffer.uint8array(U).buffer},uint8array:function(U){return k(U,new Uint8Array(U.length))},nodebuffer:E},p.transformTo=function(U,$){if($=$||"",!U)return $;p.checkSupport(U);var V=p.getTypeOf($);return P[V][U]($)},p.resolve=function(U){for(var $=U.split("/"),V=[],R=0;R<$.length;R++){var O=$[R];O==="."||O===""&&R!==0&&R!==$.length-1||(O===".."?V.pop():V.push(O))}return V.join("/")},p.getTypeOf=function(U){return typeof U=="string"?"string":Object.prototype.toString.call(U)==="[object Array]"?"array":g.nodebuffer&&y.isBuffer(U)?"nodebuffer":g.uint8array&&U instanceof Uint8Array?"uint8array":g.arraybuffer&&U instanceof ArrayBuffer?"arraybuffer":void 0},p.checkSupport=function(U){if(!g[U.toLowerCase()])throw new Error(U+" is not supported by this platform")},p.MAX_VALUE_16BITS=65535,p.MAX_VALUE_32BITS=-1,p.pretty=function(U){var $,V,R="";for(V=0;V<(U||"").length;V++)R+="\\x"+(($=U.charCodeAt(V))<16?"0":"")+$.toString(16).toUpperCase();return R},p.delay=function(U,$,V){h((function(){U.apply(V||null,$||[])}))},p.inherits=function(U,$){function V(){}V.prototype=$.prototype,U.prototype=new V},p.extend=function(){var U,$,V={};for(U=0;U<arguments.length;U++)for($ in arguments[U])Object.prototype.hasOwnProperty.call(arguments[U],$)&&V[$]===void 0&&(V[$]=arguments[U][$]);return V},p.prepareContent=function(U,$,V,R,O){return b.Promise.resolve($).then((function(T){return g.blob&&(T instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(T))!==-1)&&typeof FileReader<"u"?new b.Promise((function(w,x){var _=new FileReader;_.onload=function(S){w(S.target.result)},_.onerror=function(S){x(S.target.error)},_.readAsArrayBuffer(T)})):T})).then((function(T){var w=p.getTypeOf(T);return w?(w==="arraybuffer"?T=p.transformTo("uint8array",T):w==="string"&&(O?T=v.decode(T):V&&R!==!0&&(T=(function(x){return A(x,g.uint8array?new Uint8Array(x.length):new Array(x.length))})(T))),T):b.Promise.reject(new Error("Can't read the data of '"+U+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))}))}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(f,m,p){var g=f("./reader/readerFor"),v=f("./utils"),y=f("./signature"),b=f("./zipEntry"),E=f("./support");function A(M){this.files=[],this.loadOptions=M}A.prototype={checkSignature:function(M){if(!this.reader.readAndCheckSignature(M)){this.reader.index-=4;var L=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+v.pretty(L)+", expected "+v.pretty(M)+")")}},isSignature:function(M,L){var k=this.reader.index;this.reader.setIndex(M);var P=this.reader.readString(4)===L;return this.reader.setIndex(k),P},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var M=this.reader.readData(this.zipCommentLength),L=E.uint8array?"uint8array":"array",k=v.transformTo(L,M);this.zipComment=this.loadOptions.decodeFileName(k)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var M,L,k,P=this.zip64EndOfCentralSize-44;0<P;)M=this.reader.readInt(2),L=this.reader.readInt(4),k=this.reader.readData(L),this.zip64ExtensibleData[M]={id:M,length:L,value:k}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var M,L;for(M=0;M<this.files.length;M++)L=this.files[M],this.reader.setIndex(L.localHeaderOffset),this.checkSignature(y.LOCAL_FILE_HEADER),L.readLocalPart(this.reader),L.handleUTF8(),L.processAttributes()},readCentralDir:function(){var M;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(y.CENTRAL_FILE_HEADER);)(M=new b({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(M);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var M=this.reader.lastIndexOfSignature(y.CENTRAL_DIRECTORY_END);if(M<0)throw this.isSignature(0,y.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(M);var L=M;if(this.checkSignature(y.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===v.MAX_VALUE_16BITS||this.diskWithCentralDirStart===v.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===v.MAX_VALUE_16BITS||this.centralDirRecords===v.MAX_VALUE_16BITS||this.centralDirSize===v.MAX_VALUE_32BITS||this.centralDirOffset===v.MAX_VALUE_32BITS){if(this.zip64=!0,(M=this.reader.lastIndexOfSignature(y.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(M),this.checkSignature(y.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,y.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(y.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(y.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var k=this.centralDirOffset+this.centralDirSize;this.zip64&&(k+=20,k+=12+this.zip64EndOfCentralSize);var P=L-k;if(0<P)this.isSignature(L,y.CENTRAL_FILE_HEADER)||(this.reader.zero=P);else if(P<0)throw new Error("Corrupted zip: missing "+Math.abs(P)+" bytes.")},prepareReader:function(M){this.reader=g(M)},load:function(M){this.prepareReader(M),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},m.exports=A},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(f,m,p){var g=f("./reader/readerFor"),v=f("./utils"),y=f("./compressedObject"),b=f("./crc32"),E=f("./utf8"),A=f("./compressions"),M=f("./support");function L(k,P){this.options=k,this.loadOptions=P}L.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(k){var P,U;if(k.skip(22),this.fileNameLength=k.readInt(2),U=k.readInt(2),this.fileName=k.readData(this.fileNameLength),k.skip(U),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((P=(function($){for(var V in A)if(Object.prototype.hasOwnProperty.call(A,V)&&A[V].magic===$)return A[V];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+v.pretty(this.compressionMethod)+" unknown (inner file : "+v.transformTo("string",this.fileName)+")");this.decompressed=new y(this.compressedSize,this.uncompressedSize,this.crc32,P,k.readData(this.compressedSize))},readCentralPart:function(k){this.versionMadeBy=k.readInt(2),k.skip(2),this.bitFlag=k.readInt(2),this.compressionMethod=k.readString(2),this.date=k.readDate(),this.crc32=k.readInt(4),this.compressedSize=k.readInt(4),this.uncompressedSize=k.readInt(4);var P=k.readInt(2);if(this.extraFieldsLength=k.readInt(2),this.fileCommentLength=k.readInt(2),this.diskNumberStart=k.readInt(2),this.internalFileAttributes=k.readInt(2),this.externalFileAttributes=k.readInt(4),this.localHeaderOffset=k.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");k.skip(P),this.readExtraFields(k),this.parseZIP64ExtraField(k),this.fileComment=k.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var k=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),k==0&&(this.dosPermissions=63&this.externalFileAttributes),k==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var k=g(this.extraFields[1].value);this.uncompressedSize===v.MAX_VALUE_32BITS&&(this.uncompressedSize=k.readInt(8)),this.compressedSize===v.MAX_VALUE_32BITS&&(this.compressedSize=k.readInt(8)),this.localHeaderOffset===v.MAX_VALUE_32BITS&&(this.localHeaderOffset=k.readInt(8)),this.diskNumberStart===v.MAX_VALUE_32BITS&&(this.diskNumberStart=k.readInt(4))}},readExtraFields:function(k){var P,U,$,V=k.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});k.index+4<V;)P=k.readInt(2),U=k.readInt(2),$=k.readData(U),this.extraFields[P]={id:P,length:U,value:$};k.setIndex(V)},handleUTF8:function(){var k=M.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=E.utf8decode(this.fileName),this.fileCommentStr=E.utf8decode(this.fileComment);else{var P=this.findExtraFieldUnicodePath();if(P!==null)this.fileNameStr=P;else{var U=v.transformTo(k,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(U)}var $=this.findExtraFieldUnicodeComment();if($!==null)this.fileCommentStr=$;else{var V=v.transformTo(k,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(V)}}},findExtraFieldUnicodePath:function(){var k=this.extraFields[28789];if(k){var P=g(k.value);return P.readInt(1)!==1||b(this.fileName)!==P.readInt(4)?null:E.utf8decode(P.readData(k.length-5))}return null},findExtraFieldUnicodeComment:function(){var k=this.extraFields[25461];if(k){var P=g(k.value);return P.readInt(1)!==1||b(this.fileComment)!==P.readInt(4)?null:E.utf8decode(P.readData(k.length-5))}return null}},m.exports=L},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(f,m,p){function g(P,U,$){this.name=P,this.dir=$.dir,this.date=$.date,this.comment=$.comment,this.unixPermissions=$.unixPermissions,this.dosPermissions=$.dosPermissions,this._data=U,this._dataBinary=$.binary,this.options={compression:$.compression,compressionOptions:$.compressionOptions}}var v=f("./stream/StreamHelper"),y=f("./stream/DataWorker"),b=f("./utf8"),E=f("./compressedObject"),A=f("./stream/GenericWorker");g.prototype={internalStream:function(P){var U=null,$="string";try{if(!P)throw new Error("No output type specified.");var V=($=P.toLowerCase())==="string"||$==="text";$!=="binarystring"&&$!=="text"||($="string"),U=this._decompressWorker();var R=!this._dataBinary;R&&!V&&(U=U.pipe(new b.Utf8EncodeWorker)),!R&&V&&(U=U.pipe(new b.Utf8DecodeWorker))}catch(O){(U=new A("error")).error(O)}return new v(U,$,"")},async:function(P,U){return this.internalStream(P).accumulate(U)},nodeStream:function(P,U){return this.internalStream(P||"nodebuffer").toNodejsStream(U)},_compressWorker:function(P,U){if(this._data instanceof E&&this._data.compression.magic===P.magic)return this._data.getCompressedWorker();var $=this._decompressWorker();return this._dataBinary||($=$.pipe(new b.Utf8EncodeWorker)),E.createWorkerFrom($,P,U)},_decompressWorker:function(){return this._data instanceof E?this._data.getContentWorker():this._data instanceof A?this._data:new y(this._data)}};for(var M=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],L=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},k=0;k<M.length;k++)g.prototype[M[k]]=L;m.exports=g},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(f,m,p){(function(g){var v,y,b=g.MutationObserver||g.WebKitMutationObserver;if(b){var E=0,A=new b(P),M=g.document.createTextNode("");A.observe(M,{characterData:!0}),v=function(){M.data=E=++E%2}}else if(g.setImmediate||g.MessageChannel===void 0)v="document"in g&&"onreadystatechange"in g.document.createElement("script")?function(){var U=g.document.createElement("script");U.onreadystatechange=function(){P(),U.onreadystatechange=null,U.parentNode.removeChild(U),U=null},g.document.documentElement.appendChild(U)}:function(){setTimeout(P,0)};else{var L=new g.MessageChannel;L.port1.onmessage=P,v=function(){L.port2.postMessage(0)}}var k=[];function P(){var U,$;y=!0;for(var V=k.length;V;){for($=k,k=[],U=-1;++U<V;)$[U]();V=k.length}y=!1}m.exports=function(U){k.push(U)!==1||y||v()}}).call(this,o!==void 0?o:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(f,m,p){var g=f("immediate");function v(){}var y={},b=["REJECTED"],E=["FULFILLED"],A=["PENDING"];function M(V){if(typeof V!="function")throw new TypeError("resolver must be a function");this.state=A,this.queue=[],this.outcome=void 0,V!==v&&U(this,V)}function L(V,R,O){this.promise=V,typeof R=="function"&&(this.onFulfilled=R,this.callFulfilled=this.otherCallFulfilled),typeof O=="function"&&(this.onRejected=O,this.callRejected=this.otherCallRejected)}function k(V,R,O){g((function(){var T;try{T=R(O)}catch(w){return y.reject(V,w)}T===V?y.reject(V,new TypeError("Cannot resolve promise with itself")):y.resolve(V,T)}))}function P(V){var R=V&&V.then;if(V&&(typeof V=="object"||typeof V=="function")&&typeof R=="function")return function(){R.apply(V,arguments)}}function U(V,R){var O=!1;function T(_){O||(O=!0,y.reject(V,_))}function w(_){O||(O=!0,y.resolve(V,_))}var x=$((function(){R(w,T)}));x.status==="error"&&T(x.value)}function $(V,R){var O={};try{O.value=V(R),O.status="success"}catch(T){O.status="error",O.value=T}return O}(m.exports=M).prototype.finally=function(V){if(typeof V!="function")return this;var R=this.constructor;return this.then((function(O){return R.resolve(V()).then((function(){return O}))}),(function(O){return R.resolve(V()).then((function(){throw O}))}))},M.prototype.catch=function(V){return this.then(null,V)},M.prototype.then=function(V,R){if(typeof V!="function"&&this.state===E||typeof R!="function"&&this.state===b)return this;var O=new this.constructor(v);return this.state!==A?k(O,this.state===E?V:R,this.outcome):this.queue.push(new L(O,V,R)),O},L.prototype.callFulfilled=function(V){y.resolve(this.promise,V)},L.prototype.otherCallFulfilled=function(V){k(this.promise,this.onFulfilled,V)},L.prototype.callRejected=function(V){y.reject(this.promise,V)},L.prototype.otherCallRejected=function(V){k(this.promise,this.onRejected,V)},y.resolve=function(V,R){var O=$(P,R);if(O.status==="error")return y.reject(V,O.value);var T=O.value;if(T)U(V,T);else{V.state=E,V.outcome=R;for(var w=-1,x=V.queue.length;++w<x;)V.queue[w].callFulfilled(R)}return V},y.reject=function(V,R){V.state=b,V.outcome=R;for(var O=-1,T=V.queue.length;++O<T;)V.queue[O].callRejected(R);return V},M.resolve=function(V){return V instanceof this?V:y.resolve(new this(v),V)},M.reject=function(V){var R=new this(v);return y.reject(R,V)},M.all=function(V){var R=this;if(Object.prototype.toString.call(V)!=="[object Array]")return this.reject(new TypeError("must be an array"));var O=V.length,T=!1;if(!O)return this.resolve([]);for(var w=new Array(O),x=0,_=-1,S=new this(v);++_<O;)C(V[_],_);return S;function C(F,D){R.resolve(F).then((function(H){w[D]=H,++x!==O||T||(T=!0,y.resolve(S,w))}),(function(H){T||(T=!0,y.reject(S,H))}))}},M.race=function(V){if(Object.prototype.toString.call(V)!=="[object Array]")return this.reject(new TypeError("must be an array"));var R=V.length,O=!1;if(!R)return this.resolve([]);for(var T,w=-1,x=new this(v);++w<R;)T=V[w],this.resolve(T).then((function(_){O||(O=!0,y.resolve(x,_))}),(function(_){O||(O=!0,y.reject(x,_))}));return x}},{immediate:36}],38:[function(f,m,p){var g={};(0,f("./lib/utils/common").assign)(g,f("./lib/deflate"),f("./lib/inflate"),f("./lib/zlib/constants")),m.exports=g},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(f,m,p){var g=f("./zlib/deflate"),v=f("./utils/common"),y=f("./utils/strings"),b=f("./zlib/messages"),E=f("./zlib/zstream"),A=Object.prototype.toString;function M(k){if(!(this instanceof M))return new M(k);this.options=v.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},k||{});var P=this.options;P.raw&&0<P.windowBits?P.windowBits=-P.windowBits:P.gzip&&0<P.windowBits&&P.windowBits<16&&(P.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new E,this.strm.avail_out=0;var U=g.deflateInit2(this.strm,P.level,P.method,P.windowBits,P.memLevel,P.strategy);if(U!==0)throw new Error(b[U]);if(P.header&&g.deflateSetHeader(this.strm,P.header),P.dictionary){var $;if($=typeof P.dictionary=="string"?y.string2buf(P.dictionary):A.call(P.dictionary)==="[object ArrayBuffer]"?new Uint8Array(P.dictionary):P.dictionary,(U=g.deflateSetDictionary(this.strm,$))!==0)throw new Error(b[U]);this._dict_set=!0}}function L(k,P){var U=new M(P);if(U.push(k,!0),U.err)throw U.msg||b[U.err];return U.result}M.prototype.push=function(k,P){var U,$,V=this.strm,R=this.options.chunkSize;if(this.ended)return!1;$=P===~~P?P:P===!0?4:0,typeof k=="string"?V.input=y.string2buf(k):A.call(k)==="[object ArrayBuffer]"?V.input=new Uint8Array(k):V.input=k,V.next_in=0,V.avail_in=V.input.length;do{if(V.avail_out===0&&(V.output=new v.Buf8(R),V.next_out=0,V.avail_out=R),(U=g.deflate(V,$))!==1&&U!==0)return this.onEnd(U),!(this.ended=!0);V.avail_out!==0&&(V.avail_in!==0||$!==4&&$!==2)||(this.options.to==="string"?this.onData(y.buf2binstring(v.shrinkBuf(V.output,V.next_out))):this.onData(v.shrinkBuf(V.output,V.next_out)))}while((0<V.avail_in||V.avail_out===0)&&U!==1);return $===4?(U=g.deflateEnd(this.strm),this.onEnd(U),this.ended=!0,U===0):$!==2||(this.onEnd(0),!(V.avail_out=0))},M.prototype.onData=function(k){this.chunks.push(k)},M.prototype.onEnd=function(k){k===0&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=v.flattenChunks(this.chunks)),this.chunks=[],this.err=k,this.msg=this.strm.msg},p.Deflate=M,p.deflate=L,p.deflateRaw=function(k,P){return(P=P||{}).raw=!0,L(k,P)},p.gzip=function(k,P){return(P=P||{}).gzip=!0,L(k,P)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(f,m,p){var g=f("./zlib/inflate"),v=f("./utils/common"),y=f("./utils/strings"),b=f("./zlib/constants"),E=f("./zlib/messages"),A=f("./zlib/zstream"),M=f("./zlib/gzheader"),L=Object.prototype.toString;function k(U){if(!(this instanceof k))return new k(U);this.options=v.assign({chunkSize:16384,windowBits:0,to:""},U||{});var $=this.options;$.raw&&0<=$.windowBits&&$.windowBits<16&&($.windowBits=-$.windowBits,$.windowBits===0&&($.windowBits=-15)),!(0<=$.windowBits&&$.windowBits<16)||U&&U.windowBits||($.windowBits+=32),15<$.windowBits&&$.windowBits<48&&(15&$.windowBits)==0&&($.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new A,this.strm.avail_out=0;var V=g.inflateInit2(this.strm,$.windowBits);if(V!==b.Z_OK)throw new Error(E[V]);this.header=new M,g.inflateGetHeader(this.strm,this.header)}function P(U,$){var V=new k($);if(V.push(U,!0),V.err)throw V.msg||E[V.err];return V.result}k.prototype.push=function(U,$){var V,R,O,T,w,x,_=this.strm,S=this.options.chunkSize,C=this.options.dictionary,F=!1;if(this.ended)return!1;R=$===~~$?$:$===!0?b.Z_FINISH:b.Z_NO_FLUSH,typeof U=="string"?_.input=y.binstring2buf(U):L.call(U)==="[object ArrayBuffer]"?_.input=new Uint8Array(U):_.input=U,_.next_in=0,_.avail_in=_.input.length;do{if(_.avail_out===0&&(_.output=new v.Buf8(S),_.next_out=0,_.avail_out=S),(V=g.inflate(_,b.Z_NO_FLUSH))===b.Z_NEED_DICT&&C&&(x=typeof C=="string"?y.string2buf(C):L.call(C)==="[object ArrayBuffer]"?new Uint8Array(C):C,V=g.inflateSetDictionary(this.strm,x)),V===b.Z_BUF_ERROR&&F===!0&&(V=b.Z_OK,F=!1),V!==b.Z_STREAM_END&&V!==b.Z_OK)return this.onEnd(V),!(this.ended=!0);_.next_out&&(_.avail_out!==0&&V!==b.Z_STREAM_END&&(_.avail_in!==0||R!==b.Z_FINISH&&R!==b.Z_SYNC_FLUSH)||(this.options.to==="string"?(O=y.utf8border(_.output,_.next_out),T=_.next_out-O,w=y.buf2string(_.output,O),_.next_out=T,_.avail_out=S-T,T&&v.arraySet(_.output,_.output,O,T,0),this.onData(w)):this.onData(v.shrinkBuf(_.output,_.next_out)))),_.avail_in===0&&_.avail_out===0&&(F=!0)}while((0<_.avail_in||_.avail_out===0)&&V!==b.Z_STREAM_END);return V===b.Z_STREAM_END&&(R=b.Z_FINISH),R===b.Z_FINISH?(V=g.inflateEnd(this.strm),this.onEnd(V),this.ended=!0,V===b.Z_OK):R!==b.Z_SYNC_FLUSH||(this.onEnd(b.Z_OK),!(_.avail_out=0))},k.prototype.onData=function(U){this.chunks.push(U)},k.prototype.onEnd=function(U){U===b.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=v.flattenChunks(this.chunks)),this.chunks=[],this.err=U,this.msg=this.strm.msg},p.Inflate=k,p.inflate=P,p.inflateRaw=function(U,$){return($=$||{}).raw=!0,P(U,$)},p.ungzip=P},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(f,m,p){var g=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";p.assign=function(b){for(var E=Array.prototype.slice.call(arguments,1);E.length;){var A=E.shift();if(A){if(typeof A!="object")throw new TypeError(A+"must be non-object");for(var M in A)A.hasOwnProperty(M)&&(b[M]=A[M])}}return b},p.shrinkBuf=function(b,E){return b.length===E?b:b.subarray?b.subarray(0,E):(b.length=E,b)};var v={arraySet:function(b,E,A,M,L){if(E.subarray&&b.subarray)b.set(E.subarray(A,A+M),L);else for(var k=0;k<M;k++)b[L+k]=E[A+k]},flattenChunks:function(b){var E,A,M,L,k,P;for(E=M=0,A=b.length;E<A;E++)M+=b[E].length;for(P=new Uint8Array(M),E=L=0,A=b.length;E<A;E++)k=b[E],P.set(k,L),L+=k.length;return P}},y={arraySet:function(b,E,A,M,L){for(var k=0;k<M;k++)b[L+k]=E[A+k]},flattenChunks:function(b){return[].concat.apply([],b)}};p.setTyped=function(b){b?(p.Buf8=Uint8Array,p.Buf16=Uint16Array,p.Buf32=Int32Array,p.assign(p,v)):(p.Buf8=Array,p.Buf16=Array,p.Buf32=Array,p.assign(p,y))},p.setTyped(g)},{}],42:[function(f,m,p){var g=f("./common"),v=!0,y=!0;try{String.fromCharCode.apply(null,[0])}catch{v=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{y=!1}for(var b=new g.Buf8(256),E=0;E<256;E++)b[E]=252<=E?6:248<=E?5:240<=E?4:224<=E?3:192<=E?2:1;function A(M,L){if(L<65537&&(M.subarray&&y||!M.subarray&&v))return String.fromCharCode.apply(null,g.shrinkBuf(M,L));for(var k="",P=0;P<L;P++)k+=String.fromCharCode(M[P]);return k}b[254]=b[254]=1,p.string2buf=function(M){var L,k,P,U,$,V=M.length,R=0;for(U=0;U<V;U++)(64512&(k=M.charCodeAt(U)))==55296&&U+1<V&&(64512&(P=M.charCodeAt(U+1)))==56320&&(k=65536+(k-55296<<10)+(P-56320),U++),R+=k<128?1:k<2048?2:k<65536?3:4;for(L=new g.Buf8(R),U=$=0;$<R;U++)(64512&(k=M.charCodeAt(U)))==55296&&U+1<V&&(64512&(P=M.charCodeAt(U+1)))==56320&&(k=65536+(k-55296<<10)+(P-56320),U++),k<128?L[$++]=k:(k<2048?L[$++]=192|k>>>6:(k<65536?L[$++]=224|k>>>12:(L[$++]=240|k>>>18,L[$++]=128|k>>>12&63),L[$++]=128|k>>>6&63),L[$++]=128|63&k);return L},p.buf2binstring=function(M){return A(M,M.length)},p.binstring2buf=function(M){for(var L=new g.Buf8(M.length),k=0,P=L.length;k<P;k++)L[k]=M.charCodeAt(k);return L},p.buf2string=function(M,L){var k,P,U,$,V=L||M.length,R=new Array(2*V);for(k=P=0;k<V;)if((U=M[k++])<128)R[P++]=U;else if(4<($=b[U]))R[P++]=65533,k+=$-1;else{for(U&=$===2?31:$===3?15:7;1<$&&k<V;)U=U<<6|63&M[k++],$--;1<$?R[P++]=65533:U<65536?R[P++]=U:(U-=65536,R[P++]=55296|U>>10&1023,R[P++]=56320|1023&U)}return A(R,P)},p.utf8border=function(M,L){var k;for((L=L||M.length)>M.length&&(L=M.length),k=L-1;0<=k&&(192&M[k])==128;)k--;return k<0||k===0?L:k+b[M[k]]>L?k:L}},{"./common":41}],43:[function(f,m,p){m.exports=function(g,v,y,b){for(var E=65535&g|0,A=g>>>16&65535|0,M=0;y!==0;){for(y-=M=2e3<y?2e3:y;A=A+(E=E+v[b++]|0)|0,--M;);E%=65521,A%=65521}return E|A<<16|0}},{}],44:[function(f,m,p){m.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(f,m,p){var g=(function(){for(var v,y=[],b=0;b<256;b++){v=b;for(var E=0;E<8;E++)v=1&v?3988292384^v>>>1:v>>>1;y[b]=v}return y})();m.exports=function(v,y,b,E){var A=g,M=E+b;v^=-1;for(var L=E;L<M;L++)v=v>>>8^A[255&(v^y[L])];return-1^v}},{}],46:[function(f,m,p){var g,v=f("../utils/common"),y=f("./trees"),b=f("./adler32"),E=f("./crc32"),A=f("./messages"),M=-2,L=258,k=262,P=113;function U(B,X){return B.msg=A[X],X}function $(B){return(B<<1)-(4<B?9:0)}function V(B){for(var X=B.length;0<=--X;)B[X]=0}function R(B){var X=B.state,I=X.pending;I>B.avail_out&&(I=B.avail_out),I!==0&&(v.arraySet(B.output,X.pending_buf,X.pending_out,I,B.next_out),B.next_out+=I,X.pending_out+=I,B.total_out+=I,B.avail_out-=I,X.pending-=I,X.pending===0&&(X.pending_out=0))}function O(B,X){y._tr_flush_block(B,0<=B.block_start?B.block_start:-1,B.strstart-B.block_start,X),B.block_start=B.strstart,R(B.strm)}function T(B,X){B.pending_buf[B.pending++]=X}function w(B,X){B.pending_buf[B.pending++]=X>>>8&255,B.pending_buf[B.pending++]=255&X}function x(B,X){var I,N,j=B.max_chain_length,Q=B.strstart,W=B.prev_length,Y=B.nice_match,Z=B.strstart>B.w_size-k?B.strstart-(B.w_size-k):0,se=B.window,re=B.w_mask,K=B.prev,ie=B.strstart+L,ne=se[Q+W-1],le=se[Q+W];B.prev_length>=B.good_match&&(j>>=2),Y>B.lookahead&&(Y=B.lookahead);do if(se[(I=X)+W]===le&&se[I+W-1]===ne&&se[I]===se[Q]&&se[++I]===se[Q+1]){Q+=2,I++;do;while(se[++Q]===se[++I]&&se[++Q]===se[++I]&&se[++Q]===se[++I]&&se[++Q]===se[++I]&&se[++Q]===se[++I]&&se[++Q]===se[++I]&&se[++Q]===se[++I]&&se[++Q]===se[++I]&&Q<ie);if(N=L-(ie-Q),Q=ie-L,W<N){if(B.match_start=X,Y<=(W=N))break;ne=se[Q+W-1],le=se[Q+W]}}while((X=K[X&re])>Z&&--j!=0);return W<=B.lookahead?W:B.lookahead}function _(B){var X,I,N,j,Q,W,Y,Z,se,re,K=B.w_size;do{if(j=B.window_size-B.lookahead-B.strstart,B.strstart>=K+(K-k)){for(v.arraySet(B.window,B.window,K,K,0),B.match_start-=K,B.strstart-=K,B.block_start-=K,X=I=B.hash_size;N=B.head[--X],B.head[X]=K<=N?N-K:0,--I;);for(X=I=K;N=B.prev[--X],B.prev[X]=K<=N?N-K:0,--I;);j+=K}if(B.strm.avail_in===0)break;if(W=B.strm,Y=B.window,Z=B.strstart+B.lookahead,re=void 0,(se=j)<(re=W.avail_in)&&(re=se),I=re===0?0:(W.avail_in-=re,v.arraySet(Y,W.input,W.next_in,re,Z),W.state.wrap===1?W.adler=b(W.adler,Y,re,Z):W.state.wrap===2&&(W.adler=E(W.adler,Y,re,Z)),W.next_in+=re,W.total_in+=re,re),B.lookahead+=I,B.lookahead+B.insert>=3)for(Q=B.strstart-B.insert,B.ins_h=B.window[Q],B.ins_h=(B.ins_h<<B.hash_shift^B.window[Q+1])&B.hash_mask;B.insert&&(B.ins_h=(B.ins_h<<B.hash_shift^B.window[Q+3-1])&B.hash_mask,B.prev[Q&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=Q,Q++,B.insert--,!(B.lookahead+B.insert<3)););}while(B.lookahead<k&&B.strm.avail_in!==0)}function S(B,X){for(var I,N;;){if(B.lookahead<k){if(_(B),B.lookahead<k&&X===0)return 1;if(B.lookahead===0)break}if(I=0,B.lookahead>=3&&(B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+3-1])&B.hash_mask,I=B.prev[B.strstart&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=B.strstart),I!==0&&B.strstart-I<=B.w_size-k&&(B.match_length=x(B,I)),B.match_length>=3)if(N=y._tr_tally(B,B.strstart-B.match_start,B.match_length-3),B.lookahead-=B.match_length,B.match_length<=B.max_lazy_match&&B.lookahead>=3){for(B.match_length--;B.strstart++,B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+3-1])&B.hash_mask,I=B.prev[B.strstart&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=B.strstart,--B.match_length!=0;);B.strstart++}else B.strstart+=B.match_length,B.match_length=0,B.ins_h=B.window[B.strstart],B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+1])&B.hash_mask;else N=y._tr_tally(B,0,B.window[B.strstart]),B.lookahead--,B.strstart++;if(N&&(O(B,!1),B.strm.avail_out===0))return 1}return B.insert=B.strstart<2?B.strstart:2,X===4?(O(B,!0),B.strm.avail_out===0?3:4):B.last_lit&&(O(B,!1),B.strm.avail_out===0)?1:2}function C(B,X){for(var I,N,j;;){if(B.lookahead<k){if(_(B),B.lookahead<k&&X===0)return 1;if(B.lookahead===0)break}if(I=0,B.lookahead>=3&&(B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+3-1])&B.hash_mask,I=B.prev[B.strstart&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=B.strstart),B.prev_length=B.match_length,B.prev_match=B.match_start,B.match_length=2,I!==0&&B.prev_length<B.max_lazy_match&&B.strstart-I<=B.w_size-k&&(B.match_length=x(B,I),B.match_length<=5&&(B.strategy===1||B.match_length===3&&4096<B.strstart-B.match_start)&&(B.match_length=2)),B.prev_length>=3&&B.match_length<=B.prev_length){for(j=B.strstart+B.lookahead-3,N=y._tr_tally(B,B.strstart-1-B.prev_match,B.prev_length-3),B.lookahead-=B.prev_length-1,B.prev_length-=2;++B.strstart<=j&&(B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+3-1])&B.hash_mask,I=B.prev[B.strstart&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=B.strstart),--B.prev_length!=0;);if(B.match_available=0,B.match_length=2,B.strstart++,N&&(O(B,!1),B.strm.avail_out===0))return 1}else if(B.match_available){if((N=y._tr_tally(B,0,B.window[B.strstart-1]))&&O(B,!1),B.strstart++,B.lookahead--,B.strm.avail_out===0)return 1}else B.match_available=1,B.strstart++,B.lookahead--}return B.match_available&&(N=y._tr_tally(B,0,B.window[B.strstart-1]),B.match_available=0),B.insert=B.strstart<2?B.strstart:2,X===4?(O(B,!0),B.strm.avail_out===0?3:4):B.last_lit&&(O(B,!1),B.strm.avail_out===0)?1:2}function F(B,X,I,N,j){this.good_length=B,this.max_lazy=X,this.nice_length=I,this.max_chain=N,this.func=j}function D(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new v.Buf16(1146),this.dyn_dtree=new v.Buf16(122),this.bl_tree=new v.Buf16(78),V(this.dyn_ltree),V(this.dyn_dtree),V(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new v.Buf16(16),this.heap=new v.Buf16(573),V(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new v.Buf16(573),V(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function H(B){var X;return B&&B.state?(B.total_in=B.total_out=0,B.data_type=2,(X=B.state).pending=0,X.pending_out=0,X.wrap<0&&(X.wrap=-X.wrap),X.status=X.wrap?42:P,B.adler=X.wrap===2?0:1,X.last_flush=0,y._tr_init(X),0):U(B,M)}function G(B){var X=H(B);return X===0&&(function(I){I.window_size=2*I.w_size,V(I.head),I.max_lazy_match=g[I.level].max_lazy,I.good_match=g[I.level].good_length,I.nice_match=g[I.level].nice_length,I.max_chain_length=g[I.level].max_chain,I.strstart=0,I.block_start=0,I.lookahead=0,I.insert=0,I.match_length=I.prev_length=2,I.match_available=0,I.ins_h=0})(B.state),X}function ee(B,X,I,N,j,Q){if(!B)return M;var W=1;if(X===-1&&(X=6),N<0?(W=0,N=-N):15<N&&(W=2,N-=16),j<1||9<j||I!==8||N<8||15<N||X<0||9<X||Q<0||4<Q)return U(B,M);N===8&&(N=9);var Y=new D;return(B.state=Y).strm=B,Y.wrap=W,Y.gzhead=null,Y.w_bits=N,Y.w_size=1<<Y.w_bits,Y.w_mask=Y.w_size-1,Y.hash_bits=j+7,Y.hash_size=1<<Y.hash_bits,Y.hash_mask=Y.hash_size-1,Y.hash_shift=~~((Y.hash_bits+3-1)/3),Y.window=new v.Buf8(2*Y.w_size),Y.head=new v.Buf16(Y.hash_size),Y.prev=new v.Buf16(Y.w_size),Y.lit_bufsize=1<<j+6,Y.pending_buf_size=4*Y.lit_bufsize,Y.pending_buf=new v.Buf8(Y.pending_buf_size),Y.d_buf=1*Y.lit_bufsize,Y.l_buf=3*Y.lit_bufsize,Y.level=X,Y.strategy=Q,Y.method=I,G(B)}g=[new F(0,0,0,0,(function(B,X){var I=65535;for(I>B.pending_buf_size-5&&(I=B.pending_buf_size-5);;){if(B.lookahead<=1){if(_(B),B.lookahead===0&&X===0)return 1;if(B.lookahead===0)break}B.strstart+=B.lookahead,B.lookahead=0;var N=B.block_start+I;if((B.strstart===0||B.strstart>=N)&&(B.lookahead=B.strstart-N,B.strstart=N,O(B,!1),B.strm.avail_out===0)||B.strstart-B.block_start>=B.w_size-k&&(O(B,!1),B.strm.avail_out===0))return 1}return B.insert=0,X===4?(O(B,!0),B.strm.avail_out===0?3:4):(B.strstart>B.block_start&&(O(B,!1),B.strm.avail_out),1)})),new F(4,4,8,4,S),new F(4,5,16,8,S),new F(4,6,32,32,S),new F(4,4,16,16,C),new F(8,16,32,32,C),new F(8,16,128,128,C),new F(8,32,128,256,C),new F(32,128,258,1024,C),new F(32,258,258,4096,C)],p.deflateInit=function(B,X){return ee(B,X,8,15,8,0)},p.deflateInit2=ee,p.deflateReset=G,p.deflateResetKeep=H,p.deflateSetHeader=function(B,X){return B&&B.state?B.state.wrap!==2?M:(B.state.gzhead=X,0):M},p.deflate=function(B,X){var I,N,j,Q;if(!B||!B.state||5<X||X<0)return B?U(B,M):M;if(N=B.state,!B.output||!B.input&&B.avail_in!==0||N.status===666&&X!==4)return U(B,B.avail_out===0?-5:M);if(N.strm=B,I=N.last_flush,N.last_flush=X,N.status===42)if(N.wrap===2)B.adler=0,T(N,31),T(N,139),T(N,8),N.gzhead?(T(N,(N.gzhead.text?1:0)+(N.gzhead.hcrc?2:0)+(N.gzhead.extra?4:0)+(N.gzhead.name?8:0)+(N.gzhead.comment?16:0)),T(N,255&N.gzhead.time),T(N,N.gzhead.time>>8&255),T(N,N.gzhead.time>>16&255),T(N,N.gzhead.time>>24&255),T(N,N.level===9?2:2<=N.strategy||N.level<2?4:0),T(N,255&N.gzhead.os),N.gzhead.extra&&N.gzhead.extra.length&&(T(N,255&N.gzhead.extra.length),T(N,N.gzhead.extra.length>>8&255)),N.gzhead.hcrc&&(B.adler=E(B.adler,N.pending_buf,N.pending,0)),N.gzindex=0,N.status=69):(T(N,0),T(N,0),T(N,0),T(N,0),T(N,0),T(N,N.level===9?2:2<=N.strategy||N.level<2?4:0),T(N,3),N.status=P);else{var W=8+(N.w_bits-8<<4)<<8;W|=(2<=N.strategy||N.level<2?0:N.level<6?1:N.level===6?2:3)<<6,N.strstart!==0&&(W|=32),W+=31-W%31,N.status=P,w(N,W),N.strstart!==0&&(w(N,B.adler>>>16),w(N,65535&B.adler)),B.adler=1}if(N.status===69)if(N.gzhead.extra){for(j=N.pending;N.gzindex<(65535&N.gzhead.extra.length)&&(N.pending!==N.pending_buf_size||(N.gzhead.hcrc&&N.pending>j&&(B.adler=E(B.adler,N.pending_buf,N.pending-j,j)),R(B),j=N.pending,N.pending!==N.pending_buf_size));)T(N,255&N.gzhead.extra[N.gzindex]),N.gzindex++;N.gzhead.hcrc&&N.pending>j&&(B.adler=E(B.adler,N.pending_buf,N.pending-j,j)),N.gzindex===N.gzhead.extra.length&&(N.gzindex=0,N.status=73)}else N.status=73;if(N.status===73)if(N.gzhead.name){j=N.pending;do{if(N.pending===N.pending_buf_size&&(N.gzhead.hcrc&&N.pending>j&&(B.adler=E(B.adler,N.pending_buf,N.pending-j,j)),R(B),j=N.pending,N.pending===N.pending_buf_size)){Q=1;break}Q=N.gzindex<N.gzhead.name.length?255&N.gzhead.name.charCodeAt(N.gzindex++):0,T(N,Q)}while(Q!==0);N.gzhead.hcrc&&N.pending>j&&(B.adler=E(B.adler,N.pending_buf,N.pending-j,j)),Q===0&&(N.gzindex=0,N.status=91)}else N.status=91;if(N.status===91)if(N.gzhead.comment){j=N.pending;do{if(N.pending===N.pending_buf_size&&(N.gzhead.hcrc&&N.pending>j&&(B.adler=E(B.adler,N.pending_buf,N.pending-j,j)),R(B),j=N.pending,N.pending===N.pending_buf_size)){Q=1;break}Q=N.gzindex<N.gzhead.comment.length?255&N.gzhead.comment.charCodeAt(N.gzindex++):0,T(N,Q)}while(Q!==0);N.gzhead.hcrc&&N.pending>j&&(B.adler=E(B.adler,N.pending_buf,N.pending-j,j)),Q===0&&(N.status=103)}else N.status=103;if(N.status===103&&(N.gzhead.hcrc?(N.pending+2>N.pending_buf_size&&R(B),N.pending+2<=N.pending_buf_size&&(T(N,255&B.adler),T(N,B.adler>>8&255),B.adler=0,N.status=P)):N.status=P),N.pending!==0){if(R(B),B.avail_out===0)return N.last_flush=-1,0}else if(B.avail_in===0&&$(X)<=$(I)&&X!==4)return U(B,-5);if(N.status===666&&B.avail_in!==0)return U(B,-5);if(B.avail_in!==0||N.lookahead!==0||X!==0&&N.status!==666){var Y=N.strategy===2?(function(Z,se){for(var re;;){if(Z.lookahead===0&&(_(Z),Z.lookahead===0)){if(se===0)return 1;break}if(Z.match_length=0,re=y._tr_tally(Z,0,Z.window[Z.strstart]),Z.lookahead--,Z.strstart++,re&&(O(Z,!1),Z.strm.avail_out===0))return 1}return Z.insert=0,se===4?(O(Z,!0),Z.strm.avail_out===0?3:4):Z.last_lit&&(O(Z,!1),Z.strm.avail_out===0)?1:2})(N,X):N.strategy===3?(function(Z,se){for(var re,K,ie,ne,le=Z.window;;){if(Z.lookahead<=L){if(_(Z),Z.lookahead<=L&&se===0)return 1;if(Z.lookahead===0)break}if(Z.match_length=0,Z.lookahead>=3&&0<Z.strstart&&(K=le[ie=Z.strstart-1])===le[++ie]&&K===le[++ie]&&K===le[++ie]){ne=Z.strstart+L;do;while(K===le[++ie]&&K===le[++ie]&&K===le[++ie]&&K===le[++ie]&&K===le[++ie]&&K===le[++ie]&&K===le[++ie]&&K===le[++ie]&&ie<ne);Z.match_length=L-(ne-ie),Z.match_length>Z.lookahead&&(Z.match_length=Z.lookahead)}if(Z.match_length>=3?(re=y._tr_tally(Z,1,Z.match_length-3),Z.lookahead-=Z.match_length,Z.strstart+=Z.match_length,Z.match_length=0):(re=y._tr_tally(Z,0,Z.window[Z.strstart]),Z.lookahead--,Z.strstart++),re&&(O(Z,!1),Z.strm.avail_out===0))return 1}return Z.insert=0,se===4?(O(Z,!0),Z.strm.avail_out===0?3:4):Z.last_lit&&(O(Z,!1),Z.strm.avail_out===0)?1:2})(N,X):g[N.level].func(N,X);if(Y!==3&&Y!==4||(N.status=666),Y===1||Y===3)return B.avail_out===0&&(N.last_flush=-1),0;if(Y===2&&(X===1?y._tr_align(N):X!==5&&(y._tr_stored_block(N,0,0,!1),X===3&&(V(N.head),N.lookahead===0&&(N.strstart=0,N.block_start=0,N.insert=0))),R(B),B.avail_out===0))return N.last_flush=-1,0}return X!==4?0:N.wrap<=0?1:(N.wrap===2?(T(N,255&B.adler),T(N,B.adler>>8&255),T(N,B.adler>>16&255),T(N,B.adler>>24&255),T(N,255&B.total_in),T(N,B.total_in>>8&255),T(N,B.total_in>>16&255),T(N,B.total_in>>24&255)):(w(N,B.adler>>>16),w(N,65535&B.adler)),R(B),0<N.wrap&&(N.wrap=-N.wrap),N.pending!==0?0:1)},p.deflateEnd=function(B){var X;return B&&B.state?(X=B.state.status)!==42&&X!==69&&X!==73&&X!==91&&X!==103&&X!==P&&X!==666?U(B,M):(B.state=null,X===P?U(B,-3):0):M},p.deflateSetDictionary=function(B,X){var I,N,j,Q,W,Y,Z,se,re=X.length;if(!B||!B.state||(Q=(I=B.state).wrap)===2||Q===1&&I.status!==42||I.lookahead)return M;for(Q===1&&(B.adler=b(B.adler,X,re,0)),I.wrap=0,re>=I.w_size&&(Q===0&&(V(I.head),I.strstart=0,I.block_start=0,I.insert=0),se=new v.Buf8(I.w_size),v.arraySet(se,X,re-I.w_size,I.w_size,0),X=se,re=I.w_size),W=B.avail_in,Y=B.next_in,Z=B.input,B.avail_in=re,B.next_in=0,B.input=X,_(I);I.lookahead>=3;){for(N=I.strstart,j=I.lookahead-2;I.ins_h=(I.ins_h<<I.hash_shift^I.window[N+3-1])&I.hash_mask,I.prev[N&I.w_mask]=I.head[I.ins_h],I.head[I.ins_h]=N,N++,--j;);I.strstart=N,I.lookahead=2,_(I)}return I.strstart+=I.lookahead,I.block_start=I.strstart,I.insert=I.lookahead,I.lookahead=0,I.match_length=I.prev_length=2,I.match_available=0,B.next_in=Y,B.input=Z,B.avail_in=W,I.wrap=Q,0},p.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(f,m,p){m.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(f,m,p){m.exports=function(g,v){var y,b,E,A,M,L,k,P,U,$,V,R,O,T,w,x,_,S,C,F,D,H,G,ee,B;y=g.state,b=g.next_in,ee=g.input,E=b+(g.avail_in-5),A=g.next_out,B=g.output,M=A-(v-g.avail_out),L=A+(g.avail_out-257),k=y.dmax,P=y.wsize,U=y.whave,$=y.wnext,V=y.window,R=y.hold,O=y.bits,T=y.lencode,w=y.distcode,x=(1<<y.lenbits)-1,_=(1<<y.distbits)-1;e:do{O<15&&(R+=ee[b++]<<O,O+=8,R+=ee[b++]<<O,O+=8),S=T[R&x];t:for(;;){if(R>>>=C=S>>>24,O-=C,(C=S>>>16&255)==0)B[A++]=65535&S;else{if(!(16&C)){if((64&C)==0){S=T[(65535&S)+(R&(1<<C)-1)];continue t}if(32&C){y.mode=12;break e}g.msg="invalid literal/length code",y.mode=30;break e}F=65535&S,(C&=15)&&(O<C&&(R+=ee[b++]<<O,O+=8),F+=R&(1<<C)-1,R>>>=C,O-=C),O<15&&(R+=ee[b++]<<O,O+=8,R+=ee[b++]<<O,O+=8),S=w[R&_];r:for(;;){if(R>>>=C=S>>>24,O-=C,!(16&(C=S>>>16&255))){if((64&C)==0){S=w[(65535&S)+(R&(1<<C)-1)];continue r}g.msg="invalid distance code",y.mode=30;break e}if(D=65535&S,O<(C&=15)&&(R+=ee[b++]<<O,(O+=8)<C&&(R+=ee[b++]<<O,O+=8)),k<(D+=R&(1<<C)-1)){g.msg="invalid distance too far back",y.mode=30;break e}if(R>>>=C,O-=C,(C=A-M)<D){if(U<(C=D-C)&&y.sane){g.msg="invalid distance too far back",y.mode=30;break e}if(G=V,(H=0)===$){if(H+=P-C,C<F){for(F-=C;B[A++]=V[H++],--C;);H=A-D,G=B}}else if($<C){if(H+=P+$-C,(C-=$)<F){for(F-=C;B[A++]=V[H++],--C;);if(H=0,$<F){for(F-=C=$;B[A++]=V[H++],--C;);H=A-D,G=B}}}else if(H+=$-C,C<F){for(F-=C;B[A++]=V[H++],--C;);H=A-D,G=B}for(;2<F;)B[A++]=G[H++],B[A++]=G[H++],B[A++]=G[H++],F-=3;F&&(B[A++]=G[H++],1<F&&(B[A++]=G[H++]))}else{for(H=A-D;B[A++]=B[H++],B[A++]=B[H++],B[A++]=B[H++],2<(F-=3););F&&(B[A++]=B[H++],1<F&&(B[A++]=B[H++]))}break}}break}}while(b<E&&A<L);b-=F=O>>3,R&=(1<<(O-=F<<3))-1,g.next_in=b,g.next_out=A,g.avail_in=b<E?E-b+5:5-(b-E),g.avail_out=A<L?L-A+257:257-(A-L),y.hold=R,y.bits=O}},{}],49:[function(f,m,p){var g=f("../utils/common"),v=f("./adler32"),y=f("./crc32"),b=f("./inffast"),E=f("./inftrees"),A=-2;function M(x){return(x>>>24&255)+(x>>>8&65280)+((65280&x)<<8)+((255&x)<<24)}function L(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new g.Buf16(320),this.work=new g.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function k(x){var _;return x&&x.state?(_=x.state,x.total_in=x.total_out=_.total=0,x.msg="",_.wrap&&(x.adler=1&_.wrap),_.mode=1,_.last=0,_.havedict=0,_.dmax=32768,_.head=null,_.hold=0,_.bits=0,_.lencode=_.lendyn=new g.Buf32(852),_.distcode=_.distdyn=new g.Buf32(592),_.sane=1,_.back=-1,0):A}function P(x){var _;return x&&x.state?((_=x.state).wsize=0,_.whave=0,_.wnext=0,k(x)):A}function U(x,_){var S,C;return x&&x.state?(C=x.state,_<0?(S=0,_=-_):(S=1+(_>>4),_<48&&(_&=15)),_&&(_<8||15<_)?A:(C.window!==null&&C.wbits!==_&&(C.window=null),C.wrap=S,C.wbits=_,P(x))):A}function $(x,_){var S,C;return x?(C=new L,(x.state=C).window=null,(S=U(x,_))!==0&&(x.state=null),S):A}var V,R,O=!0;function T(x){if(O){var _;for(V=new g.Buf32(512),R=new g.Buf32(32),_=0;_<144;)x.lens[_++]=8;for(;_<256;)x.lens[_++]=9;for(;_<280;)x.lens[_++]=7;for(;_<288;)x.lens[_++]=8;for(E(1,x.lens,0,288,V,0,x.work,{bits:9}),_=0;_<32;)x.lens[_++]=5;E(2,x.lens,0,32,R,0,x.work,{bits:5}),O=!1}x.lencode=V,x.lenbits=9,x.distcode=R,x.distbits=5}function w(x,_,S,C){var F,D=x.state;return D.window===null&&(D.wsize=1<<D.wbits,D.wnext=0,D.whave=0,D.window=new g.Buf8(D.wsize)),C>=D.wsize?(g.arraySet(D.window,_,S-D.wsize,D.wsize,0),D.wnext=0,D.whave=D.wsize):(C<(F=D.wsize-D.wnext)&&(F=C),g.arraySet(D.window,_,S-C,F,D.wnext),(C-=F)?(g.arraySet(D.window,_,S-C,C,0),D.wnext=C,D.whave=D.wsize):(D.wnext+=F,D.wnext===D.wsize&&(D.wnext=0),D.whave<D.wsize&&(D.whave+=F))),0}p.inflateReset=P,p.inflateReset2=U,p.inflateResetKeep=k,p.inflateInit=function(x){return $(x,15)},p.inflateInit2=$,p.inflate=function(x,_){var S,C,F,D,H,G,ee,B,X,I,N,j,Q,W,Y,Z,se,re,K,ie,ne,le,ae,fe,pe=0,ye=new g.Buf8(4),xe=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!x||!x.state||!x.output||!x.input&&x.avail_in!==0)return A;(S=x.state).mode===12&&(S.mode=13),H=x.next_out,F=x.output,ee=x.avail_out,D=x.next_in,C=x.input,G=x.avail_in,B=S.hold,X=S.bits,I=G,N=ee,le=0;e:for(;;)switch(S.mode){case 1:if(S.wrap===0){S.mode=13;break}for(;X<16;){if(G===0)break e;G--,B+=C[D++]<<X,X+=8}if(2&S.wrap&&B===35615){ye[S.check=0]=255&B,ye[1]=B>>>8&255,S.check=y(S.check,ye,2,0),X=B=0,S.mode=2;break}if(S.flags=0,S.head&&(S.head.done=!1),!(1&S.wrap)||(((255&B)<<8)+(B>>8))%31){x.msg="incorrect header check",S.mode=30;break}if((15&B)!=8){x.msg="unknown compression method",S.mode=30;break}if(X-=4,ne=8+(15&(B>>>=4)),S.wbits===0)S.wbits=ne;else if(ne>S.wbits){x.msg="invalid window size",S.mode=30;break}S.dmax=1<<ne,x.adler=S.check=1,S.mode=512&B?10:12,X=B=0;break;case 2:for(;X<16;){if(G===0)break e;G--,B+=C[D++]<<X,X+=8}if(S.flags=B,(255&S.flags)!=8){x.msg="unknown compression method",S.mode=30;break}if(57344&S.flags){x.msg="unknown header flags set",S.mode=30;break}S.head&&(S.head.text=B>>8&1),512&S.flags&&(ye[0]=255&B,ye[1]=B>>>8&255,S.check=y(S.check,ye,2,0)),X=B=0,S.mode=3;case 3:for(;X<32;){if(G===0)break e;G--,B+=C[D++]<<X,X+=8}S.head&&(S.head.time=B),512&S.flags&&(ye[0]=255&B,ye[1]=B>>>8&255,ye[2]=B>>>16&255,ye[3]=B>>>24&255,S.check=y(S.check,ye,4,0)),X=B=0,S.mode=4;case 4:for(;X<16;){if(G===0)break e;G--,B+=C[D++]<<X,X+=8}S.head&&(S.head.xflags=255&B,S.head.os=B>>8),512&S.flags&&(ye[0]=255&B,ye[1]=B>>>8&255,S.check=y(S.check,ye,2,0)),X=B=0,S.mode=5;case 5:if(1024&S.flags){for(;X<16;){if(G===0)break e;G--,B+=C[D++]<<X,X+=8}S.length=B,S.head&&(S.head.extra_len=B),512&S.flags&&(ye[0]=255&B,ye[1]=B>>>8&255,S.check=y(S.check,ye,2,0)),X=B=0}else S.head&&(S.head.extra=null);S.mode=6;case 6:if(1024&S.flags&&(G<(j=S.length)&&(j=G),j&&(S.head&&(ne=S.head.extra_len-S.length,S.head.extra||(S.head.extra=new Array(S.head.extra_len)),g.arraySet(S.head.extra,C,D,j,ne)),512&S.flags&&(S.check=y(S.check,C,j,D)),G-=j,D+=j,S.length-=j),S.length))break e;S.length=0,S.mode=7;case 7:if(2048&S.flags){if(G===0)break e;for(j=0;ne=C[D+j++],S.head&&ne&&S.length<65536&&(S.head.name+=String.fromCharCode(ne)),ne&&j<G;);if(512&S.flags&&(S.check=y(S.check,C,j,D)),G-=j,D+=j,ne)break e}else S.head&&(S.head.name=null);S.length=0,S.mode=8;case 8:if(4096&S.flags){if(G===0)break e;for(j=0;ne=C[D+j++],S.head&&ne&&S.length<65536&&(S.head.comment+=String.fromCharCode(ne)),ne&&j<G;);if(512&S.flags&&(S.check=y(S.check,C,j,D)),G-=j,D+=j,ne)break e}else S.head&&(S.head.comment=null);S.mode=9;case 9:if(512&S.flags){for(;X<16;){if(G===0)break e;G--,B+=C[D++]<<X,X+=8}if(B!==(65535&S.check)){x.msg="header crc mismatch",S.mode=30;break}X=B=0}S.head&&(S.head.hcrc=S.flags>>9&1,S.head.done=!0),x.adler=S.check=0,S.mode=12;break;case 10:for(;X<32;){if(G===0)break e;G--,B+=C[D++]<<X,X+=8}x.adler=S.check=M(B),X=B=0,S.mode=11;case 11:if(S.havedict===0)return x.next_out=H,x.avail_out=ee,x.next_in=D,x.avail_in=G,S.hold=B,S.bits=X,2;x.adler=S.check=1,S.mode=12;case 12:if(_===5||_===6)break e;case 13:if(S.last){B>>>=7&X,X-=7&X,S.mode=27;break}for(;X<3;){if(G===0)break e;G--,B+=C[D++]<<X,X+=8}switch(S.last=1&B,X-=1,3&(B>>>=1)){case 0:S.mode=14;break;case 1:if(T(S),S.mode=20,_!==6)break;B>>>=2,X-=2;break e;case 2:S.mode=17;break;case 3:x.msg="invalid block type",S.mode=30}B>>>=2,X-=2;break;case 14:for(B>>>=7&X,X-=7&X;X<32;){if(G===0)break e;G--,B+=C[D++]<<X,X+=8}if((65535&B)!=(B>>>16^65535)){x.msg="invalid stored block lengths",S.mode=30;break}if(S.length=65535&B,X=B=0,S.mode=15,_===6)break e;case 15:S.mode=16;case 16:if(j=S.length){if(G<j&&(j=G),ee<j&&(j=ee),j===0)break e;g.arraySet(F,C,D,j,H),G-=j,D+=j,ee-=j,H+=j,S.length-=j;break}S.mode=12;break;case 17:for(;X<14;){if(G===0)break e;G--,B+=C[D++]<<X,X+=8}if(S.nlen=257+(31&B),B>>>=5,X-=5,S.ndist=1+(31&B),B>>>=5,X-=5,S.ncode=4+(15&B),B>>>=4,X-=4,286<S.nlen||30<S.ndist){x.msg="too many length or distance symbols",S.mode=30;break}S.have=0,S.mode=18;case 18:for(;S.have<S.ncode;){for(;X<3;){if(G===0)break e;G--,B+=C[D++]<<X,X+=8}S.lens[xe[S.have++]]=7&B,B>>>=3,X-=3}for(;S.have<19;)S.lens[xe[S.have++]]=0;if(S.lencode=S.lendyn,S.lenbits=7,ae={bits:S.lenbits},le=E(0,S.lens,0,19,S.lencode,0,S.work,ae),S.lenbits=ae.bits,le){x.msg="invalid code lengths set",S.mode=30;break}S.have=0,S.mode=19;case 19:for(;S.have<S.nlen+S.ndist;){for(;Z=(pe=S.lencode[B&(1<<S.lenbits)-1])>>>16&255,se=65535&pe,!((Y=pe>>>24)<=X);){if(G===0)break e;G--,B+=C[D++]<<X,X+=8}if(se<16)B>>>=Y,X-=Y,S.lens[S.have++]=se;else{if(se===16){for(fe=Y+2;X<fe;){if(G===0)break e;G--,B+=C[D++]<<X,X+=8}if(B>>>=Y,X-=Y,S.have===0){x.msg="invalid bit length repeat",S.mode=30;break}ne=S.lens[S.have-1],j=3+(3&B),B>>>=2,X-=2}else if(se===17){for(fe=Y+3;X<fe;){if(G===0)break e;G--,B+=C[D++]<<X,X+=8}X-=Y,ne=0,j=3+(7&(B>>>=Y)),B>>>=3,X-=3}else{for(fe=Y+7;X<fe;){if(G===0)break e;G--,B+=C[D++]<<X,X+=8}X-=Y,ne=0,j=11+(127&(B>>>=Y)),B>>>=7,X-=7}if(S.have+j>S.nlen+S.ndist){x.msg="invalid bit length repeat",S.mode=30;break}for(;j--;)S.lens[S.have++]=ne}}if(S.mode===30)break;if(S.lens[256]===0){x.msg="invalid code -- missing end-of-block",S.mode=30;break}if(S.lenbits=9,ae={bits:S.lenbits},le=E(1,S.lens,0,S.nlen,S.lencode,0,S.work,ae),S.lenbits=ae.bits,le){x.msg="invalid literal/lengths set",S.mode=30;break}if(S.distbits=6,S.distcode=S.distdyn,ae={bits:S.distbits},le=E(2,S.lens,S.nlen,S.ndist,S.distcode,0,S.work,ae),S.distbits=ae.bits,le){x.msg="invalid distances set",S.mode=30;break}if(S.mode=20,_===6)break e;case 20:S.mode=21;case 21:if(6<=G&&258<=ee){x.next_out=H,x.avail_out=ee,x.next_in=D,x.avail_in=G,S.hold=B,S.bits=X,b(x,N),H=x.next_out,F=x.output,ee=x.avail_out,D=x.next_in,C=x.input,G=x.avail_in,B=S.hold,X=S.bits,S.mode===12&&(S.back=-1);break}for(S.back=0;Z=(pe=S.lencode[B&(1<<S.lenbits)-1])>>>16&255,se=65535&pe,!((Y=pe>>>24)<=X);){if(G===0)break e;G--,B+=C[D++]<<X,X+=8}if(Z&&(240&Z)==0){for(re=Y,K=Z,ie=se;Z=(pe=S.lencode[ie+((B&(1<<re+K)-1)>>re)])>>>16&255,se=65535&pe,!(re+(Y=pe>>>24)<=X);){if(G===0)break e;G--,B+=C[D++]<<X,X+=8}B>>>=re,X-=re,S.back+=re}if(B>>>=Y,X-=Y,S.back+=Y,S.length=se,Z===0){S.mode=26;break}if(32&Z){S.back=-1,S.mode=12;break}if(64&Z){x.msg="invalid literal/length code",S.mode=30;break}S.extra=15&Z,S.mode=22;case 22:if(S.extra){for(fe=S.extra;X<fe;){if(G===0)break e;G--,B+=C[D++]<<X,X+=8}S.length+=B&(1<<S.extra)-1,B>>>=S.extra,X-=S.extra,S.back+=S.extra}S.was=S.length,S.mode=23;case 23:for(;Z=(pe=S.distcode[B&(1<<S.distbits)-1])>>>16&255,se=65535&pe,!((Y=pe>>>24)<=X);){if(G===0)break e;G--,B+=C[D++]<<X,X+=8}if((240&Z)==0){for(re=Y,K=Z,ie=se;Z=(pe=S.distcode[ie+((B&(1<<re+K)-1)>>re)])>>>16&255,se=65535&pe,!(re+(Y=pe>>>24)<=X);){if(G===0)break e;G--,B+=C[D++]<<X,X+=8}B>>>=re,X-=re,S.back+=re}if(B>>>=Y,X-=Y,S.back+=Y,64&Z){x.msg="invalid distance code",S.mode=30;break}S.offset=se,S.extra=15&Z,S.mode=24;case 24:if(S.extra){for(fe=S.extra;X<fe;){if(G===0)break e;G--,B+=C[D++]<<X,X+=8}S.offset+=B&(1<<S.extra)-1,B>>>=S.extra,X-=S.extra,S.back+=S.extra}if(S.offset>S.dmax){x.msg="invalid distance too far back",S.mode=30;break}S.mode=25;case 25:if(ee===0)break e;if(j=N-ee,S.offset>j){if((j=S.offset-j)>S.whave&&S.sane){x.msg="invalid distance too far back",S.mode=30;break}Q=j>S.wnext?(j-=S.wnext,S.wsize-j):S.wnext-j,j>S.length&&(j=S.length),W=S.window}else W=F,Q=H-S.offset,j=S.length;for(ee<j&&(j=ee),ee-=j,S.length-=j;F[H++]=W[Q++],--j;);S.length===0&&(S.mode=21);break;case 26:if(ee===0)break e;F[H++]=S.length,ee--,S.mode=21;break;case 27:if(S.wrap){for(;X<32;){if(G===0)break e;G--,B|=C[D++]<<X,X+=8}if(N-=ee,x.total_out+=N,S.total+=N,N&&(x.adler=S.check=S.flags?y(S.check,F,N,H-N):v(S.check,F,N,H-N)),N=ee,(S.flags?B:M(B))!==S.check){x.msg="incorrect data check",S.mode=30;break}X=B=0}S.mode=28;case 28:if(S.wrap&&S.flags){for(;X<32;){if(G===0)break e;G--,B+=C[D++]<<X,X+=8}if(B!==(4294967295&S.total)){x.msg="incorrect length check",S.mode=30;break}X=B=0}S.mode=29;case 29:le=1;break e;case 30:le=-3;break e;case 31:return-4;default:return A}return x.next_out=H,x.avail_out=ee,x.next_in=D,x.avail_in=G,S.hold=B,S.bits=X,(S.wsize||N!==x.avail_out&&S.mode<30&&(S.mode<27||_!==4))&&w(x,x.output,x.next_out,N-x.avail_out)?(S.mode=31,-4):(I-=x.avail_in,N-=x.avail_out,x.total_in+=I,x.total_out+=N,S.total+=N,S.wrap&&N&&(x.adler=S.check=S.flags?y(S.check,F,N,x.next_out-N):v(S.check,F,N,x.next_out-N)),x.data_type=S.bits+(S.last?64:0)+(S.mode===12?128:0)+(S.mode===20||S.mode===15?256:0),(I==0&&N===0||_===4)&&le===0&&(le=-5),le)},p.inflateEnd=function(x){if(!x||!x.state)return A;var _=x.state;return _.window&&(_.window=null),x.state=null,0},p.inflateGetHeader=function(x,_){var S;return x&&x.state?(2&(S=x.state).wrap)==0?A:((S.head=_).done=!1,0):A},p.inflateSetDictionary=function(x,_){var S,C=_.length;return x&&x.state?(S=x.state).wrap!==0&&S.mode!==11?A:S.mode===11&&v(1,_,C,0)!==S.check?-3:w(x,_,C,C)?(S.mode=31,-4):(S.havedict=1,0):A},p.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(f,m,p){var g=f("../utils/common"),v=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],y=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],b=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],E=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];m.exports=function(A,M,L,k,P,U,$,V){var R,O,T,w,x,_,S,C,F,D=V.bits,H=0,G=0,ee=0,B=0,X=0,I=0,N=0,j=0,Q=0,W=0,Y=null,Z=0,se=new g.Buf16(16),re=new g.Buf16(16),K=null,ie=0;for(H=0;H<=15;H++)se[H]=0;for(G=0;G<k;G++)se[M[L+G]]++;for(X=D,B=15;1<=B&&se[B]===0;B--);if(B<X&&(X=B),B===0)return P[U++]=20971520,P[U++]=20971520,V.bits=1,0;for(ee=1;ee<B&&se[ee]===0;ee++);for(X<ee&&(X=ee),H=j=1;H<=15;H++)if(j<<=1,(j-=se[H])<0)return-1;if(0<j&&(A===0||B!==1))return-1;for(re[1]=0,H=1;H<15;H++)re[H+1]=re[H]+se[H];for(G=0;G<k;G++)M[L+G]!==0&&($[re[M[L+G]]++]=G);if(_=A===0?(Y=K=$,19):A===1?(Y=v,Z-=257,K=y,ie-=257,256):(Y=b,K=E,-1),H=ee,x=U,N=G=W=0,T=-1,w=(Q=1<<(I=X))-1,A===1&&852<Q||A===2&&592<Q)return 1;for(;;){for(S=H-N,F=$[G]<_?(C=0,$[G]):$[G]>_?(C=K[ie+$[G]],Y[Z+$[G]]):(C=96,0),R=1<<H-N,ee=O=1<<I;P[x+(W>>N)+(O-=R)]=S<<24|C<<16|F|0,O!==0;);for(R=1<<H-1;W&R;)R>>=1;if(R!==0?(W&=R-1,W+=R):W=0,G++,--se[H]==0){if(H===B)break;H=M[L+$[G]]}if(X<H&&(W&w)!==T){for(N===0&&(N=X),x+=ee,j=1<<(I=H-N);I+N<B&&!((j-=se[I+N])<=0);)I++,j<<=1;if(Q+=1<<I,A===1&&852<Q||A===2&&592<Q)return 1;P[T=W&w]=X<<24|I<<16|x-U|0}}return W!==0&&(P[x+W]=H-N<<24|64<<16|0),V.bits=X,0}},{"../utils/common":41}],51:[function(f,m,p){m.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(f,m,p){var g=f("../utils/common");function v(K){for(var ie=K.length;0<=--ie;)K[ie]=0}var y=256,b=286,E=30,A=15,M=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],L=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],k=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],P=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],U=new Array(576);v(U);var $=new Array(60);v($);var V=new Array(512);v(V);var R=new Array(256);v(R);var O=new Array(29);v(O);var T,w,x,_=new Array(E);function S(K,ie,ne,le,ae){this.static_tree=K,this.extra_bits=ie,this.extra_base=ne,this.elems=le,this.max_length=ae,this.has_stree=K&&K.length}function C(K,ie){this.dyn_tree=K,this.max_code=0,this.stat_desc=ie}function F(K){return K<256?V[K]:V[256+(K>>>7)]}function D(K,ie){K.pending_buf[K.pending++]=255&ie,K.pending_buf[K.pending++]=ie>>>8&255}function H(K,ie,ne){K.bi_valid>16-ne?(K.bi_buf|=ie<<K.bi_valid&65535,D(K,K.bi_buf),K.bi_buf=ie>>16-K.bi_valid,K.bi_valid+=ne-16):(K.bi_buf|=ie<<K.bi_valid&65535,K.bi_valid+=ne)}function G(K,ie,ne){H(K,ne[2*ie],ne[2*ie+1])}function ee(K,ie){for(var ne=0;ne|=1&K,K>>>=1,ne<<=1,0<--ie;);return ne>>>1}function B(K,ie,ne){var le,ae,fe=new Array(16),pe=0;for(le=1;le<=A;le++)fe[le]=pe=pe+ne[le-1]<<1;for(ae=0;ae<=ie;ae++){var ye=K[2*ae+1];ye!==0&&(K[2*ae]=ee(fe[ye]++,ye))}}function X(K){var ie;for(ie=0;ie<b;ie++)K.dyn_ltree[2*ie]=0;for(ie=0;ie<E;ie++)K.dyn_dtree[2*ie]=0;for(ie=0;ie<19;ie++)K.bl_tree[2*ie]=0;K.dyn_ltree[512]=1,K.opt_len=K.static_len=0,K.last_lit=K.matches=0}function I(K){8<K.bi_valid?D(K,K.bi_buf):0<K.bi_valid&&(K.pending_buf[K.pending++]=K.bi_buf),K.bi_buf=0,K.bi_valid=0}function N(K,ie,ne,le){var ae=2*ie,fe=2*ne;return K[ae]<K[fe]||K[ae]===K[fe]&&le[ie]<=le[ne]}function j(K,ie,ne){for(var le=K.heap[ne],ae=ne<<1;ae<=K.heap_len&&(ae<K.heap_len&&N(ie,K.heap[ae+1],K.heap[ae],K.depth)&&ae++,!N(ie,le,K.heap[ae],K.depth));)K.heap[ne]=K.heap[ae],ne=ae,ae<<=1;K.heap[ne]=le}function Q(K,ie,ne){var le,ae,fe,pe,ye=0;if(K.last_lit!==0)for(;le=K.pending_buf[K.d_buf+2*ye]<<8|K.pending_buf[K.d_buf+2*ye+1],ae=K.pending_buf[K.l_buf+ye],ye++,le===0?G(K,ae,ie):(G(K,(fe=R[ae])+y+1,ie),(pe=M[fe])!==0&&H(K,ae-=O[fe],pe),G(K,fe=F(--le),ne),(pe=L[fe])!==0&&H(K,le-=_[fe],pe)),ye<K.last_lit;);G(K,256,ie)}function W(K,ie){var ne,le,ae,fe=ie.dyn_tree,pe=ie.stat_desc.static_tree,ye=ie.stat_desc.has_stree,xe=ie.stat_desc.elems,Ne=-1;for(K.heap_len=0,K.heap_max=573,ne=0;ne<xe;ne++)fe[2*ne]!==0?(K.heap[++K.heap_len]=Ne=ne,K.depth[ne]=0):fe[2*ne+1]=0;for(;K.heap_len<2;)fe[2*(ae=K.heap[++K.heap_len]=Ne<2?++Ne:0)]=1,K.depth[ae]=0,K.opt_len--,ye&&(K.static_len-=pe[2*ae+1]);for(ie.max_code=Ne,ne=K.heap_len>>1;1<=ne;ne--)j(K,fe,ne);for(ae=xe;ne=K.heap[1],K.heap[1]=K.heap[K.heap_len--],j(K,fe,1),le=K.heap[1],K.heap[--K.heap_max]=ne,K.heap[--K.heap_max]=le,fe[2*ae]=fe[2*ne]+fe[2*le],K.depth[ae]=(K.depth[ne]>=K.depth[le]?K.depth[ne]:K.depth[le])+1,fe[2*ne+1]=fe[2*le+1]=ae,K.heap[1]=ae++,j(K,fe,1),2<=K.heap_len;);K.heap[--K.heap_max]=K.heap[1],(function(Oe,Me){var qe,We,Ke,Je,Ve,Pe,Le=Me.dyn_tree,Ye=Me.max_code,Ze=Me.stat_desc.static_tree,Ft=Me.stat_desc.has_stree,ir=Me.stat_desc.extra_bits,ct=Me.stat_desc.extra_base,Jt=Me.stat_desc.max_length,Vt=0;for(Je=0;Je<=A;Je++)Oe.bl_count[Je]=0;for(Le[2*Oe.heap[Oe.heap_max]+1]=0,qe=Oe.heap_max+1;qe<573;qe++)Jt<(Je=Le[2*Le[2*(We=Oe.heap[qe])+1]+1]+1)&&(Je=Jt,Vt++),Le[2*We+1]=Je,Ye<We||(Oe.bl_count[Je]++,Ve=0,ct<=We&&(Ve=ir[We-ct]),Pe=Le[2*We],Oe.opt_len+=Pe*(Je+Ve),Ft&&(Oe.static_len+=Pe*(Ze[2*We+1]+Ve)));if(Vt!==0){do{for(Je=Jt-1;Oe.bl_count[Je]===0;)Je--;Oe.bl_count[Je]--,Oe.bl_count[Je+1]+=2,Oe.bl_count[Jt]--,Vt-=2}while(0<Vt);for(Je=Jt;Je!==0;Je--)for(We=Oe.bl_count[Je];We!==0;)Ye<(Ke=Oe.heap[--qe])||(Le[2*Ke+1]!==Je&&(Oe.opt_len+=(Je-Le[2*Ke+1])*Le[2*Ke],Le[2*Ke+1]=Je),We--)}})(K,ie),B(fe,Ne,K.bl_count)}function Y(K,ie,ne){var le,ae,fe=-1,pe=ie[1],ye=0,xe=7,Ne=4;for(pe===0&&(xe=138,Ne=3),ie[2*(ne+1)+1]=65535,le=0;le<=ne;le++)ae=pe,pe=ie[2*(le+1)+1],++ye<xe&&ae===pe||(ye<Ne?K.bl_tree[2*ae]+=ye:ae!==0?(ae!==fe&&K.bl_tree[2*ae]++,K.bl_tree[32]++):ye<=10?K.bl_tree[34]++:K.bl_tree[36]++,fe=ae,Ne=(ye=0)===pe?(xe=138,3):ae===pe?(xe=6,3):(xe=7,4))}function Z(K,ie,ne){var le,ae,fe=-1,pe=ie[1],ye=0,xe=7,Ne=4;for(pe===0&&(xe=138,Ne=3),le=0;le<=ne;le++)if(ae=pe,pe=ie[2*(le+1)+1],!(++ye<xe&&ae===pe)){if(ye<Ne)for(;G(K,ae,K.bl_tree),--ye!=0;);else ae!==0?(ae!==fe&&(G(K,ae,K.bl_tree),ye--),G(K,16,K.bl_tree),H(K,ye-3,2)):ye<=10?(G(K,17,K.bl_tree),H(K,ye-3,3)):(G(K,18,K.bl_tree),H(K,ye-11,7));fe=ae,Ne=(ye=0)===pe?(xe=138,3):ae===pe?(xe=6,3):(xe=7,4)}}v(_);var se=!1;function re(K,ie,ne,le){H(K,0+(le?1:0),3),(function(ae,fe,pe,ye){I(ae),D(ae,pe),D(ae,~pe),g.arraySet(ae.pending_buf,ae.window,fe,pe,ae.pending),ae.pending+=pe})(K,ie,ne)}p._tr_init=function(K){se||((function(){var ie,ne,le,ae,fe,pe=new Array(16);for(ae=le=0;ae<28;ae++)for(O[ae]=le,ie=0;ie<1<<M[ae];ie++)R[le++]=ae;for(R[le-1]=ae,ae=fe=0;ae<16;ae++)for(_[ae]=fe,ie=0;ie<1<<L[ae];ie++)V[fe++]=ae;for(fe>>=7;ae<E;ae++)for(_[ae]=fe<<7,ie=0;ie<1<<L[ae]-7;ie++)V[256+fe++]=ae;for(ne=0;ne<=A;ne++)pe[ne]=0;for(ie=0;ie<=143;)U[2*ie+1]=8,ie++,pe[8]++;for(;ie<=255;)U[2*ie+1]=9,ie++,pe[9]++;for(;ie<=279;)U[2*ie+1]=7,ie++,pe[7]++;for(;ie<=287;)U[2*ie+1]=8,ie++,pe[8]++;for(B(U,287,pe),ie=0;ie<E;ie++)$[2*ie+1]=5,$[2*ie]=ee(ie,5);T=new S(U,M,257,b,A),w=new S($,L,0,E,A),x=new S(new Array(0),k,0,19,7)})(),se=!0),K.l_desc=new C(K.dyn_ltree,T),K.d_desc=new C(K.dyn_dtree,w),K.bl_desc=new C(K.bl_tree,x),K.bi_buf=0,K.bi_valid=0,X(K)},p._tr_stored_block=re,p._tr_flush_block=function(K,ie,ne,le){var ae,fe,pe=0;0<K.level?(K.strm.data_type===2&&(K.strm.data_type=(function(ye){var xe,Ne=4093624447;for(xe=0;xe<=31;xe++,Ne>>>=1)if(1&Ne&&ye.dyn_ltree[2*xe]!==0)return 0;if(ye.dyn_ltree[18]!==0||ye.dyn_ltree[20]!==0||ye.dyn_ltree[26]!==0)return 1;for(xe=32;xe<y;xe++)if(ye.dyn_ltree[2*xe]!==0)return 1;return 0})(K)),W(K,K.l_desc),W(K,K.d_desc),pe=(function(ye){var xe;for(Y(ye,ye.dyn_ltree,ye.l_desc.max_code),Y(ye,ye.dyn_dtree,ye.d_desc.max_code),W(ye,ye.bl_desc),xe=18;3<=xe&&ye.bl_tree[2*P[xe]+1]===0;xe--);return ye.opt_len+=3*(xe+1)+5+5+4,xe})(K),ae=K.opt_len+3+7>>>3,(fe=K.static_len+3+7>>>3)<=ae&&(ae=fe)):ae=fe=ne+5,ne+4<=ae&&ie!==-1?re(K,ie,ne,le):K.strategy===4||fe===ae?(H(K,2+(le?1:0),3),Q(K,U,$)):(H(K,4+(le?1:0),3),(function(ye,xe,Ne,Oe){var Me;for(H(ye,xe-257,5),H(ye,Ne-1,5),H(ye,Oe-4,4),Me=0;Me<Oe;Me++)H(ye,ye.bl_tree[2*P[Me]+1],3);Z(ye,ye.dyn_ltree,xe-1),Z(ye,ye.dyn_dtree,Ne-1)})(K,K.l_desc.max_code+1,K.d_desc.max_code+1,pe+1),Q(K,K.dyn_ltree,K.dyn_dtree)),X(K),le&&I(K)},p._tr_tally=function(K,ie,ne){return K.pending_buf[K.d_buf+2*K.last_lit]=ie>>>8&255,K.pending_buf[K.d_buf+2*K.last_lit+1]=255&ie,K.pending_buf[K.l_buf+K.last_lit]=255&ne,K.last_lit++,ie===0?K.dyn_ltree[2*ne]++:(K.matches++,ie--,K.dyn_ltree[2*(R[ne]+y+1)]++,K.dyn_dtree[2*F(ie)]++),K.last_lit===K.lit_bufsize-1},p._tr_align=function(K){H(K,2,3),G(K,256,U),(function(ie){ie.bi_valid===16?(D(ie,ie.bi_buf),ie.bi_buf=0,ie.bi_valid=0):8<=ie.bi_valid&&(ie.pending_buf[ie.pending++]=255&ie.bi_buf,ie.bi_buf>>=8,ie.bi_valid-=8)})(K)}},{"../utils/common":41}],53:[function(f,m,p){m.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(f,m,p){(function(g){(function(v,y){if(!v.setImmediate){var b,E,A,M,L=1,k={},P=!1,U=v.document,$=Object.getPrototypeOf&&Object.getPrototypeOf(v);$=$&&$.setTimeout?$:v,b={}.toString.call(v.process)==="[object process]"?function(T){s.nextTick((function(){R(T)}))}:(function(){if(v.postMessage&&!v.importScripts){var T=!0,w=v.onmessage;return v.onmessage=function(){T=!1},v.postMessage("","*"),v.onmessage=w,T}})()?(M="setImmediate$"+Math.random()+"$",v.addEventListener?v.addEventListener("message",O,!1):v.attachEvent("onmessage",O),function(T){v.postMessage(M+T,"*")}):v.MessageChannel?((A=new MessageChannel).port1.onmessage=function(T){R(T.data)},function(T){A.port2.postMessage(T)}):U&&"onreadystatechange"in U.createElement("script")?(E=U.documentElement,function(T){var w=U.createElement("script");w.onreadystatechange=function(){R(T),w.onreadystatechange=null,E.removeChild(w),w=null},E.appendChild(w)}):function(T){setTimeout(R,0,T)},$.setImmediate=function(T){typeof T!="function"&&(T=new Function(""+T));for(var w=new Array(arguments.length-1),x=0;x<w.length;x++)w[x]=arguments[x+1];var _={callback:T,args:w};return k[L]=_,b(L),L++},$.clearImmediate=V}function V(T){delete k[T]}function R(T){if(P)setTimeout(R,0,T);else{var w=k[T];if(w){P=!0;try{(function(x){var _=x.callback,S=x.args;switch(S.length){case 0:_();break;case 1:_(S[0]);break;case 2:_(S[0],S[1]);break;case 3:_(S[0],S[1],S[2]);break;default:_.apply(void 0,S)}})(w)}finally{V(T),P=!1}}}}function O(T){T.source===v&&typeof T.data=="string"&&T.data.indexOf(M)===0&&R(+T.data.slice(M.length))}})(typeof self>"u"?g===void 0?this:g:self)}).call(this,o!==void 0?o:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)}))}).call(this)}).call(this,t("_process"),typeof Wt<"u"?Wt:typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],t("timers").setImmediate)},{_process:467,buffer:220,timers:523}],442:[function(t,n,i){(function(s){(function(){var o=/[\\^$.*+?()[\]{}|]/g,a=RegExp(o.source),l=typeof s=="object"&&s&&s.Object===Object&&s,u=typeof self=="object"&&self&&self.Object===Object&&self,c=l||u||Function("return this")(),d=Object.prototype.toString,h=c.Symbol,f=h?h.prototype:void 0,m=f?f.toString:void 0;function p(g){if(typeof g=="string")return g;if((function(y){return typeof y=="symbol"||(function(b){return!!b&&typeof b=="object"})(y)&&d.call(y)=="[object Symbol]"})(g))return m?m.call(g):"";var v=g+"";return v=="0"&&1/g==-1/0?"-0":v}n.exports=function(g){var v;return(g=(v=g)==null?"":p(v))&&a.test(g)?g.replace(o,"\\$&"):g}}).call(this)}).call(this,typeof Wt<"u"?Wt:typeof self<"u"?self:typeof window<"u"?window:{})},{}],443:[function(t,n,i){(function(s){(function(){var o="[object Arguments]",a="[object Map]",l="[object Object]",u="[object Set]",c=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,d=/^\w*$/,h=/^\./,f=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,m=/\\(\\)?/g,p=/^\[object .+?Constructor\]$/,g=/^(?:0|[1-9]\d*)$/,v={};v["[object Float32Array]"]=v["[object Float64Array]"]=v["[object Int8Array]"]=v["[object Int16Array]"]=v["[object Int32Array]"]=v["[object Uint8Array]"]=v["[object Uint8ClampedArray]"]=v["[object Uint16Array]"]=v["[object Uint32Array]"]=!0,v[o]=v["[object Array]"]=v["[object ArrayBuffer]"]=v["[object Boolean]"]=v["[object DataView]"]=v["[object Date]"]=v["[object Error]"]=v["[object Function]"]=v[a]=v["[object Number]"]=v[l]=v["[object RegExp]"]=v[u]=v["[object String]"]=v["[object WeakMap]"]=!1;var y=typeof s=="object"&&s&&s.Object===Object&&s,b=typeof self=="object"&&self&&self.Object===Object&&self,E=y||b||Function("return this")(),A=typeof i=="object"&&i&&!i.nodeType&&i,M=A&&typeof n=="object"&&n&&!n.nodeType&&n,L=M&&M.exports===A&&y.process,k=(function(){try{return L&&L.binding("util")}catch{}})(),P=k&&k.isTypedArray;function U(ce,be,Ae,Ie){for(var st=-1,De=ce?ce.length:0;++st<De;){var Ue=ce[st];be(Ie,Ue,Ae(Ue),ce)}return Ie}function $(ce,be){for(var Ae=-1,Ie=ce?ce.length:0;++Ae<Ie;)if(be(ce[Ae],Ae,ce))return!0;return!1}function V(ce){var be=!1;if(ce!=null&&typeof ce.toString!="function")try{be=!!(ce+"")}catch{}return be}function R(ce){var be=-1,Ae=Array(ce.size);return ce.forEach((function(Ie,st){Ae[++be]=[st,Ie]})),Ae}function O(ce){var be=-1,Ae=Array(ce.size);return ce.forEach((function(Ie){Ae[++be]=Ie})),Ae}var T,w,x,_=Array.prototype,S=Function.prototype,C=Object.prototype,F=E["__core-js_shared__"],D=(T=/[^.]+$/.exec(F&&F.keys&&F.keys.IE_PROTO||""))?"Symbol(src)_1."+T:"",H=S.toString,G=C.hasOwnProperty,ee=C.toString,B=RegExp("^"+H.call(G).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),X=E.Symbol,I=E.Uint8Array,N=C.propertyIsEnumerable,j=_.splice,Q=(w=Object.keys,x=Object,function(ce){return w(x(ce))}),W=gt(E,"DataView"),Y=gt(E,"Map"),Z=gt(E,"Promise"),se=gt(E,"Set"),re=gt(E,"WeakMap"),K=gt(Object,"create"),ie=ve(W),ne=ve(Y),le=ve(Z),ae=ve(se),fe=ve(re),pe=X?X.prototype:void 0,ye=pe?pe.valueOf:void 0,xe=pe?pe.toString:void 0;function Ne(ce){var be=-1,Ae=ce?ce.length:0;for(this.clear();++be<Ae;){var Ie=ce[be];this.set(Ie[0],Ie[1])}}function Oe(ce){var be=-1,Ae=ce?ce.length:0;for(this.clear();++be<Ae;){var Ie=ce[be];this.set(Ie[0],Ie[1])}}function Me(ce){var be=-1,Ae=ce?ce.length:0;for(this.clear();++be<Ae;){var Ie=ce[be];this.set(Ie[0],Ie[1])}}function qe(ce){var be=-1,Ae=ce?ce.length:0;for(this.__data__=new Me;++be<Ae;)this.add(ce[be])}function We(ce){this.__data__=new Oe(ce)}function Ke(ce,be){var Ae=ft(ce)||vt(ce)?(function(Ue,Ht){for(var Mt=-1,Dt=Array(Ue);++Mt<Ue;)Dt[Mt]=Ht(Mt);return Dt})(ce.length,String):[],Ie=Ae.length,st=!!Ie;for(var De in ce)!G.call(ce,De)||st&&(De=="length"||fr(De,Ie))||Ae.push(De);return Ae}function Je(ce,be){for(var Ae=ce.length;Ae--;)if(je(ce[Ae][0],be))return Ae;return-1}function Ve(ce,be,Ae,Ie){return Le(ce,(function(st,De,Ue){be(Ie,st,Ae(st),Ue)})),Ie}Ne.prototype.clear=function(){this.__data__=K?K(null):{}},Ne.prototype.delete=function(ce){return this.has(ce)&&delete this.__data__[ce]},Ne.prototype.get=function(ce){var be=this.__data__;if(K){var Ae=be[ce];return Ae==="__lodash_hash_undefined__"?void 0:Ae}return G.call(be,ce)?be[ce]:void 0},Ne.prototype.has=function(ce){var be=this.__data__;return K?be[ce]!==void 0:G.call(be,ce)},Ne.prototype.set=function(ce,be){return this.__data__[ce]=K&&be===void 0?"__lodash_hash_undefined__":be,this},Oe.prototype.clear=function(){this.__data__=[]},Oe.prototype.delete=function(ce){var be=this.__data__,Ae=Je(be,ce);return!(Ae<0)&&(Ae==be.length-1?be.pop():j.call(be,Ae,1),!0)},Oe.prototype.get=function(ce){var be=this.__data__,Ae=Je(be,ce);return Ae<0?void 0:be[Ae][1]},Oe.prototype.has=function(ce){return Je(this.__data__,ce)>-1},Oe.prototype.set=function(ce,be){var Ae=this.__data__,Ie=Je(Ae,ce);return Ie<0?Ae.push([ce,be]):Ae[Ie][1]=be,this},Me.prototype.clear=function(){this.__data__={hash:new Ne,map:new(Y||Oe),string:new Ne}},Me.prototype.delete=function(ce){return er(this,ce).delete(ce)},Me.prototype.get=function(ce){return er(this,ce).get(ce)},Me.prototype.has=function(ce){return er(this,ce).has(ce)},Me.prototype.set=function(ce,be){return er(this,ce).set(ce,be),this},qe.prototype.add=qe.prototype.push=function(ce){return this.__data__.set(ce,"__lodash_hash_undefined__"),this},qe.prototype.has=function(ce){return this.__data__.has(ce)},We.prototype.clear=function(){this.__data__=new Oe},We.prototype.delete=function(ce){return this.__data__.delete(ce)},We.prototype.get=function(ce){return this.__data__.get(ce)},We.prototype.has=function(ce){return this.__data__.has(ce)},We.prototype.set=function(ce,be){var Ae=this.__data__;if(Ae instanceof Oe){var Ie=Ae.__data__;if(!Y||Ie.length<199)return Ie.push([ce,be]),this;Ae=this.__data__=new Me(Ie)}return Ae.set(ce,be),this};var Pe,Le=(Pe=function(ce,be){return ce&&Ye(ce,be,nn)},function(ce,be){if(ce==null)return ce;if(!at(ce))return Pe(ce,be);for(var Ae=ce.length,Ie=-1,st=Object(ce);++Ie<Ae&&be(st[Ie],Ie,st)!==!1;);return ce}),Ye=(function(ce){return function(be,Ae,Ie){for(var st=-1,De=Object(be),Ue=Ie(be),Ht=Ue.length;Ht--;){var Mt=Ue[++st];if(Ae(De[Mt],Mt,De)===!1)break}return be}})();function Ze(ce,be){for(var Ae=0,Ie=(be=yt(be,ce)?[be]:_t(be)).length;ce!=null&&Ae<Ie;)ce=ce[me(be[Ae++])];return Ae&&Ae==Ie?ce:void 0}function Ft(ce,be){return ce!=null&&be in Object(ce)}function ir(ce,be,Ae,Ie,st){return ce===be||(ce==null||be==null||!Lt(ce)&&!Br(be)?ce!=ce&&be!=be:(function(De,Ue,Ht,Mt,Dt,pt){var lr=ft(De),ur=ft(Ue),mr="[object Array]",Ir="[object Array]";lr||(mr=(mr=Yt(De))==o?l:mr),ur||(Ir=(Ir=Yt(Ue))==o?l:Ir);var hn=mr==l&&!V(De),Gn=Ir==l&&!V(Ue),Yi=mr==Ir;if(Yi&&!hn)return pt||(pt=new We),lr||rn(De)?yr(De,Ue,Ht,Mt,Dt,pt):(function(cr,Kt,jo,Ta,ph,mi,to){switch(jo){case"[object DataView]":if(cr.byteLength!=Kt.byteLength||cr.byteOffset!=Kt.byteOffset)return!1;cr=cr.buffer,Kt=Kt.buffer;case"[object ArrayBuffer]":return!(cr.byteLength!=Kt.byteLength||!Ta(new I(cr),new I(Kt)));case"[object Boolean]":case"[object Date]":case"[object Number]":return je(+cr,+Kt);case"[object Error]":return cr.name==Kt.name&&cr.message==Kt.message;case"[object RegExp]":case"[object String]":return cr==Kt+"";case a:var $o=R;case u:var Su=2&mi;if($o||($o=O),cr.size!=Kt.size&&!Su)return!1;var mh=to.get(cr);if(mh)return mh==Kt;mi|=1,to.set(cr,Kt);var bl=yr($o(cr),$o(Kt),Ta,ph,mi,to);return to.delete(cr),bl;case"[object Symbol]":if(ye)return ye.call(cr)==ye.call(Kt)}return!1})(De,Ue,mr,Ht,Mt,Dt,pt);if(!(2&Dt)){var Sa=hn&&G.call(De,"__wrapped__"),gl=Gn&&G.call(Ue,"__wrapped__");if(Sa||gl){var yl=Sa?De.value():De,vl=gl?Ue.value():Ue;return pt||(pt=new We),Ht(yl,vl,Mt,Dt,pt)}}return Yi?(pt||(pt=new We),(function(cr,Kt,jo,Ta,ph,mi){var to=2&ph,$o=nn(cr),Su=$o.length,mh=nn(Kt).length;if(Su!=mh&&!to)return!1;for(var bl=Su;bl--;){var zo=$o[bl];if(!(to?zo in Kt:G.call(Kt,zo)))return!1}var gb=mi.get(cr);if(gb&&mi.get(Kt))return gb==Kt;var gh=!0;mi.set(cr,Kt),mi.set(Kt,cr);for(var fm=to;++bl<Su;){zo=$o[bl];var yh=cr[zo],vh=Kt[zo];if(Ta)var yb=to?Ta(vh,yh,zo,Kt,cr,mi):Ta(yh,vh,zo,cr,Kt,mi);if(!(yb===void 0?yh===vh||jo(yh,vh,Ta,ph,mi):yb)){gh=!1;break}fm||(fm=zo=="constructor")}if(gh&&!fm){var bh=cr.constructor,wh=Kt.constructor;bh==wh||!("constructor"in cr)||!("constructor"in Kt)||typeof bh=="function"&&bh instanceof bh&&typeof wh=="function"&&wh instanceof wh||(gh=!1)}return mi.delete(cr),mi.delete(Kt),gh})(De,Ue,Ht,Mt,Dt,pt)):!1})(ce,be,ir,Ae,Ie,st))}function ct(ce){return!(!Lt(ce)||(function(be){return!!D&&D in be})(ce))&&(Et(ce)||V(ce)?B:p).test(ve(ce))}function Jt(ce){return typeof ce=="function"?ce:ce==null?Qn:typeof ce=="object"?ft(ce)?(function(Ie,st){return yt(Ie)&&rr(st)?pr(me(Ie),st):function(De){var Ue=(function(Ht,Mt,Dt){var pt=Ht==null?void 0:Ze(Ht,Mt);return pt===void 0?Dt:pt})(De,Ie);return Ue===void 0&&Ue===st?(function(Ht,Mt){return Ht!=null&&(function(Dt,pt,lr){pt=yt(pt,Dt)?[pt]:_t(pt);for(var ur,mr=-1,Ir=pt.length;++mr<Ir;){var hn=me(pt[mr]);if(!(ur=Dt!=null&&lr(Dt,hn)))break;Dt=Dt[hn]}return ur||!!(Ir=Dt?Dt.length:0)&&bt(Ir)&&fr(hn,Ir)&&(ft(Dt)||vt(Dt))})(Ht,Mt,Ft)})(De,Ie):ir(st,Ue,void 0,3)}})(ce[0],ce[1]):(function(Ie){var st=(function(De){for(var Ue=nn(De),Ht=Ue.length;Ht--;){var Mt=Ue[Ht],Dt=De[Mt];Ue[Ht]=[Mt,Dt,rr(Dt)]}return Ue})(Ie);return st.length==1&&st[0][2]?pr(st[0][0],st[0][1]):function(De){return De===Ie||(function(Ue,Ht,Mt,Dt){var pt=Mt.length,lr=pt;if(Ue==null)return!lr;for(Ue=Object(Ue);pt--;){var ur=Mt[pt];if(ur[2]?ur[1]!==Ue[ur[0]]:!(ur[0]in Ue))return!1}for(;++pt<lr;){var mr=(ur=Mt[pt])[0],Ir=Ue[mr],hn=ur[1];if(ur[2]){if(Ir===void 0&&!(mr in Ue))return!1}else{var Gn=new We,Yi;if(!(Yi===void 0?ir(hn,Ir,Dt,3,Gn):Yi))return!1}}return!0})(De,Ie,st)}})(ce):yt(be=ce)?(Ae=me(be),function(Ie){return Ie?.[Ae]}):(function(Ie){return function(st){return Ze(st,Ie)}})(be);var be,Ae}function Vt(ce){if(Ae=(be=ce)&&be.constructor,Ie=typeof Ae=="function"&&Ae.prototype||C,be!==Ie)return Q(ce);var be,Ae,Ie,st=[];for(var De in Object(ce))G.call(ce,De)&&De!="constructor"&&st.push(De);return st}function _t(ce){return ft(ce)?ce:Rt(ce)}function yr(ce,be,Ae,Ie,st,De){var Ue=2&st,Ht=ce.length,Mt=be.length;if(Ht!=Mt&&!(Ue&&Mt>Ht))return!1;var Dt=De.get(ce);if(Dt&&De.get(be))return Dt==be;var pt=-1,lr=!0,ur=1&st?new qe:void 0;for(De.set(ce,be),De.set(be,ce);++pt<Ht;){var mr=ce[pt],Ir=be[pt];if(Ie)var hn=Ue?Ie(Ir,mr,pt,be,ce,De):Ie(mr,Ir,pt,ce,be,De);if(hn!==void 0){if(hn)continue;lr=!1;break}if(ur){if(!$(be,(function(Gn,Yi){if(!ur.has(Yi)&&(mr===Gn||Ae(mr,Gn,Ie,st,De)))return ur.add(Yi)}))){lr=!1;break}}else if(mr!==Ir&&!Ae(mr,Ir,Ie,st,De)){lr=!1;break}}return De.delete(ce),De.delete(be),lr}function er(ce,be){var Ae,Ie,st=ce.__data__;return((Ie=typeof(Ae=be))=="string"||Ie=="number"||Ie=="symbol"||Ie=="boolean"?Ae!=="__proto__":Ae===null)?st[typeof be=="string"?"string":"hash"]:st.map}function gt(ce,be){var Ae=(function(Ie,st){return Ie?.[st]})(ce,be);return ct(Ae)?Ae:void 0}var Yt=function(ce){return ee.call(ce)};function fr(ce,be){return!!(be=be??9007199254740991)&&(typeof ce=="number"||g.test(ce))&&ce>-1&&ce%1==0&&ce<be}function yt(ce,be){if(ft(ce))return!1;var Ae=typeof ce;return!(Ae!="number"&&Ae!="symbol"&&Ae!="boolean"&&ce!=null&&!_r(ce))||d.test(ce)||!c.test(ce)||be!=null&&ce in Object(be)}function rr(ce){return ce==ce&&!Lt(ce)}function pr(ce,be){return function(Ae){return Ae!=null&&Ae[ce]===be&&(be!==void 0||ce in Object(Ae))}}(W&&Yt(new W(new ArrayBuffer(1)))!="[object DataView]"||Y&&Yt(new Y)!=a||Z&&Yt(Z.resolve())!="[object Promise]"||se&&Yt(new se)!=u||re&&Yt(new re)!="[object WeakMap]")&&(Yt=function(ce){var be=ee.call(ce),Ae=be==l?ce.constructor:void 0,Ie=Ae?ve(Ae):void 0;if(Ie)switch(Ie){case ie:return"[object DataView]";case ne:return a;case le:return"[object Promise]";case ae:return u;case fe:return"[object WeakMap]"}return be});var Rt=dt((function(ce){var be;ce=(be=ce)==null?"":(function(Ie){if(typeof Ie=="string")return Ie;if(_r(Ie))return xe?xe.call(Ie):"";var st=Ie+"";return st=="0"&&1/Ie==-1/0?"-0":st})(be);var Ae=[];return h.test(ce)&&Ae.push(""),ce.replace(f,(function(Ie,st,De,Ue){Ae.push(De?Ue.replace(m,"$1"):st||Ie)})),Ae}));function me(ce){if(typeof ce=="string"||_r(ce))return ce;var be=ce+"";return be=="0"&&1/ce==-1/0?"-0":be}function ve(ce){if(ce!=null){try{return H.call(ce)}catch{}try{return ce+""}catch{}}return""}var Se,Be=(Se=function(ce,be,Ae){G.call(ce,Ae)?ce[Ae].push(be):ce[Ae]=[be]},function(ce,be){var Ae=ft(ce)?U:Ve,Ie={};return Ae(ce,Se,Jt(be),Ie)});function dt(ce,be){if(typeof ce!="function"||be&&typeof be!="function")throw new TypeError("Expected a function");var Ae=function(){var Ie=arguments,st=be?be.apply(this,Ie):Ie[0],De=Ae.cache;if(De.has(st))return De.get(st);var Ue=ce.apply(this,Ie);return Ae.cache=De.set(st,Ue),Ue};return Ae.cache=new(dt.Cache||Me),Ae}function je(ce,be){return ce===be||ce!=ce&&be!=be}function vt(ce){return(function(be){return Br(be)&&at(be)})(ce)&&G.call(ce,"callee")&&(!N.call(ce,"callee")||ee.call(ce)==o)}dt.Cache=Me;var ft=Array.isArray;function at(ce){return ce!=null&&bt(ce.length)&&!Et(ce)}function Et(ce){var be=Lt(ce)?ee.call(ce):"";return be=="[object Function]"||be=="[object GeneratorFunction]"}function bt(ce){return typeof ce=="number"&&ce>-1&&ce%1==0&&ce<=9007199254740991}function Lt(ce){var be=typeof ce;return!!ce&&(be=="object"||be=="function")}function Br(ce){return!!ce&&typeof ce=="object"}function _r(ce){return typeof ce=="symbol"||Br(ce)&&ee.call(ce)=="[object Symbol]"}var rn=P?(function(ce){return function(be){return ce(be)}})(P):function(ce){return Br(ce)&&bt(ce.length)&&!!v[ee.call(ce)]};function nn(ce){return at(ce)?Ke(ce):Vt(ce)}function Qn(ce){return ce}n.exports=Be}).call(this)}).call(this,typeof Wt<"u"?Wt:typeof self<"u"?self:typeof window<"u"?window:{})},{}],444:[function(t,n,i){var s=Object.prototype.toString;n.exports=function(o){return o===!0||o===!1||(function(a){return!!a&&typeof a=="object"})(o)&&s.call(o)=="[object Boolean]"}},{}],445:[function(t,n,i){(function(s){(function(){var o="[object Arguments]",a="[object Map]",l="[object Object]",u="[object Set]",c=/^\[object .+?Constructor\]$/,d=/^(?:0|[1-9]\d*)$/,h={};h["[object Float32Array]"]=h["[object Float64Array]"]=h["[object Int8Array]"]=h["[object Int16Array]"]=h["[object Int32Array]"]=h["[object Uint8Array]"]=h["[object Uint8ClampedArray]"]=h["[object Uint16Array]"]=h["[object Uint32Array]"]=!0,h[o]=h["[object Array]"]=h["[object ArrayBuffer]"]=h["[object Boolean]"]=h["[object DataView]"]=h["[object Date]"]=h["[object Error]"]=h["[object Function]"]=h[a]=h["[object Number]"]=h[l]=h["[object RegExp]"]=h[u]=h["[object String]"]=h["[object WeakMap]"]=!1;var f=typeof s=="object"&&s&&s.Object===Object&&s,m=typeof self=="object"&&self&&self.Object===Object&&self,p=f||m||Function("return this")(),g=typeof i=="object"&&i&&!i.nodeType&&i,v=g&&typeof n=="object"&&n&&!n.nodeType&&n,y=v&&v.exports===g,b=y&&f.process,E=(function(){try{return b&&b.binding&&b.binding("util")}catch{}})(),A=E&&E.isTypedArray;function M(me,ve){for(var Se=-1,Be=me==null?0:me.length;++Se<Be;)if(ve(me[Se],Se,me))return!0;return!1}function L(me){var ve=-1,Se=Array(me.size);return me.forEach((function(Be,dt){Se[++ve]=[dt,Be]})),Se}function k(me){var ve=-1,Se=Array(me.size);return me.forEach((function(Be){Se[++ve]=Be})),Se}var P,U,$,V=Array.prototype,R=Function.prototype,O=Object.prototype,T=p["__core-js_shared__"],w=R.toString,x=O.hasOwnProperty,_=(P=/[^.]+$/.exec(T&&T.keys&&T.keys.IE_PROTO||""))?"Symbol(src)_1."+P:"",S=O.toString,C=RegExp("^"+w.call(x).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),F=y?p.Buffer:void 0,D=p.Symbol,H=p.Uint8Array,G=O.propertyIsEnumerable,ee=V.splice,B=D?D.toStringTag:void 0,X=Object.getOwnPropertySymbols,I=F?F.isBuffer:void 0,N=(U=Object.keys,$=Object,function(me){return U($(me))}),j=Ft(p,"DataView"),Q=Ft(p,"Map"),W=Ft(p,"Promise"),Y=Ft(p,"Set"),Z=Ft(p,"WeakMap"),se=Ft(Object,"create"),re=Vt(j),K=Vt(Q),ie=Vt(W),ne=Vt(Y),le=Vt(Z),ae=D?D.prototype:void 0,fe=ae?ae.valueOf:void 0;function pe(me){var ve=-1,Se=me==null?0:me.length;for(this.clear();++ve<Se;){var Be=me[ve];this.set(Be[0],Be[1])}}function ye(me){var ve=-1,Se=me==null?0:me.length;for(this.clear();++ve<Se;){var Be=me[ve];this.set(Be[0],Be[1])}}function xe(me){var ve=-1,Se=me==null?0:me.length;for(this.clear();++ve<Se;){var Be=me[ve];this.set(Be[0],Be[1])}}function Ne(me){var ve=-1,Se=me==null?0:me.length;for(this.__data__=new xe;++ve<Se;)this.add(me[ve])}function Oe(me){var ve=this.__data__=new ye(me);this.size=ve.size}function Me(me,ve){var Se=er(me),Be=!Se&&yr(me),dt=!Se&&!Be&&gt(me),je=!Se&&!Be&&!dt&&pr(me),vt=Se||Be||dt||je,ft=vt?(function(bt,Lt){for(var Br=-1,_r=Array(bt);++Br<bt;)_r[Br]=Lt(Br);return _r})(me.length,String):[],at=ft.length;for(var Et in me)!x.call(me,Et)||vt&&(Et=="length"||dt&&(Et=="offset"||Et=="parent")||je&&(Et=="buffer"||Et=="byteLength"||Et=="byteOffset")||Jt(Et,at))||ft.push(Et);return ft}function qe(me,ve){for(var Se=me.length;Se--;)if(_t(me[Se][0],ve))return Se;return-1}function We(me){return me==null?me===void 0?"[object Undefined]":"[object Null]":B&&B in Object(me)?(function(ve){var Se=x.call(ve,B),Be=ve[B];try{ve[B]=void 0;var dt=!0}catch{}var je=S.call(ve);return dt&&(Se?ve[B]=Be:delete ve[B]),je})(me):(function(ve){return S.call(ve)})(me)}function Ke(me){return rr(me)&&We(me)==o}function Je(me,ve,Se,Be,dt){return me===ve||(me==null||ve==null||!rr(me)&&!rr(ve)?me!=me&&ve!=ve:(function(je,vt,ft,at,Et,bt){var Lt=er(je),Br=er(vt),_r=Lt?"[object Array]":ct(je),rn=Br?"[object Array]":ct(vt),nn=(_r=_r==o?l:_r)==l,Qn=(rn=rn==o?l:rn)==l,ce=_r==rn;if(ce&&gt(je)){if(!gt(vt))return!1;Lt=!0,nn=!1}if(ce&&!nn)return bt||(bt=new Oe),Lt||pr(je)?Le(je,vt,ft,at,Et,bt):(function(De,Ue,Ht,Mt,Dt,pt,lr){switch(Ht){case"[object DataView]":if(De.byteLength!=Ue.byteLength||De.byteOffset!=Ue.byteOffset)return!1;De=De.buffer,Ue=Ue.buffer;case"[object ArrayBuffer]":return!(De.byteLength!=Ue.byteLength||!pt(new H(De),new H(Ue)));case"[object Boolean]":case"[object Date]":case"[object Number]":return _t(+De,+Ue);case"[object Error]":return De.name==Ue.name&&De.message==Ue.message;case"[object RegExp]":case"[object String]":return De==Ue+"";case a:var ur=L;case u:var mr=1&Mt;if(ur||(ur=k),De.size!=Ue.size&&!mr)return!1;var Ir=lr.get(De);if(Ir)return Ir==Ue;Mt|=2,lr.set(De,Ue);var hn=Le(ur(De),ur(Ue),Mt,Dt,pt,lr);return lr.delete(De),hn;case"[object Symbol]":if(fe)return fe.call(De)==fe.call(Ue)}return!1})(je,vt,_r,ft,at,Et,bt);if(!(1&ft)){var be=nn&&x.call(je,"__wrapped__"),Ae=Qn&&x.call(vt,"__wrapped__");if(be||Ae){var Ie=be?je.value():je,st=Ae?vt.value():vt;return bt||(bt=new Oe),Et(Ie,st,ft,at,bt)}}return ce?(bt||(bt=new Oe),(function(De,Ue,Ht,Mt,Dt,pt){var lr=1&Ht,ur=Ye(De),mr=ur.length,Ir=Ye(Ue).length;if(mr!=Ir&&!lr)return!1;for(var hn=mr;hn--;){var Gn=ur[hn];if(!(lr?Gn in Ue:x.call(Ue,Gn)))return!1}var Yi=pt.get(De);if(Yi&&pt.get(Ue))return Yi==Ue;var Sa=!0;pt.set(De,Ue),pt.set(Ue,De);for(var gl=lr;++hn<mr;){Gn=ur[hn];var yl=De[Gn],vl=Ue[Gn];if(Mt)var cr=lr?Mt(vl,yl,Gn,Ue,De,pt):Mt(yl,vl,Gn,De,Ue,pt);if(!(cr===void 0?yl===vl||Dt(yl,vl,Ht,Mt,pt):cr)){Sa=!1;break}gl||(gl=Gn=="constructor")}if(Sa&&!gl){var Kt=De.constructor,jo=Ue.constructor;Kt==jo||!("constructor"in De)||!("constructor"in Ue)||typeof Kt=="function"&&Kt instanceof Kt&&typeof jo=="function"&&jo instanceof jo||(Sa=!1)}return pt.delete(De),pt.delete(Ue),Sa})(je,vt,ft,at,Et,bt)):!1})(me,ve,Se,Be,Je,dt))}function Ve(me){return!(!yt(me)||(function(ve){return!!_&&_ in ve})(me))&&(Yt(me)?C:c).test(Vt(me))}function Pe(me){if(Se=(ve=me)&&ve.constructor,Be=typeof Se=="function"&&Se.prototype||O,ve!==Be)return N(me);var ve,Se,Be,dt=[];for(var je in Object(me))x.call(me,je)&&je!="constructor"&&dt.push(je);return dt}function Le(me,ve,Se,Be,dt,je){var vt=1&Se,ft=me.length,at=ve.length;if(ft!=at&&!(vt&&at>ft))return!1;var Et=je.get(me);if(Et&&je.get(ve))return Et==ve;var bt=-1,Lt=!0,Br=2&Se?new Ne:void 0;for(je.set(me,ve),je.set(ve,me);++bt<ft;){var _r=me[bt],rn=ve[bt];if(Be)var nn=vt?Be(rn,_r,bt,ve,me,je):Be(_r,rn,bt,me,ve,je);if(nn!==void 0){if(nn)continue;Lt=!1;break}if(Br){if(!M(ve,(function(Qn,ce){if(be=ce,!Br.has(be)&&(_r===Qn||dt(_r,Qn,Se,Be,je)))return Br.push(ce);var be}))){Lt=!1;break}}else if(_r!==rn&&!dt(_r,rn,Se,Be,je)){Lt=!1;break}}return je.delete(me),je.delete(ve),Lt}function Ye(me){return(function(ve,Se,Be){var dt=Se(ve);return er(ve)?dt:(function(je,vt){for(var ft=-1,at=vt.length,Et=je.length;++ft<at;)je[Et+ft]=vt[ft];return je})(dt,Be(ve))})(me,Rt,ir)}function Ze(me,ve){var Se,Be,dt=me.__data__;return((Be=typeof(Se=ve))=="string"||Be=="number"||Be=="symbol"||Be=="boolean"?Se!=="__proto__":Se===null)?dt[typeof ve=="string"?"string":"hash"]:dt.map}function Ft(me,ve){var Se=(function(Be,dt){return Be?.[dt]})(me,ve);return Ve(Se)?Se:void 0}pe.prototype.clear=function(){this.__data__=se?se(null):{},this.size=0},pe.prototype.delete=function(me){var ve=this.has(me)&&delete this.__data__[me];return this.size-=ve?1:0,ve},pe.prototype.get=function(me){var ve=this.__data__;if(se){var Se=ve[me];return Se==="__lodash_hash_undefined__"?void 0:Se}return x.call(ve,me)?ve[me]:void 0},pe.prototype.has=function(me){var ve=this.__data__;return se?ve[me]!==void 0:x.call(ve,me)},pe.prototype.set=function(me,ve){var Se=this.__data__;return this.size+=this.has(me)?0:1,Se[me]=se&&ve===void 0?"__lodash_hash_undefined__":ve,this},ye.prototype.clear=function(){this.__data__=[],this.size=0},ye.prototype.delete=function(me){var ve=this.__data__,Se=qe(ve,me);return!(Se<0)&&(Se==ve.length-1?ve.pop():ee.call(ve,Se,1),--this.size,!0)},ye.prototype.get=function(me){var ve=this.__data__,Se=qe(ve,me);return Se<0?void 0:ve[Se][1]},ye.prototype.has=function(me){return qe(this.__data__,me)>-1},ye.prototype.set=function(me,ve){var Se=this.__data__,Be=qe(Se,me);return Be<0?(++this.size,Se.push([me,ve])):Se[Be][1]=ve,this},xe.prototype.clear=function(){this.size=0,this.__data__={hash:new pe,map:new(Q||ye),string:new pe}},xe.prototype.delete=function(me){var ve=Ze(this,me).delete(me);return this.size-=ve?1:0,ve},xe.prototype.get=function(me){return Ze(this,me).get(me)},xe.prototype.has=function(me){return Ze(this,me).has(me)},xe.prototype.set=function(me,ve){var Se=Ze(this,me),Be=Se.size;return Se.set(me,ve),this.size+=Se.size==Be?0:1,this},Ne.prototype.add=Ne.prototype.push=function(me){return this.__data__.set(me,"__lodash_hash_undefined__"),this},Ne.prototype.has=function(me){return this.__data__.has(me)},Oe.prototype.clear=function(){this.__data__=new ye,this.size=0},Oe.prototype.delete=function(me){var ve=this.__data__,Se=ve.delete(me);return this.size=ve.size,Se},Oe.prototype.get=function(me){return this.__data__.get(me)},Oe.prototype.has=function(me){return this.__data__.has(me)},Oe.prototype.set=function(me,ve){var Se=this.__data__;if(Se instanceof ye){var Be=Se.__data__;if(!Q||Be.length<199)return Be.push([me,ve]),this.size=++Se.size,this;Se=this.__data__=new xe(Be)}return Se.set(me,ve),this.size=Se.size,this};var ir=X?function(me){return me==null?[]:(me=Object(me),(function(ve,Se){for(var Be=-1,dt=ve==null?0:ve.length,je=0,vt=[];++Be<dt;){var ft=ve[Be];Se(ft,Be,ve)&&(vt[je++]=ft)}return vt})(X(me),(function(ve){return G.call(me,ve)})))}:function(){return[]},ct=We;function Jt(me,ve){return!!(ve=ve??9007199254740991)&&(typeof me=="number"||d.test(me))&&me>-1&&me%1==0&&me<ve}function Vt(me){if(me!=null){try{return w.call(me)}catch{}try{return me+""}catch{}}return""}function _t(me,ve){return me===ve||me!=me&&ve!=ve}(j&&ct(new j(new ArrayBuffer(1)))!="[object DataView]"||Q&&ct(new Q)!=a||W&&ct(W.resolve())!="[object Promise]"||Y&&ct(new Y)!=u||Z&&ct(new Z)!="[object WeakMap]")&&(ct=function(me){var ve=We(me),Se=ve==l?me.constructor:void 0,Be=Se?Vt(Se):"";if(Be)switch(Be){case re:return"[object DataView]";case K:return a;case ie:return"[object Promise]";case ne:return u;case le:return"[object WeakMap]"}return ve});var yr=Ke((function(){return arguments})())?Ke:function(me){return rr(me)&&x.call(me,"callee")&&!G.call(me,"callee")},er=Array.isArray,gt=I||function(){return!1};function Yt(me){if(!yt(me))return!1;var ve=We(me);return ve=="[object Function]"||ve=="[object GeneratorFunction]"||ve=="[object AsyncFunction]"||ve=="[object Proxy]"}function fr(me){return typeof me=="number"&&me>-1&&me%1==0&&me<=9007199254740991}function yt(me){var ve=typeof me;return me!=null&&(ve=="object"||ve=="function")}function rr(me){return me!=null&&typeof me=="object"}var pr=A?(function(me){return function(ve){return me(ve)}})(A):function(me){return rr(me)&&fr(me.length)&&!!h[We(me)]};function Rt(me){return(ve=me)!=null&&fr(ve.length)&&!Yt(ve)?Me(me):Pe(me);var ve}n.exports=function(me,ve){return Je(me,ve)}}).call(this)}).call(this,typeof Wt<"u"?Wt:typeof self<"u"?self:typeof window<"u"?window:{})},{}],446:[function(t,n,i){(function(s){(function(){var o=typeof s=="object"&&s&&s.Object===Object&&s,a=typeof self=="object"&&self&&self.Object===Object&&self,l=o||a||Function("return this")(),u=Object.prototype,c=u.hasOwnProperty,d=u.toString,h=l.Symbol,f=h?h.toStringTag:void 0;function m(p){return p==null?p===void 0?"[object Undefined]":"[object Null]":f&&f in Object(p)?(function(g){var v=c.call(g,f),y=g[f];try{g[f]=void 0;var b=!0}catch{}var E=d.call(g);return b&&(v?g[f]=y:delete g[f]),E})(p):(function(g){return d.call(g)})(p)}n.exports=function(p){if(!(function(v){var y=typeof v;return v!=null&&(y=="object"||y=="function")})(p))return!1;var g=m(p);return g=="[object Function]"||g=="[object GeneratorFunction]"||g=="[object AsyncFunction]"||g=="[object Proxy]"}}).call(this)}).call(this,typeof Wt<"u"?Wt:typeof self<"u"?self:typeof window<"u"?window:{})},{}],447:[function(t,n,i){n.exports=function(s){return s==null}},{}],448:[function(t,n,i){n.exports=function(s){return s===void 0}},{}],449:[function(t,n,i){(function(s){(function(){var o=/^\[object .+?Constructor\]$/,a=typeof s=="object"&&s&&s.Object===Object&&s,l=typeof self=="object"&&self&&self.Object===Object&&self,u=a||l||Function("return this")();function c(D,H){return!!(D&&D.length)&&(function(G,ee,B){if(ee!=ee)return(function(N,j,Q,W){for(var Y=N.length,Z=Q+-1;++Z<Y;)if(j(N[Z],Z,N))return Z;return-1})(G,d,B);for(var X=B-1,I=G.length;++X<I;)if(G[X]===ee)return X;return-1})(D,H,0)>-1}function d(D){return D!=D}function h(D,H){return D.has(H)}function f(D){var H=-1,G=Array(D.size);return D.forEach((function(ee){G[++H]=ee})),G}var m,p=Array.prototype,g=Function.prototype,v=Object.prototype,y=u["__core-js_shared__"],b=(m=/[^.]+$/.exec(y&&y.keys&&y.keys.IE_PROTO||""))?"Symbol(src)_1."+m:"",E=g.toString,A=v.hasOwnProperty,M=v.toString,L=RegExp("^"+E.call(A).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),k=p.splice,P=C(u,"Map"),U=C(u,"Set"),$=C(Object,"create");function V(D){var H=-1,G=D?D.length:0;for(this.clear();++H<G;){var ee=D[H];this.set(ee[0],ee[1])}}function R(D){var H=-1,G=D?D.length:0;for(this.clear();++H<G;){var ee=D[H];this.set(ee[0],ee[1])}}function O(D){var H=-1,G=D?D.length:0;for(this.clear();++H<G;){var ee=D[H];this.set(ee[0],ee[1])}}function T(D){var H=-1,G=D?D.length:0;for(this.__data__=new O;++H<G;)this.add(D[H])}function w(D,H){for(var G,ee,B=D.length;B--;)if((G=D[B][0])===(ee=H)||G!=G&&ee!=ee)return B;return-1}function x(D){return!(!F(D)||(H=D,b&&b in H))&&((function(G){var ee=F(G)?M.call(G):"";return ee=="[object Function]"||ee=="[object GeneratorFunction]"})(D)||(function(G){var ee=!1;if(G!=null&&typeof G.toString!="function")try{ee=!!(G+"")}catch{}return ee})(D)?L:o).test((function(G){if(G!=null){try{return E.call(G)}catch{}try{return G+""}catch{}}return""})(D));var H}V.prototype.clear=function(){this.__data__=$?$(null):{}},V.prototype.delete=function(D){return this.has(D)&&delete this.__data__[D]},V.prototype.get=function(D){var H=this.__data__;if($){var G=H[D];return G==="__lodash_hash_undefined__"?void 0:G}return A.call(H,D)?H[D]:void 0},V.prototype.has=function(D){var H=this.__data__;return $?H[D]!==void 0:A.call(H,D)},V.prototype.set=function(D,H){return this.__data__[D]=$&&H===void 0?"__lodash_hash_undefined__":H,this},R.prototype.clear=function(){this.__data__=[]},R.prototype.delete=function(D){var H=this.__data__,G=w(H,D);return!(G<0)&&(G==H.length-1?H.pop():k.call(H,G,1),!0)},R.prototype.get=function(D){var H=this.__data__,G=w(H,D);return G<0?void 0:H[G][1]},R.prototype.has=function(D){return w(this.__data__,D)>-1},R.prototype.set=function(D,H){var G=this.__data__,ee=w(G,D);return ee<0?G.push([D,H]):G[ee][1]=H,this},O.prototype.clear=function(){this.__data__={hash:new V,map:new(P||R),string:new V}},O.prototype.delete=function(D){return S(this,D).delete(D)},O.prototype.get=function(D){return S(this,D).get(D)},O.prototype.has=function(D){return S(this,D).has(D)},O.prototype.set=function(D,H){return S(this,D).set(D,H),this},T.prototype.add=T.prototype.push=function(D){return this.__data__.set(D,"__lodash_hash_undefined__"),this},T.prototype.has=function(D){return this.__data__.has(D)};var _=U&&1/f(new U([,-0]))[1]==1/0?function(D){return new U(D)}:function(){};function S(D,H){var G,ee,B=D.__data__;return((ee=typeof(G=H))=="string"||ee=="number"||ee=="symbol"||ee=="boolean"?G!=="__proto__":G===null)?B[typeof H=="string"?"string":"hash"]:B.map}function C(D,H){var G=(function(ee,B){return ee?.[B]})(D,H);return x(G)?G:void 0}function F(D){var H=typeof D;return!!D&&(H=="object"||H=="function")}n.exports=function(D){return D&&D.length?(function(H,G,ee){var B=-1,X=c,I=H.length,N=!0,j=[],Q=j;if(I>=200){var W=_(H);if(W)return f(W);N=!1,X=h,Q=new T}else Q=j;e:for(;++B<I;){var Y=H[B],Z=Y;if(Y=Y!==0?Y:0,N&&Z==Z){for(var se=Q.length;se--;)if(Q[se]===Z)continue e;j.push(Y)}else X(Q,Z,ee)||(Q!==j&&Q.push(Z),j.push(Y))}return j})(D):[]}}).call(this)}).call(this,typeof Wt<"u"?Wt:typeof self<"u"?self:typeof window<"u"?window:{})},{}],450:[function(t,n,i){var s=t("inherits"),o=t("hash-base"),a=t("safe-buffer").Buffer,l=new Array(16);function u(){o.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878}function c(p,g){return p<<g|p>>>32-g}function d(p,g,v,y,b,E,A){return c(p+(g&v|~g&y)+b+E|0,A)+g|0}function h(p,g,v,y,b,E,A){return c(p+(g&y|v&~y)+b+E|0,A)+g|0}function f(p,g,v,y,b,E,A){return c(p+(g^v^y)+b+E|0,A)+g|0}function m(p,g,v,y,b,E,A){return c(p+(v^(g|~y))+b+E|0,A)+g|0}s(u,o),u.prototype._update=function(){for(var p=l,g=0;g<16;++g)p[g]=this._block.readInt32LE(4*g);var v=this._a,y=this._b,b=this._c,E=this._d;v=d(v,y,b,E,p[0],3614090360,7),E=d(E,v,y,b,p[1],3905402710,12),b=d(b,E,v,y,p[2],606105819,17),y=d(y,b,E,v,p[3],3250441966,22),v=d(v,y,b,E,p[4],4118548399,7),E=d(E,v,y,b,p[5],1200080426,12),b=d(b,E,v,y,p[6],2821735955,17),y=d(y,b,E,v,p[7],4249261313,22),v=d(v,y,b,E,p[8],1770035416,7),E=d(E,v,y,b,p[9],2336552879,12),b=d(b,E,v,y,p[10],4294925233,17),y=d(y,b,E,v,p[11],2304563134,22),v=d(v,y,b,E,p[12],1804603682,7),E=d(E,v,y,b,p[13],4254626195,12),b=d(b,E,v,y,p[14],2792965006,17),v=h(v,y=d(y,b,E,v,p[15],1236535329,22),b,E,p[1],4129170786,5),E=h(E,v,y,b,p[6],3225465664,9),b=h(b,E,v,y,p[11],643717713,14),y=h(y,b,E,v,p[0],3921069994,20),v=h(v,y,b,E,p[5],3593408605,5),E=h(E,v,y,b,p[10],38016083,9),b=h(b,E,v,y,p[15],3634488961,14),y=h(y,b,E,v,p[4],3889429448,20),v=h(v,y,b,E,p[9],568446438,5),E=h(E,v,y,b,p[14],3275163606,9),b=h(b,E,v,y,p[3],4107603335,14),y=h(y,b,E,v,p[8],1163531501,20),v=h(v,y,b,E,p[13],2850285829,5),E=h(E,v,y,b,p[2],4243563512,9),b=h(b,E,v,y,p[7],1735328473,14),v=f(v,y=h(y,b,E,v,p[12],2368359562,20),b,E,p[5],4294588738,4),E=f(E,v,y,b,p[8],2272392833,11),b=f(b,E,v,y,p[11],1839030562,16),y=f(y,b,E,v,p[14],4259657740,23),v=f(v,y,b,E,p[1],2763975236,4),E=f(E,v,y,b,p[4],1272893353,11),b=f(b,E,v,y,p[7],4139469664,16),y=f(y,b,E,v,p[10],3200236656,23),v=f(v,y,b,E,p[13],681279174,4),E=f(E,v,y,b,p[0],3936430074,11),b=f(b,E,v,y,p[3],3572445317,16),y=f(y,b,E,v,p[6],76029189,23),v=f(v,y,b,E,p[9],3654602809,4),E=f(E,v,y,b,p[12],3873151461,11),b=f(b,E,v,y,p[15],530742520,16),v=m(v,y=f(y,b,E,v,p[2],3299628645,23),b,E,p[0],4096336452,6),E=m(E,v,y,b,p[7],1126891415,10),b=m(b,E,v,y,p[14],2878612391,15),y=m(y,b,E,v,p[5],4237533241,21),v=m(v,y,b,E,p[12],1700485571,6),E=m(E,v,y,b,p[3],2399980690,10),b=m(b,E,v,y,p[10],4293915773,15),y=m(y,b,E,v,p[1],2240044497,21),v=m(v,y,b,E,p[8],1873313359,6),E=m(E,v,y,b,p[15],4264355552,10),b=m(b,E,v,y,p[6],2734768916,15),y=m(y,b,E,v,p[13],1309151649,21),v=m(v,y,b,E,p[4],4149444226,6),E=m(E,v,y,b,p[11],3174756917,10),b=m(b,E,v,y,p[2],718787259,15),y=m(y,b,E,v,p[9],3951481745,21),this._a=this._a+v|0,this._b=this._b+y|0,this._c=this._c+b|0,this._d=this._d+E|0},u.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var p=a.allocUnsafe(16);return p.writeInt32LE(this._a,0),p.writeInt32LE(this._b,4),p.writeInt32LE(this._c,8),p.writeInt32LE(this._d,12),p},n.exports=u},{"hash-base":425,inherits:440,"safe-buffer":494}],451:[function(t,n,i){var s=t("bn.js"),o=t("brorand");function a(l){this.rand=l||new o.Rand}n.exports=a,a.create=function(l){return new a(l)},a.prototype._randbelow=function(l){var u=l.bitLength(),c=Math.ceil(u/8);do var d=new s(this.rand.generate(c));while(d.cmp(l)>=0);return d},a.prototype._randrange=function(l,u){var c=u.sub(l);return l.add(this._randbelow(c))},a.prototype.test=function(l,u,c){var d=l.bitLength(),h=s.mont(l),f=new s(1).toRed(h);u||(u=Math.max(1,d/48|0));for(var m=l.subn(1),p=0;!m.testn(p);p++);for(var g=l.shrn(p),v=m.toRed(h);u>0;u--){var y=this._randrange(new s(2),m);c&&c(y);var b=y.toRed(h).redPow(g);if(b.cmp(f)!==0&&b.cmp(v)!==0){for(var E=1;E<p;E++){if((b=b.redSqr()).cmp(f)===0)return!1;if(b.cmp(v)===0)break}if(E===p)return!1}}return!0},a.prototype.getDivisor=function(l,u){var c=l.bitLength(),d=s.mont(l),h=new s(1).toRed(d);u||(u=Math.max(1,c/48|0));for(var f=l.subn(1),m=0;!f.testn(m);m++);for(var p=l.shrn(m),g=f.toRed(d);u>0;u--){var v=this._randrange(new s(2),f),y=l.gcd(v);if(y.cmpn(1)!==0)return y;var b=v.toRed(d).redPow(p);if(b.cmp(h)!==0&&b.cmp(g)!==0){for(var E=1;E<m;E++){if((b=b.redSqr()).cmp(h)===0)return b.fromRed().subn(1).gcd(l);if(b.cmp(g)===0)break}if(E===m)return(b=b.redSqr()).fromRed().subn(1).gcd(l)}}return!1}},{"bn.js":452,brorand:187}],452:[function(t,n,i){arguments[4][184][0].apply(i,arguments)},{buffer:188,dup:184}],453:[function(t,n,i){function s(o,a){if(!o)throw new Error(a||"Assertion failed")}n.exports=s,s.equal=function(o,a,l){if(o!=a)throw new Error(l||"Assertion failed: "+o+" != "+a)}},{}],454:[function(t,n,i){var s=i;function o(l){return l.length===1?"0"+l:l}function a(l){for(var u="",c=0;c<l.length;c++)u+=o(l[c].toString(16));return u}s.toArray=function(l,u){if(Array.isArray(l))return l.slice();if(!l)return[];var c=[];if(typeof l!="string"){for(var d=0;d<l.length;d++)c[d]=0|l[d];return c}if(u==="hex")for((l=l.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(l="0"+l),d=0;d<l.length;d+=2)c.push(parseInt(l[d]+l[d+1],16));else for(d=0;d<l.length;d++){var h=l.charCodeAt(d),f=h>>8,m=255&h;f?c.push(f,m):c.push(m)}return c},s.zero2=o,s.toHex=a,s.encode=function(l,u){return u==="hex"?a(l):l}},{}],455:[function(t,n,i){n.exports={"2.16.840.1.101.3.4.1.1":"aes-128-ecb","2.16.840.1.101.3.4.1.2":"aes-128-cbc","2.16.840.1.101.3.4.1.3":"aes-128-ofb","2.16.840.1.101.3.4.1.4":"aes-128-cfb","2.16.840.1.101.3.4.1.21":"aes-192-ecb","2.16.840.1.101.3.4.1.22":"aes-192-cbc","2.16.840.1.101.3.4.1.23":"aes-192-ofb","2.16.840.1.101.3.4.1.24":"aes-192-cfb","2.16.840.1.101.3.4.1.41":"aes-256-ecb","2.16.840.1.101.3.4.1.42":"aes-256-cbc","2.16.840.1.101.3.4.1.43":"aes-256-ofb","2.16.840.1.101.3.4.1.44":"aes-256-cfb"}},{}],456:[function(t,n,i){var s=t("asn1.js");i.certificate=t("./certificate");var o=s.define("RSAPrivateKey",(function(){this.seq().obj(this.key("version").int(),this.key("modulus").int(),this.key("publicExponent").int(),this.key("privateExponent").int(),this.key("prime1").int(),this.key("prime2").int(),this.key("exponent1").int(),this.key("exponent2").int(),this.key("coefficient").int())}));i.RSAPrivateKey=o;var a=s.define("RSAPublicKey",(function(){this.seq().obj(this.key("modulus").int(),this.key("publicExponent").int())}));i.RSAPublicKey=a;var l=s.define("SubjectPublicKeyInfo",(function(){this.seq().obj(this.key("algorithm").use(u),this.key("subjectPublicKey").bitstr())}));i.PublicKey=l;var u=s.define("AlgorithmIdentifier",(function(){this.seq().obj(this.key("algorithm").objid(),this.key("none").null_().optional(),this.key("curve").objid().optional(),this.key("params").seq().obj(this.key("p").int(),this.key("q").int(),this.key("g").int()).optional())})),c=s.define("PrivateKeyInfo",(function(){this.seq().obj(this.key("version").int(),this.key("algorithm").use(u),this.key("subjectPrivateKey").octstr())}));i.PrivateKey=c;var d=s.define("EncryptedPrivateKeyInfo",(function(){this.seq().obj(this.key("algorithm").seq().obj(this.key("id").objid(),this.key("decrypt").seq().obj(this.key("kde").seq().obj(this.key("id").objid(),this.key("kdeparams").seq().obj(this.key("salt").octstr(),this.key("iters").int())),this.key("cipher").seq().obj(this.key("algo").objid(),this.key("iv").octstr()))),this.key("subjectPrivateKey").octstr())}));i.EncryptedPrivateKey=d;var h=s.define("DSAPrivateKey",(function(){this.seq().obj(this.key("version").int(),this.key("p").int(),this.key("q").int(),this.key("g").int(),this.key("pub_key").int(),this.key("priv_key").int())}));i.DSAPrivateKey=h,i.DSAparam=s.define("DSAparam",(function(){this.int()}));var f=s.define("ECPrivateKey",(function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").optional().explicit(0).use(m),this.key("publicKey").optional().explicit(1).bitstr())}));i.ECPrivateKey=f;var m=s.define("ECParameters",(function(){this.choice({namedCurve:this.objid()})}));i.signature=s.define("signature",(function(){this.seq().obj(this.key("r").int(),this.key("s").int())}))},{"./certificate":457,"asn1.js":170}],457:[function(t,n,i){var s=t("asn1.js"),o=s.define("Time",(function(){this.choice({utcTime:this.utctime(),generalTime:this.gentime()})})),a=s.define("AttributeTypeValue",(function(){this.seq().obj(this.key("type").objid(),this.key("value").any())})),l=s.define("AlgorithmIdentifier",(function(){this.seq().obj(this.key("algorithm").objid(),this.key("parameters").optional(),this.key("curve").objid().optional())})),u=s.define("SubjectPublicKeyInfo",(function(){this.seq().obj(this.key("algorithm").use(l),this.key("subjectPublicKey").bitstr())})),c=s.define("RelativeDistinguishedName",(function(){this.setof(a)})),d=s.define("RDNSequence",(function(){this.seqof(c)})),h=s.define("Name",(function(){this.choice({rdnSequence:this.use(d)})})),f=s.define("Validity",(function(){this.seq().obj(this.key("notBefore").use(o),this.key("notAfter").use(o))})),m=s.define("Extension",(function(){this.seq().obj(this.key("extnID").objid(),this.key("critical").bool().def(!1),this.key("extnValue").octstr())})),p=s.define("TBSCertificate",(function(){this.seq().obj(this.key("version").explicit(0).int().optional(),this.key("serialNumber").int(),this.key("signature").use(l),this.key("issuer").use(h),this.key("validity").use(f),this.key("subject").use(h),this.key("subjectPublicKeyInfo").use(u),this.key("issuerUniqueID").implicit(1).bitstr().optional(),this.key("subjectUniqueID").implicit(2).bitstr().optional(),this.key("extensions").explicit(3).seqof(m).optional())})),g=s.define("X509Certificate",(function(){this.seq().obj(this.key("tbsCertificate").use(p),this.key("signatureAlgorithm").use(l),this.key("signatureValue").bitstr())}));n.exports=g},{"asn1.js":170}],458:[function(t,n,i){var s=/Proc-Type: 4,ENCRYPTED[\n\r]+DEK-Info: AES-((?:128)|(?:192)|(?:256))-CBC,([0-9A-H]+)[\n\r]+([0-9A-z\n\r+/=]+)[\n\r]+/m,o=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----/m,a=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----([0-9A-z\n\r+/=]+)-----END \1-----$/m,l=t("evp_bytestokey"),u=t("browserify-aes"),c=t("safe-buffer").Buffer;n.exports=function(d,h){var f,m=d.toString(),p=m.match(s);if(p){var g="aes"+p[1],v=c.from(p[2],"hex"),y=c.from(p[3].replace(/[\r\n]/g,""),"base64"),b=l(h,v.slice(0,8),parseInt(p[1],10)).key,E=[],A=u.createDecipheriv(g,b,v);E.push(A.update(y)),E.push(A.final()),f=c.concat(E)}else{var M=m.match(a);f=c.from(M[2].replace(/[\r\n]/g,""),"base64")}return{tag:m.match(o)[1],data:f}}},{"browserify-aes":191,evp_bytestokey:423,"safe-buffer":494}],459:[function(t,n,i){var s=t("./asn1"),o=t("./aesid.json"),a=t("./fixProc"),l=t("browserify-aes"),u=t("pbkdf2"),c=t("safe-buffer").Buffer;function d(h){var f;typeof h!="object"||c.isBuffer(h)||(f=h.passphrase,h=h.key),typeof h=="string"&&(h=c.from(h));var m,p,g=a(h,f),v=g.tag,y=g.data;switch(v){case"CERTIFICATE":p=s.certificate.decode(y,"der").tbsCertificate.subjectPublicKeyInfo;case"PUBLIC KEY":switch(p||(p=s.PublicKey.decode(y,"der")),m=p.algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return s.RSAPublicKey.decode(p.subjectPublicKey.data,"der");case"1.2.840.10045.2.1":return p.subjectPrivateKey=p.subjectPublicKey,{type:"ec",data:p};case"1.2.840.10040.4.1":return p.algorithm.params.pub_key=s.DSAparam.decode(p.subjectPublicKey.data,"der"),{type:"dsa",data:p.algorithm.params};default:throw new Error("unknown key id "+m)}case"ENCRYPTED PRIVATE KEY":y=(function(b,E){var A=b.algorithm.decrypt.kde.kdeparams.salt,M=parseInt(b.algorithm.decrypt.kde.kdeparams.iters.toString(),10),L=o[b.algorithm.decrypt.cipher.algo.join(".")],k=b.algorithm.decrypt.cipher.iv,P=b.subjectPrivateKey,U=parseInt(L.split("-")[1],10)/8,$=u.pbkdf2Sync(E,A,M,U,"sha1"),V=l.createDecipheriv(L,$,k),R=[];return R.push(V.update(P)),R.push(V.final()),c.concat(R)})(y=s.EncryptedPrivateKey.decode(y,"der"),f);case"PRIVATE KEY":switch(m=(p=s.PrivateKey.decode(y,"der")).algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return s.RSAPrivateKey.decode(p.subjectPrivateKey,"der");case"1.2.840.10045.2.1":return{curve:p.algorithm.curve,privateKey:s.ECPrivateKey.decode(p.subjectPrivateKey,"der").privateKey};case"1.2.840.10040.4.1":return p.algorithm.params.priv_key=s.DSAparam.decode(p.subjectPrivateKey,"der"),{type:"dsa",params:p.algorithm.params};default:throw new Error("unknown key id "+m)}case"RSA PUBLIC KEY":return s.RSAPublicKey.decode(y,"der");case"RSA PRIVATE KEY":return s.RSAPrivateKey.decode(y,"der");case"DSA PRIVATE KEY":return{type:"dsa",params:s.DSAPrivateKey.decode(y,"der")};case"EC PRIVATE KEY":return{curve:(y=s.ECPrivateKey.decode(y,"der")).parameters.value,privateKey:y.privateKey};default:throw new Error("unknown key type "+v)}}n.exports=d,d.signature=s.signature},{"./aesid.json":455,"./asn1":456,"./fixProc":458,"browserify-aes":191,pbkdf2:460,"safe-buffer":494}],460:[function(t,n,i){i.pbkdf2=t("./lib/async"),i.pbkdf2Sync=t("./lib/sync")},{"./lib/async":461,"./lib/sync":464}],461:[function(t,n,i){(function(s){(function(){var o,a,l=t("safe-buffer").Buffer,u=t("./precondition"),c=t("./default-encoding"),d=t("./sync"),h=t("./to-buffer"),f=s.crypto&&s.crypto.subtle,m={sha:"SHA-1","sha-1":"SHA-1",sha1:"SHA-1",sha256:"SHA-256","sha-256":"SHA-256",sha384:"SHA-384","sha-384":"SHA-384","sha-512":"SHA-512",sha512:"SHA-512"},p=[];function g(){return a||(a=s.process&&s.process.nextTick?s.process.nextTick:s.queueMicrotask?s.queueMicrotask:s.setImmediate?s.setImmediate:s.setTimeout)}function v(y,b,E,A,M){return f.importKey("raw",y,{name:"PBKDF2"},!1,["deriveBits"]).then((function(L){return f.deriveBits({name:"PBKDF2",salt:b,iterations:E,hash:{name:M}},L,A<<3)})).then((function(L){return l.from(L)}))}n.exports=function(y,b,E,A,M,L){typeof M=="function"&&(L=M,M=void 0);var k=m[(M=M||"sha1").toLowerCase()];if(k&&typeof s.Promise=="function"){if(u(E,A),y=h(y,c,"Password"),b=h(b,c,"Salt"),typeof L!="function")throw new Error("No callback provided to pbkdf2");(function(P,U){P.then((function($){g()((function(){U(null,$)}))}),(function($){g()((function(){U($)}))}))})((function(P){if(s.process&&!s.process.browser||!f||!f.importKey||!f.deriveBits)return Promise.resolve(!1);if(p[P]!==void 0)return p[P];var U=v(o=o||l.alloc(8),o,10,128,P).then((function(){return!0})).catch((function(){return!1}));return p[P]=U,U})(k).then((function(P){return P?v(y,b,E,A,k):d(y,b,E,A,M)})),L)}else g()((function(){var P;try{P=d(y,b,E,A,M)}catch(U){return L(U)}L(null,P)}))}}).call(this)}).call(this,typeof Wt<"u"?Wt:typeof self<"u"?self:typeof window<"u"?window:{})},{"./default-encoding":462,"./precondition":463,"./sync":464,"./to-buffer":465,"safe-buffer":494}],462:[function(t,n,i){(function(s,o){(function(){var a;o.process&&o.process.browser?a="utf-8":o.process&&o.process.version?a=parseInt(s.version.split(".")[0].slice(1),10)>=6?"utf-8":"binary":a="utf-8",n.exports=a}).call(this)}).call(this,t("_process"),typeof Wt<"u"?Wt:typeof self<"u"?self:typeof window<"u"?window:{})},{_process:467}],463:[function(t,n,i){var s=Math.pow(2,30)-1;n.exports=function(o,a){if(typeof o!="number")throw new TypeError("Iterations not a number");if(o<0)throw new TypeError("Bad iterations");if(typeof a!="number")throw new TypeError("Key length not a number");if(a<0||a>s||a!=a)throw new TypeError("Bad key length")}},{}],464:[function(t,n,i){var s=t("create-hash/md5"),o=t("ripemd160"),a=t("sha.js"),l=t("safe-buffer").Buffer,u=t("./precondition"),c=t("./default-encoding"),d=t("./to-buffer"),h=l.alloc(128),f={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,rmd160:20,ripemd160:20};function m(p,g,v){var y=(function(k){function P(U){return a(k).update(U).digest()}return k==="rmd160"||k==="ripemd160"?function(U){return new o().update(U).digest()}:k==="md5"?s:P})(p),b=p==="sha512"||p==="sha384"?128:64;g.length>b?g=y(g):g.length<b&&(g=l.concat([g,h],b));for(var E=l.allocUnsafe(b+f[p]),A=l.allocUnsafe(b+f[p]),M=0;M<b;M++)E[M]=54^g[M],A[M]=92^g[M];var L=l.allocUnsafe(b+v+4);E.copy(L,0,0,b),this.ipad1=L,this.ipad2=E,this.opad=A,this.alg=p,this.blocksize=b,this.hash=y,this.size=f[p]}m.prototype.run=function(p,g){return p.copy(g,this.blocksize),this.hash(g).copy(this.opad,this.blocksize),this.hash(this.opad)},n.exports=function(p,g,v,y,b){u(v,y);var E=new m(b=b||"sha1",p=d(p,c,"Password"),(g=d(g,c,"Salt")).length),A=l.allocUnsafe(y),M=l.allocUnsafe(g.length+4);g.copy(M,0,0,g.length);for(var L=0,k=f[b],P=Math.ceil(y/k),U=1;U<=P;U++){M.writeUInt32BE(U,g.length);for(var $=E.run(M,E.ipad1),V=$,R=1;R<v;R++){V=E.run(V,E.ipad2);for(var O=0;O<k;O++)$[O]^=V[O]}$.copy(A,L),L+=k}return A}},{"./default-encoding":462,"./precondition":463,"./to-buffer":465,"create-hash/md5":387,ripemd160:493,"safe-buffer":494,"sha.js":498}],465:[function(t,n,i){var s=t("safe-buffer").Buffer;n.exports=function(o,a,l){if(s.isBuffer(o))return o;if(typeof o=="string")return s.from(o,a);if(ArrayBuffer.isView(o))return s.from(o.buffer);throw new TypeError(l+" must be a string, a Buffer, a typed array or a DataView")}},{"safe-buffer":494}],466:[function(t,n,i){(function(s){(function(){s===void 0||!s.version||s.version.indexOf("v0.")===0||s.version.indexOf("v1.")===0&&s.version.indexOf("v1.8.")!==0?n.exports={nextTick:function(o,a,l,u){if(typeof o!="function")throw new TypeError('"callback" argument must be a function');var c,d,h=arguments.length;switch(h){case 0:case 1:return s.nextTick(o);case 2:return s.nextTick((function(){o.call(null,a)}));case 3:return s.nextTick((function(){o.call(null,a,l)}));case 4:return s.nextTick((function(){o.call(null,a,l,u)}));default:for(c=new Array(h-1),d=0;d<c.length;)c[d++]=arguments[d];return s.nextTick((function(){o.apply(null,c)}))}}}:n.exports=s}).call(this)}).call(this,t("_process"))},{_process:467}],467:[function(t,n,i){var s,o,a=n.exports={};function l(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}function c(b){if(s===setTimeout)return setTimeout(b,0);if((s===l||!s)&&setTimeout)return s=setTimeout,setTimeout(b,0);try{return s(b,0)}catch{try{return s.call(null,b,0)}catch{return s.call(this,b,0)}}}(function(){try{s=typeof setTimeout=="function"?setTimeout:l}catch{s=l}try{o=typeof clearTimeout=="function"?clearTimeout:u}catch{o=u}})();var d,h=[],f=!1,m=-1;function p(){f&&d&&(f=!1,d.length?h=d.concat(h):m=-1,h.length&&g())}function g(){if(!f){var b=c(p);f=!0;for(var E=h.length;E;){for(d=h,h=[];++m<E;)d&&d[m].run();m=-1,E=h.length}d=null,f=!1,(function(A){if(o===clearTimeout)return clearTimeout(A);if((o===u||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(A);try{o(A)}catch{try{return o.call(null,A)}catch{return o.call(this,A)}}})(b)}}function v(b,E){this.fun=b,this.array=E}function y(){}a.nextTick=function(b){var E=new Array(arguments.length-1);if(arguments.length>1)for(var A=1;A<arguments.length;A++)E[A-1]=arguments[A];h.push(new v(b,E)),h.length!==1||f||c(g)},v.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=y,a.addListener=y,a.once=y,a.off=y,a.removeListener=y,a.removeAllListeners=y,a.emit=y,a.prependListener=y,a.prependOnceListener=y,a.listeners=function(b){return[]},a.binding=function(b){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(b){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},{}],468:[function(t,n,i){i.publicEncrypt=t("./publicEncrypt"),i.privateDecrypt=t("./privateDecrypt"),i.privateEncrypt=function(s,o){return i.publicEncrypt(s,o,!0)},i.publicDecrypt=function(s,o){return i.privateDecrypt(s,o,!0)}},{"./privateDecrypt":471,"./publicEncrypt":472}],469:[function(t,n,i){var s=t("create-hash"),o=t("safe-buffer").Buffer;function a(l){var u=o.allocUnsafe(4);return u.writeUInt32BE(l,0),u}n.exports=function(l,u){for(var c,d=o.alloc(0),h=0;d.length<u;)c=a(h++),d=o.concat([d,s("sha1").update(l).update(c).digest()]);return d.slice(0,u)}},{"create-hash":386,"safe-buffer":494}],470:[function(t,n,i){arguments[4][184][0].apply(i,arguments)},{buffer:188,dup:184}],471:[function(t,n,i){var s=t("parse-asn1"),o=t("./mgf"),a=t("./xor"),l=t("bn.js"),u=t("browserify-rsa"),c=t("create-hash"),d=t("./withPublic"),h=t("safe-buffer").Buffer;n.exports=function(f,m,p){var g;g=f.padding?f.padding:p?1:4;var v,y=s(f),b=y.modulus.byteLength();if(m.length>b||new l(m).cmp(y.modulus)>=0)throw new Error("decryption error");v=p?d(new l(m),y):u(m,y);var E=h.alloc(b-v.length);if(v=h.concat([E,v],b),g===4)return(function(A,M){var L=A.modulus.byteLength(),k=c("sha1").update(h.alloc(0)).digest(),P=k.length;if(M[0]!==0)throw new Error("decryption error");var U=M.slice(1,P+1),$=M.slice(P+1),V=a(U,o($,P)),R=a($,o(V,L-P-1));if((function(T,w){T=h.from(T),w=h.from(w);var x=0,_=T.length;T.length!==w.length&&(x++,_=Math.min(T.length,w.length));for(var S=-1;++S<_;)x+=T[S]^w[S];return x})(k,R.slice(0,P)))throw new Error("decryption error");for(var O=P;R[O]===0;)O++;if(R[O++]!==1)throw new Error("decryption error");return R.slice(O)})(y,v);if(g===1)return(function(A,M,L){for(var k=M.slice(0,2),P=2,U=0;M[P++]!==0;)if(P>=M.length){U++;break}var $=M.slice(2,P-1);if((k.toString("hex")!=="0002"&&!L||k.toString("hex")!=="0001"&&L)&&U++,$.length<8&&U++,U)throw new Error("decryption error");return M.slice(P)})(0,v,p);if(g===3)return v;throw new Error("unknown padding")}},{"./mgf":469,"./withPublic":473,"./xor":474,"bn.js":470,"browserify-rsa":209,"create-hash":386,"parse-asn1":459,"safe-buffer":494}],472:[function(t,n,i){var s=t("parse-asn1"),o=t("randombytes"),a=t("create-hash"),l=t("./mgf"),u=t("./xor"),c=t("bn.js"),d=t("./withPublic"),h=t("browserify-rsa"),f=t("safe-buffer").Buffer;n.exports=function(m,p,g){var v;v=m.padding?m.padding:g?1:4;var y,b=s(m);if(v===4)y=(function(E,A){var M=E.modulus.byteLength(),L=A.length,k=a("sha1").update(f.alloc(0)).digest(),P=k.length,U=2*P;if(L>M-U-2)throw new Error("message too long");var $=f.alloc(M-L-U-2),V=M-P-1,R=o(P),O=u(f.concat([k,$,f.alloc(1,1),A],V),l(R,V)),T=u(R,l(O,P));return new c(f.concat([f.alloc(1),T,O],M))})(b,p);else if(v===1)y=(function(E,A,M){var L,k=A.length,P=E.modulus.byteLength();if(k>P-11)throw new Error("message too long");return L=M?f.alloc(P-k-3,255):(function(U){for(var $,V=f.allocUnsafe(U),R=0,O=o(2*U),T=0;R<U;)T===O.length&&(O=o(2*U),T=0),($=O[T++])&&(V[R++]=$);return V})(P-k-3),new c(f.concat([f.from([0,M?1:2]),L,f.alloc(1),A],P))})(b,p,g);else{if(v!==3)throw new Error("unknown padding");if((y=new c(p)).cmp(b.modulus)>=0)throw new Error("data too long for modulus")}return g?h(y,b):d(y,b)}},{"./mgf":469,"./withPublic":473,"./xor":474,"bn.js":470,"browserify-rsa":209,"create-hash":386,"parse-asn1":459,randombytes:475,"safe-buffer":494}],473:[function(t,n,i){var s=t("bn.js"),o=t("safe-buffer").Buffer;n.exports=function(a,l){return o.from(a.toRed(s.mont(l.modulus)).redPow(new s(l.publicExponent)).fromRed().toArray())}},{"bn.js":470,"safe-buffer":494}],474:[function(t,n,i){n.exports=function(s,o){for(var a=s.length,l=-1;++l<a;)s[l]^=o[l];return s}},{}],475:[function(t,n,i){(function(s,o){(function(){var a=t("safe-buffer").Buffer,l=o.crypto||o.msCrypto;l&&l.getRandomValues?n.exports=function(u,c){if(u>4294967295)throw new RangeError("requested too many random bytes");var d=a.allocUnsafe(u);if(u>0)if(u>65536)for(var h=0;h<u;h+=65536)l.getRandomValues(d.slice(h,h+65536));else l.getRandomValues(d);return typeof c=="function"?s.nextTick((function(){c(null,d)})):d}:n.exports=function(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}}).call(this)}).call(this,t("_process"),typeof Wt<"u"?Wt:typeof self<"u"?self:typeof window<"u"?window:{})},{_process:467,"safe-buffer":494}],476:[function(t,n,i){(function(s,o){(function(){function a(){throw new Error(`secure random number generation not supported by this browser
use chrome, FireFox or Internet Explorer 11`)}var l=t("safe-buffer"),u=t("randombytes"),c=l.Buffer,d=l.kMaxLength,h=o.crypto||o.msCrypto,f=Math.pow(2,32)-1;function m(v,y){if(typeof v!="number"||v!=v)throw new TypeError("offset must be a number");if(v>f||v<0)throw new TypeError("offset must be a uint32");if(v>d||v>y)throw new RangeError("offset out of range")}function p(v,y,b){if(typeof v!="number"||v!=v)throw new TypeError("size must be a number");if(v>f||v<0)throw new TypeError("size must be a uint32");if(v+y>b||v>d)throw new RangeError("buffer too small")}function g(v,y,b,E){if(s.browser){var A=v.buffer,M=new Uint8Array(A,y,b);return h.getRandomValues(M),E?void s.nextTick((function(){E(null,v)})):v}if(!E)return u(b).copy(v,y),v;u(b,(function(L,k){if(L)return E(L);k.copy(v,y),E(null,v)}))}h&&h.getRandomValues||!s.browser?(i.randomFill=function(v,y,b,E){if(!(c.isBuffer(v)||v instanceof o.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');if(typeof y=="function")E=y,y=0,b=v.length;else if(typeof b=="function")E=b,b=v.length-y;else if(typeof E!="function")throw new TypeError('"cb" argument must be a function');return m(y,v.length),p(b,y,v.length),g(v,y,b,E)},i.randomFillSync=function(v,y,b){if(y===void 0&&(y=0),!(c.isBuffer(v)||v instanceof o.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');return m(y,v.length),b===void 0&&(b=v.length-y),p(b,y,v.length),g(v,y,b)}):(i.randomFill=a,i.randomFillSync=a)}).call(this)}).call(this,t("_process"),typeof Wt<"u"?Wt:typeof self<"u"?self:typeof window<"u"?window:{})},{_process:467,randombytes:475,"safe-buffer":494}],477:[function(t,n,i){var s={};function o(l,u,c){c||(c=Error);var d=(function(h){var f,m;function p(g,v,y){return h.call(this,(function(b,E,A){return typeof u=="string"?u:u(b,E,A)})(g,v,y))||this}return m=h,(f=p).prototype=Object.create(m.prototype),f.prototype.constructor=f,f.__proto__=m,p})(c);d.prototype.name=c.name,d.prototype.code=l,s[l]=d}function a(l,u){if(Array.isArray(l)){var c=l.length;return l=l.map((function(d){return String(d)})),c>2?"one of ".concat(u," ").concat(l.slice(0,c-1).join(", "),", or ")+l[c-1]:c===2?"one of ".concat(u," ").concat(l[0]," or ").concat(l[1]):"of ".concat(u," ").concat(l[0])}return"of ".concat(u," ").concat(String(l))}o("ERR_INVALID_OPT_VALUE",(function(l,u){return'The value "'+u+'" is invalid for option "'+l+'"'}),TypeError),o("ERR_INVALID_ARG_TYPE",(function(l,u,c){var d,h,f;if(typeof u=="string"&&(h="not ",u.substr(0,h.length)===h)?(d="must not be",u=u.replace(/^not /,"")):d="must be",(function(p,g,v){return(v===void 0||v>p.length)&&(v=p.length),p.substring(v-g.length,v)===g})(l," argument"))f="The ".concat(l," ").concat(d," ").concat(a(u,"type"));else{var m=(function(p,g,v){return typeof v!="number"&&(v=0),!(v+g.length>p.length)&&p.indexOf(g,v)!==-1})(l,".")?"property":"argument";f='The "'.concat(l,'" ').concat(m," ").concat(d," ").concat(a(u,"type"))}return f+=". Received type ".concat(typeof c)}),TypeError),o("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),o("ERR_METHOD_NOT_IMPLEMENTED",(function(l){return"The "+l+" method is not implemented"})),o("ERR_STREAM_PREMATURE_CLOSE","Premature close"),o("ERR_STREAM_DESTROYED",(function(l){return"Cannot call "+l+" after a stream was destroyed"})),o("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),o("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),o("ERR_STREAM_WRITE_AFTER_END","write after end"),o("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),o("ERR_UNKNOWN_ENCODING",(function(l){return"Unknown encoding: "+l}),TypeError),o("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),n.exports.codes=s},{}],478:[function(t,n,i){(function(s){(function(){var o=Object.keys||function(p){var g=[];for(var v in p)g.push(v);return g};n.exports=h;var a=t("./_stream_readable"),l=t("./_stream_writable");t("inherits")(h,a);for(var u=o(l.prototype),c=0;c<u.length;c++){var d=u[c];h.prototype[d]||(h.prototype[d]=l.prototype[d])}function h(p){if(!(this instanceof h))return new h(p);a.call(this,p),l.call(this,p),this.allowHalfOpen=!0,p&&(p.readable===!1&&(this.readable=!1),p.writable===!1&&(this.writable=!1),p.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",f)))}function f(){this._writableState.ended||s.nextTick(m,this)}function m(p){p.end()}Object.defineProperty(h.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(h.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(h.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(h.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(p){this._readableState!==void 0&&this._writableState!==void 0&&(this._readableState.destroyed=p,this._writableState.destroyed=p)}})}).call(this)}).call(this,t("_process"))},{"./_stream_readable":480,"./_stream_writable":482,_process:467,inherits:440}],479:[function(t,n,i){n.exports=o;var s=t("./_stream_transform");function o(a){if(!(this instanceof o))return new o(a);s.call(this,a)}t("inherits")(o,s),o.prototype._transform=function(a,l,u){u(null,a)}},{"./_stream_transform":481,inherits:440}],480:[function(t,n,i){(function(s,o){(function(){var a;n.exports=V,V.ReadableState=$,t("events").EventEmitter;var l=function(I,N){return I.listeners(N).length},u=t("./internal/streams/stream"),c=t("buffer").Buffer,d=(o!==void 0?o:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},h,f=t("util");h=f&&f.debuglog?f.debuglog("stream"):function(){};var m,p,g,v=t("./internal/streams/buffer_list"),y=t("./internal/streams/destroy"),b=t("./internal/streams/state").getHighWaterMark,E=t("../errors").codes,A=E.ERR_INVALID_ARG_TYPE,M=E.ERR_STREAM_PUSH_AFTER_EOF,L=E.ERR_METHOD_NOT_IMPLEMENTED,k=E.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;t("inherits")(V,u);var P=y.errorOrDestroy,U=["error","close","destroy","pause","resume"];function $(I,N,j){a=a||t("./_stream_duplex"),I=I||{},typeof j!="boolean"&&(j=N instanceof a),this.objectMode=!!I.objectMode,j&&(this.objectMode=this.objectMode||!!I.readableObjectMode),this.highWaterMark=b(this,I,"readableHighWaterMark",j),this.buffer=new v,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=I.emitClose!==!1,this.autoDestroy=!!I.autoDestroy,this.destroyed=!1,this.defaultEncoding=I.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,I.encoding&&(m||(m=t("string_decoder/").StringDecoder),this.decoder=new m(I.encoding),this.encoding=I.encoding)}function V(I){if(a=a||t("./_stream_duplex"),!(this instanceof V))return new V(I);var N=this instanceof a;this._readableState=new $(I,this,N),this.readable=!0,I&&(typeof I.read=="function"&&(this._read=I.read),typeof I.destroy=="function"&&(this._destroy=I.destroy)),u.call(this)}function R(I,N,j,Q,W){h("readableAddChunk",N);var Y,Z=I._readableState;if(N===null)Z.reading=!1,(function(se,re){if(h("onEofChunk"),!re.ended){if(re.decoder){var K=re.decoder.end();K&&K.length&&(re.buffer.push(K),re.length+=re.objectMode?1:K.length)}re.ended=!0,re.sync?w(se):(re.needReadable=!1,re.emittedReadable||(re.emittedReadable=!0,x(se)))}})(I,Z);else if(W||(Y=(function(se,re){var K;ie=re,c.isBuffer(ie)||ie instanceof d||typeof re=="string"||re===void 0||se.objectMode||(K=new A("chunk",["string","Buffer","Uint8Array"],re));var ie;return K})(Z,N)),Y)P(I,Y);else if(Z.objectMode||N&&N.length>0)if(typeof N=="string"||Z.objectMode||Object.getPrototypeOf(N)===c.prototype||(N=(function(se){return c.from(se)})(N)),Q)Z.endEmitted?P(I,new k):O(I,Z,N,!0);else if(Z.ended)P(I,new M);else{if(Z.destroyed)return!1;Z.reading=!1,Z.decoder&&!j?(N=Z.decoder.write(N),Z.objectMode||N.length!==0?O(I,Z,N,!1):_(I,Z)):O(I,Z,N,!1)}else Q||(Z.reading=!1,_(I,Z));return!Z.ended&&(Z.length<Z.highWaterMark||Z.length===0)}function O(I,N,j,Q){N.flowing&&N.length===0&&!N.sync?(N.awaitDrain=0,I.emit("data",j)):(N.length+=N.objectMode?1:j.length,Q?N.buffer.unshift(j):N.buffer.push(j),N.needReadable&&w(I)),_(I,N)}Object.defineProperty(V.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(I){this._readableState&&(this._readableState.destroyed=I)}}),V.prototype.destroy=y.destroy,V.prototype._undestroy=y.undestroy,V.prototype._destroy=function(I,N){N(I)},V.prototype.push=function(I,N){var j,Q=this._readableState;return Q.objectMode?j=!0:typeof I=="string"&&((N=N||Q.defaultEncoding)!==Q.encoding&&(I=c.from(I,N),N=""),j=!0),R(this,I,N,!1,j)},V.prototype.unshift=function(I){return R(this,I,null,!0,!1)},V.prototype.isPaused=function(){return this._readableState.flowing===!1},V.prototype.setEncoding=function(I){m||(m=t("string_decoder/").StringDecoder);var N=new m(I);this._readableState.decoder=N,this._readableState.encoding=this._readableState.decoder.encoding;for(var j=this._readableState.buffer.head,Q="";j!==null;)Q+=N.write(j.data),j=j.next;return this._readableState.buffer.clear(),Q!==""&&this._readableState.buffer.push(Q),this._readableState.length=Q.length,this};function T(I,N){return I<=0||N.length===0&&N.ended?0:N.objectMode?1:I!=I?N.flowing&&N.length?N.buffer.head.data.length:N.length:(I>N.highWaterMark&&(N.highWaterMark=(function(j){return j>=1073741824?j=1073741824:(j--,j|=j>>>1,j|=j>>>2,j|=j>>>4,j|=j>>>8,j|=j>>>16,j++),j})(I)),I<=N.length?I:N.ended?N.length:(N.needReadable=!0,0))}function w(I){var N=I._readableState;h("emitReadable",N.needReadable,N.emittedReadable),N.needReadable=!1,N.emittedReadable||(h("emitReadable",N.flowing),N.emittedReadable=!0,s.nextTick(x,I))}function x(I){var N=I._readableState;h("emitReadable_",N.destroyed,N.length,N.ended),N.destroyed||!N.length&&!N.ended||(I.emit("readable"),N.emittedReadable=!1),N.needReadable=!N.flowing&&!N.ended&&N.length<=N.highWaterMark,H(I)}function _(I,N){N.readingMore||(N.readingMore=!0,s.nextTick(S,I,N))}function S(I,N){for(;!N.reading&&!N.ended&&(N.length<N.highWaterMark||N.flowing&&N.length===0);){var j=N.length;if(h("maybeReadMore read 0"),I.read(0),j===N.length)break}N.readingMore=!1}function C(I){var N=I._readableState;N.readableListening=I.listenerCount("readable")>0,N.resumeScheduled&&!N.paused?N.flowing=!0:I.listenerCount("data")>0&&I.resume()}function F(I){h("readable nexttick read 0"),I.read(0)}function D(I,N){h("resume",N.reading),N.reading||I.read(0),N.resumeScheduled=!1,I.emit("resume"),H(I),N.flowing&&!N.reading&&I.read(0)}function H(I){var N=I._readableState;for(h("flow",N.flowing);N.flowing&&I.read()!==null;);}function G(I,N){return N.length===0?null:(N.objectMode?j=N.buffer.shift():!I||I>=N.length?(j=N.decoder?N.buffer.join(""):N.buffer.length===1?N.buffer.first():N.buffer.concat(N.length),N.buffer.clear()):j=N.buffer.consume(I,N.decoder),j);var j}function ee(I){var N=I._readableState;h("endReadable",N.endEmitted),N.endEmitted||(N.ended=!0,s.nextTick(B,N,I))}function B(I,N){if(h("endReadableNT",I.endEmitted,I.length),!I.endEmitted&&I.length===0&&(I.endEmitted=!0,N.readable=!1,N.emit("end"),I.autoDestroy)){var j=N._writableState;(!j||j.autoDestroy&&j.finished)&&N.destroy()}}function X(I,N){for(var j=0,Q=I.length;j<Q;j++)if(I[j]===N)return j;return-1}V.prototype.read=function(I){h("read",I),I=parseInt(I,10);var N=this._readableState,j=I;if(I!==0&&(N.emittedReadable=!1),I===0&&N.needReadable&&((N.highWaterMark!==0?N.length>=N.highWaterMark:N.length>0)||N.ended))return h("read: emitReadable",N.length,N.ended),N.length===0&&N.ended?ee(this):w(this),null;if((I=T(I,N))===0&&N.ended)return N.length===0&&ee(this),null;var Q,W=N.needReadable;return h("need readable",W),(N.length===0||N.length-I<N.highWaterMark)&&h("length less than watermark",W=!0),N.ended||N.reading?h("reading or ended",W=!1):W&&(h("do read"),N.reading=!0,N.sync=!0,N.length===0&&(N.needReadable=!0),this._read(N.highWaterMark),N.sync=!1,N.reading||(I=T(j,N))),(Q=I>0?G(I,N):null)===null?(N.needReadable=N.length<=N.highWaterMark,I=0):(N.length-=I,N.awaitDrain=0),N.length===0&&(N.ended||(N.needReadable=!0),j!==I&&N.ended&&ee(this)),Q!==null&&this.emit("data",Q),Q},V.prototype._read=function(I){P(this,new L("_read()"))},V.prototype.pipe=function(I,N){var j=this,Q=this._readableState;switch(Q.pipesCount){case 0:Q.pipes=I;break;case 1:Q.pipes=[Q.pipes,I];break;default:Q.pipes.push(I)}Q.pipesCount+=1,h("pipe count=%d opts=%j",Q.pipesCount,N);var W=(!N||N.end!==!1)&&I!==s.stdout&&I!==s.stderr?Z:ae;function Y(fe,pe){h("onunpipe"),fe===j&&pe&&pe.hasUnpiped===!1&&(pe.hasUnpiped=!0,h("cleanup"),I.removeListener("close",ne),I.removeListener("finish",le),I.removeListener("drain",se),I.removeListener("error",ie),I.removeListener("unpipe",Y),j.removeListener("end",Z),j.removeListener("end",ae),j.removeListener("data",K),re=!0,!Q.awaitDrain||I._writableState&&!I._writableState.needDrain||se())}function Z(){h("onend"),I.end()}Q.endEmitted?s.nextTick(W):j.once("end",W),I.on("unpipe",Y);var se=(function(fe){return function(){var pe=fe._readableState;h("pipeOnDrain",pe.awaitDrain),pe.awaitDrain&&pe.awaitDrain--,pe.awaitDrain===0&&l(fe,"data")&&(pe.flowing=!0,H(fe))}})(j);I.on("drain",se);var re=!1;function K(fe){h("ondata");var pe=I.write(fe);h("dest.write",pe),pe===!1&&((Q.pipesCount===1&&Q.pipes===I||Q.pipesCount>1&&X(Q.pipes,I)!==-1)&&!re&&(h("false write response, pause",Q.awaitDrain),Q.awaitDrain++),j.pause())}function ie(fe){h("onerror",fe),ae(),I.removeListener("error",ie),l(I,"error")===0&&P(I,fe)}function ne(){I.removeListener("finish",le),ae()}function le(){h("onfinish"),I.removeListener("close",ne),ae()}function ae(){h("unpipe"),j.unpipe(I)}return j.on("data",K),(function(fe,pe,ye){if(typeof fe.prependListener=="function")return fe.prependListener(pe,ye);fe._events&&fe._events[pe]?Array.isArray(fe._events[pe])?fe._events[pe].unshift(ye):fe._events[pe]=[ye,fe._events[pe]]:fe.on(pe,ye)})(I,"error",ie),I.once("close",ne),I.once("finish",le),I.emit("pipe",j),Q.flowing||(h("pipe resume"),j.resume()),I},V.prototype.unpipe=function(I){var N=this._readableState,j={hasUnpiped:!1};if(N.pipesCount===0)return this;if(N.pipesCount===1)return I&&I!==N.pipes||(I||(I=N.pipes),N.pipes=null,N.pipesCount=0,N.flowing=!1,I&&I.emit("unpipe",this,j)),this;if(!I){var Q=N.pipes,W=N.pipesCount;N.pipes=null,N.pipesCount=0,N.flowing=!1;for(var Y=0;Y<W;Y++)Q[Y].emit("unpipe",this,{hasUnpiped:!1});return this}var Z=X(N.pipes,I);return Z===-1||(N.pipes.splice(Z,1),N.pipesCount-=1,N.pipesCount===1&&(N.pipes=N.pipes[0]),I.emit("unpipe",this,j)),this},V.prototype.on=function(I,N){var j=u.prototype.on.call(this,I,N),Q=this._readableState;return I==="data"?(Q.readableListening=this.listenerCount("readable")>0,Q.flowing!==!1&&this.resume()):I==="readable"&&(Q.endEmitted||Q.readableListening||(Q.readableListening=Q.needReadable=!0,Q.flowing=!1,Q.emittedReadable=!1,h("on readable",Q.length,Q.reading),Q.length?w(this):Q.reading||s.nextTick(F,this))),j},V.prototype.addListener=V.prototype.on,V.prototype.removeListener=function(I,N){var j=u.prototype.removeListener.call(this,I,N);return I==="readable"&&s.nextTick(C,this),j},V.prototype.removeAllListeners=function(I){var N=u.prototype.removeAllListeners.apply(this,arguments);return I!=="readable"&&I!==void 0||s.nextTick(C,this),N},V.prototype.resume=function(){var I=this._readableState;return I.flowing||(h("resume"),I.flowing=!I.readableListening,(function(N,j){j.resumeScheduled||(j.resumeScheduled=!0,s.nextTick(D,N,j))})(this,I)),I.paused=!1,this},V.prototype.pause=function(){return h("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(h("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},V.prototype.wrap=function(I){var N=this,j=this._readableState,Q=!1;for(var W in I.on("end",(function(){if(h("wrapped end"),j.decoder&&!j.ended){var Z=j.decoder.end();Z&&Z.length&&N.push(Z)}N.push(null)})),I.on("data",(function(Z){h("wrapped data"),j.decoder&&(Z=j.decoder.write(Z)),j.objectMode&&Z==null||(j.objectMode||Z&&Z.length)&&(N.push(Z)||(Q=!0,I.pause()))})),I)this[W]===void 0&&typeof I[W]=="function"&&(this[W]=(function(Z){return function(){return I[Z].apply(I,arguments)}})(W));for(var Y=0;Y<U.length;Y++)I.on(U[Y],this.emit.bind(this,U[Y]));return this._read=function(Z){h("wrapped _read",Z),Q&&(Q=!1,I.resume())},this},typeof Symbol=="function"&&(V.prototype[Symbol.asyncIterator]=function(){return p===void 0&&(p=t("./internal/streams/async_iterator")),p(this)}),Object.defineProperty(V.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(V.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(V.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(I){this._readableState&&(this._readableState.flowing=I)}}),V._fromList=G,Object.defineProperty(V.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(V.from=function(I,N){return g===void 0&&(g=t("./internal/streams/from")),g(V,I,N)})}).call(this)}).call(this,t("_process"),typeof Wt<"u"?Wt:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":477,"./_stream_duplex":478,"./internal/streams/async_iterator":483,"./internal/streams/buffer_list":484,"./internal/streams/destroy":485,"./internal/streams/from":487,"./internal/streams/state":489,"./internal/streams/stream":490,_process:467,buffer:220,events:422,inherits:440,"string_decoder/":522,util:188}],481:[function(t,n,i){n.exports=h;var s=t("../errors").codes,o=s.ERR_METHOD_NOT_IMPLEMENTED,a=s.ERR_MULTIPLE_CALLBACK,l=s.ERR_TRANSFORM_ALREADY_TRANSFORMING,u=s.ERR_TRANSFORM_WITH_LENGTH_0,c=t("./_stream_duplex");function d(p,g){var v=this._transformState;v.transforming=!1;var y=v.writecb;if(y===null)return this.emit("error",new a);v.writechunk=null,v.writecb=null,g!=null&&this.push(g),y(p);var b=this._readableState;b.reading=!1,(b.needReadable||b.length<b.highWaterMark)&&this._read(b.highWaterMark)}function h(p){if(!(this instanceof h))return new h(p);c.call(this,p),this._transformState={afterTransform:d.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,p&&(typeof p.transform=="function"&&(this._transform=p.transform),typeof p.flush=="function"&&(this._flush=p.flush)),this.on("prefinish",f)}function f(){var p=this;typeof this._flush!="function"||this._readableState.destroyed?m(this,null,null):this._flush((function(g,v){m(p,g,v)}))}function m(p,g,v){if(g)return p.emit("error",g);if(v!=null&&p.push(v),p._writableState.length)throw new u;if(p._transformState.transforming)throw new l;return p.push(null)}t("inherits")(h,c),h.prototype.push=function(p,g){return this._transformState.needTransform=!1,c.prototype.push.call(this,p,g)},h.prototype._transform=function(p,g,v){v(new o("_transform()"))},h.prototype._write=function(p,g,v){var y=this._transformState;if(y.writecb=v,y.writechunk=p,y.writeencoding=g,!y.transforming){var b=this._readableState;(y.needTransform||b.needReadable||b.length<b.highWaterMark)&&this._read(b.highWaterMark)}},h.prototype._read=function(p){var g=this._transformState;g.writechunk===null||g.transforming?g.needTransform=!0:(g.transforming=!0,this._transform(g.writechunk,g.writeencoding,g.afterTransform))},h.prototype._destroy=function(p,g){c.prototype._destroy.call(this,p,(function(v){g(v)}))}},{"../errors":477,"./_stream_duplex":478,inherits:440}],482:[function(t,n,i){(function(s,o){(function(){function a(S){var C=this;this.next=null,this.entry=null,this.finish=function(){(function(F,D,H){var G=F.entry;for(F.entry=null;G;){var ee=G.callback;D.pendingcb--,ee(H),G=G.next}D.corkedRequestsFree.next=F})(C,S)}}var l;n.exports=V,V.WritableState=$;var u={deprecate:t("util-deprecate")},c=t("./internal/streams/stream"),d=t("buffer").Buffer,h=(o!==void 0?o:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},f,m=t("./internal/streams/destroy"),p=t("./internal/streams/state").getHighWaterMark,g=t("../errors").codes,v=g.ERR_INVALID_ARG_TYPE,y=g.ERR_METHOD_NOT_IMPLEMENTED,b=g.ERR_MULTIPLE_CALLBACK,E=g.ERR_STREAM_CANNOT_PIPE,A=g.ERR_STREAM_DESTROYED,M=g.ERR_STREAM_NULL_VALUES,L=g.ERR_STREAM_WRITE_AFTER_END,k=g.ERR_UNKNOWN_ENCODING,P=m.errorOrDestroy;function U(){}function $(S,C,F){l=l||t("./_stream_duplex"),S=S||{},typeof F!="boolean"&&(F=C instanceof l),this.objectMode=!!S.objectMode,F&&(this.objectMode=this.objectMode||!!S.writableObjectMode),this.highWaterMark=p(this,S,"writableHighWaterMark",F),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var D=S.decodeStrings===!1;this.decodeStrings=!D,this.defaultEncoding=S.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(H){(function(G,ee){var B=G._writableState,X=B.sync,I=B.writecb;if(typeof I!="function")throw new b;if((function(j){j.writing=!1,j.writecb=null,j.length-=j.writelen,j.writelen=0})(B),ee)(function(j,Q,W,Y,Z){--Q.pendingcb,W?(s.nextTick(Z,Y),s.nextTick(_,j,Q),j._writableState.errorEmitted=!0,P(j,Y)):(Z(Y),j._writableState.errorEmitted=!0,P(j,Y),_(j,Q))})(G,B,X,ee,I);else{var N=w(B)||G.destroyed;N||B.corked||B.bufferProcessing||!B.bufferedRequest||T(G,B),X?s.nextTick(O,G,B,N,I):O(G,B,N,I)}})(C,H)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=S.emitClose!==!1,this.autoDestroy=!!S.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new a(this)}function V(S){var C=this instanceof(l=l||t("./_stream_duplex"));if(!C&&!f.call(V,this))return new V(S);this._writableState=new $(S,this,C),this.writable=!0,S&&(typeof S.write=="function"&&(this._write=S.write),typeof S.writev=="function"&&(this._writev=S.writev),typeof S.destroy=="function"&&(this._destroy=S.destroy),typeof S.final=="function"&&(this._final=S.final)),c.call(this)}function R(S,C,F,D,H,G,ee){C.writelen=D,C.writecb=ee,C.writing=!0,C.sync=!0,C.destroyed?C.onwrite(new A("write")):F?S._writev(H,C.onwrite):S._write(H,G,C.onwrite),C.sync=!1}function O(S,C,F,D){F||(function(H,G){G.length===0&&G.needDrain&&(G.needDrain=!1,H.emit("drain"))})(S,C),C.pendingcb--,D(),_(S,C)}function T(S,C){C.bufferProcessing=!0;var F=C.bufferedRequest;if(S._writev&&F&&F.next){var D=C.bufferedRequestCount,H=new Array(D),G=C.corkedRequestsFree;G.entry=F;for(var ee=0,B=!0;F;)H[ee]=F,F.isBuf||(B=!1),F=F.next,ee+=1;H.allBuffers=B,R(S,C,!0,C.length,H,"",G.finish),C.pendingcb++,C.lastBufferedRequest=null,G.next?(C.corkedRequestsFree=G.next,G.next=null):C.corkedRequestsFree=new a(C),C.bufferedRequestCount=0}else{for(;F;){var X=F.chunk,I=F.encoding,N=F.callback;if(R(S,C,!1,C.objectMode?1:X.length,X,I,N),F=F.next,C.bufferedRequestCount--,C.writing)break}F===null&&(C.lastBufferedRequest=null)}C.bufferedRequest=F,C.bufferProcessing=!1}function w(S){return S.ending&&S.length===0&&S.bufferedRequest===null&&!S.finished&&!S.writing}function x(S,C){S._final((function(F){C.pendingcb--,F&&P(S,F),C.prefinished=!0,S.emit("prefinish"),_(S,C)}))}function _(S,C){var F=w(C);if(F&&((function(H,G){G.prefinished||G.finalCalled||(typeof H._final!="function"||G.destroyed?(G.prefinished=!0,H.emit("prefinish")):(G.pendingcb++,G.finalCalled=!0,s.nextTick(x,H,G)))})(S,C),C.pendingcb===0&&(C.finished=!0,S.emit("finish"),C.autoDestroy))){var D=S._readableState;(!D||D.autoDestroy&&D.endEmitted)&&S.destroy()}return F}t("inherits")(V,c),$.prototype.getBuffer=function(){for(var S=this.bufferedRequest,C=[];S;)C.push(S),S=S.next;return C},(function(){try{Object.defineProperty($.prototype,"buffer",{get:u.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})(),typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(f=Function.prototype[Symbol.hasInstance],Object.defineProperty(V,Symbol.hasInstance,{value:function(S){return!!f.call(this,S)||this===V&&S&&S._writableState instanceof $}})):f=function(S){return S instanceof this},V.prototype.pipe=function(){P(this,new E)},V.prototype.write=function(S,C,F){var D,H=this._writableState,G=!1,ee=!H.objectMode&&(D=S,d.isBuffer(D)||D instanceof h);return ee&&!d.isBuffer(S)&&(S=(function(B){return d.from(B)})(S)),typeof C=="function"&&(F=C,C=null),ee?C="buffer":C||(C=H.defaultEncoding),typeof F!="function"&&(F=U),H.ending?(function(B,X){var I=new L;P(B,I),s.nextTick(X,I)})(this,F):(ee||(function(B,X,I,N){var j;return I===null?j=new M:typeof I=="string"||X.objectMode||(j=new v("chunk",["string","Buffer"],I)),!j||(P(B,j),s.nextTick(N,j),!1)})(this,H,S,F))&&(H.pendingcb++,G=(function(B,X,I,N,j,Q){if(!I){var W=(function(re,K,ie){return re.objectMode||re.decodeStrings===!1||typeof K!="string"||(K=d.from(K,ie)),K})(X,N,j);N!==W&&(I=!0,j="buffer",N=W)}var Y=X.objectMode?1:N.length;X.length+=Y;var Z=X.length<X.highWaterMark;if(Z||(X.needDrain=!0),X.writing||X.corked){var se=X.lastBufferedRequest;X.lastBufferedRequest={chunk:N,encoding:j,isBuf:I,callback:Q,next:null},se?se.next=X.lastBufferedRequest:X.bufferedRequest=X.lastBufferedRequest,X.bufferedRequestCount+=1}else R(B,X,!1,Y,N,j,Q);return Z})(this,H,ee,S,C,F)),G},V.prototype.cork=function(){this._writableState.corked++},V.prototype.uncork=function(){var S=this._writableState;S.corked&&(S.corked--,S.writing||S.corked||S.bufferProcessing||!S.bufferedRequest||T(this,S))},V.prototype.setDefaultEncoding=function(S){if(typeof S=="string"&&(S=S.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((S+"").toLowerCase())>-1))throw new k(S);return this._writableState.defaultEncoding=S,this},Object.defineProperty(V.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(V.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),V.prototype._write=function(S,C,F){F(new y("_write()"))},V.prototype._writev=null,V.prototype.end=function(S,C,F){var D=this._writableState;return typeof S=="function"?(F=S,S=null,C=null):typeof C=="function"&&(F=C,C=null),S!=null&&this.write(S,C),D.corked&&(D.corked=1,this.uncork()),D.ending||(function(H,G,ee){G.ending=!0,_(H,G),ee&&(G.finished?s.nextTick(ee):H.once("finish",ee)),G.ended=!0,H.writable=!1})(this,D,F),this},Object.defineProperty(V.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(V.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(S){this._writableState&&(this._writableState.destroyed=S)}}),V.prototype.destroy=m.destroy,V.prototype._undestroy=m.undestroy,V.prototype._destroy=function(S,C){C(S)}}).call(this)}).call(this,t("_process"),typeof Wt<"u"?Wt:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":477,"./_stream_duplex":478,"./internal/streams/destroy":485,"./internal/streams/state":489,"./internal/streams/stream":490,_process:467,buffer:220,inherits:440,"util-deprecate":524}],483:[function(t,n,i){(function(s){(function(){var o;function a(A,M,L){return(M=(function(k){var P=(function(U,$){if(typeof U!="object"||U===null)return U;var V=U[Symbol.toPrimitive];if(V!==void 0){var R=V.call(U,$);if(typeof R!="object")return R;throw new TypeError("@@toPrimitive must return a primitive value.")}return($==="string"?String:Number)(U)})(k,"string");return typeof P=="symbol"?P:String(P)})(M))in A?Object.defineProperty(A,M,{value:L,enumerable:!0,configurable:!0,writable:!0}):A[M]=L,A}var l=t("./end-of-stream"),u=Symbol("lastResolve"),c=Symbol("lastReject"),d=Symbol("error"),h=Symbol("ended"),f=Symbol("lastPromise"),m=Symbol("handlePromise"),p=Symbol("stream");function g(A,M){return{value:A,done:M}}function v(A){var M=A[u];if(M!==null){var L=A[p].read();L!==null&&(A[f]=null,A[u]=null,A[c]=null,M(g(L,!1)))}}function y(A){s.nextTick(v,A)}var b=Object.getPrototypeOf((function(){})),E=Object.setPrototypeOf((a(o={get stream(){return this[p]},next:function(){var A=this,M=this[d];if(M!==null)return Promise.reject(M);if(this[h])return Promise.resolve(g(void 0,!0));if(this[p].destroyed)return new Promise((function(U,$){s.nextTick((function(){A[d]?$(A[d]):U(g(void 0,!0))}))}));var L,k=this[f];if(k)L=new Promise((function(U,$){return function(V,R){U.then((function(){$[h]?V(g(void 0,!0)):$[m](V,R)}),R)}})(k,this));else{var P=this[p].read();if(P!==null)return Promise.resolve(g(P,!1));L=new Promise(this[m])}return this[f]=L,L}},Symbol.asyncIterator,(function(){return this})),a(o,"return",(function(){var A=this;return new Promise((function(M,L){A[p].destroy(null,(function(k){k?L(k):M(g(void 0,!0))}))}))})),o),b);n.exports=function(A){var M,L=Object.create(E,(a(M={},p,{value:A,writable:!0}),a(M,u,{value:null,writable:!0}),a(M,c,{value:null,writable:!0}),a(M,d,{value:null,writable:!0}),a(M,h,{value:A._readableState.endEmitted,writable:!0}),a(M,m,{value:function(k,P){var U=L[p].read();U?(L[f]=null,L[u]=null,L[c]=null,k(g(U,!1))):(L[u]=k,L[c]=P)},writable:!0}),M));return L[f]=null,l(A,(function(k){if(k&&k.code!=="ERR_STREAM_PREMATURE_CLOSE"){var P=L[c];return P!==null&&(L[f]=null,L[u]=null,L[c]=null,P(k)),void(L[d]=k)}var U=L[u];U!==null&&(L[f]=null,L[u]=null,L[c]=null,U(g(void 0,!0))),L[h]=!0})),A.on("readable",y.bind(null,L)),L}}).call(this)}).call(this,t("_process"))},{"./end-of-stream":486,_process:467}],484:[function(t,n,i){function s(f,m){var p=Object.keys(f);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(f);m&&(g=g.filter((function(v){return Object.getOwnPropertyDescriptor(f,v).enumerable}))),p.push.apply(p,g)}return p}function o(f){for(var m=1;m<arguments.length;m++){var p=arguments[m]!=null?arguments[m]:{};m%2?s(Object(p),!0).forEach((function(g){a(f,g,p[g])})):Object.getOwnPropertyDescriptors?Object.defineProperties(f,Object.getOwnPropertyDescriptors(p)):s(Object(p)).forEach((function(g){Object.defineProperty(f,g,Object.getOwnPropertyDescriptor(p,g))}))}return f}function a(f,m,p){return(m=u(m))in f?Object.defineProperty(f,m,{value:p,enumerable:!0,configurable:!0,writable:!0}):f[m]=p,f}function l(f,m){for(var p=0;p<m.length;p++){var g=m[p];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(f,u(g.key),g)}}function u(f){var m=(function(p,g){if(typeof p!="object"||p===null)return p;var v=p[Symbol.toPrimitive];if(v!==void 0){var y=v.call(p,g);if(typeof y!="object")return y;throw new TypeError("@@toPrimitive must return a primitive value.")}return(g==="string"?String:Number)(p)})(f,"string");return typeof m=="symbol"?m:String(m)}var c=t("buffer").Buffer,d=t("util").inspect,h=d&&d.custom||"inspect";n.exports=(function(){function f(){(function(g,v){if(!(g instanceof v))throw new TypeError("Cannot call a class as a function")})(this,f),this.head=null,this.tail=null,this.length=0}var m,p;return m=f,(p=[{key:"push",value:function(g){var v={data:g,next:null};this.length>0?this.tail.next=v:this.head=v,this.tail=v,++this.length}},{key:"unshift",value:function(g){var v={data:g,next:this.head};this.length===0&&(this.tail=v),this.head=v,++this.length}},{key:"shift",value:function(){if(this.length!==0){var g=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,g}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(g){if(this.length===0)return"";for(var v=this.head,y=""+v.data;v=v.next;)y+=g+v.data;return y}},{key:"concat",value:function(g){if(this.length===0)return c.alloc(0);for(var v,y,b,E=c.allocUnsafe(g>>>0),A=this.head,M=0;A;)v=A.data,y=E,b=M,c.prototype.copy.call(v,y,b),M+=A.data.length,A=A.next;return E}},{key:"consume",value:function(g,v){var y;return g<this.head.data.length?(y=this.head.data.slice(0,g),this.head.data=this.head.data.slice(g)):y=g===this.head.data.length?this.shift():v?this._getString(g):this._getBuffer(g),y}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(g){var v=this.head,y=1,b=v.data;for(g-=b.length;v=v.next;){var E=v.data,A=g>E.length?E.length:g;if(A===E.length?b+=E:b+=E.slice(0,g),(g-=A)==0){A===E.length?(++y,v.next?this.head=v.next:this.head=this.tail=null):(this.head=v,v.data=E.slice(A));break}++y}return this.length-=y,b}},{key:"_getBuffer",value:function(g){var v=c.allocUnsafe(g),y=this.head,b=1;for(y.data.copy(v),g-=y.data.length;y=y.next;){var E=y.data,A=g>E.length?E.length:g;if(E.copy(v,v.length-g,0,A),(g-=A)==0){A===E.length?(++b,y.next?this.head=y.next:this.head=this.tail=null):(this.head=y,y.data=E.slice(A));break}++b}return this.length-=b,v}},{key:h,value:function(g,v){return d(this,o(o({},v),{},{depth:0,customInspect:!1}))}}])&&l(m.prototype,p),Object.defineProperty(m,"prototype",{writable:!1}),f})()},{buffer:220,util:188}],485:[function(t,n,i){(function(s){(function(){function o(u,c){l(u,c),a(u)}function a(u){u._writableState&&!u._writableState.emitClose||u._readableState&&!u._readableState.emitClose||u.emit("close")}function l(u,c){u.emit("error",c)}n.exports={destroy:function(u,c){var d=this,h=this._readableState&&this._readableState.destroyed,f=this._writableState&&this._writableState.destroyed;return h||f?(c?c(u):u&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,s.nextTick(l,this,u)):s.nextTick(l,this,u)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(u||null,(function(m){!c&&m?d._writableState?d._writableState.errorEmitted?s.nextTick(a,d):(d._writableState.errorEmitted=!0,s.nextTick(o,d,m)):s.nextTick(o,d,m):c?(s.nextTick(a,d),c(m)):s.nextTick(a,d)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(u,c){var d=u._readableState,h=u._writableState;d&&d.autoDestroy||h&&h.autoDestroy?u.destroy(c):u.emit("error",c)}}}).call(this)}).call(this,t("_process"))},{_process:467}],486:[function(t,n,i){var s=t("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function o(){}n.exports=function a(l,u,c){if(typeof u=="function")return a(l,null,u);u||(u={}),c=(function(A){var M=!1;return function(){if(!M){M=!0;for(var L=arguments.length,k=new Array(L),P=0;P<L;P++)k[P]=arguments[P];A.apply(this,k)}}})(c||o);var d=u.readable||u.readable!==!1&&l.readable,h=u.writable||u.writable!==!1&&l.writable,f=function(){l.writable||p()},m=l._writableState&&l._writableState.finished,p=function(){h=!1,m=!0,d||c.call(l)},g=l._readableState&&l._readableState.endEmitted,v=function(){d=!1,g=!0,h||c.call(l)},y=function(A){c.call(l,A)},b=function(){var A;return d&&!g?(l._readableState&&l._readableState.ended||(A=new s),c.call(l,A)):h&&!m?(l._writableState&&l._writableState.ended||(A=new s),c.call(l,A)):void 0},E=function(){l.req.on("finish",p)};return(function(A){return A.setHeader&&typeof A.abort=="function"})(l)?(l.on("complete",p),l.on("abort",b),l.req?E():l.on("request",E)):h&&!l._writableState&&(l.on("end",f),l.on("close",f)),l.on("end",v),l.on("finish",p),u.error!==!1&&l.on("error",y),l.on("close",b),function(){l.removeListener("complete",p),l.removeListener("abort",b),l.removeListener("request",E),l.req&&l.req.removeListener("finish",p),l.removeListener("end",f),l.removeListener("close",f),l.removeListener("finish",p),l.removeListener("end",v),l.removeListener("error",y),l.removeListener("close",b)}}},{"../../../errors":477}],487:[function(t,n,i){n.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],488:[function(t,n,i){var s,o=t("../../../errors").codes,a=o.ERR_MISSING_ARGS,l=o.ERR_STREAM_DESTROYED;function u(m){if(m)throw m}function c(m,p,g,v){v=(function(E){var A=!1;return function(){A||(A=!0,E.apply(void 0,arguments))}})(v);var y=!1;m.on("close",(function(){y=!0})),s===void 0&&(s=t("./end-of-stream")),s(m,{readable:p,writable:g},(function(E){if(E)return v(E);y=!0,v()}));var b=!1;return function(E){if(!y&&!b)return b=!0,(function(A){return A.setHeader&&typeof A.abort=="function"})(m)?m.abort():typeof m.destroy=="function"?m.destroy():void v(E||new l("pipe"))}}function d(m){m()}function h(m,p){return m.pipe(p)}function f(m){return m.length?typeof m[m.length-1]!="function"?u:m.pop():u}n.exports=function(){for(var m=arguments.length,p=new Array(m),g=0;g<m;g++)p[g]=arguments[g];var v,y=f(p);if(Array.isArray(p[0])&&(p=p[0]),p.length<2)throw new a("streams");var b=p.map((function(E,A){var M=A<p.length-1;return c(E,M,A>0,(function(L){v||(v=L),L&&b.forEach(d),M||(b.forEach(d),y(v))}))}));return p.reduce(h)}},{"../../../errors":477,"./end-of-stream":486}],489:[function(t,n,i){var s=t("../../../errors").codes.ERR_INVALID_OPT_VALUE;n.exports={getHighWaterMark:function(o,a,l,u){var c=(function(d,h,f){return d.highWaterMark!=null?d.highWaterMark:h?d[f]:null})(a,u,l);if(c!=null){if(!isFinite(c)||Math.floor(c)!==c||c<0)throw new s(u?l:"highWaterMark",c);return Math.floor(c)}return o.objectMode?16:16384}}},{"../../../errors":477}],490:[function(t,n,i){n.exports=t("events").EventEmitter},{events:422}],491:[function(t,n,i){(i=n.exports=t("./lib/_stream_readable.js")).Stream=i,i.Readable=i,i.Writable=t("./lib/_stream_writable.js"),i.Duplex=t("./lib/_stream_duplex.js"),i.Transform=t("./lib/_stream_transform.js"),i.PassThrough=t("./lib/_stream_passthrough.js"),i.finished=t("./lib/internal/streams/end-of-stream.js"),i.pipeline=t("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":478,"./lib/_stream_passthrough.js":479,"./lib/_stream_readable.js":480,"./lib/_stream_transform.js":481,"./lib/_stream_writable.js":482,"./lib/internal/streams/end-of-stream.js":486,"./lib/internal/streams/pipeline.js":488}],492:[function(t,n,i){var s=(function(o){var a=Object.prototype,l=a.hasOwnProperty,u=Object.defineProperty||function(_,S,C){_[S]=C.value},c=typeof Symbol=="function"?Symbol:{},d=c.iterator||"@@iterator",h=c.asyncIterator||"@@asyncIterator",f=c.toStringTag||"@@toStringTag";function m(_,S,C){return Object.defineProperty(_,S,{value:C,enumerable:!0,configurable:!0,writable:!0}),_[S]}try{m({},"")}catch{m=function(S,C,F){return S[C]=F}}function p(_,S,C,F){var D=S&&S.prototype instanceof y?S:y,H=Object.create(D.prototype),G=new T(F||[]);return u(H,"_invoke",{value:$(_,C,G)}),H}function g(_,S,C){try{return{type:"normal",arg:_.call(S,C)}}catch(F){return{type:"throw",arg:F}}}o.wrap=p;var v={};function y(){}function b(){}function E(){}var A={};m(A,d,(function(){return this}));var M=Object.getPrototypeOf,L=M&&M(M(w([])));L&&L!==a&&l.call(L,d)&&(A=L);var k=E.prototype=y.prototype=Object.create(A);function P(_){["next","throw","return"].forEach((function(S){m(_,S,(function(C){return this._invoke(S,C)}))}))}function U(_,S){var C;u(this,"_invoke",{value:function(F,D){function H(){return new S((function(G,ee){(function B(X,I,N,j){var Q=g(_[X],_,I);if(Q.type!=="throw"){var W=Q.arg,Y=W.value;return Y&&typeof Y=="object"&&l.call(Y,"__await")?S.resolve(Y.__await).then((function(Z){B("next",Z,N,j)}),(function(Z){B("throw",Z,N,j)})):S.resolve(Y).then((function(Z){W.value=Z,N(W)}),(function(Z){return B("throw",Z,N,j)}))}j(Q.arg)})(F,D,G,ee)}))}return C=C?C.then(H,H):H()}})}function $(_,S,C){var F="suspendedStart";return function(D,H){if(F==="executing")throw new Error("Generator is already running");if(F==="completed"){if(D==="throw")throw H;return x()}for(C.method=D,C.arg=H;;){var G=C.delegate;if(G){var ee=V(G,C);if(ee){if(ee===v)continue;return ee}}if(C.method==="next")C.sent=C._sent=C.arg;else if(C.method==="throw"){if(F==="suspendedStart")throw F="completed",C.arg;C.dispatchException(C.arg)}else C.method==="return"&&C.abrupt("return",C.arg);F="executing";var B=g(_,S,C);if(B.type==="normal"){if(F=C.done?"completed":"suspendedYield",B.arg===v)continue;return{value:B.arg,done:C.done}}B.type==="throw"&&(F="completed",C.method="throw",C.arg=B.arg)}}}function V(_,S){var C=S.method,F=_.iterator[C];if(F===void 0)return S.delegate=null,C==="throw"&&_.iterator.return&&(S.method="return",S.arg=void 0,V(_,S),S.method==="throw")||C!=="return"&&(S.method="throw",S.arg=new TypeError("The iterator does not provide a '"+C+"' method")),v;var D=g(F,_.iterator,S.arg);if(D.type==="throw")return S.method="throw",S.arg=D.arg,S.delegate=null,v;var H=D.arg;return H?H.done?(S[_.resultName]=H.value,S.next=_.nextLoc,S.method!=="return"&&(S.method="next",S.arg=void 0),S.delegate=null,v):H:(S.method="throw",S.arg=new TypeError("iterator result is not an object"),S.delegate=null,v)}function R(_){var S={tryLoc:_[0]};1 in _&&(S.catchLoc=_[1]),2 in _&&(S.finallyLoc=_[2],S.afterLoc=_[3]),this.tryEntries.push(S)}function O(_){var S=_.completion||{};S.type="normal",delete S.arg,_.completion=S}function T(_){this.tryEntries=[{tryLoc:"root"}],_.forEach(R,this),this.reset(!0)}function w(_){if(_){var S=_[d];if(S)return S.call(_);if(typeof _.next=="function")return _;if(!isNaN(_.length)){var C=-1,F=function D(){for(;++C<_.length;)if(l.call(_,C))return D.value=_[C],D.done=!1,D;return D.value=void 0,D.done=!0,D};return F.next=F}}return{next:x}}function x(){return{value:void 0,done:!0}}return b.prototype=E,u(k,"constructor",{value:E,configurable:!0}),u(E,"constructor",{value:b,configurable:!0}),b.displayName=m(E,f,"GeneratorFunction"),o.isGeneratorFunction=function(_){var S=typeof _=="function"&&_.constructor;return!!S&&(S===b||(S.displayName||S.name)==="GeneratorFunction")},o.mark=function(_){return Object.setPrototypeOf?Object.setPrototypeOf(_,E):(_.__proto__=E,m(_,f,"GeneratorFunction")),_.prototype=Object.create(k),_},o.awrap=function(_){return{__await:_}},P(U.prototype),m(U.prototype,h,(function(){return this})),o.AsyncIterator=U,o.async=function(_,S,C,F,D){D===void 0&&(D=Promise);var H=new U(p(_,S,C,F),D);return o.isGeneratorFunction(S)?H:H.next().then((function(G){return G.done?G.value:H.next()}))},P(k),m(k,f,"Generator"),m(k,d,(function(){return this})),m(k,"toString",(function(){return"[object Generator]"})),o.keys=function(_){var S=Object(_),C=[];for(var F in S)C.push(F);return C.reverse(),function D(){for(;C.length;){var H=C.pop();if(H in S)return D.value=H,D.done=!1,D}return D.done=!0,D}},o.values=w,T.prototype={constructor:T,reset:function(_){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(O),!_)for(var S in this)S.charAt(0)==="t"&&l.call(this,S)&&!isNaN(+S.slice(1))&&(this[S]=void 0)},stop:function(){this.done=!0;var _=this.tryEntries[0].completion;if(_.type==="throw")throw _.arg;return this.rval},dispatchException:function(_){if(this.done)throw _;var S=this;function C(B,X){return H.type="throw",H.arg=_,S.next=B,X&&(S.method="next",S.arg=void 0),!!X}for(var F=this.tryEntries.length-1;F>=0;--F){var D=this.tryEntries[F],H=D.completion;if(D.tryLoc==="root")return C("end");if(D.tryLoc<=this.prev){var G=l.call(D,"catchLoc"),ee=l.call(D,"finallyLoc");if(G&&ee){if(this.prev<D.catchLoc)return C(D.catchLoc,!0);if(this.prev<D.finallyLoc)return C(D.finallyLoc)}else if(G){if(this.prev<D.catchLoc)return C(D.catchLoc,!0)}else{if(!ee)throw new Error("try statement without catch or finally");if(this.prev<D.finallyLoc)return C(D.finallyLoc)}}}},abrupt:function(_,S){for(var C=this.tryEntries.length-1;C>=0;--C){var F=this.tryEntries[C];if(F.tryLoc<=this.prev&&l.call(F,"finallyLoc")&&this.prev<F.finallyLoc){var D=F;break}}D&&(_==="break"||_==="continue")&&D.tryLoc<=S&&S<=D.finallyLoc&&(D=null);var H=D?D.completion:{};return H.type=_,H.arg=S,D?(this.method="next",this.next=D.finallyLoc,v):this.complete(H)},complete:function(_,S){if(_.type==="throw")throw _.arg;return _.type==="break"||_.type==="continue"?this.next=_.arg:_.type==="return"?(this.rval=this.arg=_.arg,this.method="return",this.next="end"):_.type==="normal"&&S&&(this.next=S),v},finish:function(_){for(var S=this.tryEntries.length-1;S>=0;--S){var C=this.tryEntries[S];if(C.finallyLoc===_)return this.complete(C.completion,C.afterLoc),O(C),v}},catch:function(_){for(var S=this.tryEntries.length-1;S>=0;--S){var C=this.tryEntries[S];if(C.tryLoc===_){var F=C.completion;if(F.type==="throw"){var D=F.arg;O(C)}return D}}throw new Error("illegal catch attempt")},delegateYield:function(_,S,C){return this.delegate={iterator:w(_),resultName:S,nextLoc:C},this.method==="next"&&(this.arg=void 0),v}},o})(typeof n=="object"?n.exports:{});try{regeneratorRuntime=s}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=s:Function("r","regeneratorRuntime = r")(s)}},{}],493:[function(t,n,i){var s=t("buffer").Buffer,o=t("inherits"),a=t("hash-base"),l=new Array(16),u=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],c=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],d=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],h=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],f=[0,1518500249,1859775393,2400959708,2840853838],m=[1352829926,1548603684,1836072691,2053994217,0];function p(){a.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520}function g(M,L){return M<<L|M>>>32-L}function v(M,L,k,P,U,$,V,R){return g(M+(L^k^P)+$+V|0,R)+U|0}function y(M,L,k,P,U,$,V,R){return g(M+(L&k|~L&P)+$+V|0,R)+U|0}function b(M,L,k,P,U,$,V,R){return g(M+((L|~k)^P)+$+V|0,R)+U|0}function E(M,L,k,P,U,$,V,R){return g(M+(L&P|k&~P)+$+V|0,R)+U|0}function A(M,L,k,P,U,$,V,R){return g(M+(L^(k|~P))+$+V|0,R)+U|0}o(p,a),p.prototype._update=function(){for(var M=l,L=0;L<16;++L)M[L]=this._block.readInt32LE(4*L);for(var k=0|this._a,P=0|this._b,U=0|this._c,$=0|this._d,V=0|this._e,R=0|this._a,O=0|this._b,T=0|this._c,w=0|this._d,x=0|this._e,_=0;_<80;_+=1){var S,C;_<16?(S=v(k,P,U,$,V,M[u[_]],f[0],d[_]),C=A(R,O,T,w,x,M[c[_]],m[0],h[_])):_<32?(S=y(k,P,U,$,V,M[u[_]],f[1],d[_]),C=E(R,O,T,w,x,M[c[_]],m[1],h[_])):_<48?(S=b(k,P,U,$,V,M[u[_]],f[2],d[_]),C=b(R,O,T,w,x,M[c[_]],m[2],h[_])):_<64?(S=E(k,P,U,$,V,M[u[_]],f[3],d[_]),C=y(R,O,T,w,x,M[c[_]],m[3],h[_])):(S=A(k,P,U,$,V,M[u[_]],f[4],d[_]),C=v(R,O,T,w,x,M[c[_]],m[4],h[_])),k=V,V=$,$=g(U,10),U=P,P=S,R=x,x=w,w=g(T,10),T=O,O=C}var F=this._b+U+w|0;this._b=this._c+$+x|0,this._c=this._d+V+R|0,this._d=this._e+k+O|0,this._e=this._a+P+T|0,this._a=F},p.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var M=s.alloc?s.alloc(20):new s(20);return M.writeInt32LE(this._a,0),M.writeInt32LE(this._b,4),M.writeInt32LE(this._c,8),M.writeInt32LE(this._d,12),M.writeInt32LE(this._e,16),M},n.exports=p},{buffer:220,"hash-base":425,inherits:440}],494:[function(t,n,i){var s=t("buffer"),o=s.Buffer;function a(u,c){for(var d in u)c[d]=u[d]}function l(u,c,d){return o(u,c,d)}o.from&&o.alloc&&o.allocUnsafe&&o.allocUnsafeSlow?n.exports=s:(a(s,i),i.Buffer=l),l.prototype=Object.create(o.prototype),a(o,l),l.from=function(u,c,d){if(typeof u=="number")throw new TypeError("Argument must not be a number");return o(u,c,d)},l.alloc=function(u,c,d){if(typeof u!="number")throw new TypeError("Argument must be a number");var h=o(u);return c!==void 0?typeof d=="string"?h.fill(c,d):h.fill(c):h.fill(0),h},l.allocUnsafe=function(u){if(typeof u!="number")throw new TypeError("Argument must be a number");return o(u)},l.allocUnsafeSlow=function(u){if(typeof u!="number")throw new TypeError("Argument must be a number");return s.SlowBuffer(u)}},{buffer:220}],495:[function(t,n,i){(function(s){(function(){var o,a=t("buffer"),l=a.Buffer,u={};for(o in a)a.hasOwnProperty(o)&&o!=="SlowBuffer"&&o!=="Buffer"&&(u[o]=a[o]);var c=u.Buffer={};for(o in l)l.hasOwnProperty(o)&&o!=="allocUnsafe"&&o!=="allocUnsafeSlow"&&(c[o]=l[o]);if(u.Buffer.prototype=l.prototype,c.from&&c.from!==Uint8Array.from||(c.from=function(d,h,f){if(typeof d=="number")throw new TypeError('The "value" argument must not be of type number. Received type '+typeof d);if(d&&d.length===void 0)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof d);return l(d,h,f)}),c.alloc||(c.alloc=function(d,h,f){if(typeof d!="number")throw new TypeError('The "size" argument must be of type number. Received type '+typeof d);if(d<0||d>=2*(1<<30))throw new RangeError('The value "'+d+'" is invalid for option "size"');var m=l(d);return h&&h.length!==0?typeof f=="string"?m.fill(h,f):m.fill(h):m.fill(0),m}),!u.kStringMaxLength)try{u.kStringMaxLength=s.binding("buffer").kStringMaxLength}catch{}u.constants||(u.constants={MAX_LENGTH:u.kMaxLength},u.kStringMaxLength&&(u.constants.MAX_STRING_LENGTH=u.kStringMaxLength)),n.exports=u}).call(this)}).call(this,t("_process"))},{_process:467,buffer:220}],496:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0});const s=t("xmlchars/xml/1.0/ed5"),o=t("xmlchars/xml/1.1/ed2"),a=t("xmlchars/xmlns/1.0/ed3");var l=s.isS,u=s.isChar,c=s.isNameStartChar,d=s.isNameChar,h=s.S_LIST,f=s.NAME_RE,m=o.isChar,p=a.isNCNameStartChar,g=a.isNCNameChar,v=a.NC_NAME_RE;const y="http://www.w3.org/XML/1998/namespace",b="http://www.w3.org/2000/xmlns/",E={__proto__:null,xml:y,xmlns:b},A={__proto__:null,amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},M=w=>w===34||w===39,L=[34,39],k=[...L,91,62],P=[...L,60,93],U=[61,63,...h],$=[...h,62,38,60];function V(w,x,_){switch(x){case"xml":_!==y&&w.fail(`xml prefix must be bound to ${y}.`);break;case"xmlns":_!==b&&w.fail(`xmlns prefix must be bound to ${b}.`)}switch(_){case b:w.fail(x===""?`the default namespace may not be set to ${_}.`:`may not assign a prefix (even "xmlns") to the URI ${b}.`);break;case y:switch(x){case"xml":break;case"":w.fail(`the default namespace may not be set to ${_}.`);break;default:w.fail("may not assign the xml namespace to another prefix.")}}}const R=w=>v.test(w),O=w=>f.test(w);i.EVENTS=["xmldecl","text","processinginstruction","doctype","comment","opentagstart","attribute","opentag","closetag","cdata","error","end","ready"];const T={xmldecl:"xmldeclHandler",text:"textHandler",processinginstruction:"piHandler",doctype:"doctypeHandler",comment:"commentHandler",opentagstart:"openTagStartHandler",attribute:"attributeHandler",opentag:"openTagHandler",closetag:"closeTagHandler",cdata:"cdataHandler",error:"errorHandler",end:"endHandler",ready:"readyHandler"};i.SaxesParser=class{constructor(w){this.opt=w??{},this.fragmentOpt=!!this.opt.fragment;const x=this.xmlnsOpt=!!this.opt.xmlns;if(this.trackPosition=this.opt.position!==!1,this.fileName=this.opt.fileName,x){this.nameStartCheck=p,this.nameCheck=g,this.isName=R,this.processAttribs=this.processAttribsNS,this.pushAttrib=this.pushAttribNS,this.ns=Object.assign({__proto__:null},E);const _=this.opt.additionalNamespaces;_!=null&&((function(S,C){for(const F of Object.keys(C))V(S,F,C[F])})(this,_),Object.assign(this.ns,_))}else this.nameStartCheck=c,this.nameCheck=d,this.isName=O,this.processAttribs=this.processAttribsPlain,this.pushAttrib=this.pushAttribPlain;this.stateTable=[this.sBegin,this.sBeginWhitespace,this.sDoctype,this.sDoctypeQuote,this.sDTD,this.sDTDQuoted,this.sDTDOpenWaka,this.sDTDOpenWakaBang,this.sDTDComment,this.sDTDCommentEnding,this.sDTDCommentEnded,this.sDTDPI,this.sDTDPIEnding,this.sText,this.sEntity,this.sOpenWaka,this.sOpenWakaBang,this.sComment,this.sCommentEnding,this.sCommentEnded,this.sCData,this.sCDataEnding,this.sCDataEnding2,this.sPIFirstChar,this.sPIRest,this.sPIBody,this.sPIEnding,this.sXMLDeclNameStart,this.sXMLDeclName,this.sXMLDeclEq,this.sXMLDeclValueStart,this.sXMLDeclValue,this.sXMLDeclSeparator,this.sXMLDeclEnding,this.sOpenTag,this.sOpenTagSlash,this.sAttrib,this.sAttribName,this.sAttribNameSawWhite,this.sAttribValue,this.sAttribValueQuoted,this.sAttribValueClosed,this.sAttribValueUnquoted,this.sCloseTag,this.sCloseTagSawWhite],this._init()}get closed(){return this._closed}_init(){var w;this.openWakaBang="",this.text="",this.name="",this.piTarget="",this.entity="",this.q=null,this.tags=[],this.tag=null,this.topNS=null,this.chunk="",this.chunkPosition=0,this.i=0,this.prevI=0,this.carriedFromPrevious=void 0,this.forbiddenState=0,this.attribList=[];const{fragmentOpt:x}=this;this.state=x?13:0,this.reportedTextBeforeRoot=this.reportedTextAfterRoot=this.closedRoot=this.sawRoot=x,this.xmlDeclPossible=!x,this.xmlDeclExpects=["version"],this.entityReturnState=void 0;let{defaultXMLVersion:_}=this.opt;if(_===void 0){if(this.opt.forceXMLVersion===!0)throw new Error("forceXMLVersion set but defaultXMLVersion is not set");_="1.0"}this.setXMLVersion(_),this.positionAtNewLine=0,this.doctype=!1,this._closed=!1,this.xmlDecl={version:void 0,encoding:void 0,standalone:void 0},this.line=1,this.column=0,this.ENTITIES=Object.create(A),(w=this.readyHandler)===null||w===void 0||w.call(this)}get position(){return this.chunkPosition+this.i}get columnIndex(){return this.position-this.positionAtNewLine}on(w,x){this[T[w]]=x}off(w){this[T[w]]=void 0}makeError(w){var x;let _=(x=this.fileName)!==null&&x!==void 0?x:"";return this.trackPosition&&(_.length>0&&(_+=":"),_+=`${this.line}:${this.column}`),_.length>0&&(_+=": "),new Error(_+w)}fail(w){const x=this.makeError(w),_=this.errorHandler;if(_===void 0)throw x;return _(x),this}write(w){if(this.closed)return this.fail("cannot write after close; assign an onready handler.");let x=!1;w===null?(x=!0,w=""):typeof w=="object"&&(w=w.toString()),this.carriedFromPrevious!==void 0&&(w=`${this.carriedFromPrevious}${w}`,this.carriedFromPrevious=void 0);let _=w.length;const S=w.charCodeAt(_-1);!x&&(S===13||S>=55296&&S<=56319)&&(this.carriedFromPrevious=w[_-1],_--,w=w.slice(0,_));const{stateTable:C}=this;for(this.chunk=w,this.i=0;this.i<_;)C[this.state].call(this);return this.chunkPosition+=_,x?this.end():this}close(){return this.write(null)}getCode10(){const{chunk:w,i:x}=this;if(this.prevI=x,this.i=x+1,x>=w.length)return-1;const _=w.charCodeAt(x);if(this.column++,_<55296){if(_>=32||_===9)return _;switch(_){case 10:return this.line++,this.column=0,this.positionAtNewLine=this.position,10;case 13:return w.charCodeAt(x+1)===10&&(this.i=x+2),this.line++,this.column=0,this.positionAtNewLine=this.position,-2;default:return this.fail("disallowed character."),_}}if(_>56319)return _>=57344&&_<=65533||this.fail("disallowed character."),_;const S=65536+1024*(_-55296)+(w.charCodeAt(x+1)-56320);return this.i=x+2,S>1114111&&this.fail("disallowed character."),S}getCode11(){const{chunk:w,i:x}=this;if(this.prevI=x,this.i=x+1,x>=w.length)return-1;const _=w.charCodeAt(x);if(this.column++,_<55296){if(_>31&&_<127||_>159&&_!==8232||_===9)return _;switch(_){case 10:return this.line++,this.column=0,this.positionAtNewLine=this.position,10;case 13:{const C=w.charCodeAt(x+1);C!==10&&C!==133||(this.i=x+2)}case 133:case 8232:return this.line++,this.column=0,this.positionAtNewLine=this.position,-2;default:return this.fail("disallowed character."),_}}if(_>56319)return _>=57344&&_<=65533||this.fail("disallowed character."),_;const S=65536+1024*(_-55296)+(w.charCodeAt(x+1)-56320);return this.i=x+2,S>1114111&&this.fail("disallowed character."),S}getCodeNorm(){const w=this.getCode();return w===-2?10:w}unget(){this.i=this.prevI,this.column--}captureTo(w){let{i:x}=this;const{chunk:_}=this;for(;;){const S=this.getCode(),C=S===-2,F=C?10:S;if(F===-1||w.includes(F))return this.text+=_.slice(x,this.prevI),F;C&&(this.text+=_.slice(x,this.prevI)+`
`,x=this.i)}}captureToChar(w){let{i:x}=this;const{chunk:_}=this;for(;;){let S=this.getCode();switch(S){case-2:this.text+=_.slice(x,this.prevI)+`
`,x=this.i,S=10;break;case-1:return this.text+=_.slice(x),!1}if(S===w)return this.text+=_.slice(x,this.prevI),!0}}captureNameChars(){const{chunk:w,i:x}=this;for(;;){const _=this.getCode();if(_===-1)return this.name+=w.slice(x),-1;if(!d(_))return this.name+=w.slice(x,this.prevI),_===-2?10:_}}skipSpaces(){for(;;){const w=this.getCodeNorm();if(w===-1||!l(w))return w}}setXMLVersion(w){this.currentXMLVersion=w,w==="1.0"?(this.isChar=u,this.getCode=this.getCode10):(this.isChar=m,this.getCode=this.getCode11)}sBegin(){this.chunk.charCodeAt(0)===65279&&(this.i++,this.column++),this.state=1}sBeginWhitespace(){const w=this.i,x=this.skipSpaces();switch(this.prevI!==w&&(this.xmlDeclPossible=!1),x){case 60:if(this.state=15,this.text.length!==0)throw new Error("no-empty text at start");break;case-1:break;default:this.unget(),this.state=13,this.xmlDeclPossible=!1}}sDoctype(){var w;const x=this.captureTo(k);switch(x){case 62:(w=this.doctypeHandler)===null||w===void 0||w.call(this,this.text),this.text="",this.state=13,this.doctype=!0;break;case-1:break;default:this.text+=String.fromCodePoint(x),x===91?this.state=4:M(x)&&(this.state=3,this.q=x)}}sDoctypeQuote(){const w=this.q;this.captureToChar(w)&&(this.text+=String.fromCodePoint(w),this.q=null,this.state=2)}sDTD(){const w=this.captureTo(P);w!==-1&&(this.text+=String.fromCodePoint(w),w===93?this.state=2:w===60?this.state=6:M(w)&&(this.state=5,this.q=w))}sDTDQuoted(){const w=this.q;this.captureToChar(w)&&(this.text+=String.fromCodePoint(w),this.state=4,this.q=null)}sDTDOpenWaka(){const w=this.getCodeNorm();switch(this.text+=String.fromCodePoint(w),w){case 33:this.state=7,this.openWakaBang="";break;case 63:this.state=11;break;default:this.state=4}}sDTDOpenWakaBang(){const w=String.fromCodePoint(this.getCodeNorm()),x=this.openWakaBang+=w;this.text+=w,x!=="-"&&(this.state=x==="--"?8:4,this.openWakaBang="")}sDTDComment(){this.captureToChar(45)&&(this.text+="-",this.state=9)}sDTDCommentEnding(){const w=this.getCodeNorm();this.text+=String.fromCodePoint(w),this.state=w===45?10:8}sDTDCommentEnded(){const w=this.getCodeNorm();this.text+=String.fromCodePoint(w),w===62?this.state=4:(this.fail("malformed comment."),this.state=8)}sDTDPI(){this.captureToChar(63)&&(this.text+="?",this.state=12)}sDTDPIEnding(){const w=this.getCodeNorm();this.text+=String.fromCodePoint(w),w===62&&(this.state=4)}sText(){this.tags.length!==0?this.handleTextInRoot():this.handleTextOutsideRoot()}sEntity(){let{i:w}=this;const{chunk:x}=this;e:for(;;)switch(this.getCode()){case-2:this.entity+=x.slice(w,this.prevI)+`
`,w=this.i;break;case 59:{const{entityReturnState:_}=this,S=this.entity+x.slice(w,this.prevI);let C;this.state=_,S===""?(this.fail("empty entity name."),C="&;"):(C=this.parseEntity(S),this.entity=""),_===13&&this.textHandler===void 0||(this.text+=C);break e}case-1:this.entity+=x.slice(w);break e}}sOpenWaka(){const w=this.getCode();if(c(w))this.state=34,this.unget(),this.xmlDeclPossible=!1;else switch(w){case 47:this.state=43,this.xmlDeclPossible=!1;break;case 33:this.state=16,this.openWakaBang="",this.xmlDeclPossible=!1;break;case 63:this.state=23;break;default:this.fail("disallowed character in tag name"),this.state=13,this.xmlDeclPossible=!1}}sOpenWakaBang(){switch(this.openWakaBang+=String.fromCodePoint(this.getCodeNorm()),this.openWakaBang){case"[CDATA[":this.sawRoot||this.reportedTextBeforeRoot||(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0),this.state=20,this.openWakaBang="";break;case"--":this.state=17,this.openWakaBang="";break;case"DOCTYPE":this.state=2,(this.doctype||this.sawRoot)&&this.fail("inappropriately located doctype declaration."),this.openWakaBang="";break;default:this.openWakaBang.length>=7&&this.fail("incorrect syntax.")}}sComment(){this.captureToChar(45)&&(this.state=18)}sCommentEnding(){var w;const x=this.getCodeNorm();x===45?(this.state=19,(w=this.commentHandler)===null||w===void 0||w.call(this,this.text),this.text=""):(this.text+="-"+String.fromCodePoint(x),this.state=17)}sCommentEnded(){const w=this.getCodeNorm();w!==62?(this.fail("malformed comment."),this.text+="--"+String.fromCodePoint(w),this.state=17):this.state=13}sCData(){this.captureToChar(93)&&(this.state=21)}sCDataEnding(){const w=this.getCodeNorm();w===93?this.state=22:(this.text+="]"+String.fromCodePoint(w),this.state=20)}sCDataEnding2(){var w;const x=this.getCodeNorm();switch(x){case 62:(w=this.cdataHandler)===null||w===void 0||w.call(this,this.text),this.text="",this.state=13;break;case 93:this.text+="]";break;default:this.text+="]]"+String.fromCodePoint(x),this.state=20}}sPIFirstChar(){const w=this.getCodeNorm();this.nameStartCheck(w)?(this.piTarget+=String.fromCodePoint(w),this.state=24):w===63||l(w)?(this.fail("processing instruction without a target."),this.state=w===63?26:25):(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(w),this.state=24)}sPIRest(){const{chunk:w,i:x}=this;for(;;){const _=this.getCodeNorm();if(_===-1)return void(this.piTarget+=w.slice(x));if(!this.nameCheck(_)){this.piTarget+=w.slice(x,this.prevI);const S=_===63;S||l(_)?this.piTarget==="xml"?(this.xmlDeclPossible||this.fail("an XML declaration must be at the start of the document."),this.state=S?33:27):this.state=S?26:25:(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(_));break}}}sPIBody(){if(this.text.length===0){const w=this.getCodeNorm();w===63?this.state=26:l(w)||(this.text=String.fromCodePoint(w))}else this.captureToChar(63)&&(this.state=26)}sPIEnding(){var w;const x=this.getCodeNorm();if(x===62){const{piTarget:_}=this;_.toLowerCase()==="xml"&&this.fail("the XML declaration must appear at the start of the document."),(w=this.piHandler)===null||w===void 0||w.call(this,{target:_,body:this.text}),this.piTarget=this.text="",this.state=13}else x===63?this.text+="?":(this.text+="?"+String.fromCodePoint(x),this.state=25);this.xmlDeclPossible=!1}sXMLDeclNameStart(){const w=this.skipSpaces();w!==63?w!==-1&&(this.state=28,this.name=String.fromCodePoint(w)):this.state=33}sXMLDeclName(){const w=this.captureTo(U);if(w===63)return this.state=33,this.name+=this.text,this.text="",void this.fail("XML declaration is incomplete.");if(l(w)||w===61){if(this.name+=this.text,this.text="",!this.xmlDeclExpects.includes(this.name))switch(this.name.length){case 0:this.fail("did not expect any more name/value pairs.");break;case 1:this.fail(`expected the name ${this.xmlDeclExpects[0]}.`);break;default:this.fail("expected one of "+this.xmlDeclExpects.join(", "))}this.state=w===61?30:29}}sXMLDeclEq(){const w=this.getCodeNorm();if(w===63)return this.state=33,void this.fail("XML declaration is incomplete.");l(w)||(w!==61&&this.fail("value required."),this.state=30)}sXMLDeclValueStart(){const w=this.getCodeNorm();if(w===63)return this.state=33,void this.fail("XML declaration is incomplete.");l(w)||(M(w)?this.q=w:(this.fail("value must be quoted."),this.q=32),this.state=31)}sXMLDeclValue(){const w=this.captureTo([this.q,63]);if(w===63)return this.state=33,this.text="",void this.fail("XML declaration is incomplete.");if(w===-1)return;const x=this.text;switch(this.text="",this.name){case"version":{this.xmlDeclExpects=["encoding","standalone"];const _=x;this.xmlDecl.version=_,/^1\.[0-9]+$/.test(_)?this.opt.forceXMLVersion||this.setXMLVersion(_):this.fail("version number must match /^1\\.[0-9]+$/.");break}case"encoding":/^[A-Za-z][A-Za-z0-9._-]*$/.test(x)||this.fail("encoding value must match /^[A-Za-z0-9][A-Za-z0-9._-]*$/."),this.xmlDeclExpects=["standalone"],this.xmlDecl.encoding=x;break;case"standalone":x!=="yes"&&x!=="no"&&this.fail('standalone value must match "yes" or "no".'),this.xmlDeclExpects=[],this.xmlDecl.standalone=x}this.name="",this.state=32}sXMLDeclSeparator(){const w=this.getCodeNorm();w!==63?(l(w)||(this.fail("whitespace required."),this.unget()),this.state=27):this.state=33}sXMLDeclEnding(){var w;this.getCodeNorm()===62?(this.piTarget!=="xml"?this.fail("processing instructions are not allowed before root."):this.name!=="version"&&this.xmlDeclExpects.includes("version")&&this.fail("XML declaration must contain a version."),(w=this.xmldeclHandler)===null||w===void 0||w.call(this,this.xmlDecl),this.name="",this.piTarget=this.text="",this.state=13):this.fail("The character ? is disallowed anywhere in XML declarations."),this.xmlDeclPossible=!1}sOpenTag(){var w;const x=this.captureNameChars();if(x===-1)return;const _=this.tag={name:this.name,attributes:Object.create(null)};switch(this.name="",this.xmlnsOpt&&(this.topNS=_.ns=Object.create(null)),(w=this.openTagStartHandler)===null||w===void 0||w.call(this,_),this.sawRoot=!0,!this.fragmentOpt&&this.closedRoot&&this.fail("documents may contain only one root."),x){case 62:this.openTag();break;case 47:this.state=35;break;default:l(x)||this.fail("disallowed character in tag name."),this.state=36}}sOpenTagSlash(){this.getCode()===62?this.openSelfClosingTag():(this.fail("forward-slash in opening tag not followed by >."),this.state=36)}sAttrib(){const w=this.skipSpaces();w!==-1&&(c(w)?(this.unget(),this.state=37):w===62?this.openTag():w===47?this.state=35:this.fail("disallowed character in attribute name."))}sAttribName(){const w=this.captureNameChars();w===61?this.state=39:l(w)?this.state=38:w===62?(this.fail("attribute without value."),this.pushAttrib(this.name,this.name),this.name=this.text="",this.openTag()):w!==-1&&this.fail("disallowed character in attribute name.")}sAttribNameSawWhite(){const w=this.skipSpaces();switch(w){case-1:return;case 61:this.state=39;break;default:this.fail("attribute without value."),this.text="",this.name="",w===62?this.openTag():c(w)?(this.unget(),this.state=37):(this.fail("disallowed character in attribute name."),this.state=36)}}sAttribValue(){const w=this.getCodeNorm();M(w)?(this.q=w,this.state=40):l(w)||(this.fail("unquoted attribute value."),this.state=42,this.unget())}sAttribValueQuoted(){const{q:w,chunk:x}=this;let{i:_}=this;for(;;)switch(this.getCode()){case w:return this.pushAttrib(this.name,this.text+x.slice(_,this.prevI)),this.name=this.text="",this.q=null,void(this.state=41);case 38:return this.text+=x.slice(_,this.prevI),this.state=14,void(this.entityReturnState=40);case 10:case-2:case 9:this.text+=x.slice(_,this.prevI)+" ",_=this.i;break;case 60:return this.text+=x.slice(_,this.prevI),void this.fail("disallowed character.");case-1:return void(this.text+=x.slice(_))}}sAttribValueClosed(){const w=this.getCodeNorm();l(w)?this.state=36:w===62?this.openTag():w===47?this.state=35:c(w)?(this.fail("no whitespace between attributes."),this.unget(),this.state=37):this.fail("disallowed character in attribute name.")}sAttribValueUnquoted(){const w=this.captureTo($);switch(w){case 38:this.state=14,this.entityReturnState=42;break;case 60:this.fail("disallowed character.");break;case-1:break;default:this.text.includes("]]>")&&this.fail('the string "]]>" is disallowed in char data.'),this.pushAttrib(this.name,this.text),this.name=this.text="",w===62?this.openTag():this.state=36}}sCloseTag(){const w=this.captureNameChars();w===62?this.closeTag():l(w)?this.state=44:w!==-1&&this.fail("disallowed character in closing tag.")}sCloseTagSawWhite(){switch(this.skipSpaces()){case 62:this.closeTag();break;case-1:break;default:this.fail("disallowed character in closing tag.")}}handleTextInRoot(){let{i:w,forbiddenState:x}=this;const{chunk:_,textHandler:S}=this;e:for(;;)switch(this.getCode()){case 60:if(this.state=15,S!==void 0){const{text:C}=this,F=_.slice(w,this.prevI);C.length!==0?(S(C+F),this.text=""):F.length!==0&&S(F)}x=0;break e;case 38:this.state=14,this.entityReturnState=13,S!==void 0&&(this.text+=_.slice(w,this.prevI)),x=0;break e;case 93:switch(x){case 0:x=1;break;case 1:x=2;break;case 2:break;default:throw new Error("impossible state")}break;case 62:x===2&&this.fail('the string "]]>" is disallowed in char data.'),x=0;break;case-2:S!==void 0&&(this.text+=_.slice(w,this.prevI)+`
`),w=this.i,x=0;break;case-1:S!==void 0&&(this.text+=_.slice(w));break e;default:x=0}this.forbiddenState=x}handleTextOutsideRoot(){let{i:w}=this;const{chunk:x,textHandler:_}=this;let S=!1;e:for(;;){const C=this.getCode();switch(C){case 60:if(this.state=15,_!==void 0){const{text:F}=this,D=x.slice(w,this.prevI);F.length!==0?(_(F+D),this.text=""):D.length!==0&&_(D)}break e;case 38:this.state=14,this.entityReturnState=13,_!==void 0&&(this.text+=x.slice(w,this.prevI)),S=!0;break e;case-2:_!==void 0&&(this.text+=x.slice(w,this.prevI)+`
`),w=this.i;break;case-1:_!==void 0&&(this.text+=x.slice(w));break e;default:l(C)||(S=!0)}}S&&(this.sawRoot||this.reportedTextBeforeRoot||(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0))}pushAttribNS(w,x){var _;const{prefix:S,local:C}=this.qname(w),F={name:w,prefix:S,local:C,value:x};if(this.attribList.push(F),(_=this.attributeHandler)===null||_===void 0||_.call(this,F),S==="xmlns"){const D=x.trim();this.currentXMLVersion==="1.0"&&D===""&&this.fail("invalid attempt to undefine prefix in XML 1.0"),this.topNS[C]=D,V(this,C,D)}else if(w==="xmlns"){const D=x.trim();this.topNS[""]=D,V(this,"",D)}}pushAttribPlain(w,x){var _;const S={name:w,value:x};this.attribList.push(S),(_=this.attributeHandler)===null||_===void 0||_.call(this,S)}end(){var w,x;this.sawRoot||this.fail("document must contain a root element.");const{tags:_}=this;for(;_.length>0;){const C=_.pop();this.fail("unclosed tag: "+C.name)}this.state!==0&&this.state!==13&&this.fail("unexpected end.");const{text:S}=this;return S.length!==0&&((w=this.textHandler)===null||w===void 0||w.call(this,S),this.text=""),this._closed=!0,(x=this.endHandler)===null||x===void 0||x.call(this),this._init(),this}resolve(w){var x,_;let S=this.topNS[w];if(S!==void 0)return S;const{tags:C}=this;for(let F=C.length-1;F>=0;F--)if(S=C[F].ns[w],S!==void 0)return S;return S=this.ns[w],S!==void 0?S:(_=(x=this.opt).resolvePrefix)===null||_===void 0?void 0:_.call(x,w)}qname(w){const x=w.indexOf(":");if(x===-1)return{prefix:"",local:w};const _=w.slice(x+1),S=w.slice(0,x);return(S===""||_===""||_.includes(":"))&&this.fail(`malformed name: ${w}.`),{prefix:S,local:_}}processAttribsNS(){var w;const{attribList:x}=this,_=this.tag;{const{prefix:F,local:D}=this.qname(_.name);_.prefix=F,_.local=D;const H=_.uri=(w=this.resolve(F))!==null&&w!==void 0?w:"";F!==""&&(F==="xmlns"&&this.fail('tags may not have "xmlns" as prefix.'),H===""&&(this.fail(`unbound namespace prefix: ${JSON.stringify(F)}.`),_.uri=F))}if(x.length===0)return;const{attributes:S}=_,C=new Set;for(const F of x){const{name:D,prefix:H,local:G}=F;let ee,B;H===""?(ee=D==="xmlns"?b:"",B=D):(ee=this.resolve(H),ee===void 0&&(this.fail(`unbound namespace prefix: ${JSON.stringify(H)}.`),ee=H),B=`{${ee}}${G}`),C.has(B)&&this.fail(`duplicate attribute: ${B}.`),C.add(B),F.uri=ee,S[D]=F}this.attribList=[]}processAttribsPlain(){const{attribList:w}=this,x=this.tag.attributes;for(const{name:_,value:S}of w)x[_]!==void 0&&this.fail(`duplicate attribute: ${_}.`),x[_]=S;this.attribList=[]}openTag(){var w;this.processAttribs();const{tags:x}=this,_=this.tag;_.isSelfClosing=!1,(w=this.openTagHandler)===null||w===void 0||w.call(this,_),x.push(_),this.state=13,this.name=""}openSelfClosingTag(){var w,x,_;this.processAttribs();const{tags:S}=this,C=this.tag;C.isSelfClosing=!0,(w=this.openTagHandler)===null||w===void 0||w.call(this,C),(x=this.closeTagHandler)===null||x===void 0||x.call(this,C),(this.tag=(_=S[S.length-1])!==null&&_!==void 0?_:null)===null&&(this.closedRoot=!0),this.state=13,this.name=""}closeTag(){const{tags:w,name:x}=this;if(this.state=13,this.name="",x==="")return this.fail("weird empty close tag."),void(this.text+="</>");const _=this.closeTagHandler;let S=w.length;for(;S-- >0;){const C=this.tag=w.pop();if(this.topNS=C.ns,_?.(C),C.name===x)break;this.fail("unexpected close tag.")}S===0?this.closedRoot=!0:S<0&&(this.fail(`unmatched closing tag: ${x}.`),this.text+=`</${x}>`)}parseEntity(w){if(w[0]!=="#"){const _=this.ENTITIES[w];return _!==void 0?_:(this.fail(this.isName(w)?"undefined entity.":"disallowed character in entity name."),`&${w};`)}let x=NaN;return w[1]==="x"&&/^#x[0-9a-f]+$/i.test(w)?x=parseInt(w.slice(2),16):/^#[0-9]+$/.test(w)&&(x=parseInt(w.slice(1),10)),this.isChar(x)?String.fromCodePoint(x):(this.fail("malformed character entity."),`&${w};`)}}},{"xmlchars/xml/1.0/ed5":543,"xmlchars/xml/1.1/ed2":544,"xmlchars/xmlns/1.0/ed3":545}],497:[function(t,n,i){var s=t("safe-buffer").Buffer;function o(a,l){this._block=s.alloc(a),this._finalSize=l,this._blockSize=a,this._len=0}o.prototype.update=function(a,l){typeof a=="string"&&(l=l||"utf8",a=s.from(a,l));for(var u=this._block,c=this._blockSize,d=a.length,h=this._len,f=0;f<d;){for(var m=h%c,p=Math.min(d-f,c-m),g=0;g<p;g++)u[m+g]=a[f+g];f+=p,(h+=p)%c==0&&this._update(u)}return this._len+=d,this},o.prototype.digest=function(a){var l=this._len%this._blockSize;this._block[l]=128,this._block.fill(0,l+1),l>=this._finalSize&&(this._update(this._block),this._block.fill(0));var u=8*this._len;if(u<=4294967295)this._block.writeUInt32BE(u,this._blockSize-4);else{var c=(4294967295&u)>>>0,d=(u-c)/4294967296;this._block.writeUInt32BE(d,this._blockSize-8),this._block.writeUInt32BE(c,this._blockSize-4)}this._update(this._block);var h=this._hash();return a?h.toString(a):h},o.prototype._update=function(){throw new Error("_update must be implemented by subclass")},n.exports=o},{"safe-buffer":494}],498:[function(t,n,i){var s=n.exports=function(o){o=o.toLowerCase();var a=s[o];if(!a)throw new Error(o+" is not supported (we accept pull requests)");return new a};s.sha=t("./sha"),s.sha1=t("./sha1"),s.sha224=t("./sha224"),s.sha256=t("./sha256"),s.sha384=t("./sha384"),s.sha512=t("./sha512")},{"./sha":499,"./sha1":500,"./sha224":501,"./sha256":502,"./sha384":503,"./sha512":504}],499:[function(t,n,i){var s=t("inherits"),o=t("./hash"),a=t("safe-buffer").Buffer,l=[1518500249,1859775393,-1894007588,-899497514],u=new Array(80);function c(){this.init(),this._w=u,o.call(this,64,56)}function d(f){return f<<30|f>>>2}function h(f,m,p,g){return f===0?m&p|~m&g:f===2?m&p|m&g|p&g:m^p^g}s(c,o),c.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},c.prototype._update=function(f){for(var m,p=this._w,g=0|this._a,v=0|this._b,y=0|this._c,b=0|this._d,E=0|this._e,A=0;A<16;++A)p[A]=f.readInt32BE(4*A);for(;A<80;++A)p[A]=p[A-3]^p[A-8]^p[A-14]^p[A-16];for(var M=0;M<80;++M){var L=~~(M/20),k=0|((m=g)<<5|m>>>27)+h(L,v,y,b)+E+p[M]+l[L];E=b,b=y,y=d(v),v=g,g=k}this._a=g+this._a|0,this._b=v+this._b|0,this._c=y+this._c|0,this._d=b+this._d|0,this._e=E+this._e|0},c.prototype._hash=function(){var f=a.allocUnsafe(20);return f.writeInt32BE(0|this._a,0),f.writeInt32BE(0|this._b,4),f.writeInt32BE(0|this._c,8),f.writeInt32BE(0|this._d,12),f.writeInt32BE(0|this._e,16),f},n.exports=c},{"./hash":497,inherits:440,"safe-buffer":494}],500:[function(t,n,i){var s=t("inherits"),o=t("./hash"),a=t("safe-buffer").Buffer,l=[1518500249,1859775393,-1894007588,-899497514],u=new Array(80);function c(){this.init(),this._w=u,o.call(this,64,56)}function d(m){return m<<5|m>>>27}function h(m){return m<<30|m>>>2}function f(m,p,g,v){return m===0?p&g|~p&v:m===2?p&g|p&v|g&v:p^g^v}s(c,o),c.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},c.prototype._update=function(m){for(var p,g=this._w,v=0|this._a,y=0|this._b,b=0|this._c,E=0|this._d,A=0|this._e,M=0;M<16;++M)g[M]=m.readInt32BE(4*M);for(;M<80;++M)g[M]=(p=g[M-3]^g[M-8]^g[M-14]^g[M-16])<<1|p>>>31;for(var L=0;L<80;++L){var k=~~(L/20),P=d(v)+f(k,y,b,E)+A+g[L]+l[k]|0;A=E,E=b,b=h(y),y=v,v=P}this._a=v+this._a|0,this._b=y+this._b|0,this._c=b+this._c|0,this._d=E+this._d|0,this._e=A+this._e|0},c.prototype._hash=function(){var m=a.allocUnsafe(20);return m.writeInt32BE(0|this._a,0),m.writeInt32BE(0|this._b,4),m.writeInt32BE(0|this._c,8),m.writeInt32BE(0|this._d,12),m.writeInt32BE(0|this._e,16),m},n.exports=c},{"./hash":497,inherits:440,"safe-buffer":494}],501:[function(t,n,i){var s=t("inherits"),o=t("./sha256"),a=t("./hash"),l=t("safe-buffer").Buffer,u=new Array(64);function c(){this.init(),this._w=u,a.call(this,64,56)}s(c,o),c.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},c.prototype._hash=function(){var d=l.allocUnsafe(28);return d.writeInt32BE(this._a,0),d.writeInt32BE(this._b,4),d.writeInt32BE(this._c,8),d.writeInt32BE(this._d,12),d.writeInt32BE(this._e,16),d.writeInt32BE(this._f,20),d.writeInt32BE(this._g,24),d},n.exports=c},{"./hash":497,"./sha256":502,inherits:440,"safe-buffer":494}],502:[function(t,n,i){var s=t("inherits"),o=t("./hash"),a=t("safe-buffer").Buffer,l=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],u=new Array(64);function c(){this.init(),this._w=u,o.call(this,64,56)}function d(g,v,y){return y^g&(v^y)}function h(g,v,y){return g&v|y&(g|v)}function f(g){return(g>>>2|g<<30)^(g>>>13|g<<19)^(g>>>22|g<<10)}function m(g){return(g>>>6|g<<26)^(g>>>11|g<<21)^(g>>>25|g<<7)}function p(g){return(g>>>7|g<<25)^(g>>>18|g<<14)^g>>>3}s(c,o),c.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},c.prototype._update=function(g){for(var v,y=this._w,b=0|this._a,E=0|this._b,A=0|this._c,M=0|this._d,L=0|this._e,k=0|this._f,P=0|this._g,U=0|this._h,$=0;$<16;++$)y[$]=g.readInt32BE(4*$);for(;$<64;++$)y[$]=0|(((v=y[$-2])>>>17|v<<15)^(v>>>19|v<<13)^v>>>10)+y[$-7]+p(y[$-15])+y[$-16];for(var V=0;V<64;++V){var R=U+m(L)+d(L,k,P)+l[V]+y[V]|0,O=f(b)+h(b,E,A)|0;U=P,P=k,k=L,L=M+R|0,M=A,A=E,E=b,b=R+O|0}this._a=b+this._a|0,this._b=E+this._b|0,this._c=A+this._c|0,this._d=M+this._d|0,this._e=L+this._e|0,this._f=k+this._f|0,this._g=P+this._g|0,this._h=U+this._h|0},c.prototype._hash=function(){var g=a.allocUnsafe(32);return g.writeInt32BE(this._a,0),g.writeInt32BE(this._b,4),g.writeInt32BE(this._c,8),g.writeInt32BE(this._d,12),g.writeInt32BE(this._e,16),g.writeInt32BE(this._f,20),g.writeInt32BE(this._g,24),g.writeInt32BE(this._h,28),g},n.exports=c},{"./hash":497,inherits:440,"safe-buffer":494}],503:[function(t,n,i){var s=t("inherits"),o=t("./sha512"),a=t("./hash"),l=t("safe-buffer").Buffer,u=new Array(160);function c(){this.init(),this._w=u,a.call(this,128,112)}s(c,o),c.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},c.prototype._hash=function(){var d=l.allocUnsafe(48);function h(f,m,p){d.writeInt32BE(f,p),d.writeInt32BE(m,p+4)}return h(this._ah,this._al,0),h(this._bh,this._bl,8),h(this._ch,this._cl,16),h(this._dh,this._dl,24),h(this._eh,this._el,32),h(this._fh,this._fl,40),d},n.exports=c},{"./hash":497,"./sha512":504,inherits:440,"safe-buffer":494}],504:[function(t,n,i){var s=t("inherits"),o=t("./hash"),a=t("safe-buffer").Buffer,l=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],u=new Array(160);function c(){this.init(),this._w=u,o.call(this,128,112)}function d(E,A,M){return M^E&(A^M)}function h(E,A,M){return E&A|M&(E|A)}function f(E,A){return(E>>>28|A<<4)^(A>>>2|E<<30)^(A>>>7|E<<25)}function m(E,A){return(E>>>14|A<<18)^(E>>>18|A<<14)^(A>>>9|E<<23)}function p(E,A){return(E>>>1|A<<31)^(E>>>8|A<<24)^E>>>7}function g(E,A){return(E>>>1|A<<31)^(E>>>8|A<<24)^(E>>>7|A<<25)}function v(E,A){return(E>>>19|A<<13)^(A>>>29|E<<3)^E>>>6}function y(E,A){return(E>>>19|A<<13)^(A>>>29|E<<3)^(E>>>6|A<<26)}function b(E,A){return E>>>0<A>>>0?1:0}s(c,o),c.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},c.prototype._update=function(E){for(var A=this._w,M=0|this._ah,L=0|this._bh,k=0|this._ch,P=0|this._dh,U=0|this._eh,$=0|this._fh,V=0|this._gh,R=0|this._hh,O=0|this._al,T=0|this._bl,w=0|this._cl,x=0|this._dl,_=0|this._el,S=0|this._fl,C=0|this._gl,F=0|this._hl,D=0;D<32;D+=2)A[D]=E.readInt32BE(4*D),A[D+1]=E.readInt32BE(4*D+4);for(;D<160;D+=2){var H=A[D-30],G=A[D-30+1],ee=p(H,G),B=g(G,H),X=v(H=A[D-4],G=A[D-4+1]),I=y(G,H),N=A[D-14],j=A[D-14+1],Q=A[D-32],W=A[D-32+1],Y=B+j|0,Z=ee+N+b(Y,B)|0;Z=(Z=Z+X+b(Y=Y+I|0,I)|0)+Q+b(Y=Y+W|0,W)|0,A[D]=Z,A[D+1]=Y}for(var se=0;se<160;se+=2){Z=A[se],Y=A[se+1];var re=h(M,L,k),K=h(O,T,w),ie=f(M,O),ne=f(O,M),le=m(U,_),ae=m(_,U),fe=l[se],pe=l[se+1],ye=d(U,$,V),xe=d(_,S,C),Ne=F+ae|0,Oe=R+le+b(Ne,F)|0;Oe=(Oe=(Oe=Oe+ye+b(Ne=Ne+xe|0,xe)|0)+fe+b(Ne=Ne+pe|0,pe)|0)+Z+b(Ne=Ne+Y|0,Y)|0;var Me=ne+K|0,qe=ie+re+b(Me,ne)|0;R=V,F=C,V=$,C=S,$=U,S=_,U=P+Oe+b(_=x+Ne|0,x)|0,P=k,x=w,k=L,w=T,L=M,T=O,M=Oe+qe+b(O=Ne+Me|0,Ne)|0}this._al=this._al+O|0,this._bl=this._bl+T|0,this._cl=this._cl+w|0,this._dl=this._dl+x|0,this._el=this._el+_|0,this._fl=this._fl+S|0,this._gl=this._gl+C|0,this._hl=this._hl+F|0,this._ah=this._ah+M+b(this._al,O)|0,this._bh=this._bh+L+b(this._bl,T)|0,this._ch=this._ch+k+b(this._cl,w)|0,this._dh=this._dh+P+b(this._dl,x)|0,this._eh=this._eh+U+b(this._el,_)|0,this._fh=this._fh+$+b(this._fl,S)|0,this._gh=this._gh+V+b(this._gl,C)|0,this._hh=this._hh+R+b(this._hl,F)|0},c.prototype._hash=function(){var E=a.allocUnsafe(64);function A(M,L,k){E.writeInt32BE(M,k),E.writeInt32BE(L,k+4)}return A(this._ah,this._al,0),A(this._bh,this._bl,8),A(this._ch,this._cl,16),A(this._dh,this._dl,24),A(this._eh,this._el,32),A(this._fh,this._fl,40),A(this._gh,this._gl,48),A(this._hh,this._hl,56),E},n.exports=c},{"./hash":497,inherits:440,"safe-buffer":494}],505:[function(t,n,i){n.exports=o;var s=t("events").EventEmitter;function o(){s.call(this)}t("inherits")(o,s),o.Readable=t("readable-stream/readable.js"),o.Writable=t("readable-stream/writable.js"),o.Duplex=t("readable-stream/duplex.js"),o.Transform=t("readable-stream/transform.js"),o.PassThrough=t("readable-stream/passthrough.js"),o.Stream=o,o.prototype.pipe=function(a,l){var u=this;function c(v){a.writable&&a.write(v)===!1&&u.pause&&u.pause()}function d(){u.readable&&u.resume&&u.resume()}u.on("data",c),a.on("drain",d),a._isStdio||l&&l.end===!1||(u.on("end",f),u.on("close",m));var h=!1;function f(){h||(h=!0,a.end())}function m(){h||(h=!0,typeof a.destroy=="function"&&a.destroy())}function p(v){if(g(),s.listenerCount(this,"error")===0)throw v}function g(){u.removeListener("data",c),a.removeListener("drain",d),u.removeListener("end",f),u.removeListener("close",m),u.removeListener("error",p),a.removeListener("error",p),u.removeListener("end",g),u.removeListener("close",g),a.removeListener("close",g)}return u.on("error",p),a.on("error",p),u.on("end",g),u.on("close",g),a.on("close",g),a.emit("pipe",u),a}},{events:422,inherits:440,"readable-stream/duplex.js":507,"readable-stream/passthrough.js":516,"readable-stream/readable.js":517,"readable-stream/transform.js":518,"readable-stream/writable.js":519}],506:[function(t,n,i){var s={}.toString;n.exports=Array.isArray||function(o){return s.call(o)=="[object Array]"}},{}],507:[function(t,n,i){n.exports=t("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":508}],508:[function(t,n,i){var s=t("process-nextick-args"),o=Object.keys||function(g){var v=[];for(var y in g)v.push(y);return v};n.exports=f;var a=Object.create(t("core-util-is"));a.inherits=t("inherits");var l=t("./_stream_readable"),u=t("./_stream_writable");a.inherits(f,l);for(var c=o(u.prototype),d=0;d<c.length;d++){var h=c[d];f.prototype[h]||(f.prototype[h]=u.prototype[h])}function f(g){if(!(this instanceof f))return new f(g);l.call(this,g),u.call(this,g),g&&g.readable===!1&&(this.readable=!1),g&&g.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,g&&g.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",m)}function m(){this.allowHalfOpen||this._writableState.ended||s.nextTick(p,this)}function p(g){g.end()}Object.defineProperty(f.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(f.prototype,"destroyed",{get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(g){this._readableState!==void 0&&this._writableState!==void 0&&(this._readableState.destroyed=g,this._writableState.destroyed=g)}}),f.prototype._destroy=function(g,v){this.push(null),this.end(),s.nextTick(v,g)}},{"./_stream_readable":510,"./_stream_writable":512,"core-util-is":383,inherits:440,"process-nextick-args":466}],509:[function(t,n,i){n.exports=a;var s=t("./_stream_transform"),o=Object.create(t("core-util-is"));function a(l){if(!(this instanceof a))return new a(l);s.call(this,l)}o.inherits=t("inherits"),o.inherits(a,s),a.prototype._transform=function(l,u,c){c(null,l)}},{"./_stream_transform":511,"core-util-is":383,inherits:440}],510:[function(t,n,i){(function(s,o){(function(){var a=t("process-nextick-args");n.exports=M;var l,u=t("isarray");M.ReadableState=A,t("events").EventEmitter;var c=function(F,D){return F.listeners(D).length},d=t("./internal/streams/stream"),h=t("safe-buffer").Buffer,f=(o!==void 0?o:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},m=Object.create(t("core-util-is"));m.inherits=t("inherits");var p=t("util"),g=void 0;g=p&&p.debuglog?p.debuglog("stream"):function(){};var v,y=t("./internal/streams/BufferList"),b=t("./internal/streams/destroy");m.inherits(M,d);var E=["error","close","destroy","pause","resume"];function A(F,D){F=F||{};var H=D instanceof(l=l||t("./_stream_duplex"));this.objectMode=!!F.objectMode,H&&(this.objectMode=this.objectMode||!!F.readableObjectMode);var G=F.highWaterMark,ee=F.readableHighWaterMark,B=this.objectMode?16:16384;this.highWaterMark=G||G===0?G:H&&(ee||ee===0)?ee:B,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new y,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=F.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,F.encoding&&(v||(v=t("string_decoder/").StringDecoder),this.decoder=new v(F.encoding),this.encoding=F.encoding)}function M(F){if(l=l||t("./_stream_duplex"),!(this instanceof M))return new M(F);this._readableState=new A(F,this),this.readable=!0,F&&(typeof F.read=="function"&&(this._read=F.read),typeof F.destroy=="function"&&(this._destroy=F.destroy)),d.call(this)}function L(F,D,H,G,ee){var B,X=F._readableState;return D===null?(X.reading=!1,(function(I,N){if(!N.ended){if(N.decoder){var j=N.decoder.end();j&&j.length&&(N.buffer.push(j),N.length+=N.objectMode?1:j.length)}N.ended=!0,U(I)}})(F,X)):(ee||(B=(function(I,N){var j;Q=N,h.isBuffer(Q)||Q instanceof f||typeof N=="string"||N===void 0||I.objectMode||(j=new TypeError("Invalid non-string/buffer chunk"));var Q;return j})(X,D)),B?F.emit("error",B):X.objectMode||D&&D.length>0?(typeof D=="string"||X.objectMode||Object.getPrototypeOf(D)===h.prototype||(D=(function(I){return h.from(I)})(D)),G?X.endEmitted?F.emit("error",new Error("stream.unshift() after end event")):k(F,X,D,!0):X.ended?F.emit("error",new Error("stream.push() after EOF")):(X.reading=!1,X.decoder&&!H?(D=X.decoder.write(D),X.objectMode||D.length!==0?k(F,X,D,!1):V(F,X)):k(F,X,D,!1))):G||(X.reading=!1)),(function(I){return!I.ended&&(I.needReadable||I.length<I.highWaterMark||I.length===0)})(X)}function k(F,D,H,G){D.flowing&&D.length===0&&!D.sync?(F.emit("data",H),F.read(0)):(D.length+=D.objectMode?1:H.length,G?D.buffer.unshift(H):D.buffer.push(H),D.needReadable&&U(F)),V(F,D)}Object.defineProperty(M.prototype,"destroyed",{get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(F){this._readableState&&(this._readableState.destroyed=F)}}),M.prototype.destroy=b.destroy,M.prototype._undestroy=b.undestroy,M.prototype._destroy=function(F,D){this.push(null),D(F)},M.prototype.push=function(F,D){var H,G=this._readableState;return G.objectMode?H=!0:typeof F=="string"&&((D=D||G.defaultEncoding)!==G.encoding&&(F=h.from(F,D),D=""),H=!0),L(this,F,D,!1,H)},M.prototype.unshift=function(F){return L(this,F,null,!0,!1)},M.prototype.isPaused=function(){return this._readableState.flowing===!1},M.prototype.setEncoding=function(F){return v||(v=t("string_decoder/").StringDecoder),this._readableState.decoder=new v(F),this._readableState.encoding=F,this};function P(F,D){return F<=0||D.length===0&&D.ended?0:D.objectMode?1:F!=F?D.flowing&&D.length?D.buffer.head.data.length:D.length:(F>D.highWaterMark&&(D.highWaterMark=(function(H){return H>=8388608?H=8388608:(H--,H|=H>>>1,H|=H>>>2,H|=H>>>4,H|=H>>>8,H|=H>>>16,H++),H})(F)),F<=D.length?F:D.ended?D.length:(D.needReadable=!0,0))}function U(F){var D=F._readableState;D.needReadable=!1,D.emittedReadable||(g("emitReadable",D.flowing),D.emittedReadable=!0,D.sync?a.nextTick($,F):$(F))}function $(F){g("emit readable"),F.emit("readable"),w(F)}function V(F,D){D.readingMore||(D.readingMore=!0,a.nextTick(R,F,D))}function R(F,D){for(var H=D.length;!D.reading&&!D.flowing&&!D.ended&&D.length<D.highWaterMark&&(g("maybeReadMore read 0"),F.read(0),H!==D.length);)H=D.length;D.readingMore=!1}function O(F){g("readable nexttick read 0"),F.read(0)}function T(F,D){D.reading||(g("resume read 0"),F.read(0)),D.resumeScheduled=!1,D.awaitDrain=0,F.emit("resume"),w(F),D.flowing&&!D.reading&&F.read(0)}function w(F){var D=F._readableState;for(g("flow",D.flowing);D.flowing&&F.read()!==null;);}function x(F,D){return D.length===0?null:(D.objectMode?H=D.buffer.shift():!F||F>=D.length?(H=D.decoder?D.buffer.join(""):D.buffer.length===1?D.buffer.head.data:D.buffer.concat(D.length),D.buffer.clear()):H=(function(G,ee,B){var X;return G<ee.head.data.length?(X=ee.head.data.slice(0,G),ee.head.data=ee.head.data.slice(G)):X=G===ee.head.data.length?ee.shift():B?(function(I,N){var j=N.head,Q=1,W=j.data;for(I-=W.length;j=j.next;){var Y=j.data,Z=I>Y.length?Y.length:I;if(Z===Y.length?W+=Y:W+=Y.slice(0,I),(I-=Z)===0){Z===Y.length?(++Q,j.next?N.head=j.next:N.head=N.tail=null):(N.head=j,j.data=Y.slice(Z));break}++Q}return N.length-=Q,W})(G,ee):(function(I,N){var j=h.allocUnsafe(I),Q=N.head,W=1;for(Q.data.copy(j),I-=Q.data.length;Q=Q.next;){var Y=Q.data,Z=I>Y.length?Y.length:I;if(Y.copy(j,j.length-I,0,Z),(I-=Z)===0){Z===Y.length?(++W,Q.next?N.head=Q.next:N.head=N.tail=null):(N.head=Q,Q.data=Y.slice(Z));break}++W}return N.length-=W,j})(G,ee),X})(F,D.buffer,D.decoder),H);var H}function _(F){var D=F._readableState;if(D.length>0)throw new Error('"endReadable()" called on non-empty stream');D.endEmitted||(D.ended=!0,a.nextTick(S,D,F))}function S(F,D){F.endEmitted||F.length!==0||(F.endEmitted=!0,D.readable=!1,D.emit("end"))}function C(F,D){for(var H=0,G=F.length;H<G;H++)if(F[H]===D)return H;return-1}M.prototype.read=function(F){g("read",F),F=parseInt(F,10);var D=this._readableState,H=F;if(F!==0&&(D.emittedReadable=!1),F===0&&D.needReadable&&(D.length>=D.highWaterMark||D.ended))return g("read: emitReadable",D.length,D.ended),D.length===0&&D.ended?_(this):U(this),null;if((F=P(F,D))===0&&D.ended)return D.length===0&&_(this),null;var G,ee=D.needReadable;return g("need readable",ee),(D.length===0||D.length-F<D.highWaterMark)&&g("length less than watermark",ee=!0),D.ended||D.reading?g("reading or ended",ee=!1):ee&&(g("do read"),D.reading=!0,D.sync=!0,D.length===0&&(D.needReadable=!0),this._read(D.highWaterMark),D.sync=!1,D.reading||(F=P(H,D))),(G=F>0?x(F,D):null)===null?(D.needReadable=!0,F=0):D.length-=F,D.length===0&&(D.ended||(D.needReadable=!0),H!==F&&D.ended&&_(this)),G!==null&&this.emit("data",G),G},M.prototype._read=function(F){this.emit("error",new Error("_read() is not implemented"))},M.prototype.pipe=function(F,D){var H=this,G=this._readableState;switch(G.pipesCount){case 0:G.pipes=F;break;case 1:G.pipes=[G.pipes,F];break;default:G.pipes.push(F)}G.pipesCount+=1,g("pipe count=%d opts=%j",G.pipesCount,D);var ee=(!D||D.end!==!1)&&F!==s.stdout&&F!==s.stderr?X:se;function B(re,K){g("onunpipe"),re===H&&K&&K.hasUnpiped===!1&&(K.hasUnpiped=!0,g("cleanup"),F.removeListener("close",Y),F.removeListener("finish",Z),F.removeListener("drain",I),F.removeListener("error",W),F.removeListener("unpipe",B),H.removeListener("end",X),H.removeListener("end",se),H.removeListener("data",Q),N=!0,!G.awaitDrain||F._writableState&&!F._writableState.needDrain||I())}function X(){g("onend"),F.end()}G.endEmitted?a.nextTick(ee):H.once("end",ee),F.on("unpipe",B);var I=(function(re){return function(){var K=re._readableState;g("pipeOnDrain",K.awaitDrain),K.awaitDrain&&K.awaitDrain--,K.awaitDrain===0&&c(re,"data")&&(K.flowing=!0,w(re))}})(H);F.on("drain",I);var N=!1,j=!1;function Q(re){g("ondata"),j=!1,F.write(re)!==!1||j||((G.pipesCount===1&&G.pipes===F||G.pipesCount>1&&C(G.pipes,F)!==-1)&&!N&&(g("false write response, pause",G.awaitDrain),G.awaitDrain++,j=!0),H.pause())}function W(re){g("onerror",re),se(),F.removeListener("error",W),c(F,"error")===0&&F.emit("error",re)}function Y(){F.removeListener("finish",Z),se()}function Z(){g("onfinish"),F.removeListener("close",Y),se()}function se(){g("unpipe"),H.unpipe(F)}return H.on("data",Q),(function(re,K,ie){if(typeof re.prependListener=="function")return re.prependListener(K,ie);re._events&&re._events[K]?u(re._events[K])?re._events[K].unshift(ie):re._events[K]=[ie,re._events[K]]:re.on(K,ie)})(F,"error",W),F.once("close",Y),F.once("finish",Z),F.emit("pipe",H),G.flowing||(g("pipe resume"),H.resume()),F},M.prototype.unpipe=function(F){var D=this._readableState,H={hasUnpiped:!1};if(D.pipesCount===0)return this;if(D.pipesCount===1)return F&&F!==D.pipes||(F||(F=D.pipes),D.pipes=null,D.pipesCount=0,D.flowing=!1,F&&F.emit("unpipe",this,H)),this;if(!F){var G=D.pipes,ee=D.pipesCount;D.pipes=null,D.pipesCount=0,D.flowing=!1;for(var B=0;B<ee;B++)G[B].emit("unpipe",this,{hasUnpiped:!1});return this}var X=C(D.pipes,F);return X===-1||(D.pipes.splice(X,1),D.pipesCount-=1,D.pipesCount===1&&(D.pipes=D.pipes[0]),F.emit("unpipe",this,H)),this},M.prototype.on=function(F,D){var H=d.prototype.on.call(this,F,D);if(F==="data")this._readableState.flowing!==!1&&this.resume();else if(F==="readable"){var G=this._readableState;G.endEmitted||G.readableListening||(G.readableListening=G.needReadable=!0,G.emittedReadable=!1,G.reading?G.length&&U(this):a.nextTick(O,this))}return H},M.prototype.addListener=M.prototype.on,M.prototype.resume=function(){var F=this._readableState;return F.flowing||(g("resume"),F.flowing=!0,(function(D,H){H.resumeScheduled||(H.resumeScheduled=!0,a.nextTick(T,D,H))})(this,F)),this},M.prototype.pause=function(){return g("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(g("pause"),this._readableState.flowing=!1,this.emit("pause")),this},M.prototype.wrap=function(F){var D=this,H=this._readableState,G=!1;for(var ee in F.on("end",(function(){if(g("wrapped end"),H.decoder&&!H.ended){var X=H.decoder.end();X&&X.length&&D.push(X)}D.push(null)})),F.on("data",(function(X){g("wrapped data"),H.decoder&&(X=H.decoder.write(X)),H.objectMode&&X==null||(H.objectMode||X&&X.length)&&(D.push(X)||(G=!0,F.pause()))})),F)this[ee]===void 0&&typeof F[ee]=="function"&&(this[ee]=(function(X){return function(){return F[X].apply(F,arguments)}})(ee));for(var B=0;B<E.length;B++)F.on(E[B],this.emit.bind(this,E[B]));return this._read=function(X){g("wrapped _read",X),G&&(G=!1,F.resume())},this},Object.defineProperty(M.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),M._fromList=x}).call(this)}).call(this,t("_process"),typeof Wt<"u"?Wt:typeof self<"u"?self:typeof window<"u"?window:{})},{"./_stream_duplex":508,"./internal/streams/BufferList":513,"./internal/streams/destroy":514,"./internal/streams/stream":515,_process:467,"core-util-is":383,events:422,inherits:440,isarray:506,"process-nextick-args":466,"safe-buffer":520,"string_decoder/":521,util:188}],511:[function(t,n,i){n.exports=l;var s=t("./_stream_duplex"),o=Object.create(t("core-util-is"));function a(d,h){var f=this._transformState;f.transforming=!1;var m=f.writecb;if(!m)return this.emit("error",new Error("write callback called multiple times"));f.writechunk=null,f.writecb=null,h!=null&&this.push(h),m(d);var p=this._readableState;p.reading=!1,(p.needReadable||p.length<p.highWaterMark)&&this._read(p.highWaterMark)}function l(d){if(!(this instanceof l))return new l(d);s.call(this,d),this._transformState={afterTransform:a.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,d&&(typeof d.transform=="function"&&(this._transform=d.transform),typeof d.flush=="function"&&(this._flush=d.flush)),this.on("prefinish",u)}function u(){var d=this;typeof this._flush=="function"?this._flush((function(h,f){c(d,h,f)})):c(this,null,null)}function c(d,h,f){if(h)return d.emit("error",h);if(f!=null&&d.push(f),d._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(d._transformState.transforming)throw new Error("Calling transform done when still transforming");return d.push(null)}o.inherits=t("inherits"),o.inherits(l,s),l.prototype.push=function(d,h){return this._transformState.needTransform=!1,s.prototype.push.call(this,d,h)},l.prototype._transform=function(d,h,f){throw new Error("_transform() is not implemented")},l.prototype._write=function(d,h,f){var m=this._transformState;if(m.writecb=f,m.writechunk=d,m.writeencoding=h,!m.transforming){var p=this._readableState;(m.needTransform||p.needReadable||p.length<p.highWaterMark)&&this._read(p.highWaterMark)}},l.prototype._read=function(d){var h=this._transformState;h.writechunk!==null&&h.writecb&&!h.transforming?(h.transforming=!0,this._transform(h.writechunk,h.writeencoding,h.afterTransform)):h.needTransform=!0},l.prototype._destroy=function(d,h){var f=this;s.prototype._destroy.call(this,d,(function(m){h(m),f.emit("close")}))}},{"./_stream_duplex":508,"core-util-is":383,inherits:440}],512:[function(t,n,i){(function(s,o,a){(function(){var l=t("process-nextick-args");function u(V){var R=this;this.next=null,this.entry=null,this.finish=function(){(function(O,T,w){var x=O.entry;for(O.entry=null;x;){var _=x.callback;T.pendingcb--,_(w),x=x.next}T.corkedRequestsFree.next=O})(R,V)}}n.exports=A;var c,d=!s.browser&&["v0.10","v0.9."].indexOf(s.version.slice(0,5))>-1?a:l.nextTick;A.WritableState=E;var h=Object.create(t("core-util-is"));h.inherits=t("inherits");var f={deprecate:t("util-deprecate")},m=t("./internal/streams/stream"),p=t("safe-buffer").Buffer,g=(o!==void 0?o:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},v,y=t("./internal/streams/destroy");function b(){}function E(V,R){c=c||t("./_stream_duplex"),V=V||{};var O=R instanceof c;this.objectMode=!!V.objectMode,O&&(this.objectMode=this.objectMode||!!V.writableObjectMode);var T=V.highWaterMark,w=V.writableHighWaterMark,x=this.objectMode?16:16384;this.highWaterMark=T||T===0?T:O&&(w||w===0)?w:x,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var _=V.decodeStrings===!1;this.decodeStrings=!_,this.defaultEncoding=V.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(S){(function(C,F){var D=C._writableState,H=D.sync,G=D.writecb;if((function(B){B.writing=!1,B.writecb=null,B.length-=B.writelen,B.writelen=0})(D),F)(function(B,X,I,N,j){--X.pendingcb,I?(l.nextTick(j,N),l.nextTick($,B,X),B._writableState.errorEmitted=!0,B.emit("error",N)):(j(N),B._writableState.errorEmitted=!0,B.emit("error",N),$(B,X))})(C,D,H,F,G);else{var ee=P(D);ee||D.corked||D.bufferProcessing||!D.bufferedRequest||k(C,D),H?d(L,C,D,ee,G):L(C,D,ee,G)}})(R,S)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new u(this)}function A(V){if(c=c||t("./_stream_duplex"),!(v.call(A,this)||this instanceof c))return new A(V);this._writableState=new E(V,this),this.writable=!0,V&&(typeof V.write=="function"&&(this._write=V.write),typeof V.writev=="function"&&(this._writev=V.writev),typeof V.destroy=="function"&&(this._destroy=V.destroy),typeof V.final=="function"&&(this._final=V.final)),m.call(this)}function M(V,R,O,T,w,x,_){R.writelen=T,R.writecb=_,R.writing=!0,R.sync=!0,O?V._writev(w,R.onwrite):V._write(w,x,R.onwrite),R.sync=!1}function L(V,R,O,T){O||(function(w,x){x.length===0&&x.needDrain&&(x.needDrain=!1,w.emit("drain"))})(V,R),R.pendingcb--,T(),$(V,R)}function k(V,R){R.bufferProcessing=!0;var O=R.bufferedRequest;if(V._writev&&O&&O.next){var T=R.bufferedRequestCount,w=new Array(T),x=R.corkedRequestsFree;x.entry=O;for(var _=0,S=!0;O;)w[_]=O,O.isBuf||(S=!1),O=O.next,_+=1;w.allBuffers=S,M(V,R,!0,R.length,w,"",x.finish),R.pendingcb++,R.lastBufferedRequest=null,x.next?(R.corkedRequestsFree=x.next,x.next=null):R.corkedRequestsFree=new u(R),R.bufferedRequestCount=0}else{for(;O;){var C=O.chunk,F=O.encoding,D=O.callback;if(M(V,R,!1,R.objectMode?1:C.length,C,F,D),O=O.next,R.bufferedRequestCount--,R.writing)break}O===null&&(R.lastBufferedRequest=null)}R.bufferedRequest=O,R.bufferProcessing=!1}function P(V){return V.ending&&V.length===0&&V.bufferedRequest===null&&!V.finished&&!V.writing}function U(V,R){V._final((function(O){R.pendingcb--,O&&V.emit("error",O),R.prefinished=!0,V.emit("prefinish"),$(V,R)}))}function $(V,R){var O=P(R);return O&&((function(T,w){w.prefinished||w.finalCalled||(typeof T._final=="function"?(w.pendingcb++,w.finalCalled=!0,l.nextTick(U,T,w)):(w.prefinished=!0,T.emit("prefinish")))})(V,R),R.pendingcb===0&&(R.finished=!0,V.emit("finish"))),O}h.inherits(A,m),E.prototype.getBuffer=function(){for(var V=this.bufferedRequest,R=[];V;)R.push(V),V=V.next;return R},(function(){try{Object.defineProperty(E.prototype,"buffer",{get:f.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})(),typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(v=Function.prototype[Symbol.hasInstance],Object.defineProperty(A,Symbol.hasInstance,{value:function(V){return!!v.call(this,V)||this===A&&V&&V._writableState instanceof E}})):v=function(V){return V instanceof this},A.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},A.prototype.write=function(V,R,O){var T,w=this._writableState,x=!1,_=!w.objectMode&&(T=V,p.isBuffer(T)||T instanceof g);return _&&!p.isBuffer(V)&&(V=(function(S){return p.from(S)})(V)),typeof R=="function"&&(O=R,R=null),_?R="buffer":R||(R=w.defaultEncoding),typeof O!="function"&&(O=b),w.ended?(function(S,C){var F=new Error("write after end");S.emit("error",F),l.nextTick(C,F)})(this,O):(_||(function(S,C,F,D){var H=!0,G=!1;return F===null?G=new TypeError("May not write null values to stream"):typeof F=="string"||F===void 0||C.objectMode||(G=new TypeError("Invalid non-string/buffer chunk")),G&&(S.emit("error",G),l.nextTick(D,G),H=!1),H})(this,w,V,O))&&(w.pendingcb++,x=(function(S,C,F,D,H,G){if(!F){var ee=(function(N,j,Q){return N.objectMode||N.decodeStrings===!1||typeof j!="string"||(j=p.from(j,Q)),j})(C,D,H);D!==ee&&(F=!0,H="buffer",D=ee)}var B=C.objectMode?1:D.length;C.length+=B;var X=C.length<C.highWaterMark;if(X||(C.needDrain=!0),C.writing||C.corked){var I=C.lastBufferedRequest;C.lastBufferedRequest={chunk:D,encoding:H,isBuf:F,callback:G,next:null},I?I.next=C.lastBufferedRequest:C.bufferedRequest=C.lastBufferedRequest,C.bufferedRequestCount+=1}else M(S,C,!1,B,D,H,G);return X})(this,w,_,V,R,O)),x},A.prototype.cork=function(){this._writableState.corked++},A.prototype.uncork=function(){var V=this._writableState;V.corked&&(V.corked--,V.writing||V.corked||V.bufferProcessing||!V.bufferedRequest||k(this,V))},A.prototype.setDefaultEncoding=function(V){if(typeof V=="string"&&(V=V.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((V+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+V);return this._writableState.defaultEncoding=V,this},Object.defineProperty(A.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),A.prototype._write=function(V,R,O){O(new Error("_write() is not implemented"))},A.prototype._writev=null,A.prototype.end=function(V,R,O){var T=this._writableState;typeof V=="function"?(O=V,V=null,R=null):typeof R=="function"&&(O=R,R=null),V!=null&&this.write(V,R),T.corked&&(T.corked=1,this.uncork()),T.ending||(function(w,x,_){x.ending=!0,$(w,x),_&&(x.finished?l.nextTick(_):w.once("finish",_)),x.ended=!0,w.writable=!1})(this,T,O)},Object.defineProperty(A.prototype,"destroyed",{get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(V){this._writableState&&(this._writableState.destroyed=V)}}),A.prototype.destroy=y.destroy,A.prototype._undestroy=y.undestroy,A.prototype._destroy=function(V,R){this.end(),R(V)}}).call(this)}).call(this,t("_process"),typeof Wt<"u"?Wt:typeof self<"u"?self:typeof window<"u"?window:{},t("timers").setImmediate)},{"./_stream_duplex":508,"./internal/streams/destroy":514,"./internal/streams/stream":515,_process:467,"core-util-is":383,inherits:440,"process-nextick-args":466,"safe-buffer":520,timers:523,"util-deprecate":524}],513:[function(t,n,i){var s=t("safe-buffer").Buffer,o=t("util");n.exports=(function(){function a(){(function(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")})(this,a),this.head=null,this.tail=null,this.length=0}return a.prototype.push=function(l){var u={data:l,next:null};this.length>0?this.tail.next=u:this.head=u,this.tail=u,++this.length},a.prototype.unshift=function(l){var u={data:l,next:this.head};this.length===0&&(this.tail=u),this.head=u,++this.length},a.prototype.shift=function(){if(this.length!==0){var l=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,l}},a.prototype.clear=function(){this.head=this.tail=null,this.length=0},a.prototype.join=function(l){if(this.length===0)return"";for(var u=this.head,c=""+u.data;u=u.next;)c+=l+u.data;return c},a.prototype.concat=function(l){if(this.length===0)return s.alloc(0);for(var u,c,d,h=s.allocUnsafe(l>>>0),f=this.head,m=0;f;)u=f.data,c=h,d=m,u.copy(c,d),m+=f.data.length,f=f.next;return h},a})(),o&&o.inspect&&o.inspect.custom&&(n.exports.prototype[o.inspect.custom]=function(){var a=o.inspect({length:this.length});return this.constructor.name+" "+a})},{"safe-buffer":520,util:188}],514:[function(t,n,i){var s=t("process-nextick-args");function o(a,l){a.emit("error",l)}n.exports={destroy:function(a,l){var u=this,c=this._readableState&&this._readableState.destroyed,d=this._writableState&&this._writableState.destroyed;return c||d?(l?l(a):a&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,s.nextTick(o,this,a)):s.nextTick(o,this,a)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(a||null,(function(h){!l&&h?u._writableState?u._writableState.errorEmitted||(u._writableState.errorEmitted=!0,s.nextTick(o,u,h)):s.nextTick(o,u,h):l&&l(h)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},{"process-nextick-args":466}],515:[function(t,n,i){arguments[4][490][0].apply(i,arguments)},{dup:490,events:422}],516:[function(t,n,i){n.exports=t("./readable").PassThrough},{"./readable":517}],517:[function(t,n,i){(i=n.exports=t("./lib/_stream_readable.js")).Stream=i,i.Readable=i,i.Writable=t("./lib/_stream_writable.js"),i.Duplex=t("./lib/_stream_duplex.js"),i.Transform=t("./lib/_stream_transform.js"),i.PassThrough=t("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":508,"./lib/_stream_passthrough.js":509,"./lib/_stream_readable.js":510,"./lib/_stream_transform.js":511,"./lib/_stream_writable.js":512}],518:[function(t,n,i){n.exports=t("./readable").Transform},{"./readable":517}],519:[function(t,n,i){n.exports=t("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":512}],520:[function(t,n,i){arguments[4][217][0].apply(i,arguments)},{buffer:220,dup:217}],521:[function(t,n,i){arguments[4][218][0].apply(i,arguments)},{dup:218,"safe-buffer":520}],522:[function(t,n,i){arguments[4][218][0].apply(i,arguments)},{dup:218,"safe-buffer":494}],523:[function(t,n,i){(function(s,o){(function(){var a=t("process/browser.js").nextTick,l=Function.prototype.apply,u=Array.prototype.slice,c={},d=0;function h(f,m){this._id=f,this._clearFn=m}i.setTimeout=function(){return new h(l.call(setTimeout,window,arguments),clearTimeout)},i.setInterval=function(){return new h(l.call(setInterval,window,arguments),clearInterval)},i.clearTimeout=i.clearInterval=function(f){f.close()},h.prototype.unref=h.prototype.ref=function(){},h.prototype.close=function(){this._clearFn.call(window,this._id)},i.enroll=function(f,m){clearTimeout(f._idleTimeoutId),f._idleTimeout=m},i.unenroll=function(f){clearTimeout(f._idleTimeoutId),f._idleTimeout=-1},i._unrefActive=i.active=function(f){clearTimeout(f._idleTimeoutId);var m=f._idleTimeout;m>=0&&(f._idleTimeoutId=setTimeout((function(){f._onTimeout&&f._onTimeout()}),m))},i.setImmediate=typeof s=="function"?s:function(f){var m=d++,p=!(arguments.length<2)&&u.call(arguments,1);return c[m]=!0,a((function(){c[m]&&(p?f.apply(null,p):f.call(null),i.clearImmediate(m))})),m},i.clearImmediate=typeof o=="function"?o:function(f){delete c[f]}}).call(this)}).call(this,t("timers").setImmediate,t("timers").clearImmediate)},{"process/browser.js":467,timers:523}],524:[function(t,n,i){(function(s){(function(){function o(a){try{if(!s.localStorage)return!1}catch{return!1}var l=s.localStorage[a];return l!=null&&String(l).toLowerCase()==="true"}n.exports=function(a,l){if(o("noDeprecation"))return a;var u=!1;return function(){if(!u){if(o("throwDeprecation"))throw new Error(l);o("traceDeprecation")?console.trace(l):console.warn(l),u=!0}return a.apply(this,arguments)}}}).call(this)}).call(this,typeof Wt<"u"?Wt:typeof self<"u"?self:typeof window<"u"?window:{})},{}],525:[function(t,n,i){typeof Object.create=="function"?n.exports=function(s,o){s.super_=o,s.prototype=Object.create(o.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}})}:n.exports=function(s,o){s.super_=o;var a=function(){};a.prototype=o.prototype,s.prototype=new a,s.prototype.constructor=s}},{}],526:[function(t,n,i){n.exports=function(s){return s&&typeof s=="object"&&typeof s.copy=="function"&&typeof s.fill=="function"&&typeof s.readUInt8=="function"}},{}],527:[function(t,n,i){(function(s,o){(function(){var a=/%[sdj%]/g;i.format=function(w){if(!E(w)){for(var x=[],_=0;_<arguments.length;_++)x.push(c(arguments[_]));return x.join(" ")}_=1;for(var S=arguments,C=S.length,F=String(w).replace(a,(function(H){if(H==="%%")return"%";if(_>=C)return H;switch(H){case"%s":return String(S[_++]);case"%d":return Number(S[_++]);case"%j":try{return JSON.stringify(S[_++])}catch{return"[Circular]"}default:return H}})),D=S[_];_<C;D=S[++_])y(D)||!L(D)?F+=" "+D:F+=" "+c(D);return F},i.deprecate=function(w,x){if(A(o.process))return function(){return i.deprecate(w,x).apply(this,arguments)};if(s.noDeprecation===!0)return w;var _=!1;return function(){if(!_){if(s.throwDeprecation)throw new Error(x);s.traceDeprecation?console.trace(x):console.error(x),_=!0}return w.apply(this,arguments)}};var l,u={};function c(w,x){var _={seen:[],stylize:h};return arguments.length>=3&&(_.depth=arguments[2]),arguments.length>=4&&(_.colors=arguments[3]),v(x)?_.showHidden=x:x&&i._extend(_,x),A(_.showHidden)&&(_.showHidden=!1),A(_.depth)&&(_.depth=2),A(_.colors)&&(_.colors=!1),A(_.customInspect)&&(_.customInspect=!0),_.colors&&(_.stylize=d),f(_,w,_.depth)}function d(w,x){var _=c.styles[x];return _?"\x1B["+c.colors[_][0]+"m"+w+"\x1B["+c.colors[_][1]+"m":w}function h(w,x){return w}function f(w,x,_){if(w.customInspect&&x&&U(x.inspect)&&x.inspect!==i.inspect&&(!x.constructor||x.constructor.prototype!==x)){var S=x.inspect(_,w);return E(S)||(S=f(w,S,_)),S}var C=(function(I,N){if(A(N))return I.stylize("undefined","undefined");if(E(N)){var j="'"+JSON.stringify(N).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return I.stylize(j,"string")}if(b(N))return I.stylize(""+N,"number");if(v(N))return I.stylize(""+N,"boolean");if(y(N))return I.stylize("null","null")})(w,x);if(C)return C;var F=Object.keys(x),D=(function(I){var N={};return I.forEach((function(j,Q){N[j]=!0})),N})(F);if(w.showHidden&&(F=Object.getOwnPropertyNames(x)),P(x)&&(F.indexOf("message")>=0||F.indexOf("description")>=0))return m(x);if(F.length===0){if(U(x)){var H=x.name?": "+x.name:"";return w.stylize("[Function"+H+"]","special")}if(M(x))return w.stylize(RegExp.prototype.toString.call(x),"regexp");if(k(x))return w.stylize(Date.prototype.toString.call(x),"date");if(P(x))return m(x)}var G,ee="",B=!1,X=["{","}"];return g(x)&&(B=!0,X=["[","]"]),U(x)&&(ee=" [Function"+(x.name?": "+x.name:"")+"]"),M(x)&&(ee=" "+RegExp.prototype.toString.call(x)),k(x)&&(ee=" "+Date.prototype.toUTCString.call(x)),P(x)&&(ee=" "+m(x)),F.length!==0||B&&x.length!=0?_<0?M(x)?w.stylize(RegExp.prototype.toString.call(x),"regexp"):w.stylize("[Object]","special"):(w.seen.push(x),G=B?(function(I,N,j,Q,W){for(var Y=[],Z=0,se=N.length;Z<se;++Z)T(N,String(Z))?Y.push(p(I,N,j,Q,String(Z),!0)):Y.push("");return W.forEach((function(re){re.match(/^\d+$/)||Y.push(p(I,N,j,Q,re,!0))})),Y})(w,x,_,D,F):F.map((function(I){return p(w,x,_,D,I,B)})),w.seen.pop(),(function(I,N,j){return I.reduce((function(Q,W){return W.indexOf(`
`)>=0,Q+W.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?j[0]+(N===""?"":N+`
 `)+" "+I.join(`,
  `)+" "+j[1]:j[0]+N+" "+I.join(", ")+" "+j[1]})(G,ee,X)):X[0]+ee+X[1]}function m(w){return"["+Error.prototype.toString.call(w)+"]"}function p(w,x,_,S,C,F){var D,H,G;if((G=Object.getOwnPropertyDescriptor(x,C)||{value:x[C]}).get?H=G.set?w.stylize("[Getter/Setter]","special"):w.stylize("[Getter]","special"):G.set&&(H=w.stylize("[Setter]","special")),T(S,C)||(D="["+C+"]"),H||(w.seen.indexOf(G.value)<0?(H=y(_)?f(w,G.value,null):f(w,G.value,_-1)).indexOf(`
`)>-1&&(H=F?H.split(`
`).map((function(ee){return"  "+ee})).join(`
`).substr(2):`
`+H.split(`
`).map((function(ee){return"   "+ee})).join(`
`)):H=w.stylize("[Circular]","special")),A(D)){if(F&&C.match(/^\d+$/))return H;(D=JSON.stringify(""+C)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(D=D.substr(1,D.length-2),D=w.stylize(D,"name")):(D=D.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),D=w.stylize(D,"string"))}return D+": "+H}function g(w){return Array.isArray(w)}function v(w){return typeof w=="boolean"}function y(w){return w===null}function b(w){return typeof w=="number"}function E(w){return typeof w=="string"}function A(w){return w===void 0}function M(w){return L(w)&&$(w)==="[object RegExp]"}function L(w){return typeof w=="object"&&w!==null}function k(w){return L(w)&&$(w)==="[object Date]"}function P(w){return L(w)&&($(w)==="[object Error]"||w instanceof Error)}function U(w){return typeof w=="function"}function $(w){return Object.prototype.toString.call(w)}function V(w){return w<10?"0"+w.toString(10):w.toString(10)}i.debuglog=function(w){if(A(l)&&(l=s.env.NODE_DEBUG||""),w=w.toUpperCase(),!u[w])if(new RegExp("\\b"+w+"\\b","i").test(l)){var x=s.pid;u[w]=function(){var _=i.format.apply(i,arguments);console.error("%s %d: %s",w,x,_)}}else u[w]=function(){};return u[w]},i.inspect=c,c.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},c.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},i.isArray=g,i.isBoolean=v,i.isNull=y,i.isNullOrUndefined=function(w){return w==null},i.isNumber=b,i.isString=E,i.isSymbol=function(w){return typeof w=="symbol"},i.isUndefined=A,i.isRegExp=M,i.isObject=L,i.isDate=k,i.isError=P,i.isFunction=U,i.isPrimitive=function(w){return w===null||typeof w=="boolean"||typeof w=="number"||typeof w=="string"||typeof w=="symbol"||w===void 0},i.isBuffer=t("./support/isBuffer");var R=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function O(){var w=new Date,x=[V(w.getHours()),V(w.getMinutes()),V(w.getSeconds())].join(":");return[w.getDate(),R[w.getMonth()],x].join(" ")}function T(w,x){return Object.prototype.hasOwnProperty.call(w,x)}i.log=function(){console.log("%s - %s",O(),i.format.apply(i,arguments))},i.inherits=t("inherits"),i._extend=function(w,x){if(!x||!L(x))return w;for(var _=Object.keys(x),S=_.length;S--;)w[_[S]]=x[_[S]];return w}}).call(this)}).call(this,t("_process"),typeof Wt<"u"?Wt:typeof self<"u"?self:typeof window<"u"?window:{})},{"./support/isBuffer":526,_process:467,inherits:525}],528:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0}),Object.defineProperty(i,"v1",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(i,"v3",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(i,"v4",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(i,"v5",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(i,"NIL",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(i,"version",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(i,"validate",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(i,"stringify",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(i,"parse",{enumerable:!0,get:function(){return f.default}});var s=m(t("./v1.js")),o=m(t("./v3.js")),a=m(t("./v4.js")),l=m(t("./v5.js")),u=m(t("./nil.js")),c=m(t("./version.js")),d=m(t("./validate.js")),h=m(t("./stringify.js")),f=m(t("./parse.js"));function m(p){return p&&p.__esModule?p:{default:p}}},{"./nil.js":530,"./parse.js":531,"./stringify.js":535,"./v1.js":536,"./v3.js":537,"./v4.js":539,"./v5.js":540,"./validate.js":541,"./version.js":542}],529:[function(t,n,i){function s(f){return 14+(f+64>>>9<<4)+1}function o(f,m){const p=(65535&f)+(65535&m);return(f>>16)+(m>>16)+(p>>16)<<16|65535&p}function a(f,m,p,g,v,y){return o((b=o(o(m,f),o(g,y)))<<(E=v)|b>>>32-E,p);var b,E}function l(f,m,p,g,v,y,b){return a(m&p|~m&g,f,m,v,y,b)}function u(f,m,p,g,v,y,b){return a(m&g|p&~g,f,m,v,y,b)}function c(f,m,p,g,v,y,b){return a(m^p^g,f,m,v,y,b)}function d(f,m,p,g,v,y,b){return a(p^(m|~g),f,m,v,y,b)}Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var h=function(f){if(typeof f=="string"){const m=unescape(encodeURIComponent(f));f=new Uint8Array(m.length);for(let p=0;p<m.length;++p)f[p]=m.charCodeAt(p)}return(function(m){const p=[],g=32*m.length;for(let v=0;v<g;v+=8){const y=m[v>>5]>>>v%32&255,b=parseInt("0123456789abcdef".charAt(y>>>4&15)+"0123456789abcdef".charAt(15&y),16);p.push(b)}return p})((function(m,p){m[p>>5]|=128<<p%32,m[s(p)-1]=p;let g=1732584193,v=-271733879,y=-1732584194,b=271733878;for(let E=0;E<m.length;E+=16){const A=g,M=v,L=y,k=b;g=l(g,v,y,b,m[E],7,-680876936),b=l(b,g,v,y,m[E+1],12,-389564586),y=l(y,b,g,v,m[E+2],17,606105819),v=l(v,y,b,g,m[E+3],22,-1044525330),g=l(g,v,y,b,m[E+4],7,-176418897),b=l(b,g,v,y,m[E+5],12,1200080426),y=l(y,b,g,v,m[E+6],17,-1473231341),v=l(v,y,b,g,m[E+7],22,-45705983),g=l(g,v,y,b,m[E+8],7,1770035416),b=l(b,g,v,y,m[E+9],12,-1958414417),y=l(y,b,g,v,m[E+10],17,-42063),v=l(v,y,b,g,m[E+11],22,-1990404162),g=l(g,v,y,b,m[E+12],7,1804603682),b=l(b,g,v,y,m[E+13],12,-40341101),y=l(y,b,g,v,m[E+14],17,-1502002290),v=l(v,y,b,g,m[E+15],22,1236535329),g=u(g,v,y,b,m[E+1],5,-165796510),b=u(b,g,v,y,m[E+6],9,-1069501632),y=u(y,b,g,v,m[E+11],14,643717713),v=u(v,y,b,g,m[E],20,-373897302),g=u(g,v,y,b,m[E+5],5,-701558691),b=u(b,g,v,y,m[E+10],9,38016083),y=u(y,b,g,v,m[E+15],14,-660478335),v=u(v,y,b,g,m[E+4],20,-405537848),g=u(g,v,y,b,m[E+9],5,568446438),b=u(b,g,v,y,m[E+14],9,-1019803690),y=u(y,b,g,v,m[E+3],14,-187363961),v=u(v,y,b,g,m[E+8],20,1163531501),g=u(g,v,y,b,m[E+13],5,-1444681467),b=u(b,g,v,y,m[E+2],9,-51403784),y=u(y,b,g,v,m[E+7],14,1735328473),v=u(v,y,b,g,m[E+12],20,-1926607734),g=c(g,v,y,b,m[E+5],4,-378558),b=c(b,g,v,y,m[E+8],11,-2022574463),y=c(y,b,g,v,m[E+11],16,1839030562),v=c(v,y,b,g,m[E+14],23,-35309556),g=c(g,v,y,b,m[E+1],4,-1530992060),b=c(b,g,v,y,m[E+4],11,1272893353),y=c(y,b,g,v,m[E+7],16,-155497632),v=c(v,y,b,g,m[E+10],23,-1094730640),g=c(g,v,y,b,m[E+13],4,681279174),b=c(b,g,v,y,m[E],11,-358537222),y=c(y,b,g,v,m[E+3],16,-722521979),v=c(v,y,b,g,m[E+6],23,76029189),g=c(g,v,y,b,m[E+9],4,-640364487),b=c(b,g,v,y,m[E+12],11,-421815835),y=c(y,b,g,v,m[E+15],16,530742520),v=c(v,y,b,g,m[E+2],23,-995338651),g=d(g,v,y,b,m[E],6,-198630844),b=d(b,g,v,y,m[E+7],10,1126891415),y=d(y,b,g,v,m[E+14],15,-1416354905),v=d(v,y,b,g,m[E+5],21,-57434055),g=d(g,v,y,b,m[E+12],6,1700485571),b=d(b,g,v,y,m[E+3],10,-1894986606),y=d(y,b,g,v,m[E+10],15,-1051523),v=d(v,y,b,g,m[E+1],21,-2054922799),g=d(g,v,y,b,m[E+8],6,1873313359),b=d(b,g,v,y,m[E+15],10,-30611744),y=d(y,b,g,v,m[E+6],15,-1560198380),v=d(v,y,b,g,m[E+13],21,1309151649),g=d(g,v,y,b,m[E+4],6,-145523070),b=d(b,g,v,y,m[E+11],10,-1120210379),y=d(y,b,g,v,m[E+2],15,718787259),v=d(v,y,b,g,m[E+9],21,-343485551),g=o(g,A),v=o(v,M),y=o(y,L),b=o(b,k)}return[g,v,y,b]})((function(m){if(m.length===0)return[];const p=8*m.length,g=new Uint32Array(s(p));for(let v=0;v<p;v+=8)g[v>>5]|=(255&m[v/8])<<v%32;return g})(f),8*f.length))};i.default=h},{}],530:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0,i.default="00000000-0000-0000-0000-000000000000"},{}],531:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var s,o=(s=t("./validate.js"))&&s.__esModule?s:{default:s},a=function(l){if(!(0,o.default)(l))throw TypeError("Invalid UUID");let u;const c=new Uint8Array(16);return c[0]=(u=parseInt(l.slice(0,8),16))>>>24,c[1]=u>>>16&255,c[2]=u>>>8&255,c[3]=255&u,c[4]=(u=parseInt(l.slice(9,13),16))>>>8,c[5]=255&u,c[6]=(u=parseInt(l.slice(14,18),16))>>>8,c[7]=255&u,c[8]=(u=parseInt(l.slice(19,23),16))>>>8,c[9]=255&u,c[10]=(u=parseInt(l.slice(24,36),16))/1099511627776&255,c[11]=u/4294967296&255,c[12]=u>>>24&255,c[13]=u>>>16&255,c[14]=u>>>8&255,c[15]=255&u,c};i.default=a},{"./validate.js":541}],532:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0,i.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i},{}],533:[function(t,n,i){let s;Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(){if(!s&&(s=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!s))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return s(o)};const o=new Uint8Array(16)},{}],534:[function(t,n,i){function s(l,u,c,d){switch(l){case 0:return u&c^~u&d;case 1:return u^c^d;case 2:return u&c^u&d^c&d;case 3:return u^c^d}}function o(l,u){return l<<u|l>>>32-u}Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var a=function(l){const u=[1518500249,1859775393,2400959708,3395469782],c=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof l=="string"){const m=unescape(encodeURIComponent(l));l=[];for(let p=0;p<m.length;++p)l.push(m.charCodeAt(p))}else Array.isArray(l)||(l=Array.prototype.slice.call(l));l.push(128);const d=l.length/4+2,h=Math.ceil(d/16),f=new Array(h);for(let m=0;m<h;++m){const p=new Uint32Array(16);for(let g=0;g<16;++g)p[g]=l[64*m+4*g]<<24|l[64*m+4*g+1]<<16|l[64*m+4*g+2]<<8|l[64*m+4*g+3];f[m]=p}f[h-1][14]=8*(l.length-1)/Math.pow(2,32),f[h-1][14]=Math.floor(f[h-1][14]),f[h-1][15]=8*(l.length-1)&4294967295;for(let m=0;m<h;++m){const p=new Uint32Array(80);for(let A=0;A<16;++A)p[A]=f[m][A];for(let A=16;A<80;++A)p[A]=o(p[A-3]^p[A-8]^p[A-14]^p[A-16],1);let g=c[0],v=c[1],y=c[2],b=c[3],E=c[4];for(let A=0;A<80;++A){const M=Math.floor(A/20),L=o(g,5)+s(M,v,y,b)+E+u[M]+p[A]>>>0;E=b,b=y,y=o(v,30)>>>0,v=g,g=L}c[0]=c[0]+g>>>0,c[1]=c[1]+v>>>0,c[2]=c[2]+y>>>0,c[3]=c[3]+b>>>0,c[4]=c[4]+E>>>0}return[c[0]>>24&255,c[0]>>16&255,c[0]>>8&255,255&c[0],c[1]>>24&255,c[1]>>16&255,c[1]>>8&255,255&c[1],c[2]>>24&255,c[2]>>16&255,c[2]>>8&255,255&c[2],c[3]>>24&255,c[3]>>16&255,c[3]>>8&255,255&c[3],c[4]>>24&255,c[4]>>16&255,c[4]>>8&255,255&c[4]]};i.default=a},{}],535:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var s,o=(s=t("./validate.js"))&&s.__esModule?s:{default:s};const a=[];for(let u=0;u<256;++u)a.push((u+256).toString(16).substr(1));var l=function(u){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const d=(a[u[c+0]]+a[u[c+1]]+a[u[c+2]]+a[u[c+3]]+"-"+a[u[c+4]]+a[u[c+5]]+"-"+a[u[c+6]]+a[u[c+7]]+"-"+a[u[c+8]]+a[u[c+9]]+"-"+a[u[c+10]]+a[u[c+11]]+a[u[c+12]]+a[u[c+13]]+a[u[c+14]]+a[u[c+15]]).toLowerCase();if(!(0,o.default)(d))throw TypeError("Stringified UUID is invalid");return d};i.default=l},{"./validate.js":541}],536:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var s=a(t("./rng.js")),o=a(t("./stringify.js"));function a(f){return f&&f.__esModule?f:{default:f}}let l,u,c=0,d=0;var h=function(f,m,p){let g=m&&p||0;const v=m||new Array(16);let y=(f=f||{}).node||l,b=f.clockseq!==void 0?f.clockseq:u;if(y==null||b==null){const P=f.random||(f.rng||s.default)();y==null&&(y=l=[1|P[0],P[1],P[2],P[3],P[4],P[5]]),b==null&&(b=u=16383&(P[6]<<8|P[7]))}let E=f.msecs!==void 0?f.msecs:Date.now(),A=f.nsecs!==void 0?f.nsecs:d+1;const M=E-c+(A-d)/1e4;if(M<0&&f.clockseq===void 0&&(b=b+1&16383),(M<0||E>c)&&f.nsecs===void 0&&(A=0),A>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");c=E,d=A,u=b,E+=122192928e5;const L=(1e4*(268435455&E)+A)%4294967296;v[g++]=L>>>24&255,v[g++]=L>>>16&255,v[g++]=L>>>8&255,v[g++]=255&L;const k=E/4294967296*1e4&268435455;v[g++]=k>>>8&255,v[g++]=255&k,v[g++]=k>>>24&15|16,v[g++]=k>>>16&255,v[g++]=b>>>8|128,v[g++]=255&b;for(let P=0;P<6;++P)v[g+P]=y[P];return m||(0,o.default)(v)};i.default=h},{"./rng.js":533,"./stringify.js":535}],537:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var s=a(t("./v35.js")),o=a(t("./md5.js"));function a(u){return u&&u.__esModule?u:{default:u}}var l=(0,s.default)("v3",48,o.default);i.default=l},{"./md5.js":529,"./v35.js":538}],538:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(c,d,h){function f(m,p,g,v){if(typeof m=="string"&&(m=(function(b){b=unescape(encodeURIComponent(b));const E=[];for(let A=0;A<b.length;++A)E.push(b.charCodeAt(A));return E})(m)),typeof p=="string"&&(p=(0,o.default)(p)),p.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let y=new Uint8Array(16+m.length);if(y.set(p),y.set(m,p.length),y=h(y),y[6]=15&y[6]|d,y[8]=63&y[8]|128,g){v=v||0;for(let b=0;b<16;++b)g[v+b]=y[b];return g}return(0,s.default)(y)}try{f.name=c}catch{}return f.DNS=l,f.URL=u,f},i.URL=i.DNS=void 0;var s=a(t("./stringify.js")),o=a(t("./parse.js"));function a(c){return c&&c.__esModule?c:{default:c}}const l="6ba7b810-9dad-11d1-80b4-00c04fd430c8";i.DNS=l;const u="6ba7b811-9dad-11d1-80b4-00c04fd430c8";i.URL=u},{"./parse.js":531,"./stringify.js":535}],539:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var s=a(t("./rng.js")),o=a(t("./stringify.js"));function a(u){return u&&u.__esModule?u:{default:u}}var l=function(u,c,d){const h=(u=u||{}).random||(u.rng||s.default)();if(h[6]=15&h[6]|64,h[8]=63&h[8]|128,c){d=d||0;for(let f=0;f<16;++f)c[d+f]=h[f];return c}return(0,o.default)(h)};i.default=l},{"./rng.js":533,"./stringify.js":535}],540:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var s=a(t("./v35.js")),o=a(t("./sha1.js"));function a(u){return u&&u.__esModule?u:{default:u}}var l=(0,s.default)("v5",80,o.default);i.default=l},{"./sha1.js":534,"./v35.js":538}],541:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var s,o=(s=t("./regex.js"))&&s.__esModule?s:{default:s},a=function(l){return typeof l=="string"&&o.default.test(l)};i.default=a},{"./regex.js":532}],542:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var s,o=(s=t("./validate.js"))&&s.__esModule?s:{default:s},a=function(l){if(!(0,o.default)(l))throw TypeError("Invalid UUID");return parseInt(l.substr(14,1),16)};i.default=a},{"./validate.js":541}],543:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.CHAR=`	
\r ---`,i.S=` 	\r
`,i.NAME_START_CHAR=":A-Z_a-z-----------",i.NAME_CHAR="-"+i.NAME_START_CHAR+".0-9--",i.CHAR_RE=new RegExp("^["+i.CHAR+"]$","u"),i.S_RE=new RegExp("^["+i.S+"]+$","u"),i.NAME_START_CHAR_RE=new RegExp("^["+i.NAME_START_CHAR+"]$","u"),i.NAME_CHAR_RE=new RegExp("^["+i.NAME_CHAR+"]$","u"),i.NAME_RE=new RegExp("^["+i.NAME_START_CHAR+"]["+i.NAME_CHAR+"]*$","u"),i.NMTOKEN_RE=new RegExp("^["+i.NAME_CHAR+"]+$","u");function s(o){return o>=65&&o<=90||o>=97&&o<=122||o===58||o===95||o===8204||o===8205||o>=192&&o<=214||o>=216&&o<=246||o>=248&&o<=767||o>=880&&o<=893||o>=895&&o<=8191||o>=8304&&o<=8591||o>=11264&&o<=12271||o>=12289&&o<=55295||o>=63744&&o<=64975||o>=65008&&o<=65533||o>=65536&&o<=983039}i.S_LIST=[32,10,13,9],i.isChar=function(o){return o>=32&&o<=55295||o===10||o===13||o===9||o>=57344&&o<=65533||o>=65536&&o<=1114111},i.isS=function(o){return o===32||o===10||o===13||o===9},i.isNameStartChar=s,i.isNameChar=function(o){return s(o)||o>=48&&o<=57||o===45||o===46||o===183||o>=768&&o<=879||o>=8255&&o<=8256}},{}],544:[function(t,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.CHAR="---",i.RESTRICTED_CHAR="-\b\v\f---",i.S=` 	\r
`,i.NAME_START_CHAR=":A-Z_a-z-----------",i.NAME_CHAR="-"+i.NAME_START_CHAR+".0-9--",i.CHAR_RE=new RegExp("^["+i.CHAR+"]$","u"),i.RESTRICTED_CHAR_RE=new RegExp("^["+i.RESTRICTED_CHAR+"]$","u"),i.S_RE=new RegExp("^["+i.S+"]+$","u"),i.NAME_START_CHAR_RE=new RegExp("^["+i.NAME_START_CHAR+"]$","u"),i.NAME_CHAR_RE=new RegExp("^["+i.NAME_CHAR+"]$","u"),i.NAME_RE=new RegExp("^["+i.NAME_START_CHAR+"]["+i.NAME_CHAR+"]*$","u"),i.NMTOKEN_RE=new RegExp("^["+i.NAME_CHAR+"]+$","u");function s(o){return o>=65&&o<=90||o>=97&&o<=122||o===58||o===95||o===8204||o===8205||o>=192&&o<=214||o>=216&&o<=246||o>=248&&o<=767||o>=880&&o<=893||o>=895&&o<=8191||o>=8304&&o<=8591||o>=11264&&o<=12271||o>=12289&&o<=55295||o>=63744&&o<=64975||o>=65008&&o<=65533||o>=65536&&o<=983039}i.S_LIST=[32,10,13,9],i.isChar=function(o){return o>=1&&o<=55295||o>=57344&&o<=65533||o>=65536&&o<=1114111},i.isRestrictedChar=function(o){return o>=1&&o<=8||o===11||o===12||o>=14&&o<=31||o>=127&&o<=132||o>=134&&o<=159},i.isCharAndNotRestricted=function(o){return o===9||o===10||o===13||o>31&&o<127||o===133||o>159&&o<=55295||o>=57344&&o<=65533||o>=65536&&o<=1114111},i.isS=function(o){return o===32||o===10||o===13||o===9},i.isNameStartChar=s,i.isNameChar=function(o){return s(o)||o>=48&&o<=57||o===45||o===46||o===183||o>=768&&o<=879||o>=8255&&o<=8256}},{}],545:[function(t,n,i){function s(o){return o>=65&&o<=90||o===95||o>=97&&o<=122||o>=192&&o<=214||o>=216&&o<=246||o>=248&&o<=767||o>=880&&o<=893||o>=895&&o<=8191||o>=8204&&o<=8205||o>=8304&&o<=8591||o>=11264&&o<=12271||o>=12289&&o<=55295||o>=63744&&o<=64975||o>=65008&&o<=65533||o>=65536&&o<=983039}Object.defineProperty(i,"__esModule",{value:!0}),i.NC_NAME_START_CHAR="A-Z_a-z------------",i.NC_NAME_CHAR="-"+i.NC_NAME_START_CHAR+".0-9--",i.NC_NAME_START_CHAR_RE=new RegExp("^["+i.NC_NAME_START_CHAR+"]$","u"),i.NC_NAME_CHAR_RE=new RegExp("^["+i.NC_NAME_CHAR+"]$","u"),i.NC_NAME_RE=new RegExp("^["+i.NC_NAME_START_CHAR+"]["+i.NC_NAME_CHAR+"]*$","u"),i.isNCNameStartChar=s,i.isNCNameChar=function(o){return s(o)||o===45||o===46||o>=48&&o<=57||o===183||o>=768&&o<=879||o>=8255&&o<=8256}},{}]},{},[15])(15)}))})(jm)),jm.exports}var Ck=Ak();const Tw=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Nk=r=>r.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase()),Mk=r=>{const e=Nk(r);return e.charAt(0).toUpperCase()+e.slice(1)},Ok=(...r)=>r.filter((e,t,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===t).join(" ").trim(),Rw=r=>r==="";var Cu={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};const Ik=({name:r,iconNode:e,absoluteStrokeWidth:t,"absolute-stroke-width":n,strokeWidth:i,"stroke-width":s,size:o=Cu.width,color:a=Cu.stroke,...l},{slots:u})=>Fs("svg",{...Cu,...l,width:o,height:o,stroke:a,"stroke-width":Rw(t)||Rw(n)||t===!0||n===!0?Number(i||s||Cu["stroke-width"])*24/Number(o):i||s||Cu["stroke-width"],class:Ok("lucide",l.class,...r?[`lucide-${Tw(Mk(r))}-icon`,`lucide-${Tw(r)}`]:["lucide-icon"])},[...e.map(c=>Fs(...c)),...u.default?[u.default()]:[]]);const Kr=(r,e)=>(t,{slots:n,attrs:i})=>Fs(Ik,{...i,...t,iconNode:e,name:r},n);const kk=Kr("arrow-down",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);const Pk=Kr("arrow-up",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);const Pc=Kr("chart-column",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);const tR=Kr("chart-line",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]]);const rR=Kr("chart-pie",[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]]);const Fk=Kr("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);const nR=Kr("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);const iR=Kr("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);const Lk=Kr("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);const Dk=Kr("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);const tv=Kr("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);const Bk=Kr("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);const Uk=Kr("file-text",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);const Vk=Kr("layers",[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]]);const jk=Kr("pen-line",[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);const $k=Kr("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);const dc=Kr("settings-2",[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]]);const zk=Kr("sheet",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["line",{x1:"3",x2:"21",y1:"9",y2:"9",key:"1vqk6q"}],["line",{x1:"3",x2:"21",y1:"15",y2:"15",key:"o2sbyz"}],["line",{x1:"9",x2:"9",y1:"9",y2:"21",key:"1ib60c"}],["line",{x1:"15",x2:"15",y1:"9",y2:"21",key:"1n26ft"}]]);const sR=Kr("tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);const Hk=Kr("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);const oR=Kr("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function aR(r){var e,t,n="";if(typeof r=="string"||typeof r=="number")n+=r;else if(typeof r=="object")if(Array.isArray(r)){var i=r.length;for(e=0;e<i;e++)r[e]&&(t=aR(r[e]))&&(n&&(n+=" "),n+=t)}else for(t in r)r[t]&&(n&&(n+=" "),n+=t);return n}function lR(){for(var r,e,t=0,n="",i=arguments.length;t<i;t++)(r=arguments[t])&&(e=aR(r))&&(n&&(n+=" "),n+=e);return n}const Aw=r=>typeof r=="boolean"?`${r}`:r===0?"0":r,Cw=lR,uR=(r,e)=>t=>{var n;if(e?.variants==null)return Cw(r,t?.class,t?.className);const{variants:i,defaultVariants:s}=e,o=Object.keys(i).map(u=>{const c=t?.[u],d=s?.[u];if(c===null)return null;const h=Aw(c)||Aw(d);return i[u][h]}),a=t&&Object.entries(t).reduce((u,c)=>{let[d,h]=c;return h===void 0||(u[d]=h),u},{}),l=e==null||(n=e.compoundVariants)===null||n===void 0?void 0:n.reduce((u,c)=>{let{class:d,className:h,...f}=c;return Object.entries(f).every(m=>{let[p,g]=m;return Array.isArray(g)?g.includes({...s,...a}[p]):{...s,...a}[p]===g})?[...u,d,h]:u},[]);return Cw(r,o,l,t?.class,t?.className)};function Nw(r){return typeof r=="string"?`'${r}'`:new Wk().serialize(r)}const Wk=(function(){class r{#e=new Map;compare(t,n){const i=typeof t,s=typeof n;return i==="string"&&s==="string"?t.localeCompare(n):i==="number"&&s==="number"?t-n:String.prototype.localeCompare.call(this.serialize(t,!0),this.serialize(n,!0))}serialize(t,n){if(t===null)return"null";switch(typeof t){case"string":return n?t:`'${t}'`;case"bigint":return`${t}n`;case"object":return this.$object(t);case"function":return this.$function(t)}return String(t)}serializeObject(t){const n=Object.prototype.toString.call(t);if(n!=="[object Object]")return this.serializeBuiltInType(n.length<10?`unknown:${n}`:n.slice(8,-1),t);const i=t.constructor,s=i===Object||i===void 0?"":i.name;if(s!==""&&globalThis[s]===i)return this.serializeBuiltInType(s,t);if(typeof t.toJSON=="function"){const o=t.toJSON();return s+(o!==null&&typeof o=="object"?this.$object(o):`(${this.serialize(o)})`)}return this.serializeObjectEntries(s,Object.entries(t))}serializeBuiltInType(t,n){const i=this["$"+t];if(i)return i.call(this,n);if(typeof n?.entries=="function")return this.serializeObjectEntries(t,n.entries());throw new Error(`Cannot serialize ${t}`)}serializeObjectEntries(t,n){const i=Array.from(n).sort((o,a)=>this.compare(o[0],a[0]));let s=`${t}{`;for(let o=0;o<i.length;o++){const[a,l]=i[o];s+=`${this.serialize(a,!0)}:${this.serialize(l)}`,o<i.length-1&&(s+=",")}return s+"}"}$object(t){let n=this.#e.get(t);return n===void 0&&(this.#e.set(t,`#${this.#e.size}`),n=this.serializeObject(t),this.#e.set(t,n)),n}$function(t){const n=Function.prototype.toString.call(t);return n.slice(-15)==="[native code] }"?`${t.name||""}()[native]`:`${t.name}(${t.length})${n.replace(/\s*\n\s*/g,"")}`}$Array(t){let n="[";for(let i=0;i<t.length;i++)n+=this.serialize(t[i]),i<t.length-1&&(n+=",");return n+"]"}$Date(t){try{return`Date(${t.toISOString()})`}catch{return"Date(null)"}}$ArrayBuffer(t){return`ArrayBuffer[${new Uint8Array(t).join(",")}]`}$Set(t){return`Set${this.$Array(Array.from(t).sort((n,i)=>this.compare(n,i)))}`}$Map(t){return this.serializeObjectEntries("Map",t.entries())}}for(const e of["Error","RegExp","URL"])r.prototype["$"+e]=function(t){return`${e}(${t})`};for(const e of["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"])r.prototype["$"+e]=function(t){return`${e}[${t.join(",")}]`};for(const e of["BigInt64Array","BigUint64Array"])r.prototype["$"+e]=function(t){return`${e}[${t.join("n,")}${t.length>0?"n":""}]`};return r})();function Gk(r,e){return r===e||Nw(r)===Nw(e)}function Mw(r,e=Number.NEGATIVE_INFINITY,t=Number.POSITIVE_INFINITY){return Math.min(t,Math.max(e,r))}function Mn(r,e){const t=typeof r=="string"&&!e?`${r}Context`:e,n=Symbol(t);return[o=>{const a=Ui(n,o);if(a||a===null)return a;throw new Error(`Injection \`${n.toString()}\` not found. Component must be used within ${Array.isArray(r)?`one of the following components: ${r.join(", ")}`:`\`${r}\``}`)},o=>(ts(n,o),o)]}function Hn(){let r=document.activeElement;if(r==null)return null;for(;r!=null&&r.shadowRoot!=null&&r.shadowRoot.activeElement!=null;)r=r.shadowRoot.activeElement;return r}function rv(r,e,t){const n=t.originalEvent.target,i=new CustomEvent(r,{bubbles:!1,cancelable:!0,detail:t});e&&n.addEventListener(r,e,{once:!0}),n.dispatchEvent(i)}function o0(r){return r==null}function nv(r){return r?r.flatMap(e=>e.type===Tt?nv(e.children):[e]):[]}const qk=["INPUT","TEXTAREA"];function Yk(r,e,t,n={}){if(!e||n.enableIgnoredElement&&qk.includes(e.nodeName))return null;const{arrowKeyOptions:i="both",attributeName:s="[data-reka-collection-item]",itemsArray:o=[],loop:a=!0,dir:l="ltr",preventScroll:u=!0,focus:c=!1}=n,[d,h,f,m,p,g]=[r.key==="ArrowRight",r.key==="ArrowLeft",r.key==="ArrowUp",r.key==="ArrowDown",r.key==="Home",r.key==="End"],v=f||m,y=d||h;if(!p&&!g&&(!v&&!y||i==="vertical"&&y||i==="horizontal"&&v))return null;const b=t?Array.from(t.querySelectorAll(s)):o;if(!b.length)return null;u&&r.preventDefault();let E=null;return y||v?E=cR(b,e,{goForward:v?m:l==="ltr"?d:h,loop:a}):p?E=b.at(0)||null:g&&(E=b.at(-1)||null),c&&E?.focus(),E}function cR(r,e,t,n=r.length){if(--n===0)return null;const i=r.indexOf(e),s=t.goForward?i+1:i-1;if(!t.loop&&(s<0||s>=r.length))return null;const o=(s+r.length)%r.length,a=r[o];return a?a.hasAttribute("disabled")&&a.getAttribute("disabled")!=="false"?cR(r,a,t,n):a:null}const[iv]=Mn("ConfigProvider");function Xk(r,e){var t;const n=wp();return An(()=>{n.value=r()},{...e,flush:(t=e?.flush)!==null&&t!==void 0?t:"sync"}),qd(n)}function sv(r,e){return oy()?(q2(r,e),!0):!1}function Kk(r){let e=!1,t;const n=G2(!0);return((...i)=>(e||(t=n.run(()=>r(...i)),e=!0),t))}const Qs=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Zk=r=>typeof r<"u",Qk=Object.prototype.toString,Jk=r=>Qk.call(r)==="[object Object]",Ow=e9();function e9(){var r,e,t;return Qs&&!!(!((r=window)===null||r===void 0||(r=r.navigator)===null||r===void 0)&&r.userAgent)&&(/iP(?:ad|hone|od)/.test(window.navigator.userAgent)||((e=window)===null||e===void 0||(e=e.navigator)===null||e===void 0?void 0:e.maxTouchPoints)>2&&/iPad|Macintosh/.test((t=window)===null||t===void 0?void 0:t.navigator.userAgent))}function $m(r){return Array.isArray(r)?r:[r]}function t9(r){return Ys()}function hR(r){if(!Qs)return r;let e=0,t,n;const i=()=>{e-=1,n&&e<=0&&(n.stop(),t=void 0,n=void 0)};return((...s)=>(e+=1,n||(n=G2(!0),t=n.run(()=>r(...s))),sv(i),t))}function r9(r){return Vs(Cr(r)?new Proxy({},{get(e,t,n){return q(Reflect.get(r.value,t,n))},set(e,t,n){return Cr(r.value[t])&&!Cr(n)?r.value[t].value=n:r.value[t]=n,!0},deleteProperty(e,t){return Reflect.deleteProperty(r.value,t)},has(e,t){return Reflect.has(r.value,t)},ownKeys(){return Object.keys(r.value)},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}}}):r)}function n9(r){return r9(Te(r))}function Dr(r,...e){const t=e.flat(),n=t[0];return n9(()=>Object.fromEntries(typeof n=="function"?Object.entries(Rn(r)).filter(([i,s])=>!n(zn(s),i)):Object.entries(Rn(r)).filter(i=>!t.includes(i[0]))))}function i9(r,e=1e4){return M4((t,n)=>{let i=zn(r),s;const o=()=>setTimeout(()=>{i=zn(r),n()},zn(e));return sv(()=>{clearTimeout(s)}),{get(){return t(),i},set(a){i=a,n(),clearTimeout(s),s=o()}}})}function s9(r,e){t9()&&Sp(r,e)}function o9(r,e,t){return jt(r,e,{...t,immediate:!0})}const Hp=Qs?window:void 0;function Ws(r){var e;const t=zn(r);return(e=t?.$el)!==null&&e!==void 0?e:t}function Cf(...r){const e=(n,i,s,o)=>(n.addEventListener(i,s,o),()=>n.removeEventListener(i,s,o)),t=Te(()=>{const n=$m(zn(r[0])).filter(i=>i!=null);return n.every(i=>typeof i!="string")?n:void 0});return o9(()=>{var n,i;return[(n=(i=t.value)===null||i===void 0?void 0:i.map(s=>Ws(s)))!==null&&n!==void 0?n:[Hp].filter(s=>s!=null),$m(zn(t.value?r[1]:r[0])),$m(q(t.value?r[2]:r[1])),zn(t.value?r[3]:r[2])]},([n,i,s,o],a,l)=>{if(!n?.length||!i?.length||!s?.length)return;const u=Jk(o)?{...o}:o,c=n.flatMap(d=>i.flatMap(h=>s.map(f=>e(d,h,f,u))));l(()=>{c.forEach(d=>d())})},{flush:"post"})}function dR(){const r=wp(!1),e=Ys();return e&&Lr(()=>{r.value=!0},e),r}function a9(r){const e=dR();return Te(()=>(e.value,!!r()))}function l9(r){return typeof r=="function"?r:typeof r=="string"?e=>e.key===r:Array.isArray(r)?e=>r.includes(e.key):()=>!0}function u9(...r){let e,t,n={};r.length===3?(e=r[0],t=r[1],n=r[2]):r.length===2?typeof r[1]=="object"?(e=!0,t=r[0],n=r[1]):(e=r[0],t=r[1]):(e=!0,t=r[0]);const{target:i=Hp,eventName:s="keydown",passive:o=!1,dedupe:a=!1}=n,l=l9(e);return Cf(i,s,c=>{c.repeat&&zn(a)||l(c)&&t(c)},o)}function c9(r){return JSON.parse(JSON.stringify(r))}function h9(r,e,t={}){const{window:n=Hp,...i}=t;let s;const o=a9(()=>n&&"ResizeObserver"in n),a=()=>{s&&(s.disconnect(),s=void 0)},l=jt(Te(()=>{const c=zn(r);return Array.isArray(c)?c.map(d=>Ws(d)):[Ws(c)]}),c=>{if(a(),o.value&&n){s=new ResizeObserver(e);for(const d of c)d&&s.observe(d,i)}},{immediate:!0,flush:"post"}),u=()=>{a(),l()};return sv(u),{isSupported:o,stop:u}}function hs(r,e,t,n={}){var i,s;const{clone:o=!1,passive:a=!1,eventName:l,deep:u=!1,defaultValue:c,shouldEmit:d}=n,h=Ys(),f=t||h?.emit||(h==null||(i=h.$emit)===null||i===void 0?void 0:i.bind(h))||(h==null||(s=h.proxy)===null||s===void 0||(s=s.$emit)===null||s===void 0?void 0:s.bind(h?.proxy));let m=l;e||(e="modelValue"),m=m||`update:${e.toString()}`;const p=y=>o?typeof o=="function"?o(y):c9(y):y,g=()=>Zk(r[e])?p(r[e]):c,v=y=>{d?d(y)&&f(m,y):f(m,y)};if(a){const y=Ce(g());let b=!1;return jt(()=>r[e],E=>{b||(b=!0,y.value=p(E),br(()=>b=!1))}),jt(y,E=>{!b&&(E!==r[e]||u)&&v(E)},{deep:u}),y}else return Te({get(){return g()},set(y){v(y)}})}function zm(r){if(r===null||typeof r!="object")return!1;const e=Object.getPrototypeOf(r);return e!==null&&e!==Object.prototype&&Object.getPrototypeOf(e)!==null||Symbol.iterator in r?!1:Symbol.toStringTag in r?Object.prototype.toString.call(r)==="[object Module]":!0}function a0(r,e,t=".",n){if(!zm(e))return a0(r,{},t,n);const i=Object.assign({},e);for(const s in r){if(s==="__proto__"||s==="constructor")continue;const o=r[s];o!=null&&(n&&n(i,s,o,t)||(Array.isArray(o)&&Array.isArray(i[s])?i[s]=[...o,...i[s]]:zm(o)&&zm(i[s])?i[s]=a0(o,i[s],(t?`${t}.`:"")+s.toString(),n):i[s]=o))}return i}function d9(r){return(...e)=>e.reduce((t,n)=>a0(t,n,"",r),{})}const f9=d9(),p9=hR(()=>{const r=Ce(new Map),e=Ce(),t=Te(()=>{for(const o of r.value.values())if(o)return!0;return!1}),n=iv({scrollBody:Ce(!0)});let i=null;const s=()=>{document.body.style.paddingRight="",document.body.style.marginRight="",document.body.style.pointerEvents="",document.documentElement.style.removeProperty("--scrollbar-width"),document.body.style.overflow=e.value??"",Ow&&i?.(),e.value=void 0};return jt(t,(o,a)=>{if(!Qs)return;if(!o){a&&s();return}e.value===void 0&&(e.value=document.body.style.overflow);const l=window.innerWidth-document.documentElement.clientWidth,u={padding:l,margin:0},c=n.scrollBody?.value?typeof n.scrollBody.value=="object"?f9({padding:n.scrollBody.value.padding===!0?l:n.scrollBody.value.padding,margin:n.scrollBody.value.margin===!0?l:n.scrollBody.value.margin},u):u:{padding:0,margin:0};l>0&&(document.body.style.paddingRight=typeof c.padding=="number"?`${c.padding}px`:String(c.padding),document.body.style.marginRight=typeof c.margin=="number"?`${c.margin}px`:String(c.margin),document.documentElement.style.setProperty("--scrollbar-width",`${l}px`),document.body.style.overflow="hidden"),Ow&&(i=Cf(document,"touchmove",d=>m9(d),{passive:!1})),br(()=>{document.body.style.pointerEvents="none",document.body.style.overflow="hidden"})},{immediate:!0,flush:"sync"}),r});function ov(r){const e=Math.random().toString(36).substring(2,7),t=p9();t.value.set(e,r??!1);const n=Te({get:()=>t.value.get(e)??!1,set:i=>t.value.set(e,i)});return s9(()=>{t.value.delete(e)}),n}function fR(r){const e=window.getComputedStyle(r);if(e.overflowX==="scroll"||e.overflowY==="scroll"||e.overflowX==="auto"&&r.clientWidth<r.scrollWidth||e.overflowY==="auto"&&r.clientHeight<r.scrollHeight)return!0;{const t=r.parentNode;return!(t instanceof Element)||t.tagName==="BODY"?!1:fR(t)}}function m9(r){const e=r||window.event,t=e.target;return t instanceof Element&&fR(t)?!1:e.touches.length>1?!0:(e.preventDefault&&e.cancelable&&e.preventDefault(),!1)}function rh(r){const e=iv({dir:Ce("ltr")});return Te(()=>r?.value||e.dir?.value||"ltr")}function nh(r){const e=Ys(),t=e?.type.emits,n={};return t?.length||console.warn(`No emitted event found. Please check component: ${e?.type.__name}`),t?.forEach(i=>{n[ad(Wn(i))]=(...s)=>r(i,...s)}),n}let Hm=0;function pR(){An(r=>{if(!Qs)return;const e=document.querySelectorAll("[data-reka-focus-guard]");document.body.insertAdjacentElement("afterbegin",e[0]??Iw()),document.body.insertAdjacentElement("beforeend",e[1]??Iw()),Hm++,r(()=>{Hm===1&&document.querySelectorAll("[data-reka-focus-guard]").forEach(t=>t.remove()),Hm--})})}function Iw(){const r=document.createElement("span");return r.setAttribute("data-reka-focus-guard",""),r.tabIndex=0,r.style.outline="none",r.style.opacity="0",r.style.position="fixed",r.style.pointerEvents="none",r}function mR(r){return Te(()=>zn(r)?!!Ws(r)?.closest("form"):!0)}function Ot(){const r=Ys(),e=Ce(),t=Te(()=>["#text","#comment"].includes(e.value?.$el.nodeName)?e.value?.$el.nextElementSibling:Ws(e)),n=Object.assign({},r.exposed),i={};for(const o in r.props)Object.defineProperty(i,o,{enumerable:!0,configurable:!0,get:()=>r.props[o]});if(Object.keys(n).length>0)for(const o in n)Object.defineProperty(i,o,{enumerable:!0,configurable:!0,get:()=>n[o]});Object.defineProperty(i,"$el",{enumerable:!0,configurable:!0,get:()=>r.vnode.el}),r.exposed=i;function s(o){if(e.value=o,!!o&&(Object.defineProperty(i,"$el",{enumerable:!0,configurable:!0,get:()=>o instanceof Element?o:o.$el}),!(o instanceof Element)&&!Object.hasOwn(o,"$el"))){const a=o.$.exposed,l=Object.assign({},i);for(const u in a)Object.defineProperty(l,u,{enumerable:!0,configurable:!0,get:()=>a[u]});r.exposed=l}}return{forwardRef:s,currentRef:e,currentElement:t}}function pi(r){const e=Ys(),t=Object.keys(e?.type.props??{}).reduce((i,s)=>{const o=(e?.type.props[s]).default;return o!==void 0&&(i[s]=o),i},{}),n=k4(r);return Te(()=>{const i={},s=e?.vnode.props??{};return Object.keys(s).forEach(o=>{i[Wn(o)]=s[o]}),Object.keys({...t,...i}).reduce((o,a)=>(n.value[a]!==void 0&&(o[a]=n.value[a]),o),{})})}function On(r,e){const t=pi(r),n=e?nh(e):{};return Te(()=>({...t.value,...n}))}var g9=function(r){if(typeof document>"u")return null;var e=Array.isArray(r)?r[0]:r;return e.ownerDocument.body},Rl=new WeakMap,Hh=new WeakMap,Wh={},Wm=0,gR=function(r){return r&&(r.host||gR(r.parentNode))},y9=function(r,e){return e.map(function(t){if(r.contains(t))return t;var n=gR(t);return n&&r.contains(n)?n:(console.error("aria-hidden",t,"in not contained inside",r,". Doing nothing"),null)}).filter(function(t){return!!t})},v9=function(r,e,t,n){var i=y9(e,Array.isArray(r)?r:[r]);Wh[t]||(Wh[t]=new WeakMap);var s=Wh[t],o=[],a=new Set,l=new Set(i),u=function(d){!d||a.has(d)||(a.add(d),u(d.parentNode))};i.forEach(u);var c=function(d){!d||l.has(d)||Array.prototype.forEach.call(d.children,function(h){if(a.has(h))c(h);else try{var f=h.getAttribute(n),m=f!==null&&f!=="false",p=(Rl.get(h)||0)+1,g=(s.get(h)||0)+1;Rl.set(h,p),s.set(h,g),o.push(h),p===1&&m&&Hh.set(h,!0),g===1&&h.setAttribute(t,"true"),m||h.setAttribute(n,"true")}catch(v){console.error("aria-hidden: cannot operate on ",h,v)}})};return c(e),a.clear(),Wm++,function(){o.forEach(function(d){var h=Rl.get(d)-1,f=s.get(d)-1;Rl.set(d,h),s.set(d,f),h||(Hh.has(d)||d.removeAttribute(n),Hh.delete(d)),f||d.removeAttribute(t)}),Wm--,Wm||(Rl=new WeakMap,Rl=new WeakMap,Hh=new WeakMap,Wh={})}},b9=function(r,e,t){t===void 0&&(t="data-aria-hidden");var n=Array.from(Array.isArray(r)?r:[r]),i=g9(r);return i?(n.push.apply(n,Array.from(i.querySelectorAll("[aria-live], script"))),v9(n,i,t,"aria-hidden")):function(){return null}};function av(r){let e;jt(()=>Ws(r),t=>{t?e=b9(t):e&&e()}),Nn(()=>{e&&e()})}function Gi(r,e="reka"){return`${e}-${Y4?.()}`}function w9(r){const e=Ce(),t=Te(()=>e.value?.width??0),n=Te(()=>e.value?.height??0);return Lr(()=>{const i=Ws(r);if(i){e.value={width:i.offsetWidth,height:i.offsetHeight};const s=new ResizeObserver(o=>{if(!Array.isArray(o)||!o.length)return;const a=o[0];let l,u;if("borderBoxSize"in a){const c=a.borderBoxSize,d=Array.isArray(c)?c[0]:c;l=d.inlineSize,u=d.blockSize}else l=i.offsetWidth,u=i.offsetHeight;e.value={width:l,height:u}});return s.observe(i,{box:"border-box"}),()=>s.unobserve(i)}else e.value=void 0}),{width:t,height:n}}function _9(r,e){const t=Ce(r);function n(s){return e[t.value][s]??t.value}return{state:t,dispatch:s=>{t.value=n(s)}}}function lv(r){const e=i9("",1e3);return{search:e,handleTypeaheadSearch:(i,s)=>{e.value=e.value+i;{const o=Hn(),a=s.map(h=>({...h,textValue:h.value?.textValue??h.ref.textContent?.trim()??""})),l=a.find(h=>h.ref===o),u=a.map(h=>h.textValue),c=E9(u,e.value,l?.textValue),d=a.find(h=>h.textValue===c);return d&&d.ref.focus(),d?.ref}},resetTypeahead:()=>{e.value=""}}}function x9(r,e){return r.map((t,n)=>r[(e+n)%r.length])}function E9(r,e,t){const i=e.length>1&&Array.from(e).every(u=>u===e[0])?e[0]:e,s=t?r.indexOf(t):-1;let o=x9(r,Math.max(s,0));i.length===1&&(o=o.filter(u=>u!==t));const l=o.find(u=>u.toLowerCase().startsWith(i.toLowerCase()));return l!==t?l:void 0}function S9(r,e){const t=Ce({}),n=Ce("none"),i=Ce(r),s=r.value?"mounted":"unmounted";let o;const a=e.value?.ownerDocument.defaultView??Hp,{state:l,dispatch:u}=_9(s,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}}),c=g=>{if(Qs){const v=new CustomEvent(g,{bubbles:!1,cancelable:!1});e.value?.dispatchEvent(v)}};jt(r,async(g,v)=>{const y=v!==g;if(await br(),y){const b=n.value,E=Gh(e.value);g?(u("MOUNT"),c("enter"),E==="none"&&c("after-enter")):E==="none"||E==="undefined"||t.value?.display==="none"?(u("UNMOUNT"),c("leave"),c("after-leave")):v&&b!==E?(u("ANIMATION_OUT"),c("leave")):(u("UNMOUNT"),c("after-leave"))}},{immediate:!0});const d=g=>{const v=Gh(e.value),y=v.includes(CSS.escape(g.animationName)),b=l.value==="mounted"?"enter":"leave";if(g.target===e.value&&y&&(c(`after-${b}`),u("ANIMATION_END"),!i.value)){const E=e.value.style.animationFillMode;e.value.style.animationFillMode="forwards",o=a?.setTimeout(()=>{e.value?.style.animationFillMode==="forwards"&&(e.value.style.animationFillMode=E)})}g.target===e.value&&v==="none"&&u("ANIMATION_END")},h=g=>{g.target===e.value&&(n.value=Gh(e.value))},f=jt(e,(g,v)=>{g?(t.value=getComputedStyle(g),g.addEventListener("animationstart",h),g.addEventListener("animationcancel",d),g.addEventListener("animationend",d)):(u("ANIMATION_END"),o!==void 0&&a?.clearTimeout(o),v?.removeEventListener("animationstart",h),v?.removeEventListener("animationcancel",d),v?.removeEventListener("animationend",d))},{immediate:!0}),m=jt(l,()=>{const g=Gh(e.value);n.value=l.value==="mounted"?g:"none"});return Nn(()=>{f(),m()}),{isPresent:Te(()=>["mounted","unmountSuspended"].includes(l.value))}}function Gh(r){return r&&getComputedStyle(r).animationName||"none"}var vu=_e({name:"Presence",props:{present:{type:Boolean,required:!0},forceMount:{type:Boolean}},slots:{},setup(r,{slots:e,expose:t}){const{present:n,forceMount:i}=Rn(r),s=Ce(),{isPresent:o}=S9(n,s);t({present:o});let a=e.default({present:o.value});a=nv(a||[]);const l=Ys();if(a&&a?.length>1){const u=l?.parent?.type.name?`<${l.parent.type.name} />`:"component";throw new Error([`Detected an invalid children for \`${u}\` for  \`Presence\` component.`,"","Note: Presence works similarly to `v-if` directly, but it waits for animation/transition to finished before unmounting. So it expect only one direct child of valid VNode type.","You can apply a few solutions:",["Provide a single child element so that `presence` directive attach correctly.","Ensure the first child is an actual element instead of a raw text node or comment node."].map(c=>`  - ${c}`).join(`
`)].join(`
`))}return()=>i.value||n.value||o.value?Fs(e.default({present:o.value})[0],{ref:u=>{const c=Ws(u);return typeof c?.hasAttribute>"u"||(c?.hasAttribute("data-reka-popper-content-wrapper")?s.value=c.firstElementChild:s.value=c),c}}):null}});const l0=_e({name:"PrimitiveSlot",inheritAttrs:!1,setup(r,{attrs:e,slots:t}){return()=>{if(!t.default)return null;const n=nv(t.default()),i=n.findIndex(l=>l.type!==$s);if(i===-1)return n;const s=n[i];delete s.props?.ref;const o=s.props?et(e,s.props):e,a=Za({...s,props:{}},o);return n.length===1?a:(n[i]=a,n)}}}),T9=["area","img","input"],qt=_e({name:"Primitive",inheritAttrs:!1,props:{asChild:{type:Boolean,default:!1},as:{type:[String,Object],default:"div"}},setup(r,{attrs:e,slots:t}){const n=r.asChild?"template":r.as;return typeof n=="string"&&T9.includes(n)?()=>Fs(n,e):n!=="template"?()=>Fs(r.as,e,{default:t.default}):()=>Fs(l0,e,{default:t.default})}});function u0(){const r=Ce(),e=Te(()=>["#text","#comment"].includes(r.value?.$el.nodeName)?r.value?.$el.nextElementSibling:Ws(r));return{primitiveElement:r,currentElement:e}}const[Bo,R9]=Mn("DialogRoot");var A9=_e({inheritAttrs:!1,__name:"DialogRoot",props:{open:{type:Boolean,required:!1,default:void 0},defaultOpen:{type:Boolean,required:!1,default:!1},modal:{type:Boolean,required:!1,default:!0}},emits:["update:open"],setup(r,{emit:e}){const t=r,i=hs(t,"open",e,{defaultValue:t.defaultOpen,passive:t.open===void 0}),s=Ce(),o=Ce(),{modal:a}=Rn(t);return R9({open:i,modal:a,openModal:()=>{i.value=!0},onOpenChange:l=>{i.value=l},onOpenToggle:()=>{i.value=!i.value},contentId:"",titleId:"",descriptionId:"",triggerElement:s,contentElement:o}),(l,u)=>Re(l.$slots,"default",{open:q(i),close:()=>i.value=!1})}}),C9=A9,N9=_e({__name:"DialogClose",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"button"}},setup(r){const e=r;Ot();const t=Bo();return(n,i)=>(he(),Ee(q(qt),et(e,{type:n.as==="button"?"button":void 0,onClick:i[0]||(i[0]=s=>q(t).onOpenChange(!1))}),{default:de(()=>[Re(n.$slots,"default")]),_:3},16,["type"]))}}),M9=N9;const O9="dismissableLayer.pointerDownOutside",I9="dismissableLayer.focusOutside";function yR(r,e){const t=e.closest("[data-dismissable-layer]"),n=r.dataset.dismissableLayer===""?r:r.querySelector("[data-dismissable-layer]"),i=Array.from(r.ownerDocument.querySelectorAll("[data-dismissable-layer]"));return!!(t&&(n===t||i.indexOf(n)<i.indexOf(t)))}function k9(r,e,t=!0){const n=e?.value?.ownerDocument??globalThis?.document,i=Ce(!1),s=Ce(()=>{});return An(o=>{if(!Qs||!zn(t))return;const a=async u=>{const c=u.target;if(!(!e?.value||!c)){if(yR(e.value,c)){i.value=!1;return}if(u.target&&!i.value){let f=function(){rv(O9,r,h)};var d=f;const h={originalEvent:u};u.pointerType==="touch"?(n.removeEventListener("click",s.value),s.value=f,n.addEventListener("click",s.value,{once:!0})):f()}else n.removeEventListener("click",s.value);i.value=!1}},l=window.setTimeout(()=>{n.addEventListener("pointerdown",a)},0);o(()=>{window.clearTimeout(l),n.removeEventListener("pointerdown",a),n.removeEventListener("click",s.value)})}),{onPointerDownCapture:()=>{zn(t)&&(i.value=!0)}}}function P9(r,e,t=!0){const n=e?.value?.ownerDocument??globalThis?.document,i=Ce(!1);return An(s=>{if(!Qs||!zn(t))return;const o=async a=>{if(!e?.value)return;await br(),await br();const l=a.target;!e.value||!l||yR(e.value,l)||a.target&&!i.value&&rv(I9,r,{originalEvent:a})};n.addEventListener("focusin",o),s(()=>n.removeEventListener("focusin",o))}),{onFocusCapture:()=>{zn(t)&&(i.value=!0)},onBlurCapture:()=>{zn(t)&&(i.value=!1)}}}const Ii=Vs({layersRoot:new Set,layersWithOutsidePointerEventsDisabled:new Set,originalBodyPointerEvents:void 0,branches:new Set});var F9=_e({__name:"DismissableLayer",props:{disableOutsidePointerEvents:{type:Boolean,required:!1,default:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","dismiss"],setup(r,{emit:e}){const t=r,n=e,{forwardRef:i,currentElement:s}=Ot(),o=Te(()=>s.value?.ownerDocument??globalThis.document),a=Te(()=>Ii.layersRoot),l=Te(()=>s.value?Array.from(a.value).indexOf(s.value):-1),u=Te(()=>Ii.layersWithOutsidePointerEventsDisabled.size>0),c=Te(()=>{const f=Array.from(a.value),[m]=[...Ii.layersWithOutsidePointerEventsDisabled].slice(-1),p=f.indexOf(m);return l.value>=p}),d=k9(async f=>{const m=[...Ii.branches].some(p=>p?.contains(f.target));!c.value||m||(n("pointerDownOutside",f),n("interactOutside",f),await br(),f.defaultPrevented||n("dismiss"))},s),h=P9(f=>{[...Ii.branches].some(p=>p?.contains(f.target))||(n("focusOutside",f),n("interactOutside",f),f.defaultPrevented||n("dismiss"))},s);return u9("Escape",f=>{l.value===a.value.size-1&&(n("escapeKeyDown",f),f.defaultPrevented||n("dismiss"))}),An(f=>{s.value&&(t.disableOutsidePointerEvents&&(Ii.layersWithOutsidePointerEventsDisabled.size===0&&(Ii.originalBodyPointerEvents=o.value.body.style.pointerEvents,o.value.body.style.pointerEvents="none"),Ii.layersWithOutsidePointerEventsDisabled.add(s.value)),a.value.add(s.value),f(()=>{t.disableOutsidePointerEvents&&Ii.layersWithOutsidePointerEventsDisabled.size===1&&!o0(Ii.originalBodyPointerEvents)&&(o.value.body.style.pointerEvents=Ii.originalBodyPointerEvents)}))}),An(f=>{f(()=>{s.value&&(a.value.delete(s.value),Ii.layersWithOutsidePointerEventsDisabled.delete(s.value))})}),(f,m)=>(he(),Ee(q(qt),{ref:q(i),"as-child":f.asChild,as:f.as,"data-dismissable-layer":"",style:qs({pointerEvents:u.value?c.value?"auto":"none":void 0}),onFocusCapture:q(h).onFocusCapture,onBlurCapture:q(h).onBlurCapture,onPointerdownCapture:q(d).onPointerDownCapture},{default:de(()=>[Re(f.$slots,"default")]),_:3},8,["as-child","as","style","onFocusCapture","onBlurCapture","onPointerdownCapture"]))}}),uv=F9;const L9=Kk(()=>Ce([]));function D9(){const r=L9();return{add(e){const t=r.value[0];e!==t&&t?.pause(),r.value=kw(r.value,e),r.value.unshift(e)},remove(e){r.value=kw(r.value,e),r.value[0]?.resume()}}}function kw(r,e){const t=[...r],n=t.indexOf(e);return n!==-1&&t.splice(n,1),t}const Gm="focusScope.autoFocusOnMount",qm="focusScope.autoFocusOnUnmount",Pw={bubbles:!1,cancelable:!0};function B9(r,{select:e=!1}={}){const t=Hn();for(const n of r)if(Wo(n,{select:e}),Hn()!==t)return!0}function U9(r){const e=vR(r),t=Fw(e,r),n=Fw(e.reverse(),r);return[t,n]}function vR(r){const e=[],t=document.createTreeWalker(r,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const i=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||i?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)e.push(t.currentNode);return e}function Fw(r,e){for(const t of r)if(!V9(t,{upTo:e}))return t}function V9(r,{upTo:e}){if(getComputedStyle(r).visibility==="hidden")return!0;for(;r;){if(e!==void 0&&r===e)return!1;if(getComputedStyle(r).display==="none")return!0;r=r.parentElement}return!1}function j9(r){return r instanceof HTMLInputElement&&"select"in r}function Wo(r,{select:e=!1}={}){if(r&&r.focus){const t=Hn();r.focus({preventScroll:!0}),r!==t&&j9(r)&&e&&r.select()}}var $9=_e({__name:"FocusScope",props:{loop:{type:Boolean,required:!1,default:!1},trapped:{type:Boolean,required:!1,default:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["mountAutoFocus","unmountAutoFocus"],setup(r,{emit:e}){const t=r,n=e,{currentRef:i,currentElement:s}=Ot(),o=Ce(null),a=D9(),l=Vs({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}});An(c=>{if(!Qs)return;const d=s.value;if(!t.trapped)return;function h(g){if(l.paused||!d)return;const v=g.target;d.contains(v)?o.value=v:Wo(o.value,{select:!0})}function f(g){if(l.paused||!d)return;const v=g.relatedTarget;v!==null&&(d.contains(v)||Wo(o.value,{select:!0}))}function m(g){d.contains(o.value)||Wo(d)}document.addEventListener("focusin",h),document.addEventListener("focusout",f);const p=new MutationObserver(m);d&&p.observe(d,{childList:!0,subtree:!0}),c(()=>{document.removeEventListener("focusin",h),document.removeEventListener("focusout",f),p.disconnect()})}),An(async c=>{const d=s.value;if(await br(),!d)return;a.add(l);const h=Hn();if(!d.contains(h)){const m=new CustomEvent(Gm,Pw);d.addEventListener(Gm,p=>n("mountAutoFocus",p)),d.dispatchEvent(m),m.defaultPrevented||(B9(vR(d),{select:!0}),Hn()===h&&Wo(d))}c(()=>{d.removeEventListener(Gm,g=>n("mountAutoFocus",g));const m=new CustomEvent(qm,Pw),p=g=>{n("unmountAutoFocus",g)};d.addEventListener(qm,p),d.dispatchEvent(m),setTimeout(()=>{m.defaultPrevented||Wo(h??document.body,{select:!0}),d.removeEventListener(qm,p),a.remove(l)},0)})});function u(c){if(!t.loop&&!t.trapped||l.paused)return;const d=c.key==="Tab"&&!c.altKey&&!c.ctrlKey&&!c.metaKey,h=Hn();if(d&&h){const f=c.currentTarget,[m,p]=U9(f);m&&p?!c.shiftKey&&h===p?(c.preventDefault(),t.loop&&Wo(m,{select:!0})):c.shiftKey&&h===m&&(c.preventDefault(),t.loop&&Wo(p,{select:!0})):h===f&&c.preventDefault()}}return(c,d)=>(he(),Ee(q(qt),{ref_key:"currentRef",ref:i,tabindex:"-1","as-child":c.asChild,as:c.as,onKeydown:u},{default:de(()=>[Re(c.$slots,"default")]),_:3},8,["as-child","as"]))}}),cv=$9;const z9="menu.itemSelect",c0=["Enter"," "],H9=["ArrowDown","PageUp","Home"],bR=["ArrowUp","PageDown","End"],W9=[...H9,...bR],G9={ltr:[...c0,"ArrowRight"],rtl:[...c0,"ArrowLeft"]},q9={ltr:["ArrowLeft"],rtl:["ArrowRight"]};function hv(r){return r?"open":"closed"}function h0(r){const e=Hn();for(const t of r)if(t===e||(t.focus(),Hn()!==e))return}function Y9(r,e){const{x:t,y:n}=r;let i=!1;for(let s=0,o=e.length-1;s<e.length;o=s++){const a=e[s].x,l=e[s].y,u=e[o].x,c=e[o].y;l>n!=c>n&&t<(u-a)*(n-l)/(c-l)+a&&(i=!i)}return i}function X9(r,e){if(!e)return!1;const t={x:r.clientX,y:r.clientY};return Y9(t,e)}function Fc(r){return r.pointerType==="mouse"}var K9=_e({__name:"DialogContentImpl",props:{forceMount:{type:Boolean,required:!1},trapFocus:{type:Boolean,required:!1},disableOutsidePointerEvents:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(r,{emit:e}){const t=r,n=e,i=Bo(),{forwardRef:s,currentElement:o}=Ot();return i.titleId||=Gi(void 0,"reka-dialog-title"),i.descriptionId||=Gi(void 0,"reka-dialog-description"),Lr(()=>{i.contentElement=o,Hn()!==document.body&&(i.triggerElement.value=Hn())}),(a,l)=>(he(),Ee(q(cv),{"as-child":"",loop:"",trapped:t.trapFocus,onMountAutoFocus:l[5]||(l[5]=u=>n("openAutoFocus",u)),onUnmountAutoFocus:l[6]||(l[6]=u=>n("closeAutoFocus",u))},{default:de(()=>[ge(q(uv),et({id:q(i).contentId,ref:q(s),as:a.as,"as-child":a.asChild,"disable-outside-pointer-events":a.disableOutsidePointerEvents,role:"dialog","aria-describedby":q(i).descriptionId,"aria-labelledby":q(i).titleId,"data-state":q(hv)(q(i).open.value)},a.$attrs,{onDismiss:l[0]||(l[0]=u=>q(i).onOpenChange(!1)),onEscapeKeyDown:l[1]||(l[1]=u=>n("escapeKeyDown",u)),onFocusOutside:l[2]||(l[2]=u=>n("focusOutside",u)),onInteractOutside:l[3]||(l[3]=u=>n("interactOutside",u)),onPointerDownOutside:l[4]||(l[4]=u=>n("pointerDownOutside",u))}),{default:de(()=>[Re(a.$slots,"default")]),_:3},16,["id","as","as-child","disable-outside-pointer-events","aria-describedby","aria-labelledby","data-state"])]),_:3},8,["trapped"]))}}),wR=K9,Z9=_e({__name:"DialogContentModal",props:{forceMount:{type:Boolean,required:!1},trapFocus:{type:Boolean,required:!1},disableOutsidePointerEvents:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(r,{emit:e}){const t=r,n=e,i=Bo(),s=nh(n),{forwardRef:o,currentElement:a}=Ot();return av(a),(l,u)=>(he(),Ee(wR,et({...t,...q(s)},{ref:q(o),"trap-focus":q(i).open.value,"disable-outside-pointer-events":!0,onCloseAutoFocus:u[0]||(u[0]=c=>{c.defaultPrevented||(c.preventDefault(),q(i).triggerElement.value?.focus())}),onPointerDownOutside:u[1]||(u[1]=c=>{const d=c.detail.originalEvent,h=d.button===0&&d.ctrlKey===!0;(d.button===2||h)&&c.preventDefault()}),onFocusOutside:u[2]||(u[2]=c=>{c.preventDefault()})}),{default:de(()=>[Re(l.$slots,"default")]),_:3},16,["trap-focus"]))}}),Q9=Z9,J9=_e({__name:"DialogContentNonModal",props:{forceMount:{type:Boolean,required:!1},trapFocus:{type:Boolean,required:!1},disableOutsidePointerEvents:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(r,{emit:e}){const t=r,i=nh(e);Ot();const s=Bo(),o=Ce(!1),a=Ce(!1);return(l,u)=>(he(),Ee(wR,et({...t,...q(i)},{"trap-focus":!1,"disable-outside-pointer-events":!1,onCloseAutoFocus:u[0]||(u[0]=c=>{c.defaultPrevented||(o.value||q(s).triggerElement.value?.focus(),c.preventDefault()),o.value=!1,a.value=!1}),onInteractOutside:u[1]||(u[1]=c=>{c.defaultPrevented||(o.value=!0,c.detail.originalEvent.type==="pointerdown"&&(a.value=!0));const d=c.target;q(s).triggerElement.value?.contains(d)&&c.preventDefault(),c.detail.originalEvent.type==="focusin"&&a.value&&c.preventDefault()})}),{default:de(()=>[Re(l.$slots,"default")]),_:3},16))}}),e7=J9,t7=_e({__name:"DialogContent",props:{forceMount:{type:Boolean,required:!1},disableOutsidePointerEvents:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(r,{emit:e}){const t=r,n=e,i=Bo(),s=nh(n),{forwardRef:o}=Ot();return(a,l)=>(he(),Ee(q(vu),{present:a.forceMount||q(i).open.value},{default:de(()=>[q(i).modal.value?(he(),Ee(Q9,et({key:0,ref:q(o)},{...t,...q(s),...a.$attrs}),{default:de(()=>[Re(a.$slots,"default")]),_:3},16)):(he(),Ee(e7,et({key:1,ref:q(o)},{...t,...q(s),...a.$attrs}),{default:de(()=>[Re(a.$slots,"default")]),_:3},16))]),_:3},8,["present"]))}}),r7=t7,n7=_e({__name:"DialogDescription",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"p"}},setup(r){const e=r;Ot();const t=Bo();return(n,i)=>(he(),Ee(q(qt),et(e,{id:q(t).descriptionId}),{default:de(()=>[Re(n.$slots,"default")]),_:3},16,["id"]))}}),i7=n7,s7=_e({__name:"DialogOverlayImpl",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(r){const e=Bo();return ov(!0),Ot(),(t,n)=>(he(),Ee(q(qt),{as:t.as,"as-child":t.asChild,"data-state":q(e).open.value?"open":"closed",style:{"pointer-events":"auto"}},{default:de(()=>[Re(t.$slots,"default")]),_:3},8,["as","as-child","data-state"]))}}),o7=s7,a7=_e({__name:"DialogOverlay",props:{forceMount:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(r){const e=Bo(),{forwardRef:t}=Ot();return(n,i)=>q(e)?.modal.value?(he(),Ee(q(vu),{key:0,present:n.forceMount||q(e).open.value},{default:de(()=>[ge(o7,et(n.$attrs,{ref:q(t),as:n.as,"as-child":n.asChild}),{default:de(()=>[Re(n.$slots,"default")]),_:3},16,["as","as-child"])]),_:3},8,["present"])):zt("v-if",!0)}}),l7=a7,u7=_e({__name:"Teleport",props:{to:{type:null,required:!1,default:"body"},disabled:{type:Boolean,required:!1},defer:{type:Boolean,required:!1},forceMount:{type:Boolean,required:!1}},setup(r){const e=dR();return(t,n)=>q(e)||t.forceMount?(he(),Ee(Ex,{key:0,to:t.to,disabled:t.disabled,defer:t.defer},[Re(t.$slots,"default")],8,["to","disabled","defer"])):zt("v-if",!0)}}),dv=u7,c7=_e({__name:"DialogPortal",props:{to:{type:null,required:!1},disabled:{type:Boolean,required:!1},defer:{type:Boolean,required:!1},forceMount:{type:Boolean,required:!1}},setup(r){const e=r;return(t,n)=>(he(),Ee(q(dv),en(un(e)),{default:de(()=>[Re(t.$slots,"default")]),_:3},16))}}),h7=c7,d7=_e({__name:"DialogTitle",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"h2"}},setup(r){const e=r,t=Bo();return Ot(),(n,i)=>(he(),Ee(q(qt),et(e,{id:q(t).titleId}),{default:de(()=>[Re(n.$slots,"default")]),_:3},16,["id"]))}}),f7=d7;const Lw="data-reka-collection-item";function Uo(r={}){const{key:e="",isProvider:t=!1}=r,n=`${e}CollectionProvider`;let i;t?(i={collectionRef:Ce(),itemMap:Ce(new Map)},ts(n,i)):i=Ui(n);const s=(c=!1)=>{const d=i.collectionRef.value;if(!d)return[];const h=Array.from(d.querySelectorAll(`[${Lw}]`)),m=Array.from(i.itemMap.value.values()).sort((p,g)=>h.indexOf(p.ref)-h.indexOf(g.ref));return c?m:m.filter(p=>p.ref.dataset.disabled!=="")},o=_e({name:"CollectionSlot",inheritAttrs:!1,setup(c,{slots:d,attrs:h}){const{primitiveElement:f,currentElement:m}=u0();return jt(m,()=>{i.collectionRef.value=m.value}),()=>Fs(l0,{ref:f,...h},d)}}),a=_e({name:"CollectionItem",inheritAttrs:!1,props:{value:{validator:()=>!0}},setup(c,{slots:d,attrs:h}){const{primitiveElement:f,currentElement:m}=u0();return An(p=>{if(m.value){const g=cx(m.value);i.itemMap.value.set(g,{ref:m.value,value:c.value}),p(()=>i.itemMap.value.delete(g))}}),()=>Fs(l0,{...h,[Lw]:"",ref:f},d)}}),l=Te(()=>Array.from(i.itemMap.value.values())),u=Te(()=>i.itemMap.value.size);return{getItems:s,reactiveItems:l,itemMapSize:u,CollectionSlot:o,CollectionItem:a}}const p7="rovingFocusGroup.onEntryFocus",m7={bubbles:!1,cancelable:!0},g7={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function y7(r,e){return e!=="rtl"?r:r==="ArrowLeft"?"ArrowRight":r==="ArrowRight"?"ArrowLeft":r}function v7(r,e,t){const n=y7(r.key,t);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return g7[n]}function _R(r,e=!1){const t=Hn();for(const n of r)if(n===t||(n.focus({preventScroll:e}),Hn()!==t))return}function b7(r,e){return r.map((t,n)=>r[(e+n)%r.length])}const[w7,_7]=Mn("RovingFocusGroup");var x7=_e({__name:"RovingFocusGroup",props:{orientation:{type:String,required:!1,default:void 0},dir:{type:String,required:!1},loop:{type:Boolean,required:!1,default:!1},currentTabStopId:{type:[String,null],required:!1},defaultCurrentTabStopId:{type:String,required:!1},preventScrollOnEntryFocus:{type:Boolean,required:!1,default:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["entryFocus","update:currentTabStopId"],setup(r,{expose:e,emit:t}){const n=r,i=t,{loop:s,orientation:o,dir:a}=Rn(n),l=rh(a),u=hs(n,"currentTabStopId",i,{defaultValue:n.defaultCurrentTabStopId,passive:n.currentTabStopId===void 0}),c=Ce(!1),d=Ce(!1),h=Ce(0),{getItems:f,CollectionSlot:m}=Uo({isProvider:!0});function p(v){const y=!d.value;if(v.currentTarget&&v.target===v.currentTarget&&y&&!c.value){const b=new CustomEvent(p7,m7);if(v.currentTarget.dispatchEvent(b),i("entryFocus",b),!b.defaultPrevented){const E=f().map(P=>P.ref).filter(P=>P.dataset.disabled!==""),A=E.find(P=>P.getAttribute("data-active")===""),M=E.find(P=>P.getAttribute("data-highlighted")===""),L=E.find(P=>P.id===u.value),k=[A,M,L,...E].filter(Boolean);_R(k,n.preventScrollOnEntryFocus)}}d.value=!1}function g(){setTimeout(()=>{d.value=!1},1)}return e({getItems:f}),_7({loop:s,dir:l,orientation:o,currentTabStopId:u,onItemFocus:v=>{u.value=v},onItemShiftTab:()=>{c.value=!0},onFocusableItemAdd:()=>{h.value++},onFocusableItemRemove:()=>{h.value--}}),(v,y)=>(he(),Ee(q(m),null,{default:de(()=>[ge(q(qt),{tabindex:c.value||h.value===0?-1:0,"data-orientation":q(o),as:v.as,"as-child":v.asChild,dir:q(l),style:{outline:"none"},onMousedown:y[0]||(y[0]=b=>d.value=!0),onMouseup:g,onFocus:p,onBlur:y[1]||(y[1]=b=>c.value=!1)},{default:de(()=>[Re(v.$slots,"default")]),_:3},8,["tabindex","data-orientation","as","as-child","dir"])]),_:3}))}}),xR=x7,E7=_e({__name:"RovingFocusItem",props:{tabStopId:{type:String,required:!1},focusable:{type:Boolean,required:!1,default:!0},active:{type:Boolean,required:!1},allowShiftKey:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"span"}},setup(r){const e=r,t=w7(),n=Gi(),i=Te(()=>e.tabStopId||n),s=Te(()=>t.currentTabStopId.value===i.value),{getItems:o,CollectionItem:a}=Uo();Lr(()=>{e.focusable&&t.onFocusableItemAdd()}),Nn(()=>{e.focusable&&t.onFocusableItemRemove()});function l(u){if(u.key==="Tab"&&u.shiftKey){t.onItemShiftTab();return}if(u.target!==u.currentTarget)return;const c=v7(u,t.orientation.value,t.dir.value);if(c!==void 0){if(u.metaKey||u.ctrlKey||u.altKey||!e.allowShiftKey&&u.shiftKey)return;u.preventDefault();let d=[...o().map(h=>h.ref).filter(h=>h.dataset.disabled!=="")];if(c==="last")d.reverse();else if(c==="prev"||c==="next"){c==="prev"&&d.reverse();const h=d.indexOf(u.currentTarget);d=t.loop.value?b7(d,h+1):d.slice(h+1)}br(()=>_R(d))}}return(u,c)=>(he(),Ee(q(a),null,{default:de(()=>[ge(q(qt),{tabindex:s.value?0:-1,"data-orientation":q(t).orientation.value,"data-active":u.active?"":void 0,"data-disabled":u.focusable?void 0:"",as:u.as,"as-child":u.asChild,onMousedown:c[0]||(c[0]=d=>{u.focusable?q(t).onItemFocus(i.value):d.preventDefault()}),onFocus:c[1]||(c[1]=d=>q(t).onItemFocus(i.value)),onKeydown:l},{default:de(()=>[Re(u.$slots,"default")]),_:3},8,["tabindex","data-orientation","data-active","data-disabled","as","as-child"])]),_:3}))}}),S7=E7,T7=_e({__name:"VisuallyHidden",props:{feature:{type:String,required:!1,default:"focusable"},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"span"}},setup(r){return(e,t)=>(he(),Ee(q(qt),{as:e.as,"as-child":e.asChild,"aria-hidden":e.feature==="focusable"?"true":void 0,"data-hidden":e.feature==="fully-hidden"?"":void 0,tabindex:e.feature==="fully-hidden"?"-1":void 0,style:{position:"absolute",border:0,width:"1px",height:"1px",padding:0,margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",clipPath:"inset(50%)",whiteSpace:"nowrap",wordWrap:"normal",top:"-1px",left:"-1px"}},{default:de(()=>[Re(e.$slots,"default")]),_:3},8,["as","as-child","aria-hidden","data-hidden","tabindex"]))}}),ER=T7,R7=_e({inheritAttrs:!1,__name:"VisuallyHiddenInputBubble",props:{name:{type:String,required:!0},value:{type:null,required:!0},checked:{type:Boolean,required:!1,default:void 0},required:{type:Boolean,required:!1},disabled:{type:Boolean,required:!1},feature:{type:String,required:!1,default:"fully-hidden"}},setup(r){const e=r,{primitiveElement:t,currentElement:n}=u0(),i=Te(()=>e.checked??e.value);return jt(i,(s,o)=>{if(!n.value)return;const a=n.value,l=window.HTMLInputElement.prototype,c=Object.getOwnPropertyDescriptor(l,"value").set;if(c&&s!==o){const d=new Event("input",{bubbles:!0}),h=new Event("change",{bubbles:!0});c.call(a,s),a.dispatchEvent(d),a.dispatchEvent(h)}}),(s,o)=>(he(),Ee(ER,et({ref_key:"primitiveElement",ref:t},{...e,...s.$attrs},{as:"input"}),null,16))}}),Dw=R7,A7=_e({inheritAttrs:!1,__name:"VisuallyHiddenInput",props:{name:{type:String,required:!0},value:{type:null,required:!0},checked:{type:Boolean,required:!1,default:void 0},required:{type:Boolean,required:!1},disabled:{type:Boolean,required:!1},feature:{type:String,required:!1,default:"fully-hidden"}},setup(r){const e=r,t=Te(()=>typeof e.value=="object"&&Array.isArray(e.value)&&e.value.length===0&&e.required),n=Te(()=>typeof e.value=="string"||typeof e.value=="number"||typeof e.value=="boolean"||e.value===null||e.value===void 0?[{name:e.name,value:e.value}]:typeof e.value=="object"&&Array.isArray(e.value)?e.value.flatMap((i,s)=>typeof i=="object"?Object.entries(i).map(([o,a])=>({name:`${e.name}[${s}][${o}]`,value:a})):{name:`${e.name}[${s}]`,value:i}):e.value!==null&&typeof e.value=="object"&&!Array.isArray(e.value)?Object.entries(e.value).map(([i,s])=>({name:`${e.name}[${i}]`,value:s})):[]);return(i,s)=>(he(),ke(Tt,null,[zt(" We render single input if it's required "),t.value?(he(),Ee(Dw,et({key:i.name},{...e,...i.$attrs},{name:i.name,value:i.value}),null,16,["name","value"])):(he(!0),ke(Tt,{key:1},Er(n.value,o=>(he(),Ee(Dw,et({key:o.name},{ref_for:!0},{...e,...i.$attrs},{name:o.name,value:o.value}),null,16,["name","value"]))),128))],2112))}}),C7=A7;const[SR,N7]=Mn("PopperRoot");var M7=_e({inheritAttrs:!1,__name:"PopperRoot",setup(r){const e=Ce();return N7({anchor:e,onAnchorChange:t=>e.value=t}),(t,n)=>Re(t.$slots,"default")}}),fv=M7,O7=_e({__name:"PopperAnchor",props:{reference:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(r){const e=r,{forwardRef:t,currentElement:n}=Ot(),i=SR();return bx(()=>{i.onAnchorChange(e.reference??n.value)}),(s,o)=>(he(),Ee(q(qt),{ref:q(t),as:s.as,"as-child":s.asChild},{default:de(()=>[Re(s.$slots,"default")]),_:3},8,["as","as-child"]))}}),TR=O7;function I7(r){return r!==null}function k7(r){return{name:"transformOrigin",options:r,fn(e){const{placement:t,rects:n,middlewareData:i}=e,o=i.arrow?.centerOffset!==0,a=o?0:r.arrowWidth,l=o?0:r.arrowHeight,[u,c]=d0(t),d={start:"0%",center:"50%",end:"100%"}[c],h=(i.arrow?.x??0)+a/2,f=(i.arrow?.y??0)+l/2;let m="",p="";return u==="bottom"?(m=o?d:`${h}px`,p=`${-l}px`):u==="top"?(m=o?d:`${h}px`,p=`${n.floating.height+l}px`):u==="right"?(m=`${-l}px`,p=o?d:`${f}px`):u==="left"&&(m=`${n.floating.width+l}px`,p=o?d:`${f}px`),{data:{x:m,y:p}}}}}function d0(r){const[e,t="center"]=r.split("-");return[e,t]}const P7=["top","right","bottom","left"],fa=Math.min,bi=Math.max,Nf=Math.round,qh=Math.floor,Ds=r=>({x:r,y:r}),F7={left:"right",right:"left",bottom:"top",top:"bottom"},L7={start:"end",end:"start"};function f0(r,e,t){return bi(r,fa(e,t))}function Ao(r,e){return typeof r=="function"?r(e):r}function Co(r){return r.split("-")[0]}function bu(r){return r.split("-")[1]}function pv(r){return r==="x"?"y":"x"}function mv(r){return r==="y"?"height":"width"}const D7=new Set(["top","bottom"]);function Is(r){return D7.has(Co(r))?"y":"x"}function gv(r){return pv(Is(r))}function B7(r,e,t){t===void 0&&(t=!1);const n=bu(r),i=gv(r),s=mv(i);let o=i==="x"?n===(t?"end":"start")?"right":"left":n==="start"?"bottom":"top";return e.reference[s]>e.floating[s]&&(o=Mf(o)),[o,Mf(o)]}function U7(r){const e=Mf(r);return[p0(r),e,p0(e)]}function p0(r){return r.replace(/start|end/g,e=>L7[e])}const Bw=["left","right"],Uw=["right","left"],V7=["top","bottom"],j7=["bottom","top"];function $7(r,e,t){switch(r){case"top":case"bottom":return t?e?Uw:Bw:e?Bw:Uw;case"left":case"right":return e?V7:j7;default:return[]}}function z7(r,e,t,n){const i=bu(r);let s=$7(Co(r),t==="start",n);return i&&(s=s.map(o=>o+"-"+i),e&&(s=s.concat(s.map(p0)))),s}function Mf(r){return r.replace(/left|right|bottom|top/g,e=>F7[e])}function H7(r){return{top:0,right:0,bottom:0,left:0,...r}}function RR(r){return typeof r!="number"?H7(r):{top:r,right:r,bottom:r,left:r}}function Of(r){const{x:e,y:t,width:n,height:i}=r;return{width:n,height:i,top:t,left:e,right:e+n,bottom:t+i,x:e,y:t}}function Vw(r,e,t){let{reference:n,floating:i}=r;const s=Is(e),o=gv(e),a=mv(o),l=Co(e),u=s==="y",c=n.x+n.width/2-i.width/2,d=n.y+n.height/2-i.height/2,h=n[a]/2-i[a]/2;let f;switch(l){case"top":f={x:c,y:n.y-i.height};break;case"bottom":f={x:c,y:n.y+n.height};break;case"right":f={x:n.x+n.width,y:d};break;case"left":f={x:n.x-i.width,y:d};break;default:f={x:n.x,y:n.y}}switch(bu(e)){case"start":f[o]-=h*(t&&u?-1:1);break;case"end":f[o]+=h*(t&&u?-1:1);break}return f}const W7=async(r,e,t)=>{const{placement:n="bottom",strategy:i="absolute",middleware:s=[],platform:o}=t,a=s.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(e));let u=await o.getElementRects({reference:r,floating:e,strategy:i}),{x:c,y:d}=Vw(u,n,l),h=n,f={},m=0;for(let p=0;p<a.length;p++){const{name:g,fn:v}=a[p],{x:y,y:b,data:E,reset:A}=await v({x:c,y:d,initialPlacement:n,placement:h,strategy:i,middlewareData:f,rects:u,platform:o,elements:{reference:r,floating:e}});c=y??c,d=b??d,f={...f,[g]:{...f[g],...E}},A&&m<=50&&(m++,typeof A=="object"&&(A.placement&&(h=A.placement),A.rects&&(u=A.rects===!0?await o.getElementRects({reference:r,floating:e,strategy:i}):A.rects),{x:c,y:d}=Vw(u,h,l)),p=-1)}return{x:c,y:d,placement:h,strategy:i,middlewareData:f}};async function Lc(r,e){var t;e===void 0&&(e={});const{x:n,y:i,platform:s,rects:o,elements:a,strategy:l}=r,{boundary:u="clippingAncestors",rootBoundary:c="viewport",elementContext:d="floating",altBoundary:h=!1,padding:f=0}=Ao(e,r),m=RR(f),g=a[h?d==="floating"?"reference":"floating":d],v=Of(await s.getClippingRect({element:(t=await(s.isElement==null?void 0:s.isElement(g)))==null||t?g:g.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(a.floating)),boundary:u,rootBoundary:c,strategy:l})),y=d==="floating"?{x:n,y:i,width:o.floating.width,height:o.floating.height}:o.reference,b=await(s.getOffsetParent==null?void 0:s.getOffsetParent(a.floating)),E=await(s.isElement==null?void 0:s.isElement(b))?await(s.getScale==null?void 0:s.getScale(b))||{x:1,y:1}:{x:1,y:1},A=Of(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:y,offsetParent:b,strategy:l}):y);return{top:(v.top-A.top+m.top)/E.y,bottom:(A.bottom-v.bottom+m.bottom)/E.y,left:(v.left-A.left+m.left)/E.x,right:(A.right-v.right+m.right)/E.x}}const G7=r=>({name:"arrow",options:r,async fn(e){const{x:t,y:n,placement:i,rects:s,platform:o,elements:a,middlewareData:l}=e,{element:u,padding:c=0}=Ao(r,e)||{};if(u==null)return{};const d=RR(c),h={x:t,y:n},f=gv(i),m=mv(f),p=await o.getDimensions(u),g=f==="y",v=g?"top":"left",y=g?"bottom":"right",b=g?"clientHeight":"clientWidth",E=s.reference[m]+s.reference[f]-h[f]-s.floating[m],A=h[f]-s.reference[f],M=await(o.getOffsetParent==null?void 0:o.getOffsetParent(u));let L=M?M[b]:0;(!L||!await(o.isElement==null?void 0:o.isElement(M)))&&(L=a.floating[b]||s.floating[m]);const k=E/2-A/2,P=L/2-p[m]/2-1,U=fa(d[v],P),$=fa(d[y],P),V=U,R=L-p[m]-$,O=L/2-p[m]/2+k,T=f0(V,O,R),w=!l.arrow&&bu(i)!=null&&O!==T&&s.reference[m]/2-(O<V?U:$)-p[m]/2<0,x=w?O<V?O-V:O-R:0;return{[f]:h[f]+x,data:{[f]:T,centerOffset:O-T-x,...w&&{alignmentOffset:x}},reset:w}}}),q7=function(r){return r===void 0&&(r={}),{name:"flip",options:r,async fn(e){var t,n;const{placement:i,middlewareData:s,rects:o,initialPlacement:a,platform:l,elements:u}=e,{mainAxis:c=!0,crossAxis:d=!0,fallbackPlacements:h,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:m="none",flipAlignment:p=!0,...g}=Ao(r,e);if((t=s.arrow)!=null&&t.alignmentOffset)return{};const v=Co(i),y=Is(a),b=Co(a)===a,E=await(l.isRTL==null?void 0:l.isRTL(u.floating)),A=h||(b||!p?[Mf(a)]:U7(a)),M=m!=="none";!h&&M&&A.push(...z7(a,p,m,E));const L=[a,...A],k=await Lc(e,g),P=[];let U=((n=s.flip)==null?void 0:n.overflows)||[];if(c&&P.push(k[v]),d){const O=B7(i,o,E);P.push(k[O[0]],k[O[1]])}if(U=[...U,{placement:i,overflows:P}],!P.every(O=>O<=0)){var $,V;const O=((($=s.flip)==null?void 0:$.index)||0)+1,T=L[O];if(T&&(!(d==="alignment"?y!==Is(T):!1)||U.every(_=>Is(_.placement)===y?_.overflows[0]>0:!0)))return{data:{index:O,overflows:U},reset:{placement:T}};let w=(V=U.filter(x=>x.overflows[0]<=0).sort((x,_)=>x.overflows[1]-_.overflows[1])[0])==null?void 0:V.placement;if(!w)switch(f){case"bestFit":{var R;const x=(R=U.filter(_=>{if(M){const S=Is(_.placement);return S===y||S==="y"}return!0}).map(_=>[_.placement,_.overflows.filter(S=>S>0).reduce((S,C)=>S+C,0)]).sort((_,S)=>_[1]-S[1])[0])==null?void 0:R[0];x&&(w=x);break}case"initialPlacement":w=a;break}if(i!==w)return{reset:{placement:w}}}return{}}}};function jw(r,e){return{top:r.top-e.height,right:r.right-e.width,bottom:r.bottom-e.height,left:r.left-e.width}}function $w(r){return P7.some(e=>r[e]>=0)}const Y7=function(r){return r===void 0&&(r={}),{name:"hide",options:r,async fn(e){const{rects:t}=e,{strategy:n="referenceHidden",...i}=Ao(r,e);switch(n){case"referenceHidden":{const s=await Lc(e,{...i,elementContext:"reference"}),o=jw(s,t.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:$w(o)}}}case"escaped":{const s=await Lc(e,{...i,altBoundary:!0}),o=jw(s,t.floating);return{data:{escapedOffsets:o,escaped:$w(o)}}}default:return{}}}}},AR=new Set(["left","top"]);async function X7(r,e){const{placement:t,platform:n,elements:i}=r,s=await(n.isRTL==null?void 0:n.isRTL(i.floating)),o=Co(t),a=bu(t),l=Is(t)==="y",u=AR.has(o)?-1:1,c=s&&l?-1:1,d=Ao(e,r);let{mainAxis:h,crossAxis:f,alignmentAxis:m}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return a&&typeof m=="number"&&(f=a==="end"?m*-1:m),l?{x:f*c,y:h*u}:{x:h*u,y:f*c}}const K7=function(r){return r===void 0&&(r=0),{name:"offset",options:r,async fn(e){var t,n;const{x:i,y:s,placement:o,middlewareData:a}=e,l=await X7(e,r);return o===((t=a.offset)==null?void 0:t.placement)&&(n=a.arrow)!=null&&n.alignmentOffset?{}:{x:i+l.x,y:s+l.y,data:{...l,placement:o}}}}},Z7=function(r){return r===void 0&&(r={}),{name:"shift",options:r,async fn(e){const{x:t,y:n,placement:i}=e,{mainAxis:s=!0,crossAxis:o=!1,limiter:a={fn:g=>{let{x:v,y}=g;return{x:v,y}}},...l}=Ao(r,e),u={x:t,y:n},c=await Lc(e,l),d=Is(Co(i)),h=pv(d);let f=u[h],m=u[d];if(s){const g=h==="y"?"top":"left",v=h==="y"?"bottom":"right",y=f+c[g],b=f-c[v];f=f0(y,f,b)}if(o){const g=d==="y"?"top":"left",v=d==="y"?"bottom":"right",y=m+c[g],b=m-c[v];m=f0(y,m,b)}const p=a.fn({...e,[h]:f,[d]:m});return{...p,data:{x:p.x-t,y:p.y-n,enabled:{[h]:s,[d]:o}}}}}},Q7=function(r){return r===void 0&&(r={}),{options:r,fn(e){const{x:t,y:n,placement:i,rects:s,middlewareData:o}=e,{offset:a=0,mainAxis:l=!0,crossAxis:u=!0}=Ao(r,e),c={x:t,y:n},d=Is(i),h=pv(d);let f=c[h],m=c[d];const p=Ao(a,e),g=typeof p=="number"?{mainAxis:p,crossAxis:0}:{mainAxis:0,crossAxis:0,...p};if(l){const b=h==="y"?"height":"width",E=s.reference[h]-s.floating[b]+g.mainAxis,A=s.reference[h]+s.reference[b]-g.mainAxis;f<E?f=E:f>A&&(f=A)}if(u){var v,y;const b=h==="y"?"width":"height",E=AR.has(Co(i)),A=s.reference[d]-s.floating[b]+(E&&((v=o.offset)==null?void 0:v[d])||0)+(E?0:g.crossAxis),M=s.reference[d]+s.reference[b]+(E?0:((y=o.offset)==null?void 0:y[d])||0)-(E?g.crossAxis:0);m<A?m=A:m>M&&(m=M)}return{[h]:f,[d]:m}}}},J7=function(r){return r===void 0&&(r={}),{name:"size",options:r,async fn(e){var t,n;const{placement:i,rects:s,platform:o,elements:a}=e,{apply:l=()=>{},...u}=Ao(r,e),c=await Lc(e,u),d=Co(i),h=bu(i),f=Is(i)==="y",{width:m,height:p}=s.floating;let g,v;d==="top"||d==="bottom"?(g=d,v=h===(await(o.isRTL==null?void 0:o.isRTL(a.floating))?"start":"end")?"left":"right"):(v=d,g=h==="end"?"top":"bottom");const y=p-c.top-c.bottom,b=m-c.left-c.right,E=fa(p-c[g],y),A=fa(m-c[v],b),M=!e.middlewareData.shift;let L=E,k=A;if((t=e.middlewareData.shift)!=null&&t.enabled.x&&(k=b),(n=e.middlewareData.shift)!=null&&n.enabled.y&&(L=y),M&&!h){const U=bi(c.left,0),$=bi(c.right,0),V=bi(c.top,0),R=bi(c.bottom,0);f?k=m-2*(U!==0||$!==0?U+$:bi(c.left,c.right)):L=p-2*(V!==0||R!==0?V+R:bi(c.top,c.bottom))}await l({...e,availableWidth:k,availableHeight:L});const P=await o.getDimensions(a.floating);return m!==P.width||p!==P.height?{reset:{rects:!0}}:{}}}};function Wp(){return typeof window<"u"}function ll(r){return yv(r)?(r.nodeName||"").toLowerCase():"#document"}function Ti(r){var e;return(r==null||(e=r.ownerDocument)==null?void 0:e.defaultView)||window}function Js(r){var e;return(e=(yv(r)?r.ownerDocument:r.document)||window.document)==null?void 0:e.documentElement}function yv(r){return Wp()?r instanceof Node||r instanceof Ti(r).Node:!1}function ds(r){return Wp()?r instanceof Element||r instanceof Ti(r).Element:!1}function Gs(r){return Wp()?r instanceof HTMLElement||r instanceof Ti(r).HTMLElement:!1}function zw(r){return!Wp()||typeof ShadowRoot>"u"?!1:r instanceof ShadowRoot||r instanceof Ti(r).ShadowRoot}const eP=new Set(["inline","contents"]);function ih(r){const{overflow:e,overflowX:t,overflowY:n,display:i}=fs(r);return/auto|scroll|overlay|hidden|clip/.test(e+n+t)&&!eP.has(i)}const tP=new Set(["table","td","th"]);function rP(r){return tP.has(ll(r))}const nP=[":popover-open",":modal"];function Gp(r){return nP.some(e=>{try{return r.matches(e)}catch{return!1}})}const iP=["transform","translate","scale","rotate","perspective"],sP=["transform","translate","scale","rotate","perspective","filter"],oP=["paint","layout","strict","content"];function vv(r){const e=bv(),t=ds(r)?fs(r):r;return iP.some(n=>t[n]?t[n]!=="none":!1)||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||sP.some(n=>(t.willChange||"").includes(n))||oP.some(n=>(t.contain||"").includes(n))}function aP(r){let e=pa(r);for(;Gs(e)&&!au(e);){if(vv(e))return e;if(Gp(e))return null;e=pa(e)}return null}function bv(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const lP=new Set(["html","body","#document"]);function au(r){return lP.has(ll(r))}function fs(r){return Ti(r).getComputedStyle(r)}function qp(r){return ds(r)?{scrollLeft:r.scrollLeft,scrollTop:r.scrollTop}:{scrollLeft:r.scrollX,scrollTop:r.scrollY}}function pa(r){if(ll(r)==="html")return r;const e=r.assignedSlot||r.parentNode||zw(r)&&r.host||Js(r);return zw(e)?e.host:e}function CR(r){const e=pa(r);return au(e)?r.ownerDocument?r.ownerDocument.body:r.body:Gs(e)&&ih(e)?e:CR(e)}function Dc(r,e,t){var n;e===void 0&&(e=[]),t===void 0&&(t=!0);const i=CR(r),s=i===((n=r.ownerDocument)==null?void 0:n.body),o=Ti(i);if(s){const a=m0(o);return e.concat(o,o.visualViewport||[],ih(i)?i:[],a&&t?Dc(a):[])}return e.concat(i,Dc(i,[],t))}function m0(r){return r.parent&&Object.getPrototypeOf(r.parent)?r.frameElement:null}function NR(r){const e=fs(r);let t=parseFloat(e.width)||0,n=parseFloat(e.height)||0;const i=Gs(r),s=i?r.offsetWidth:t,o=i?r.offsetHeight:n,a=Nf(t)!==s||Nf(n)!==o;return a&&(t=s,n=o),{width:t,height:n,$:a}}function wv(r){return ds(r)?r:r.contextElement}function Ql(r){const e=wv(r);if(!Gs(e))return Ds(1);const t=e.getBoundingClientRect(),{width:n,height:i,$:s}=NR(e);let o=(s?Nf(t.width):t.width)/n,a=(s?Nf(t.height):t.height)/i;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const uP=Ds(0);function MR(r){const e=Ti(r);return!bv()||!e.visualViewport?uP:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function cP(r,e,t){return e===void 0&&(e=!1),!t||e&&t!==Ti(r)?!1:e}function tl(r,e,t,n){e===void 0&&(e=!1),t===void 0&&(t=!1);const i=r.getBoundingClientRect(),s=wv(r);let o=Ds(1);e&&(n?ds(n)&&(o=Ql(n)):o=Ql(r));const a=cP(s,t,n)?MR(s):Ds(0);let l=(i.left+a.x)/o.x,u=(i.top+a.y)/o.y,c=i.width/o.x,d=i.height/o.y;if(s){const h=Ti(s),f=n&&ds(n)?Ti(n):n;let m=h,p=m0(m);for(;p&&n&&f!==m;){const g=Ql(p),v=p.getBoundingClientRect(),y=fs(p),b=v.left+(p.clientLeft+parseFloat(y.paddingLeft))*g.x,E=v.top+(p.clientTop+parseFloat(y.paddingTop))*g.y;l*=g.x,u*=g.y,c*=g.x,d*=g.y,l+=b,u+=E,m=Ti(p),p=m0(m)}}return Of({width:c,height:d,x:l,y:u})}function Yp(r,e){const t=qp(r).scrollLeft;return e?e.left+t:tl(Js(r)).left+t}function OR(r,e){const t=r.getBoundingClientRect(),n=t.left+e.scrollLeft-Yp(r,t),i=t.top+e.scrollTop;return{x:n,y:i}}function hP(r){let{elements:e,rect:t,offsetParent:n,strategy:i}=r;const s=i==="fixed",o=Js(n),a=e?Gp(e.floating):!1;if(n===o||a&&s)return t;let l={scrollLeft:0,scrollTop:0},u=Ds(1);const c=Ds(0),d=Gs(n);if((d||!d&&!s)&&((ll(n)!=="body"||ih(o))&&(l=qp(n)),Gs(n))){const f=tl(n);u=Ql(n),c.x=f.x+n.clientLeft,c.y=f.y+n.clientTop}const h=o&&!d&&!s?OR(o,l):Ds(0);return{width:t.width*u.x,height:t.height*u.y,x:t.x*u.x-l.scrollLeft*u.x+c.x+h.x,y:t.y*u.y-l.scrollTop*u.y+c.y+h.y}}function dP(r){return Array.from(r.getClientRects())}function fP(r){const e=Js(r),t=qp(r),n=r.ownerDocument.body,i=bi(e.scrollWidth,e.clientWidth,n.scrollWidth,n.clientWidth),s=bi(e.scrollHeight,e.clientHeight,n.scrollHeight,n.clientHeight);let o=-t.scrollLeft+Yp(r);const a=-t.scrollTop;return fs(n).direction==="rtl"&&(o+=bi(e.clientWidth,n.clientWidth)-i),{width:i,height:s,x:o,y:a}}const Hw=25;function pP(r,e){const t=Ti(r),n=Js(r),i=t.visualViewport;let s=n.clientWidth,o=n.clientHeight,a=0,l=0;if(i){s=i.width,o=i.height;const c=bv();(!c||c&&e==="fixed")&&(a=i.offsetLeft,l=i.offsetTop)}const u=Yp(n);if(u<=0){const c=n.ownerDocument,d=c.body,h=getComputedStyle(d),f=c.compatMode==="CSS1Compat"&&parseFloat(h.marginLeft)+parseFloat(h.marginRight)||0,m=Math.abs(n.clientWidth-d.clientWidth-f);m<=Hw&&(s-=m)}else u<=Hw&&(s+=u);return{width:s,height:o,x:a,y:l}}const mP=new Set(["absolute","fixed"]);function gP(r,e){const t=tl(r,!0,e==="fixed"),n=t.top+r.clientTop,i=t.left+r.clientLeft,s=Gs(r)?Ql(r):Ds(1),o=r.clientWidth*s.x,a=r.clientHeight*s.y,l=i*s.x,u=n*s.y;return{width:o,height:a,x:l,y:u}}function Ww(r,e,t){let n;if(e==="viewport")n=pP(r,t);else if(e==="document")n=fP(Js(r));else if(ds(e))n=gP(e,t);else{const i=MR(r);n={x:e.x-i.x,y:e.y-i.y,width:e.width,height:e.height}}return Of(n)}function IR(r,e){const t=pa(r);return t===e||!ds(t)||au(t)?!1:fs(t).position==="fixed"||IR(t,e)}function yP(r,e){const t=e.get(r);if(t)return t;let n=Dc(r,[],!1).filter(a=>ds(a)&&ll(a)!=="body"),i=null;const s=fs(r).position==="fixed";let o=s?pa(r):r;for(;ds(o)&&!au(o);){const a=fs(o),l=vv(o);!l&&a.position==="fixed"&&(i=null),(s?!l&&!i:!l&&a.position==="static"&&!!i&&mP.has(i.position)||ih(o)&&!l&&IR(r,o))?n=n.filter(c=>c!==o):i=a,o=pa(o)}return e.set(r,n),n}function vP(r){let{element:e,boundary:t,rootBoundary:n,strategy:i}=r;const o=[...t==="clippingAncestors"?Gp(e)?[]:yP(e,this._c):[].concat(t),n],a=o[0],l=o.reduce((u,c)=>{const d=Ww(e,c,i);return u.top=bi(d.top,u.top),u.right=fa(d.right,u.right),u.bottom=fa(d.bottom,u.bottom),u.left=bi(d.left,u.left),u},Ww(e,a,i));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function bP(r){const{width:e,height:t}=NR(r);return{width:e,height:t}}function wP(r,e,t){const n=Gs(e),i=Js(e),s=t==="fixed",o=tl(r,!0,s,e);let a={scrollLeft:0,scrollTop:0};const l=Ds(0);function u(){l.x=Yp(i)}if(n||!n&&!s)if((ll(e)!=="body"||ih(i))&&(a=qp(e)),n){const f=tl(e,!0,s,e);l.x=f.x+e.clientLeft,l.y=f.y+e.clientTop}else i&&u();s&&!n&&i&&u();const c=i&&!n&&!s?OR(i,a):Ds(0),d=o.left+a.scrollLeft-l.x-c.x,h=o.top+a.scrollTop-l.y-c.y;return{x:d,y:h,width:o.width,height:o.height}}function Ym(r){return fs(r).position==="static"}function Gw(r,e){if(!Gs(r)||fs(r).position==="fixed")return null;if(e)return e(r);let t=r.offsetParent;return Js(r)===t&&(t=t.ownerDocument.body),t}function kR(r,e){const t=Ti(r);if(Gp(r))return t;if(!Gs(r)){let i=pa(r);for(;i&&!au(i);){if(ds(i)&&!Ym(i))return i;i=pa(i)}return t}let n=Gw(r,e);for(;n&&rP(n)&&Ym(n);)n=Gw(n,e);return n&&au(n)&&Ym(n)&&!vv(n)?t:n||aP(r)||t}const _P=async function(r){const e=this.getOffsetParent||kR,t=this.getDimensions,n=await t(r.floating);return{reference:wP(r.reference,await e(r.floating),r.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function xP(r){return fs(r).direction==="rtl"}const EP={convertOffsetParentRelativeRectToViewportRelativeRect:hP,getDocumentElement:Js,getClippingRect:vP,getOffsetParent:kR,getElementRects:_P,getClientRects:dP,getDimensions:bP,getScale:Ql,isElement:ds,isRTL:xP};function PR(r,e){return r.x===e.x&&r.y===e.y&&r.width===e.width&&r.height===e.height}function SP(r,e){let t=null,n;const i=Js(r);function s(){var a;clearTimeout(n),(a=t)==null||a.disconnect(),t=null}function o(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),s();const u=r.getBoundingClientRect(),{left:c,top:d,width:h,height:f}=u;if(a||e(),!h||!f)return;const m=qh(d),p=qh(i.clientWidth-(c+h)),g=qh(i.clientHeight-(d+f)),v=qh(c),b={rootMargin:-m+"px "+-p+"px "+-g+"px "+-v+"px",threshold:bi(0,fa(1,l))||1};let E=!0;function A(M){const L=M[0].intersectionRatio;if(L!==l){if(!E)return o();L?o(!1,L):n=setTimeout(()=>{o(!1,1e-7)},1e3)}L===1&&!PR(u,r.getBoundingClientRect())&&o(),E=!1}try{t=new IntersectionObserver(A,{...b,root:i.ownerDocument})}catch{t=new IntersectionObserver(A,b)}t.observe(r)}return o(!0),s}function TP(r,e,t,n){n===void 0&&(n={});const{ancestorScroll:i=!0,ancestorResize:s=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=n,u=wv(r),c=i||s?[...u?Dc(u):[],...Dc(e)]:[];c.forEach(v=>{i&&v.addEventListener("scroll",t,{passive:!0}),s&&v.addEventListener("resize",t)});const d=u&&a?SP(u,t):null;let h=-1,f=null;o&&(f=new ResizeObserver(v=>{let[y]=v;y&&y.target===u&&f&&(f.unobserve(e),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var b;(b=f)==null||b.observe(e)})),t()}),u&&!l&&f.observe(u),f.observe(e));let m,p=l?tl(r):null;l&&g();function g(){const v=tl(r);p&&!PR(p,v)&&t(),p=v,m=requestAnimationFrame(g)}return t(),()=>{var v;c.forEach(y=>{i&&y.removeEventListener("scroll",t),s&&y.removeEventListener("resize",t)}),d?.(),(v=f)==null||v.disconnect(),f=null,l&&cancelAnimationFrame(m)}}const RP=K7,AP=Z7,qw=q7,CP=J7,NP=Y7,MP=G7,OP=Q7,IP=(r,e,t)=>{const n=new Map,i={platform:EP,...t},s={...i.platform,_c:n};return W7(r,e,{...i,platform:s})};function kP(r){return r!=null&&typeof r=="object"&&"$el"in r}function g0(r){if(kP(r)){const e=r.$el;return yv(e)&&ll(e)==="#comment"?null:e}return r}function Ll(r){return typeof r=="function"?r():q(r)}function PP(r){return{name:"arrow",options:r,fn(e){const t=g0(Ll(r.element));return t==null?{}:MP({element:t,padding:r.padding}).fn(e)}}}function FR(r){return typeof window>"u"?1:(r.ownerDocument.defaultView||window).devicePixelRatio||1}function Yw(r,e){const t=FR(r);return Math.round(e*t)/t}function FP(r,e,t){t===void 0&&(t={});const n=t.whileElementsMounted,i=Te(()=>{var L;return(L=Ll(t.open))!=null?L:!0}),s=Te(()=>Ll(t.middleware)),o=Te(()=>{var L;return(L=Ll(t.placement))!=null?L:"bottom"}),a=Te(()=>{var L;return(L=Ll(t.strategy))!=null?L:"absolute"}),l=Te(()=>{var L;return(L=Ll(t.transform))!=null?L:!0}),u=Te(()=>g0(r.value)),c=Te(()=>g0(e.value)),d=Ce(0),h=Ce(0),f=Ce(a.value),m=Ce(o.value),p=wp({}),g=Ce(!1),v=Te(()=>{const L={position:f.value,left:"0",top:"0"};if(!c.value)return L;const k=Yw(c.value,d.value),P=Yw(c.value,h.value);return l.value?{...L,transform:"translate("+k+"px, "+P+"px)",...FR(c.value)>=1.5&&{willChange:"transform"}}:{position:f.value,left:k+"px",top:P+"px"}});let y;function b(){if(u.value==null||c.value==null)return;const L=i.value;IP(u.value,c.value,{middleware:s.value,placement:o.value,strategy:a.value}).then(k=>{d.value=k.x,h.value=k.y,f.value=k.strategy,m.value=k.placement,p.value=k.middlewareData,g.value=L!==!1})}function E(){typeof y=="function"&&(y(),y=void 0)}function A(){if(E(),n===void 0){b();return}if(u.value!=null&&c.value!=null){y=n(u.value,c.value,b);return}}function M(){i.value||(g.value=!1)}return jt([s,o,a,i],b,{flush:"sync"}),jt([u,c],A,{flush:"sync"}),jt(i,M,{flush:"sync"}),oy()&&q2(E),{x:_l(d),y:_l(h),strategy:_l(f),placement:_l(m),middlewareData:_l(p),isPositioned:_l(g),floatingStyles:v,update:b}}const LR={side:"bottom",sideOffset:0,sideFlip:!0,align:"center",alignOffset:0,alignFlip:!0,arrowPadding:0,hideShiftedArrow:!0,avoidCollisions:!0,collisionBoundary:()=>[],collisionPadding:0,sticky:"partial",hideWhenDetached:!1,positionStrategy:"fixed",updatePositionStrategy:"optimized",prioritizePosition:!1},[SK,LP]=Mn("PopperContent");var DP=_e({inheritAttrs:!1,__name:"PopperContent",props:Mx({side:{type:null,required:!1},sideOffset:{type:Number,required:!1},sideFlip:{type:Boolean,required:!1},align:{type:null,required:!1},alignOffset:{type:Number,required:!1},alignFlip:{type:Boolean,required:!1},avoidCollisions:{type:Boolean,required:!1},collisionBoundary:{type:null,required:!1},collisionPadding:{type:[Number,Object],required:!1},arrowPadding:{type:Number,required:!1},hideShiftedArrow:{type:Boolean,required:!1},sticky:{type:String,required:!1},hideWhenDetached:{type:Boolean,required:!1},positionStrategy:{type:String,required:!1},updatePositionStrategy:{type:String,required:!1},disableUpdateOnLayoutShift:{type:Boolean,required:!1},prioritizePosition:{type:Boolean,required:!1},reference:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},{...LR}),emits:["placed"],setup(r,{emit:e}){const t=r,n=e,i=SR(),{forwardRef:s,currentElement:o}=Ot(),a=Ce(),l=Ce(),{width:u,height:c}=w9(l),d=Te(()=>t.side+(t.align!=="center"?`-${t.align}`:"")),h=Te(()=>typeof t.collisionPadding=="number"?t.collisionPadding:{top:0,right:0,bottom:0,left:0,...t.collisionPadding}),f=Te(()=>Array.isArray(t.collisionBoundary)?t.collisionBoundary:[t.collisionBoundary]),m=Te(()=>({padding:h.value,boundary:f.value.filter(I7),altBoundary:f.value.length>0})),p=Te(()=>({mainAxis:t.sideFlip,crossAxis:t.alignFlip})),g=Xk(()=>[RP({mainAxis:t.sideOffset+c.value,alignmentAxis:t.alignOffset}),t.prioritizePosition&&t.avoidCollisions&&qw({...m.value,...p.value}),t.avoidCollisions&&AP({mainAxis:!0,crossAxis:!!t.prioritizePosition,limiter:t.sticky==="partial"?OP():void 0,...m.value}),!t.prioritizePosition&&t.avoidCollisions&&qw({...m.value,...p.value}),CP({...m.value,apply:({elements:V,rects:R,availableWidth:O,availableHeight:T})=>{const{width:w,height:x}=R.reference,_=V.floating.style;_.setProperty("--reka-popper-available-width",`${O}px`),_.setProperty("--reka-popper-available-height",`${T}px`),_.setProperty("--reka-popper-anchor-width",`${w}px`),_.setProperty("--reka-popper-anchor-height",`${x}px`)}}),l.value&&PP({element:l.value,padding:t.arrowPadding}),k7({arrowWidth:u.value,arrowHeight:c.value}),t.hideWhenDetached&&NP({strategy:"referenceHidden",...m.value})]),v=Te(()=>t.reference??i.anchor.value),{floatingStyles:y,placement:b,isPositioned:E,middlewareData:A}=FP(v,a,{strategy:t.positionStrategy,placement:d,whileElementsMounted:(...V)=>TP(...V,{layoutShift:!t.disableUpdateOnLayoutShift,animationFrame:t.updatePositionStrategy==="always"}),middleware:g}),M=Te(()=>d0(b.value)[0]),L=Te(()=>d0(b.value)[1]);bx(()=>{E.value&&n("placed")});const k=Te(()=>{const V=A.value.arrow?.centerOffset!==0;return t.hideShiftedArrow&&V}),P=Ce("");An(()=>{o.value&&(P.value=window.getComputedStyle(o.value).zIndex)});const U=Te(()=>A.value.arrow?.x??0),$=Te(()=>A.value.arrow?.y??0);return LP({placedSide:M,onArrowChange:V=>l.value=V,arrowX:U,arrowY:$,shouldHideArrow:k}),(V,R)=>(he(),ke("div",{ref_key:"floatingRef",ref:a,"data-reka-popper-content-wrapper":"",style:qs({...q(y),transform:q(E)?q(y).transform:"translate(0, -200%)",minWidth:"max-content",zIndex:P.value,"--reka-popper-transform-origin":[q(A).transformOrigin?.x,q(A).transformOrigin?.y].join(" "),...q(A).hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}})},[ge(q(qt),et({ref:q(s)},V.$attrs,{"as-child":t.asChild,as:V.as,"data-side":M.value,"data-align":L.value,style:{animation:q(E)?void 0:"none"}}),{default:de(()=>[Re(V.$slots,"default")]),_:3},16,["as-child","as","data-side","data-align","style"])],4))}}),DR=DP;function BP(r){const e=iv({nonce:Ce()});return Te(()=>r?.value||e.nonce?.value)}var UP=_e({__name:"MenuAnchor",props:{reference:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(r){const e=r;return(t,n)=>(he(),Ee(q(TR),en(un(e)),{default:de(()=>[Re(t.$slots,"default")]),_:3},16))}}),BR=UP;function VP(){const r=Ce(!1);return Lr(()=>{Cf("keydown",()=>{r.value=!0},{capture:!0,passive:!0}),Cf(["pointerdown","pointermove"],()=>{r.value=!1},{capture:!0,passive:!0})}),r}const jP=hR(VP),[ul,UR]=Mn(["MenuRoot","MenuSub"],"MenuContext"),[sh,$P]=Mn("MenuRoot");var zP=_e({__name:"MenuRoot",props:{open:{type:Boolean,required:!1,default:!1},dir:{type:String,required:!1},modal:{type:Boolean,required:!1,default:!0}},emits:["update:open"],setup(r,{emit:e}){const t=r,n=e,{modal:i,dir:s}=Rn(t),o=rh(s),a=hs(t,"open",n),l=Ce(),u=jP();return UR({open:a,onOpenChange:c=>{a.value=c},content:l,onContentChange:c=>{l.value=c}}),$P({onClose:()=>{a.value=!1},isUsingKeyboardRef:u,dir:o,modal:i}),(c,d)=>(he(),Ee(q(fv),null,{default:de(()=>[Re(c.$slots,"default")]),_:3}))}}),HP=zP;const[_v,WP]=Mn("MenuContent");var GP=_e({__name:"MenuContentImpl",props:Mx({loop:{type:Boolean,required:!1},disableOutsidePointerEvents:{type:Boolean,required:!1},disableOutsideScroll:{type:Boolean,required:!1},trapFocus:{type:Boolean,required:!1},side:{type:null,required:!1},sideOffset:{type:Number,required:!1},sideFlip:{type:Boolean,required:!1},align:{type:null,required:!1},alignOffset:{type:Number,required:!1},alignFlip:{type:Boolean,required:!1},avoidCollisions:{type:Boolean,required:!1},collisionBoundary:{type:null,required:!1},collisionPadding:{type:[Number,Object],required:!1},arrowPadding:{type:Number,required:!1},hideShiftedArrow:{type:Boolean,required:!1},sticky:{type:String,required:!1},hideWhenDetached:{type:Boolean,required:!1},positionStrategy:{type:String,required:!1},updatePositionStrategy:{type:String,required:!1},disableUpdateOnLayoutShift:{type:Boolean,required:!1},prioritizePosition:{type:Boolean,required:!1},reference:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},{...LR}),emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","entryFocus","openAutoFocus","closeAutoFocus","dismiss"],setup(r,{emit:e}){const t=r,n=e,i=ul(),s=sh(),{trapFocus:o,disableOutsidePointerEvents:a,loop:l}=Rn(t);pR(),ov(a.value);const u=Ce(""),c=Ce(0),d=Ce(0),h=Ce(null),f=Ce("right"),m=Ce(0),p=Ce(null),g=Ce(),{forwardRef:v,currentElement:y}=Ot(),{handleTypeaheadSearch:b}=lv();jt(y,P=>{i.onContentChange(P)}),Nn(()=>{window.clearTimeout(c.value)});function E(P){return f.value===h.value?.side&&X9(P,h.value?.area)}async function A(P){n("openAutoFocus",P),!P.defaultPrevented&&(P.preventDefault(),y.value?.focus({preventScroll:!0}))}function M(P){if(P.defaultPrevented)return;const $=P.target.closest("[data-reka-menu-content]")===P.currentTarget,V=P.ctrlKey||P.altKey||P.metaKey,R=P.key.length===1,O=Yk(P,Hn(),y.value,{loop:l.value,arrowKeyOptions:"vertical",dir:s?.dir.value,focus:!0,attributeName:"[data-reka-collection-item]:not([data-disabled])"});if(O)return O?.focus();if(P.code==="Space")return;const T=g.value?.getItems()??[];if($&&(P.key==="Tab"&&P.preventDefault(),!V&&R&&b(P.key,T)),P.target!==y.value||!W9.includes(P.key))return;P.preventDefault();const w=[...T.map(x=>x.ref)];bR.includes(P.key)&&w.reverse(),h0(w)}function L(P){P?.currentTarget?.contains?.(P.target)||(window.clearTimeout(c.value),u.value="")}function k(P){if(!Fc(P))return;const U=P.target,$=m.value!==P.clientX;if(P?.currentTarget?.contains(U)&&$){const V=P.clientX>m.value?"right":"left";f.value=V,m.value=P.clientX}}return WP({onItemEnter:P=>!!E(P),onItemLeave:P=>{E(P)||(y.value?.focus(),p.value=null)},onTriggerLeave:P=>!!E(P),searchRef:u,pointerGraceTimerRef:d,onPointerGraceIntentChange:P=>{h.value=P}}),(P,U)=>(he(),Ee(q(cv),{"as-child":"",trapped:q(o),onMountAutoFocus:A,onUnmountAutoFocus:U[7]||(U[7]=$=>n("closeAutoFocus",$))},{default:de(()=>[ge(q(uv),{"as-child":"","disable-outside-pointer-events":q(a),onEscapeKeyDown:U[2]||(U[2]=$=>n("escapeKeyDown",$)),onPointerDownOutside:U[3]||(U[3]=$=>n("pointerDownOutside",$)),onFocusOutside:U[4]||(U[4]=$=>n("focusOutside",$)),onInteractOutside:U[5]||(U[5]=$=>n("interactOutside",$)),onDismiss:U[6]||(U[6]=$=>n("dismiss"))},{default:de(()=>[ge(q(xR),{ref_key:"rovingFocusGroupRef",ref:g,"current-tab-stop-id":p.value,"onUpdate:currentTabStopId":U[0]||(U[0]=$=>p.value=$),"as-child":"",orientation:"vertical",dir:q(s).dir.value,loop:q(l),onEntryFocus:U[1]||(U[1]=$=>{n("entryFocus",$),q(s).isUsingKeyboardRef.value||$.preventDefault()})},{default:de(()=>[ge(q(DR),{ref:q(v),role:"menu",as:P.as,"as-child":P.asChild,"aria-orientation":"vertical","data-reka-menu-content":"","data-state":q(hv)(q(i).open.value),dir:q(s).dir.value,side:P.side,"side-offset":P.sideOffset,align:P.align,"align-offset":P.alignOffset,"avoid-collisions":P.avoidCollisions,"collision-boundary":P.collisionBoundary,"collision-padding":P.collisionPadding,"arrow-padding":P.arrowPadding,"prioritize-position":P.prioritizePosition,"position-strategy":P.positionStrategy,"update-position-strategy":P.updatePositionStrategy,sticky:P.sticky,"hide-when-detached":P.hideWhenDetached,reference:P.reference,onKeydown:M,onBlur:L,onPointermove:k},{default:de(()=>[Re(P.$slots,"default")]),_:3},8,["as","as-child","data-state","dir","side","side-offset","align","align-offset","avoid-collisions","collision-boundary","collision-padding","arrow-padding","prioritize-position","position-strategy","update-position-strategy","sticky","hide-when-detached","reference"])]),_:3},8,["current-tab-stop-id","dir","loop"])]),_:3},8,["disable-outside-pointer-events"])]),_:3},8,["trapped"]))}}),xv=GP,qP=_e({inheritAttrs:!1,__name:"MenuItemImpl",props:{disabled:{type:Boolean,required:!1},textValue:{type:String,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(r){const e=r,t=_v(),{forwardRef:n}=Ot(),{CollectionItem:i}=Uo(),s=Ce(!1);async function o(l){l.defaultPrevented||Fc(l)&&(e.disabled?t.onItemLeave(l):t.onItemEnter(l)||l.currentTarget?.focus({preventScroll:!0}))}async function a(l){await br(),!l.defaultPrevented&&Fc(l)&&t.onItemLeave(l)}return(l,u)=>(he(),Ee(q(i),{value:{textValue:l.textValue}},{default:de(()=>[ge(q(qt),et({ref:q(n),role:"menuitem",tabindex:"-1"},l.$attrs,{as:l.as,"as-child":l.asChild,"aria-disabled":l.disabled||void 0,"data-disabled":l.disabled?"":void 0,"data-highlighted":s.value?"":void 0,onPointermove:o,onPointerleave:a,onFocus:u[0]||(u[0]=async c=>{await br(),!(c.defaultPrevented||l.disabled)&&(s.value=!0)}),onBlur:u[1]||(u[1]=async c=>{await br(),!c.defaultPrevented&&(s.value=!1)})}),{default:de(()=>[Re(l.$slots,"default")]),_:3},16,["as","as-child","aria-disabled","data-disabled","data-highlighted"])]),_:3},8,["value"]))}}),VR=qP,YP=_e({__name:"MenuItem",props:{disabled:{type:Boolean,required:!1},textValue:{type:String,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["select"],setup(r,{emit:e}){const t=r,n=e,{forwardRef:i,currentElement:s}=Ot(),o=sh(),a=_v(),l=Ce(!1);async function u(){const c=s.value;if(!t.disabled&&c){const d=new CustomEvent(z9,{bubbles:!0,cancelable:!0});n("select",d),await br(),d.defaultPrevented?l.value=!1:o.onClose()}}return(c,d)=>(he(),Ee(VR,et(t,{ref:q(i),onClick:u,onPointerdown:d[0]||(d[0]=()=>{l.value=!0}),onPointerup:d[1]||(d[1]=async h=>{await br(),!h.defaultPrevented&&(l.value||h.currentTarget?.click())}),onKeydown:d[2]||(d[2]=async h=>{const f=q(a).searchRef.value!=="";c.disabled||f&&h.key===" "||q(c0).includes(h.key)&&(h.currentTarget.click(),h.preventDefault())})}),{default:de(()=>[Re(c.$slots,"default")]),_:3},16))}}),XP=YP,KP=_e({__name:"MenuRootContentModal",props:{loop:{type:Boolean,required:!1},side:{type:null,required:!1},sideOffset:{type:Number,required:!1},sideFlip:{type:Boolean,required:!1},align:{type:null,required:!1},alignOffset:{type:Number,required:!1},alignFlip:{type:Boolean,required:!1},avoidCollisions:{type:Boolean,required:!1},collisionBoundary:{type:null,required:!1},collisionPadding:{type:[Number,Object],required:!1},arrowPadding:{type:Number,required:!1},hideShiftedArrow:{type:Boolean,required:!1},sticky:{type:String,required:!1},hideWhenDetached:{type:Boolean,required:!1},positionStrategy:{type:String,required:!1},updatePositionStrategy:{type:String,required:!1},disableUpdateOnLayoutShift:{type:Boolean,required:!1},prioritizePosition:{type:Boolean,required:!1},reference:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","entryFocus","openAutoFocus","closeAutoFocus"],setup(r,{emit:e}){const t=r,n=e,i=On(t,n),s=ul(),{forwardRef:o,currentElement:a}=Ot();return av(a),(l,u)=>(he(),Ee(xv,et(q(i),{ref:q(o),"trap-focus":q(s).open.value,"disable-outside-pointer-events":q(s).open.value,"disable-outside-scroll":!0,onDismiss:u[0]||(u[0]=c=>q(s).onOpenChange(!1)),onFocusOutside:u[1]||(u[1]=as(c=>n("focusOutside",c),["prevent"]))}),{default:de(()=>[Re(l.$slots,"default")]),_:3},16,["trap-focus","disable-outside-pointer-events"]))}}),ZP=KP,QP=_e({__name:"MenuRootContentNonModal",props:{loop:{type:Boolean,required:!1},side:{type:null,required:!1},sideOffset:{type:Number,required:!1},sideFlip:{type:Boolean,required:!1},align:{type:null,required:!1},alignOffset:{type:Number,required:!1},alignFlip:{type:Boolean,required:!1},avoidCollisions:{type:Boolean,required:!1},collisionBoundary:{type:null,required:!1},collisionPadding:{type:[Number,Object],required:!1},arrowPadding:{type:Number,required:!1},hideShiftedArrow:{type:Boolean,required:!1},sticky:{type:String,required:!1},hideWhenDetached:{type:Boolean,required:!1},positionStrategy:{type:String,required:!1},updatePositionStrategy:{type:String,required:!1},disableUpdateOnLayoutShift:{type:Boolean,required:!1},prioritizePosition:{type:Boolean,required:!1},reference:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","entryFocus","openAutoFocus","closeAutoFocus"],setup(r,{emit:e}){const i=On(r,e),s=ul();return(o,a)=>(he(),Ee(xv,et(q(i),{"trap-focus":!1,"disable-outside-pointer-events":!1,"disable-outside-scroll":!1,onDismiss:a[0]||(a[0]=l=>q(s).onOpenChange(!1))}),{default:de(()=>[Re(o.$slots,"default")]),_:3},16))}}),JP=QP,eF=_e({__name:"MenuContent",props:{forceMount:{type:Boolean,required:!1},loop:{type:Boolean,required:!1},side:{type:null,required:!1},sideOffset:{type:Number,required:!1},sideFlip:{type:Boolean,required:!1},align:{type:null,required:!1},alignOffset:{type:Number,required:!1},alignFlip:{type:Boolean,required:!1},avoidCollisions:{type:Boolean,required:!1},collisionBoundary:{type:null,required:!1},collisionPadding:{type:[Number,Object],required:!1},arrowPadding:{type:Number,required:!1},hideShiftedArrow:{type:Boolean,required:!1},sticky:{type:String,required:!1},hideWhenDetached:{type:Boolean,required:!1},positionStrategy:{type:String,required:!1},updatePositionStrategy:{type:String,required:!1},disableUpdateOnLayoutShift:{type:Boolean,required:!1},prioritizePosition:{type:Boolean,required:!1},reference:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","entryFocus","openAutoFocus","closeAutoFocus"],setup(r,{emit:e}){const i=On(r,e),s=ul(),o=sh();return(a,l)=>(he(),Ee(q(vu),{present:a.forceMount||q(s).open.value},{default:de(()=>[q(o).modal.value?(he(),Ee(ZP,en(et({key:0},{...a.$attrs,...q(i)})),{default:de(()=>[Re(a.$slots,"default")]),_:3},16)):(he(),Ee(JP,en(et({key:1},{...a.$attrs,...q(i)})),{default:de(()=>[Re(a.$slots,"default")]),_:3},16))]),_:3},8,["present"]))}}),tF=eF,rF=_e({__name:"MenuLabel",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"div"}},setup(r){const e=r;return(t,n)=>(he(),Ee(q(qt),en(un(e)),{default:de(()=>[Re(t.$slots,"default")]),_:3},16))}}),nF=rF,iF=_e({__name:"MenuPortal",props:{to:{type:null,required:!1},disabled:{type:Boolean,required:!1},defer:{type:Boolean,required:!1},forceMount:{type:Boolean,required:!1}},setup(r){const e=r;return(t,n)=>(he(),Ee(q(dv),en(un(e)),{default:de(()=>[Re(t.$slots,"default")]),_:3},16))}}),sF=iF,oF=_e({__name:"MenuSeparator",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(r){const e=r;return(t,n)=>(he(),Ee(q(qt),et(e,{role:"separator","aria-orientation":"horizontal"}),{default:de(()=>[Re(t.$slots,"default")]),_:3},16))}}),aF=oF;const[jR,lF]=Mn("MenuSub");var uF=_e({__name:"MenuSub",props:{open:{type:Boolean,required:!1,default:void 0}},emits:["update:open"],setup(r,{emit:e}){const t=r,i=hs(t,"open",e,{defaultValue:!1,passive:t.open===void 0}),s=ul(),o=Ce(),a=Ce();return An(l=>{s?.open.value===!1&&(i.value=!1),l(()=>i.value=!1)}),UR({open:i,onOpenChange:l=>{i.value=l},content:a,onContentChange:l=>{a.value=l}}),lF({triggerId:"",contentId:"",trigger:o,onTriggerChange:l=>{o.value=l}}),(l,u)=>(he(),Ee(q(fv),null,{default:de(()=>[Re(l.$slots,"default")]),_:3}))}}),cF=uF,hF=_e({__name:"MenuSubContent",props:{forceMount:{type:Boolean,required:!1},loop:{type:Boolean,required:!1},sideOffset:{type:Number,required:!1},sideFlip:{type:Boolean,required:!1},alignOffset:{type:Number,required:!1},alignFlip:{type:Boolean,required:!1},avoidCollisions:{type:Boolean,required:!1},collisionBoundary:{type:null,required:!1},collisionPadding:{type:[Number,Object],required:!1},arrowPadding:{type:Number,required:!1},hideShiftedArrow:{type:Boolean,required:!1},sticky:{type:String,required:!1},hideWhenDetached:{type:Boolean,required:!1},positionStrategy:{type:String,required:!1},updatePositionStrategy:{type:String,required:!1},disableUpdateOnLayoutShift:{type:Boolean,required:!1},prioritizePosition:{type:Boolean,required:!1,default:!0},reference:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","entryFocus","openAutoFocus","closeAutoFocus"],setup(r,{emit:e}){const i=On(r,e),s=ul(),o=sh(),a=jR(),{forwardRef:l,currentElement:u}=Ot();return a.contentId||=Gi(void 0,"reka-menu-sub-content"),(c,d)=>(he(),Ee(q(vu),{present:c.forceMount||q(s).open.value},{default:de(()=>[ge(xv,et(q(i),{id:q(a).contentId,ref:q(l),"aria-labelledby":q(a).triggerId,align:"start",side:q(o).dir.value==="rtl"?"left":"right","disable-outside-pointer-events":!1,"disable-outside-scroll":!1,"trap-focus":!1,onOpenAutoFocus:d[0]||(d[0]=as(h=>{q(o).isUsingKeyboardRef.value&&q(u)?.focus()},["prevent"])),onCloseAutoFocus:d[1]||(d[1]=as(()=>{},["prevent"])),onFocusOutside:d[2]||(d[2]=h=>{h.defaultPrevented||h.target!==q(a).trigger.value&&q(s).onOpenChange(!1)}),onEscapeKeyDown:d[3]||(d[3]=h=>{q(o).onClose(),h.preventDefault()}),onKeydown:d[4]||(d[4]=h=>{const f=h.currentTarget?.contains(h.target),m=q(q9)[q(o).dir.value].includes(h.key);f&&m&&(q(s).onOpenChange(!1),q(a).trigger.value?.focus(),h.preventDefault())})}),{default:de(()=>[Re(c.$slots,"default")]),_:3},16,["id","aria-labelledby","side"])]),_:3},8,["present"]))}}),dF=hF,fF=_e({__name:"MenuSubTrigger",props:{disabled:{type:Boolean,required:!1},textValue:{type:String,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(r){const e=r,t=ul(),n=sh(),i=jR(),s=_v(),o=Ce(null);i.triggerId||=Gi(void 0,"reka-menu-sub-trigger");function a(){o.value&&window.clearTimeout(o.value),o.value=null}Nn(()=>{a()});function l(d){!Fc(d)||s.onItemEnter(d)||!e.disabled&&!t.open.value&&!o.value&&(s.onPointerGraceIntentChange(null),o.value=window.setTimeout(()=>{t.onOpenChange(!0),a()},100))}async function u(d){if(!Fc(d))return;a();const h=t.content.value?.getBoundingClientRect();if(h?.width){const f=t.content.value?.dataset.side,m=f==="right",p=m?-5:5,g=h[m?"left":"right"],v=h[m?"right":"left"];s.onPointerGraceIntentChange({area:[{x:d.clientX+p,y:d.clientY},{x:g,y:h.top},{x:v,y:h.top},{x:v,y:h.bottom},{x:g,y:h.bottom}],side:f}),window.clearTimeout(s.pointerGraceTimerRef.value),s.pointerGraceTimerRef.value=window.setTimeout(()=>s.onPointerGraceIntentChange(null),300)}else{if(s.onTriggerLeave(d))return;s.onPointerGraceIntentChange(null)}}async function c(d){const h=s.searchRef.value!=="";e.disabled||h&&d.key===" "||G9[n.dir.value].includes(d.key)&&(t.onOpenChange(!0),await br(),t.content.value?.focus(),d.preventDefault())}return(d,h)=>(he(),Ee(BR,{"as-child":""},{default:de(()=>[ge(VR,et(e,{id:q(i).triggerId,ref:f=>{q(i)?.onTriggerChange(f?.$el)},"aria-haspopup":"menu","aria-expanded":q(t).open.value,"aria-controls":q(i).contentId,"data-state":q(hv)(q(t).open.value),onClick:h[0]||(h[0]=async f=>{e.disabled||f.defaultPrevented||(f.currentTarget.focus(),q(t).open.value||q(t).onOpenChange(!0))}),onPointermove:l,onPointerleave:u,onKeydown:c}),{default:de(()=>[Re(d.$slots,"default")]),_:3},16,["id","aria-expanded","aria-controls","data-state"])]),_:3}))}}),pF=fF;const[$R,mF]=Mn("DropdownMenuRoot");var gF=_e({__name:"DropdownMenuRoot",props:{defaultOpen:{type:Boolean,required:!1},open:{type:Boolean,required:!1,default:void 0},dir:{type:String,required:!1},modal:{type:Boolean,required:!1,default:!0}},emits:["update:open"],setup(r,{emit:e}){const t=r,n=e;Ot();const i=hs(t,"open",n,{defaultValue:t.defaultOpen,passive:t.open===void 0}),s=Ce(),{modal:o,dir:a}=Rn(t),l=rh(a);return mF({open:i,onOpenChange:u=>{i.value=u},onOpenToggle:()=>{i.value=!i.value},triggerId:"",triggerElement:s,contentId:"",modal:o,dir:l}),(u,c)=>(he(),Ee(q(HP),{open:q(i),"onUpdate:open":c[0]||(c[0]=d=>Cr(i)?i.value=d:null),dir:q(l),modal:q(o)},{default:de(()=>[Re(u.$slots,"default",{open:q(i)})]),_:3},8,["open","dir","modal"]))}}),yF=gF,vF=_e({__name:"DropdownMenuContent",props:{forceMount:{type:Boolean,required:!1},loop:{type:Boolean,required:!1},side:{type:null,required:!1},sideOffset:{type:Number,required:!1},sideFlip:{type:Boolean,required:!1},align:{type:null,required:!1},alignOffset:{type:Number,required:!1},alignFlip:{type:Boolean,required:!1},avoidCollisions:{type:Boolean,required:!1},collisionBoundary:{type:null,required:!1},collisionPadding:{type:[Number,Object],required:!1},arrowPadding:{type:Number,required:!1},hideShiftedArrow:{type:Boolean,required:!1},sticky:{type:String,required:!1},hideWhenDetached:{type:Boolean,required:!1},positionStrategy:{type:String,required:!1},updatePositionStrategy:{type:String,required:!1},disableUpdateOnLayoutShift:{type:Boolean,required:!1},prioritizePosition:{type:Boolean,required:!1},reference:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","closeAutoFocus"],setup(r,{emit:e}){const i=On(r,e);Ot();const s=$R(),o=Ce(!1);function a(l){l.defaultPrevented||(o.value||setTimeout(()=>{s.triggerElement.value?.focus()},0),o.value=!1,l.preventDefault())}return s.contentId||=Gi(void 0,"reka-dropdown-menu-content"),(l,u)=>(he(),Ee(q(tF),et(q(i),{id:q(s).contentId,"aria-labelledby":q(s)?.triggerId,style:{"--reka-dropdown-menu-content-transform-origin":"var(--reka-popper-transform-origin)","--reka-dropdown-menu-content-available-width":"var(--reka-popper-available-width)","--reka-dropdown-menu-content-available-height":"var(--reka-popper-available-height)","--reka-dropdown-menu-trigger-width":"var(--reka-popper-anchor-width)","--reka-dropdown-menu-trigger-height":"var(--reka-popper-anchor-height)"},onCloseAutoFocus:a,onInteractOutside:u[0]||(u[0]=c=>{if(c.defaultPrevented)return;const d=c.detail.originalEvent,h=d.button===0&&d.ctrlKey===!0,f=d.button===2||h;(!q(s).modal.value||f)&&(o.value=!0),q(s).triggerElement.value?.contains(c.target)&&c.preventDefault()})}),{default:de(()=>[Re(l.$slots,"default")]),_:3},16,["id","aria-labelledby"]))}}),bF=vF,wF=_e({__name:"DropdownMenuItem",props:{disabled:{type:Boolean,required:!1},textValue:{type:String,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["select"],setup(r,{emit:e}){const t=r,i=nh(e);return Ot(),(s,o)=>(he(),Ee(q(XP),en(un({...t,...q(i)})),{default:de(()=>[Re(s.$slots,"default")]),_:3},16))}}),_F=wF,xF=_e({__name:"DropdownMenuLabel",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(r){const e=r;return Ot(),(t,n)=>(he(),Ee(q(nF),en(un(e)),{default:de(()=>[Re(t.$slots,"default")]),_:3},16))}}),EF=xF,SF=_e({__name:"DropdownMenuPortal",props:{to:{type:null,required:!1},disabled:{type:Boolean,required:!1},defer:{type:Boolean,required:!1},forceMount:{type:Boolean,required:!1}},setup(r){const e=r;return(t,n)=>(he(),Ee(q(sF),en(un(e)),{default:de(()=>[Re(t.$slots,"default")]),_:3},16))}}),TF=SF,RF=_e({__name:"DropdownMenuSeparator",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(r){const e=r;return Ot(),(t,n)=>(he(),Ee(q(aF),en(un(e)),{default:de(()=>[Re(t.$slots,"default")]),_:3},16))}}),AF=RF,CF=_e({__name:"DropdownMenuSub",props:{defaultOpen:{type:Boolean,required:!1},open:{type:Boolean,required:!1,default:void 0}},emits:["update:open"],setup(r,{emit:e}){const t=r,i=hs(t,"open",e,{passive:t.open===void 0,defaultValue:t.defaultOpen??!1});return Ot(),(s,o)=>(he(),Ee(q(cF),{open:q(i),"onUpdate:open":o[0]||(o[0]=a=>Cr(i)?i.value=a:null)},{default:de(()=>[Re(s.$slots,"default",{open:q(i)})]),_:3},8,["open"]))}}),NF=CF,MF=_e({__name:"DropdownMenuSubContent",props:{forceMount:{type:Boolean,required:!1},loop:{type:Boolean,required:!1},sideOffset:{type:Number,required:!1},sideFlip:{type:Boolean,required:!1},alignOffset:{type:Number,required:!1},alignFlip:{type:Boolean,required:!1},avoidCollisions:{type:Boolean,required:!1},collisionBoundary:{type:null,required:!1},collisionPadding:{type:[Number,Object],required:!1},arrowPadding:{type:Number,required:!1},hideShiftedArrow:{type:Boolean,required:!1},sticky:{type:String,required:!1},hideWhenDetached:{type:Boolean,required:!1},positionStrategy:{type:String,required:!1},updatePositionStrategy:{type:String,required:!1},disableUpdateOnLayoutShift:{type:Boolean,required:!1},prioritizePosition:{type:Boolean,required:!1},reference:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","entryFocus","openAutoFocus","closeAutoFocus"],setup(r,{emit:e}){const i=On(r,e);return Ot(),(s,o)=>(he(),Ee(q(dF),et(q(i),{style:{"--reka-dropdown-menu-content-transform-origin":"var(--reka-popper-transform-origin)","--reka-dropdown-menu-content-available-width":"var(--reka-popper-available-width)","--reka-dropdown-menu-content-available-height":"var(--reka-popper-available-height)","--reka-dropdown-menu-trigger-width":"var(--reka-popper-anchor-width)","--reka-dropdown-menu-trigger-height":"var(--reka-popper-anchor-height)"}}),{default:de(()=>[Re(s.$slots,"default")]),_:3},16))}}),OF=MF,IF=_e({__name:"DropdownMenuSubTrigger",props:{disabled:{type:Boolean,required:!1},textValue:{type:String,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(r){const e=r;return Ot(),(t,n)=>(he(),Ee(q(pF),en(un(e)),{default:de(()=>[Re(t.$slots,"default")]),_:3},16))}}),kF=IF,PF=_e({__name:"DropdownMenuTrigger",props:{disabled:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"button"}},setup(r){const e=r,t=$R(),{forwardRef:n,currentElement:i}=Ot();return Lr(()=>{t.triggerElement=i}),t.triggerId||=Gi(void 0,"reka-dropdown-menu-trigger"),(s,o)=>(he(),Ee(q(BR),{"as-child":""},{default:de(()=>[ge(q(qt),{id:q(t).triggerId,ref:q(n),type:s.as==="button"?"button":void 0,"as-child":e.asChild,as:s.as,"aria-haspopup":"menu","aria-expanded":q(t).open.value,"aria-controls":q(t).open.value?q(t).contentId:void 0,"data-disabled":s.disabled?"":void 0,disabled:s.disabled,"data-state":q(t).open.value?"open":"closed",onClick:o[0]||(o[0]=async a=>{!s.disabled&&a.button===0&&a.ctrlKey===!1&&(q(t)?.onOpenToggle(),await br(),q(t).open.value&&a.preventDefault())}),onKeydown:o[1]||(o[1]=yy(a=>{s.disabled||(["Enter"," "].includes(a.key)&&q(t).onOpenToggle(),a.key==="ArrowDown"&&q(t).onOpenChange(!0),["Enter"," ","ArrowDown"].includes(a.key)&&a.preventDefault())},["enter","space","arrow-down"]))},{default:de(()=>[Re(s.$slots,"default")]),_:3},8,["id","type","as-child","as","aria-expanded","aria-controls","data-disabled","disabled","data-state"])]),_:3}))}}),FF=PF,LF=_e({__name:"Label",props:{for:{type:String,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"label"}},setup(r){const e=r;return Ot(),(t,n)=>(he(),Ee(q(qt),et(e,{onMousedown:n[0]||(n[0]=i=>{!i.defaultPrevented&&i.detail>1&&i.preventDefault()})}),{default:de(()=>[Re(t.$slots,"default")]),_:3},16))}}),DF=LF;const BF=[" ","Enter","ArrowUp","ArrowDown"],UF=[" ","Enter"],Xi=10;function Bc(r,e,t){return r===void 0?!1:Array.isArray(r)?r.some(n=>y0(n,e,t)):y0(r,e,t)}function y0(r,e,t){return r===void 0||e===void 0?!1:typeof r=="string"?r===e:typeof t=="function"?t(r,e):typeof t=="string"?r?.[t]===e?.[t]:Gk(r,e)}function VF(r){return r==null||r===""||Array.isArray(r)&&r.length===0}const jF={key:0,value:""},[xa,zR]=Mn("SelectRoot");var $F=_e({inheritAttrs:!1,__name:"SelectRoot",props:{open:{type:Boolean,required:!1,default:void 0},defaultOpen:{type:Boolean,required:!1},defaultValue:{type:null,required:!1},modelValue:{type:null,required:!1,default:void 0},by:{type:[String,Function],required:!1},dir:{type:String,required:!1},multiple:{type:Boolean,required:!1},autocomplete:{type:String,required:!1},disabled:{type:Boolean,required:!1},name:{type:String,required:!1},required:{type:Boolean,required:!1}},emits:["update:modelValue","update:open"],setup(r,{emit:e}){const t=r,n=e,{required:i,disabled:s,multiple:o,dir:a}=Rn(t),l=hs(t,"modelValue",n,{defaultValue:t.defaultValue??(o.value?[]:void 0),passive:t.modelValue===void 0,deep:!0}),u=hs(t,"open",n,{defaultValue:t.defaultOpen,passive:t.open===void 0}),c=Ce(),d=Ce(),h=Ce({x:0,y:0}),f=Te(()=>o.value&&Array.isArray(l.value)?l.value?.length===0:o0(l.value));Uo({isProvider:!0});const m=rh(a),p=mR(c),g=Ce(new Set),v=Te(()=>Array.from(g.value).map(E=>E.value).join(";"));function y(E){if(o.value){const A=Array.isArray(l.value)?[...l.value]:[],M=A.findIndex(L=>y0(L,E,t.by));M===-1?A.push(E):A.splice(M,1),l.value=[...A]}else l.value=E}function b(E){return Array.from(g.value).find(A=>Bc(E,A.value,t.by))}return zR({triggerElement:c,onTriggerChange:E=>{c.value=E},valueElement:d,onValueElementChange:E=>{d.value=E},contentId:"",modelValue:l,onValueChange:y,by:t.by,open:u,multiple:o,required:i,onOpenChange:E=>{u.value=E},dir:m,triggerPointerDownPosRef:h,disabled:s,isEmptyModelValue:f,optionsSet:g,onOptionAdd:E=>{const A=b(E.value);A&&g.value.delete(A),g.value.add(E)},onOptionRemove:E=>{const A=b(E.value);A&&g.value.delete(A)}}),(E,A)=>(he(),Ee(q(fv),null,{default:de(()=>[Re(E.$slots,"default",{modelValue:q(l),open:q(u)}),q(p)?(he(),Ee(WF,{key:v.value,"aria-hidden":"true",tabindex:"-1",multiple:q(o),required:q(i),name:E.name,autocomplete:E.autocomplete,disabled:q(s),value:q(l)},{default:de(()=>[q(o0)(q(l))?(he(),ke("option",jF)):zt("v-if",!0),(he(!0),ke(Tt,null,Er(Array.from(g.value),M=>(he(),ke("option",et({key:M.value??""},{ref_for:!0},M),null,16))),128))]),_:1},8,["multiple","required","name","autocomplete","disabled","value"])):zt("v-if",!0)]),_:3}))}}),zF=$F,HF=_e({__name:"BubbleSelect",props:{autocomplete:{type:String,required:!1},autofocus:{type:Boolean,required:!1},disabled:{type:Boolean,required:!1},form:{type:String,required:!1},multiple:{type:Boolean,required:!1},name:{type:String,required:!1},required:{type:Boolean,required:!1},size:{type:Number,required:!1},value:{type:null,required:!1}},setup(r){const e=r,t=Ce(),n=xa();jt(()=>e.value,(s,o)=>{const a=window.HTMLSelectElement.prototype,u=Object.getOwnPropertyDescriptor(a,"value").set;if(s!==o&&u&&t.value){const c=new Event("change",{bubbles:!0});u.call(t.value,s),t.value.dispatchEvent(c)}});function i(s){n.onValueChange(s.target.value)}return(s,o)=>(he(),Ee(q(ER),{"as-child":""},{default:de(()=>[we("select",et({ref_key:"selectElement",ref:t},e,{onInput:i}),[Re(s.$slots,"default")],16)]),_:3}))}}),WF=HF,GF=_e({__name:"SelectPopperPosition",props:{side:{type:null,required:!1},sideOffset:{type:Number,required:!1},sideFlip:{type:Boolean,required:!1},align:{type:null,required:!1,default:"start"},alignOffset:{type:Number,required:!1},alignFlip:{type:Boolean,required:!1},avoidCollisions:{type:Boolean,required:!1},collisionBoundary:{type:null,required:!1},collisionPadding:{type:[Number,Object],required:!1,default:Xi},arrowPadding:{type:Number,required:!1},hideShiftedArrow:{type:Boolean,required:!1},sticky:{type:String,required:!1},hideWhenDetached:{type:Boolean,required:!1},positionStrategy:{type:String,required:!1},updatePositionStrategy:{type:String,required:!1},disableUpdateOnLayoutShift:{type:Boolean,required:!1},prioritizePosition:{type:Boolean,required:!1},reference:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(r){const t=pi(r);return(n,i)=>(he(),Ee(q(DR),et(q(t),{style:{boxSizing:"border-box","--reka-select-content-transform-origin":"var(--reka-popper-transform-origin)","--reka-select-content-available-width":"var(--reka-popper-available-width)","--reka-select-content-available-height":"var(--reka-popper-available-height)","--reka-select-trigger-width":"var(--reka-popper-anchor-width)","--reka-select-trigger-height":"var(--reka-popper-anchor-height)"}}),{default:de(()=>[Re(n.$slots,"default")]),_:3},16))}}),qF=GF;const YF={onViewportChange:()=>{},itemTextRefCallback:()=>{},itemRefCallback:()=>{}},[cl,HR]=Mn("SelectContent");var XF=_e({__name:"SelectContentImpl",props:{position:{type:String,required:!1,default:"item-aligned"},bodyLock:{type:Boolean,required:!1,default:!0},side:{type:null,required:!1},sideOffset:{type:Number,required:!1},sideFlip:{type:Boolean,required:!1},align:{type:null,required:!1,default:"start"},alignOffset:{type:Number,required:!1},alignFlip:{type:Boolean,required:!1},avoidCollisions:{type:Boolean,required:!1},collisionBoundary:{type:null,required:!1},collisionPadding:{type:[Number,Object],required:!1},arrowPadding:{type:Number,required:!1},hideShiftedArrow:{type:Boolean,required:!1},sticky:{type:String,required:!1},hideWhenDetached:{type:Boolean,required:!1},positionStrategy:{type:String,required:!1},updatePositionStrategy:{type:String,required:!1},disableUpdateOnLayoutShift:{type:Boolean,required:!1},prioritizePosition:{type:Boolean,required:!1},reference:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1},disableOutsidePointerEvents:{type:Boolean,required:!1,default:!0}},emits:["closeAutoFocus","escapeKeyDown","pointerDownOutside"],setup(r,{emit:e}){const t=r,n=e,i=xa();pR(),ov(t.bodyLock);const{CollectionSlot:s,getItems:o}=Uo(),a=Ce();av(a);const{search:l,handleTypeaheadSearch:u}=lv(),c=Ce(),d=Ce(),h=Ce(),f=Ce(!1),m=Ce(!1),p=Ce(!1);function g(){d.value&&a.value&&h0([d.value,a.value])}jt(f,()=>{g()});const{onOpenChange:v,triggerPointerDownPosRef:y}=i;An(M=>{if(!a.value)return;let L={x:0,y:0};const k=U=>{L={x:Math.abs(Math.round(U.pageX)-(y.value?.x??0)),y:Math.abs(Math.round(U.pageY)-(y.value?.y??0))}},P=U=>{U.pointerType!=="touch"&&(L.x<=10&&L.y<=10?U.preventDefault():a.value?.contains(U.target)||v(!1),document.removeEventListener("pointermove",k),y.value=null)};y.value!==null&&(document.addEventListener("pointermove",k),document.addEventListener("pointerup",P,{capture:!0,once:!0})),M(()=>{document.removeEventListener("pointermove",k),document.removeEventListener("pointerup",P,{capture:!0})})});function b(M){const L=M.ctrlKey||M.altKey||M.metaKey;if(M.key==="Tab"&&M.preventDefault(),!L&&M.key.length===1&&u(M.key,o()),["ArrowUp","ArrowDown","Home","End"].includes(M.key)){let P=[...o().map(U=>U.ref)];if(["ArrowUp","End"].includes(M.key)&&(P=P.slice().reverse()),["ArrowUp","ArrowDown"].includes(M.key)){const U=M.target,$=P.indexOf(U);P=P.slice($+1)}setTimeout(()=>h0(P)),M.preventDefault()}}const E=Te(()=>t.position==="popper"?t:{}),A=pi(E.value);return HR({content:a,viewport:c,onViewportChange:M=>{c.value=M},itemRefCallback:(M,L,k)=>{const P=!m.value&&!k,U=Bc(i.modelValue.value,L,i.by);if(i.multiple.value){if(p.value)return;(U||P)&&(d.value=M,U&&(p.value=!0))}else(U||P)&&(d.value=M);P&&(m.value=!0)},selectedItem:d,selectedItemText:h,onItemLeave:()=>{a.value?.focus()},itemTextRefCallback:(M,L,k)=>{const P=!m.value&&!k;(Bc(i.modelValue.value,L,i.by)||P)&&(h.value=M)},focusSelectedItem:g,position:t.position,isPositioned:f,searchRef:l}),(M,L)=>(he(),Ee(q(s),null,{default:de(()=>[ge(q(cv),{"as-child":"",onMountAutoFocus:L[6]||(L[6]=as(()=>{},["prevent"])),onUnmountAutoFocus:L[7]||(L[7]=k=>{n("closeAutoFocus",k),!k.defaultPrevented&&(q(i).triggerElement.value?.focus({preventScroll:!0}),k.preventDefault())})},{default:de(()=>[ge(q(uv),{"as-child":"","disable-outside-pointer-events":M.disableOutsidePointerEvents,onFocusOutside:L[2]||(L[2]=as(()=>{},["prevent"])),onDismiss:L[3]||(L[3]=k=>q(i).onOpenChange(!1)),onEscapeKeyDown:L[4]||(L[4]=k=>n("escapeKeyDown",k)),onPointerDownOutside:L[5]||(L[5]=k=>n("pointerDownOutside",k))},{default:de(()=>[(he(),Ee(dy(M.position==="popper"?qF:JF),et({...M.$attrs,...q(A)},{id:q(i).contentId,ref:k=>{const P=q(Ws)(k);P?.hasAttribute("data-reka-popper-content-wrapper")?a.value=P.firstElementChild:a.value=P},role:"listbox","data-state":q(i).open.value?"open":"closed",dir:q(i).dir.value,style:{display:"flex",flexDirection:"column",outline:"none"},onContextmenu:L[0]||(L[0]=as(()=>{},["prevent"])),onPlaced:L[1]||(L[1]=k=>f.value=!0),onKeydown:b}),{default:de(()=>[Re(M.$slots,"default")]),_:3},16,["id","data-state","dir","onKeydown"]))]),_:3},8,["disable-outside-pointer-events"])]),_:3})]),_:3}))}}),KF=XF;const[Ev,ZF]=Mn("SelectItemAlignedPosition");var QF=_e({inheritAttrs:!1,__name:"SelectItemAlignedPosition",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["placed"],setup(r,{emit:e}){const t=r,n=e,{getItems:i}=Uo(),s=xa(),o=cl(),a=Ce(!1),l=Ce(!0),u=Ce(),{forwardRef:c,currentElement:d}=Ot(),{viewport:h,selectedItem:f,selectedItemText:m,focusSelectedItem:p}=o;function g(){if(s.triggerElement.value&&s.valueElement.value&&u.value&&d.value&&h?.value&&f?.value&&m?.value){const b=s.triggerElement.value.getBoundingClientRect(),E=d.value.getBoundingClientRect(),A=s.valueElement.value.getBoundingClientRect(),M=m.value.getBoundingClientRect();if(s.dir.value!=="rtl"){const X=M.left-E.left,I=A.left-X,N=b.left-I,j=b.width+N,Q=Math.max(j,E.width),W=window.innerWidth-Xi,Y=Mw(I,Xi,Math.max(Xi,W-Q));u.value.style.minWidth=`${j}px`,u.value.style.left=`${Y}px`}else{const X=E.right-M.right,I=window.innerWidth-A.right-X,N=window.innerWidth-b.right-I,j=b.width+N,Q=Math.max(j,E.width),W=window.innerWidth-Xi,Y=Mw(I,Xi,Math.max(Xi,W-Q));u.value.style.minWidth=`${j}px`,u.value.style.right=`${Y}px`}const L=i().map(X=>X.ref),k=window.innerHeight-Xi*2,P=h.value.scrollHeight,U=window.getComputedStyle(d.value),$=Number.parseInt(U.borderTopWidth,10),V=Number.parseInt(U.paddingTop,10),R=Number.parseInt(U.borderBottomWidth,10),O=Number.parseInt(U.paddingBottom,10),T=$+V+P+O+R,w=Math.min(f.value.offsetHeight*5,T),x=window.getComputedStyle(h.value),_=Number.parseInt(x.paddingTop,10),S=Number.parseInt(x.paddingBottom,10),C=b.top+b.height/2-Xi,F=k-C,D=f.value.offsetHeight/2,H=f.value.offsetTop+D,G=$+V+H,ee=T-G;if(G<=C){const X=f.value===L[L.length-1];u.value.style.bottom="0px";const I=d.value.clientHeight-h.value.offsetTop-h.value.offsetHeight,N=Math.max(F,D+(X?S:0)+I+R),j=G+N;u.value.style.height=`${j}px`}else{const X=f.value===L[0];u.value.style.top="0px";const N=Math.max(C,$+h.value.offsetTop+(X?_:0)+D)+ee;u.value.style.height=`${N}px`,h.value.scrollTop=G-C+h.value.offsetTop}u.value.style.margin=`${Xi}px 0`,u.value.style.minHeight=`${w}px`,u.value.style.maxHeight=`${k}px`,n("placed"),requestAnimationFrame(()=>a.value=!0)}}const v=Ce("");Lr(async()=>{await br(),g(),d.value&&(v.value=window.getComputedStyle(d.value).zIndex)});function y(b){b&&l.value===!0&&(g(),p?.(),l.value=!1)}return h9(s.triggerElement,()=>{g()}),ZF({contentWrapper:u,shouldExpandOnScrollRef:a,onScrollButtonChange:y}),(b,E)=>(he(),ke("div",{ref_key:"contentWrapperElement",ref:u,style:qs({display:"flex",flexDirection:"column",position:"fixed",zIndex:v.value})},[ge(q(qt),et({ref:q(c),style:{boxSizing:"border-box",maxHeight:"100%"}},{...b.$attrs,...t}),{default:de(()=>[Re(b.$slots,"default")]),_:3},16)],4))}}),JF=QF,eL=_e({inheritAttrs:!1,__name:"SelectProvider",props:{context:{type:Object,required:!0}},setup(r){return zR(r.context),HR(YF),(t,n)=>Re(t.$slots,"default")}}),tL=eL;const rL={key:1};var nL=_e({inheritAttrs:!1,__name:"SelectContent",props:{forceMount:{type:Boolean,required:!1},position:{type:String,required:!1},bodyLock:{type:Boolean,required:!1},side:{type:null,required:!1},sideOffset:{type:Number,required:!1},sideFlip:{type:Boolean,required:!1},align:{type:null,required:!1},alignOffset:{type:Number,required:!1},alignFlip:{type:Boolean,required:!1},avoidCollisions:{type:Boolean,required:!1},collisionBoundary:{type:null,required:!1},collisionPadding:{type:[Number,Object],required:!1},arrowPadding:{type:Number,required:!1},hideShiftedArrow:{type:Boolean,required:!1},sticky:{type:String,required:!1},hideWhenDetached:{type:Boolean,required:!1},positionStrategy:{type:String,required:!1},updatePositionStrategy:{type:String,required:!1},disableUpdateOnLayoutShift:{type:Boolean,required:!1},prioritizePosition:{type:Boolean,required:!1},reference:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1},disableOutsidePointerEvents:{type:Boolean,required:!1}},emits:["closeAutoFocus","escapeKeyDown","pointerDownOutside"],setup(r,{emit:e}){const t=r,i=On(t,e),s=xa(),o=Ce();Lr(()=>{o.value=new DocumentFragment});const a=Ce(),l=Te(()=>t.forceMount||s.open.value),u=Ce(l.value);return jt(l,()=>{setTimeout(()=>u.value=l.value)}),(c,d)=>l.value||u.value||a.value?.present?(he(),Ee(q(vu),{key:0,ref_key:"presenceRef",ref:a,present:l.value},{default:de(()=>[ge(KF,en(un({...q(i),...c.$attrs})),{default:de(()=>[Re(c.$slots,"default")]),_:3},16)]),_:3},8,["present"])):o.value?(he(),ke("div",rL,[(he(),Ee(Ex,{to:o.value},[ge(tL,{context:q(s)},{default:de(()=>[Re(c.$slots,"default")]),_:3},8,["context"])],8,["to"]))])):zt("v-if",!0)}}),iL=nL,sL=_e({__name:"SelectIcon",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"span"}},setup(r){return(e,t)=>(he(),Ee(q(qt),{"aria-hidden":"true",as:e.as,"as-child":e.asChild},{default:de(()=>[Re(e.$slots,"default",{},()=>[t[0]||(t[0]=ze(""))])]),_:3},8,["as","as-child"]))}}),oL=sL;const[WR,aL]=Mn("SelectItem");var lL=_e({__name:"SelectItem",props:{value:{type:null,required:!0},disabled:{type:Boolean,required:!1},textValue:{type:String,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["select"],setup(r,{emit:e}){const t=r,n=e,{disabled:i}=Rn(t),s=xa(),o=cl(),{forwardRef:a,currentElement:l}=Ot(),{CollectionItem:u}=Uo(),c=Te(()=>Bc(s.modelValue?.value,t.value,s.by)),d=Ce(!1),h=Ce(t.textValue??""),f=Gi(void 0,"reka-select-item-text"),m="select.select";async function p(E){if(E.defaultPrevented)return;const A={originalEvent:E,value:t.value};rv(m,g,A)}async function g(E){await br(),n("select",E),!E.defaultPrevented&&(i.value||(s.onValueChange(t.value),s.multiple.value||s.onOpenChange(!1)))}async function v(E){await br(),!E.defaultPrevented&&(i.value?o.onItemLeave?.():E.currentTarget?.focus({preventScroll:!0}))}async function y(E){await br(),!E.defaultPrevented&&E.currentTarget===Hn()&&o.onItemLeave?.()}async function b(E){await br(),!(E.defaultPrevented||o.searchRef?.value!==""&&E.key===" ")&&(UF.includes(E.key)&&p(E),E.key===" "&&E.preventDefault())}if(t.value==="")throw new Error("A <SelectItem /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return Lr(()=>{l.value&&o.itemRefCallback(l.value,t.value,t.disabled)}),aL({value:t.value,disabled:i,textId:f,isSelected:c,onItemTextChange:E=>{h.value=((h.value||E?.textContent)??"").trim()}}),(E,A)=>(he(),Ee(q(u),{value:{textValue:h.value}},{default:de(()=>[ge(q(qt),{ref:q(a),role:"option","aria-labelledby":q(f),"data-highlighted":d.value?"":void 0,"aria-selected":c.value,"data-state":c.value?"checked":"unchecked","aria-disabled":q(i)||void 0,"data-disabled":q(i)?"":void 0,tabindex:q(i)?void 0:-1,as:E.as,"as-child":E.asChild,onFocus:A[0]||(A[0]=M=>d.value=!0),onBlur:A[1]||(A[1]=M=>d.value=!1),onPointerup:p,onPointerdown:A[2]||(A[2]=M=>{M.currentTarget.focus({preventScroll:!0})}),onTouchend:A[3]||(A[3]=as(()=>{},["prevent","stop"])),onPointermove:v,onPointerleave:y,onKeydown:b},{default:de(()=>[Re(E.$slots,"default")]),_:3},8,["aria-labelledby","data-highlighted","aria-selected","data-state","aria-disabled","data-disabled","tabindex","as","as-child"])]),_:3},8,["value"]))}}),uL=lL,cL=_e({__name:"SelectItemIndicator",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"span"}},setup(r){const e=r,t=WR();return(n,i)=>q(t).isSelected.value?(he(),Ee(q(qt),et({key:0,"aria-hidden":"true"},e),{default:de(()=>[Re(n.$slots,"default")]),_:3},16)):zt("v-if",!0)}}),hL=cL,dL=_e({inheritAttrs:!1,__name:"SelectItemText",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"span"}},setup(r){const e=r,t=xa(),n=cl(),i=WR(),{forwardRef:s,currentElement:o}=Ot(),a=Te(()=>({value:i.value,disabled:i.disabled.value,textContent:o.value?.textContent??i.value?.toString()??""}));return Lr(()=>{o.value&&(i.onItemTextChange(o.value),n.itemTextRefCallback(o.value,i.value,i.disabled.value),t.onOptionAdd(a.value))}),Nn(()=>{t.onOptionRemove(a.value)}),(l,u)=>(he(),Ee(q(qt),et({id:q(i).textId,ref:q(s)},{...e,...l.$attrs}),{default:de(()=>[Re(l.$slots,"default")]),_:3},16,["id"]))}}),fL=dL,pL=_e({__name:"SelectPortal",props:{to:{type:null,required:!1},disabled:{type:Boolean,required:!1},defer:{type:Boolean,required:!1},forceMount:{type:Boolean,required:!1}},setup(r){const e=r;return(t,n)=>(he(),Ee(q(dv),en(un(e)),{default:de(()=>[Re(t.$slots,"default")]),_:3},16))}}),mL=pL,gL=_e({__name:"SelectScrollButtonImpl",emits:["autoScroll"],setup(r,{emit:e}){const t=e,{getItems:n}=Uo(),i=cl(),s=Ce(null);function o(){s.value!==null&&(window.clearInterval(s.value),s.value=null)}An(()=>{n().map(c=>c.ref).find(c=>c===Hn())?.scrollIntoView({block:"nearest"})});function a(){s.value===null&&(s.value=window.setInterval(()=>{t("autoScroll")},50))}function l(){i.onItemLeave?.(),s.value===null&&(s.value=window.setInterval(()=>{t("autoScroll")},50))}return Sp(()=>o()),(u,c)=>(he(),Ee(q(qt),et({"aria-hidden":"true",style:{flexShrink:0}},u.$parent?.$props,{onPointerdown:a,onPointermove:l,onPointerleave:c[0]||(c[0]=()=>{o()})}),{default:de(()=>[Re(u.$slots,"default")]),_:3},16))}}),GR=gL,yL=_e({__name:"SelectScrollDownButton",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(r){const e=cl(),t=e.position==="item-aligned"?Ev():void 0,{forwardRef:n,currentElement:i}=Ot(),s=Ce(!1);return An(o=>{if(e.viewport?.value&&e.isPositioned?.value){let u=function(){const c=l.scrollHeight-l.clientHeight;s.value=Math.ceil(l.scrollTop)<c};var a=u;const l=e.viewport.value;u(),l.addEventListener("scroll",u),o(()=>l.removeEventListener("scroll",u))}}),jt(i,()=>{i.value&&t?.onScrollButtonChange(i.value)}),(o,a)=>s.value?(he(),Ee(GR,{key:0,ref:q(n),onAutoScroll:a[0]||(a[0]=()=>{const{viewport:l,selectedItem:u}=q(e);l?.value&&u?.value&&(l.value.scrollTop=l.value.scrollTop+u.value.offsetHeight)})},{default:de(()=>[Re(o.$slots,"default")]),_:3},512)):zt("v-if",!0)}}),vL=yL,bL=_e({__name:"SelectScrollUpButton",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(r){const e=cl(),t=e.position==="item-aligned"?Ev():void 0,{forwardRef:n,currentElement:i}=Ot(),s=Ce(!1);return An(o=>{if(e.viewport?.value&&e.isPositioned?.value){let u=function(){s.value=l.scrollTop>0};var a=u;const l=e.viewport.value;u(),l.addEventListener("scroll",u),o(()=>l.removeEventListener("scroll",u))}}),jt(i,()=>{i.value&&t?.onScrollButtonChange(i.value)}),(o,a)=>s.value?(he(),Ee(GR,{key:0,ref:q(n),onAutoScroll:a[0]||(a[0]=()=>{const{viewport:l,selectedItem:u}=q(e);l?.value&&u?.value&&(l.value.scrollTop=l.value.scrollTop-u.value.offsetHeight)})},{default:de(()=>[Re(o.$slots,"default")]),_:3},512)):zt("v-if",!0)}}),wL=bL,_L=_e({__name:"SelectTrigger",props:{disabled:{type:Boolean,required:!1},reference:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"button"}},setup(r){const e=r,t=xa(),{forwardRef:n,currentElement:i}=Ot(),s=Te(()=>t.disabled?.value||e.disabled);t.contentId||=Gi(void 0,"reka-select-content"),Lr(()=>{t.onTriggerChange(i.value)});const{getItems:o}=Uo(),{search:a,handleTypeaheadSearch:l,resetTypeahead:u}=lv();function c(){s.value||(t.onOpenChange(!0),u())}function d(h){c(),t.triggerPointerDownPosRef.value={x:Math.round(h.pageX),y:Math.round(h.pageY)}}return(h,f)=>(he(),Ee(q(TR),{"as-child":"",reference:h.reference},{default:de(()=>[ge(q(qt),{ref:q(n),role:"combobox",type:h.as==="button"?"button":void 0,"aria-controls":q(t).contentId,"aria-expanded":q(t).open.value||!1,"aria-required":q(t).required?.value,"aria-autocomplete":"none",disabled:s.value,dir:q(t)?.dir.value,"data-state":q(t)?.open.value?"open":"closed","data-disabled":s.value?"":void 0,"data-placeholder":q(VF)(q(t).modelValue?.value)?"":void 0,"as-child":h.asChild,as:h.as,onClick:f[0]||(f[0]=m=>{m?.currentTarget?.focus()}),onPointerdown:f[1]||(f[1]=m=>{if(m.pointerType==="touch")return m.preventDefault();const p=m.target;p.hasPointerCapture(m.pointerId)&&p.releasePointerCapture(m.pointerId),m.button===0&&m.ctrlKey===!1&&(d(m),m.preventDefault())}),onPointerup:f[2]||(f[2]=as(m=>{m.pointerType==="touch"&&d(m)},["prevent"])),onKeydown:f[3]||(f[3]=m=>{const p=q(a)!=="";!(m.ctrlKey||m.altKey||m.metaKey)&&m.key.length===1&&p&&m.key===" "||(q(l)(m.key,q(o)()),q(BF).includes(m.key)&&(c(),m.preventDefault()))})},{default:de(()=>[Re(h.$slots,"default")]),_:3},8,["type","aria-controls","aria-expanded","aria-required","disabled","dir","data-state","data-disabled","data-placeholder","as-child","as"])]),_:3},8,["reference"]))}}),xL=_L,EL=_e({__name:"SelectValue",props:{placeholder:{type:String,required:!1,default:""},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"span"}},setup(r){const e=r,{forwardRef:t,currentElement:n}=Ot(),i=xa();Lr(()=>{i.valueElement=n});const s=Te(()=>{let a=[];const l=Array.from(i.optionsSet.value),u=c=>l.find(d=>Bc(c,d.value,i.by));return Array.isArray(i.modelValue.value)?a=i.modelValue.value.map(c=>u(c)?.textContent??""):a=[u(i.modelValue.value)?.textContent??""],a.filter(Boolean)}),o=Te(()=>s.value.length?s.value.join(", "):e.placeholder);return(a,l)=>(he(),Ee(q(qt),{ref:q(t),as:a.as,"as-child":a.asChild,style:{pointerEvents:"none"},"data-placeholder":s.value.length?void 0:e.placeholder},{default:de(()=>[Re(a.$slots,"default",{selectedLabel:s.value,modelValue:q(i).modelValue.value},()=>[ze(ot(o.value),1)])]),_:3},8,["as","as-child","data-placeholder"]))}}),SL=EL,TL=_e({__name:"SelectViewport",props:{nonce:{type:String,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(r){const e=r,{nonce:t}=Rn(e),n=BP(t),i=cl(),s=i.position==="item-aligned"?Ev():void 0,{forwardRef:o,currentElement:a}=Ot();Lr(()=>{i?.onViewportChange(a.value)});const l=Ce(0);function u(c){const d=c.currentTarget,{shouldExpandOnScrollRef:h,contentWrapper:f}=s??{};if(h?.value&&f?.value){const m=Math.abs(l.value-d.scrollTop);if(m>0){const p=window.innerHeight-Xi*2,g=Number.parseFloat(f.value.style.minHeight),v=Number.parseFloat(f.value.style.height),y=Math.max(g,v);if(y<p){const b=y+m,E=Math.min(p,b),A=b-E;f.value.style.height=`${E}px`,f.value.style.bottom==="0px"&&(d.scrollTop=A>0?A:0,f.value.style.justifyContent="flex-end")}}}l.value=d.scrollTop}return(c,d)=>(he(),ke(Tt,null,[ge(q(qt),et({ref:q(o),"data-reka-select-viewport":"",role:"presentation"},{...c.$attrs,...e},{style:{position:"relative",flex:1,overflow:"hidden auto"},onScroll:u}),{default:de(()=>[Re(c.$slots,"default")]),_:3},16),ge(q(qt),{as:"style",nonce:q(n)},{default:de(()=>d[0]||(d[0]=[ze(" /* Hide scrollbars cross-browser and enable momentum scroll for touch devices */ [data-reka-select-viewport] { scrollbar-width:none; -ms-overflow-style: none; -webkit-overflow-scrolling: touch; } [data-reka-select-viewport]::-webkit-scrollbar { display: none; } ")])),_:1,__:[0]},8,["nonce"])],64))}}),RL=TL,AL=_e({__name:"BaseSeparator",props:{orientation:{type:String,required:!1,default:"horizontal"},decorative:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(r){const e=r,t=["horizontal","vertical"];function n(a){return t.includes(a)}const i=Te(()=>n(e.orientation)?e.orientation:"horizontal"),s=Te(()=>i.value==="vertical"?e.orientation:void 0),o=Te(()=>e.decorative?{role:"none"}:{"aria-orientation":s.value,role:"separator"});return(a,l)=>(he(),Ee(q(qt),et({as:a.as,"as-child":a.asChild,"data-orientation":i.value},o.value),{default:de(()=>[Re(a.$slots,"default")]),_:3},16,["as","as-child","data-orientation"]))}}),CL=AL,NL=_e({__name:"Separator",props:{orientation:{type:String,required:!1,default:"horizontal"},decorative:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(r){const e=r;return(t,n)=>(he(),Ee(CL,en(un(e)),{default:de(()=>[Re(t.$slots,"default")]),_:3},16))}}),ML=NL;const[OL,IL]=Mn("SwitchRoot");var kL=_e({__name:"SwitchRoot",props:{defaultValue:{type:Boolean,required:!1},modelValue:{type:[Boolean,null],required:!1,default:void 0},disabled:{type:Boolean,required:!1},id:{type:String,required:!1},value:{type:String,required:!1,default:"on"},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"button"},name:{type:String,required:!1},required:{type:Boolean,required:!1}},emits:["update:modelValue"],setup(r,{emit:e}){const t=r,n=e,{disabled:i}=Rn(t),s=hs(t,"modelValue",n,{defaultValue:t.defaultValue,passive:t.modelValue===void 0});function o(){i.value||(s.value=!s.value)}const{forwardRef:a,currentElement:l}=Ot(),u=mR(l),c=Te(()=>t.id&&l.value?document.querySelector(`[for="${t.id}"]`)?.innerText:void 0);return IL({modelValue:s,toggleCheck:o,disabled:i}),(d,h)=>(he(),Ee(q(qt),et(d.$attrs,{id:d.id,ref:q(a),role:"switch",type:d.as==="button"?"button":void 0,value:d.value,"aria-label":d.$attrs["aria-label"]||c.value,"aria-checked":q(s),"aria-required":d.required,"data-state":q(s)?"checked":"unchecked","data-disabled":q(i)?"":void 0,"as-child":d.asChild,as:d.as,disabled:q(i),onClick:o,onKeydown:yy(as(o,["prevent"]),["enter"])}),{default:de(()=>[Re(d.$slots,"default",{modelValue:q(s)}),q(u)&&d.name?(he(),Ee(q(C7),{key:0,type:"checkbox",name:d.name,disabled:q(i),required:d.required,value:d.value,checked:!!q(s)},null,8,["name","disabled","required","value","checked"])):zt("v-if",!0)]),_:3},16,["id","type","value","aria-label","aria-checked","aria-required","data-state","data-disabled","as-child","as","disabled","onKeydown"]))}}),PL=kL,FL=_e({__name:"SwitchThumb",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"span"}},setup(r){const e=OL();return Ot(),(t,n)=>(he(),Ee(q(qt),{"data-state":q(e).modelValue?.value?"checked":"unchecked","data-disabled":q(e).disabled.value?"":void 0,"as-child":t.asChild,as:t.as},{default:de(()=>[Re(t.$slots,"default")]),_:3},8,["data-state","data-disabled","as-child","as"]))}}),LL=FL;const[Sv,DL]=Mn("TabsRoot");var BL=_e({__name:"TabsRoot",props:{defaultValue:{type:null,required:!1},orientation:{type:String,required:!1,default:"horizontal"},dir:{type:String,required:!1},activationMode:{type:String,required:!1,default:"automatic"},modelValue:{type:null,required:!1},unmountOnHide:{type:Boolean,required:!1,default:!0},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["update:modelValue"],setup(r,{emit:e}){const t=r,n=e,{orientation:i,unmountOnHide:s,dir:o}=Rn(t),a=rh(o);Ot();const l=hs(t,"modelValue",n,{defaultValue:t.defaultValue,passive:t.modelValue===void 0}),u=Ce(),c=wp(new Set);return DL({modelValue:l,changeModelValue:d=>{l.value=d},orientation:i,dir:a,unmountOnHide:s,activationMode:t.activationMode,baseId:Gi(void 0,"reka-tabs"),tabsList:u,contentIds:c,registerContent:d=>{c.value=new Set([...c.value,d])},unregisterContent:d=>{const h=new Set(c.value);h.delete(d),c.value=h}}),(d,h)=>(he(),Ee(q(qt),{dir:q(a),"data-orientation":q(i),"as-child":d.asChild,as:d.as},{default:de(()=>[Re(d.$slots,"default",{modelValue:q(l)})]),_:3},8,["dir","data-orientation","as-child","as"]))}}),UL=BL;function qR(r,e){return`${r}-trigger-${e}`}function YR(r,e){return`${r}-content-${e}`}var VL=_e({__name:"TabsContent",props:{value:{type:[String,Number],required:!0},forceMount:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(r){const e=r,{forwardRef:t}=Ot(),n=Sv(),i=Te(()=>qR(n.baseId,e.value)),s=Te(()=>YR(n.baseId,e.value)),o=Te(()=>e.value===n.modelValue.value),a=Ce(o.value);return Lr(()=>{n.registerContent(e.value),requestAnimationFrame(()=>{a.value=!1})}),Sp(()=>{n.unregisterContent(e.value)}),(l,u)=>(he(),Ee(q(vu),{present:l.forceMount||o.value,"force-mount":""},{default:de(({present:c})=>[ge(q(qt),{id:s.value,ref:q(t),"as-child":l.asChild,as:l.as,role:"tabpanel","data-state":o.value?"active":"inactive","data-orientation":q(n).orientation.value,"aria-labelledby":i.value,hidden:!c,tabindex:"0",style:qs({animationDuration:a.value?"0s":void 0})},{default:de(()=>[!q(n).unmountOnHide.value||c?Re(l.$slots,"default",{key:0}):zt("v-if",!0)]),_:2},1032,["id","as-child","as","data-state","data-orientation","aria-labelledby","hidden","style"])]),_:3},8,["present"]))}}),jL=VL,$L=_e({__name:"TabsList",props:{loop:{type:Boolean,required:!1,default:!0},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(r){const e=r,{loop:t}=Rn(e),{forwardRef:n,currentElement:i}=Ot(),s=Sv();return s.tabsList=i,(o,a)=>(he(),Ee(q(xR),{"as-child":"",orientation:q(s).orientation.value,dir:q(s).dir.value,loop:q(t)},{default:de(()=>[ge(q(qt),{ref:q(n),role:"tablist","as-child":o.asChild,as:o.as,"aria-orientation":q(s).orientation.value},{default:de(()=>[Re(o.$slots,"default")]),_:3},8,["as-child","as","aria-orientation"])]),_:3},8,["orientation","dir","loop"]))}}),zL=$L,HL=_e({__name:"TabsTrigger",props:{value:{type:[String,Number],required:!0},disabled:{type:Boolean,required:!1,default:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"button"}},setup(r){const e=r,{forwardRef:t}=Ot(),n=Sv(),i=Te(()=>qR(n.baseId,e.value)),s=Te(()=>n.contentIds.value.has(e.value)?YR(n.baseId,e.value):void 0),o=Te(()=>e.value===n.modelValue.value);return(a,l)=>(he(),Ee(q(S7),{"as-child":"",focusable:!a.disabled,active:o.value},{default:de(()=>[ge(q(qt),{id:i.value,ref:q(t),role:"tab",type:a.as==="button"?"button":void 0,as:a.as,"as-child":a.asChild,"aria-selected":o.value?"true":"false","aria-controls":s.value,"data-state":o.value?"active":"inactive",disabled:a.disabled,"data-disabled":a.disabled?"":void 0,"data-orientation":q(n).orientation.value,onMousedown:l[0]||(l[0]=as(u=>{!a.disabled&&u.ctrlKey===!1?q(n).changeModelValue(a.value):u.preventDefault()},["left"])),onKeydown:l[1]||(l[1]=yy(u=>q(n).changeModelValue(a.value),["enter","space"])),onFocus:l[2]||(l[2]=()=>{const u=q(n).activationMode!=="manual";!o.value&&!a.disabled&&u&&q(n).changeModelValue(a.value)})},{default:de(()=>[Re(a.$slots,"default")]),_:3},8,["id","type","as","as-child","aria-selected","aria-controls","data-state","disabled","data-disabled","data-orientation"])]),_:3},8,["focusable","active"]))}}),WL=HL;const GL=(r,e)=>{const t=new Array(r.length+e.length);for(let n=0;n<r.length;n++)t[n]=r[n];for(let n=0;n<e.length;n++)t[r.length+n]=e[n];return t},qL=(r,e)=>({classGroupId:r,validator:e}),XR=(r=new Map,e=null,t)=>({nextPart:r,validators:e,classGroupId:t}),If="-",Xw=[],YL="arbitrary..",XL=r=>{const e=ZL(r),{conflictingClassGroups:t,conflictingClassGroupModifiers:n}=r;return{getClassGroupId:o=>{if(o.startsWith("[")&&o.endsWith("]"))return KL(o);const a=o.split(If),l=a[0]===""&&a.length>1?1:0;return KR(a,l,e)},getConflictingClassGroupIds:(o,a)=>{if(a){const l=n[o],u=t[o];return l?u?GL(u,l):l:u||Xw}return t[o]||Xw}}},KR=(r,e,t)=>{if(r.length-e===0)return t.classGroupId;const i=r[e],s=t.nextPart.get(i);if(s){const u=KR(r,e+1,s);if(u)return u}const o=t.validators;if(o===null)return;const a=e===0?r.join(If):r.slice(e).join(If),l=o.length;for(let u=0;u<l;u++){const c=o[u];if(c.validator(a))return c.classGroupId}},KL=r=>r.slice(1,-1).indexOf(":")===-1?void 0:(()=>{const e=r.slice(1,-1),t=e.indexOf(":"),n=e.slice(0,t);return n?YL+n:void 0})(),ZL=r=>{const{theme:e,classGroups:t}=r;return QL(t,e)},QL=(r,e)=>{const t=XR();for(const n in r){const i=r[n];Tv(i,t,n,e)}return t},Tv=(r,e,t,n)=>{const i=r.length;for(let s=0;s<i;s++){const o=r[s];JL(o,e,t,n)}},JL=(r,e,t,n)=>{if(typeof r=="string"){eD(r,e,t);return}if(typeof r=="function"){tD(r,e,t,n);return}rD(r,e,t,n)},eD=(r,e,t)=>{const n=r===""?e:ZR(e,r);n.classGroupId=t},tD=(r,e,t,n)=>{if(nD(r)){Tv(r(n),e,t,n);return}e.validators===null&&(e.validators=[]),e.validators.push(qL(t,r))},rD=(r,e,t,n)=>{const i=Object.entries(r),s=i.length;for(let o=0;o<s;o++){const[a,l]=i[o];Tv(l,ZR(e,a),t,n)}},ZR=(r,e)=>{let t=r;const n=e.split(If),i=n.length;for(let s=0;s<i;s++){const o=n[s];let a=t.nextPart.get(o);a||(a=XR(),t.nextPart.set(o,a)),t=a}return t},nD=r=>"isThemeGetter"in r&&r.isThemeGetter===!0,iD=r=>{if(r<1)return{get:()=>{},set:()=>{}};let e=0,t=Object.create(null),n=Object.create(null);const i=(s,o)=>{t[s]=o,e++,e>r&&(e=0,n=t,t=Object.create(null))};return{get(s){let o=t[s];if(o!==void 0)return o;if((o=n[s])!==void 0)return i(s,o),o},set(s,o){s in t?t[s]=o:i(s,o)}}},v0="!",Kw=":",sD=[],Zw=(r,e,t,n,i)=>({modifiers:r,hasImportantModifier:e,baseClassName:t,maybePostfixModifierPosition:n,isExternal:i}),oD=r=>{const{prefix:e,experimentalParseClassName:t}=r;let n=i=>{const s=[];let o=0,a=0,l=0,u;const c=i.length;for(let p=0;p<c;p++){const g=i[p];if(o===0&&a===0){if(g===Kw){s.push(i.slice(l,p)),l=p+1;continue}if(g==="/"){u=p;continue}}g==="["?o++:g==="]"?o--:g==="("?a++:g===")"&&a--}const d=s.length===0?i:i.slice(l);let h=d,f=!1;d.endsWith(v0)?(h=d.slice(0,-1),f=!0):d.startsWith(v0)&&(h=d.slice(1),f=!0);const m=u&&u>l?u-l:void 0;return Zw(s,f,h,m)};if(e){const i=e+Kw,s=n;n=o=>o.startsWith(i)?s(o.slice(i.length)):Zw(sD,!1,o,void 0,!0)}if(t){const i=n;n=s=>t({className:s,parseClassName:i})}return n},aD=r=>{const e=new Map;return r.orderSensitiveModifiers.forEach((t,n)=>{e.set(t,1e6+n)}),t=>{const n=[];let i=[];for(let s=0;s<t.length;s++){const o=t[s],a=o[0]==="[",l=e.has(o);a||l?(i.length>0&&(i.sort(),n.push(...i),i=[]),n.push(o)):i.push(o)}return i.length>0&&(i.sort(),n.push(...i)),n}},lD=r=>({cache:iD(r.cacheSize),parseClassName:oD(r),sortModifiers:aD(r),...XL(r)}),uD=/\s+/,cD=(r,e)=>{const{parseClassName:t,getClassGroupId:n,getConflictingClassGroupIds:i,sortModifiers:s}=e,o=[],a=r.trim().split(uD);let l="";for(let u=a.length-1;u>=0;u-=1){const c=a[u],{isExternal:d,modifiers:h,hasImportantModifier:f,baseClassName:m,maybePostfixModifierPosition:p}=t(c);if(d){l=c+(l.length>0?" "+l:l);continue}let g=!!p,v=n(g?m.substring(0,p):m);if(!v){if(!g){l=c+(l.length>0?" "+l:l);continue}if(v=n(m),!v){l=c+(l.length>0?" "+l:l);continue}g=!1}const y=h.length===0?"":h.length===1?h[0]:s(h).join(":"),b=f?y+v0:y,E=b+v;if(o.indexOf(E)>-1)continue;o.push(E);const A=i(v,g);for(let M=0;M<A.length;++M){const L=A[M];o.push(b+L)}l=c+(l.length>0?" "+l:l)}return l},hD=(...r)=>{let e=0,t,n,i="";for(;e<r.length;)(t=r[e++])&&(n=QR(t))&&(i&&(i+=" "),i+=n);return i},QR=r=>{if(typeof r=="string")return r;let e,t="";for(let n=0;n<r.length;n++)r[n]&&(e=QR(r[n]))&&(t&&(t+=" "),t+=e);return t},dD=(r,...e)=>{let t,n,i,s;const o=l=>{const u=e.reduce((c,d)=>d(c),r());return t=lD(u),n=t.cache.get,i=t.cache.set,s=a,a(l)},a=l=>{const u=n(l);if(u)return u;const c=cD(l,t);return i(l,c),c};return s=o,(...l)=>s(hD(...l))},fD=[],sn=r=>{const e=t=>t[r]||fD;return e.isThemeGetter=!0,e},JR=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,eA=/^\((?:(\w[\w-]*):)?(.+)\)$/i,pD=/^\d+\/\d+$/,mD=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,gD=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,yD=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,vD=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,bD=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Al=r=>pD.test(r),Ut=r=>!!r&&!Number.isNaN(Number(r)),Ho=r=>!!r&&Number.isInteger(Number(r)),Xm=r=>r.endsWith("%")&&Ut(r.slice(0,-1)),so=r=>mD.test(r),wD=()=>!0,_D=r=>gD.test(r)&&!yD.test(r),tA=()=>!1,xD=r=>vD.test(r),ED=r=>bD.test(r),SD=r=>!tt(r)&&!rt(r),TD=r=>wu(r,iA,tA),tt=r=>JR.test(r),Ia=r=>wu(r,sA,_D),Km=r=>wu(r,MD,Ut),Qw=r=>wu(r,rA,tA),RD=r=>wu(r,nA,ED),Yh=r=>wu(r,oA,xD),rt=r=>eA.test(r),Nu=r=>_u(r,sA),AD=r=>_u(r,OD),Jw=r=>_u(r,rA),CD=r=>_u(r,iA),ND=r=>_u(r,nA),Xh=r=>_u(r,oA,!0),wu=(r,e,t)=>{const n=JR.exec(r);return n?n[1]?e(n[1]):t(n[2]):!1},_u=(r,e,t=!1)=>{const n=eA.exec(r);return n?n[1]?e(n[1]):t:!1},rA=r=>r==="position"||r==="percentage",nA=r=>r==="image"||r==="url",iA=r=>r==="length"||r==="size"||r==="bg-size",sA=r=>r==="length",MD=r=>r==="number",OD=r=>r==="family-name",oA=r=>r==="shadow",ID=()=>{const r=sn("color"),e=sn("font"),t=sn("text"),n=sn("font-weight"),i=sn("tracking"),s=sn("leading"),o=sn("breakpoint"),a=sn("container"),l=sn("spacing"),u=sn("radius"),c=sn("shadow"),d=sn("inset-shadow"),h=sn("text-shadow"),f=sn("drop-shadow"),m=sn("blur"),p=sn("perspective"),g=sn("aspect"),v=sn("ease"),y=sn("animate"),b=()=>["auto","avoid","all","avoid-page","page","left","right","column"],E=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],A=()=>[...E(),rt,tt],M=()=>["auto","hidden","clip","visible","scroll"],L=()=>["auto","contain","none"],k=()=>[rt,tt,l],P=()=>[Al,"full","auto",...k()],U=()=>[Ho,"none","subgrid",rt,tt],$=()=>["auto",{span:["full",Ho,rt,tt]},Ho,rt,tt],V=()=>[Ho,"auto",rt,tt],R=()=>["auto","min","max","fr",rt,tt],O=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],T=()=>["start","end","center","stretch","center-safe","end-safe"],w=()=>["auto",...k()],x=()=>[Al,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...k()],_=()=>[r,rt,tt],S=()=>[...E(),Jw,Qw,{position:[rt,tt]}],C=()=>["no-repeat",{repeat:["","x","y","space","round"]}],F=()=>["auto","cover","contain",CD,TD,{size:[rt,tt]}],D=()=>[Xm,Nu,Ia],H=()=>["","none","full",u,rt,tt],G=()=>["",Ut,Nu,Ia],ee=()=>["solid","dashed","dotted","double"],B=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],X=()=>[Ut,Xm,Jw,Qw],I=()=>["","none",m,rt,tt],N=()=>["none",Ut,rt,tt],j=()=>["none",Ut,rt,tt],Q=()=>[Ut,rt,tt],W=()=>[Al,"full",...k()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[so],breakpoint:[so],color:[wD],container:[so],"drop-shadow":[so],ease:["in","out","in-out"],font:[SD],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[so],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[so],shadow:[so],spacing:["px",Ut],text:[so],"text-shadow":[so],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Al,tt,rt,g]}],container:["container"],columns:[{columns:[Ut,tt,rt,a]}],"break-after":[{"break-after":b()}],"break-before":[{"break-before":b()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:A()}],overflow:[{overflow:M()}],"overflow-x":[{"overflow-x":M()}],"overflow-y":[{"overflow-y":M()}],overscroll:[{overscroll:L()}],"overscroll-x":[{"overscroll-x":L()}],"overscroll-y":[{"overscroll-y":L()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:P()}],"inset-x":[{"inset-x":P()}],"inset-y":[{"inset-y":P()}],start:[{start:P()}],end:[{end:P()}],top:[{top:P()}],right:[{right:P()}],bottom:[{bottom:P()}],left:[{left:P()}],visibility:["visible","invisible","collapse"],z:[{z:[Ho,"auto",rt,tt]}],basis:[{basis:[Al,"full","auto",a,...k()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Ut,Al,"auto","initial","none",tt]}],grow:[{grow:["",Ut,rt,tt]}],shrink:[{shrink:["",Ut,rt,tt]}],order:[{order:[Ho,"first","last","none",rt,tt]}],"grid-cols":[{"grid-cols":U()}],"col-start-end":[{col:$()}],"col-start":[{"col-start":V()}],"col-end":[{"col-end":V()}],"grid-rows":[{"grid-rows":U()}],"row-start-end":[{row:$()}],"row-start":[{"row-start":V()}],"row-end":[{"row-end":V()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":R()}],"auto-rows":[{"auto-rows":R()}],gap:[{gap:k()}],"gap-x":[{"gap-x":k()}],"gap-y":[{"gap-y":k()}],"justify-content":[{justify:[...O(),"normal"]}],"justify-items":[{"justify-items":[...T(),"normal"]}],"justify-self":[{"justify-self":["auto",...T()]}],"align-content":[{content:["normal",...O()]}],"align-items":[{items:[...T(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...T(),{baseline:["","last"]}]}],"place-content":[{"place-content":O()}],"place-items":[{"place-items":[...T(),"baseline"]}],"place-self":[{"place-self":["auto",...T()]}],p:[{p:k()}],px:[{px:k()}],py:[{py:k()}],ps:[{ps:k()}],pe:[{pe:k()}],pt:[{pt:k()}],pr:[{pr:k()}],pb:[{pb:k()}],pl:[{pl:k()}],m:[{m:w()}],mx:[{mx:w()}],my:[{my:w()}],ms:[{ms:w()}],me:[{me:w()}],mt:[{mt:w()}],mr:[{mr:w()}],mb:[{mb:w()}],ml:[{ml:w()}],"space-x":[{"space-x":k()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":k()}],"space-y-reverse":["space-y-reverse"],size:[{size:x()}],w:[{w:[a,"screen",...x()]}],"min-w":[{"min-w":[a,"screen","none",...x()]}],"max-w":[{"max-w":[a,"screen","none","prose",{screen:[o]},...x()]}],h:[{h:["screen","lh",...x()]}],"min-h":[{"min-h":["screen","lh","none",...x()]}],"max-h":[{"max-h":["screen","lh",...x()]}],"font-size":[{text:["base",t,Nu,Ia]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[n,rt,Km]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",Xm,tt]}],"font-family":[{font:[AD,tt,e]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[i,rt,tt]}],"line-clamp":[{"line-clamp":[Ut,"none",rt,Km]}],leading:[{leading:[s,...k()]}],"list-image":[{"list-image":["none",rt,tt]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",rt,tt]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:_()}],"text-color":[{text:_()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ee(),"wavy"]}],"text-decoration-thickness":[{decoration:[Ut,"from-font","auto",rt,Ia]}],"text-decoration-color":[{decoration:_()}],"underline-offset":[{"underline-offset":[Ut,"auto",rt,tt]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:k()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",rt,tt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",rt,tt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:S()}],"bg-repeat":[{bg:C()}],"bg-size":[{bg:F()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Ho,rt,tt],radial:["",rt,tt],conic:[Ho,rt,tt]},ND,RD]}],"bg-color":[{bg:_()}],"gradient-from-pos":[{from:D()}],"gradient-via-pos":[{via:D()}],"gradient-to-pos":[{to:D()}],"gradient-from":[{from:_()}],"gradient-via":[{via:_()}],"gradient-to":[{to:_()}],rounded:[{rounded:H()}],"rounded-s":[{"rounded-s":H()}],"rounded-e":[{"rounded-e":H()}],"rounded-t":[{"rounded-t":H()}],"rounded-r":[{"rounded-r":H()}],"rounded-b":[{"rounded-b":H()}],"rounded-l":[{"rounded-l":H()}],"rounded-ss":[{"rounded-ss":H()}],"rounded-se":[{"rounded-se":H()}],"rounded-ee":[{"rounded-ee":H()}],"rounded-es":[{"rounded-es":H()}],"rounded-tl":[{"rounded-tl":H()}],"rounded-tr":[{"rounded-tr":H()}],"rounded-br":[{"rounded-br":H()}],"rounded-bl":[{"rounded-bl":H()}],"border-w":[{border:G()}],"border-w-x":[{"border-x":G()}],"border-w-y":[{"border-y":G()}],"border-w-s":[{"border-s":G()}],"border-w-e":[{"border-e":G()}],"border-w-t":[{"border-t":G()}],"border-w-r":[{"border-r":G()}],"border-w-b":[{"border-b":G()}],"border-w-l":[{"border-l":G()}],"divide-x":[{"divide-x":G()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":G()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...ee(),"hidden","none"]}],"divide-style":[{divide:[...ee(),"hidden","none"]}],"border-color":[{border:_()}],"border-color-x":[{"border-x":_()}],"border-color-y":[{"border-y":_()}],"border-color-s":[{"border-s":_()}],"border-color-e":[{"border-e":_()}],"border-color-t":[{"border-t":_()}],"border-color-r":[{"border-r":_()}],"border-color-b":[{"border-b":_()}],"border-color-l":[{"border-l":_()}],"divide-color":[{divide:_()}],"outline-style":[{outline:[...ee(),"none","hidden"]}],"outline-offset":[{"outline-offset":[Ut,rt,tt]}],"outline-w":[{outline:["",Ut,Nu,Ia]}],"outline-color":[{outline:_()}],shadow:[{shadow:["","none",c,Xh,Yh]}],"shadow-color":[{shadow:_()}],"inset-shadow":[{"inset-shadow":["none",d,Xh,Yh]}],"inset-shadow-color":[{"inset-shadow":_()}],"ring-w":[{ring:G()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:_()}],"ring-offset-w":[{"ring-offset":[Ut,Ia]}],"ring-offset-color":[{"ring-offset":_()}],"inset-ring-w":[{"inset-ring":G()}],"inset-ring-color":[{"inset-ring":_()}],"text-shadow":[{"text-shadow":["none",h,Xh,Yh]}],"text-shadow-color":[{"text-shadow":_()}],opacity:[{opacity:[Ut,rt,tt]}],"mix-blend":[{"mix-blend":[...B(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":B()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[Ut]}],"mask-image-linear-from-pos":[{"mask-linear-from":X()}],"mask-image-linear-to-pos":[{"mask-linear-to":X()}],"mask-image-linear-from-color":[{"mask-linear-from":_()}],"mask-image-linear-to-color":[{"mask-linear-to":_()}],"mask-image-t-from-pos":[{"mask-t-from":X()}],"mask-image-t-to-pos":[{"mask-t-to":X()}],"mask-image-t-from-color":[{"mask-t-from":_()}],"mask-image-t-to-color":[{"mask-t-to":_()}],"mask-image-r-from-pos":[{"mask-r-from":X()}],"mask-image-r-to-pos":[{"mask-r-to":X()}],"mask-image-r-from-color":[{"mask-r-from":_()}],"mask-image-r-to-color":[{"mask-r-to":_()}],"mask-image-b-from-pos":[{"mask-b-from":X()}],"mask-image-b-to-pos":[{"mask-b-to":X()}],"mask-image-b-from-color":[{"mask-b-from":_()}],"mask-image-b-to-color":[{"mask-b-to":_()}],"mask-image-l-from-pos":[{"mask-l-from":X()}],"mask-image-l-to-pos":[{"mask-l-to":X()}],"mask-image-l-from-color":[{"mask-l-from":_()}],"mask-image-l-to-color":[{"mask-l-to":_()}],"mask-image-x-from-pos":[{"mask-x-from":X()}],"mask-image-x-to-pos":[{"mask-x-to":X()}],"mask-image-x-from-color":[{"mask-x-from":_()}],"mask-image-x-to-color":[{"mask-x-to":_()}],"mask-image-y-from-pos":[{"mask-y-from":X()}],"mask-image-y-to-pos":[{"mask-y-to":X()}],"mask-image-y-from-color":[{"mask-y-from":_()}],"mask-image-y-to-color":[{"mask-y-to":_()}],"mask-image-radial":[{"mask-radial":[rt,tt]}],"mask-image-radial-from-pos":[{"mask-radial-from":X()}],"mask-image-radial-to-pos":[{"mask-radial-to":X()}],"mask-image-radial-from-color":[{"mask-radial-from":_()}],"mask-image-radial-to-color":[{"mask-radial-to":_()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":E()}],"mask-image-conic-pos":[{"mask-conic":[Ut]}],"mask-image-conic-from-pos":[{"mask-conic-from":X()}],"mask-image-conic-to-pos":[{"mask-conic-to":X()}],"mask-image-conic-from-color":[{"mask-conic-from":_()}],"mask-image-conic-to-color":[{"mask-conic-to":_()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:S()}],"mask-repeat":[{mask:C()}],"mask-size":[{mask:F()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",rt,tt]}],filter:[{filter:["","none",rt,tt]}],blur:[{blur:I()}],brightness:[{brightness:[Ut,rt,tt]}],contrast:[{contrast:[Ut,rt,tt]}],"drop-shadow":[{"drop-shadow":["","none",f,Xh,Yh]}],"drop-shadow-color":[{"drop-shadow":_()}],grayscale:[{grayscale:["",Ut,rt,tt]}],"hue-rotate":[{"hue-rotate":[Ut,rt,tt]}],invert:[{invert:["",Ut,rt,tt]}],saturate:[{saturate:[Ut,rt,tt]}],sepia:[{sepia:["",Ut,rt,tt]}],"backdrop-filter":[{"backdrop-filter":["","none",rt,tt]}],"backdrop-blur":[{"backdrop-blur":I()}],"backdrop-brightness":[{"backdrop-brightness":[Ut,rt,tt]}],"backdrop-contrast":[{"backdrop-contrast":[Ut,rt,tt]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Ut,rt,tt]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Ut,rt,tt]}],"backdrop-invert":[{"backdrop-invert":["",Ut,rt,tt]}],"backdrop-opacity":[{"backdrop-opacity":[Ut,rt,tt]}],"backdrop-saturate":[{"backdrop-saturate":[Ut,rt,tt]}],"backdrop-sepia":[{"backdrop-sepia":["",Ut,rt,tt]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":k()}],"border-spacing-x":[{"border-spacing-x":k()}],"border-spacing-y":[{"border-spacing-y":k()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",rt,tt]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Ut,"initial",rt,tt]}],ease:[{ease:["linear","initial",v,rt,tt]}],delay:[{delay:[Ut,rt,tt]}],animate:[{animate:["none",y,rt,tt]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[p,rt,tt]}],"perspective-origin":[{"perspective-origin":A()}],rotate:[{rotate:N()}],"rotate-x":[{"rotate-x":N()}],"rotate-y":[{"rotate-y":N()}],"rotate-z":[{"rotate-z":N()}],scale:[{scale:j()}],"scale-x":[{"scale-x":j()}],"scale-y":[{"scale-y":j()}],"scale-z":[{"scale-z":j()}],"scale-3d":["scale-3d"],skew:[{skew:Q()}],"skew-x":[{"skew-x":Q()}],"skew-y":[{"skew-y":Q()}],transform:[{transform:[rt,tt,"","none","gpu","cpu"]}],"transform-origin":[{origin:A()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:W()}],"translate-x":[{"translate-x":W()}],"translate-y":[{"translate-y":W()}],"translate-z":[{"translate-z":W()}],"translate-none":["translate-none"],accent:[{accent:_()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:_()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",rt,tt]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":k()}],"scroll-mx":[{"scroll-mx":k()}],"scroll-my":[{"scroll-my":k()}],"scroll-ms":[{"scroll-ms":k()}],"scroll-me":[{"scroll-me":k()}],"scroll-mt":[{"scroll-mt":k()}],"scroll-mr":[{"scroll-mr":k()}],"scroll-mb":[{"scroll-mb":k()}],"scroll-ml":[{"scroll-ml":k()}],"scroll-p":[{"scroll-p":k()}],"scroll-px":[{"scroll-px":k()}],"scroll-py":[{"scroll-py":k()}],"scroll-ps":[{"scroll-ps":k()}],"scroll-pe":[{"scroll-pe":k()}],"scroll-pt":[{"scroll-pt":k()}],"scroll-pr":[{"scroll-pr":k()}],"scroll-pb":[{"scroll-pb":k()}],"scroll-pl":[{"scroll-pl":k()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",rt,tt]}],fill:[{fill:["none",..._()]}],"stroke-w":[{stroke:[Ut,Nu,Ia,Km]}],stroke:[{stroke:["none",..._()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},kD=dD(ID);function Bt(...r){return kD(lR(r))}function PD(r,e="fr-FR"){return r?.value===null||r?.value===void 0?"":r?.formula?r?.formula:r?.value instanceof Date?r?.value.toLocaleDateString(e):r.value}const Un=_e({__name:"Button",props:{variant:{},size:{},class:{},asChild:{type:Boolean},as:{default:"button"}},setup(r){const e=r;return(t,n)=>(he(),Ee(q(qt),{"data-slot":"button",as:r.as,"as-child":r.asChild,class:mt(q(Bt)(q(FD)({variant:r.variant,size:r.size}),e.class))},{default:de(()=>[Re(t.$slots,"default")]),_:3},8,["as","as-child","class"]))}}),FD=uR("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9","icon-sm":"size-8","icon-lg":"size-10"}},defaultVariants:{variant:"default",size:"default"}}),LD={class:"w-full max-w-2xl mx-auto p-6"},DD={class:"border-2 border-dashed border-gray-300 rounded-lg p-12 text-center hover:border-gray-400 transition-colors"},BD={key:0,class:"mt-4 text-sm text-red-600"},UD=_e({__name:"ExcelImporter",setup(r){const e=Ce(null),t=Ce(!1),n=Ce(null);function i(a){const u=a.target.files?.[0];if(!u)return;if(!["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel"].includes(u.type)&&!u.name.match(/\.(xlsx|xls)$/i)){n.value="Veuillez slectionner un fichier Excel (.xlsx ou .xls)";return}s(u)}async function s(a){t.value=!0,n.value=null;try{const l=new Ck.Workbook,u=await a.arrayBuffer();await l.xlsx.load(u),mk(l,a.name),t.value=!1,console.log(" Excel charg avec ExcelJS:",{fileName:a.name,sheets:ht.sheetNames,sheetCount:ht.sheetNames.length,currentSheet:ht.currentSheet.name,rawDataPreview:ht.currentSheet.rawData.slice(0,5)})}catch(l){n.value="Erreur lors de la lecture du fichier",t.value=!1,console.error("Erreur ExcelJS:",l)}}function o(){e.value?.click()}return(a,l)=>(he(),ke("div",LD,[we("div",DD,[we("input",{ref_key:"fileInput",ref:e,type:"file",accept:".xlsx,.xls",class:"hidden",onChange:i},null,544),ge(q(Hk),{class:"w-12 h-12 mx-auto mb-4 text-gray-400"}),l[0]||(l[0]=we("h3",{class:"text-lg font-semibold mb-2"},"Importer un fichier Excel",-1)),l[1]||(l[1]=we("p",{class:"text-sm text-gray-600 mb-4"},"Glissez-dposez ou cliquez pour slectionner",-1)),ge(q(Un),{onClick:o,disabled:t.value},{default:de(()=>[ze(ot(t.value?"Chargement...":"Slectionner un fichier"),1)]),_:1},8,["disabled"]),n.value?(he(),ke("p",BD,ot(n.value),1)):zt("",!0)])]))}}),lu=_e({__name:"Badge",props:{asChild:{type:Boolean},as:{},variant:{},class:{}},setup(r){const e=r,t=Dr(e,"class");return(n,i)=>(he(),Ee(q(qt),et({"data-slot":"badge",class:q(Bt)(q(VD)({variant:r.variant}),e.class)},q(t)),{default:de(()=>[Re(n.$slots,"default")]),_:3},16,["class"]))}}),VD=uR("inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}}),jD=_e({__name:"Select",props:{open:{type:Boolean},defaultOpen:{type:Boolean},defaultValue:{},modelValue:{},by:{type:[String,Function]},dir:{},multiple:{type:Boolean},autocomplete:{},disabled:{type:Boolean},name:{},required:{type:Boolean}},emits:["update:modelValue","update:open"],setup(r,{emit:e}){const i=On(r,e);return(s,o)=>(he(),Ee(q(zF),et({"data-slot":"select"},q(i)),{default:de(a=>[Re(s.$slots,"default",en(un(a)))]),_:3},16))}}),$D=_e({inheritAttrs:!1,__name:"SelectContent",props:{forceMount:{type:Boolean},position:{default:"popper"},bodyLock:{type:Boolean},side:{},sideOffset:{},sideFlip:{type:Boolean},align:{},alignOffset:{},alignFlip:{type:Boolean},avoidCollisions:{type:Boolean},collisionBoundary:{},collisionPadding:{},arrowPadding:{},hideShiftedArrow:{type:Boolean},sticky:{},hideWhenDetached:{type:Boolean},positionStrategy:{},updatePositionStrategy:{},disableUpdateOnLayoutShift:{type:Boolean},prioritizePosition:{type:Boolean},reference:{},asChild:{type:Boolean},as:{},disableOutsidePointerEvents:{type:Boolean},class:{}},emits:["closeAutoFocus","escapeKeyDown","pointerDownOutside"],setup(r,{emit:e}){const t=r,n=e,i=Dr(t,"class"),s=On(i,n);return(o,a)=>(he(),Ee(q(mL),null,{default:de(()=>[ge(q(iL),et({"data-slot":"select-content"},{...o.$attrs,...q(s)},{class:q(Bt)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--reka-select-content-available-height) min-w-[8rem] overflow-x-hidden overflow-y-auto rounded-md border shadow-md",r.position==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t.class)}),{default:de(()=>[ge(q(GD)),ge(q(RL),{class:mt(q(Bt)("p-1",r.position==="popper"&&"h-[var(--reka-select-trigger-height)] w-full min-w-[var(--reka-select-trigger-width)] scroll-my-1"))},{default:de(()=>[Re(o.$slots,"default")]),_:3},8,["class"]),ge(q(WD))]),_:3},16,["class"])]),_:3}))}}),zD={class:"absolute right-2 flex size-3.5 items-center justify-center"},HD=_e({__name:"SelectItem",props:{value:{},disabled:{type:Boolean},textValue:{},asChild:{type:Boolean},as:{},class:{}},setup(r){const e=r,t=Dr(e,"class"),n=pi(t);return(i,s)=>(he(),Ee(q(uL),et({"data-slot":"select-item"},q(n),{class:q(Bt)("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",e.class)}),{default:de(()=>[we("span",zD,[ge(q(hL),null,{default:de(()=>[Re(i.$slots,"indicator-icon",{},()=>[ge(q(Fk),{class:"size-4"})])]),_:3})]),ge(q(fL),null,{default:de(()=>[Re(i.$slots,"default")]),_:3})]),_:3},16,["class"]))}}),WD=_e({__name:"SelectScrollDownButton",props:{asChild:{type:Boolean},as:{},class:{}},setup(r){const e=r,t=Dr(e,"class"),n=pi(t);return(i,s)=>(he(),Ee(q(vL),et({"data-slot":"select-scroll-down-button"},q(n),{class:q(Bt)("flex cursor-default items-center justify-center py-1",e.class)}),{default:de(()=>[Re(i.$slots,"default",{},()=>[ge(q(nR),{class:"size-4"})])]),_:3},16,["class"]))}}),GD=_e({__name:"SelectScrollUpButton",props:{asChild:{type:Boolean},as:{},class:{}},setup(r){const e=r,t=Dr(e,"class"),n=pi(t);return(i,s)=>(he(),Ee(q(wL),et({"data-slot":"select-scroll-up-button"},q(n),{class:q(Bt)("flex cursor-default items-center justify-center py-1",e.class)}),{default:de(()=>[Re(i.$slots,"default",{},()=>[ge(q(Lk),{class:"size-4"})])]),_:3},16,["class"]))}}),qD=_e({__name:"SelectTrigger",props:{disabled:{type:Boolean},reference:{},asChild:{type:Boolean},as:{},class:{},size:{default:"default"}},setup(r){const e=r,t=Dr(e,"class","size"),n=pi(t);return(i,s)=>(he(),Ee(q(xL),et({"data-slot":"select-trigger","data-size":r.size},q(n),{class:q(Bt)("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e.class)}),{default:de(()=>[Re(i.$slots,"default"),ge(q(oL),{"as-child":""},{default:de(()=>[ge(q(nR),{class:"size-4 opacity-50"})]),_:1})]),_:3},16,["data-size","class"]))}}),YD=_e({__name:"SelectValue",props:{placeholder:{},asChild:{type:Boolean},as:{}},setup(r){const e=r;return(t,n)=>(he(),Ee(q(SL),et({"data-slot":"select-value"},e),{default:de(()=>[Re(t.$slots,"default")]),_:3},16))}}),XD={class:"flex items-center justify-between pb-4 border-b"},KD={class:"flex items-center gap-3"},ZD={class:"text-2xl font-bold text-gray-900"},QD={class:"flex items-center gap-2 mt-1"},JD={class:"text-sm text-gray-500"},eB={class:"flex items-center gap-2"},tB=_e({__name:"SheetHeader",props:{title:{},currentSheetName:{},sheetNames:{},sectionCount:{}},emits:["sheetChange"],setup(r,{emit:e}){const t=e;return(n,i)=>(he(),ke("div",XD,[we("div",KD,[ge(q(Uk),{class:"w-6 h-6 text-blue-600"}),we("div",null,[we("h2",ZD,ot(r.title),1),we("div",QD,[ge(q(lu),{variant:"secondary",class:"text-xs"},{default:de(()=>[ze(ot(r.currentSheetName),1)]),_:1}),we("span",JD,ot(r.sectionCount)+" section"+ot(r.sectionCount>1?"s":""),1)])])]),r.sheetNames.length>1?(he(),Ee(q(jD),{key:0,"model-value":r.currentSheetName,"onUpdate:modelValue":i[0]||(i[0]=s=>t("sheetChange",s))},{default:de(()=>[ge(q(qD),{class:"w-[200px]"},{default:de(()=>[ge(q(YD),{placeholder:"Choose a sheet"})]),_:1}),ge(q($D),null,{default:de(()=>[(he(!0),ke(Tt,null,Er(r.sheetNames,s=>(he(),Ee(q(HD),{key:s,value:s},{default:de(()=>[we("div",eB,[ge(q(zk),{class:"w-4 h-4"}),ze(" "+ot(s),1)])]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value"])):zt("",!0)]))}}),b0=[{id:"slate",label:"Slate",bg:"bg-slate-50",border:"border-slate-200",text:"text-slate-900",accent:"bg-slate-600"},{id:"neutral",label:"Neutral",bg:"bg-neutral-50",border:"border-neutral-200",text:"text-neutral-900",accent:"bg-neutral-600"},{id:"red",label:"Red",bg:"bg-red-50",border:"border-red-200",text:"text-red-900",accent:"bg-red-600"},{id:"orange",label:"Orange",bg:"bg-orange-50",border:"border-orange-200",text:"text-orange-900",accent:"bg-orange-600"},{id:"amber",label:"Amber",bg:"bg-amber-50",border:"border-amber-200",text:"text-amber-900",accent:"bg-amber-600"},{id:"yellow",label:"Yellow",bg:"bg-yellow-50",border:"border-yellow-200",text:"text-yellow-900",accent:"bg-yellow-600"},{id:"lime",label:"Lime",bg:"bg-lime-50",border:"border-lime-200",text:"text-lime-900",accent:"bg-lime-600"},{id:"green",label:"Green",bg:"bg-green-50",border:"border-green-200",text:"text-green-900",accent:"bg-green-600"},{id:"emerald",label:"Emerald",bg:"bg-emerald-50",border:"border-emerald-200",text:"text-emerald-900",accent:"bg-emerald-600"},{id:"teal",label:"Teal",bg:"bg-teal-50",border:"border-teal-200",text:"text-teal-900",accent:"bg-teal-600"},{id:"cyan",label:"Cyan",bg:"bg-cyan-50",border:"border-cyan-200",text:"text-cyan-900",accent:"bg-cyan-600"},{id:"sky",label:"Sky",bg:"bg-sky-50",border:"border-sky-200",text:"text-sky-900",accent:"bg-sky-600"},{id:"blue",label:"Blue",bg:"bg-blue-50",border:"border-blue-200",text:"text-blue-900",accent:"bg-blue-600"},{id:"indigo",label:"Indigo",bg:"bg-indigo-50",border:"border-indigo-200",text:"text-indigo-900",accent:"bg-indigo-600"},{id:"violet",label:"Violet",bg:"bg-violet-50",border:"border-violet-200",text:"text-violet-900",accent:"bg-violet-600"},{id:"purple",label:"Purple",bg:"bg-purple-50",border:"border-purple-200",text:"text-purple-900",accent:"bg-purple-600"},{id:"fuchsia",label:"Fuchsia",bg:"bg-fuchsia-50",border:"border-fuchsia-200",text:"text-fuchsia-900",accent:"bg-fuchsia-600"},{id:"pink",label:"Pink",bg:"bg-pink-50",border:"border-pink-200",text:"text-pink-900",accent:"bg-pink-600"},{id:"rose",label:"Rose",bg:"bg-rose-50",border:"border-rose-200",text:"text-rose-900",accent:"bg-rose-600"}],rB=["large","xlarge","2xlarge"],nB=["left","right","top","bottom"];function Rv(r){return b0.find(e=>e.id===r)||b0[12]}function aA(r){switch(r){case"large":return"text-lg";case"2xlarge":return"text-2xl";default:return"text-xl"}}function lA(r){switch(r){case"left":return"flex-row-reverse items-start";case"right":return"flex-row items-start";case"top":return"flex-col-reverse";case"bottom":return"flex-col";default:return"flex-row-reverse items-start"}}function uA(r,e){const t=[];return r&&t.push("border"),e&&t.push("rounded-lg"),t.join(" ")}const Av=_e({__name:"Input",props:{defaultValue:{},modelValue:{},class:{}},emits:["update:modelValue"],setup(r,{emit:e}){const t=r,i=hs(t,"modelValue",e,{passive:!0,defaultValue:t.defaultValue});return(s,o)=>j4((he(),ke("input",{"onUpdate:modelValue":o[0]||(o[0]=a=>Cr(i)?i.value=a:null),"data-slot":"input",class:mt(q(Bt)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t.class))},null,2)),[[hN,q(i)]])}}),iB={class:"flex items-center gap-3"},sB={class:"relative w-64"},oB={class:"text-sm text-gray-600"},aB=_e({__name:"SearchBar",props:{section:{},sectionIndex:{},filteredCount:{},totalCount:{}},setup(r){const e=r,t=Te({get:()=>e.section.searchText||"",set:n=>_k(e.sectionIndex,n)});return(n,i)=>(he(),ke("div",iB,[we("div",sB,[ge(q($k),{class:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),ge(q(Av),{modelValue:t.value,"onUpdate:modelValue":i[0]||(i[0]=s=>t.value=s),placeholder:`Search in ${e.section.title||"section"}...`,class:"pl-9 pr-9 h-9"},null,8,["modelValue","placeholder"]),t.value?(he(),ke("button",{key:0,onClick:i[1]||(i[1]=s=>t.value=""),class:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600"},[ge(q(oR),{class:"w-4 h-4"})])):zt("",!0)]),we("div",oB,[we("strong",null,ot(r.filteredCount),1),r.filteredCount!==r.totalCount?(he(),ke(Tt,{key:0},[ze(" / "+ot(r.totalCount),1)],64)):zt("",!0),ze(" row"+ot(r.filteredCount>1?"s":""),1)])]))}}),Td=_e({__name:"Switch",props:{defaultValue:{type:Boolean},modelValue:{type:[Boolean,null]},disabled:{type:Boolean},id:{},value:{},asChild:{type:Boolean},as:{},name:{},required:{type:Boolean},class:{}},emits:["update:modelValue"],setup(r,{emit:e}){const t=r,n=e,i=Dr(t,"class"),s=On(i,n);return(o,a)=>(he(),Ee(q(PL),et({"data-slot":"switch"},q(s),{class:q(Bt)("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t.class)}),{default:de(l=>[ge(q(LL),{"data-slot":"switch-thumb",class:mt(q(Bt)("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0"))},{default:de(()=>[Re(o.$slots,"thumb",en(un(l)))]),_:2},1032,["class"])]),_:3},16,["class"]))}}),qr=_e({__name:"Label",props:{for:{},asChild:{type:Boolean},as:{},class:{}},setup(r){const e=r,t=Dr(e,"class");return(n,i)=>(he(),Ee(q(DF),et({"data-slot":"label"},q(t),{class:q(Bt)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e.class)}),{default:de(()=>[Re(n.$slots,"default")]),_:3},16,["class"]))}}),lB={class:"flex items-center justify-between gap-4 mb-3"},uB={key:0,class:"flex items-center gap-3"},cB={class:"flex items-center gap-3"},hB={key:0,class:"flex items-center gap-2 pl-3 border-l"},dB=_e({__name:"SectionHeader",props:{section:{},sectionIndex:{},filteredCount:{},totalCount:{}},setup(r){const e=r,t=Te(()=>Nr.fromConfig(e.section)),n=Te(()=>Rv(t.value.style.colorTheme)),i=Te(()=>t.value.getVisibleCharts().length>0),s=Te(()=>!!e.section.searchText||!!e.section.sortConfig),o=Te(()=>i.value&&s.value),a=Te({get:()=>e.section.applyFiltersToCharts??!0,set:l=>Rk(e.sectionIndex,l)});return(l,u)=>(he(),ke("div",lB,[r.section.title?(he(),ke("div",uB,[we("div",{class:mt(["h-1 w-8 rounded",n.value.accent])},null,2),we("h3",{class:mt(["font-semibold text-gray-900",q(aA)(t.value.style.titleSize)])},ot(r.section.title),3)])):zt("",!0),we("div",cB,[ge(aB,{section:r.section,"section-index":r.sectionIndex,"filtered-count":r.filteredCount,"total-count":r.totalCount},null,8,["section","section-index","filtered-count","total-count"]),o.value?(he(),ke("div",hB,[ge(q(Td),{id:`filter-toggle-${r.sectionIndex}`,modelValue:a.value,"onUpdate:modelValue":u[0]||(u[0]=c=>a.value=c),size:"sm"},null,8,["id","modelValue"]),ge(q(qr),{for:`filter-toggle-${r.sectionIndex}`,class:"text-sm text-gray-600 cursor-pointer"},{default:de(()=>[...u[1]||(u[1]=[ze(" Link charts ",-1)])]),_:1},8,["for"])])):zt("",!0)])]))}}),fB={"data-slot":"table-container",class:"relative w-full overflow-auto"},cA=_e({__name:"Table",props:{class:{}},setup(r){const e=r;return(t,n)=>(he(),ke("div",fB,[we("table",{"data-slot":"table",class:mt(q(Bt)("w-full caption-bottom text-sm",e.class))},[Re(t.$slots,"default")],2)]))}}),hA=_e({__name:"TableBody",props:{class:{}},setup(r){const e=r;return(t,n)=>(he(),ke("tbody",{"data-slot":"table-body",class:mt(q(Bt)("[&_tr:last-child]:border-0",e.class))},[Re(t.$slots,"default")],2))}}),kf=_e({__name:"TableCell",props:{class:{}},setup(r){const e=r;return(t,n)=>(he(),ke("td",{"data-slot":"table-cell",class:mt(q(Bt)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e.class))},[Re(t.$slots,"default")],2))}}),Pf=_e({__name:"TableRow",props:{class:{}},setup(r){const e=r;return(t,n)=>(he(),ke("tr",{"data-slot":"table-row",class:mt(q(Bt)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e.class))},[Re(t.$slots,"default")],2))}}),Ff=_e({__name:"TableHead",props:{class:{}},setup(r){const e=r;return(t,n)=>(he(),ke("th",{"data-slot":"table-head",class:mt(q(Bt)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e.class))},[Re(t.$slots,"default")],2))}}),dA=_e({__name:"TableHeader",props:{class:{}},setup(r){const e=r;return(t,n)=>(he(),ke("thead",{"data-slot":"table-header",class:mt(q(Bt)("[&_tr]:border-b",e.class))},[Re(t.$slots,"default")],2))}}),pB={class:"flex items-center gap-4 group"},mB=["onClick"],gB=["onClick"],yB=_e({__name:"DataTableHeader",props:{headers:{},numericColumns:{},selectedCell:{},hasDataRows:{type:Boolean},sortConfig:{},colorTheme:{}},emits:["headerClick","chartIconClick","sortClick"],setup(r,{emit:e}){const t=r,n=e;function i(a){return a==null?"":String(a)}function s(a,l){return!l||l.columnIndex!==a?null:l.direction==="asc"?Pk:kk}function o(a){ht.currentSheet.editionMode&&(ht.currentSheet.currentCell=a,console.log("double click on header",a))}return(a,l)=>(he(),Ee(q(Pf),null,{default:de(()=>[ge(q(Ff),{class:mt(["w-12 sticky left-0 z-10 border-r",[r.colorTheme?.text,r.colorTheme?.border]])},{default:de(()=>[...l[0]||(l[0]=[ze("#",-1)])]),_:1},8,["class"]),(he(!0),ke(Tt,null,Er(r.headers,(u,c)=>(he(),Ee(q(Ff),{key:c,class:mt(["min-w-[150px] cursor-pointer hover:bg-gray-100",r.selectedCell?.row===0&&r.selectedCell?.col===c&&!r.hasDataRows?"bg-blue-100":"",r.colorTheme?.text]),onDblclick:d=>o(u),onClick:d=>n("headerClick",c)},{default:de(()=>[we("div",pB,[we("div",{class:"flex items-center gap-1 flex-1",onClick:d=>t.hasDataRows&&!q(ht).currentSheet.editionMode?n("sortClick",c):null},[ze(ot(i(u)||`Col ${c+1}`)+" ",1),s(c,r.sortConfig)?(he(),Ee(dy(s(c,r.sortConfig)),{key:0,class:"w-4 h-4 text-blue-600"})):zt("",!0)],8,mB),r.selectedCell?.row===0&&r.selectedCell?.col===c&&!r.hasDataRows?(he(),Ee(q(lu),{key:0,class:"text-xs bg-sky-100"},{default:de(()=>[...l[1]||(l[1]=[ze("  ",-1)])]),_:1})):zt("",!0),r.numericColumns.includes(c)?(he(),ke("button",{key:1,onClick:as(d=>n("chartIconClick",c),["stop"]),class:"opacity-0 group-hover:opacity-100 transition-opacity p-1 rounded hover:bg-gray-100 cursor-pointer"},[ge(q(Pc),{class:"w-4 h-4"})],8,gB)):zt("",!0)])]),_:2},1032,["class","onDblclick","onClick"]))),128))]),_:1}))}}),vB={class:"flex items-center gap-2"},bB=["title"],wB={class:"flex items-center gap-2 relative"},_B=_e({__name:"DataTableRow",props:{row:{},rowIndex:{},selectedCell:{},isExcluded:{type:Boolean},hasVisibleCharts:{type:Boolean},alternatingRows:{type:Boolean}},emits:["cellClick","toggleExclusion"],setup(r,{emit:e}){const t=r,n=e;function i(o,a){return a?a.row===t.rowIndex&&a.col===o:!1}function s(o){ht.currentSheet.editionMode&&(ht.currentSheet.currentCell=o,console.log("double click on cell",o))}return(o,a)=>(he(),Ee(q(Pf),{class:mt(["group",r.alternatingRows&&r.rowIndex%2===1?"bg-gray-50":""])},{default:de(()=>[ge(q(kf),{class:"bg-gray-50 font-medium sticky left-0 z-10"},{default:de(()=>[we("div",vB,[ze(ot(r.rowIndex+1)+" ",1),r.hasVisibleCharts?(he(),ke("button",{key:0,onClick:a[0]||(a[0]=l=>n("toggleExclusion")),class:mt(["opacity-0 group-hover:opacity-100 transition-opacity p-1 rounded hover:bg-gray-100",r.isExcluded?"opacity-100":""]),title:r.isExcluded?"Include in charts":"Exclude from charts"},[r.isExcluded?(he(),Ee(q(tv),{key:0,class:"w-4 h-4 text-orange-500"})):(he(),Ee(q(Bk),{key:1,class:"w-4 h-4 text-gray-400"}))],10,bB)):zt("",!0)])]),_:1}),(he(!0),ke(Tt,null,Er(r.row,(l,u)=>(he(),Ee(q(kf),{key:u,class:mt(["cursor-pointer hover:bg-blue-50",i(u,r.selectedCell)?"bg-blue-100":"",r.isExcluded?"opacity-50":""]),onClick:c=>!q(ht).currentSheet.editionMode&&n("cellClick",u),onDblclick:c=>s(l)},{default:de(()=>[we("div",wB,[ze(ot(l)+" ",1),q(ht).currentSheet.currentCell?.formula?(he(),Ee(q(lu),{key:0,class:"absolute top-0 right-0 text-[0.6em] bg-gray-100 text-gray-600"},{default:de(()=>[ze(ot(l.address),1)]),_:2},1024)):zt("",!0),i(u,r.selectedCell)?(he(),Ee(q(lu),{key:1,class:"text-xs bg-sky-100"},{default:de(()=>[...a[1]||(a[1]=[ze("  ",-1)])]),_:1})):zt("",!0)])]),_:2},1032,["class","onClick","onDblclick"]))),128))]),_:1},8,["class"]))}}),xB={class:"overflow-auto max-h-[400px]"},EB=_e({__name:"SectionTable",props:{section:{},sectionIndex:{},filteredData:{}},emits:["cellClick","headerClick","chartIconClick","toggleRowExclusion","sortClick"],setup(r,{emit:e}){const t=r,n=e,i=Te(()=>Nr.fromConfig(t.section)),s=Te(()=>t.section.header.map((d,h)=>h).filter(d=>Ga.isNumericColumn(t.section,d))),o=Te(()=>i.value.getVisibleCharts().length>0),a=Te(()=>Rv(i.value.style.colorTheme)),l=Te(()=>{const d=i.value.style.tableStyle;return uA(d.showBorders,d.roundedBorders)});function u(d){return i.value.getVisibleCharts().some(f=>f.isRowExcluded(d))}function c(){return t.section.cardRecap?{row:t.section.cardRecap.rowIndex,col:t.section.cardRecap.colIndex}:null}return(d,h)=>(he(),ke("div",{class:mt(["overflow-hidden grow",l.value])},[we("div",xB,[ge(q(cA),null,{default:de(()=>[ge(q(dA),{class:mt([a.value.bg])},{default:de(()=>[ge(yB,{headers:r.section.header,"numeric-columns":s.value,"selected-cell":c(),"has-data-rows":r.section.data.length>0,"sort-config":r.section.sortConfig,"color-theme":a.value,onHeaderClick:h[0]||(h[0]=f=>n("headerClick",f)),onChartIconClick:h[1]||(h[1]=f=>n("chartIconClick",f)),onSortClick:h[2]||(h[2]=f=>n("sortClick",f))},null,8,["headers","numeric-columns","selected-cell","has-data-rows","sort-config","color-theme"])]),_:1},8,["class"]),ge(q(hA),null,{default:de(()=>[(he(!0),ke(Tt,null,Er(r.filteredData,(f,m)=>(he(),Ee(_B,{key:m,row:f,"row-index":m,"selected-cell":c(),"is-excluded":u(f),"has-visible-charts":o.value,"alternating-rows":i.value.style.tableStyle.alternatingRows,onCellClick:p=>n("cellClick",m,p),onToggleExclusion:p=>n("toggleRowExclusion",f)},null,8,["row","row-index","selected-cell","is-excluded","has-visible-charts","alternating-rows","onCellClick","onToggleExclusion"]))),128))]),_:1})]),_:1})])],2))}}),fA=_e({__name:"DropdownMenu",props:{defaultOpen:{type:Boolean},open:{type:Boolean},dir:{},modal:{type:Boolean}},emits:["update:open"],setup(r,{emit:e}){const i=On(r,e);return(s,o)=>(he(),Ee(q(yF),et({"data-slot":"dropdown-menu"},q(i)),{default:de(a=>[Re(s.$slots,"default",en(un(a)))]),_:3},16))}}),pA=_e({inheritAttrs:!1,__name:"DropdownMenuContent",props:{forceMount:{type:Boolean},loop:{type:Boolean},side:{},sideOffset:{default:4},sideFlip:{type:Boolean},align:{},alignOffset:{},alignFlip:{type:Boolean},avoidCollisions:{type:Boolean},collisionBoundary:{},collisionPadding:{},arrowPadding:{},hideShiftedArrow:{type:Boolean},sticky:{},hideWhenDetached:{type:Boolean},positionStrategy:{},updatePositionStrategy:{},disableUpdateOnLayoutShift:{type:Boolean},prioritizePosition:{type:Boolean},reference:{},asChild:{type:Boolean},as:{},class:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","closeAutoFocus"],setup(r,{emit:e}){const t=r,n=e,i=Dr(t,"class"),s=On(i,n);return(o,a)=>(he(),Ee(q(TF),null,{default:de(()=>[ge(q(bF),et({"data-slot":"dropdown-menu-content"},{...o.$attrs,...q(s)},{class:q(Bt)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--reka-dropdown-menu-content-available-height) min-w-[8rem] origin-(--reka-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",t.class)}),{default:de(()=>[Re(o.$slots,"default")]),_:3},16,["class"])]),_:3}))}}),ia=_e({__name:"DropdownMenuItem",props:{disabled:{type:Boolean},textValue:{},asChild:{type:Boolean},as:{},class:{},inset:{type:Boolean},variant:{default:"default"}},setup(r){const e=r,t=Dr(e,"inset","variant","class"),n=pi(t);return(i,s)=>(he(),Ee(q(_F),et({"data-slot":"dropdown-menu-item","data-inset":r.inset?"":void 0,"data-variant":r.variant},q(n),{class:q(Bt)("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e.class)}),{default:de(()=>[Re(i.$slots,"default")]),_:3},16,["data-inset","data-variant","class"]))}}),mA=_e({__name:"DropdownMenuLabel",props:{asChild:{type:Boolean},as:{},class:{},inset:{type:Boolean}},setup(r){const e=r,t=Dr(e,"class","inset"),n=pi(t);return(i,s)=>(he(),Ee(q(EF),et({"data-slot":"dropdown-menu-label","data-inset":r.inset?"":void 0},q(n),{class:q(Bt)("px-2 py-1.5 text-sm font-medium data-[inset]:pl-8",e.class)}),{default:de(()=>[Re(i.$slots,"default")]),_:3},16,["data-inset","class"]))}}),gA=_e({__name:"DropdownMenuSeparator",props:{asChild:{type:Boolean},as:{},class:{}},setup(r){const e=r,t=Dr(e,"class");return(n,i)=>(he(),Ee(q(AF),et({"data-slot":"dropdown-menu-separator"},q(t),{class:q(Bt)("bg-border -mx-1 my-1 h-px",e.class)}),null,16,["class"]))}}),yA=_e({__name:"DropdownMenuSub",props:{defaultOpen:{type:Boolean},open:{type:Boolean}},emits:["update:open"],setup(r,{emit:e}){const i=On(r,e);return(s,o)=>(he(),Ee(q(NF),et({"data-slot":"dropdown-menu-sub"},q(i)),{default:de(a=>[Re(s.$slots,"default",en(un(a)))]),_:3},16))}}),vA=_e({__name:"DropdownMenuSubContent",props:{forceMount:{type:Boolean},loop:{type:Boolean},sideOffset:{},sideFlip:{type:Boolean},alignOffset:{},alignFlip:{type:Boolean},avoidCollisions:{type:Boolean},collisionBoundary:{},collisionPadding:{},arrowPadding:{},hideShiftedArrow:{type:Boolean},sticky:{},hideWhenDetached:{type:Boolean},positionStrategy:{},updatePositionStrategy:{},disableUpdateOnLayoutShift:{type:Boolean},prioritizePosition:{type:Boolean},reference:{},asChild:{type:Boolean},as:{},class:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","entryFocus","openAutoFocus","closeAutoFocus"],setup(r,{emit:e}){const t=r,n=e,i=Dr(t,"class"),s=On(i,n);return(o,a)=>(he(),Ee(q(OF),et({"data-slot":"dropdown-menu-sub-content"},q(s),{class:q(Bt)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 min-w-[8rem] origin-(--reka-dropdown-menu-content-transform-origin) overflow-hidden rounded-md border p-1 shadow-lg",t.class)}),{default:de(()=>[Re(o.$slots,"default")]),_:3},16,["class"]))}}),bA=_e({__name:"DropdownMenuSubTrigger",props:{disabled:{type:Boolean},textValue:{},asChild:{type:Boolean},as:{},class:{},inset:{type:Boolean}},setup(r){const e=r,t=Dr(e,"class","inset"),n=pi(t);return(i,s)=>(he(),Ee(q(kF),et({"data-slot":"dropdown-menu-sub-trigger"},q(n),{class:q(Bt)("focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground flex cursor-default items-center rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[inset]:pl-8",e.class)}),{default:de(()=>[Re(i.$slots,"default"),ge(q(iR),{class:"ml-auto size-4"})]),_:3},16,["class"]))}}),wA=_e({__name:"DropdownMenuTrigger",props:{disabled:{type:Boolean},asChild:{type:Boolean},as:{}},setup(r){const t=pi(r);return(n,i)=>(he(),Ee(q(FF),et({"data-slot":"dropdown-menu-trigger"},q(t)),{default:de(()=>[Re(n.$slots,"default")]),_:3},16))}}),SB=_e({__name:"ChartStyle",props:{id:{}},setup(r){const{config:e}=Jq(),t=Te(()=>Object.entries(e.value).filter(([,n])=>n.theme||n.color));return(n,i)=>t.value.length?(he(),Ee(q(qt),{key:0,as:"style"},{default:de(()=>[ze(ot(Object.entries(q(Qq)).map(([s,o])=>`
${o} [data-chart=${r.id}] {
${t.value.map(([a,l])=>{const u=l.theme?.[s]||l.color;return u?`  --color-${a}: ${u};`:null}).join(`
`)}
}
`).join(`
`)),1)]),_:1})):zt("",!0)}}),TB=["data-chart"],Rd=_e({__name:"ChartContainer",props:{id:{},class:{},config:{},cursor:{type:Boolean}},setup(r){const e=r,{config:t}=Rn(e),n=Gi(),i=Te(()=>`chart-${e.id||n.replace(/:/g,"")}`);return eY({id:n,config:t}),(s,o)=>(he(),ke("div",{"data-slot":"chart","data-chart":i.value,class:mt(q(Bt)("[&_.tick_text]:!fill-muted-foreground [&_.tick_line]:!stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border flex flex-col justify-center text-xs [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-hidden [&_.recharts-sector]:outline-hidden [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-surface]:outline-hidden [&_[data-vis-xy-container]]:h-full [&_[data-vis-single-container]]:h-full h-full [&_[data-vis-xy-container]]:w-full [&_[data-vis-single-container]]:w-full w-full ",e.class)),style:qs({"--vis-tooltip-padding":"0px","--vis-tooltip-background-color":"transparent","--vis-tooltip-border-color":"transparent","--vis-tooltip-text-color":"none","--vis-tooltip-shadow-color":"none","--vis-tooltip-backdrop-filter":"none","--vis-crosshair-circle-stroke-color":"#0000","--vis-crosshair-line-stroke-width":r.cursor?"1px":"0px","--vis-font-family":"var(--font-sans)"})},[Re(s.$slots,"default",{id:q(n),config:q(t)}),ge(SB,{id:i.value},null,8,["id"])],14,TB))}}),RB={key:0,class:"font-medium"},AB={class:"grid gap-1.5"},CB={class:"grid gap-1.5"},NB={key:0,class:"font-medium"},MB={class:"text-muted-foreground"},OB={key:0,class:"text-foreground font-mono font-medium tabular-nums"},e_=_e({__name:"ChartTooltipContent",props:{hideLabel:{type:Boolean},hideIndicator:{type:Boolean},indicator:{default:"dot"},nameKey:{},labelKey:{},labelFormatter:{},payload:{default:()=>({})},config:{default:()=>({})},class:{},color:{},x:{}},setup(r){const e=r,t=Te(()=>Object.entries(e.payload).map(([s,o])=>{const a=e.config[s],l=e.config[s]?.color??e.payload.fill;return{key:s,value:o,itemConfig:a,indicatorColor:l}}).filter(s=>s.itemConfig)),n=Te(()=>Object.keys(e.payload).length===1&&e.indicator!=="dot"),i=Te(()=>e.hideLabel?null:e.labelFormatter&&e.x!==void 0?e.labelFormatter(e.x):e.labelKey?e.config[e.labelKey]?.label||e.payload[e.labelKey]:e.x);return(s,o)=>(he(),ke("div",{class:mt(q(Bt)("border-border/50 bg-background grid min-w-[8rem] items-start gap-1.5 rounded-lg border px-2.5 py-1.5 text-xs shadow-xl",e.class))},[Re(s.$slots,"default",{},()=>[!n.value&&i.value?(he(),ke("div",RB,ot(i.value),1)):zt("",!0),we("div",AB,[(he(!0),ke(Tt,null,Er(t.value,({value:a,itemConfig:l,indicatorColor:u,key:c})=>(he(),ke("div",{key:c,class:mt(q(Bt)("[&>svg]:text-muted-foreground flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5",r.indicator==="dot"&&"items-center"))},[l?.icon?(he(),Ee(dy(l.icon),{key:0})):r.hideIndicator?zt("",!0):(he(),ke("div",{key:1,class:mt(q(Bt)("shrink-0 rounded-[2px] border-(--color-border) bg-(--color-bg)",{"h-2.5 w-2.5":r.indicator==="dot","w-1":r.indicator==="line","w-0 border-[1.5px] border-dashed bg-transparent":r.indicator==="dashed","my-0.5":n.value&&r.indicator==="dashed"})),style:qs({"--color-bg":u,"--color-border":u})},null,6)),we("div",{class:mt(q(Bt)("flex flex-1 justify-between leading-none",n.value?"items-end":"items-center"))},[we("div",CB,[n.value?(he(),ke("div",NB,ot(i.value),1)):zt("",!0),we("span",MB,ot(l?.label||a),1)]),a?(he(),ke("span",OB,ot(a.toLocaleString()),1)):zt("",!0)],2)],2))),128))])])],2))}}),t_=new Map;function IB(r){return JSON.stringify(r,Object.keys(r).sort())}function r_(r,e,t){if(!Qs)return;const n=Gi();return(i,s)=>{const o="data"in i?i.data:i,a=`${n}-${IB(o)}`,l=t_.get(a);if(l)return l;const u=Fs(e,{...t,payload:o,config:r,x:s}),c=document.createElement("div");return gN(u,c),t_.set(a,c.innerHTML),c.innerHTML}}var w0="http://www.w3.org/1999/xhtml";const n_={svg:"http://www.w3.org/2000/svg",xhtml:w0,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Xp(r){var e=r+="",t=e.indexOf(":");return t>=0&&(e=r.slice(0,t))!=="xmlns"&&(r=r.slice(t+1)),n_.hasOwnProperty(e)?{space:n_[e],local:r}:r}function kB(r){return function(){var e=this.ownerDocument,t=this.namespaceURI;return t===w0&&e.documentElement.namespaceURI===w0?e.createElement(r):e.createElementNS(t,r)}}function PB(r){return function(){return this.ownerDocument.createElementNS(r.space,r.local)}}function _A(r){var e=Xp(r);return(e.local?PB:kB)(e)}function FB(){}function Cv(r){return r==null?FB:function(){return this.querySelector(r)}}function LB(r){typeof r!="function"&&(r=Cv(r));for(var e=this._groups,t=e.length,n=new Array(t),i=0;i<t;++i)for(var s=e[i],o=s.length,a=n[i]=new Array(o),l,u,c=0;c<o;++c)(l=s[c])&&(u=r.call(l,l.__data__,c,s))&&("__data__"in l&&(u.__data__=l.__data__),a[c]=u);return new Mi(n,this._parents)}function DB(r){return r==null?[]:Array.isArray(r)?r:Array.from(r)}function BB(){return[]}function xA(r){return r==null?BB:function(){return this.querySelectorAll(r)}}function UB(r){return function(){return DB(r.apply(this,arguments))}}function VB(r){typeof r=="function"?r=UB(r):r=xA(r);for(var e=this._groups,t=e.length,n=[],i=[],s=0;s<t;++s)for(var o=e[s],a=o.length,l,u=0;u<a;++u)(l=o[u])&&(n.push(r.call(l,l.__data__,u,o)),i.push(l));return new Mi(n,i)}function EA(r){return function(){return this.matches(r)}}function SA(r){return function(e){return e.matches(r)}}var jB=Array.prototype.find;function $B(r){return function(){return jB.call(this.children,r)}}function zB(){return this.firstElementChild}function HB(r){return this.select(r==null?zB:$B(typeof r=="function"?r:SA(r)))}var WB=Array.prototype.filter;function GB(){return Array.from(this.children)}function qB(r){return function(){return WB.call(this.children,r)}}function YB(r){return this.selectAll(r==null?GB:qB(typeof r=="function"?r:SA(r)))}function XB(r){typeof r!="function"&&(r=EA(r));for(var e=this._groups,t=e.length,n=new Array(t),i=0;i<t;++i)for(var s=e[i],o=s.length,a=n[i]=[],l,u=0;u<o;++u)(l=s[u])&&r.call(l,l.__data__,u,s)&&a.push(l);return new Mi(n,this._parents)}function TA(r){return new Array(r.length)}function KB(){return new Mi(this._enter||this._groups.map(TA),this._parents)}function Lf(r,e){this.ownerDocument=r.ownerDocument,this.namespaceURI=r.namespaceURI,this._next=null,this._parent=r,this.__data__=e}Lf.prototype={constructor:Lf,appendChild:function(r){return this._parent.insertBefore(r,this._next)},insertBefore:function(r,e){return this._parent.insertBefore(r,e)},querySelector:function(r){return this._parent.querySelector(r)},querySelectorAll:function(r){return this._parent.querySelectorAll(r)}};function ZB(r){return function(){return r}}function QB(r,e,t,n,i,s){for(var o=0,a,l=e.length,u=s.length;o<u;++o)(a=e[o])?(a.__data__=s[o],n[o]=a):t[o]=new Lf(r,s[o]);for(;o<l;++o)(a=e[o])&&(i[o]=a)}function JB(r,e,t,n,i,s,o){var a,l,u=new Map,c=e.length,d=s.length,h=new Array(c),f;for(a=0;a<c;++a)(l=e[a])&&(h[a]=f=o.call(l,l.__data__,a,e)+"",u.has(f)?i[a]=l:u.set(f,l));for(a=0;a<d;++a)f=o.call(r,s[a],a,s)+"",(l=u.get(f))?(n[a]=l,l.__data__=s[a],u.delete(f)):t[a]=new Lf(r,s[a]);for(a=0;a<c;++a)(l=e[a])&&u.get(h[a])===l&&(i[a]=l)}function eU(r){return r.__data__}function tU(r,e){if(!arguments.length)return Array.from(this,eU);var t=e?JB:QB,n=this._parents,i=this._groups;typeof r!="function"&&(r=ZB(r));for(var s=i.length,o=new Array(s),a=new Array(s),l=new Array(s),u=0;u<s;++u){var c=n[u],d=i[u],h=d.length,f=rU(r.call(c,c&&c.__data__,u,n)),m=f.length,p=a[u]=new Array(m),g=o[u]=new Array(m),v=l[u]=new Array(h);t(c,d,p,g,v,f,e);for(var y=0,b=0,E,A;y<m;++y)if(E=p[y]){for(y>=b&&(b=y+1);!(A=g[b])&&++b<m;);E._next=A||null}}return o=new Mi(o,n),o._enter=a,o._exit=l,o}function rU(r){return typeof r=="object"&&"length"in r?r:Array.from(r)}function nU(){return new Mi(this._exit||this._groups.map(TA),this._parents)}function iU(r,e,t){var n=this.enter(),i=this,s=this.exit();return typeof r=="function"?(n=r(n),n&&(n=n.selection())):n=n.append(r+""),e!=null&&(i=e(i),i&&(i=i.selection())),t==null?s.remove():t(s),n&&i?n.merge(i).order():i}function sU(r){for(var e=r.selection?r.selection():r,t=this._groups,n=e._groups,i=t.length,s=n.length,o=Math.min(i,s),a=new Array(i),l=0;l<o;++l)for(var u=t[l],c=n[l],d=u.length,h=a[l]=new Array(d),f,m=0;m<d;++m)(f=u[m]||c[m])&&(h[m]=f);for(;l<i;++l)a[l]=t[l];return new Mi(a,this._parents)}function oU(){for(var r=this._groups,e=-1,t=r.length;++e<t;)for(var n=r[e],i=n.length-1,s=n[i],o;--i>=0;)(o=n[i])&&(s&&o.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(o,s),s=o);return this}function aU(r){r||(r=lU);function e(d,h){return d&&h?r(d.__data__,h.__data__):!d-!h}for(var t=this._groups,n=t.length,i=new Array(n),s=0;s<n;++s){for(var o=t[s],a=o.length,l=i[s]=new Array(a),u,c=0;c<a;++c)(u=o[c])&&(l[c]=u);l.sort(e)}return new Mi(i,this._parents).order()}function lU(r,e){return r<e?-1:r>e?1:r>=e?0:NaN}function uU(){var r=arguments[0];return arguments[0]=this,r.apply(null,arguments),this}function cU(){return Array.from(this)}function hU(){for(var r=this._groups,e=0,t=r.length;e<t;++e)for(var n=r[e],i=0,s=n.length;i<s;++i){var o=n[i];if(o)return o}return null}function dU(){let r=0;for(const e of this)++r;return r}function fU(){return!this.node()}function pU(r){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var i=e[t],s=0,o=i.length,a;s<o;++s)(a=i[s])&&r.call(a,a.__data__,s,i);return this}function mU(r){return function(){this.removeAttribute(r)}}function gU(r){return function(){this.removeAttributeNS(r.space,r.local)}}function yU(r,e){return function(){this.setAttribute(r,e)}}function vU(r,e){return function(){this.setAttributeNS(r.space,r.local,e)}}function bU(r,e){return function(){var t=e.apply(this,arguments);t==null?this.removeAttribute(r):this.setAttribute(r,t)}}function wU(r,e){return function(){var t=e.apply(this,arguments);t==null?this.removeAttributeNS(r.space,r.local):this.setAttributeNS(r.space,r.local,t)}}function _U(r,e){var t=Xp(r);if(arguments.length<2){var n=this.node();return t.local?n.getAttributeNS(t.space,t.local):n.getAttribute(t)}return this.each((e==null?t.local?gU:mU:typeof e=="function"?t.local?wU:bU:t.local?vU:yU)(t,e))}function RA(r){return r.ownerDocument&&r.ownerDocument.defaultView||r.document&&r||r.defaultView}function xU(r){return function(){this.style.removeProperty(r)}}function EU(r,e,t){return function(){this.style.setProperty(r,e,t)}}function SU(r,e,t){return function(){var n=e.apply(this,arguments);n==null?this.style.removeProperty(r):this.style.setProperty(r,n,t)}}function TU(r,e,t){return arguments.length>1?this.each((e==null?xU:typeof e=="function"?SU:EU)(r,e,t??"")):uu(this.node(),r)}function uu(r,e){return r.style.getPropertyValue(e)||RA(r).getComputedStyle(r,null).getPropertyValue(e)}function RU(r){return function(){delete this[r]}}function AU(r,e){return function(){this[r]=e}}function CU(r,e){return function(){var t=e.apply(this,arguments);t==null?delete this[r]:this[r]=t}}function NU(r,e){return arguments.length>1?this.each((e==null?RU:typeof e=="function"?CU:AU)(r,e)):this.node()[r]}function AA(r){return r.trim().split(/^|\s+/)}function Nv(r){return r.classList||new CA(r)}function CA(r){this._node=r,this._names=AA(r.getAttribute("class")||"")}CA.prototype={add:function(r){var e=this._names.indexOf(r);e<0&&(this._names.push(r),this._node.setAttribute("class",this._names.join(" ")))},remove:function(r){var e=this._names.indexOf(r);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(r){return this._names.indexOf(r)>=0}};function NA(r,e){for(var t=Nv(r),n=-1,i=e.length;++n<i;)t.add(e[n])}function MA(r,e){for(var t=Nv(r),n=-1,i=e.length;++n<i;)t.remove(e[n])}function MU(r){return function(){NA(this,r)}}function OU(r){return function(){MA(this,r)}}function IU(r,e){return function(){(e.apply(this,arguments)?NA:MA)(this,r)}}function kU(r,e){var t=AA(r+"");if(arguments.length<2){for(var n=Nv(this.node()),i=-1,s=t.length;++i<s;)if(!n.contains(t[i]))return!1;return!0}return this.each((typeof e=="function"?IU:e?MU:OU)(t,e))}function PU(){this.textContent=""}function FU(r){return function(){this.textContent=r}}function LU(r){return function(){var e=r.apply(this,arguments);this.textContent=e??""}}function DU(r){return arguments.length?this.each(r==null?PU:(typeof r=="function"?LU:FU)(r)):this.node().textContent}function BU(){this.innerHTML=""}function UU(r){return function(){this.innerHTML=r}}function VU(r){return function(){var e=r.apply(this,arguments);this.innerHTML=e??""}}function jU(r){return arguments.length?this.each(r==null?BU:(typeof r=="function"?VU:UU)(r)):this.node().innerHTML}function $U(){this.nextSibling&&this.parentNode.appendChild(this)}function zU(){return this.each($U)}function HU(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function WU(){return this.each(HU)}function GU(r){var e=typeof r=="function"?r:_A(r);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function qU(){return null}function YU(r,e){var t=typeof r=="function"?r:_A(r),n=e==null?qU:typeof e=="function"?e:Cv(e);return this.select(function(){return this.insertBefore(t.apply(this,arguments),n.apply(this,arguments)||null)})}function XU(){var r=this.parentNode;r&&r.removeChild(this)}function KU(){return this.each(XU)}function ZU(){var r=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(r,this.nextSibling):r}function QU(){var r=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(r,this.nextSibling):r}function JU(r){return this.select(r?QU:ZU)}function eV(r){return arguments.length?this.property("__data__",r):this.node().__data__}function tV(r){return function(e){r.call(this,e,this.__data__)}}function rV(r){return r.trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}})}function nV(r){return function(){var e=this.__on;if(e){for(var t=0,n=-1,i=e.length,s;t<i;++t)s=e[t],(!r.type||s.type===r.type)&&s.name===r.name?this.removeEventListener(s.type,s.listener,s.options):e[++n]=s;++n?e.length=n:delete this.__on}}}function iV(r,e,t){return function(){var n=this.__on,i,s=tV(e);if(n){for(var o=0,a=n.length;o<a;++o)if((i=n[o]).type===r.type&&i.name===r.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=t),i.value=e;return}}this.addEventListener(r.type,s,t),i={type:r.type,name:r.name,value:e,listener:s,options:t},n?n.push(i):this.__on=[i]}}function sV(r,e,t){var n=rV(r+""),i,s=n.length,o;if(arguments.length<2){var a=this.node().__on;if(a){for(var l=0,u=a.length,c;l<u;++l)for(i=0,c=a[l];i<s;++i)if((o=n[i]).type===c.type&&o.name===c.name)return c.value}return}for(a=e?iV:nV,i=0;i<s;++i)this.each(a(n[i],e,t));return this}function OA(r,e,t){var n=RA(r),i=n.CustomEvent;typeof i=="function"?i=new i(e,t):(i=n.document.createEvent("Event"),t?(i.initEvent(e,t.bubbles,t.cancelable),i.detail=t.detail):i.initEvent(e,!1,!1)),r.dispatchEvent(i)}function oV(r,e){return function(){return OA(this,r,e)}}function aV(r,e){return function(){return OA(this,r,e.apply(this,arguments))}}function lV(r,e){return this.each((typeof e=="function"?aV:oV)(r,e))}function*uV(){for(var r=this._groups,e=0,t=r.length;e<t;++e)for(var n=r[e],i=0,s=n.length,o;i<s;++i)(o=n[i])&&(yield o)}var IA=[null];function Mi(r,e){this._groups=r,this._parents=e}function oh(){return new Mi([[document.documentElement]],IA)}function cV(){return this}Mi.prototype=oh.prototype={constructor:Mi,select:LB,selectAll:VB,selectChild:HB,selectChildren:YB,filter:XB,data:tU,enter:KB,exit:nU,join:iU,merge:sU,selection:cV,order:oU,sort:aU,call:uU,nodes:cU,node:hU,size:dU,empty:fU,each:pU,attr:_U,style:TU,property:NU,classed:kU,text:DU,html:jU,raise:zU,lower:WU,append:GU,insert:YU,remove:KU,clone:JU,datum:eV,on:sV,dispatch:lV,[Symbol.iterator]:uV};function ui(r){return typeof r=="string"?new Mi([[document.querySelector(r)]],[document.documentElement]):new Mi([[r]],IA)}function hV(r){let e;for(;e=r.sourceEvent;)r=e;return r}function Df(r,e){if(r=hV(r),e===void 0&&(e=r.currentTarget),e){var t=e.ownerSVGElement||e;if(t.createSVGPoint){var n=t.createSVGPoint();return n.x=r.clientX,n.y=r.clientY,n=n.matrixTransform(e.getScreenCTM().inverse()),[n.x,n.y]}if(e.getBoundingClientRect){var i=e.getBoundingClientRect();return[r.clientX-i.left-e.clientLeft,r.clientY-i.top-e.clientTop]}}return[r.pageX,r.pageY]}var fc;(function(r){r[r.SVG=0]="SVG",r[r.HTML=1]="HTML"})(fc||(fc={}));var _o;(function(r){r.Fit="fit",r.Extend="extend",r.FitWidth="fit_width"})(_o||(_o={}));function pc(r,e){return r==null||e==null?NaN:r<e?-1:r>e?1:r>=e?0:NaN}function dV(r,e){return r==null||e==null?NaN:e<r?-1:e>r?1:e>=r?0:NaN}function Mv(r){let e,t,n;r.length!==2?(e=pc,t=(a,l)=>pc(r(a),l),n=(a,l)=>r(a)-l):(e=r===pc||r===dV?r:fV,t=r,n=r);function i(a,l,u=0,c=a.length){if(u<c){if(e(l,l)!==0)return c;do{const d=u+c>>>1;t(a[d],l)<0?u=d+1:c=d}while(u<c)}return u}function s(a,l,u=0,c=a.length){if(u<c){if(e(l,l)!==0)return c;do{const d=u+c>>>1;t(a[d],l)<=0?u=d+1:c=d}while(u<c)}return u}function o(a,l,u=0,c=a.length){const d=i(a,l,u,c-1);return d>u&&n(a[d-1],l)>-n(a[d],l)?d-1:d}return{left:i,center:o,right:s}}function fV(){return 0}function kA(r){return r===null?NaN:+r}const PA=Mv(pc),ah=PA.right,pV=PA.left;Mv(kA).center;function mV(r,e){let t,n;for(const i of r)i!=null&&(t===void 0?i>=i&&(t=n=i):(t>i&&(t=i),n<i&&(n=i)));return[t,n]}class i_ extends Map{constructor(e,t=vV){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),e!=null)for(const[n,i]of e)this.set(n,i)}get(e){return super.get(s_(this,e))}has(e){return super.has(s_(this,e))}set(e,t){return super.set(gV(this,e),t)}delete(e){return super.delete(yV(this,e))}}function s_({_intern:r,_key:e},t){const n=e(t);return r.has(n)?r.get(n):t}function gV({_intern:r,_key:e},t){const n=e(t);return r.has(n)?r.get(n):(r.set(n,t),t)}function yV({_intern:r,_key:e},t){const n=e(t);return r.has(n)&&(t=r.get(n),r.delete(n)),t}function vV(r){return r!==null&&typeof r=="object"?r.valueOf():r}const bV=Math.sqrt(50),wV=Math.sqrt(10),_V=Math.sqrt(2);function Bf(r,e,t){const n=(e-r)/Math.max(0,t),i=Math.floor(Math.log10(n)),s=n/Math.pow(10,i),o=s>=bV?10:s>=wV?5:s>=_V?2:1;let a,l,u;return i<0?(u=Math.pow(10,-i)/o,a=Math.round(r*u),l=Math.round(e*u),a/u<r&&++a,l/u>e&&--l,u=-u):(u=Math.pow(10,i)*o,a=Math.round(r/u),l=Math.round(e/u),a*u<r&&++a,l*u>e&&--l),l<a&&.5<=t&&t<2?Bf(r,e,t*2):[a,l,u]}function _0(r,e,t){if(e=+e,r=+r,t=+t,!(t>0))return[];if(r===e)return[r];const n=e<r,[i,s,o]=n?Bf(e,r,t):Bf(r,e,t);if(!(s>=i))return[];const a=s-i+1,l=new Array(a);if(n)if(o<0)for(let u=0;u<a;++u)l[u]=(s-u)/-o;else for(let u=0;u<a;++u)l[u]=(s-u)*o;else if(o<0)for(let u=0;u<a;++u)l[u]=(i+u)/-o;else for(let u=0;u<a;++u)l[u]=(i+u)*o;return l}function x0(r,e,t){return e=+e,r=+r,t=+t,Bf(r,e,t)[2]}function E0(r,e,t){e=+e,r=+r,t=+t;const n=e<r,i=n?x0(e,r,t):x0(r,e,t);return(n?-1:1)*(i<0?1/-i:i)}function S0(r,e){let t;if(e===void 0)for(const n of r)n!=null&&(t<n||t===void 0&&n>=n)&&(t=n);else{let n=-1;for(let i of r)(i=e(i,++n,r))!=null&&(t<i||t===void 0&&i>=i)&&(t=i)}return t}function mc(r,e){let t;if(e===void 0)for(const n of r)n!=null&&(t>n||t===void 0&&n>=n)&&(t=n);else{let n=-1;for(let i of r)(i=e(i,++n,r))!=null&&(t>i||t===void 0&&i>=i)&&(t=i)}return t}function xV(r,e,t=kA){if(!(!(n=r.length)||isNaN(e=+e))){if(e<=0||n<2)return+t(r[0],0,r);if(e>=1)return+t(r[n-1],n-1,r);var n,i=(n-1)*e,s=Math.floor(i),o=+t(r[s],s,r),a=+t(r[s+1],s+1,r);return o+(a-o)*(i-s)}}function*EV(r){for(const e of r)yield*e}function SV(r){return Array.from(EV(r))}function FA(r,e,t){r=+r,e=+e,t=(i=arguments.length)<2?(e=r,r=0,1):i<3?1:+t;for(var n=-1,i=Math.max(0,Math.ceil((e-r)/t))|0,s=new Array(i);++n<i;)s[n]=r+n*t;return s}function TV(r,e){let t=0;if(e===void 0)for(let n of r)(n=+n)&&(t+=n);else{let n=-1;for(let i of r)(i=+e(i,++n,r))&&(t+=i)}return t}function RV(r,e,t){var n={},i=n.noTrailing,s=i===void 0?!1:i,o=n.noLeading,a=o===void 0?!1:o,l=n.debounceMode,u=l===void 0?void 0:l,c,d=!1,h=0;function f(){c&&clearTimeout(c)}function m(g){var v=g||{},y=v.upcomingOnly,b=y===void 0?!1:y;f(),d=!b}function p(){for(var g=arguments.length,v=new Array(g),y=0;y<g;y++)v[y]=arguments[y];var b=this,E=Date.now()-h;if(d)return;function A(){h=Date.now(),e.apply(b,v)}function M(){c=void 0}!a&&u&&!c&&A(),f(),u===void 0&&E>r?a?(h=Date.now(),s||(c=setTimeout(u?M:A,r))):A():s!==!0&&(c=setTimeout(u?M:A,u===void 0?r-E:r))}return p.cancel=m,p}var go;(function(r){r.Left="left",r.Right="right",r.Auto="auto"})(go||(go={}));const ji=r=>typeof r=="number",Ov=r=>typeof r=="function",xu=r=>Array.isArray(r),AV=r=>r instanceof Object,Uf=r=>r.constructor.name!=="Function"&&r.constructor.name!=="Object",o_=r=>AV(r)&&!xu(r)&&!Ov(r)&&!Uf(r),CV=r=>[Object,Array].includes((r||{}).constructor)&&!Object.entries(r||{}).length,rl=(r,e,t=[],n=new Set)=>{if(Array.isArray(r)){if(!Array.isArray(e)||r.length!==e.length)return!1;if(n.has(r))return!0;n.add(r);for(let i=0;i<r.length;i++)if(!rl(r[i],e[i],t,n))return!1;return!0}if(r instanceof Date&&e instanceof Date)return r.getTime()===e.getTime();if(typeof r=="object"&&r!==null&&e!==null){if(typeof e!="object")return!1;if(r===e)return!0;const i=Object.keys(r).filter(o=>!t.includes(o)),s=Object.keys(e).filter(o=>!t.includes(o));if(i.length!==s.length)return!1;if(n.has(r))return!0;n.add(r);for(const o of i)if(!rl(r[o],e[o],t,n))return!1;return!0}return r===e},T0=r=>r.flat(),Vf=(r,e=new Map)=>{if(typeof r!="object"||r===null)return r;if(r instanceof Date)return new Date(r.getTime());if(r instanceof Array){const t=[];e.set(r,t);for(const n of r)t.push(e.has(n)?e.get(n):Vf(n,e));return t}if(Uf(r))return r;if(r instanceof Object){const t={};e.set(r,t);const n=r;return Object.keys(r).reduce((i,s)=>(i[s]=e.has(n[s])?e.get(n[s]):Vf(n[s],e),i),t),t}return r},nl=(r,e,t=new Map)=>{if(!r||!e||r===e)return r;const n=Uf(r)?r:Vf(r);return t.has(e)?t.get(e):(t.set(e,n),Object.keys(e).forEach(i=>{i==="__proto__"||i==="constructor"||(o_(r[i])&&o_(e[i])?n[i]=nl(r[i],e[i],t):Uf(e)?n[i]=e:n[i]=Vf(e[i]))}),n)},jf=(r,e,t)=>RV(e,r);function Iv(r,e,t){return Ov(e)?e(r,t):e}function Uc(r,e,t){return Iv(r,e,t)}function zr(r,e,t){return Iv(r,e,t)}function Mu(r){return r.filter(e=>e&&!ji(e))}function ks(r,e,t){return Math.min(Math.max(r,e),t)}function NV(r,e,...t){const n=[];let i=0,s=0;for(const o of t){const a=zr(r,o,e)||0;a>=0?n.push(i+=a):n.push(s+=a)}return n}function LA(r,...e){return r?mc(r,(n,i)=>mc(e,s=>zr(n,s,i))):void 0}function DA(r,...e){return r?S0(r,(n,i)=>S0(e,s=>zr(n,s,i))):void 0}function Ad(r,...e){return[LA(r,...e),DA(r,...e)]}function $f(r,e,t,n=go.Auto){if(r.length<=1)return r[0];const s=r.map((l,u)=>[l,u]).sort(([l,u],[c,d])=>zr(l,t,u)-zr(c,t,d)),o=s.map(([l,u])=>zr(l,t,u)),a=n===go.Right?pV(o,e,0,r.length-1):ah(o,e,1,r.length);return n===go.Right?s[a][0]:n===go.Left?s[a-1][0]:e-o[a-1]>o[a]-e?s[a][0]:s[a-1][0]}function MV(r,e,t,n=!1){if(!t)return[];const i=r.filter((s,o)=>{const a=zr(s,t,o);return a>=e[0]&&a<=e[1]});if(n){if(i.length===0){const d=$f(r,e[0],t,go.Left),h=$f(r,e[1],t,go.Right);return[d,h].filter(Boolean)}const s=i[0],o=i[i.length-1],a=r.findIndex(d=>d===s),l=r.findIndex(d=>d===o),u=Math.max(0,a-1),c=Math.min(r.length-1,l+1);return r.slice(u,c+1)}return i}const OV=r=>r==null?[]:Array.isArray(r)?r:[r];var qa=[],IV=function(){return qa.some(function(r){return r.activeTargets.length>0})},kV=function(){return qa.some(function(r){return r.skippedTargets.length>0})},a_="ResizeObserver loop completed with undelivered notifications.",PV=function(){var r;typeof ErrorEvent=="function"?r=new ErrorEvent("error",{message:a_}):(r=document.createEvent("Event"),r.initEvent("error",!1,!1),r.message=a_),window.dispatchEvent(r)},Vc;(function(r){r.BORDER_BOX="border-box",r.CONTENT_BOX="content-box",r.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box"})(Vc||(Vc={}));var Ya=function(r){return Object.freeze(r)},FV=(function(){function r(e,t){this.inlineSize=e,this.blockSize=t,Ya(this)}return r})(),BA=(function(){function r(e,t,n,i){return this.x=e,this.y=t,this.width=n,this.height=i,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,Ya(this)}return r.prototype.toJSON=function(){var e=this,t=e.x,n=e.y,i=e.top,s=e.right,o=e.bottom,a=e.left,l=e.width,u=e.height;return{x:t,y:n,top:i,right:s,bottom:o,left:a,width:l,height:u}},r.fromRect=function(e){return new r(e.x,e.y,e.width,e.height)},r})(),kv=function(r){return r instanceof SVGElement&&"getBBox"in r},UA=function(r){if(kv(r)){var e=r.getBBox(),t=e.width,n=e.height;return!t&&!n}var i=r,s=i.offsetWidth,o=i.offsetHeight;return!(s||o||r.getClientRects().length)},l_=function(r){var e;if(r instanceof Element)return!0;var t=(e=r?.ownerDocument)===null||e===void 0?void 0:e.defaultView;return!!(t&&r instanceof t.Element)},LV=function(r){switch(r.tagName){case"INPUT":if(r.type!=="image")break;case"VIDEO":case"AUDIO":case"EMBED":case"OBJECT":case"CANVAS":case"IFRAME":case"IMG":return!0}return!1},gc=typeof window<"u"?window:{},Kh=new WeakMap,u_=/auto|scroll/,DV=/^tb|vertical/,BV=/msie|trident/i.test(gc.navigator&&gc.navigator.userAgent),_s=function(r){return parseFloat(r||"0")},Jl=function(r,e,t){return r===void 0&&(r=0),e===void 0&&(e=0),t===void 0&&(t=!1),new FV((t?e:r)||0,(t?r:e)||0)},c_=Ya({devicePixelContentBoxSize:Jl(),borderBoxSize:Jl(),contentBoxSize:Jl(),contentRect:new BA(0,0,0,0)}),VA=function(r,e){if(e===void 0&&(e=!1),Kh.has(r)&&!e)return Kh.get(r);if(UA(r))return Kh.set(r,c_),c_;var t=getComputedStyle(r),n=kv(r)&&r.ownerSVGElement&&r.getBBox(),i=!BV&&t.boxSizing==="border-box",s=DV.test(t.writingMode||""),o=!n&&u_.test(t.overflowY||""),a=!n&&u_.test(t.overflowX||""),l=n?0:_s(t.paddingTop),u=n?0:_s(t.paddingRight),c=n?0:_s(t.paddingBottom),d=n?0:_s(t.paddingLeft),h=n?0:_s(t.borderTopWidth),f=n?0:_s(t.borderRightWidth),m=n?0:_s(t.borderBottomWidth),p=n?0:_s(t.borderLeftWidth),g=d+u,v=l+c,y=p+f,b=h+m,E=a?r.offsetHeight-b-r.clientHeight:0,A=o?r.offsetWidth-y-r.clientWidth:0,M=i?g+y:0,L=i?v+b:0,k=n?n.width:_s(t.width)-M-A,P=n?n.height:_s(t.height)-L-E,U=k+g+A+y,$=P+v+E+b,V=Ya({devicePixelContentBoxSize:Jl(Math.round(k*devicePixelRatio),Math.round(P*devicePixelRatio),s),borderBoxSize:Jl(U,$,s),contentBoxSize:Jl(k,P,s),contentRect:new BA(d,l,k,P)});return Kh.set(r,V),V},jA=function(r,e,t){var n=VA(r,t),i=n.borderBoxSize,s=n.contentBoxSize,o=n.devicePixelContentBoxSize;switch(e){case Vc.DEVICE_PIXEL_CONTENT_BOX:return o;case Vc.BORDER_BOX:return i;default:return s}},UV=(function(){function r(e){var t=VA(e);this.target=e,this.contentRect=t.contentRect,this.borderBoxSize=Ya([t.borderBoxSize]),this.contentBoxSize=Ya([t.contentBoxSize]),this.devicePixelContentBoxSize=Ya([t.devicePixelContentBoxSize])}return r})(),$A=function(r){if(UA(r))return 1/0;for(var e=0,t=r.parentNode;t;)e+=1,t=t.parentNode;return e},VV=function(){var r=1/0,e=[];qa.forEach(function(o){if(o.activeTargets.length!==0){var a=[];o.activeTargets.forEach(function(u){var c=new UV(u.target),d=$A(u.target);a.push(c),u.lastReportedSize=jA(u.target,u.observedBox),d<r&&(r=d)}),e.push(function(){o.callback.call(o.observer,a,o.observer)}),o.activeTargets.splice(0,o.activeTargets.length)}});for(var t=0,n=e;t<n.length;t++){var i=n[t];i()}return r},h_=function(r){qa.forEach(function(t){t.activeTargets.splice(0,t.activeTargets.length),t.skippedTargets.splice(0,t.skippedTargets.length),t.observationTargets.forEach(function(i){i.isActive()&&($A(i.target)>r?t.activeTargets.push(i):t.skippedTargets.push(i))})})},jV=function(){var r=0;for(h_(r);IV();)r=VV(),h_(r);return kV()&&PV(),r>0},Zm,zA=[],$V=function(){return zA.splice(0).forEach(function(r){return r()})},zV=function(r){if(!Zm){var e=0,t=document.createTextNode(""),n={characterData:!0};new MutationObserver(function(){return $V()}).observe(t,n),Zm=function(){t.textContent="".concat(e?e--:e++)}}zA.push(r),Zm()},HV=function(r){zV(function(){requestAnimationFrame(r)})},Cd=0,WV=function(){return!!Cd},GV=250,qV={attributes:!0,characterData:!0,childList:!0,subtree:!0},d_=["resize","load","transitionend","animationend","animationstart","animationiteration","keyup","keydown","mouseup","mousedown","mouseover","mouseout","blur","focus"],f_=function(r){return r===void 0&&(r=0),Date.now()+r},Qm=!1,YV=(function(){function r(){var e=this;this.stopped=!0,this.listener=function(){return e.schedule()}}return r.prototype.run=function(e){var t=this;if(e===void 0&&(e=GV),!Qm){Qm=!0;var n=f_(e);HV(function(){var i=!1;try{i=jV()}finally{if(Qm=!1,e=n-f_(),!WV())return;i?t.run(1e3):e>0?t.run(e):t.start()}})}},r.prototype.schedule=function(){this.stop(),this.run()},r.prototype.observe=function(){var e=this,t=function(){return e.observer&&e.observer.observe(document.body,qV)};document.body?t():gc.addEventListener("DOMContentLoaded",t)},r.prototype.start=function(){var e=this;this.stopped&&(this.stopped=!1,this.observer=new MutationObserver(this.listener),this.observe(),d_.forEach(function(t){return gc.addEventListener(t,e.listener,!0)}))},r.prototype.stop=function(){var e=this;this.stopped||(this.observer&&this.observer.disconnect(),d_.forEach(function(t){return gc.removeEventListener(t,e.listener,!0)}),this.stopped=!0)},r})(),R0=new YV,p_=function(r){!Cd&&r>0&&R0.start(),Cd+=r,!Cd&&R0.stop()},XV=function(r){return!kv(r)&&!LV(r)&&getComputedStyle(r).display==="inline"},KV=(function(){function r(e,t){this.target=e,this.observedBox=t||Vc.CONTENT_BOX,this.lastReportedSize={inlineSize:0,blockSize:0}}return r.prototype.isActive=function(){var e=jA(this.target,this.observedBox,!0);return XV(this.target)&&(this.lastReportedSize=e),this.lastReportedSize.inlineSize!==e.inlineSize||this.lastReportedSize.blockSize!==e.blockSize},r})(),ZV=(function(){function r(e,t){this.activeTargets=[],this.skippedTargets=[],this.observationTargets=[],this.observer=e,this.callback=t}return r})(),Zh=new WeakMap,m_=function(r,e){for(var t=0;t<r.length;t+=1)if(r[t].target===e)return t;return-1},Qh=(function(){function r(){}return r.connect=function(e,t){var n=new ZV(e,t);Zh.set(e,n)},r.observe=function(e,t,n){var i=Zh.get(e),s=i.observationTargets.length===0;m_(i.observationTargets,t)<0&&(s&&qa.push(i),i.observationTargets.push(new KV(t,n&&n.box)),p_(1),R0.schedule())},r.unobserve=function(e,t){var n=Zh.get(e),i=m_(n.observationTargets,t),s=n.observationTargets.length===1;i>=0&&(s&&qa.splice(qa.indexOf(n),1),n.observationTargets.splice(i,1),p_(-1))},r.disconnect=function(e){var t=this,n=Zh.get(e);n.observationTargets.slice().forEach(function(i){return t.unobserve(e,i.target)}),n.activeTargets.splice(0,n.activeTargets.length)},r})(),QV=(function(){function r(e){if(arguments.length===0)throw new TypeError("Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.");if(typeof e!="function")throw new TypeError("Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.");Qh.connect(this,e)}return r.prototype.observe=function(e,t){if(arguments.length===0)throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!l_(e))throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element");Qh.observe(this,e,t)},r.prototype.unobserve=function(e){if(arguments.length===0)throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!l_(e))throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element");Qh.unobserve(this,e)},r.prototype.disconnect=function(){Qh.disconnect(this)},r.toString=function(){return"function ResizeObserver () { [polyfill code] }"},r})();const JV=globalThis.ResizeObserver||QV,Pv={duration:void 0,margin:{top:0,bottom:0,left:0,right:0},padding:{top:0,bottom:0,left:0,right:0},sizing:_o.Fit,width:void 0,height:void 0,svgDefs:void 0,ariaLabel:void 0};class cu{constructor(e){this._defaultConfig=Pv,this._isFirstRender=!0,this._renderAnimationFrameId=null,this._container=e;const t=ui(this._container);t.attr("role","figure"),this.svg=t.append("svg").style("display","block").attr("xmlns","http://www.w3.org/2000/svg").attr("height",cu.DEFAULT_CONTAINER_HEIGHT).attr("aria-hidden",!0),this._svgDefs=this.svg.append("defs"),this._svgDefsExternal=this.svg.append("defs"),this.element=this.svg.node()}updateContainer(e){var t;this.prevConfig=this.config,this.config=nl(this._defaultConfig,e),e?.svgDefs!==((t=this.prevConfig)===null||t===void 0?void 0:t.svgDefs)&&(this._svgDefsExternal.selectAll("*").remove(),this._svgDefsExternal.html(e.svgDefs))}_preRender(){}_render(e){const{config:t}=this;ui(this._container).attr("aria-label",t.ariaLabel),this._isFirstRender=!1}render(e=this.config.duration){const t=this.config.width||this.containerWidth,n=this.config.height||this.containerHeight;this.svg.attr("width",t).attr("height",n),this._resizeObserver||this._setUpResizeObserver(),cancelAnimationFrame(this._renderAnimationFrameId),this._renderAnimationFrameId=requestAnimationFrame(()=>{this._preRender(),this._render(e)})}get containerWidth(){return this.config.width?this.element.clientWidth:this._container.clientWidth||this._container.getBoundingClientRect().width}get containerHeight(){return this.config.height?this.element.clientHeight:this._container.clientHeight||this._container.getBoundingClientRect().height||cu.DEFAULT_CONTAINER_HEIGHT}get width(){return ks(this.containerWidth-this.config.margin.left-this.config.margin.right,0,Number.POSITIVE_INFINITY)}get height(){return ks(this.containerHeight-this.config.margin.top-this.config.margin.bottom,0,Number.POSITIVE_INFINITY)}_removeAllChildren(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild)}_onResize(){const{config:e}=this;(e.sizing===_o.Fit||e.sizing===_o.FitWidth)&&this.render(0)}_setUpResizeObserver(){if(this._resizeObserver)return;const e=this._container.getBoundingClientRect();this._containerSize={width:e.width,height:e.height},this._resizeObserver=new JV((t,n)=>{cancelAnimationFrame(this._resizeObserverAnimationFrameId),this._resizeObserverAnimationFrameId=requestAnimationFrame(()=>{const i=this._container.getBoundingClientRect(),s={width:i.width,height:i.height};!rl(this._containerSize,s)&&s.width&&s.height&&(this._containerSize=s,this._onResize())})}),this._resizeObserver.observe(this._container)}destroy(){var e;cancelAnimationFrame(this._renderAnimationFrameId),cancelAnimationFrame(this._resizeObserverAnimationFrameId),(e=this._resizeObserver)===null||e===void 0||e.disconnect(),this.svg.remove()}}cu.DEFAULT_CONTAINER_HEIGHT=300;function ej(r){if(r.sheet)return r.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===r)return document.styleSheets[e]}function tj(r){var e=document.createElement("style");return e.setAttribute("data-emotion",r.key),r.nonce!==void 0&&e.setAttribute("nonce",r.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var rj=(function(){function r(t){var n=this;this._insertTag=function(i){var s;n.tags.length===0?n.insertionPoint?s=n.insertionPoint.nextSibling:n.prepend?s=n.container.firstChild:s=n.before:s=n.tags[n.tags.length-1].nextSibling,n.container.insertBefore(i,s),n.tags.push(i)},this.isSpeedy=t.speedy===void 0?!0:t.speedy,this.tags=[],this.ctr=0,this.nonce=t.nonce,this.key=t.key,this.container=t.container,this.prepend=t.prepend,this.insertionPoint=t.insertionPoint,this.before=null}var e=r.prototype;return e.hydrate=function(n){n.forEach(this._insertTag)},e.insert=function(n){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(tj(this));var i=this.tags[this.tags.length-1];if(this.isSpeedy){var s=ej(i);try{s.insertRule(n,s.cssRules.length)}catch{}}else i.appendChild(document.createTextNode(n));this.ctr++},e.flush=function(){this.tags.forEach(function(n){var i;return(i=n.parentNode)==null?void 0:i.removeChild(n)}),this.tags=[],this.ctr=0},r})(),kn="-ms-",zf="-moz-",or="-webkit-",HA="comm",Fv="rule",Lv="decl",nj="@import",WA="@keyframes",ij="@layer",sj=Math.abs,Kp=String.fromCharCode,oj=Object.assign;function aj(r,e){return _n(r,0)^45?(((e<<2^_n(r,0))<<2^_n(r,1))<<2^_n(r,2))<<2^_n(r,3):0}function GA(r){return r.trim()}function lj(r,e){return(r=e.exec(r))?r[0]:r}function ar(r,e,t){return r.replace(e,t)}function A0(r,e){return r.indexOf(e)}function _n(r,e){return r.charCodeAt(e)|0}function jc(r,e,t){return r.slice(e,t)}function Ns(r){return r.length}function Dv(r){return r.length}function Jh(r,e){return e.push(r),r}function uj(r,e){return r.map(e).join("")}var Zp=1,hu=1,qA=0,fi=0,Jr=0,Eu="";function Qp(r,e,t,n,i,s,o){return{value:r,root:e,parent:t,type:n,props:i,children:s,line:Zp,column:hu,length:o,return:""}}function Ou(r,e){return oj(Qp("",null,null,"",null,null,0),r,{length:-r.length},e)}function cj(){return Jr}function hj(){return Jr=fi>0?_n(Eu,--fi):0,hu--,Jr===10&&(hu=1,Zp--),Jr}function Ri(){return Jr=fi<qA?_n(Eu,fi++):0,hu++,Jr===10&&(hu=1,Zp++),Jr}function Bs(){return _n(Eu,fi)}function Nd(){return fi}function lh(r,e){return jc(Eu,r,e)}function $c(r){switch(r){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function YA(r){return Zp=hu=1,qA=Ns(Eu=r),fi=0,[]}function XA(r){return Eu="",r}function Md(r){return GA(lh(fi-1,C0(r===91?r+2:r===40?r+1:r)))}function dj(r){for(;(Jr=Bs())&&Jr<33;)Ri();return $c(r)>2||$c(Jr)>3?"":" "}function fj(r,e){for(;--e&&Ri()&&!(Jr<48||Jr>102||Jr>57&&Jr<65||Jr>70&&Jr<97););return lh(r,Nd()+(e<6&&Bs()==32&&Ri()==32))}function C0(r){for(;Ri();)switch(Jr){case r:return fi;case 34:case 39:r!==34&&r!==39&&C0(Jr);break;case 40:r===41&&C0(r);break;case 92:Ri();break}return fi}function pj(r,e){for(;Ri()&&r+Jr!==57;)if(r+Jr===84&&Bs()===47)break;return"/*"+lh(e,fi-1)+"*"+Kp(r===47?r:Ri())}function mj(r){for(;!$c(Bs());)Ri();return lh(r,fi)}function gj(r){return XA(Od("",null,null,null,[""],r=YA(r),0,[0],r))}function Od(r,e,t,n,i,s,o,a,l){for(var u=0,c=0,d=o,h=0,f=0,m=0,p=1,g=1,v=1,y=0,b="",E=i,A=s,M=n,L=b;g;)switch(m=y,y=Ri()){case 40:if(m!=108&&_n(L,d-1)==58){A0(L+=ar(Md(y),"&","&\f"),"&\f")!=-1&&(v=-1);break}case 34:case 39:case 91:L+=Md(y);break;case 9:case 10:case 13:case 32:L+=dj(m);break;case 92:L+=fj(Nd()-1,7);continue;case 47:switch(Bs()){case 42:case 47:Jh(yj(pj(Ri(),Nd()),e,t),l);break;default:L+="/"}break;case 123*p:a[u++]=Ns(L)*v;case 125*p:case 59:case 0:switch(y){case 0:case 125:g=0;case 59+c:v==-1&&(L=ar(L,/\f/g,"")),f>0&&Ns(L)-d&&Jh(f>32?y_(L+";",n,t,d-1):y_(ar(L," ","")+";",n,t,d-2),l);break;case 59:L+=";";default:if(Jh(M=g_(L,e,t,u,c,i,a,b,E=[],A=[],d),s),y===123)if(c===0)Od(L,e,M,M,E,s,d,a,A);else switch(h===99&&_n(L,3)===110?100:h){case 100:case 108:case 109:case 115:Od(r,M,M,n&&Jh(g_(r,M,M,0,0,i,a,b,i,E=[],d),A),i,A,d,a,n?E:A);break;default:Od(L,M,M,M,[""],A,0,a,A)}}u=c=f=0,p=v=1,b=L="",d=o;break;case 58:d=1+Ns(L),f=m;default:if(p<1){if(y==123)--p;else if(y==125&&p++==0&&hj()==125)continue}switch(L+=Kp(y),y*p){case 38:v=c>0?1:(L+="\f",-1);break;case 44:a[u++]=(Ns(L)-1)*v,v=1;break;case 64:Bs()===45&&(L+=Md(Ri())),h=Bs(),c=d=Ns(b=L+=mj(Nd())),y++;break;case 45:m===45&&Ns(L)==2&&(p=0)}}return s}function g_(r,e,t,n,i,s,o,a,l,u,c){for(var d=i-1,h=i===0?s:[""],f=Dv(h),m=0,p=0,g=0;m<n;++m)for(var v=0,y=jc(r,d+1,d=sj(p=o[m])),b=r;v<f;++v)(b=GA(p>0?h[v]+" "+y:ar(y,/&\f/g,h[v])))&&(l[g++]=b);return Qp(r,e,t,i===0?Fv:a,l,u,c)}function yj(r,e,t){return Qp(r,e,t,HA,Kp(cj()),jc(r,2,-2),0)}function y_(r,e,t,n){return Qp(r,e,t,Lv,jc(r,0,n),jc(r,n+1,-1),n)}function eu(r,e){for(var t="",n=Dv(r),i=0;i<n;i++)t+=e(r[i],i,r,e)||"";return t}function vj(r,e,t,n){switch(r.type){case ij:if(r.children.length)break;case nj:case Lv:return r.return=r.return||r.value;case HA:return"";case WA:return r.return=r.value+"{"+eu(r.children,n)+"}";case Fv:r.value=r.props.join(",")}return Ns(t=eu(r.children,n))?r.return=r.value+"{"+t+"}":""}function bj(r){var e=Dv(r);return function(t,n,i,s){for(var o="",a=0;a<e;a++)o+=r[a](t,n,i,s)||"";return o}}function wj(r){return function(e){e.root||(e=e.return)&&r(e)}}function _j(r){var e=Object.create(null);return function(t){return e[t]===void 0&&(e[t]=r(t)),e[t]}}var xj=function(e,t,n){for(var i=0,s=0;i=s,s=Bs(),i===38&&s===12&&(t[n]=1),!$c(s);)Ri();return lh(e,fi)},Ej=function(e,t){var n=-1,i=44;do switch($c(i)){case 0:i===38&&Bs()===12&&(t[n]=1),e[n]+=xj(fi-1,t,n);break;case 2:e[n]+=Md(i);break;case 4:if(i===44){e[++n]=Bs()===58?"&\f":"",t[n]=e[n].length;break}default:e[n]+=Kp(i)}while(i=Ri());return e},Sj=function(e,t){return XA(Ej(YA(e),t))},v_=new WeakMap,Tj=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var t=e.value,n=e.parent,i=e.column===n.column&&e.line===n.line;n.type!=="rule";)if(n=n.parent,!n)return;if(!(e.props.length===1&&t.charCodeAt(0)!==58&&!v_.get(n))&&!i){v_.set(e,!0);for(var s=[],o=Sj(t,s),a=n.props,l=0,u=0;l<o.length;l++)for(var c=0;c<a.length;c++,u++)e.props[u]=s[l]?o[l].replace(/&\f/g,a[c]):a[c]+" "+o[l]}}},Rj=function(e){if(e.type==="decl"){var t=e.value;t.charCodeAt(0)===108&&t.charCodeAt(2)===98&&(e.return="",e.value="")}};function KA(r,e){switch(aj(r,e)){case 5103:return or+"print-"+r+r;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return or+r+r;case 5349:case 4246:case 4810:case 6968:case 2756:return or+r+zf+r+kn+r+r;case 6828:case 4268:return or+r+kn+r+r;case 6165:return or+r+kn+"flex-"+r+r;case 5187:return or+r+ar(r,/(\w+).+(:[^]+)/,or+"box-$1$2"+kn+"flex-$1$2")+r;case 5443:return or+r+kn+"flex-item-"+ar(r,/flex-|-self/,"")+r;case 4675:return or+r+kn+"flex-line-pack"+ar(r,/align-content|flex-|-self/,"")+r;case 5548:return or+r+kn+ar(r,"shrink","negative")+r;case 5292:return or+r+kn+ar(r,"basis","preferred-size")+r;case 6060:return or+"box-"+ar(r,"-grow","")+or+r+kn+ar(r,"grow","positive")+r;case 4554:return or+ar(r,/([^-])(transform)/g,"$1"+or+"$2")+r;case 6187:return ar(ar(ar(r,/(zoom-|grab)/,or+"$1"),/(image-set)/,or+"$1"),r,"")+r;case 5495:case 3959:return ar(r,/(image-set\([^]*)/,or+"$1$`$1");case 4968:return ar(ar(r,/(.+:)(flex-)?(.*)/,or+"box-pack:$3"+kn+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+or+r+r;case 4095:case 3583:case 4068:case 2532:return ar(r,/(.+)-inline(.+)/,or+"$1$2")+r;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Ns(r)-1-e>6)switch(_n(r,e+1)){case 109:if(_n(r,e+4)!==45)break;case 102:return ar(r,/(.+:)(.+)-([^]+)/,"$1"+or+"$2-$3$1"+zf+(_n(r,e+3)==108?"$3":"$2-$3"))+r;case 115:return~A0(r,"stretch")?KA(ar(r,"stretch","fill-available"),e)+r:r}break;case 4949:if(_n(r,e+1)!==115)break;case 6444:switch(_n(r,Ns(r)-3-(~A0(r,"!important")&&10))){case 107:return ar(r,":",":"+or)+r;case 101:return ar(r,/(.+:)([^;!]+)(;|!.+)?/,"$1"+or+(_n(r,14)===45?"inline-":"")+"box$3$1"+or+"$2$3$1"+kn+"$2box$3")+r}break;case 5936:switch(_n(r,e+11)){case 114:return or+r+kn+ar(r,/[svh]\w+-[tblr]{2}/,"tb")+r;case 108:return or+r+kn+ar(r,/[svh]\w+-[tblr]{2}/,"tb-rl")+r;case 45:return or+r+kn+ar(r,/[svh]\w+-[tblr]{2}/,"lr")+r}return or+r+kn+r+r}return r}var Aj=function(e,t,n,i){if(e.length>-1&&!e.return)switch(e.type){case Lv:e.return=KA(e.value,e.length);break;case WA:return eu([Ou(e,{value:ar(e.value,"@","@"+or)})],i);case Fv:if(e.length)return uj(e.props,function(s){switch(lj(s,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return eu([Ou(e,{props:[ar(s,/:(read-\w+)/,":"+zf+"$1")]})],i);case"::placeholder":return eu([Ou(e,{props:[ar(s,/:(plac\w+)/,":"+or+"input-$1")]}),Ou(e,{props:[ar(s,/:(plac\w+)/,":"+zf+"$1")]}),Ou(e,{props:[ar(s,/:(plac\w+)/,kn+"input-$1")]})],i)}return""})}},Cj=[Aj],Nj=function(e){var t=e.key;if(t==="css"){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,function(p){var g=p.getAttribute("data-emotion");g.indexOf(" ")!==-1&&(document.head.appendChild(p),p.setAttribute("data-s",""))})}var i=e.stylisPlugins||Cj,s={},o,a=[];o=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),function(p){for(var g=p.getAttribute("data-emotion").split(" "),v=1;v<g.length;v++)s[g[v]]=!0;a.push(p)});var l,u=[Tj,Rj];{var c,d=[vj,wj(function(p){c.insert(p)})],h=bj(u.concat(i,d)),f=function(g){return eu(gj(g),h)};l=function(g,v,y,b){c=y,f(g?g+"{"+v.styles+"}":v.styles),b&&(m.inserted[v.name]=!0)}}var m={key:t,sheet:new rj({key:t,container:o,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:s,registered:{},insert:l};return m.sheet.hydrate(a),m};function Mj(r){for(var e=0,t,n=0,i=r.length;i>=4;++n,i-=4)t=r.charCodeAt(n)&255|(r.charCodeAt(++n)&255)<<8|(r.charCodeAt(++n)&255)<<16|(r.charCodeAt(++n)&255)<<24,t=(t&65535)*1540483477+((t>>>16)*59797<<16),t^=t>>>24,e=(t&65535)*1540483477+((t>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(i){case 3:e^=(r.charCodeAt(n+2)&255)<<16;case 2:e^=(r.charCodeAt(n+1)&255)<<8;case 1:e^=r.charCodeAt(n)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var Oj={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Ij=/[A-Z]|^ms/g,kj=/_EMO_([^_]+?)_([^]*?)_EMO_/g,ZA=function(e){return e.charCodeAt(1)===45},b_=function(e){return e!=null&&typeof e!="boolean"},Jm=_j(function(r){return ZA(r)?r:r.replace(Ij,"-$&").toLowerCase()}),w_=function(e,t){switch(e){case"animation":case"animationName":if(typeof t=="string")return t.replace(kj,function(n,i,s){return sa={name:i,styles:s,next:sa},i})}return Oj[e]!==1&&!ZA(e)&&typeof t=="number"&&t!==0?t+"px":t};function Hf(r,e,t){if(t==null)return"";var n=t;if(n.__emotion_styles!==void 0)return n;switch(typeof t){case"boolean":return"";case"object":{var i=t;if(i.anim===1)return sa={name:i.name,styles:i.styles,next:sa},i.name;var s=t;if(s.styles!==void 0){var o=s.next;if(o!==void 0)for(;o!==void 0;)sa={name:o.name,styles:o.styles,next:sa},o=o.next;var a=s.styles+";";return a}return Pj(r,e,t)}}var l=t;if(e==null)return l;var u=e[l];return u!==void 0?u:l}function Pj(r,e,t){var n="";if(Array.isArray(t))for(var i=0;i<t.length;i++)n+=Hf(r,e,t[i])+";";else for(var s in t){var o=t[s];if(typeof o!="object"){var a=o;e!=null&&e[a]!==void 0?n+=s+"{"+e[a]+"}":b_(a)&&(n+=Jm(s)+":"+w_(s,a)+";")}else if(Array.isArray(o)&&typeof o[0]=="string"&&(e==null||e[o[0]]===void 0))for(var l=0;l<o.length;l++)b_(o[l])&&(n+=Jm(s)+":"+w_(s,o[l])+";");else{var u=Hf(r,e,o);switch(s){case"animation":case"animationName":{n+=Jm(s)+":"+u+";";break}default:n+=s+"{"+u+"}"}}}return n}var __=/label:\s*([^\s;{]+)\s*(;|$)/g,sa;function eg(r,e,t){if(r.length===1&&typeof r[0]=="object"&&r[0]!==null&&r[0].styles!==void 0)return r[0];var n=!0,i="";sa=void 0;var s=r[0];if(s==null||s.raw===void 0)n=!1,i+=Hf(t,e,s);else{var o=s;i+=o[0]}for(var a=1;a<r.length;a++)if(i+=Hf(t,e,r[a]),n){var l=s;i+=l[a]}__.lastIndex=0;for(var u="",c;(c=__.exec(i))!==null;)u+="-"+c[1];var d=Mj(i)+u;return{name:d,styles:i,next:sa}}function QA(r,e,t){var n="";return t.split(" ").forEach(function(i){r[i]!==void 0?e.push(r[i]+";"):i&&(n+=i+" ")}),n}var Fj=function(e,t,n){var i=e.key+"-"+t.name;e.registered[i]===void 0&&(e.registered[i]=t.styles)},Lj=function(e,t,n){Fj(e,t);var i=e.key+"-"+t.name;if(e.inserted[t.name]===void 0){var s=t;do e.insert(t===s?"."+i:"",s,e.sheet,!0),s=s.next;while(s!==void 0)}};function x_(r,e){if(r.inserted[e.name]===void 0)return r.insert("",e,r.sheet,!0)}function E_(r,e,t){var n=[],i=QA(r,n,t);return n.length<2?t:i+e(n)}var Dj=function(e){var t=Nj(e);t.sheet.speedy=function(a){this.isSpeedy=a},t.compat=!0;var n=function(){for(var l=arguments.length,u=new Array(l),c=0;c<l;c++)u[c]=arguments[c];var d=eg(u,t.registered,void 0);return Lj(t,d),t.key+"-"+d.name},i=function(){for(var l=arguments.length,u=new Array(l),c=0;c<l;c++)u[c]=arguments[c];var d=eg(u,t.registered),h="animation-"+d.name;return x_(t,{name:d.name,styles:"@keyframes "+h+"{"+d.styles+"}"}),h},s=function(){for(var l=arguments.length,u=new Array(l),c=0;c<l;c++)u[c]=arguments[c];var d=eg(u,t.registered);x_(t,d)},o=function(){for(var l=arguments.length,u=new Array(l),c=0;c<l;c++)u[c]=arguments[c];return E_(t.registered,n,Bj(u))};return{css:n,cx:o,injectGlobal:s,keyframes:i,hydrate:function(l){l.forEach(function(u){t.inserted[u]=!0})},flush:function(){t.registered={},t.inserted={},t.sheet.flush()},sheet:t.sheet,cache:t,getRegisteredStyles:QA.bind(null,t.registered),merge:E_.bind(null,t.registered,n)}},Bj=function r(e){for(var t="",n=0;n<e.length;n++){var i=e[n];if(i!=null){var s=void 0;switch(typeof i){case"boolean":break;case"object":{if(Array.isArray(i))s=r(i);else{s="";for(var o in i)i[o]&&o&&(s&&(s+=" "),s+=o)}break}default:s=i}s&&(t&&(t+=" "),t+=s)}}return t},JA=Dj({key:"css"}),Ea=JA.injectGlobal,Pt=JA.css,tg,S_;function Uj(){return S_||(S_=1,tg=function(e,t){t||(t=[0,""]),e=String(e);var n=parseFloat(e,10);return t[0]=n,t[1]=e.match(/[\d.\-\+]*\s*(.*)/)[1]||"",t}),tg}var rg,T_;function Vj(){if(T_)return rg;T_=1;var r=Uj();rg=i;var e=n("in",document.body);function t(s,o){var a=r(getComputedStyle(s).getPropertyValue(o));return a[0]*i(a[1],s)}function n(s,o){var a=document.createElement("div");a.style.height="128"+s,o.appendChild(a);var l=t(a,"height")/128;return o.removeChild(a),l}function i(s,o){if(!s)return null;switch(o=o||document.body,s=(s+""||"px").trim().toLowerCase(),(o===window||o===document)&&(o=document.body),s){case"%":return o.clientHeight/100;case"ch":case"ex":return n(s,o);case"em":return t(o,"font-size");case"rem":return t(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return e;case"cm":return e/2.54;case"mm":return e/25.4;case"pt":return e/72;case"pc":return e/6;case"px":return 1}var a=r(s);if(!isNaN(a[0])&&a[1]){var l=i(a[1],o);return typeof l=="number"?a[0]*l:null}return null}return rg}var jj=Vj();const N0=cE(jj);function eC(){const r=()=>Math.floor((1+crypto.getRandomValues(new Uint32Array(1))[0])*65536).toString(16).substring(1);return`${r()+r()}-${r()}-${r()}-${r()}-${r()}${r()}${r()}`}function $j(r,e){const t=r.substr(4,r.length-5);return getComputedStyle(e).getPropertyValue(t)}function zj(r,e,t=0){const[n,i,s,o]=[r.x+t,r.y+r.height-2*t,r.x+r.width-2*t,r.y+t],[a,l,u,c]=[e.x+t,e.y+e.height-2*t,e.x+e.width-2*t,e.y+t];return!(i<c||l<o||s<a||u<n)}function Bv(r,e,t){r.prototype=e.prototype=t,t.constructor=r}function tC(r,e){var t=Object.create(r.prototype);for(var n in e)t[n]=e[n];return t}function uh(){}var zc=.7,Wf=1/zc,tu="\\s*([+-]?\\d+)\\s*",Hc="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Us="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Hj=/^#([0-9a-f]{3,8})$/,Wj=new RegExp(`^rgb\\(${tu},${tu},${tu}\\)$`),Gj=new RegExp(`^rgb\\(${Us},${Us},${Us}\\)$`),qj=new RegExp(`^rgba\\(${tu},${tu},${tu},${Hc}\\)$`),Yj=new RegExp(`^rgba\\(${Us},${Us},${Us},${Hc}\\)$`),Xj=new RegExp(`^hsl\\(${Hc},${Us},${Us}\\)$`),Kj=new RegExp(`^hsla\\(${Hc},${Us},${Us},${Hc}\\)$`),R_={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Bv(uh,il,{copy(r){return Object.assign(new this.constructor,this,r)},displayable(){return this.rgb().displayable()},hex:A_,formatHex:A_,formatHex8:Zj,formatHsl:Qj,formatRgb:C_,toString:C_});function A_(){return this.rgb().formatHex()}function Zj(){return this.rgb().formatHex8()}function Qj(){return rC(this).formatHsl()}function C_(){return this.rgb().formatRgb()}function il(r){var e,t;return r=(r+"").trim().toLowerCase(),(e=Hj.exec(r))?(t=e[1].length,e=parseInt(e[1],16),t===6?N_(e):t===3?new oi(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):t===8?ed(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):t===4?ed(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Wj.exec(r))?new oi(e[1],e[2],e[3],1):(e=Gj.exec(r))?new oi(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=qj.exec(r))?ed(e[1],e[2],e[3],e[4]):(e=Yj.exec(r))?ed(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Xj.exec(r))?I_(e[1],e[2]/100,e[3]/100,1):(e=Kj.exec(r))?I_(e[1],e[2]/100,e[3]/100,e[4]):R_.hasOwnProperty(r)?N_(R_[r]):r==="transparent"?new oi(NaN,NaN,NaN,0):null}function N_(r){return new oi(r>>16&255,r>>8&255,r&255,1)}function ed(r,e,t,n){return n<=0&&(r=e=t=NaN),new oi(r,e,t,n)}function Jj(r){return r instanceof uh||(r=il(r)),r?(r=r.rgb(),new oi(r.r,r.g,r.b,r.opacity)):new oi}function M0(r,e,t,n){return arguments.length===1?Jj(r):new oi(r,e,t,n??1)}function oi(r,e,t,n){this.r=+r,this.g=+e,this.b=+t,this.opacity=+n}Bv(oi,M0,tC(uh,{brighter(r){return r=r==null?Wf:Math.pow(Wf,r),new oi(this.r*r,this.g*r,this.b*r,this.opacity)},darker(r){return r=r==null?zc:Math.pow(zc,r),new oi(this.r*r,this.g*r,this.b*r,this.opacity)},rgb(){return this},clamp(){return new oi(Xa(this.r),Xa(this.g),Xa(this.b),Gf(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:M_,formatHex:M_,formatHex8:e$,formatRgb:O_,toString:O_}));function M_(){return`#${Va(this.r)}${Va(this.g)}${Va(this.b)}`}function e$(){return`#${Va(this.r)}${Va(this.g)}${Va(this.b)}${Va((isNaN(this.opacity)?1:this.opacity)*255)}`}function O_(){const r=Gf(this.opacity);return`${r===1?"rgb(":"rgba("}${Xa(this.r)}, ${Xa(this.g)}, ${Xa(this.b)}${r===1?")":`, ${r})`}`}function Gf(r){return isNaN(r)?1:Math.max(0,Math.min(1,r))}function Xa(r){return Math.max(0,Math.min(255,Math.round(r)||0))}function Va(r){return r=Xa(r),(r<16?"0":"")+r.toString(16)}function I_(r,e,t,n){return n<=0?r=e=t=NaN:t<=0||t>=1?r=e=NaN:e<=0&&(r=NaN),new ns(r,e,t,n)}function rC(r){if(r instanceof ns)return new ns(r.h,r.s,r.l,r.opacity);if(r instanceof uh||(r=il(r)),!r)return new ns;if(r instanceof ns)return r;r=r.rgb();var e=r.r/255,t=r.g/255,n=r.b/255,i=Math.min(e,t,n),s=Math.max(e,t,n),o=NaN,a=s-i,l=(s+i)/2;return a?(e===s?o=(t-n)/a+(t<n)*6:t===s?o=(n-e)/a+2:o=(e-t)/a+4,a/=l<.5?s+i:2-s-i,o*=60):a=l>0&&l<1?0:o,new ns(o,a,l,r.opacity)}function Uv(r,e,t,n){return arguments.length===1?rC(r):new ns(r,e,t,n??1)}function ns(r,e,t,n){this.h=+r,this.s=+e,this.l=+t,this.opacity=+n}Bv(ns,Uv,tC(uh,{brighter(r){return r=r==null?Wf:Math.pow(Wf,r),new ns(this.h,this.s,this.l*r,this.opacity)},darker(r){return r=r==null?zc:Math.pow(zc,r),new ns(this.h,this.s,this.l*r,this.opacity)},rgb(){var r=this.h%360+(this.h<0)*360,e=isNaN(r)||isNaN(this.s)?0:this.s,t=this.l,n=t+(t<.5?t:1-t)*e,i=2*t-n;return new oi(ng(r>=240?r-240:r+120,i,n),ng(r,i,n),ng(r<120?r+240:r-120,i,n),this.opacity)},clamp(){return new ns(k_(this.h),td(this.s),td(this.l),Gf(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const r=Gf(this.opacity);return`${r===1?"hsl(":"hsla("}${k_(this.h)}, ${td(this.s)*100}%, ${td(this.l)*100}%${r===1?")":`, ${r})`}`}}));function k_(r){return r=(r||0)%360,r<0?r+360:r}function td(r){return Math.max(0,Math.min(1,r||0))}function ng(r,e,t){return(r<60?e+(t-e)*r/60:r<180?t:r<240?e+(t-e)*(240-r)/60:e)*255}const zu=globalThis?.UNOVIS_COLORS||["#4D8CFD","#FF6B7E","#F4B83E","#A6CC74","#00C19A","#6859BE"],t$=globalThis?.UNOVIS_COLORS_DARK||["#4D8CFD","#FF6B7E","#FFC16D","#A6CC74","#00C19A","#7887E0"],Qo=r=>`--vis-${ji(r)?`color${r%zu.length}`:r}`;function r$(r,e=.4){const t=Uv(r);return t.l=t.l*(1+e),t.formatHex()}function n$(r,e=.4,t=.6){const n=Uv(r);return n.s=n.s*(1-t),n.l=n.l*(1-e),n.formatHex()}const Wc=10,O0=[{id:"stripes-diagonal",svg:'<path d="M-1,1 l2,-2 M0,10 l10,-10 M9,11 l2,-2" stroke="#000"/>'},{id:"dots",svg:'<path d="m0-1.5a1 1 0 010 3m10-3a1 1 0 000 3M5 3.5a1 1 0 010 3 1 1 0 010-3M0 8.5 a1 1 0 010 3m10-3a1 1 0 000 3" fill"#000"/>'},{id:"stripes-vertical",svg:'<path d="M 5,-1 L5,11" stroke="#000"/>'},{id:"crosshatch",svg:'<path d="M0 0L10 10ZM10 0L0 10Z" stroke="#000"/>'},{id:"waves",svg:'<path d="M0 4Q2.5 1 5 4 7.5 7 10 4v2Q7.5 9 5 6 2.5 3 0 6Z" fill="#000"/>'},{id:"circles",svg:'<circle cx="5" cy="5" r="3" stroke="#000" fill="#fff"/>'}],I0=[{id:"circle",marker:'<circle cx="5" cy="5" r="5"/>',dashArray:[]},{id:"triangle",marker:'<path d="M5,0 L10,9 L0,9Z">',dashArray:[9,1]},{id:"diamond",marker:'<path d="M 0 5 L5 0 L 10 5 L 5 10 L 0 5Z">',dashArray:[2]},{id:"arrow",marker:'<path d="M4 0 0 0 6 5 0 10 4 10 10 5Z">',dashArray:[2,3,8,3]},{id:"square",marker:'<rect x="1" y="1" width="8" height="8"/>',dashArray:[6]},{id:"star",marker:'<path d="m2 9 3-9 3 9L0 3h10Z"/>',dashArray:[1,6]}];function Jo(r){return`vis-${`pattern-${r.svg?"fill":"marker"}`}-${r.id}`}const i$=r=>`<mask id="${Jo(r)}">
    <pattern id="${r.id}" viewBox="0 0 10 10" width="${Wc}" height="${Wc}" patternUnits="userSpaceOnUse">
      <rect width="100%" height="100%" fill="#fff"/>
      ${r.svg}
    </pattern>
    <rect x="-50%" y="-50%" width="200%" height="200%" fill="url(#${r.id})"/>
  </mask>`,s$=(r,e)=>`<marker id="${Jo(r)}"
    fill="var(${Qo(e)})"
    markerUnits="userSpaceOnUse"
    refX="5"
    refY="5"
    markerWidth="${Wc}"
    markerHeight="${Wc}">
    ${r.marker}
  </marker>`;function o$(){const r=O0.map(i$).concat(I0.map(s$)).join(""),e=document.createElementNS("http://www.w3.org/2000/svg","svg");e.setAttribute("height","100%"),e.setAttribute("width","100%"),e.style.position="fixed",e.style.zIndex="-99999999",e.innerHTML=`<defs>${r}</defs>`,document.body.appendChild(e)}typeof window<"u"&&o$();const nC=globalThis?.UNOVIS_FONT_W2H_RATIO_DEFAULT||.5,iC=globalThis?.UNOVIS_TEXT_SEPARATOR_DEFAULT||[" ","-",".",","],sC=globalThis?.UNOVIS_TEXT_HYPHEN_CHARACTER_DEFAULT||"-",yc=globalThis?.UNOVIS_TEXT_DEFAULT||{text:"",fontSize:12,fontFamily:"var(--vis-font-family)",lineHeight:1.25,marginTop:0,marginBottom:0};Ea`
  :root {
    label: vis-root-styles;
    --vis-font-family: Inter, Arial, "Helvetica Neue", Helvetica, sans-serif;
    --vis-font-wh-ratio: ${nC};
    --vis-color-main: var(${Qo(0)});
    --vis-color-main-light: ${r$(zu[0])};
    --vis-color-main-dark: ${n$(zu[0])};
    --vis-color-grey: #2a2a2a;
    ${zu.map((r,e)=>`${Qo(e)}: ${r};`)}
    ${t$.map((r,e)=>`--vis-dark-color${e}: ${r};`)}
    ${O0.map((r,e)=>`
      --${Jo(r)}: url(#${Jo(r)});
      --vis-pattern-fill${e}: var(--${Jo(r)});
    `)}
    ${I0.map((r,e)=>{var t;return`
      --${Jo(r)}: url(#${Jo(r)});
      --vis-pattern-marker${e}: var(--${Jo(r)});
      --vis-pattern-dasharray${e}: ${(t=r.dashArray)===null||t===void 0?void 0:t.join(" ")};
    `})}

    body.theme-dark {
      ${zu.map((r,e)=>`${Qo(e)}: var(--vis-dark-color${e});`)}
    }

    body.theme-patterns {
      ${O0.map((r,e)=>`path[style*="fill: var(${Qo(e)})"]  {
        mask: var(--vis-pattern-fill${e});
      }`)}
      ${I0.map((r,e)=>`
      path[stroke="var(${Qo(e)})"]:not([style*="fill"]),
      path[style*="stroke: var(${Qo(e)})"]:not([style*="fill"]) {
        marker: var(--vis-pattern-marker${e});
        stroke-dasharray: var(--vis-pattern-dasharray${e});
      }
    `)}
}
`;function oC(r=window?.document.body){return r?+$j("var(--vis-font-wh-ratio)",r):nC}var a$={value:()=>{}};function aC(){for(var r=0,e=arguments.length,t={},n;r<e;++r){if(!(n=arguments[r]+"")||n in t||/[\s.]/.test(n))throw new Error("illegal type: "+n);t[n]=[]}return new Id(t)}function Id(r){this._=r}function l$(r,e){return r.trim().split(/^|\s+/).map(function(t){var n="",i=t.indexOf(".");if(i>=0&&(n=t.slice(i+1),t=t.slice(0,i)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}})}Id.prototype=aC.prototype={constructor:Id,on:function(r,e){var t=this._,n=l$(r+"",t),i,s=-1,o=n.length;if(arguments.length<2){for(;++s<o;)if((i=(r=n[s]).type)&&(i=u$(t[i],r.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++s<o;)if(i=(r=n[s]).type)t[i]=P_(t[i],r.name,e);else if(e==null)for(i in t)t[i]=P_(t[i],r.name,null);return this},copy:function(){var r={},e=this._;for(var t in e)r[t]=e[t].slice();return new Id(r)},call:function(r,e){if((i=arguments.length-2)>0)for(var t=new Array(i),n=0,i,s;n<i;++n)t[n]=arguments[n+2];if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(s=this._[r],n=0,i=s.length;n<i;++n)s[n].value.apply(e,t)},apply:function(r,e,t){if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(var n=this._[r],i=0,s=n.length;i<s;++i)n[i].value.apply(e,t)}};function u$(r,e){for(var t=0,n=r.length,i;t<n;++t)if((i=r[t]).name===e)return i.value}function P_(r,e,t){for(var n=0,i=r.length;n<i;++n)if(r[n].name===e){r[n]=a$,r=r.slice(0,n).concat(r.slice(n+1));break}return t!=null&&r.push({name:e,value:t}),r}var du=0,Hu=0,Iu=0,lC=1e3,qf,Wu,Yf=0,sl=0,Jp=0,Gc=typeof performance=="object"&&performance.now?performance:Date,uC=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(r){setTimeout(r,17)};function Vv(){return sl||(uC(c$),sl=Gc.now()+Jp)}function c$(){sl=0}function Xf(){this._call=this._time=this._next=null}Xf.prototype=cC.prototype={constructor:Xf,restart:function(r,e,t){if(typeof r!="function")throw new TypeError("callback is not a function");t=(t==null?Vv():+t)+(e==null?0:+e),!this._next&&Wu!==this&&(Wu?Wu._next=this:qf=this,Wu=this),this._call=r,this._time=t,k0()},stop:function(){this._call&&(this._call=null,this._time=1/0,k0())}};function cC(r,e,t){var n=new Xf;return n.restart(r,e,t),n}function h$(){Vv(),++du;for(var r=qf,e;r;)(e=sl-r._time)>=0&&r._call.call(void 0,e),r=r._next;--du}function F_(){sl=(Yf=Gc.now())+Jp,du=Hu=0;try{h$()}finally{du=0,f$(),sl=0}}function d$(){var r=Gc.now(),e=r-Yf;e>lC&&(Jp-=e,Yf=r)}function f$(){for(var r,e=qf,t,n=1/0;e;)e._call?(n>e._time&&(n=e._time),r=e,e=e._next):(t=e._next,e._next=null,e=r?r._next=t:qf=t);Wu=r,k0(n)}function k0(r){if(!du){Hu&&(Hu=clearTimeout(Hu));var e=r-sl;e>24?(r<1/0&&(Hu=setTimeout(F_,r-Gc.now()-Jp)),Iu&&(Iu=clearInterval(Iu))):(Iu||(Yf=Gc.now(),Iu=setInterval(d$,lC)),du=1,uC(F_))}}function L_(r,e,t){var n=new Xf;return e=e==null?0:+e,n.restart(i=>{n.stop(),r(i+e)},e,t),n}var p$=aC("start","end","cancel","interrupt"),m$=[],hC=0,D_=1,P0=2,kd=3,B_=4,F0=5,Pd=6;function em(r,e,t,n,i,s){var o=r.__transition;if(!o)r.__transition={};else if(t in o)return;g$(r,t,{name:e,index:n,group:i,on:p$,tween:m$,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:hC})}function jv(r,e){var t=gs(r,e);if(t.state>hC)throw new Error("too late; already scheduled");return t}function eo(r,e){var t=gs(r,e);if(t.state>kd)throw new Error("too late; already running");return t}function gs(r,e){var t=r.__transition;if(!t||!(t=t[e]))throw new Error("transition not found");return t}function g$(r,e,t){var n=r.__transition,i;n[e]=t,t.timer=cC(s,0,t.time);function s(u){t.state=D_,t.timer.restart(o,t.delay,t.time),t.delay<=u&&o(u-t.delay)}function o(u){var c,d,h,f;if(t.state!==D_)return l();for(c in n)if(f=n[c],f.name===t.name){if(f.state===kd)return L_(o);f.state===B_?(f.state=Pd,f.timer.stop(),f.on.call("interrupt",r,r.__data__,f.index,f.group),delete n[c]):+c<e&&(f.state=Pd,f.timer.stop(),f.on.call("cancel",r,r.__data__,f.index,f.group),delete n[c])}if(L_(function(){t.state===kd&&(t.state=B_,t.timer.restart(a,t.delay,t.time),a(u))}),t.state=P0,t.on.call("start",r,r.__data__,t.index,t.group),t.state===P0){for(t.state=kd,i=new Array(h=t.tween.length),c=0,d=-1;c<h;++c)(f=t.tween[c].value.call(r,r.__data__,t.index,t.group))&&(i[++d]=f);i.length=d+1}}function a(u){for(var c=u<t.duration?t.ease.call(null,u/t.duration):(t.timer.restart(l),t.state=F0,1),d=-1,h=i.length;++d<h;)i[d].call(r,c);t.state===F0&&(t.on.call("end",r,r.__data__,t.index,t.group),l())}function l(){t.state=Pd,t.timer.stop(),delete n[e];for(var u in n)return;delete r.__transition}}function $v(r,e){var t=r.__transition,n,i,s=!0,o;if(t){e=e==null?null:e+"";for(o in t){if((n=t[o]).name!==e){s=!1;continue}i=n.state>P0&&n.state<F0,n.state=Pd,n.timer.stop(),n.on.call(i?"interrupt":"cancel",r,r.__data__,n.index,n.group),delete t[o]}s&&delete r.__transition}}function y$(r){return this.each(function(){$v(this,r)})}const zv=r=>()=>r;function v$(r,e){return function(t){return r+t*e}}function b$(r,e,t){return r=Math.pow(r,t),e=Math.pow(e,t)-r,t=1/t,function(n){return Math.pow(r+n*e,t)}}function w$(r){return(r=+r)==1?dC:function(e,t){return t-e?b$(e,t,r):zv(isNaN(e)?t:e)}}function dC(r,e){var t=e-r;return t?v$(r,t):zv(isNaN(r)?e:r)}const Kf=(function r(e){var t=w$(e);function n(i,s){var o=t((i=M0(i)).r,(s=M0(s)).r),a=t(i.g,s.g),l=t(i.b,s.b),u=dC(i.opacity,s.opacity);return function(c){return i.r=o(c),i.g=a(c),i.b=l(c),i.opacity=u(c),i+""}}return n.gamma=r,n})(1);function _$(r,e){e||(e=[]);var t=r?Math.min(e.length,r.length):0,n=e.slice(),i;return function(s){for(i=0;i<t;++i)n[i]=r[i]*(1-s)+e[i]*s;return n}}function x$(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}function E$(r,e){var t=e?e.length:0,n=r?Math.min(t,r.length):0,i=new Array(n),s=new Array(t),o;for(o=0;o<n;++o)i[o]=hl(r[o],e[o]);for(;o<t;++o)s[o]=e[o];return function(a){for(o=0;o<n;++o)s[o]=i[o](a);return s}}function S$(r,e){var t=new Date;return r=+r,e=+e,function(n){return t.setTime(r*(1-n)+e*n),t}}function es(r,e){return r=+r,e=+e,function(t){return r*(1-t)+e*t}}function T$(r,e){var t={},n={},i;(r===null||typeof r!="object")&&(r={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in r?t[i]=hl(r[i],e[i]):n[i]=e[i];return function(s){for(i in t)n[i]=t[i](s);return n}}var L0=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ig=new RegExp(L0.source,"g");function R$(r){return function(){return r}}function A$(r){return function(e){return r(e)+""}}function fC(r,e){var t=L0.lastIndex=ig.lastIndex=0,n,i,s,o=-1,a=[],l=[];for(r=r+"",e=e+"";(n=L0.exec(r))&&(i=ig.exec(e));)(s=i.index)>t&&(s=e.slice(t,s),a[o]?a[o]+=s:a[++o]=s),(n=n[0])===(i=i[0])?a[o]?a[o]+=i:a[++o]=i:(a[++o]=null,l.push({i:o,x:es(n,i)})),t=ig.lastIndex;return t<e.length&&(s=e.slice(t),a[o]?a[o]+=s:a[++o]=s),a.length<2?l[0]?A$(l[0].x):R$(e):(e=l.length,function(u){for(var c=0,d;c<e;++c)a[(d=l[c]).i]=d.x(u);return a.join("")})}function hl(r,e){var t=typeof e,n;return e==null||t==="boolean"?zv(e):(t==="number"?es:t==="string"?(n=il(e))?(e=n,Kf):fC:e instanceof il?Kf:e instanceof Date?S$:x$(e)?_$:Array.isArray(e)?E$:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?T$:es)(r,e)}function Hv(r,e){return r=+r,e=+e,function(t){return Math.round(r*(1-t)+e*t)}}var U_=180/Math.PI,D0={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function pC(r,e,t,n,i,s){var o,a,l;return(o=Math.sqrt(r*r+e*e))&&(r/=o,e/=o),(l=r*t+e*n)&&(t-=r*l,n-=e*l),(a=Math.sqrt(t*t+n*n))&&(t/=a,n/=a,l/=a),r*n<e*t&&(r=-r,e=-e,l=-l,o=-o),{translateX:i,translateY:s,rotate:Math.atan2(e,r)*U_,skewX:Math.atan(l)*U_,scaleX:o,scaleY:a}}var rd;function C$(r){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(r+"");return e.isIdentity?D0:pC(e.a,e.b,e.c,e.d,e.e,e.f)}function N$(r){return r==null||(rd||(rd=document.createElementNS("http://www.w3.org/2000/svg","g")),rd.setAttribute("transform",r),!(r=rd.transform.baseVal.consolidate()))?D0:(r=r.matrix,pC(r.a,r.b,r.c,r.d,r.e,r.f))}function mC(r,e,t,n){function i(u){return u.length?u.pop()+" ":""}function s(u,c,d,h,f,m){if(u!==d||c!==h){var p=f.push("translate(",null,e,null,t);m.push({i:p-4,x:es(u,d)},{i:p-2,x:es(c,h)})}else(d||h)&&f.push("translate("+d+e+h+t)}function o(u,c,d,h){u!==c?(u-c>180?c+=360:c-u>180&&(u+=360),h.push({i:d.push(i(d)+"rotate(",null,n)-2,x:es(u,c)})):c&&d.push(i(d)+"rotate("+c+n)}function a(u,c,d,h){u!==c?h.push({i:d.push(i(d)+"skewX(",null,n)-2,x:es(u,c)}):c&&d.push(i(d)+"skewX("+c+n)}function l(u,c,d,h,f,m){if(u!==d||c!==h){var p=f.push(i(f)+"scale(",null,",",null,")");m.push({i:p-4,x:es(u,d)},{i:p-2,x:es(c,h)})}else(d!==1||h!==1)&&f.push(i(f)+"scale("+d+","+h+")")}return function(u,c){var d=[],h=[];return u=r(u),c=r(c),s(u.translateX,u.translateY,c.translateX,c.translateY,d,h),o(u.rotate,c.rotate,d,h),a(u.skewX,c.skewX,d,h),l(u.scaleX,u.scaleY,c.scaleX,c.scaleY,d,h),u=c=null,function(f){for(var m=-1,p=h.length,g;++m<p;)d[(g=h[m]).i]=g.x(f);return d.join("")}}}var M$=mC(C$,"px, ","px)","deg)"),O$=mC(N$,", ",")",")");function I$(r,e){e===void 0&&(e=r,r=hl);for(var t=0,n=e.length-1,i=e[0],s=new Array(n<0?0:n);t<n;)s[t]=r(i,i=e[++t]);return function(o){var a=Math.max(0,Math.min(n-1,Math.floor(o*=n)));return s[a](o-a)}}function k$(r,e){var t,n;return function(){var i=eo(this,r),s=i.tween;if(s!==t){n=t=s;for(var o=0,a=n.length;o<a;++o)if(n[o].name===e){n=n.slice(),n.splice(o,1);break}}i.tween=n}}function P$(r,e,t){var n,i;if(typeof t!="function")throw new Error;return function(){var s=eo(this,r),o=s.tween;if(o!==n){i=(n=o).slice();for(var a={name:e,value:t},l=0,u=i.length;l<u;++l)if(i[l].name===e){i[l]=a;break}l===u&&i.push(a)}s.tween=i}}function F$(r,e){var t=this._id;if(r+="",arguments.length<2){for(var n=gs(this.node(),t).tween,i=0,s=n.length,o;i<s;++i)if((o=n[i]).name===r)return o.value;return null}return this.each((e==null?k$:P$)(t,r,e))}function Wv(r,e,t){var n=r._id;return r.each(function(){var i=eo(this,n);(i.value||(i.value={}))[e]=t.apply(this,arguments)}),function(i){return gs(i,n).value[e]}}function gC(r,e){var t;return(typeof e=="number"?es:e instanceof il?Kf:(t=il(e))?(e=t,Kf):fC)(r,e)}function L$(r){return function(){this.removeAttribute(r)}}function D$(r){return function(){this.removeAttributeNS(r.space,r.local)}}function B$(r,e,t){var n,i=t+"",s;return function(){var o=this.getAttribute(r);return o===i?null:o===n?s:s=e(n=o,t)}}function U$(r,e,t){var n,i=t+"",s;return function(){var o=this.getAttributeNS(r.space,r.local);return o===i?null:o===n?s:s=e(n=o,t)}}function V$(r,e,t){var n,i,s;return function(){var o,a=t(this),l;return a==null?void this.removeAttribute(r):(o=this.getAttribute(r),l=a+"",o===l?null:o===n&&l===i?s:(i=l,s=e(n=o,a)))}}function j$(r,e,t){var n,i,s;return function(){var o,a=t(this),l;return a==null?void this.removeAttributeNS(r.space,r.local):(o=this.getAttributeNS(r.space,r.local),l=a+"",o===l?null:o===n&&l===i?s:(i=l,s=e(n=o,a)))}}function $$(r,e){var t=Xp(r),n=t==="transform"?O$:gC;return this.attrTween(r,typeof e=="function"?(t.local?j$:V$)(t,n,Wv(this,"attr."+r,e)):e==null?(t.local?D$:L$)(t):(t.local?U$:B$)(t,n,e))}function z$(r,e){return function(t){this.setAttribute(r,e.call(this,t))}}function H$(r,e){return function(t){this.setAttributeNS(r.space,r.local,e.call(this,t))}}function W$(r,e){var t,n;function i(){var s=e.apply(this,arguments);return s!==n&&(t=(n=s)&&H$(r,s)),t}return i._value=e,i}function G$(r,e){var t,n;function i(){var s=e.apply(this,arguments);return s!==n&&(t=(n=s)&&z$(r,s)),t}return i._value=e,i}function q$(r,e){var t="attr."+r;if(arguments.length<2)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;var n=Xp(r);return this.tween(t,(n.local?W$:G$)(n,e))}function Y$(r,e){return function(){jv(this,r).delay=+e.apply(this,arguments)}}function X$(r,e){return e=+e,function(){jv(this,r).delay=e}}function K$(r){var e=this._id;return arguments.length?this.each((typeof r=="function"?Y$:X$)(e,r)):gs(this.node(),e).delay}function Z$(r,e){return function(){eo(this,r).duration=+e.apply(this,arguments)}}function Q$(r,e){return e=+e,function(){eo(this,r).duration=e}}function J$(r){var e=this._id;return arguments.length?this.each((typeof r=="function"?Z$:Q$)(e,r)):gs(this.node(),e).duration}function ez(r,e){if(typeof e!="function")throw new Error;return function(){eo(this,r).ease=e}}function tz(r){var e=this._id;return arguments.length?this.each(ez(e,r)):gs(this.node(),e).ease}function rz(r,e){return function(){var t=e.apply(this,arguments);if(typeof t!="function")throw new Error;eo(this,r).ease=t}}function nz(r){if(typeof r!="function")throw new Error;return this.each(rz(this._id,r))}function iz(r){typeof r!="function"&&(r=EA(r));for(var e=this._groups,t=e.length,n=new Array(t),i=0;i<t;++i)for(var s=e[i],o=s.length,a=n[i]=[],l,u=0;u<o;++u)(l=s[u])&&r.call(l,l.__data__,u,s)&&a.push(l);return new No(n,this._parents,this._name,this._id)}function sz(r){if(r._id!==this._id)throw new Error;for(var e=this._groups,t=r._groups,n=e.length,i=t.length,s=Math.min(n,i),o=new Array(n),a=0;a<s;++a)for(var l=e[a],u=t[a],c=l.length,d=o[a]=new Array(c),h,f=0;f<c;++f)(h=l[f]||u[f])&&(d[f]=h);for(;a<n;++a)o[a]=e[a];return new No(o,this._parents,this._name,this._id)}function oz(r){return(r+"").trim().split(/^|\s+/).every(function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||e==="start"})}function az(r,e,t){var n,i,s=oz(e)?jv:eo;return function(){var o=s(this,r),a=o.on;a!==n&&(i=(n=a).copy()).on(e,t),o.on=i}}function lz(r,e){var t=this._id;return arguments.length<2?gs(this.node(),t).on.on(r):this.each(az(t,r,e))}function uz(r){return function(){var e=this.parentNode;for(var t in this.__transition)if(+t!==r)return;e&&e.removeChild(this)}}function cz(){return this.on("end.remove",uz(this._id))}function hz(r){var e=this._name,t=this._id;typeof r!="function"&&(r=Cv(r));for(var n=this._groups,i=n.length,s=new Array(i),o=0;o<i;++o)for(var a=n[o],l=a.length,u=s[o]=new Array(l),c,d,h=0;h<l;++h)(c=a[h])&&(d=r.call(c,c.__data__,h,a))&&("__data__"in c&&(d.__data__=c.__data__),u[h]=d,em(u[h],e,t,h,u,gs(c,t)));return new No(s,this._parents,e,t)}function dz(r){var e=this._name,t=this._id;typeof r!="function"&&(r=xA(r));for(var n=this._groups,i=n.length,s=[],o=[],a=0;a<i;++a)for(var l=n[a],u=l.length,c,d=0;d<u;++d)if(c=l[d]){for(var h=r.call(c,c.__data__,d,l),f,m=gs(c,t),p=0,g=h.length;p<g;++p)(f=h[p])&&em(f,e,t,p,h,m);s.push(h),o.push(c)}return new No(s,o,e,t)}var fz=oh.prototype.constructor;function pz(){return new fz(this._groups,this._parents)}function mz(r,e){var t,n,i;return function(){var s=uu(this,r),o=(this.style.removeProperty(r),uu(this,r));return s===o?null:s===t&&o===n?i:i=e(t=s,n=o)}}function yC(r){return function(){this.style.removeProperty(r)}}function gz(r,e,t){var n,i=t+"",s;return function(){var o=uu(this,r);return o===i?null:o===n?s:s=e(n=o,t)}}function yz(r,e,t){var n,i,s;return function(){var o=uu(this,r),a=t(this),l=a+"";return a==null&&(l=a=(this.style.removeProperty(r),uu(this,r))),o===l?null:o===n&&l===i?s:(i=l,s=e(n=o,a))}}function vz(r,e){var t,n,i,s="style."+e,o="end."+s,a;return function(){var l=eo(this,r),u=l.on,c=l.value[s]==null?a||(a=yC(e)):void 0;(u!==t||i!==c)&&(n=(t=u).copy()).on(o,i=c),l.on=n}}function bz(r,e,t){var n=(r+="")=="transform"?M$:gC;return e==null?this.styleTween(r,mz(r,n)).on("end.style."+r,yC(r)):typeof e=="function"?this.styleTween(r,yz(r,n,Wv(this,"style."+r,e))).each(vz(this._id,r)):this.styleTween(r,gz(r,n,e),t).on("end.style."+r,null)}function wz(r,e,t){return function(n){this.style.setProperty(r,e.call(this,n),t)}}function _z(r,e,t){var n,i;function s(){var o=e.apply(this,arguments);return o!==i&&(n=(i=o)&&wz(r,o,t)),n}return s._value=e,s}function xz(r,e,t){var n="style."+(r+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;return this.tween(n,_z(r,e,t??""))}function Ez(r){return function(){this.textContent=r}}function Sz(r){return function(){var e=r(this);this.textContent=e??""}}function Tz(r){return this.tween("text",typeof r=="function"?Sz(Wv(this,"text",r)):Ez(r==null?"":r+""))}function Rz(r){return function(e){this.textContent=r.call(this,e)}}function Az(r){var e,t;function n(){var i=r.apply(this,arguments);return i!==t&&(e=(t=i)&&Rz(i)),e}return n._value=r,n}function Cz(r){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(r==null)return this.tween(e,null);if(typeof r!="function")throw new Error;return this.tween(e,Az(r))}function Nz(){for(var r=this._name,e=this._id,t=vC(),n=this._groups,i=n.length,s=0;s<i;++s)for(var o=n[s],a=o.length,l,u=0;u<a;++u)if(l=o[u]){var c=gs(l,e);em(l,r,t,u,o,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new No(n,this._parents,r,t)}function Mz(){var r,e,t=this,n=t._id,i=t.size();return new Promise(function(s,o){var a={value:o},l={value:function(){--i===0&&s()}};t.each(function(){var u=eo(this,n),c=u.on;c!==r&&(e=(r=c).copy(),e._.cancel.push(a),e._.interrupt.push(a),e._.end.push(l)),u.on=e}),i===0&&s()})}var Oz=0;function No(r,e,t,n){this._groups=r,this._parents=e,this._name=t,this._id=n}function vC(){return++Oz}var oo=oh.prototype;No.prototype={constructor:No,select:hz,selectAll:dz,selectChild:oo.selectChild,selectChildren:oo.selectChildren,filter:iz,merge:sz,selection:pz,transition:Nz,call:oo.call,nodes:oo.nodes,node:oo.node,size:oo.size,empty:oo.empty,each:oo.each,on:lz,attr:$$,attrTween:q$,style:bz,styleTween:xz,text:Tz,textTween:Cz,remove:cz,tween:F$,delay:K$,duration:J$,ease:tz,easeVarying:nz,end:Mz,[Symbol.iterator]:oo[Symbol.iterator]};const V_=r=>+r;function Iz(r){return((r*=2)<=1?r*r*r:(r-=2)*r*r+2)/2}var kz={time:null,delay:0,duration:250,ease:Iz};function Pz(r,e){for(var t;!(t=r.__transition)||!(t=t[e]);)if(!(r=r.parentNode))throw new Error(`transition ${e} not found`);return t}function Fz(r){var e,t;r instanceof No?(e=r._id,r=r._name):(e=vC(),(t=kz).time=Vv(),r=r==null?null:r+"");for(var n=this._groups,i=n.length,s=0;s<i;++s)for(var o=n[s],a=o.length,l,u=0;u<a;++u)(l=o[u])&&em(l,r,e,u,o,t||Pz(l,e));return new No(n,this._parents,r,e)}oh.prototype.interrupt=y$;oh.prototype.transition=Fz;function an(r,e,t){if(r.nodes().forEach(n=>$v(n)),e){const n=r.transition().duration(e);return t&&n.ease(t),n}else return r}const Lz=Object.assign(Object.assign({},Pv),{tooltip:void 0,annotations:void 0});class Dz extends cu{constructor(e,t,n){var i;super(e),this._defaultConfig=Lz,this.config=this._defaultConfig,t&&(this.updateContainer(t,!0),this.component=t.component),n&&this.setData(n,!0),!((i=this.component)===null||i===void 0)&&i.datamodel.data&&this.render()}setData(e,t){var n;const{config:i}=this;this.component&&this.component.setData(e),t||this.render(),(n=i.tooltip)===null||n===void 0||n.hide()}updateContainer(e,t){super.updateContainer(e),this._removeAllChildren(),this.component=e.component,e.sizing&&(this.component.sizing=e.sizing),this.element.appendChild(this.component.element);const n=e.tooltip;n&&(n.hasContainer()||n.setContainer(this._container),n.setComponents([this.component]));const i=e.annotations;i&&this.element.appendChild(i.element),this.element.appendChild(this._svgDefs.node()),this.element.appendChild(this._svgDefsExternal.node()),t||this.render()}updateComponent(e,t){this.component.setConfig(e),t||this.render()}update(e,t,n){e&&this.updateContainer(e,!0),t&&this.updateComponent(t,!0),n&&this.setData(n,!0),this.render()}getFitWidthScale(){const{config:e,component:t}=this,n=t;if(!n.getWidth)return 1;const i=n.getWidth()+e.margin.left+e.margin.right;return this.width/i}_preRender(){var e,t;super._preRender(),this.component.setSize(this.width,this.height,this.containerWidth,this.containerHeight),this.component.setContainerMargin(this.config.margin),(e=this.config.annotations)===null||e===void 0||e.setSize(this.width,this.height,this.containerWidth,this.containerHeight),(t=this.config.annotations)===null||t===void 0||t.setContainerMargin(this.config.margin)}_render(e){var t;const{config:n,component:i}=this;super._render(e),i.g.attr("transform",`translate(${n.margin.left},${n.margin.top})`),i.render(e),(t=n.annotations)===null||t===void 0||t.render(e),n.tooltip&&n.tooltip.update()}render(e=this.config.duration){const{config:t,component:n}=this;if(t.sizing===_o.Extend||t.sizing===_o.FitWidth){const i=t.sizing===_o.FitWidth,s=n,o=s.getWidth()+t.margin.left+t.margin.right,a=s.getHeight()+t.margin.top+t.margin.bottom,l=i?this.getFitWidthScale():1,u=this.svg.attr("width"),c=this.svg.attr("height"),d=o*l,h=a*l,f=u||c;an(this.svg,f?e:0).attr("width",d).attr("height",h).attr("viewBox",`0 0 ${o} ${i?h:a}`).attr("preserveAspectRatio","xMinYMin")}else this.svg.attr("width",this.config.width||this.containerWidth).attr("height",this.config.height||this.containerHeight);this._resizeObserver||this._setUpResizeObserver(),cancelAnimationFrame(this._renderAnimationFrameId),this._renderAnimationFrameId=requestAnimationFrame(()=>{this._preRender(),this._render(e)})}_onResize(){var e;const{config:t}=this;super._onResize(),(e=t.tooltip)===null||e===void 0||e.hide()}destroy(){var e,t;const{component:n,config:i}=this;super.destroy(),n?.destroy(),(e=i.tooltip)===null||e===void 0||e.destroy(),(t=i.annotations)===null||t===void 0||t.destroy()}}class Gv{constructor(e){this.data=e}get data(){return this._data}set data(e){this._data=e}}var tr;(function(r){r.X="x",r.Y="y"})(tr||(tr={}));function ys(r,e){switch(arguments.length){case 0:break;case 1:this.range(r);break;default:this.range(e).domain(r);break}return this}function bC(r,e){switch(arguments.length){case 0:break;case 1:{typeof r=="function"?this.interpolator(r):this.range(r);break}default:{this.domain(r),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const j_=Symbol("implicit");function qv(){var r=new i_,e=[],t=[],n=j_;function i(s){let o=r.get(s);if(o===void 0){if(n!==j_)return n;r.set(s,o=e.push(s)-1)}return t[o%t.length]}return i.domain=function(s){if(!arguments.length)return e.slice();e=[],r=new i_;for(const o of s)r.has(o)||r.set(o,e.push(o)-1);return i},i.range=function(s){return arguments.length?(t=Array.from(s),i):t.slice()},i.unknown=function(s){return arguments.length?(n=s,i):n},i.copy=function(){return qv(e,t).unknown(n)},ys.apply(i,arguments),i}function tm(){var r=qv().unknown(void 0),e=r.domain,t=r.range,n=0,i=1,s,o,a=!1,l=0,u=0,c=.5;delete r.unknown;function d(){var h=e().length,f=i<n,m=f?i:n,p=f?n:i;s=(p-m)/Math.max(1,h-l+u*2),a&&(s=Math.floor(s)),m+=(p-m-s*(h-l))*c,o=s*(1-l),a&&(m=Math.round(m),o=Math.round(o));var g=FA(h).map(function(v){return m+s*v});return t(f?g.reverse():g)}return r.domain=function(h){return arguments.length?(e(h),d()):e()},r.range=function(h){return arguments.length?([n,i]=h,n=+n,i=+i,d()):[n,i]},r.rangeRound=function(h){return[n,i]=h,n=+n,i=+i,a=!0,d()},r.bandwidth=function(){return o},r.step=function(){return s},r.round=function(h){return arguments.length?(a=!!h,d()):a},r.padding=function(h){return arguments.length?(l=Math.min(1,u=+h),d()):l},r.paddingInner=function(h){return arguments.length?(l=Math.min(1,h),d()):l},r.paddingOuter=function(h){return arguments.length?(u=+h,d()):u},r.align=function(h){return arguments.length?(c=Math.max(0,Math.min(1,h)),d()):c},r.copy=function(){return tm(e(),[n,i]).round(a).paddingInner(l).paddingOuter(u).align(c)},ys.apply(d(),arguments)}function wC(r){var e=r.copy;return r.padding=r.paddingOuter,delete r.paddingInner,delete r.paddingOuter,r.copy=function(){return wC(e())},r}function Bz(){return wC(tm.apply(null,arguments).paddingInner(1))}function Uz(r){return function(){return r}}function B0(r){return+r}var $_=[0,1];function ai(r){return r}function U0(r,e){return(e-=r=+r)?function(t){return(t-r)/e}:Uz(isNaN(e)?NaN:.5)}function Vz(r,e){var t;return r>e&&(t=r,r=e,e=t),function(n){return Math.max(r,Math.min(e,n))}}function jz(r,e,t){var n=r[0],i=r[1],s=e[0],o=e[1];return i<n?(n=U0(i,n),s=t(o,s)):(n=U0(n,i),s=t(s,o)),function(a){return s(n(a))}}function $z(r,e,t){var n=Math.min(r.length,e.length)-1,i=new Array(n),s=new Array(n),o=-1;for(r[n]<r[0]&&(r=r.slice().reverse(),e=e.slice().reverse());++o<n;)i[o]=U0(r[o],r[o+1]),s[o]=t(e[o],e[o+1]);return function(a){var l=ah(r,a,1,n)-1;return s[l](i[l](a))}}function ch(r,e){return e.domain(r.domain()).range(r.range()).interpolate(r.interpolate()).clamp(r.clamp()).unknown(r.unknown())}function rm(){var r=$_,e=$_,t=hl,n,i,s,o=ai,a,l,u;function c(){var h=Math.min(r.length,e.length);return o!==ai&&(o=Vz(r[0],r[h-1])),a=h>2?$z:jz,l=u=null,d}function d(h){return h==null||isNaN(h=+h)?s:(l||(l=a(r.map(n),e,t)))(n(o(h)))}return d.invert=function(h){return o(i((u||(u=a(e,r.map(n),es)))(h)))},d.domain=function(h){return arguments.length?(r=Array.from(h,B0),c()):r.slice()},d.range=function(h){return arguments.length?(e=Array.from(h),c()):e.slice()},d.rangeRound=function(h){return e=Array.from(h),t=Hv,c()},d.clamp=function(h){return arguments.length?(o=h?!0:ai,c()):o!==ai},d.interpolate=function(h){return arguments.length?(t=h,c()):t},d.unknown=function(h){return arguments.length?(s=h,d):s},function(h,f){return n=h,i=f,c()}}function _C(){return rm()(ai,ai)}function zz(r){return Math.abs(r=Math.round(r))>=1e21?r.toLocaleString("en").replace(/,/g,""):r.toString(10)}function Zf(r,e){if(!isFinite(r)||r===0)return null;var t=(r=e?r.toExponential(e-1):r.toExponential()).indexOf("e"),n=r.slice(0,t);return[n.length>1?n[0]+n.slice(2):n,+r.slice(t+1)]}function fu(r){return r=Zf(Math.abs(r)),r?r[1]:NaN}function Hz(r,e){return function(t,n){for(var i=t.length,s=[],o=0,a=r[0],l=0;i>0&&a>0&&(l+a+1>n&&(a=Math.max(1,n-l)),s.push(t.substring(i-=a,i+a)),!((l+=a+1)>n));)a=r[o=(o+1)%r.length];return s.reverse().join(e)}}function Wz(r){return function(e){return e.replace(/[0-9]/g,function(t){return r[+t]})}}var Gz=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function qc(r){if(!(e=Gz.exec(r)))throw new Error("invalid format: "+r);var e;return new Yv({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}qc.prototype=Yv.prototype;function Yv(r){this.fill=r.fill===void 0?" ":r.fill+"",this.align=r.align===void 0?">":r.align+"",this.sign=r.sign===void 0?"-":r.sign+"",this.symbol=r.symbol===void 0?"":r.symbol+"",this.zero=!!r.zero,this.width=r.width===void 0?void 0:+r.width,this.comma=!!r.comma,this.precision=r.precision===void 0?void 0:+r.precision,this.trim=!!r.trim,this.type=r.type===void 0?"":r.type+""}Yv.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function qz(r){e:for(var e=r.length,t=1,n=-1,i;t<e;++t)switch(r[t]){case".":n=i=t;break;case"0":n===0&&(n=t),i=t;break;default:if(!+r[t])break e;n>0&&(n=0);break}return n>0?r.slice(0,n)+r.slice(i+1):r}var Qf;function Yz(r,e){var t=Zf(r,e);if(!t)return Qf=void 0,r.toPrecision(e);var n=t[0],i=t[1],s=i-(Qf=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=n.length;return s===o?n:s>o?n+new Array(s-o+1).join("0"):s>0?n.slice(0,s)+"."+n.slice(s):"0."+new Array(1-s).join("0")+Zf(r,Math.max(0,e+s-1))[0]}function z_(r,e){var t=Zf(r,e);if(!t)return r+"";var n=t[0],i=t[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}const H_={"%":(r,e)=>(r*100).toFixed(e),b:r=>Math.round(r).toString(2),c:r=>r+"",d:zz,e:(r,e)=>r.toExponential(e),f:(r,e)=>r.toFixed(e),g:(r,e)=>r.toPrecision(e),o:r=>Math.round(r).toString(8),p:(r,e)=>z_(r*100,e),r:z_,s:Yz,X:r=>Math.round(r).toString(16).toUpperCase(),x:r=>Math.round(r).toString(16)};function W_(r){return r}var G_=Array.prototype.map,q_=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Xz(r){var e=r.grouping===void 0||r.thousands===void 0?W_:Hz(G_.call(r.grouping,Number),r.thousands+""),t=r.currency===void 0?"":r.currency[0]+"",n=r.currency===void 0?"":r.currency[1]+"",i=r.decimal===void 0?".":r.decimal+"",s=r.numerals===void 0?W_:Wz(G_.call(r.numerals,String)),o=r.percent===void 0?"%":r.percent+"",a=r.minus===void 0?"":r.minus+"",l=r.nan===void 0?"NaN":r.nan+"";function u(d,h){d=qc(d);var f=d.fill,m=d.align,p=d.sign,g=d.symbol,v=d.zero,y=d.width,b=d.comma,E=d.precision,A=d.trim,M=d.type;M==="n"?(b=!0,M="g"):H_[M]||(E===void 0&&(E=12),A=!0,M="g"),(v||f==="0"&&m==="=")&&(v=!0,f="0",m="=");var L=(h&&h.prefix!==void 0?h.prefix:"")+(g==="$"?t:g==="#"&&/[boxX]/.test(M)?"0"+M.toLowerCase():""),k=(g==="$"?n:/[%p]/.test(M)?o:"")+(h&&h.suffix!==void 0?h.suffix:""),P=H_[M],U=/[defgprs%]/.test(M);E=E===void 0?6:/[gprs]/.test(M)?Math.max(1,Math.min(21,E)):Math.max(0,Math.min(20,E));function $(V){var R=L,O=k,T,w,x;if(M==="c")O=P(V)+O,V="";else{V=+V;var _=V<0||1/V<0;if(V=isNaN(V)?l:P(Math.abs(V),E),A&&(V=qz(V)),_&&+V==0&&p!=="+"&&(_=!1),R=(_?p==="("?p:a:p==="-"||p==="("?"":p)+R,O=(M==="s"&&!isNaN(V)&&Qf!==void 0?q_[8+Qf/3]:"")+O+(_&&p==="("?")":""),U){for(T=-1,w=V.length;++T<w;)if(x=V.charCodeAt(T),48>x||x>57){O=(x===46?i+V.slice(T+1):V.slice(T))+O,V=V.slice(0,T);break}}}b&&!v&&(V=e(V,1/0));var S=R.length+V.length+O.length,C=S<y?new Array(y-S+1).join(f):"";switch(b&&v&&(V=e(C+V,C.length?y-O.length:1/0),C=""),m){case"<":V=R+V+O+C;break;case"=":V=R+C+V+O;break;case"^":V=C.slice(0,S=C.length>>1)+R+V+O+C.slice(S);break;default:V=C+R+V+O;break}return s(V)}return $.toString=function(){return d+""},$}function c(d,h){var f=Math.max(-8,Math.min(8,Math.floor(fu(h)/3)))*3,m=Math.pow(10,-f),p=u((d=qc(d),d.type="f",d),{suffix:q_[8+f/3]});return function(g){return p(m*g)}}return{format:u,formatPrefix:c}}var nd,Xv,xC;Kz({thousands:",",grouping:[3],currency:["$",""]});function Kz(r){return nd=Xz(r),Xv=nd.format,xC=nd.formatPrefix,nd}function Zz(r){return Math.max(0,-fu(Math.abs(r)))}function Qz(r,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(fu(e)/3)))*3-fu(Math.abs(r)))}function Jz(r,e){return r=Math.abs(r),e=Math.abs(e)-r,Math.max(0,fu(e)-fu(r))+1}function eH(r,e,t,n){var i=E0(r,e,t),s;switch(n=qc(n??",f"),n.type){case"s":{var o=Math.max(Math.abs(r),Math.abs(e));return n.precision==null&&!isNaN(s=Qz(i,o))&&(n.precision=s),xC(n,o)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(s=Jz(i,Math.max(Math.abs(r),Math.abs(e))))&&(n.precision=s-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(s=Zz(i))&&(n.precision=s-(n.type==="%")*2);break}}return Xv(n)}function dl(r){var e=r.domain;return r.ticks=function(t){var n=e();return _0(n[0],n[n.length-1],t??10)},r.tickFormat=function(t,n){var i=e();return eH(i[0],i[i.length-1],t??10,n)},r.nice=function(t){t==null&&(t=10);var n=e(),i=0,s=n.length-1,o=n[i],a=n[s],l,u,c=10;for(a<o&&(u=o,o=a,a=u,u=i,i=s,s=u);c-- >0;){if(u=x0(o,a,t),u===l)return n[i]=o,n[s]=a,e(n);if(u>0)o=Math.floor(o/u)*u,a=Math.ceil(a/u)*u;else if(u<0)o=Math.ceil(o*u)/u,a=Math.floor(a*u)/u;else break;l=u}return r},r}function EC(){var r=_C();return r.copy=function(){return ch(r,EC())},ys.apply(r,arguments),dl(r)}function SC(r){var e;function t(n){return n==null||isNaN(n=+n)?e:n}return t.invert=t,t.domain=t.range=function(n){return arguments.length?(r=Array.from(n,B0),t):r.slice()},t.unknown=function(n){return arguments.length?(e=n,t):e},t.copy=function(){return SC(r).unknown(e)},r=arguments.length?Array.from(r,B0):[0,1],dl(t)}function TC(r,e){r=r.slice();var t=0,n=r.length-1,i=r[t],s=r[n],o;return s<i&&(o=t,t=n,n=o,o=i,i=s,s=o),r[t]=e.floor(i),r[n]=e.ceil(s),r}function Y_(r){return Math.log(r)}function X_(r){return Math.exp(r)}function tH(r){return-Math.log(-r)}function rH(r){return-Math.exp(-r)}function nH(r){return isFinite(r)?+("1e"+r):r<0?0:r}function iH(r){return r===10?nH:r===Math.E?Math.exp:e=>Math.pow(r,e)}function sH(r){return r===Math.E?Math.log:r===10&&Math.log10||r===2&&Math.log2||(r=Math.log(r),e=>Math.log(e)/r)}function K_(r){return(e,t)=>-r(-e,t)}function oH(r){const e=r(Y_,X_),t=e.domain;let n=10,i,s;function o(){return i=sH(n),s=iH(n),t()[0]<0?(i=K_(i),s=K_(s),r(tH,rH)):r(Y_,X_),e}return e.base=function(a){return arguments.length?(n=+a,o()):n},e.domain=function(a){return arguments.length?(t(a),o()):t()},e.ticks=a=>{const l=t();let u=l[0],c=l[l.length-1];const d=c<u;d&&([u,c]=[c,u]);let h=i(u),f=i(c),m,p;const g=a==null?10:+a;let v=[];if(!(n%1)&&f-h<g){if(h=Math.floor(h),f=Math.ceil(f),u>0){for(;h<=f;++h)for(m=1;m<n;++m)if(p=h<0?m/s(-h):m*s(h),!(p<u)){if(p>c)break;v.push(p)}}else for(;h<=f;++h)for(m=n-1;m>=1;--m)if(p=h>0?m/s(-h):m*s(h),!(p<u)){if(p>c)break;v.push(p)}v.length*2<g&&(v=_0(u,c,g))}else v=_0(h,f,Math.min(f-h,g)).map(s);return d?v.reverse():v},e.tickFormat=(a,l)=>{if(a==null&&(a=10),l==null&&(l=n===10?"s":","),typeof l!="function"&&(!(n%1)&&(l=qc(l)).precision==null&&(l.trim=!0),l=Xv(l)),a===1/0)return l;const u=Math.max(1,n*a/e.ticks().length);return c=>{let d=c/s(Math.round(i(c)));return d*n<n-.5&&(d*=n),d<=u?l(c):""}},e.nice=()=>t(TC(t(),{floor:a=>s(Math.floor(i(a))),ceil:a=>s(Math.ceil(i(a)))})),e}function RC(){const r=oH(rm()).domain([1,10]);return r.copy=()=>ch(r,RC()).base(r.base()),ys.apply(r,arguments),r}function Z_(r){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/r))}}function Q_(r){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*r}}function aH(r){var e=1,t=r(Z_(e),Q_(e));return t.constant=function(n){return arguments.length?r(Z_(e=+n),Q_(e)):e},dl(t)}function AC(){var r=aH(rm());return r.copy=function(){return ch(r,AC()).constant(r.constant())},ys.apply(r,arguments)}function J_(r){return function(e){return e<0?-Math.pow(-e,r):Math.pow(e,r)}}function lH(r){return r<0?-Math.sqrt(-r):Math.sqrt(r)}function uH(r){return r<0?-r*r:r*r}function cH(r){var e=r(ai,ai),t=1;function n(){return t===1?r(ai,ai):t===.5?r(lH,uH):r(J_(t),J_(1/t))}return e.exponent=function(i){return arguments.length?(t=+i,n()):t},dl(e)}function Kv(){var r=cH(rm());return r.copy=function(){return ch(r,Kv()).exponent(r.exponent())},ys.apply(r,arguments),r}function hH(){return Kv.apply(null,arguments).exponent(.5)}function CC(){var r=[],e=[],t=[],n;function i(){var o=0,a=Math.max(1,e.length);for(t=new Array(a-1);++o<a;)t[o-1]=xV(r,o/a);return s}function s(o){return o==null||isNaN(o=+o)?n:e[ah(t,o)]}return s.invertExtent=function(o){var a=e.indexOf(o);return a<0?[NaN,NaN]:[a>0?t[a-1]:r[0],a<t.length?t[a]:r[r.length-1]]},s.domain=function(o){if(!arguments.length)return r.slice();r=[];for(let a of o)a!=null&&!isNaN(a=+a)&&r.push(a);return r.sort(pc),i()},s.range=function(o){return arguments.length?(e=Array.from(o),i()):e.slice()},s.unknown=function(o){return arguments.length?(n=o,s):n},s.quantiles=function(){return t.slice()},s.copy=function(){return CC().domain(r).range(e).unknown(n)},ys.apply(s,arguments)}function NC(){var r=0,e=1,t=1,n=[.5],i=[0,1],s;function o(l){return l!=null&&l<=l?i[ah(n,l,0,t)]:s}function a(){var l=-1;for(n=new Array(t);++l<t;)n[l]=((l+1)*e-(l-t)*r)/(t+1);return o}return o.domain=function(l){return arguments.length?([r,e]=l,r=+r,e=+e,a()):[r,e]},o.range=function(l){return arguments.length?(t=(i=Array.from(l)).length-1,a()):i.slice()},o.invertExtent=function(l){var u=i.indexOf(l);return u<0?[NaN,NaN]:u<1?[r,n[0]]:u>=t?[n[t-1],e]:[n[u-1],n[u]]},o.unknown=function(l){return arguments.length&&(s=l),o},o.thresholds=function(){return n.slice()},o.copy=function(){return NC().domain([r,e]).range(i).unknown(s)},ys.apply(dl(o),arguments)}function MC(){var r=[.5],e=[0,1],t,n=1;function i(s){return s!=null&&s<=s?e[ah(r,s,0,n)]:t}return i.domain=function(s){return arguments.length?(r=Array.from(s),n=Math.min(r.length,e.length-1),i):r.slice()},i.range=function(s){return arguments.length?(e=Array.from(s),n=Math.min(r.length,e.length-1),i):e.slice()},i.invertExtent=function(s){var o=e.indexOf(s);return[r[o-1],r[o]]},i.unknown=function(s){return arguments.length?(t=s,i):t},i.copy=function(){return MC().domain(r).range(e).unknown(t)},ys.apply(i,arguments)}const sg=new Date,og=new Date;function cn(r,e,t,n){function i(s){return r(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=s=>(r(s=new Date(+s)),s),i.ceil=s=>(r(s=new Date(s-1)),e(s,1),r(s),s),i.round=s=>{const o=i(s),a=i.ceil(s);return s-o<a-s?o:a},i.offset=(s,o)=>(e(s=new Date(+s),o==null?1:Math.floor(o)),s),i.range=(s,o,a)=>{const l=[];if(s=i.ceil(s),a=a==null?1:Math.floor(a),!(s<o)||!(a>0))return l;let u;do l.push(u=new Date(+s)),e(s,a),r(s);while(u<s&&s<o);return l},i.filter=s=>cn(o=>{if(o>=o)for(;r(o),!s(o);)o.setTime(o-1)},(o,a)=>{if(o>=o)if(a<0)for(;++a<=0;)for(;e(o,-1),!s(o););else for(;--a>=0;)for(;e(o,1),!s(o););}),t&&(i.count=(s,o)=>(sg.setTime(+s),og.setTime(+o),r(sg),r(og),Math.floor(t(sg,og))),i.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(n?o=>n(o)%s===0:o=>i.count(0,o)%s===0):i)),i}const Jf=cn(()=>{},(r,e)=>{r.setTime(+r+e)},(r,e)=>e-r);Jf.every=r=>(r=Math.floor(r),!isFinite(r)||!(r>0)?null:r>1?cn(e=>{e.setTime(Math.floor(e/r)*r)},(e,t)=>{e.setTime(+e+t*r)},(e,t)=>(t-e)/r):Jf);Jf.range;const yo=1e3,Di=yo*60,vo=Di*60,Mo=vo*24,Zv=Mo*7,e2=Mo*30,ag=Mo*365,ja=cn(r=>{r.setTime(r-r.getMilliseconds())},(r,e)=>{r.setTime(+r+e*yo)},(r,e)=>(e-r)/yo,r=>r.getUTCSeconds());ja.range;const Qv=cn(r=>{r.setTime(r-r.getMilliseconds()-r.getSeconds()*yo)},(r,e)=>{r.setTime(+r+e*Di)},(r,e)=>(e-r)/Di,r=>r.getMinutes());Qv.range;const Jv=cn(r=>{r.setUTCSeconds(0,0)},(r,e)=>{r.setTime(+r+e*Di)},(r,e)=>(e-r)/Di,r=>r.getUTCMinutes());Jv.range;const eb=cn(r=>{r.setTime(r-r.getMilliseconds()-r.getSeconds()*yo-r.getMinutes()*Di)},(r,e)=>{r.setTime(+r+e*vo)},(r,e)=>(e-r)/vo,r=>r.getHours());eb.range;const tb=cn(r=>{r.setUTCMinutes(0,0,0)},(r,e)=>{r.setTime(+r+e*vo)},(r,e)=>(e-r)/vo,r=>r.getUTCHours());tb.range;const hh=cn(r=>r.setHours(0,0,0,0),(r,e)=>r.setDate(r.getDate()+e),(r,e)=>(e-r-(e.getTimezoneOffset()-r.getTimezoneOffset())*Di)/Mo,r=>r.getDate()-1);hh.range;const nm=cn(r=>{r.setUTCHours(0,0,0,0)},(r,e)=>{r.setUTCDate(r.getUTCDate()+e)},(r,e)=>(e-r)/Mo,r=>r.getUTCDate()-1);nm.range;const OC=cn(r=>{r.setUTCHours(0,0,0,0)},(r,e)=>{r.setUTCDate(r.getUTCDate()+e)},(r,e)=>(e-r)/Mo,r=>Math.floor(r/Mo));OC.range;function fl(r){return cn(e=>{e.setDate(e.getDate()-(e.getDay()+7-r)%7),e.setHours(0,0,0,0)},(e,t)=>{e.setDate(e.getDate()+t*7)},(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Di)/Zv)}const im=fl(0),ep=fl(1),dH=fl(2),fH=fl(3),pu=fl(4),pH=fl(5),mH=fl(6);im.range;ep.range;dH.range;fH.range;pu.range;pH.range;mH.range;function pl(r){return cn(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-r)%7),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t*7)},(e,t)=>(t-e)/Zv)}const sm=pl(0),tp=pl(1),gH=pl(2),yH=pl(3),mu=pl(4),vH=pl(5),bH=pl(6);sm.range;tp.range;gH.range;yH.range;mu.range;vH.range;bH.range;const rb=cn(r=>{r.setDate(1),r.setHours(0,0,0,0)},(r,e)=>{r.setMonth(r.getMonth()+e)},(r,e)=>e.getMonth()-r.getMonth()+(e.getFullYear()-r.getFullYear())*12,r=>r.getMonth());rb.range;const nb=cn(r=>{r.setUTCDate(1),r.setUTCHours(0,0,0,0)},(r,e)=>{r.setUTCMonth(r.getUTCMonth()+e)},(r,e)=>e.getUTCMonth()-r.getUTCMonth()+(e.getUTCFullYear()-r.getUTCFullYear())*12,r=>r.getUTCMonth());nb.range;const Oo=cn(r=>{r.setMonth(0,1),r.setHours(0,0,0,0)},(r,e)=>{r.setFullYear(r.getFullYear()+e)},(r,e)=>e.getFullYear()-r.getFullYear(),r=>r.getFullYear());Oo.every=r=>!isFinite(r=Math.floor(r))||!(r>0)?null:cn(e=>{e.setFullYear(Math.floor(e.getFullYear()/r)*r),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t*r)});Oo.range;const Io=cn(r=>{r.setUTCMonth(0,1),r.setUTCHours(0,0,0,0)},(r,e)=>{r.setUTCFullYear(r.getUTCFullYear()+e)},(r,e)=>e.getUTCFullYear()-r.getUTCFullYear(),r=>r.getUTCFullYear());Io.every=r=>!isFinite(r=Math.floor(r))||!(r>0)?null:cn(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/r)*r),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t*r)});Io.range;function IC(r,e,t,n,i,s){const o=[[ja,1,yo],[ja,5,5*yo],[ja,15,15*yo],[ja,30,30*yo],[s,1,Di],[s,5,5*Di],[s,15,15*Di],[s,30,30*Di],[i,1,vo],[i,3,3*vo],[i,6,6*vo],[i,12,12*vo],[n,1,Mo],[n,2,2*Mo],[t,1,Zv],[e,1,e2],[e,3,3*e2],[r,1,ag]];function a(u,c,d){const h=c<u;h&&([u,c]=[c,u]);const f=d&&typeof d.range=="function"?d:l(u,c,d),m=f?f.range(u,+c+1):[];return h?m.reverse():m}function l(u,c,d){const h=Math.abs(c-u)/d,f=Mv(([,,g])=>g).right(o,h);if(f===o.length)return r.every(E0(u/ag,c/ag,d));if(f===0)return Jf.every(Math.max(E0(u,c,d),1));const[m,p]=o[h/o[f-1][2]<o[f][2]/h?f-1:f];return m.every(p)}return[a,l]}const[wH,_H]=IC(Io,nb,sm,OC,tb,Jv),[xH,EH]=IC(Oo,rb,im,hh,eb,Qv);function lg(r){if(0<=r.y&&r.y<100){var e=new Date(-1,r.m,r.d,r.H,r.M,r.S,r.L);return e.setFullYear(r.y),e}return new Date(r.y,r.m,r.d,r.H,r.M,r.S,r.L)}function ug(r){if(0<=r.y&&r.y<100){var e=new Date(Date.UTC(-1,r.m,r.d,r.H,r.M,r.S,r.L));return e.setUTCFullYear(r.y),e}return new Date(Date.UTC(r.y,r.m,r.d,r.H,r.M,r.S,r.L))}function ku(r,e,t){return{y:r,m:e,d:t,H:0,M:0,S:0,L:0}}function SH(r){var e=r.dateTime,t=r.date,n=r.time,i=r.periods,s=r.days,o=r.shortDays,a=r.months,l=r.shortMonths,u=Pu(i),c=Fu(i),d=Pu(s),h=Fu(s),f=Pu(o),m=Fu(o),p=Pu(a),g=Fu(a),v=Pu(l),y=Fu(l),b={a:x,A:_,b:S,B:C,c:null,d:o2,e:o2,f:qH,g:nW,G:sW,H:HH,I:WH,j:GH,L:kC,m:YH,M:XH,p:F,q:D,Q:u2,s:c2,S:KH,u:ZH,U:QH,V:JH,w:eW,W:tW,x:null,X:null,y:rW,Y:iW,Z:oW,"%":l2},E={a:H,A:G,b:ee,B,c:null,d:a2,e:a2,f:cW,g:wW,G:xW,H:aW,I:lW,j:uW,L:FC,m:hW,M:dW,p:X,q:I,Q:u2,s:c2,S:fW,u:pW,U:mW,V:gW,w:yW,W:vW,x:null,X:null,y:bW,Y:_W,Z:EW,"%":l2},A={a:U,A:$,b:V,B:R,c:O,d:i2,e:i2,f:VH,g:n2,G:r2,H:s2,I:s2,j:LH,L:UH,m:FH,M:DH,p:P,q:PH,Q:$H,s:zH,S:BH,u:NH,U:MH,V:OH,w:CH,W:IH,x:T,X:w,y:n2,Y:r2,Z:kH,"%":jH};b.x=M(t,b),b.X=M(n,b),b.c=M(e,b),E.x=M(t,E),E.X=M(n,E),E.c=M(e,E);function M(N,j){return function(Q){var W=[],Y=-1,Z=0,se=N.length,re,K,ie;for(Q instanceof Date||(Q=new Date(+Q));++Y<se;)N.charCodeAt(Y)===37&&(W.push(N.slice(Z,Y)),(K=t2[re=N.charAt(++Y)])!=null?re=N.charAt(++Y):K=re==="e"?" ":"0",(ie=j[re])&&(re=ie(Q,K)),W.push(re),Z=Y+1);return W.push(N.slice(Z,Y)),W.join("")}}function L(N,j){return function(Q){var W=ku(1900,void 0,1),Y=k(W,N,Q+="",0),Z,se;if(Y!=Q.length)return null;if("Q"in W)return new Date(W.Q);if("s"in W)return new Date(W.s*1e3+("L"in W?W.L:0));if(j&&!("Z"in W)&&(W.Z=0),"p"in W&&(W.H=W.H%12+W.p*12),W.m===void 0&&(W.m="q"in W?W.q:0),"V"in W){if(W.V<1||W.V>53)return null;"w"in W||(W.w=1),"Z"in W?(Z=ug(ku(W.y,0,1)),se=Z.getUTCDay(),Z=se>4||se===0?tp.ceil(Z):tp(Z),Z=nm.offset(Z,(W.V-1)*7),W.y=Z.getUTCFullYear(),W.m=Z.getUTCMonth(),W.d=Z.getUTCDate()+(W.w+6)%7):(Z=lg(ku(W.y,0,1)),se=Z.getDay(),Z=se>4||se===0?ep.ceil(Z):ep(Z),Z=hh.offset(Z,(W.V-1)*7),W.y=Z.getFullYear(),W.m=Z.getMonth(),W.d=Z.getDate()+(W.w+6)%7)}else("W"in W||"U"in W)&&("w"in W||(W.w="u"in W?W.u%7:"W"in W?1:0),se="Z"in W?ug(ku(W.y,0,1)).getUTCDay():lg(ku(W.y,0,1)).getDay(),W.m=0,W.d="W"in W?(W.w+6)%7+W.W*7-(se+5)%7:W.w+W.U*7-(se+6)%7);return"Z"in W?(W.H+=W.Z/100|0,W.M+=W.Z%100,ug(W)):lg(W)}}function k(N,j,Q,W){for(var Y=0,Z=j.length,se=Q.length,re,K;Y<Z;){if(W>=se)return-1;if(re=j.charCodeAt(Y++),re===37){if(re=j.charAt(Y++),K=A[re in t2?j.charAt(Y++):re],!K||(W=K(N,Q,W))<0)return-1}else if(re!=Q.charCodeAt(W++))return-1}return W}function P(N,j,Q){var W=u.exec(j.slice(Q));return W?(N.p=c.get(W[0].toLowerCase()),Q+W[0].length):-1}function U(N,j,Q){var W=f.exec(j.slice(Q));return W?(N.w=m.get(W[0].toLowerCase()),Q+W[0].length):-1}function $(N,j,Q){var W=d.exec(j.slice(Q));return W?(N.w=h.get(W[0].toLowerCase()),Q+W[0].length):-1}function V(N,j,Q){var W=v.exec(j.slice(Q));return W?(N.m=y.get(W[0].toLowerCase()),Q+W[0].length):-1}function R(N,j,Q){var W=p.exec(j.slice(Q));return W?(N.m=g.get(W[0].toLowerCase()),Q+W[0].length):-1}function O(N,j,Q){return k(N,e,j,Q)}function T(N,j,Q){return k(N,t,j,Q)}function w(N,j,Q){return k(N,n,j,Q)}function x(N){return o[N.getDay()]}function _(N){return s[N.getDay()]}function S(N){return l[N.getMonth()]}function C(N){return a[N.getMonth()]}function F(N){return i[+(N.getHours()>=12)]}function D(N){return 1+~~(N.getMonth()/3)}function H(N){return o[N.getUTCDay()]}function G(N){return s[N.getUTCDay()]}function ee(N){return l[N.getUTCMonth()]}function B(N){return a[N.getUTCMonth()]}function X(N){return i[+(N.getUTCHours()>=12)]}function I(N){return 1+~~(N.getUTCMonth()/3)}return{format:function(N){var j=M(N+="",b);return j.toString=function(){return N},j},parse:function(N){var j=L(N+="",!1);return j.toString=function(){return N},j},utcFormat:function(N){var j=M(N+="",E);return j.toString=function(){return N},j},utcParse:function(N){var j=L(N+="",!0);return j.toString=function(){return N},j}}}var t2={"-":"",_:" ",0:"0"},vn=/^\s*\d+/,TH=/^%/,RH=/[\\^$*+?|[\]().{}]/g;function nr(r,e,t){var n=r<0?"-":"",i=(n?-r:r)+"",s=i.length;return n+(s<t?new Array(t-s+1).join(e)+i:i)}function AH(r){return r.replace(RH,"\\$&")}function Pu(r){return new RegExp("^(?:"+r.map(AH).join("|")+")","i")}function Fu(r){return new Map(r.map((e,t)=>[e.toLowerCase(),t]))}function CH(r,e,t){var n=vn.exec(e.slice(t,t+1));return n?(r.w=+n[0],t+n[0].length):-1}function NH(r,e,t){var n=vn.exec(e.slice(t,t+1));return n?(r.u=+n[0],t+n[0].length):-1}function MH(r,e,t){var n=vn.exec(e.slice(t,t+2));return n?(r.U=+n[0],t+n[0].length):-1}function OH(r,e,t){var n=vn.exec(e.slice(t,t+2));return n?(r.V=+n[0],t+n[0].length):-1}function IH(r,e,t){var n=vn.exec(e.slice(t,t+2));return n?(r.W=+n[0],t+n[0].length):-1}function r2(r,e,t){var n=vn.exec(e.slice(t,t+4));return n?(r.y=+n[0],t+n[0].length):-1}function n2(r,e,t){var n=vn.exec(e.slice(t,t+2));return n?(r.y=+n[0]+(+n[0]>68?1900:2e3),t+n[0].length):-1}function kH(r,e,t){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(t,t+6));return n?(r.Z=n[1]?0:-(n[2]+(n[3]||"00")),t+n[0].length):-1}function PH(r,e,t){var n=vn.exec(e.slice(t,t+1));return n?(r.q=n[0]*3-3,t+n[0].length):-1}function FH(r,e,t){var n=vn.exec(e.slice(t,t+2));return n?(r.m=n[0]-1,t+n[0].length):-1}function i2(r,e,t){var n=vn.exec(e.slice(t,t+2));return n?(r.d=+n[0],t+n[0].length):-1}function LH(r,e,t){var n=vn.exec(e.slice(t,t+3));return n?(r.m=0,r.d=+n[0],t+n[0].length):-1}function s2(r,e,t){var n=vn.exec(e.slice(t,t+2));return n?(r.H=+n[0],t+n[0].length):-1}function DH(r,e,t){var n=vn.exec(e.slice(t,t+2));return n?(r.M=+n[0],t+n[0].length):-1}function BH(r,e,t){var n=vn.exec(e.slice(t,t+2));return n?(r.S=+n[0],t+n[0].length):-1}function UH(r,e,t){var n=vn.exec(e.slice(t,t+3));return n?(r.L=+n[0],t+n[0].length):-1}function VH(r,e,t){var n=vn.exec(e.slice(t,t+6));return n?(r.L=Math.floor(n[0]/1e3),t+n[0].length):-1}function jH(r,e,t){var n=TH.exec(e.slice(t,t+1));return n?t+n[0].length:-1}function $H(r,e,t){var n=vn.exec(e.slice(t));return n?(r.Q=+n[0],t+n[0].length):-1}function zH(r,e,t){var n=vn.exec(e.slice(t));return n?(r.s=+n[0],t+n[0].length):-1}function o2(r,e){return nr(r.getDate(),e,2)}function HH(r,e){return nr(r.getHours(),e,2)}function WH(r,e){return nr(r.getHours()%12||12,e,2)}function GH(r,e){return nr(1+hh.count(Oo(r),r),e,3)}function kC(r,e){return nr(r.getMilliseconds(),e,3)}function qH(r,e){return kC(r,e)+"000"}function YH(r,e){return nr(r.getMonth()+1,e,2)}function XH(r,e){return nr(r.getMinutes(),e,2)}function KH(r,e){return nr(r.getSeconds(),e,2)}function ZH(r){var e=r.getDay();return e===0?7:e}function QH(r,e){return nr(im.count(Oo(r)-1,r),e,2)}function PC(r){var e=r.getDay();return e>=4||e===0?pu(r):pu.ceil(r)}function JH(r,e){return r=PC(r),nr(pu.count(Oo(r),r)+(Oo(r).getDay()===4),e,2)}function eW(r){return r.getDay()}function tW(r,e){return nr(ep.count(Oo(r)-1,r),e,2)}function rW(r,e){return nr(r.getFullYear()%100,e,2)}function nW(r,e){return r=PC(r),nr(r.getFullYear()%100,e,2)}function iW(r,e){return nr(r.getFullYear()%1e4,e,4)}function sW(r,e){var t=r.getDay();return r=t>=4||t===0?pu(r):pu.ceil(r),nr(r.getFullYear()%1e4,e,4)}function oW(r){var e=r.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+nr(e/60|0,"0",2)+nr(e%60,"0",2)}function a2(r,e){return nr(r.getUTCDate(),e,2)}function aW(r,e){return nr(r.getUTCHours(),e,2)}function lW(r,e){return nr(r.getUTCHours()%12||12,e,2)}function uW(r,e){return nr(1+nm.count(Io(r),r),e,3)}function FC(r,e){return nr(r.getUTCMilliseconds(),e,3)}function cW(r,e){return FC(r,e)+"000"}function hW(r,e){return nr(r.getUTCMonth()+1,e,2)}function dW(r,e){return nr(r.getUTCMinutes(),e,2)}function fW(r,e){return nr(r.getUTCSeconds(),e,2)}function pW(r){var e=r.getUTCDay();return e===0?7:e}function mW(r,e){return nr(sm.count(Io(r)-1,r),e,2)}function LC(r){var e=r.getUTCDay();return e>=4||e===0?mu(r):mu.ceil(r)}function gW(r,e){return r=LC(r),nr(mu.count(Io(r),r)+(Io(r).getUTCDay()===4),e,2)}function yW(r){return r.getUTCDay()}function vW(r,e){return nr(tp.count(Io(r)-1,r),e,2)}function bW(r,e){return nr(r.getUTCFullYear()%100,e,2)}function wW(r,e){return r=LC(r),nr(r.getUTCFullYear()%100,e,2)}function _W(r,e){return nr(r.getUTCFullYear()%1e4,e,4)}function xW(r,e){var t=r.getUTCDay();return r=t>=4||t===0?mu(r):mu.ceil(r),nr(r.getUTCFullYear()%1e4,e,4)}function EW(){return"+0000"}function l2(){return"%"}function u2(r){return+r}function c2(r){return Math.floor(+r/1e3)}var Cl,DC,BC;SW({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function SW(r){return Cl=SH(r),DC=Cl.format,Cl.parse,BC=Cl.utcFormat,Cl.utcParse,Cl}function TW(r){return new Date(r)}function RW(r){return r instanceof Date?+r:+new Date(+r)}function ib(r,e,t,n,i,s,o,a,l,u){var c=_C(),d=c.invert,h=c.domain,f=u(".%L"),m=u(":%S"),p=u("%I:%M"),g=u("%I %p"),v=u("%a %d"),y=u("%b %d"),b=u("%B"),E=u("%Y");function A(M){return(l(M)<M?f:a(M)<M?m:o(M)<M?p:s(M)<M?g:n(M)<M?i(M)<M?v:y:t(M)<M?b:E)(M)}return c.invert=function(M){return new Date(d(M))},c.domain=function(M){return arguments.length?h(Array.from(M,RW)):h().map(TW)},c.ticks=function(M){var L=h();return r(L[0],L[L.length-1],M??10)},c.tickFormat=function(M,L){return L==null?A:u(L)},c.nice=function(M){var L=h();return(!M||typeof M.range!="function")&&(M=e(L[0],L[L.length-1],M??10)),M?h(TC(L,M)):c},c.copy=function(){return ch(c,ib(r,e,t,n,i,s,o,a,l,u))},c}function AW(){return ys.apply(ib(xH,EH,Oo,rb,im,hh,eb,Qv,ja,DC).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function CW(){return ys.apply(ib(wH,_H,Io,nb,sm,nm,tb,Jv,ja,BC).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function NW(){var r=0,e=1,t,n,i,s,o=ai,a=!1,l;function u(d){return d==null||isNaN(d=+d)?l:o(i===0?.5:(d=(s(d)-t)*i,a?Math.max(0,Math.min(1,d)):d))}u.domain=function(d){return arguments.length?([r,e]=d,t=s(r=+r),n=s(e=+e),i=t===n?0:1/(n-t),u):[r,e]},u.clamp=function(d){return arguments.length?(a=!!d,u):a},u.interpolator=function(d){return arguments.length?(o=d,u):o};function c(d){return function(h){var f,m;return arguments.length?([f,m]=h,o=d(f,m),u):[o(0),o(1)]}}return u.range=c(hl),u.rangeRound=c(Hv),u.unknown=function(d){return arguments.length?(l=d,u):l},function(d){return s=d,t=d(r),n=d(e),i=t===n?0:1/(n-t),u}}function UC(r,e){return e.domain(r.domain()).interpolator(r.interpolator()).clamp(r.clamp()).unknown(r.unknown())}function VC(){var r=dl(NW()(ai));return r.copy=function(){return UC(r,VC())},bC.apply(r,arguments)}function MW(){var r=0,e=.5,t=1,n=1,i,s,o,a,l,u=ai,c,d=!1,h;function f(p){return isNaN(p=+p)?h:(p=.5+((p=+c(p))-s)*(n*p<n*s?a:l),u(d?Math.max(0,Math.min(1,p)):p))}f.domain=function(p){return arguments.length?([r,e,t]=p,i=c(r=+r),s=c(e=+e),o=c(t=+t),a=i===s?0:.5/(s-i),l=s===o?0:.5/(o-s),n=s<i?-1:1,f):[r,e,t]},f.clamp=function(p){return arguments.length?(d=!!p,f):d},f.interpolator=function(p){return arguments.length?(u=p,f):u};function m(p){return function(g){var v,y,b;return arguments.length?([v,y,b]=g,u=I$(p,[v,y,b]),f):[u(0),u(.5),u(1)]}}return f.range=m(hl),f.rangeRound=m(Hv),f.unknown=function(p){return arguments.length?(h=p,f):h},function(p){return c=p,i=p(r),s=p(e),o=p(t),a=i===s?0:.5/(s-i),l=s===o?0:.5/(o-s),n=s<i?-1:1,f}}function jC(){var r=dl(MW()(ai));return r.copy=function(){return UC(r,jC())},bC.apply(r,arguments)}const h2={scaleLinear:EC,scalePow:Kv,scaleSqrt:hH,scaleLog:RC,scaleSymlog:AC,scaleIdentity:SC,scaleTime:AW,scaleUtc:CW,scaleSequential:VC,scaleDiverging:jC,scaleQuantize:NC,scaleQuantile:CC,scaleThreshold:MC,scaleOrdinal:qv,scaleBand:tm,scalePoint:Bz};var Gr;(function(r){r.X="x",r.Y="y"})(Gr||(Gr={}));var ss;(function(r){r.West="west",r.East="east",r.North="north",r.South="south"})(ss||(ss={}));const OW=Object.assign(Object.assign({},Pv),{components:[],tooltip:void 0,crosshair:void 0,annotations:void 0,xAxis:void 0,yAxis:void 0,autoMargin:!0,xScale:void 0,xDomain:void 0,xDomainMinConstraint:void 0,xDomainMaxConstraint:void 0,xRange:void 0,yScale:void 0,yDomain:void 0,yDomainMinConstraint:void 0,yDomainMaxConstraint:void 0,yRange:void 0,yDirection:ss.North,preventEmptyDomain:null,scaleByDomain:!1,clipPathExtend:2});class IW extends cu{constructor(e,t,n){var i,s;super(e),this._defaultConfig=OW,this.datamodel=new Gv,this.config=this._defaultConfig,this._clipPathId=eC(),this._axisMargin={top:0,bottom:0,left:0,right:0},this._firstRender=!0,this._clipPath=this.svg.append("clipPath").attr("id",this._clipPathId),this._clipPath.append("rect");const o="saturate",a=window.location.href.replace(window.location.hash,"");this.svg.attr("class",Pt`
      --highlight-filter-id: url(${a}#${o}); // defining a css variable
    `),this._svgDefs.append("filter").attr("id",o).attr("filterUnits","objectBoundingBox").html('<feColorMatrix type="saturate" in="SourceGraphic" values="1.35"/>'),t&&this.updateContainer(t,!0),n&&this.setData(n,!0),(this.config.xAxis||this.config.yAxis||!((i=this.components)===null||i===void 0)&&i.some(l=>l.datamodel.data))&&this.render(),(s=document.fonts)===null||s===void 0||s.ready.then(()=>{this._firstRender||this._renderAxes(0)})}get components(){return this.config.components}get width(){const e=this._getMargin();return ks(this.containerWidth-e.left-e.right,0,Number.POSITIVE_INFINITY)}get height(){const e=this._getMargin();return ks(this.containerHeight-e.top-e.bottom,0,Number.POSITIVE_INFINITY)}setData(e,t){var n,i,s,o,a;const{components:l,config:u}=this;if(!e)return;this.datamodel.data=e,l.forEach(d=>{d.setData(e)}),(n=u.crosshair)===null||n===void 0||n.setData(e),(i=u.xAxis)===null||i===void 0||i.setData(e),(s=u.yAxis)===null||s===void 0||s.setData(e),!rl(this.datamodel.data,e)&&((o=u.tooltip)===null||o===void 0||o.hide(),(a=u.crosshair)===null||a===void 0||a.hide()),t||this.render()}updateContainer(e,t){super.updateContainer(e),this._removeAllChildren(),this.setData(this.datamodel.data,!0),e.xAxis&&(this.config.xAxis.config.type=tr.X,this.element.appendChild(e.xAxis.element)),e.yAxis&&(this.config.yAxis.config.type=tr.Y,this.element.appendChild(e.yAxis.element));for(const o of this.components)this.element.appendChild(o.element);const n=e.tooltip;n&&(n.hasContainer()||n.setContainer(this._container),n.setComponents(this.components));const i=e.crosshair;i&&(i.setContainer(this.svg),i.tooltip=n,this.element.appendChild(i.element));const s=e.annotations;s&&this.element.appendChild(s.element),this.element.appendChild(this._clipPath.node()),this.element.appendChild(this._svgDefs.node()),this.element.appendChild(this._svgDefsExternal.node()),t||this.render()}updateComponents(e,t){const{config:n}=this;this.components.forEach((i,s)=>{e[s]&&i.setConfig(e[s])}),this._updateScales(...this.components,n.xAxis,n.yAxis,n.crosshair),t||this.render()}update(e,t,n){n&&(this.datamodel.data=n),e&&this.updateContainer(e,!0),t&&this.updateComponents(t,!0),this.render()}_preRender(){const{config:e}=this;super._preRender(),e.autoMargin&&this._setAutoMargin();const t=Mu([...this.components,e.xAxis,e.yAxis,e.crosshair,e.annotations]),n=this._getMargin();for(const i of t)i.setSize(this.width,this.height,this.containerWidth,this.containerHeight),i.setContainerMargin(n);this._updateScales(...this.components,e.xAxis,e.yAxis,e.crosshair)}_render(e){var t,n,i,s,o;const{config:a}=this;super._render();const l=this._getMargin();for(const d of this.components)d.g.attr("transform",`translate(${l.left},${l.top})`).style("clip-path",d.clippable?`url(#${this._clipPathId})`:null).style("-webkit-clip-path",d.clippable?`url(#${this._clipPathId})`:null),d.render(e);this._renderAxes(this._firstRender?0:e);const u=a.clipPathExtend;this._clipPath.select("rect").attr("x",-u).attr("y",-u).attr("width",this.width+2*u).attr("height",this.height+2*u),(t=a.tooltip)===null||t===void 0||t.update();const c=a.crosshair;if(c){const d=this.components.filter(p=>!p.stacked).map(p=>p.config.y),h=this.components.filter(p=>p.stacked).map(p=>p.config.y),f=(n=this.components.find(p=>p.config.baseline))===null||n===void 0?void 0:n.config,m=f?.baseline;c.accessors={x:(i=this.components[0])===null||i===void 0?void 0:i.config.x,y:T0(d),yStacked:T0(h),baseline:m},c.g.attr("transform",`translate(${l.left},${l.top})`).style("clip-path",`url(#${this._clipPathId})`).style("-webkit-clip-path",`url(#${this._clipPathId})`),c.render()}(s=a.annotations)===null||s===void 0||s.g.attr("transform",`translate(${l.left},${l.top})`),(o=a.annotations)===null||o===void 0||o.render(),this._firstRender=!1}_updateScales(...e){const t=Mu(e||this.components);this._setScales(...t),this._updateScalesDomain(...t),this._updateScalesRange(...t)}_setScales(...e){const{config:t}=this;e&&(t.xScale&&e.forEach(n=>n.setScale(Gr.X,t.xScale)),t.yScale&&e.forEach(n=>n.setScale(Gr.Y,t.yScale)))}_updateScalesDomain(...e){const{config:t}=this;if(!e)return;const n=e.filter(i=>!i.config.excludeFromDomainCalculation);Object.values(Gr).forEach(i=>{var s,o,a,l,u,c,d,h;const[f,m]=mV(SV(n.map(A=>A.getDataExtent(i,t.scaleByDomain)))),p=i===Gr.Y?t.yDomain:t.xDomain,g=i===Gr.Y?t.yDomainMinConstraint:t.xDomainMinConstraint,v=i===Gr.Y?t.yDomainMaxConstraint:t.xDomainMaxConstraint,y=(o=(s=p?.[0])!==null&&s!==void 0?s:f)!==null&&o!==void 0?o:0,b=(l=(a=p?.[1])!==null&&a!==void 0?a:m)!==null&&l!==void 0?l:1,E=[ks(y,(u=g?.[0])!==null&&u!==void 0?u:Number.NEGATIVE_INFINITY,(c=g?.[1])!==null&&c!==void 0?c:Number.POSITIVE_INFINITY),ks(b,(d=v?.[0])!==null&&d!==void 0?d:Number.NEGATIVE_INFINITY,(h=v?.[1])!==null&&h!==void 0?h:Number.POSITIVE_INFINITY)];if(E[0]===E[1]){const A=n.some(M=>{var L;return((L=M.datamodel.data)===null||L===void 0?void 0:L.length)>0});(t.preventEmptyDomain||t.preventEmptyDomain===null&&(!A||i===Gr.Y))&&(E[1]=E[0]+1)}e.forEach(A=>A.setScaleDomain(i,E))})}_updateScalesRange(...e){var t,n,i,s,o,a;const{config:l}=this;if(!e)return;const u=l.yDirection===ss.South,c=[(t=l.padding.left)!==null&&t!==void 0?t:0,this.width-((n=l.padding.right)!==null&&n!==void 0?n:0)],d=[this.height-((i=l.padding.bottom)!==null&&i!==void 0?i:0),(s=l.padding.top)!==null&&s!==void 0?s:0];u&&d.reverse();for(const f of e)f.setSize(this.width,this.height,this.containerWidth,this.containerHeight),f.setScaleRange(Gr.X,(o=l.xRange)!==null&&o!==void 0?o:c),f.setScaleRange(Gr.Y,(a=l.yRange)!==null&&a!==void 0?a:d);const h=e.map(f=>f.bleed).reduce((f,m)=>{for(const p of Object.keys(f)){const g=p;f[g]<m[g]&&(f[g]=m[g])}return f},{top:0,bottom:0,left:0,right:0});for(const f of e)f.setScaleRange(Gr.X,[c[0]+h.left,c[1]-h.right]),f.setScaleRange(Gr.Y,u?[d[0]+h.top,d[1]-h.bottom]:[d[0]-h.bottom,d[1]+h.top])}_renderAxes(e){const{config:{xAxis:t,yAxis:n}}=this,i=this._getMargin();Mu([t,n]).forEach(o=>{const a=o.getOffset(i);o.g.attr("transform",`translate(${a.left},${a.top})`),o.render(e)})}_setAutoMargin(){const{config:{xAxis:e,yAxis:t}}=this,n=Mu([...this.components,e,t]);this._setScales(...n),this._updateScalesDomain(...n);const i=this._firstRender?2:1;for(let s=0;s<i;s+=1){const o={top:0,bottom:0,left:0,right:0};this._updateScalesRange(...n),Mu([e,t]).forEach(l=>{l.preRender();const u=l.getRequiredMargin();o.top<u.top&&(o.top=u.top),o.bottom<u.bottom&&(o.bottom=u.bottom),o.left<u.left&&(o.left=u.left),o.right<u.right&&(o.right=u.right)}),this._axisMargin=o}}_getMargin(){const{config:{margin:e}}=this;return{top:e.top+this._axisMargin.top,bottom:e.bottom+this._axisMargin.bottom,left:e.left+this._axisMargin.left,right:e.right+this._axisMargin.right}}destroy(){const{components:e,config:{tooltip:t,crosshair:n,annotations:i,xAxis:s,yAxis:o}}=this;super.destroy();for(const a of e)a?.destroy();t?.destroy(),n?.destroy(),i?.destroy(),s?.destroy(),o?.destroy()}}const sb={duration:600,events:{},attributes:{}};class $C{constructor(e=fc.SVG){var t,n;this.type=fc.SVG,this.datamodel=new Gv,this.sizing=_o.Fit,this.events={},this._defaultConfig=sb,this._width=400,this._height=200,this._containerWidth=void 0,this._containerHeight=void 0,this._containerMargin={top:0,bottom:0,left:0,right:0},this._setUpComponentEventsThrottled=jf(this._setUpComponentEvents,500),this._setCustomAttributesThrottled=jf(this._setCustomAttributes,500),e===fc.SVG?this.element=document.createElementNS("http://www.w3.org/2000/svg","g"):this.element=document.createElement("div"),this.uid=eC(),this.g=ui(this.element);const i=(n=(t=this.constructor)===null||t===void 0?void 0:t.selectors)===null||n===void 0?void 0:n.root;i&&this.g.attr("class",i)}setContainerMargin(e){this._containerMargin=e}setConfig(e){this.prevConfig=this.config,this.config=nl(this._defaultConfig,e)}setData(e){this.datamodel.data=e}setSize(e,t,n,i){isFinite(e)&&(this._width=e),isFinite(t)&&(this._height=t),isFinite(n)&&(this._containerWidth=n),isFinite(i)&&(this._containerHeight=i)}render(e=this.config.duration){this._render(e);const t="animating";e&&(this.g.attr(t,""),this.g.transition(t).duration(e).on("end interrupt",()=>{this.g.attr(t,null)})),this._setUpComponentEventsThrottled(),this._setCustomAttributesThrottled()}get bleed(){return{top:0,bottom:0,left:0,right:0}}_render(e=this.config.duration){}_setCustomAttributes(){const e=this.config.attributes;Object.keys(e).forEach(t=>{Object.keys(e[t]).forEach(n=>{this.g.selectAll(`.${t}`).attr(n,e[t][n])})})}_setUpComponentEvents(){this._bindEvents(this.events),this._bindEvents(this.config.events,".user")}_bindEvents(e=this.events,t=""){Object.keys(e).forEach(n=>{Object.keys(e[n]).forEach(i=>{const s=this.g.selectAll(`.${n}`);s.on(i+t,(o,a)=>{const l=s.nodes(),u=l.indexOf(o.currentTarget),c=e[n][i];return c?.(a,o,u,l)})})})}destroy(){var e;(e=this.g)===null||e===void 0||e.remove(),this.element=void 0}isDestroyed(){return!this.element}}class zC extends Gv{constructor(e){super(e)}get data(){var e;return(e=this._data)!==null&&e!==void 0?e:[]}set data(e){Array.isArray(e)&&(this._data=e)}}const dh=Object.assign(Object.assign({},sb),{x:void 0,y:void 0,id:(r,e)=>{var t;return(t=r.id)!==null&&t!==void 0?t:`${e}`},color:r=>r.color,xScale:void 0,yScale:void 0,excludeFromDomainCalculation:!1});class om extends $C{constructor(){super(...arguments),this.datamodel=new zC,this.clippable=!0,this.stacked=!1,this._defaultConfig=dh,this._xScale=h2.scaleLinear(),this._yScale=h2.scaleLinear()}get xScale(){return this.config.xScale||this._xScale}get yScale(){return this.config.yScale||this._yScale}setConfig(e){var t,n;!((t=this.config)===null||t===void 0)&&t.xScale&&(e.xScale=this.config.xScale),!((n=this.config)===null||n===void 0)&&n.yScale&&(e.yScale=this.config.yScale),super.setConfig(e)}setScaleDomain(e,t){var n,i;e===Gr.X&&((n=this._xScale)===null||n===void 0||n.domain(t)),e===Gr.Y&&((i=this._yScale)===null||i===void 0||i.domain(t))}setScaleRange(e,t){var n,i;e===Gr.X&&((n=this._xScale)===null||n===void 0||n.range(t)),e===Gr.Y&&((i=this._yScale)===null||i===void 0||i.range(t))}setScale(e,t){t&&e===Gr.X&&(this._xScale=t),t&&e===Gr.Y&&(this._yScale=t)}getDataExtent(e,t){const{config:n,datamodel:i}=this;switch(e){case Gr.X:return this.getXDataExtent();case Gr.Y:return this.getYDataExtent(t);default:return Ad(i.data,n[e])}}getXDataExtent(){const{config:e,datamodel:t}=this;return Ad(t.data,e.x)}getYDataExtent(e){const{config:t,datamodel:n}=this,i=this.xScale.domain(),s=e?MV(n.data,i,t.x,!0):n.data,o=xu(t.y)?t.y:[t.y];return Ad(s,...o)}}var nt;(function(r){r.Top="top",r.Bottom="bottom",r.Left="left",r.Right="right",r.Center="center",r.Auto="auto"})(nt||(nt={}));var d2;(function(r){r.Absolute="absolute",r.Fixed="fixed"})(d2||(d2={}));var f2;(function(r){r.Inside="inside",r.Outside="outside",r.Center="center"})(f2||(f2={}));var rp;(function(r){r.Horizontal="horizontal",r.Vertical="vertical"})(rp||(rp={}));const kW={components:[],container:void 0,followCursor:!0,allowHover:!1,horizontalPlacement:nt.Auto,horizontalShift:0,verticalPlacement:nt.Top,verticalShift:0,attributes:{},triggers:{},className:void 0,showDelay:void 0,hideDelay:void 0},am=Pt`
  label: tooltip;
  display: inline-block;
  left: 0;
  bottom: 0;
  min-width: max-content;
  position: absolute;
  opacity: 0;
  transition: opacity;
  transition-duration: var(--vis-tooltip-transition-duration);
  z-index: 999999;
  padding: var(--vis-tooltip-padding);
  color: var(--vis-tooltip-text-color);
  border-radius: var(--vis-tooltip-border-radius);
  box-shadow: var(--vis-tooltip-box-shadow);
  border: solid 1px var(--vis-tooltip-border-color);
  background-color: var(--vis-tooltip-background-color);
  backdrop-filter: var(--vis-tooltip-backdrop-filter);
`,PW=am,FW=Ea`
  :root {
    --vis-tooltip-background-color: rgba(255, 255, 255, 0.95);
    --vis-tooltip-border-color: #e5e9f7;
    --vis-tooltip-text-color: #000;
    --vis-tooltip-shadow-color: rgba(172, 179, 184, 0.35);
    --vis-tooltip-backdrop-filter: none;
    --vis-tooltip-padding: 10px 15px;
    --vis-tooltip-border-radius: 5px;
    --vis-tooltip-transition-duration: 300ms;
    --vis-tooltip-box-shadow: none;

    --vis-dark-tooltip-background-color: rgba(30,30,30, 0.95);
    --vis-dark-tooltip-text-color: #e5e9f7;
    --vis-dark-tooltip-border-color: var(--vis-color-grey);
    --vis-dark-tooltip-shadow-color: rgba(0,0,0, 0.95);
  }

  body.theme-dark ${`.${am}`} {
    --vis-tooltip-background-color: var(--vis-dark-tooltip-background-color);
    --vis-tooltip-text-color: var(--vis-dark-tooltip-text-color);
    --vis-tooltip-border-color: var(--vis-dark-tooltip-border-color);
    --vis-tooltip-shadow-color: var(--vis-dark-tooltip-shadow-color);
  }

  body.theme-dark {
    --vis-tooltip-background-color: rgba(30,30,30, 0.95);
    --vis-tooltip-text-color: #e5e9f7;
    --vis-tooltip-border-color: var(--vis-color-grey);
    --vis-tooltip-shadow-color: rgba(0,0,0, 0.95);
  }
`,HC=Pt`
  bottom: unset;
  position: fixed;
`,Fd=Pt`
  opacity: 1;
`,Ld=Pt`
  display: none;
`,WC=Pt`
  label: non-interactive;
  pointer-events: none;
  user-select: none;
`,LW=Object.freeze(Object.defineProperty({__proto__:null,hidden:Ld,nonInteractive:WC,positionFixed:HC,root:am,show:Fd,tooltip:PW,variables:FW},Symbol.toStringTag,{value:"Module"}));class GC{constructor(e={}){this._defaultConfig=kW,this.config=this._defaultConfig,this._setUpEventsThrottled=jf(this._setUpEvents,500),this._setContainerPositionThrottled=jf(this._setContainerPosition,500),this._isShown=!1,this.element=document.createElement("div"),this.div=ui(this.element).attr("class",am).classed(Fd,!1).classed(Ld,!0),this.setConfig(e),this.components=this.config.components,this._mutationObserver=new MutationObserver(()=>{this._isShown&&(!this.config.followCursor&&this._hoveredElement?this.placeByElement(this._hoveredElement):this._position&&this.place({x:this._position[0],y:this._position[1]}))}),this._mutationObserver.observe(this.div.node(),{childList:!0,subtree:!0})}setConfig(e){var t;this.prevConfig=this.config,this.config=nl(this._defaultConfig,e),this.prevConfig.horizontalPlacement!==this.config.horizontalPlacement&&this.overrideHorizontalPlacement(void 0),this.config.container&&this.config.container!==((t=this.prevConfig)===null||t===void 0?void 0:t.container)&&this.setContainer(this.config.container),this._setUpAttributes()}setContainer(e){var t;(t=this.element.parentNode)===null||t===void 0||t.removeChild(this.element),this._container=e,this._container.appendChild(this.element),this._setContainerPositionThrottled()}getContainer(){return this._container}hasContainer(){return!!this._container&&this._container.isConnected}setComponents(e){this.components=e}update(){this._container&&this._setUpEventsThrottled()}show(e,t){this.render(e),this.place(t)}_hide(){this.div.classed(Fd,!1).on("transitionend",()=>{this.div.classed(Ld,!this._isShown)}),this._isShown=!1}hide(){window.clearTimeout(this._showDelayTimeoutId),this.config.hideDelay?(window.clearTimeout(this._hideDelayTimeoutId),this._hideDelayTimeoutId=setTimeout(()=>this._hide(),this.config.hideDelay)):this._hide()}_display(){window.clearTimeout(this._hideDelayTimeoutId),this.div.classed(Ld,!1).classed(Fd,!0),this._isShown=!0}display(){this._isShown||(this.config.showDelay?(window.clearTimeout(this._showDelayTimeoutId),this._showDelayTimeoutId=setTimeout(()=>{this._display(),this.place({x:this._position[0],y:this._position[1]})},this.config.showDelay)):this._display())}place(e){if(this._position=[e.x,e.y],!this.hasContainer()){console.warn("Unovis | Tooltip: Container was not set or is not initialized yet");return}const{config:t}=this,n=this.element.offsetWidth,i=this.element.offsetHeight,s=this._overriddenHorizontalPlacement||(t.horizontalPlacement===nt.Auto?nt.Center:t.horizontalPlacement),o=t.verticalPlacement===nt.Auto?e.y-i<0?nt.Bottom:nt.Top:t.verticalPlacement,a=5,l=s===nt.Left?-n-a-t.horizontalShift:s===nt.Center?-n/2:a+t.horizontalShift,u=o===nt.Bottom?a+t.verticalShift:o===nt.Center?-i/2:-a-t.verticalShift-i,[c,d]=this._constraintPosToContainer(e.x+l,e.y+u,n,i);this._applyPosition(c,d,i)}placeByElement(e){const{config:t}=this;this._hoveredElement=e;const n=5,i=this.element.offsetWidth,s=this.element.offsetHeight,o=this.isContainerBody(),a=o?window.innerWidth:this._container.scrollWidth,l=e.getBoundingClientRect(),u=o?[l.x,l.y]:Df({clientX:l.x,clientY:l.y,pageX:l.x,pageY:l.y},this._container),c=this._overriddenHorizontalPlacement||(t.horizontalPlacement===nt.Auto?u[0]-i<0?nt.Right:u[0]+i>a?nt.Left:nt.Center:t.horizontalPlacement);let d=0;switch(c){case nt.Left:d=-i-n-t.horizontalShift;break;case nt.Right:d=l.width+n+t.horizontalShift;break;case nt.Center:default:d=(-i+l.width)/2;break}const h=t.verticalPlacement===nt.Auto?c!==nt.Center?nt.Center:u[1]-s<0?nt.Bottom:nt.Top:t.verticalPlacement;let f=-s;switch(h){case nt.Center:f+=(s+l.height)/2;break;case nt.Bottom:f+=s+l.height+n+t.verticalShift;break;case nt.Top:default:f+=-n-t.verticalShift;break}const[m,p]=this._constraintPosToContainer(u[0]+d,u[1]+f,i,s);this._applyPosition(m,p,s)}isContainerBody(){return this._container===document.body}overrideHorizontalPlacement(e){this._overriddenHorizontalPlacement=e}render(e){var t;const{config:n,prevConfig:i}=this;e instanceof HTMLElement?this.div.select(":first-child").node()!==e&&this.div.html("").append(()=>e):e!==null&&this.div.html(e||""),this.div.classed((t=n.className)!==null&&t!==void 0?t:"",!!n.className).classed(WC,!n.allowHover),i?.className&&i.className!==n.className&&this.div.classed(i.className,!1),this.display()}_applyPosition(e,t,n){const i=this.isContainerBody(),s=i?window.innerHeight:this._container.scrollHeight;this.div.classed(HC,i).style("top",i?`${t}px`:"unset").style("bottom",i?"unset":`${s-t-n}px`).style("left",`${e}px`)}_constraintPosToContainer(e,t,n,i){const s=this.isContainerBody(),o=s?window.innerHeight:this._container.scrollHeight,a=s?window.innerWidth:this._container.scrollWidth,l=10,u=e>a-n-l,c=e<l,d=u?a-n-l:c?l:e,h=10,f=t>o-i-h,m=t<h,p=f?o-i-h:m?h:t;return[a<n?0:d,o<i?0:p]}_setContainerPosition(){var e;this._container!==document.body&&((e=getComputedStyle(this._container))===null||e===void 0?void 0:e.position)==="static"&&(this._container.style.position="relative")}_setUpEvents(){const{config:e}=this;this.components.forEach(t=>{const n=ui(t.element);n.on("mousemove.tooltip",i=>{const{config:s}=this,o=i.composedPath&&i.composedPath()||i.path||[i.target];for(const a of Object.keys(s.triggers)){const l=s.triggers[a];if(!l)continue;const u=n.selectAll(`.${a}`).nodes();for(const c of o){if(c===n.node())break;if(c.classList.contains(a)){const d=u.indexOf(c),h=ui(c).datum(),f=l(h,d,u),[m,p]=this.isContainerBody()?[i.clientX,i.clientY]:Df(i,this._container);f===null?this.hide():(this.render(f),s.followCursor?this.place({x:m,y:p}):this.placeByElement(c)),i.stopPropagation();return}}}this._isShown&&this.hide()}).on("mouseleave.tooltip",i=>{i.stopPropagation(),this.hide()})}),e.allowHover?this.div.on("mouseenter.tooltip",this._display.bind(this)).on("mouseleave.tooltip",this.hide.bind(this)):this.div.on("mouseenter.tooltip",null).on("mouseleave.tooltip",null)}_setUpAttributes(){const e=this.config.attributes;e&&Object.keys(e).forEach(t=>{this.div.attr(t,e[t])})}destroy(){var e;this._mutationObserver.disconnect(),window.clearTimeout(this._hideDelayTimeoutId),window.clearTimeout(this._showDelayTimeoutId),(e=this.div)===null||e===void 0||e.remove()}}GC.selectors=LW;function Ar(r){return function(){return r}}const p2=Math.abs,In=Math.atan2,co=Math.cos,DW=Math.max,cg=Math.min,Jn=Math.sin,En=Math.sqrt,Pn=1e-12,ma=Math.PI,np=ma/2,ca=2*ma;function BW(r){return r>1?0:r<-1?ma:Math.acos(r)}function m2(r){return r>=1?np:r<=-1?-np:Math.asin(r)}const V0=Math.PI,j0=2*V0,Fa=1e-6,UW=j0-Fa;function qC(r){this._+=r[0];for(let e=1,t=r.length;e<t;++e)this._+=arguments[e]+r[e]}function VW(r){let e=Math.floor(r);if(!(e>=0))throw new Error(`invalid digits: ${r}`);if(e>15)return qC;const t=10**e;return function(n){this._+=n[0];for(let i=1,s=n.length;i<s;++i)this._+=Math.round(arguments[i]*t)/t+n[i]}}class jW{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?qC:VW(e)}moveTo(e,t){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,t){this._append`L${this._x1=+e},${this._y1=+t}`}quadraticCurveTo(e,t,n,i){this._append`Q${+e},${+t},${this._x1=+n},${this._y1=+i}`}bezierCurveTo(e,t,n,i,s,o){this._append`C${+e},${+t},${+n},${+i},${this._x1=+s},${this._y1=+o}`}arcTo(e,t,n,i,s){if(e=+e,t=+t,n=+n,i=+i,s=+s,s<0)throw new Error(`negative radius: ${s}`);let o=this._x1,a=this._y1,l=n-e,u=i-t,c=o-e,d=a-t,h=c*c+d*d;if(this._x1===null)this._append`M${this._x1=e},${this._y1=t}`;else if(h>Fa)if(!(Math.abs(d*l-u*c)>Fa)||!s)this._append`L${this._x1=e},${this._y1=t}`;else{let f=n-o,m=i-a,p=l*l+u*u,g=f*f+m*m,v=Math.sqrt(p),y=Math.sqrt(h),b=s*Math.tan((V0-Math.acos((p+h-g)/(2*v*y)))/2),E=b/y,A=b/v;Math.abs(E-1)>Fa&&this._append`L${e+E*c},${t+E*d}`,this._append`A${s},${s},0,0,${+(d*f>c*m)},${this._x1=e+A*l},${this._y1=t+A*u}`}}arc(e,t,n,i,s,o){if(e=+e,t=+t,n=+n,o=!!o,n<0)throw new Error(`negative radius: ${n}`);let a=n*Math.cos(i),l=n*Math.sin(i),u=e+a,c=t+l,d=1^o,h=o?i-s:s-i;this._x1===null?this._append`M${u},${c}`:(Math.abs(this._x1-u)>Fa||Math.abs(this._y1-c)>Fa)&&this._append`L${u},${c}`,n&&(h<0&&(h=h%j0+j0),h>UW?this._append`A${n},${n},0,1,${d},${e-a},${t-l}A${n},${n},0,1,${d},${this._x1=u},${this._y1=c}`:h>Fa&&this._append`A${n},${n},0,${+(h>=V0)},${d},${this._x1=e+n*Math.cos(s)},${this._y1=t+n*Math.sin(s)}`)}rect(e,t,n,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}h${n=+n}v${+i}h${-n}Z`}toString(){return this._}}function ob(r){let e=3;return r.digits=function(t){if(!arguments.length)return e;if(t==null)e=null;else{const n=Math.floor(t);if(!(n>=0))throw new RangeError(`invalid digits: ${t}`);e=n}return r},()=>new jW(e)}function $W(r){return r.innerRadius}function zW(r){return r.outerRadius}function HW(r){return r.startAngle}function WW(r){return r.endAngle}function GW(r){return r&&r.padAngle}function qW(r,e,t,n,i,s,o,a){var l=t-r,u=n-e,c=o-i,d=a-s,h=d*l-c*u;if(!(h*h<Pn))return h=(c*(e-s)-d*(r-i))/h,[r+h*l,e+h*u]}function id(r,e,t,n,i,s,o){var a=r-t,l=e-n,u=(o?s:-s)/En(a*a+l*l),c=u*l,d=-u*a,h=r+c,f=e+d,m=t+c,p=n+d,g=(h+m)/2,v=(f+p)/2,y=m-h,b=p-f,E=y*y+b*b,A=i-s,M=h*p-m*f,L=(b<0?-1:1)*En(DW(0,A*A*E-M*M)),k=(M*b-y*L)/E,P=(-M*y-b*L)/E,U=(M*b+y*L)/E,$=(-M*y+b*L)/E,V=k-g,R=P-v,O=U-g,T=$-v;return V*V+R*R>O*O+T*T&&(k=U,P=$),{cx:k,cy:P,x01:-c,y01:-d,x11:k*(i/A-1),y11:P*(i/A-1)}}function YW(){var r=$W,e=zW,t=Ar(0),n=null,i=HW,s=WW,o=GW,a=null,l=ob(u);function u(){var c,d,h=+r.apply(this,arguments),f=+e.apply(this,arguments),m=i.apply(this,arguments)-np,p=s.apply(this,arguments)-np,g=p2(p-m),v=p>m;if(a||(a=c=l()),f<h&&(d=f,f=h,h=d),!(f>Pn))a.moveTo(0,0);else if(g>ca-Pn)a.moveTo(f*co(m),f*Jn(m)),a.arc(0,0,f,m,p,!v),h>Pn&&(a.moveTo(h*co(p),h*Jn(p)),a.arc(0,0,h,p,m,v));else{var y=m,b=p,E=m,A=p,M=g,L=g,k=o.apply(this,arguments)/2,P=k>Pn&&(n?+n.apply(this,arguments):En(h*h+f*f)),U=cg(p2(f-h)/2,+t.apply(this,arguments)),$=U,V=U,R,O;if(P>Pn){var T=m2(P/h*Jn(k)),w=m2(P/f*Jn(k));(M-=T*2)>Pn?(T*=v?1:-1,E+=T,A-=T):(M=0,E=A=(m+p)/2),(L-=w*2)>Pn?(w*=v?1:-1,y+=w,b-=w):(L=0,y=b=(m+p)/2)}var x=f*co(y),_=f*Jn(y),S=h*co(A),C=h*Jn(A);if(U>Pn){var F=f*co(b),D=f*Jn(b),H=h*co(E),G=h*Jn(E),ee;if(g<ma)if(ee=qW(x,_,H,G,F,D,S,C)){var B=x-ee[0],X=_-ee[1],I=F-ee[0],N=D-ee[1],j=1/Jn(BW((B*I+X*N)/(En(B*B+X*X)*En(I*I+N*N)))/2),Q=En(ee[0]*ee[0]+ee[1]*ee[1]);$=cg(U,(h-Q)/(j-1)),V=cg(U,(f-Q)/(j+1))}else $=V=0}L>Pn?V>Pn?(R=id(H,G,x,_,f,V,v),O=id(F,D,S,C,f,V,v),a.moveTo(R.cx+R.x01,R.cy+R.y01),V<U?a.arc(R.cx,R.cy,V,In(R.y01,R.x01),In(O.y01,O.x01),!v):(a.arc(R.cx,R.cy,V,In(R.y01,R.x01),In(R.y11,R.x11),!v),a.arc(0,0,f,In(R.cy+R.y11,R.cx+R.x11),In(O.cy+O.y11,O.cx+O.x11),!v),a.arc(O.cx,O.cy,V,In(O.y11,O.x11),In(O.y01,O.x01),!v))):(a.moveTo(x,_),a.arc(0,0,f,y,b,!v)):a.moveTo(x,_),!(h>Pn)||!(M>Pn)?a.lineTo(S,C):$>Pn?(R=id(S,C,F,D,h,-$,v),O=id(x,_,H,G,h,-$,v),a.lineTo(R.cx+R.x01,R.cy+R.y01),$<U?a.arc(R.cx,R.cy,$,In(R.y01,R.x01),In(O.y01,O.x01),!v):(a.arc(R.cx,R.cy,$,In(R.y01,R.x01),In(R.y11,R.x11),!v),a.arc(0,0,h,In(R.cy+R.y11,R.cx+R.x11),In(O.cy+O.y11,O.cx+O.x11),v),a.arc(O.cx,O.cy,$,In(O.y11,O.x11),In(O.y01,O.x01),!v))):a.arc(0,0,h,A,E,v)}if(a.closePath(),c)return a=null,c+""||null}return u.centroid=function(){var c=(+r.apply(this,arguments)+ +e.apply(this,arguments))/2,d=(+i.apply(this,arguments)+ +s.apply(this,arguments))/2-ma/2;return[co(d)*c,Jn(d)*c]},u.innerRadius=function(c){return arguments.length?(r=typeof c=="function"?c:Ar(+c),u):r},u.outerRadius=function(c){return arguments.length?(e=typeof c=="function"?c:Ar(+c),u):e},u.cornerRadius=function(c){return arguments.length?(t=typeof c=="function"?c:Ar(+c),u):t},u.padRadius=function(c){return arguments.length?(n=c==null?null:typeof c=="function"?c:Ar(+c),u):n},u.startAngle=function(c){return arguments.length?(i=typeof c=="function"?c:Ar(+c),u):i},u.endAngle=function(c){return arguments.length?(s=typeof c=="function"?c:Ar(+c),u):s},u.padAngle=function(c){return arguments.length?(o=typeof c=="function"?c:Ar(+c),u):o},u.context=function(c){return arguments.length?(a=c??null,u):a},u}function YC(r){return typeof r=="object"&&"length"in r?r:Array.from(r)}function XC(r){this._context=r}XC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(r,e){switch(r=+r,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(r,e):this._context.moveTo(r,e);break;case 1:this._point=2;default:this._context.lineTo(r,e);break}}};function KC(r){return new XC(r)}function XW(r){return r[0]}function KW(r){return r[1]}function ZW(r,e){var t=Ar(!0),n=null,i=KC,s=null,o=ob(a);r=typeof r=="function"?r:r===void 0?XW:Ar(r),e=typeof e=="function"?e:e===void 0?KW:Ar(e);function a(l){var u,c=(l=YC(l)).length,d,h=!1,f;for(n==null&&(s=i(f=o())),u=0;u<=c;++u)!(u<c&&t(d=l[u],u,l))===h&&((h=!h)?s.lineStart():s.lineEnd()),h&&s.point(+r(d,u,l),+e(d,u,l));if(f)return s=null,f+""||null}return a.x=function(l){return arguments.length?(r=typeof l=="function"?l:Ar(+l),a):r},a.y=function(l){return arguments.length?(e=typeof l=="function"?l:Ar(+l),a):e},a.defined=function(l){return arguments.length?(t=typeof l=="function"?l:Ar(!!l),a):t},a.curve=function(l){return arguments.length?(i=l,n!=null&&(s=i(n)),a):i},a.context=function(l){return arguments.length?(l==null?n=s=null:s=i(n=l),a):n},a}function QW(r,e){return e<r?-1:e>r?1:e>=r?0:NaN}function JW(r){return r}function eG(){var r=JW,e=QW,t=null,n=Ar(0),i=Ar(ca),s=Ar(0);function o(a){var l,u=(a=YC(a)).length,c,d,h=0,f=new Array(u),m=new Array(u),p=+n.apply(this,arguments),g=Math.min(ca,Math.max(-ca,i.apply(this,arguments)-p)),v,y=Math.min(Math.abs(g)/u,s.apply(this,arguments)),b=y*(g<0?-1:1),E;for(l=0;l<u;++l)(E=m[f[l]=l]=+r(a[l],l,a))>0&&(h+=E);for(e!=null?f.sort(function(A,M){return e(m[A],m[M])}):t!=null&&f.sort(function(A,M){return t(a[A],a[M])}),l=0,d=h?(g-u*b)/h:0;l<u;++l,p=v)c=f[l],E=m[c],v=p+(E>0?E*d:0)+b,m[c]={data:a[c],index:l,value:E,startAngle:p,endAngle:v,padAngle:y};return m}return o.value=function(a){return arguments.length?(r=typeof a=="function"?a:Ar(+a),o):r},o.sortValues=function(a){return arguments.length?(e=a,t=null,o):e},o.sort=function(a){return arguments.length?(t=a,e=null,o):t},o.startAngle=function(a){return arguments.length?(n=typeof a=="function"?a:Ar(+a),o):n},o.endAngle=function(a){return arguments.length?(i=typeof a=="function"?a:Ar(+a),o):i},o.padAngle=function(a){return arguments.length?(s=typeof a=="function"?a:Ar(+a),o):s},o}const ZC={draw(r,e){const t=En(e/ma);r.moveTo(t,0),r.arc(0,0,t,0,ca)}},tG={draw(r,e){const t=En(e/5)/2;r.moveTo(-3*t,-t),r.lineTo(-t,-t),r.lineTo(-t,-3*t),r.lineTo(t,-3*t),r.lineTo(t,-t),r.lineTo(3*t,-t),r.lineTo(3*t,t),r.lineTo(t,t),r.lineTo(t,3*t),r.lineTo(-t,3*t),r.lineTo(-t,t),r.lineTo(-3*t,t),r.closePath()}},QC=En(1/3),rG=QC*2,nG={draw(r,e){const t=En(e/rG),n=t*QC;r.moveTo(0,-t),r.lineTo(n,0),r.lineTo(0,t),r.lineTo(-n,0),r.closePath()}},iG={draw(r,e){const t=En(e),n=-t/2;r.rect(n,n,t,t)}},sG=.8908130915292852,JC=Jn(ma/10)/Jn(7*ma/10),oG=Jn(ca/10)*JC,aG=-co(ca/10)*JC,lG={draw(r,e){const t=En(e*sG),n=oG*t,i=aG*t;r.moveTo(0,-t),r.lineTo(n,i);for(let s=1;s<5;++s){const o=ca*s/5,a=co(o),l=Jn(o);r.lineTo(l*t,-a*t),r.lineTo(a*n-l*i,l*n+a*i)}r.closePath()}},hg=En(3),uG={draw(r,e){const t=-En(e/(hg*3));r.moveTo(0,t*2),r.lineTo(-hg*t,-t),r.lineTo(hg*t,-t),r.closePath()}},ki=-.5,Pi=En(3)/2,$0=1/En(12),cG=($0/2+1)*3,hG={draw(r,e){const t=En(e/cG),n=t/2,i=t*$0,s=n,o=t*$0+t,a=-s,l=o;r.moveTo(n,i),r.lineTo(s,o),r.lineTo(a,l),r.lineTo(ki*n-Pi*i,Pi*n+ki*i),r.lineTo(ki*s-Pi*o,Pi*s+ki*o),r.lineTo(ki*a-Pi*l,Pi*a+ki*l),r.lineTo(ki*n+Pi*i,ki*i-Pi*n),r.lineTo(ki*s+Pi*o,ki*o-Pi*s),r.lineTo(ki*a+Pi*l,ki*l-Pi*a),r.closePath()}};function dG(r,e){let t=null,n=ob(i);r=typeof r=="function"?r:Ar(r||ZC),e=typeof e=="function"?e:Ar(e===void 0?64:+e);function i(){let s;if(t||(t=s=n()),r.apply(this,arguments).draw(t,+e.apply(this,arguments)),s)return t=null,s+""||null}return i.type=function(s){return arguments.length?(r=typeof s=="function"?s:Ar(s),i):r},i.size=function(s){return arguments.length?(e=typeof s=="function"?s:Ar(+s),i):e},i.context=function(s){return arguments.length?(t=s??null,i):t},i}function ga(){}function ip(r,e,t){r._context.bezierCurveTo((2*r._x0+r._x1)/3,(2*r._y0+r._y1)/3,(r._x0+2*r._x1)/3,(r._y0+2*r._y1)/3,(r._x0+4*r._x1+e)/6,(r._y0+4*r._y1+t)/6)}function lm(r){this._context=r}lm.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:ip(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(r,e){switch(r=+r,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(r,e):this._context.moveTo(r,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:ip(this,r,e);break}this._x0=this._x1,this._x1=r,this._y0=this._y1,this._y1=e}};function fG(r){return new lm(r)}function e3(r){this._context=r}e3.prototype={areaStart:ga,areaEnd:ga,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(r,e){switch(r=+r,e=+e,this._point){case 0:this._point=1,this._x2=r,this._y2=e;break;case 1:this._point=2,this._x3=r,this._y3=e;break;case 2:this._point=3,this._x4=r,this._y4=e,this._context.moveTo((this._x0+4*this._x1+r)/6,(this._y0+4*this._y1+e)/6);break;default:ip(this,r,e);break}this._x0=this._x1,this._x1=r,this._y0=this._y1,this._y1=e}};function pG(r){return new e3(r)}function t3(r){this._context=r}t3.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(r,e){switch(r=+r,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var t=(this._x0+4*this._x1+r)/6,n=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 3:this._point=4;default:ip(this,r,e);break}this._x0=this._x1,this._x1=r,this._y0=this._y1,this._y1=e}};function mG(r){return new t3(r)}function r3(r,e){this._basis=new lm(r),this._beta=e}r3.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var r=this._x,e=this._y,t=r.length-1;if(t>0)for(var n=r[0],i=e[0],s=r[t]-n,o=e[t]-i,a=-1,l;++a<=t;)l=a/t,this._basis.point(this._beta*r[a]+(1-this._beta)*(n+l*s),this._beta*e[a]+(1-this._beta)*(i+l*o));this._x=this._y=null,this._basis.lineEnd()},point:function(r,e){this._x.push(+r),this._y.push(+e)}};const gG=(function r(e){function t(n){return e===1?new lm(n):new r3(n,e)}return t.beta=function(n){return r(+n)},t})(.85);function sp(r,e,t){r._context.bezierCurveTo(r._x1+r._k*(r._x2-r._x0),r._y1+r._k*(r._y2-r._y0),r._x2+r._k*(r._x1-e),r._y2+r._k*(r._y1-t),r._x2,r._y2)}function ab(r,e){this._context=r,this._k=(1-e)/6}ab.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:sp(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(r,e){switch(r=+r,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(r,e):this._context.moveTo(r,e);break;case 1:this._point=2,this._x1=r,this._y1=e;break;case 2:this._point=3;default:sp(this,r,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=r,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const yG=(function r(e){function t(n){return new ab(n,e)}return t.tension=function(n){return r(+n)},t})(0);function lb(r,e){this._context=r,this._k=(1-e)/6}lb.prototype={areaStart:ga,areaEnd:ga,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(r,e){switch(r=+r,e=+e,this._point){case 0:this._point=1,this._x3=r,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=r,this._y4=e);break;case 2:this._point=3,this._x5=r,this._y5=e;break;default:sp(this,r,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=r,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const vG=(function r(e){function t(n){return new lb(n,e)}return t.tension=function(n){return r(+n)},t})(0);function ub(r,e){this._context=r,this._k=(1-e)/6}ub.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(r,e){switch(r=+r,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:sp(this,r,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=r,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const bG=(function r(e){function t(n){return new ub(n,e)}return t.tension=function(n){return r(+n)},t})(0);function cb(r,e,t){var n=r._x1,i=r._y1,s=r._x2,o=r._y2;if(r._l01_a>Pn){var a=2*r._l01_2a+3*r._l01_a*r._l12_a+r._l12_2a,l=3*r._l01_a*(r._l01_a+r._l12_a);n=(n*a-r._x0*r._l12_2a+r._x2*r._l01_2a)/l,i=(i*a-r._y0*r._l12_2a+r._y2*r._l01_2a)/l}if(r._l23_a>Pn){var u=2*r._l23_2a+3*r._l23_a*r._l12_a+r._l12_2a,c=3*r._l23_a*(r._l23_a+r._l12_a);s=(s*u+r._x1*r._l23_2a-e*r._l12_2a)/c,o=(o*u+r._y1*r._l23_2a-t*r._l12_2a)/c}r._context.bezierCurveTo(n,i,s,o,r._x2,r._y2)}function n3(r,e){this._context=r,this._alpha=e}n3.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(r,e){if(r=+r,e=+e,this._point){var t=this._x2-r,n=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(t*t+n*n,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(r,e):this._context.moveTo(r,e);break;case 1:this._point=2;break;case 2:this._point=3;default:cb(this,r,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=r,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const wG=(function r(e){function t(n){return e?new n3(n,e):new ab(n,0)}return t.alpha=function(n){return r(+n)},t})(.5);function i3(r,e){this._context=r,this._alpha=e}i3.prototype={areaStart:ga,areaEnd:ga,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(r,e){if(r=+r,e=+e,this._point){var t=this._x2-r,n=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(t*t+n*n,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=r,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=r,this._y4=e);break;case 2:this._point=3,this._x5=r,this._y5=e;break;default:cb(this,r,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=r,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const _G=(function r(e){function t(n){return e?new i3(n,e):new lb(n,0)}return t.alpha=function(n){return r(+n)},t})(.5);function s3(r,e){this._context=r,this._alpha=e}s3.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(r,e){if(r=+r,e=+e,this._point){var t=this._x2-r,n=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(t*t+n*n,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:cb(this,r,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=r,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const xG=(function r(e){function t(n){return e?new s3(n,e):new ub(n,0)}return t.alpha=function(n){return r(+n)},t})(.5);function o3(r){this._context=r}o3.prototype={areaStart:ga,areaEnd:ga,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(r,e){r=+r,e=+e,this._point?this._context.lineTo(r,e):(this._point=1,this._context.moveTo(r,e))}};function EG(r){return new o3(r)}function g2(r){return r<0?-1:1}function y2(r,e,t){var n=r._x1-r._x0,i=e-r._x1,s=(r._y1-r._y0)/(n||i<0&&-0),o=(t-r._y1)/(i||n<0&&-0),a=(s*i+o*n)/(n+i);return(g2(s)+g2(o))*Math.min(Math.abs(s),Math.abs(o),.5*Math.abs(a))||0}function v2(r,e){var t=r._x1-r._x0;return t?(3*(r._y1-r._y0)/t-e)/2:e}function dg(r,e,t){var n=r._x0,i=r._y0,s=r._x1,o=r._y1,a=(s-n)/3;r._context.bezierCurveTo(n+a,i+a*e,s-a,o-a*t,s,o)}function op(r){this._context=r}op.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:dg(this,this._t0,v2(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(r,e){var t=NaN;if(r=+r,e=+e,!(r===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(r,e):this._context.moveTo(r,e);break;case 1:this._point=2;break;case 2:this._point=3,dg(this,v2(this,t=y2(this,r,e)),t);break;default:dg(this,this._t0,t=y2(this,r,e));break}this._x0=this._x1,this._x1=r,this._y0=this._y1,this._y1=e,this._t0=t}}};function a3(r){this._context=new l3(r)}(a3.prototype=Object.create(op.prototype)).point=function(r,e){op.prototype.point.call(this,e,r)};function l3(r){this._context=r}l3.prototype={moveTo:function(r,e){this._context.moveTo(e,r)},closePath:function(){this._context.closePath()},lineTo:function(r,e){this._context.lineTo(e,r)},bezierCurveTo:function(r,e,t,n,i,s){this._context.bezierCurveTo(e,r,n,t,s,i)}};function SG(r){return new op(r)}function TG(r){return new a3(r)}function u3(r){this._context=r}u3.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var r=this._x,e=this._y,t=r.length;if(t)if(this._line?this._context.lineTo(r[0],e[0]):this._context.moveTo(r[0],e[0]),t===2)this._context.lineTo(r[1],e[1]);else for(var n=b2(r),i=b2(e),s=0,o=1;o<t;++s,++o)this._context.bezierCurveTo(n[0][s],i[0][s],n[1][s],i[1][s],r[o],e[o]);(this._line||this._line!==0&&t===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(r,e){this._x.push(+r),this._y.push(+e)}};function b2(r){var e,t=r.length-1,n,i=new Array(t),s=new Array(t),o=new Array(t);for(i[0]=0,s[0]=2,o[0]=r[0]+2*r[1],e=1;e<t-1;++e)i[e]=1,s[e]=4,o[e]=4*r[e]+2*r[e+1];for(i[t-1]=2,s[t-1]=7,o[t-1]=8*r[t-1]+r[t],e=1;e<t;++e)n=i[e]/s[e-1],s[e]-=n,o[e]-=n*o[e-1];for(i[t-1]=o[t-1]/s[t-1],e=t-2;e>=0;--e)i[e]=(o[e]-i[e+1])/s[e];for(s[t-1]=(r[t]+i[t-1])/2,e=0;e<t-1;++e)s[e]=2*r[e+1]-i[e+1];return[i,s]}function RG(r){return new u3(r)}function um(r,e){this._context=r,this._t=e}um.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(r,e){switch(r=+r,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(r,e):this._context.moveTo(r,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(r,e);else{var t=this._x*(1-this._t)+r*this._t;this._context.lineTo(t,this._y),this._context.lineTo(t,e)}break}}this._x=r,this._y=e}};function AG(r){return new um(r,.5)}function CG(r){return new um(r,0)}function NG(r){return new um(r,1)}function w2(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function MG(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?w2(Object(t),!0).forEach(function(n){OG(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):w2(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function vc(r){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?vc=function(e){return typeof e}:vc=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vc(r)}function OG(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function ap(){return ap=Object.assign||function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},ap.apply(this,arguments)}function IG(r,e){if(r){if(typeof r=="string")return _2(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return _2(r,e)}}function _2(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}function c3(r,e){var t=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(!t){if(Array.isArray(r)||(t=IG(r))||e){t&&(r=t);var n=0,i=function(){};return{s:i,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,o=!1,a;return{s:function(){t=t.call(r)},n:function(){var l=t.next();return s=l.done,l},e:function(l){o=!0,a=l},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(o)throw a}}}}function kG(r,e){var t=[],n=[];function i(s,o){if(s.length===1)t.push(s[0]),n.push(s[0]);else{for(var a=Array(s.length-1),l=0;l<a.length;l++)l===0&&t.push(s[0]),l===a.length-1&&n.push(s[l+1]),a[l]=[(1-o)*s[l][0]+o*s[l+1][0],(1-o)*s[l][1]+o*s[l+1][1]];i(a,o)}}return r.length&&i(r,e),{left:t,right:n.reverse()}}function PG(r){var e={};return r.length===4&&(e.x2=r[2][0],e.y2=r[2][1]),r.length>=3&&(e.x1=r[1][0],e.y1=r[1][1]),e.x=r[r.length-1][0],e.y=r[r.length-1][1],r.length===4?e.type="C":r.length===3?e.type="Q":e.type="L",e}function FG(r,e){e=e||2;for(var t=[],n=r,i=1/e,s=0;s<e-1;s++){var o=i/(1-i*s),a=kG(n,o);t.push(a.left),n=a.right}return t.push(n),t}function LG(r,e,t){var n=[[r.x,r.y]];return e.x1!=null&&n.push([e.x1,e.y1]),e.x2!=null&&n.push([e.x2,e.y2]),n.push([e.x,e.y]),FG(n,t).map(PG)}var DG=/[MLCSTQAHVZmlcstqahv]|-?[\d.e+-]+/g,ru={M:["x","y"],L:["x","y"],H:["x"],V:["y"],C:["x1","y1","x2","y2","x","y"],S:["x2","y2","x","y"],Q:["x1","y1","x","y"],T:["x","y"],A:["rx","ry","xAxisRotation","largeArcFlag","sweepFlag","x","y"],Z:[]};Object.keys(ru).forEach(function(r){ru[r.toLowerCase()]=ru[r]});function z0(r,e){for(var t=Array(r),n=0;n<r;n++)t[n]=e;return t}function BG(r){return"".concat(r.type).concat(ru[r.type].map(function(e){return r[e]}).join(","))}function UG(r,e){var t={x1:"x",y1:"y",x2:"x",y2:"y"},n=["xAxisRotation","largeArcFlag","sweepFlag"];if(r.type!==e.type&&e.type.toUpperCase()!=="M"){var i={};Object.keys(e).forEach(function(s){var o=e[s],a=r[s];a===void 0&&(n.includes(s)?a=o:(a===void 0&&t[s]&&(a=r[t[s]]),a===void 0&&(a=0))),i[s]=a}),i.type=e.type,r=i}return r}function VG(r,e,t){var n=[];if(e.type==="L"||e.type==="Q"||e.type==="C")n=n.concat(LG(r,e,t));else{var i=ap({},r);i.type==="M"&&(i.type="L"),n=n.concat(z0(t-1).map(function(){return i})),n.push(e)}return n}function x2(r,e,t){var n=r.length-1,i=e.length-1,s=n/i,o=z0(i).reduce(function(l,u,c){var d=Math.floor(s*c);if(t&&d<r.length-1&&t(r[d],r[d+1])){var h=s*c%1<.5;l[d]&&(h?d>0?d-=1:d<r.length-1&&(d+=1):d<r.length-1?d+=1:d>0&&(d-=1))}return l[d]=(l[d]||0)+1,l},[]),a=o.reduce(function(l,u,c){if(c===r.length-1){var d=z0(u,ap({},r[r.length-1]));return d[0].type==="M"&&d.forEach(function(h){h.type="L"}),l.concat(d)}return l.concat(VG(r[c],r[c+1],u))},[]);return a.unshift(r[0]),a}function E2(r){for(var e=(r||"").match(DG)||[],t=[],n,i,s=0;s<e.length;++s)if(n=ru[e[s]],n){i={type:e[s]};for(var o=0;o<n.length;++o)i[n[o]]=+e[s+o+1];s+=n.length,t.push(i)}return t}function jG(r,e,t){var n=r==null?[]:r.slice(),i=e==null?[]:e.slice(),s=vc(t)==="object"?t:{excludeSegment:t,snapEndsToInput:!0},o=s.excludeSegment,a=s.snapEndsToInput;if(!n.length&&!i.length)return function(){return[]};var l=(n.length===0||n[n.length-1].type==="Z")&&(i.length===0||i[i.length-1].type==="Z");n.length>0&&n[n.length-1].type==="Z"&&n.pop(),i.length>0&&i[i.length-1].type==="Z"&&i.pop(),n.length?i.length||i.push(n[0]):n.push(i[0]);var u=Math.abs(i.length-n.length);u!==0&&(i.length>n.length?n=x2(n,i,o):i.length<n.length&&(i=x2(i,n,o))),n=n.map(function(d,h){return UG(d,i[h])});var c=n.map(function(d){return MG({},d)});return l&&(c.push({type:"Z"}),n.push({type:"Z"})),function(h){if(h===1&&a)return e??[];if(h===0)return n;for(var f=0;f<c.length;++f){var m=n[f],p=i[f],g=c[f],v=c3(ru[g.type]),y;try{for(v.s();!(y=v.n()).done;){var b=y.value;g[b]=(1-h)*m[b]+h*p[b],(b==="largeArcFlag"||b==="sweepFlag")&&(g[b]=Math.round(g[b]))}}catch(E){v.e(E)}finally{v.f()}}return c}}function $G(r,e,t){var n=E2(r),i=E2(e),s=vc(t)==="object"?t:{excludeSegment:t,snapEndsToInput:!0},o=s.excludeSegment,a=s.snapEndsToInput;if(!n.length&&!i.length)return function(){return""};var l=jG(n,i,{excludeSegment:o,snapEndsToInput:a});return function(c){if(c===1&&a)return e??"";var d=l(c),h="",f=c3(d),m;try{for(f.s();!(m=f.n()).done;){var p=m.value;h+=BG(p)}}catch(g){f.e(g)}finally{f.f()}return h}}function Bi(r,e,t,n){return Array.isArray(e)&&isFinite(t)?e[t%e.length]:Uc(r,e,t)||(ji(t)?`var(${Qo(t)})`:null)}var jr;(function(r){r.Basis="basis",r.BasisClosed="basisClosed",r.BasisOpen="basisOpen",r.Bundle="bundle",r.Cardinal="cardinal",r.CardinalClosed="cardinalClosed",r.CardinalOpen="cardinalOpen",r.CatmullRom="catmullRom",r.CatmullRomClosed="catmullRomClosed",r.CatmullRomOpen="catmullRomOpen",r.Linear="linear",r.LinearClosed="linearClosed",r.MonotoneX="monotoneX",r.MonotoneY="monotoneY",r.Natural="natural",r.Step="step",r.StepAfter="stepAfter",r.StepBefore="stepBefore"})(jr||(jr={}));const S2={[jr.Basis]:fG,[jr.BasisClosed]:pG,[jr.BasisOpen]:mG,[jr.Bundle]:gG,[jr.Cardinal]:yG,[jr.CardinalClosed]:vG,[jr.CardinalOpen]:bG,[jr.CatmullRom]:wG,[jr.CatmullRomClosed]:_G,[jr.CatmullRomOpen]:xG,[jr.Linear]:KC,[jr.LinearClosed]:EG,[jr.MonotoneX]:SG,[jr.MonotoneY]:TG,[jr.Natural]:RG,[jr.Step]:AG,[jr.StepAfter]:NG,[jr.StepBefore]:CG},zG=Object.assign(Object.assign({},dh),{curveType:jr.MonotoneX,lineWidth:2,lineDashArray:void 0,fallbackValue:void 0,highlightOnHover:!1,cursor:null,interpolateMissingData:!1}),HG=Ea`
  :root {
    --vis-line-cursor: default;
    --vis-line-stroke-dasharray: none;
    --vis-line-stroke-dashoffset: 0;

    --vis-line-gapfill-stroke-dasharray: 2 3;
    --vis-line-gapfill-stroke-opacity: 0.8;
    --vis-line-gapfill-stroke-dashoffset: 0;
  }
`,WG=Pt`
  label: line-component;
`,Gu=Pt`
  label: line;
  transition: opacity 200ms;
  cursor: var(--vis-line-cursor);
`,H0=Pt`
  label: linePath;
  fill: none;
  stroke-dasharray: var(--vis-line-stroke-dasharray);
  stroke-dashoffset: var(--vis-line-stroke-dashoffset);
`,W0=Pt`
  label: lineSelectionHelper;
  fill: none;
  stroke: rgba(0, 0, 0, 0);
  stroke-width: 8px;
`,G0=Pt`
  opacity: 0.2;
`,q0=Pt`
  label: interpolated-path;
  fill: none;
  stroke-dasharray: var(--vis-line-gapfill-stroke-dasharray);
  stroke-dashoffset: var(--vis-line-gapfill-stroke-dashoffset);
  stroke-opacity: var(--vis-line-gapfill-stroke-opacity);
`,GG=Object.freeze(Object.defineProperty({__proto__:null,dim:G0,globalStyles:HG,interpolatedPath:q0,line:Gu,linePath:H0,lineSelectionHelper:W0,root:WG},Symbol.toStringTag,{value:"Module"}));class cm extends om{constructor(e){super(),this._defaultConfig=zG,this.config=this._defaultConfig,this.curve=S2[jr.MonotoneX],this.events={[cm.selectors.line]:{mouseover:this._highlight.bind(this),mouseleave:this._resetHighlight.bind(this)}},e&&this.setConfig(e)}get bleed(){const{config:{lineWidth:e}}=this,t=this.yScale.domain(),i=(this.yScale.range()[0]>this.yScale.range()[1]?ss.North:ss.South)===ss.South,s=e>3,o=e>=10;return{top:!o&&(!i&&t[1]===0||i&&t[0]===0)?0:e/2,bottom:!o&&(!i&&t[0]===0||i&&t[1]===0)?0:e/2,left:s?e/2:0,right:s?e/2:0}}_render(e){super._render(e);const{config:t,datamodel:{data:n}}=this,i=ji(e)?e:t.duration;this.curve=S2[t.curveType],this.lineGen=ZW().x(d=>d.x).y(d=>d.y).defined(d=>d.defined).curve(this.curve);const s=xu(t.y)?t.y:[t.y],o=n.map((d,h)=>this.xScale(zr(d,t.x,h))),a=s.map(d=>{const h=n.map((v,y)=>{const b=zr(v,d,y),E=(ji(b)||b===null)&&isFinite(b)?b:t.fallbackValue,A=t.interpolateMissingData?(ji(b)||b===null)&&isFinite(b):isFinite(E);return{x:o[y],y:this.yScale(E??0),defined:A,value:E}}),f=h.reduce((v,y)=>y.defined||v,!1);let m=!1;const p=h.reduce((v,y,b)=>{!y.defined&&isFinite(t.fallbackValue)&&v.push(Object.assign(Object.assign({},y),{defined:!0})),!y.defined&&!m&&(m=!0);const E=b>0&&!h[b-1].defined||b<h.length-1&&!h[b+1].defined;return y.defined&&E&&(m||v.push(Object.assign(Object.assign({},y),{defined:!1})),v.push(y),m=!1),v},[]),g=f&&h.some(v=>v.value!==null);return{values:h,defined:f,gaps:p,visible:g}}),l=this.g.selectAll(`.${Gu}`).data(a),u=l.enter().append("g").attr("class",Gu);u.append("path").attr("class",H0).attr("stroke",(d,h)=>Bi(n,t.color,h)).attr("stroke-opacity",0).attr("stroke-width",t.lineWidth),u.append("path").attr("class",W0).attr("d",this._emptyPath()),u.append("path").attr("class",q0).attr("d",this._emptyPath()).style("opacity",0);const c=u.merge(l);c.style("cursor",(d,h)=>Uc(n,t.cursor,h)),c.each((d,h,f)=>{var m;const p=ui(f[h]),g=p.select(`.${H0}`),v=p.select(`.${W0}`),y=p.select(`.${q0}`),b=d.visible,E=Iv(n,t.lineDashArray,h),A=an(g,i).attr("stroke",Bi(n,t.color,h)).attr("stroke-width",t.lineWidth).attr("stroke-opacity",b?1:0).style("stroke-dasharray",(m=E?.join(" "))!==null&&m!==void 0?m:null),M=d.values.some(k=>!k.defined),L=this.lineGen(d.values);if(i&&!M){const k=g.attr("d")||this._emptyPath(),P=L||this._emptyPath();A.attrTween("d",()=>$G(k,P))}else d.visible&&A.attr("d",L);v.attr("d",L).attr("visibility",b?null:"hidden"),M&&t.interpolateMissingData?an(y,i).attr("d",this.lineGen(d.gaps)).attr("stroke",Bi(n,t.color,h)).attr("stroke-width",t.lineWidth-1).style("opacity",1):y.transition().duration(i).style("opacity",0)}),an(l.exit(),i).style("opacity",0).remove()}_emptyPath(){const e=this.xScale.range(),t=this.yScale.range();return`M${e[0]},${t[0]} L${e[1]},${t[0]}`}_highlight(e){const{config:t}=this;t.highlightOnHover&&this.g.selectAll(`.${Gu}`).classed(G0,n=>n!==e)}_resetHighlight(){const{config:e}=this;e.highlightOnHover&&this.g.selectAll(`.${Gu}`).classed(G0,!1)}}cm.selectors=GG;function qG({x:r,y:e,w:t,h:n,tl:i=!1,tr:s=!1,bl:o=!1,br:a=!1,r:l=0}){let u;u=`M${r+l},${e}h${t-2*l}`;let c=s?l:0,d=s?0:l;return u+=`a${c},${c} 0 0 1 ${c},${c}`,u+=`h${d}v${d}`,u+=`v${n-2*l}`,c=a?l:0,d=a?0:l,u+=`a${c},${c} 0 0 1 ${-c},${c}`,u+=`v${d}h${-d}`,u+=`h${2*l-t}`,c=o?l:0,d=o?0:l,u+=`a${c},${c} 0 0 1 ${-c},${-c}`,u+=`h${-d}v${-d}`,u+=`v${2*l-n}`,c=i?l:0,d=i?0:l,u+=`a${c},${c} 0 0 1 ${c},${-c}`,u+=`v${-d}h${d}`,u+="z",u}const YG=Object.assign(Object.assign({},dh),{color:void 0,groupMaxWidth:void 0,groupWidth:void 0,dataStep:void 0,groupPadding:.05,barPadding:0,roundedCorners:2,barMinHeight:2,cursor:null,orientation:rp.Vertical}),h3=Pt`
  label: grouped-bar-component;
`,XG=Ea`
  :root {
    --vis-grouped-bar-cursor: default;
    --vis-grouped-bar-fill-color: var(--vis-color-main);
    --vis-grouped-bar-stroke-color: none;
    --vis-grouped-bar-stroke-width: 0px;
    --vis-grouped-bar-hover-stroke-width: 1px;
    --vis-grouped-bar-hover-stroke-color: none;


    /* Dark Theme */
    --vis-dark-grouped-bar-stroke-color: none;
  }

  body.theme-dark ${`.${h3}`} {
    --vis-grouped-bar-stroke-color: var(--vis-dark-grouped-bar-stroke-color);
  }
`,Dd=Pt`
  label: bar;
  fill: var(--vis-grouped-bar-fill-color);
  stroke: var(--vis-grouped-bar-stroke-color);
  stroke-width: var(--vis-grouped-bar-stroke-width);
  cursor: var(--vis-grouped-bar-cursor);

  &:hover {
    stroke-width: var(--vis-grouped-bar-hover-stroke-width);
    stroke: var(--vis-grouped-bar-hover-stroke-color);
  }
`,Y0=Pt`
  label: barGroup;
`,d3=Pt`
  label: barGroupExit;
`,KG=Object.freeze(Object.defineProperty({__proto__:null,bar:Dd,barGroup:Y0,barGroupExit:d3,globalStyles:XG,root:h3},Symbol.toStringTag,{value:"Module"}));class f3 extends om{constructor(e){super(),this._defaultConfig=YG,this.config=this._defaultConfig,this.getAccessors=()=>xu(this.config.y)?this.config.y:[this.config.y],this.events={},this._barData=[],e&&this.setConfig(e)}get bleed(){if(this._barData=this._getVisibleData(),this._barData.length===0)return{top:0,bottom:0,left:0,right:0};const e=!this.isVertical()&&this.dataScale.range()[0]>this.dataScale.range()[1],t=this.dataScale.domain(),n=this._getGroupWidth()/2,i=this._barData.map((f,m)=>zr(f,this.config.x,m)),s=mc(i),o=S0(i),a=this.dataScale(s),l=this.dataScale(o),u=this.dataScale.invert(a+(e?n:-n)),c=this.dataScale.invert(l+(e?-n:n)),d=u<=t[0]?this.dataScale(t[0])-this.dataScale(u):0,h=c>t[1]?this.dataScale(c)-this.dataScale(t[1]):0;return{top:this.isVertical()?0:e?-h:d,bottom:this.isVertical()?0:e?-d:h,left:this.isVertical()?d:0,right:this.isVertical()?h:0}}get dataScale(){return this.isVertical()?this.xScale:this.yScale}get valueScale(){return this.isVertical()?this.yScale:this.xScale}isVertical(){return this.config.orientation===rp.Vertical}_render(e){const{config:t}=this,n=ji(e)?e:t.duration,i=this._getGroupWidth(),s=this.getAccessors(),o=[-i/2,i/2],a=tm().domain(FA(s.length)).range(o).paddingInner(t.barPadding).paddingOuter(t.barPadding),l=this.g.selectAll(`.${Y0}`).data(this._barData,(y,b)=>{var E;return`${(E=Uc(y,t.id,b))!==null&&E!==void 0?E:b}`}),u=(y,b)=>{const E=this.dataScale(zr(y,t.x,b)),A=this.isVertical()?E:0,M=this.isVertical()?0:E;return`translate(${A},${M})`},d=l.enter().append("g").attr("class",Y0).attr("transform",u).style("opacity",1).merge(l);an(d,n).attr("transform",u).style("opacity",1);const h=l.exit().attr("class",d3);an(h,n).style("opacity",0).remove(),an(h.selectAll(`.${Dd}`),n).attr("transform",(y,b,E)=>this.isVertical()?`translate(0,${this.yScale(0)}) scale(1,0)`:`translate(${this.xScale(0)},0) scale(0,1)`);const f=a.bandwidth(),m=d.selectAll(`.${Dd}`).data(y=>s.map(()=>y)),p=this._getValueAxisDirection(),v=m.enter().append("path").attr("class",Dd).attr("d",(y,b)=>{const E=a(b),A=this.valueScale(0),M=f;return this._getBarPath(E,A,M,0,!1,p)}).style("fill",(y,b)=>Bi(y,t.color,b)).merge(m);an(v,n).attr("d",(y,b)=>{const E=a(b),A=f,M=zr(y,s[b]),L=M<0;let k=L?this.valueScale(0):this.valueScale(M||0),P=Math.abs(this.valueScale(0)-this.valueScale(M))||0;if(P<t.barMinHeight){const U=p===ss.North?-1:1;k=this.valueScale(0)+U*t.barMinHeight,P=t.barMinHeight}return this._getBarPath(E,k,A,P,L,p)}).style("fill",(y,b)=>Bi(y,t.color,b)).style("cursor",(y,b)=>Uc(y,t.cursor,b)),an(m.exit(),n).remove()}_getValueAxisDirection(){return this.valueScale.range()[0]>this.valueScale.range()[1]?ss.North:ss.South}_getVisibleData(){const{config:e,datamodel:{data:t}}=this,n=this._getGroupWidth(),i=t.length<2?0:n/2,s=this.dataScale,o=Math.abs(s.invert(i)-s.invert(0));return t?.filter((l,u)=>{const c=zr(l,e.x,u),d=s.domain(),h=+d[0],f=+d[1];return c>=h-o&&c<=f+o})}_getBarPath(e,t,n,i,s,o){const{config:a}=this,l=a.roundedCorners?ji(a.roundedCorners)?+a.roundedCorners:n/2:0,u=ks(l,0,Math.min(i,n)/2),c=o===ss.North,d=this.isVertical()&&s!==c,h=this.isVertical()&&s===c,f=!this.isVertical()&&s,m=!this.isVertical()&&!s;return qG({x:this.isVertical()?e:t+(c?0:-i),y:this.isVertical()?t+(c?0:-i):e,w:this.isVertical()?n:i,h:this.isVertical()?i:n,tl:d||f,tr:d||m,bl:h||f,br:h||m,r:u})}_getGroupWidth(){const{config:e,datamodel:{data:t}}=this;if(CV(t))return 0;if(e.groupWidth)return mc([e.groupWidth,e.groupMaxWidth]);const n=this.dataScale.bandwidth,i=this.dataScale.domain?this.dataScale.domain():[];let o=1+(n?i.length:i[1]-i[0])/e.dataStep||!n&&t.filter((u,c)=>{const d=zr(u,e.x,c);return d>=i[0]&&d<=i[1]}).length||t.length;!n&&o>=2&&(o+=1);const l=(o<2?1:1-e.groupPadding)*(this.isVertical()?this._width:this._height)/o;return mc([l,e.groupMaxWidth])}getValueScaleExtent(e){const{datamodel:t}=this,n=this.getAccessors(),i=e?this._getVisibleData():t.data,s=LA(i,...n),o=DA(i,...n);return[s>0?0:s,o<0?0:o]}getDataScaleExtent(){const{config:e,datamodel:t}=this;return Ad(t.data,e.x)}getYDataExtent(e){return this.isVertical()?this.getValueScaleExtent(e):this.getDataScaleExtent()}getXDataExtent(){return this.isVertical()?this.getDataScaleExtent():this.getValueScaleExtent(!1)}}f3.selectors=KG;function ZG(r){return r}var Bd=1,Ud=2,X0=3,qu=4,T2=1e-6;function QG(r){return"translate("+r+",0)"}function JG(r){return"translate(0,"+r+")"}function eq(r){return e=>+r(e)}function tq(r,e){return e=Math.max(0,r.bandwidth()-e*2)/2,r.round()&&(e=Math.round(e)),t=>+r(t)+e}function rq(){return!this.__axis}function hm(r,e){var t=[],n=null,i=null,s=6,o=6,a=3,l=typeof window<"u"&&window.devicePixelRatio>1?0:.5,u=r===Bd||r===qu?-1:1,c=r===qu||r===Ud?"x":"y",d=r===Bd||r===X0?QG:JG;function h(f){var m=n??(e.ticks?e.ticks.apply(e,t):e.domain()),p=i??(e.tickFormat?e.tickFormat.apply(e,t):ZG),g=Math.max(s,0)+a,v=e.range(),y=+v[0]+l,b=+v[v.length-1]+l,E=(e.bandwidth?tq:eq)(e.copy(),l),A=f.selection?f.selection():f,M=A.selectAll(".domain").data([null]),L=A.selectAll(".tick").data(m,e).order(),k=L.exit(),P=L.enter().append("g").attr("class","tick"),U=L.select("line"),$=L.select("text");M=M.merge(M.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),L=L.merge(P),U=U.merge(P.append("line").attr("stroke","currentColor").attr(c+"2",u*s)),$=$.merge(P.append("text").attr("fill","currentColor").attr(c,u*g).attr("dy",r===Bd?"0em":r===X0?"0.71em":"0.32em")),f!==A&&(M=M.transition(f),L=L.transition(f),U=U.transition(f),$=$.transition(f),k=k.transition(f).attr("opacity",T2).attr("transform",function(V){return isFinite(V=E(V))?d(V+l):this.getAttribute("transform")}),P.attr("opacity",T2).attr("transform",function(V){var R=this.parentNode.__axis;return d((R&&isFinite(R=R(V))?R:E(V))+l)})),k.remove(),M.attr("d",r===qu||r===Ud?o?"M"+u*o+","+y+"H"+l+"V"+b+"H"+u*o:"M"+l+","+y+"V"+b:o?"M"+y+","+u*o+"V"+l+"H"+b+"V"+u*o:"M"+y+","+l+"H"+b),L.attr("opacity",1).attr("transform",function(V){return d(E(V)+l)}),U.attr(c+"2",u*s),$.attr(c,u*g).text(p),A.filter(rq).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",r===Ud?"start":r===qu?"end":"middle"),A.each(function(){this.__axis=E})}return h.scale=function(f){return arguments.length?(e=f,h):e},h.ticks=function(){return t=Array.from(arguments),h},h.tickArguments=function(f){return arguments.length?(t=f==null?[]:Array.from(f),h):t.slice()},h.tickValues=function(f){return arguments.length?(n=f==null?null:Array.from(f),h):n&&n.slice()},h.tickFormat=function(f){return arguments.length?(i=f,h):i},h.tickSize=function(f){return arguments.length?(s=o=+f,h):s},h.tickSizeInner=function(f){return arguments.length?(s=+f,h):s},h.tickSizeOuter=function(f){return arguments.length?(o=+f,h):o},h.tickPadding=function(f){return arguments.length?(a=+f,h):a},h.offset=function(f){return arguments.length?(l=+f,h):l},h}function R2(r){return hm(Bd,r)}function A2(r){return hm(Ud,r)}function C2(r){return hm(X0,r)}function N2(r){return hm(qu,r)}var ha;(function(r){r.Start="start",r.Middle="middle",r.End="end"})(ha||(ha={}));var Ka;(function(r){r.Top="top",r.Middle="middle",r.Bottom="bottom"})(Ka||(Ka={}));var po;(function(r){r.Wrap="wrap",r.Trim="trim"})(po||(po={}));var us;(function(r){r.Left="left",r.Center="center",r.Right="right"})(us||(us={}));var Vd={exports:{}},nq=Vd.exports,M2;function iq(){return M2||(M2=1,(function(r){(function(e){if(typeof t!="function"){var t=function(m){return m};t.nonNative=!0}const n=t("plaintext"),i=t("html"),s=t("comment"),o=/<(\w*)>/g,a=/<\/?([^\s\/>]+)/;function l(m,p,g){m=m||"",p=p||[],g=g||"";let v=c(p,g);return d(m,v)}function u(m,p){m=m||[],p=p||"";let g=c(m,p);return function(y){return d(y||"",g)}}l.init_streaming_mode=u;function c(m,p){return m=h(m),{allowable_tags:m,tag_replacement:p,state:n,tag_buffer:"",depth:0,in_quote_char:""}}function d(m,p){if(typeof m!="string")throw new TypeError("'html' parameter must be a string");let g=p.allowable_tags,v=p.tag_replacement,y=p.state,b=p.tag_buffer,E=p.depth,A=p.in_quote_char,M="";for(let L=0,k=m.length;L<k;L++){let P=m[L];if(y===n)P==="<"?(y=i,b+=P):M+=P;else if(y===i)switch(P){case"<":if(A)break;E++;break;case">":if(A)break;if(E){E--;break}A="",y=n,b+=">",g.has(f(b))?M+=b:M+=v,b="";break;case'"':case"'":P===A?A="":A=A||P,b+=P;break;case"-":b==="<!-"&&(y=s),b+=P;break;case" ":case`
`:if(b==="<"){y=n,M+="< ",b="";break}b+=P;break;default:b+=P;break}else y===s&&(P===">"?(b.slice(-2)=="--"&&(y=n),b=""):b+=P)}return p.state=y,p.tag_buffer=b,p.depth=E,p.in_quote_char=A,M}function h(m){let p=new Set;if(typeof m=="string"){let g;for(;g=o.exec(m);)p.add(g[1])}else!t.nonNative&&typeof m[t.iterator]=="function"?p=new Set(m):typeof m.forEach=="function"&&m.forEach(p.add,p);return p}function f(m){let p=a.exec(m);return p?p[1].toLowerCase():null}r.exports?r.exports=l:e.striptags=l})(nq)})(Vd)),Vd.exports}var sq=iq();const oq=cE(sq);function aq(r){switch(r){case us.Center:return"middle";case us.Right:return"end";case us.Left:default:return"start"}}const lq=r=>{switch(r){case us.Left:return"start";case us.Right:return"end";case us.Center:return"middle";default:return null}};function uq(r){return r.replace(/-([a-z])/g,(e,t)=>t.toUpperCase())}function cq(r){var e;return(e=r.match(/[A-Z]{2,}(?=[A-Z][a-z0-9]*|\b)|[A-Z]?[a-z0-9]*|[A-Z]|[0-9]+/g))===null||e===void 0?void 0:e.filter(Boolean).map(t=>t.toLowerCase()).join("-")}function hq(r){return r.replace(/['"]/g,"&#39;").replace(/\u0000/g,"\\0").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\v/g,"\\v").replace(/\t/g,"\\t").replace(/\f/g,"\\f")}function dq(r,e=15){return r?r.length>e?`${r.substr(r.length-e,e)}`:r:""}function fq(r,e=15){if(!r)return"";const t=Math.floor((e-3)/2);return r.length>e?`${r.substr(0,t)}${r.substr(-t,t)}`:r}function pq(r,e=15){return r?r.length>e?`${r.substr(0,e)}`:r:""}function mq(r,e=15,t=ha.Middle){if(!r)return"";let n=pq(r,e);return t===ha.Start?n=dq(r,e):t===ha.Middle&&(n=fq(r,e)),n}function p3(r,e=[" "]){let t=[r];for(let n=0;n<e.length;n++){const i=e[n];t.forEach((s,o)=>{const a=s.split(i),l=a.map((u,c)=>`${u}${c===a.length-1?"":i}`);t[o]=l}),t=T0(t)}return t}function m3(r,e,t=[" ","-",".",","]){const n=r.text();if(!n)return;const i=xu(t)?t:[t],s=p3(n,i),o=parseFloat(r.attr("x"))||0;r.text("");let a=r.append("tspan").attr("x",o),l=`${s[0]}`;a.text(l),s.forEach((u,c)=>{if(c===0)return;const d=`${l}${u}`;a.text(d),a.node().getComputedTextLength()>e?(a.text(l.trim()),a=r.append("tspan").attr("x",o).attr("dy","1.2em").text(u),l=u):l+=u})}function O2(r,e,t,n,i,s){var o;e===void 0&&(e=50),t===void 0&&(t=ha.Middle),i===void 0&&(i=+((o=window.getComputedStyle(r.node()))===null||o===void 0?void 0:o.fontSize)||0),s===void 0&&(s=oC());const a=r.text()||"",l=a.length,u=i*l*s,d=Math.ceil(l*e/(1.1*u));return d<l?(r.text(mq(a,d,t)),!0):!1}function jd(r,e,t=oC()){return r.length*e*t||0}function $d(r,e,t){const n="http://www.w3.org/2000/svg",i=document.createElementNS(n,"svg"),s=document.createElementNS(n,"text");s.textContent=r,s.setAttribute("font-size",`${t}`),s.setAttribute("font-family",e),i.appendChild(s),document.body.appendChild(i);const o=s.getComputedTextLength();return document.body.removeChild(i),o}function gq(r,e=void 0,t=!0,n=iC,i=!1){var s,o,a;const l=`${r.text}`;if(!l)return[];const u=(s=r.fontSize)!==null&&s!==void 0?s:yc.fontSize,c=(o=r.fontFamily)!==null&&o!==void 0?o:yc.fontFamily,d=(a=r.fontWidthToHeightRatio)!==null&&a!==void 0?a:yc.fontWidthToHeightRatio,h=Array.isArray(n)?n:[n];return l.split(`
`).map(m=>{const p=[];if(!e)return[m];const g=p3(m,h);let v="";for(let y=0;y<g.length;y+=1){(t?jd(v+g[y],u,d):$d(v+g[y],c,u))<e||y===0?v+=g[y]:(p.push(v.trim()),v=g[y]);const E=2;if(i)for(;v.trim().length>E&&(t?jd(v,u,d):$d(v,c,u))>e;){let M=v.trim().length-E;for(;M>0;){const L=`${v.substring(0,M)}${sC}`;if((t?jd(L,u,d):$d(L,c,u))<=e||M===1){p.push(L.trim()),v=v.substring(M);break}M--}}}return v&&p.push(v.trim()),p}).flat()}function yq(r,e=void 0,t=void 0,n=!0,i=iC,s=!1){const o=Array.isArray(r)?r.map(d=>nl(yc,d)):[nl(yc,r)],a=o.map(d=>gq(d,e,n,i,s)),l=o[0];let u=-l.fontSize*(l.lineHeight-1);const c=[];return o.forEach((d,h)=>{var f;let m=a[h];const p=h>0?c[h-1]:void 0,g=p?p.marginBottom:0,v=d.marginTop,y=Math.max(g,v);u+=y;const b=d.fontSize*d.lineHeight;let E=0;for(let A=0;A<m.length;A+=1){let M=m[A];u+=b;const L=`${M} `,k=n?jd(L,d.fontSize,d.fontWidthToHeightRatio):$d(L,d.fontFamily,d.fontSize);if(E=Math.max(k,E),t&&u+b>t&&A!==m.length-1){M.charAt(M.length-1)===sC&&(M=M.substr(0,m[A].length-1)),k<e?m[A]=L:m[A]=`${m[A].substr(0,m[A].length-2)}`,m=m.slice(0,A+1);break}}c.push(Object.assign(Object.assign({},d),{_lines:m,_estimatedHeight:u-(p?._estimatedHeight||0),_maxWidth:Math.max(E,(f=p?._maxWidth)!==null&&f!==void 0?f:0)}))}),c}function vq(r,e=0,t){return r.map((n,i)=>{const s=i>0?r[i-1]:void 0,o=s?s.marginBottom/s.fontSize:0,a=n.marginTop/n.fontSize,l=Math.max(o,a),u={fontSize:n.fontSize,fontFamily:n.fontFamily,fontWeight:n.fontWeight,fill:n.color,y:i===0&&t};return`<tspan xmlns="http://www.w3.org/2000/svg" ${Object.entries(u).filter(([d,h])=>h).map(([d,h])=>`${cq(d)}="${hq(h.toString())}"`).join(" ")}>${n._lines.map((d,h)=>{let f;return i===0&&h===0?f=.8+l:h===0?f=l+n.lineHeight:f=n.lineHeight,`<tspan x="${e}" dy="${f}em">${d.length?d:""}</tspan>`}).join("")}</tspan>`})}function bq(r){return TV(r,e=>e._estimatedHeight)}const wq=["text","tspan","textPath","altGlyph","altGlyphDef","altGlyphItem","glyphRef","textRef","textArea"];function _q(r,e,t,n){var i,s;const o=yq(e,t.width,void 0,t.fastMode,t.separator,t.wordBreak),a=(i=t.x)!==null&&i!==void 0?i:+r.getAttribute("x"),l=(s=t.y)!==null&&s!==void 0?s:+r.getAttribute("y"),u=a??0;let c=l??0;if(t.textAlign&&r.setAttribute("text-anchor",aq(t.textAlign)),t.verticalAlign&&t.verticalAlign!==Ka.Top){const d=bq(o),h=t.verticalAlign===Ka.Middle?-d/2:t.verticalAlign===Ka.Bottom?-d:0;c+=h}t.textRotationAngle?r.setAttribute("transform",`rotate(${t.textRotationAngle===0||t.textRotationAngle?t.textRotationAngle:0} ${u} ${c})`):r.removeAttribute("transform");{const d=new DOMParser;r.textContent="",o.forEach(h=>{const f=vq([h],u,c).join(""),m=oq(f,wq),p=d.parseFromString(m,"image/svg+xml").firstChild;r.appendChild(p)})}}const xq=Object.assign(Object.assign({},dh),{position:void 0,type:void 0,label:void 0,labelFontSize:null,labelTextFitMode:po.Wrap,labelTextTrimType:ha.Middle,gridLine:!0,tickLine:!0,domainLine:!0,numTicks:void 0,minMaxTicksOnly:!1,minMaxTicksOnlyWhenWidthIsLess:250,minMaxTicksOnlyShowGridLines:!1,tickTextWidth:void 0,tickTextSeparator:void 0,tickTextForceWordBreak:!1,tickTextTrimType:ha.Middle,tickTextFitMode:po.Wrap,tickTextFontSize:null,tickTextAlign:void 0,tickTextColor:null,tickTextAngle:void 0,labelMargin:8,labelColor:null,tickFormat:void 0,tickValues:void 0,fullSize:!0,tickPadding:8,tickTextHideOverlapping:void 0});function Eq(r,e){const t="--vis-",n=Object.entries(r);return Object.fromEntries(n.map(([i])=>[uq(i.replace(t,"")),i]))}function Sq(r,e){Ea({":root":r,[`body.theme-dark .${e}`]:Object.keys(r).filter(t=>t.includes("--vis-dark")).map(t=>({[t.replace("--vis-dark","--vis")]:`var(${t})`}))})}const g3=Pt`
  label: axis-component;
`,hb={"--vis-axis-tick-color":"#e8e9ef","--vis-axis-grid-color":"#e8e9ef","--vis-axis-grid-line-width":"1px","--vis-axis-grid-line-dasharray":"none","--vis-axis-label-font-size":"14px","--vis-axis-label-color":"#6c778c","--vis-axis-label-weight":"500","--vis-axis-tick-label-color":"#6c778c","--vis-axis-tick-label-font-size":"12px","--vis-axis-tick-label-weight":"500","--vis-axis-tick-label-cursor":"default","--vis-axis-tick-label-text-decoration":"none","--vis-axis-tick-line-width":"1px","--vis-axis-tick-label-hide-transition":"opacity 400ms ease-in-out","--vis-dark-axis-tick-color":"#6c778c","--vis-dark-axis-tick-label-color":"#e8e9ef","--vis-dark-axis-grid-color":"#6c778c","--vis-dark-axis-label-color":"#fefefe"},Tq=Eq(hb);Sq(hb,g3);const db=Pt`
  label: hide-tick-line;
`,fb=Pt`
  label: hide-domain;
`,y3=Pt`
  label: axis;

  user-select: none;

  .domain {
    stroke: var(--vis-axis-domain-color, var(--vis-axis-tick-color));
    stroke-width: var(--vis-axis-domain-line-width, var(--vis-axis-grid-line-width));
    stroke-dasharray: var(--vis-axis-domain-line-dasharray, var(--vis-axis-grid-line-dasharray));
  }

  &${`.${db}`} {
    .tick > line {
      opacity: 0;
    }
  }

  &${`.${fb}`} {
    .domain {
      opacity: 0;
    }
  }
`,v3=Pt`
  label: grid;

  .domain {
    opacity: 0;
  }

  line {
    stroke: var(--vis-axis-grid-color);
    stroke-width: var(--vis-axis-grid-line-width);
    stroke-dasharray: var(--vis-axis-grid-line-dasharray);
  }
`,b3=Pt`
  label: tick;

  stroke: none;
  font-size: var(--vis-axis-tick-label-font-size);
  font-weight: var(--vis-axis-tick-label-weight);

  line {
    stroke: var(--vis-axis-tick-color);
    stroke-width: var(--vis-axis-tick-line-width);
  }

  text {
    fill: var(--vis-axis-tick-label-color);
    cursor: var(--vis-axis-tick-label-cursor);
    font-family: var(--vis-axis-font-family, var(--vis-font-family));
    text-decoration: var(--vis-axis-tick-label-text-decoration);
    stroke: none;
  }
`,K0=Pt`
  label: tick-text-exiting;
`,Z0=Pt`
  label: label;
  fill: var(--vis-axis-label-color);
  font-size: var(--vis-axis-label-font-size);
  font-weight: var(--vis-axis-label-weight);
  font-family: var(--vis-axis-font-family, var(--vis-font-family));
  text-anchor: middle;
`,w3=Pt`
  label: tick-label;
`,_3=Pt`
  label: tick-label-hideable;
  opacity: 0;
  transition: var(--vis-axis-tick-label-hide-transition);
`,Rq=Object.freeze(Object.defineProperty({__proto__:null,axis:y3,cssVarDefaults:hb,grid:v3,hideDomain:fb,hideTickLine:db,label:Z0,root:g3,tick:b3,tickLabel:w3,tickLabelHideable:_3,tickTextExiting:K0,variables:Tq},Symbol.toStringTag,{value:"Module"}));class x3 extends om{constructor(e){super(),this._defaultConfig=xq,this.config=this._defaultConfig,this._defaultNumTicks=3,this.events={},e&&this.setConfig(e),this.axisGroup=this.g.append("g"),this.gridGroup=this.g.append("g").attr("class",v3)}preRender(){const{config:e}=this,t=this.g.append("g").attr("opacity",0);this._renderAxis(t,0),this._axisRawBBox=t.node().getBBox(),e.tickTextAlign&&this._alignTickLabels(),this._renderAxisLabel(t),this._axisSizeBBox=this._getAxisSize(t),this._requiredMargin=this._getRequiredMargin(this._axisSizeBBox),t.remove()}getPosition(){const{config:{type:e,position:t}}=this;return t??(e===tr.X?nt.Bottom:nt.Left)}_getAxisSize(e){return e.node().getBBox()}_getRequiredMargin(e=this._axisSizeBBox){const{config:{type:t,position:n}}=this;switch(t){case tr.X:{const s=this._axisSizeBBox.x+this._axisSizeBBox.width,o=this._axisSizeBBox.x<0?Math.abs(this._axisSizeBBox.x):0,a=s-this._width>1?s-this._width:0;switch(n){case nt.Top:return{top:e.height,left:o,right:a};case nt.Bottom:default:return{bottom:e.height,left:o,right:a}}}case tr.Y:{const i=e.height>this._height?(e.height-this._height)/2:0,s=i,o=i;switch(n){case nt.Right:return{right:e.width,top:s,bottom:o};case nt.Left:default:return{left:e.width,top:s,bottom:o}}}}}getRequiredMargin(){return this._requiredMargin}getOffset(e){const{config:{type:t,position:n}}=this;switch(t){case tr.X:switch(n){case nt.Top:return{top:e.top,left:e.left};case nt.Bottom:default:return{top:e.top+this._height,left:e.left}}case tr.Y:switch(n){case nt.Right:return{top:e.top,left:e.left+this._width};case nt.Left:default:return{top:e.top,left:e.left}}}}_render(e=this.config.duration,t=this.axisGroup){const{config:n}=this;if(this._renderAxis(t,e),this._renderAxisLabel(t),n.gridLine){const i=this._buildGrid();this.gridGroup.selectAll("*").interrupt(),an(this.gridGroup,e).call(i).style("opacity",1)}else an(this.gridGroup,e).style("opacity",0);n.tickTextAlign&&this._alignTickLabels(),this._resolveTickLabelOverlap(t)}_buildAxis(){const{config:{type:e,position:t,tickPadding:n}}=this,i=this._getNumTicks();switch(e){case tr.X:switch(t){case nt.Top:return R2(this.xScale).ticks(i).tickPadding(n);case nt.Bottom:default:return C2(this.xScale).ticks(i).tickPadding(n)}case tr.Y:switch(t){case nt.Right:return A2(this.yScale).ticks(i).tickPadding(n);case nt.Left:default:return N2(this.yScale).ticks(i).tickPadding(n)}}}_buildGrid(){const{config:e}=this;let t;switch(e.type){case tr.X:switch(e.position){case nt.Top:{t=R2(this.xScale);break}case nt.Bottom:default:{t=C2(this.xScale);break}}t.tickSize(-this._height);break;case tr.Y:switch(e.position){case nt.Right:{t=A2(this.yScale);break}case nt.Left:default:{t=N2(this.yScale);break}}t.tickSize(-this._width)}t.tickSizeOuter(0).tickFormat(()=>"");const n=this._getNumTicks()*2,i=t.scale(),s=i.domain(),o=()=>{if(!e.minMaxTicksOnlyShowGridLines)return s;const l=i.ticks(n);if(l.length<2)return s;const u=+l[1]-+l[0],c=s[1];return+c-+l[l.length-1]>u/2?[...l,c]:l},a=e.tickValues?this._getConfiguredTickValues():this._shouldRenderMinMaxTicksOnly()?o():i.ticks(n);return t.tickValues(a),t}_renderAxis(e=this.axisGroup,t=this.config.duration){const{config:n}=this,i=this._buildAxis(),s=i.scale(),o=n.tickValues?this._getConfiguredTickValues():this._shouldRenderMinMaxTicksOnly()?s.domain():s.ticks(this._getNumTicks()),a=o.length;i.tickValues(o),e.selectAll("*").interrupt(),an(e,t).call(i).on("end",()=>{this._resolveTickLabelOverlap(e)}),e.selectAll("g.tick").classed(b3,!0).style("font-size",n.tickTextFontSize);const c=e.selectAll("g.tick > text").filter(d=>o.some(h=>rl(d,h))).classed(w3,!0).classed(_3,!!n.tickTextHideOverlapping).style("fill",n.tickTextColor);if(e.selectAll("g.tick > text").filter(d=>!o.some(h=>rl(d,h))).classed(K0,!0),c.nodes().forEach(d=>$v(d)),c.each((d,h,f)=>{var m,p;let g=(p=(m=n.tickFormat)===null||m===void 0?void 0:m.call(n,d,h,o))!==null&&p!==void 0?p:`${d}`;const v=f[h],y=n.tickTextWidth||(n.type===tr.X?this._containerWidth/(a+1):this._containerWidth/5),b=getComputedStyle(v),E=Number.parseFloat(b.fontSize),A=b.fontFamily,M={verticalAlign:n.type===tr.X?Ka.Top:Ka.Middle,width:y,textRotationAngle:n.tickTextAngle,separator:n.tickTextSeparator,wordBreak:n.tickTextForceWordBreak};if(n.tickTextFitMode===po.Trim){const k=ui(v).text(g);O2(k,y,n.tickTextTrimType,!0,E,.58),g=ui(v).text()}_q(v,{text:g,fontFamily:A,fontSize:E},M)}),e.classed(y3,!0).classed(db,!n.tickLine).classed(fb,!n.domainLine),n.fullSize){const d=this._getFullDomainPath(0);an(e.select(".domain"),t).attr("d",d)}}_resolveTickLabelOverlap(e=this.axisGroup){const{config:t}=this,n=e.selectAll(`g.tick > text:not(.${K0})`);if(!t.tickTextHideOverlapping){n.style("opacity",null);return}cancelAnimationFrame(this._collideTickLabelsAnimFrameId),this._collideTickLabelsAnimFrameId=requestAnimationFrame(()=>{this._collideTickLabels(n)})}_collideTickLabels(e){e.each((n,i,s)=>{const o=s[i];o._visible=!0});const t=3;for(let n=0;n<t;n+=1)e.each((i,s,o)=>{const a=o[s];if(!a._visible)return;const u=a.getBoundingClientRect();for(let c=s+1;c<o.length;c+=1){if(s===c)continue;const d=o[c];if(d._visible){const f=d.getBoundingClientRect();if(zj(u,f,-5)){d._visible=!1;break}}}});e.each((n,i,s)=>{const o=s[i];ui(o).style("opacity",o._visible?1:0)})}_getNumTicks(){const{config:{type:e,numTicks:t}}=this;if(t)return t;if(e===tr.X){const n=this.xScale.range(),i=n[1]-n[0];return Math.floor(i/175)}if(e===tr.Y){const n=this.yScale.range(),i=Math.abs(n[0]-n[1]);return Math.pow(i,.85)/25}return this._defaultNumTicks}_getConfiguredTickValues(){const{config:e}=this,t=e.type===tr.X?this.xScale:this.yScale,n=t?.domain();return e.tickValues?e.tickValues.filter(i=>i>=n[0]&&i<=n[1]):null}_shouldRenderMinMaxTicksOnly(){const{config:e}=this;return e.minMaxTicksOnly||e.type===tr.X&&this._width<e.minMaxTicksOnlyWhenWidthIsLess}_getFullDomainPath(e=0){const{config:{type:t}}=this;switch(t){case tr.X:return`M0.5, ${e} V0.5 H${this._width+.5} V${e}`;case tr.Y:return`M${-e}, ${this._height+.5} H0.5 V0.5 H${-e}`}}_renderAxisLabel(e=this.axisGroup){var t;const{type:n,label:i,labelMargin:s,labelFontSize:o,labelTextFitMode:a}=this.config;if(e.selectAll(`.${Z0}`).remove(),!i)return;const l=this.getPosition(),{width:u,height:c}=(t=this._axisRawBBox)!==null&&t!==void 0?t:e.node().getBBox(),d=n===tr.Y?-90:0,h=e.append("text").attr("class",Z0).attr("dy",`${this._getLabelDY()}em`).style("font-size",o).style("fill",this.config.labelColor);h.text(i);let f=!1;if(a===po.Wrap){const E=n===tr.Y?this._height:this._width;h.node().getComputedTextLength()>E&&(m3(h,E),f=!0)}let m=u,p=c;if(a===po.Wrap){const E=h.node().getBBox();m=E.width,p=E.height}else{const E=n===tr.X?m:p,A=getComputedStyle(h.node()),M=Number.parseFloat(A.fontSize);O2(h,E,this.config.labelTextTrimType,!0,M);const L=h.node().getBBox();m=L.width,p=L.height}const g=n===tr.X?this._width/2:n===tr.Y&&a===po.Wrap&&f?l===nt.Left?-u-p/2-10:u:Math.pow(-1,+(l===nt.Left))*u,v=n===tr.Y?this._height/2:n===tr.X&&a===po.Wrap?l===nt.Top?-c-p/2:c:Math.pow(-1,+(l===nt.Top))*c,y=n===tr.X?0:Math.pow(-1,+(l===nt.Left))*s,b=n===tr.X?Math.pow(-1,+(l===nt.Top))*s:0;h.attr("transform",`translate(${g+y},${v+b}) rotate(${d})`)}_getLabelDY(){const{type:e,position:t}=this.config;switch(e){case tr.X:switch(t){case nt.Top:return 0;case nt.Bottom:default:return .75}case tr.Y:switch(t){case nt.Right:return .75;case nt.Left:default:return-.25}}}_alignTickLabels(){const{config:{type:e,tickTextAlign:t,tickTextAngle:n,position:i}}=this,s=this.g.selectAll("g.tick > text"),o=lq(t),a=e===tr.X?0:this._getYTickTextTranslate(t,i),l=n?`translate(${a},0) rotate(${n})`:`translate(${a},0)`;s.attr("transform",l).attr("text-anchor",o)}_getYTickTextTranslate(e,t=nt.Left){var n,i,s,o;const a=this.config.tickPadding+1,l=((o=(i=(n=this._axisRawBBox)===null||n===void 0?void 0:n.width)!==null&&i!==void 0?i:(s=this.axisGroup.node())===null||s===void 0?void 0:s.getBBox().width)!==null&&o!==void 0?o:0)-a;switch(e){case us.Left:return t===nt.Left?l*-1:0;case us.Right:return t===nt.Left?0:l;case us.Center:return t===nt.Left?l*-.5:l*.5;default:return 0}}}x3.selectors=Rq;var Ts;(function(r){r.Circle="circle",r.Cross="cross",r.Diamond="diamond",r.Square="square",r.Star="star",r.Triangle="triangle",r.Wye="wye"})(Ts||(Ts={}));const Aq={[Ts.Circle]:ZC,[Ts.Cross]:tG,[Ts.Diamond]:nG,[Ts.Square]:iG,[Ts.Star]:lG,[Ts.Triangle]:uG,[Ts.Wye]:hG},vi=Object.assign(Object.assign({},Ts),{Line:"line"});var lp;(function(r){r.Horizontal="horizontal",r.Vertical="vertical"})(lp||(lp={}));const Cq={items:[],labelClassName:"",onLegendItemClick:void 0,labelFontSize:null,labelMaxWidth:null,bulletSize:null,bulletSpacing:4,bulletShape:r=>{var e;return(e=r.shape)!==null&&e!==void 0?e:vi.Circle},orientation:lp.Horizontal,renderIntoProvidedDomNode:!1},sd=Wc*3,Nq={[vi.Circle]:Math.PI/4,[vi.Cross]:5/9,[vi.Diamond]:Math.sqrt(3)/6,[vi.Square]:1,[vi.Star]:.3,[vi.Triangle]:Math.sqrt(3)/4,[vi.Wye]:5/11};function E3(r,e,t){return e<1?0:r*e+t*(e-1)}function Mq(r){r.each((e,t,n)=>{ui(n[t]).append("svg").attr("width","100%").attr("height","100%").append("path")})}function Oq(r,e,t){r.each((n,i,s)=>{var o;const a=Uc(n,e.bulletShape,i),l=OV((o=n.color)!==null&&o!==void 0?o:Bi(n,t,i)),u=l.length,c=sd,d=N0(getComputedStyle(s[i]).getPropertyValue("--vis-legend-bullet-size")),h=e.bulletSpacing*(sd/d),f=E3(c,u,h),m=a===vi.Line?sd/2.5:sd,p=ui(s[i]).select("svg").attr("viewBox",`0 0 ${f} ${m}`);p.selectAll("path").remove();const g=n.inactive?"var(--vis-legend-bullet-inactive-opacity)":1;l.forEach((v,y)=>{const b=p.append("path");if(a===vi.Line){const E=y*(c+h),A=E+c;b.attr("d",`M${E},${m/2} L${A},${m/2}`).attr("transform",null).style("opacity",g).style("stroke",v).style("stroke-width","3px").style("fill",null).style("fill-opacity",null).style("marker-start","none").style("marker-end","none")}else{const E=dG().type(Aq[a]).size(c*m*Nq[a]),A=(c-2)/c;let M=m/2;switch(a){case vi.Triangle:M+=m/8;break;case vi.Star:M+=m/16;break;case vi.Wye:M-=m/16;break}const L=y*(c+h)+c/2;b.attr("d",E).attr("transform",`translate(${L}, ${Math.round(M)}) scale(${A})`).style("stroke",v).style("stroke-width","1px").style("opacity",null).style("fill",v).style("fill-opacity",g)}})})}const pb=Pt`
  label: bullet-legend-component;
`,Iq=Ea`
  :root {
    // Undefined by default to allow proper fallback to var(--vis-font-family)
    /* --vis-legend-font-family: */

    --vis-legend-label-color: #6c778c;
    --vis-legend-label-max-width: 300px;
    --vis-legend-label-font-size: 12px;
    --vis-legend-bullet-size: 9px;
    --vis-legend-bullet-inactive-opacity: 0.15;
    --vis-legend-item-spacing: 20px;
    --vis-legend-vertical-item-spacing: 5px;
    --vis-legend-bullet-label-spacing: 8px;

    --vis-dark-legend-label-color: #eee;
  }

  body.theme-dark ${`.${pb}`} {
    --vis-legend-label-color: var(--vis-dark-legend-label-color);
  }

  body.theme-patterns {
    --vis-legend-bullet-size: 14px;
  }
`,zd=Pt`
  label: legendItem;
  display: inline-flex;
  align-items: center;
  font-family: var(--vis-legend-font-family, var(--vis-font-family));
  margin-right: var(--vis-legend-item-spacing);
  white-space: nowrap;
  cursor: default;
  user-select: none;
  max-width: min-content;
`,S3=Pt`
  label: legendItemVertical;
  display: flex;
  margin-top: var(--vis-legend-vertical-item-spacing);
`,T3=Pt`
  cursor: pointer;
`,Q0=Pt`
  label: legendItemLabel;
  font-size: var(--vis-legend-label-font-size);
  display: inline-block;
  vertical-align: middle;
  color: var(--vis-legend-label-color);
  max-width: var(--vis-legend-label-max-width);
  text-overflow: ellipsis;
  overflow: hidden;
  white-space: nowrap;
`,J0=Pt`
  flex: 0 0 auto;
  label: legendItemBullet;
  margin-right: var(--vis-legend-bullet-label-spacing);
  height: var(--vis-legend-bullet-size);
  width: var(--vis-legend-bullet-size);

  svg {
    display: block;
  }
`,kq=Object.freeze(Object.defineProperty({__proto__:null,bullet:J0,clickable:T3,item:zd,itemVertical:S3,label:Q0,root:pb,variables:Iq},Symbol.toStringTag,{value:"Module"}));class R3{constructor(e,t){this._defaultConfig=Cq,this.config=this._defaultConfig,this._colorAccessor=n=>n.color,this._container=e,this.div=t?.renderIntoProvidedDomNode?ui(this._container):ui(this._container).append("div"),this.div.classed(pb,!0),this.element=this.div.node(),t&&this.update(t)}update(e){this.prevConfig=this.config,this.config=nl(this._defaultConfig,e),this.render()}render(){const{config:e}=this,t=this.div.selectAll(`.${zd}`).data(e.items),n=t.enter().append("div").on("click",this._onItemClick.bind(this)),i=n.merge(t);i.attr("class",s=>{var o;return`${zd} ${(o=s.className)!==null&&o!==void 0?o:""}`}).classed(S3,e.orientation===lp.Vertical).classed(T3,s=>!!e.onLegendItemClick&&this._isItemClickable(s)).attr("title",s=>s.name).style("display",s=>s.hidden?"none":null),n.append("span").attr("class",J0).call(Mq),i.select(`.${J0}`).style("width",function(s){const a=(Array.isArray(s.color)?s.color:[s.color]).length,l=N0(getComputedStyle(this).getPropertyValue("--vis-legend-bullet-size"))||9,u=e.bulletSize?N0(e.bulletSize):l,c=e.bulletSpacing;return`${E3(u,a,c)}px`}).style("height",e.bulletSize).style("box-sizing","content-box").call(Oq,this.config,this._colorAccessor),n.append("span").attr("class",Q0).classed(e.labelClassName,!0).style("max-width",e.labelMaxWidth).style("font-size",e.labelFontSize),i.select(`.${Q0}`).text(s=>s.name),t.exit().remove()}_isItemClickable(e){return e.pointer===void 0?!0:e.pointer}_onItemClick(e,t){const{config:{onLegendItemClick:n}}=this,s=this.div.selectAll(`.${zd}`).nodes().indexOf(e.currentTarget);n&&n(t,s)}destroy(){this.element!==this._container&&this.div.remove()}}R3.selectors=kq;const Pq=Object.assign(Object.assign({},dh),{yStacked:void 0,baseline:null,duration:100,tooltip:void 0,template:(r,e,t,n)=>"",hideWhenFarFromPointer:!0,hideWhenFarFromPointerDistance:100,snapToData:!0,getCircles:void 0,color:void 0,strokeColor:void 0,strokeWidth:void 0,onCrosshairMove:void 0,forceShowAt:void 0,skipRangeCheck:!1}),Fq=Ea`
  :root {
    --vis-crosshair-line-stroke-color: #888;
    --vis-crosshair-line-stroke-width: 1px;
    --vis-crosshair-line-stroke-opacity: 1;
    --vis-crosshair-circle-stroke-color: #fff;
    --vis-crosshair-circle-stroke-width: 1px;
    --vis-crosshair-circle-stroke-opacity: 0.75;
  }
`,Lq=Pt`
  label: crosshair-component;
`,A3=Pt`
  stroke: var(--vis-crosshair-line-stroke-color);
  stroke-width: var(--vis-crosshair-line-stroke-width);
  stroke-opacity: var(--vis-crosshair-line-stroke-opacity);
  pointer-events: none;
`,C3=Pt`
  stroke: var(--vis-crosshair-circle-stroke-color);
  stroke-width: var(--vis-crosshair-circle-stroke-width);
  stroke-opacity: var(--vis-crosshair-circle-stroke-opacity);
  pointer-events: none;
`,Dq=Object.freeze(Object.defineProperty({__proto__:null,circle:C3,globalStyles:Fq,line:A3,root:Lq},Symbol.toStringTag,{value:"Module"}));class N3 extends om{constructor(e){super(),this.clippable=!0,this._defaultConfig=Pq,this.config=this._defaultConfig,this._xPx=void 0,this._yPx=void 0,this._mouseEvent=void 0,this._animFrameId=null,this._accessors={x:void 0,y:void 0,yStacked:void 0,baseline:void 0},e&&this.setConfig(e),this.g.style("opacity",0),this.line=this.g.append("line").attr("class",A3)}set accessors(e){this._accessors=e}get accessors(){var e;const{config:t}=this,n=!!(t.x||t.y||t.yStacked),i=n?t.x:this._accessors.x,s=n?t.y:this._accessors.y,o=s?xu(s)?s:[s]:void 0,a=n?t.yStacked:this._accessors.yStacked,l=(e=t.baseline)!==null&&e!==void 0?e:this._accessors.baseline;return{x:i,y:o,yStacked:a,baseline:l}}_isContainerInViewport(){var e;if(!(!((e=this.container)===null||e===void 0)&&e.node()))return!1;const t=this.container.node().getBoundingClientRect(),n=window.innerWidth||document.documentElement.clientWidth,i=window.innerHeight||document.documentElement.clientHeight,s=Math.max(0,Math.min(t.right,n)-Math.max(t.left,0)),o=Math.max(0,Math.min(t.bottom,i)-Math.max(t.top,0)),a=t.width*t.height,l=s*o;return a>0&&l/a>=.35}setContainer(e){this.container!==e&&(this.container=e,this.container.on("mousemove.crosshair",this._onMouseMove.bind(this)),this.container.on("mouseout.crosshair",this._onMouseOut.bind(this)),this.container.on("wheel.crosshair",this._onWheel.bind(this)))}_render(e){var t,n,i,s,o;const{config:a,datamodel:l}=this,u=ji(e)?e:a.duration,c=a.forceShowAt!==void 0,d=c?this.xScale(a.forceShowAt):this._xPx,h=this.xScale.invert(d),f=!((t=l.data)===null||t===void 0)&&t.length&&this.accessors.x?l.data.indexOf($f(l.data,h,this.accessors.x,go.Left)):void 0;let m,p;a.snapToData&&(!this.accessors.y&&!this.accessors.yStacked&&(!((n=l.data)===null||n===void 0)&&n.length)&&console.warn("Unovis | Crosshair: Y accessors have not been configured. Please check if they're present in the configuration object"),!(!((i=l.data)===null||i===void 0)&&i.length)&&this._mouseEvent&&console.warn("Unovis | Crosshair: No data to snap to. Make sure the data has been passed to the container or to the crosshair itself"),m=$f(l.data,h,this.accessors.x),p=l.data.indexOf(m));const g=this.xScale.range(),v=this.yScale.range(),y=a.snapToData&&m?ks(Math.round(this.xScale(zr(m,this.accessors.x,p))),0,this._width):ks(d,g[0],g[1]),b=d>=g[0]&&d<=g[1],E=this._yPx>=Math.min(v[0],v[1])&&this._yPx<=Math.max(v[0],v[1]);let A=a.skipRangeCheck?!!this._xPx:this._xPx?b&&E:b;a.hideWhenFarFromPointer&&Math.abs(y-+d)>=a.hideWhenFarFromPointerDistance&&(A=!1);const M=(s=a.tooltip)!==null&&s!==void 0?s:this.tooltip;if(A&&M&&this._isContainerInViewport()){const U=M.getContainer()||this.container.node(),$=M.isContainerBody();if(c){const V=this.container.node().getBoundingClientRect(),R=($?d+V.left:d)+this._containerMargin.left,O=this._height/2+($?V.top:0),T=[R,O];this._showTooltip(m,h,T,f)}else if(this._mouseEvent){const V=$?[this._mouseEvent.clientX,this._mouseEvent.clientY]:Df(this._mouseEvent,U);this._showTooltip(m,h,V,f)}}else this._hideTooltip();if(this._mouseEvent&&((o=a.onCrosshairMove)===null||o===void 0||o.call(a,A?this.xScale.invert(this._xPx):void 0,m,p,this._mouseEvent),this._mouseEvent=void 0),an(this.g,u).style("opacity",A?1:0),!isFinite(d))return;this.line.attr("y1",0).attr("y2",this._height),an(this.line,u,V_).attr("x1",y).attr("x2",y);const L=Ov(a.getCircles)?a.getCircles(h,l.data,this.yScale,f):this.getCircleData(m,p),k=this.g.selectAll("circle").data(L,(U,$)=>{var V;return(V=U.id)!==null&&V!==void 0?V:$}),P=k.enter().append("circle").attr("class",C3).attr("r",0).attr("cx",y).attr("cy",U=>U.y).style("fill",U=>U.color).style("stroke",U=>U.strokeColor).style("stroke-width",U=>U.strokeWidth);an(P.merge(k),u,V_).attr("cx",y).attr("cy",U=>U.y).attr("r",4).style("opacity",U=>U.opacity).style("fill",U=>U.color).style("stroke",U=>U.strokeColor).style("stroke-width",U=>U.strokeWidth),k.exit().remove()}hide(e){window.cancelAnimationFrame(this._animFrameId),this._animFrameId=window.requestAnimationFrame(()=>{var t,n;this._xPx=void 0,this._yPx=void 0,this._mouseEvent=void 0,(n=(t=this.config).onCrosshairMove)===null||n===void 0||n.call(t,void 0,void 0,void 0,e),this._render()})}_onMouseMove(e){var t;const{datamodel:n,element:i}=this;!this.accessors.x&&(!((t=n.data)===null||t===void 0)&&t.length)&&console.warn("Unovis | Crosshair: X accessor function has not been configured. Please check if it's present in the configuration object");const[s,o]=Df(e,i);this._xPx=s,this._yPx=o,this._mouseEvent=e,window.cancelAnimationFrame(this._animFrameId),this._animFrameId=window.requestAnimationFrame(()=>{this._render()})}_onMouseOut(e){var t;(!e||!(!((t=this.container)===null||t===void 0)&&t.node().contains(e.relatedTarget)))&&this.hide(e)}_onWheel(e){this.hide(e)}_showTooltip(e,t,n,i){var s;const{config:o,datamodel:a}=this,l=(s=o.tooltip)!==null&&s!==void 0?s:this.tooltip;if(!l||!n)return;const[u,c]=n,d=o.template(e,t,a.data,i);if(l.config.followCursor=!0,!l.config.horizontalPlacement||l.config.horizontalPlacement===nt.Auto){const h=l.isContainerBody()?u-this.container.node().getBoundingClientRect().left:u;l.overrideHorizontalPlacement(h>this._containerWidth/2?nt.Left:nt.Right)}d&&l.show(d,{x:u,y:c})}_hideTooltip(){var e;const{config:t}=this,n=(e=t.tooltip)!==null&&e!==void 0?e:this.tooltip;n?.hide()}getYDataExtent(){return[void 0,void 0]}getCircleData(e,t){var n,i;const{config:s}=this;if(s.snapToData&&e){const o=(n=this.accessors.y)!==null&&n!==void 0?n:[],a=(i=this.accessors.yStacked)!==null&&i!==void 0?i:[],l=zr(e,this.accessors.baseline,t)||0,u=NV(e,t,...a).map((d,h)=>({y:this.yScale(d+l),opacity:ji(zr(e,a[h],h))?1:0,color:Bi(e,s.color,h),strokeColor:s.strokeColor?Bi(e,s.strokeColor,h):void 0,strokeWidth:s.strokeWidth?zr(e,s.strokeWidth,h):void 0})),c=o.map((d,h)=>{const f=zr(e,d,t);return{y:this.yScale(f),opacity:ji(f)?1:0,color:Bi(e,s.color,u.length+h),strokeColor:s.strokeColor?Bi(e,s.strokeColor,h):void 0,strokeWidth:s.strokeWidth?zr(e,s.strokeWidth,h):void 0}});return u.concat(c)}return[]}}N3.selectors=Dq;const Bq=Object.assign(Object.assign({},sb),{id:(r,e)=>{var t;return(t=r.id)!==null&&t!==void 0?t:e},value:void 0,angleRange:[0,2*Math.PI],padAngle:0,sortFunction:void 0,cornerRadius:0,color:void 0,radius:void 0,arcWidth:20,centralLabel:void 0,centralSubLabel:void 0,centralSubLabelWrap:!0,showEmptySegments:!1,emptySegmentAngle:.5*Math.PI/180,showBackground:!0,backgroundAngleRange:void 0,centralLabelOffsetX:void 0,centralLabelOffsetY:void 0});function Uq(r,e){r.style("fill",t=>Bi(t.data,e.color,t.index)).style("opacity",0).each((t,n,i)=>{const s=i[n],o=(t.startAngle+t.endAngle)/2,a=(t.endAngle-t.startAngle)/2;s._animState={startAngle:o-a,endAngle:o+a,innerRadius:t.innerRadius,outerRadius:t.outerRadius,padAngle:t.padAngle}})}function Vq(r,e,t,n){r.style("transition",`fill ${n}ms`).style("fill",s=>Bi(s.data,e.color,s.index));const i=s=>e.showEmptySegments||s.value?1:0;n?an(r,n).style("opacity",i).attrTween("d",(o,a,l)=>{const u=l[a],c={startAngle:o.startAngle,endAngle:o.endAngle,innerRadius:o.innerRadius,outerRadius:o.outerRadius,padAngle:o.padAngle},d=hl(u._animState,c);return h=>(u._animState=d(h),t(u._animState))}):r.attr("d",t).style("opacity",i)}function jq(r,e){an(r,e).style("opacity",0).remove()}const M3=Array.from({length:4},(r,e)=>{const t=-Math.PI/2+e*Math.PI/2;return[t,t+Math.PI]}),[TK,RK,AK,CK]=M3,O3=Pt`
  label: donut-component;
`,$q=Ea`
  :root {
    --vis-donut-central-label-font-size: 16px;
    --vis-donut-central-label-text-color: #5b5f6d;
    // Undefined by default to allow proper fallback to var(--vis-font-family)
    /* --vis-donut-central-label-font-family: */
    --vis-donut-central-label-font-weight: 600;

    --vis-donut-central-sub-label-font-size: 12px;
    --vis-donut-central-sub-label-text-color: #5b5f6d;
    // Undefined by default to allow proper fallback to var(--vis-font-family)
    /* --vis-donut-central-sub-label-font-family: */
    --vis-donut-central-sub-label-font-weight: 500;

    --vis-donut-background-color: #E7E9F3;
    --vis-donut-segment-stroke-width: 0;
    // The line segment color variable is not defined by default
    // to allow it to fallback to the donut background color
    /* --vis-donut-segment-stroke-color: none; */

    --vis-dark-donut-central-label-text-color: #C2BECE;
    --vis-dark-donut-central-sub-label-text-color: #C2BECE;
    --vis-dark-donut-background-color: #18160C;
  }

  body.theme-dark ${`.${O3}`} {
    --vis-donut-central-label-text-color: var(--vis-dark-donut-central-label-text-color);
    --vis-donut-central-sub-label-text-color: var(--vis-dark-donut-central-sub-label-text-color);
    --vis-donut-background-color: var(--vis-dark-donut-background-color);
  }
`,I3=Pt`
  label: background;
  fill: var(--vis-donut-background-color);
`,ey=Pt`
  label: segment;
  stroke-width: var(--vis-donut-segment-stroke-width);
  stroke: var(--vis-donut-segment-stroke-color, var(--vis-donut-background-color));
`,k3=Pt`
  label: segment-exit;
`,P3=Pt`
  label: central-label;
  text-anchor: middle;
  dominant-baseline: middle;
  font-size: var(--vis-donut-central-label-font-size);
  font-family: var(--vis-donut-central-label-font-family, var(--vis-font-family));
  font-weight: var(--vis-donut-central-label-font-weight);
  fill: var(--vis-donut-central-label-text-color);
`,F3=Pt`
  label: central-label;
  text-anchor: middle;
  dominant-baseline: middle;
  font-size: var(--vis-donut-central-sub-label-font-size);
  font-family: var(--vis-donut-central-sub-label-font-family, var(--vis-font-family));
  font-weight: var(--vis-donut-central-sub-label-font-weight);
  fill: var(--vis-donut-central-sub-label-text-color);
`,zq=Object.freeze(Object.defineProperty({__proto__:null,background:I3,centralLabel:P3,centralSubLabel:F3,root:O3,segment:ey,segmentExit:k3,variables:$q},Symbol.toStringTag,{value:"Module"}));class dm extends $C{constructor(e){super(),this._defaultConfig=Bq,this.config=this._defaultConfig,this.datamodel=new zC,this.arcGen=YW(),this.events={},e&&this.setConfig(e),this.arcBackground=this.g.append("path"),this.arcGroup=this.g.append("g"),this.centralLabel=this.g.append("text").attr("class",P3),this.centralSubLabel=this.g.append("text").attr("class",F3)}get bleed(){return{top:0,bottom:0,left:0,right:0}}_render(e){var t,n,i,s,o,a,l,u,c,d,h,f,m,p;const{config:g,datamodel:v,bleed:y}=this,b=v.data.map((X,I)=>({index:I,datum:X})).filter(X=>g.showEmptySegments||zr(X.datum,g.value,X.index)),E=ji(e)?e:g.duration,[A,M,L,k]=M3.map(X=>g.angleRange&&g.angleRange[0]===X[0]&&g.angleRange[1]===X[1]),P=A||L,U=M||k,$=this._width*(U?2:1),V=this._height*(P?2:1),R=g.radius||Math.min($-y.left-y.right,V-y.top-y.bottom)/2,O=g.arcWidth===0?0:ks(R-g.arcWidth,0,R-1),T=this._height/2+(A?R/2:L?-R/2:0),w=this._width/2+(k?R/2:M?-R/2:0),x=`translate(${w},${T})`;this.arcGroup.attr("transform",x),this.arcGen.startAngle(X=>X.startAngle).endAngle(X=>X.endAngle).innerRadius(X=>X.innerRadius).outerRadius(X=>X.outerRadius).padAngle(X=>X.padAngle).cornerRadius(g.cornerRadius);const S=eG().startAngle((n=(t=g.angleRange)===null||t===void 0?void 0:t[0])!==null&&n!==void 0?n:0).endAngle((s=(i=g.angleRange)===null||i===void 0?void 0:i[1])!==null&&s!==void 0?s:2*Math.PI).padAngle(g.padAngle).value(X=>zr(X.datum,g.value,X.index)||0).sort((X,I)=>{var N;return(N=g.sortFunction)===null||N===void 0?void 0:N.call(g,X.datum,I.datum)})(b).map(X=>{const I=Object.assign(Object.assign({},X),{data:X.data.datum,index:X.data.index,innerRadius:O,outerRadius:R});return g.showEmptySegments&&X.endAngle-X.startAngle-X.padAngle<=Number.EPSILON&&(I.endAngle=X.startAngle+Math.max(g.emptySegmentAngle,g.padAngle),I.padAngle=X.padAngle/2),I}),C=this.arcGroup.selectAll(`.${ey}`).data(S,X=>g.id(X.data,X.index)),F=C.enter().append("path").attr("class",ey).call(Uq,g),D=C.merge(F);D.call(Vq,g,this.arcGen,E),D.sort((X,I)=>I.value-X.value),C.exit().attr("class",k3).call(jq,E);const H=M?"start":k?"end":"middle";this.centralLabel.attr("dy",g.centralSubLabel?"-0.55em":null).style("text-anchor",H).text((o=g.centralLabel)!==null&&o!==void 0?o:null),this.centralSubLabel.attr("dy",g.centralLabel?"0.55em":null).style("text-anchor",H).text((a=g.centralSubLabel)!==null&&a!==void 0?a:null),g.centralSubLabelWrap&&m3(this.centralSubLabel,O*1.9);const G=(g.centralLabelOffsetX||0)+w;let ee=(g.centralLabelOffsetY||0)+T;P&&g.centralLabelOffsetX===void 0&&g.centralLabelOffsetY===void 0&&(ee=(A?-this.centralSubLabel.node().getBoundingClientRect().height:L?this.centralLabel.node().getBoundingClientRect().height:0)+T);const B=`translate(${G},${ee})`;this.centralLabel.attr("transform",B),this.centralSubLabel.attr("transform",B),this.arcBackground.attr("class",I3).attr("visibility",g.showBackground?null:"hidden").attr("transform",x),an(this.arcBackground,E).attr("d",this.arcGen({startAngle:(d=(u=(l=g.backgroundAngleRange)===null||l===void 0?void 0:l[0])!==null&&u!==void 0?u:(c=g.angleRange)===null||c===void 0?void 0:c[0])!==null&&d!==void 0?d:0,endAngle:(p=(f=(h=g.backgroundAngleRange)===null||h===void 0?void 0:h[1])!==null&&f!==void 0?f:(m=g.angleRange)===null||m===void 0?void 0:m[1])!==null&&p!==void 0?p:2*Math.PI,innerRadius:O,outerRadius:R}))}}dm.selectors=zq;const fh=Symbol("componentAccessorKey"),mb=Symbol("tooltipAccessorKey"),L3=Symbol("crosshairAccessorKey"),D3=Symbol("axisAccessorKey"),B3=Symbol("annotationsAccessorKey");function ml(r,e){return rl(r,e)}function Vo(r){const e=Ys(),t=e.attrs;return Te(()=>{const n={},i=e?.vnode.props??{};return Object.keys(i).forEach(s=>{n[Wn(s)]=r[Wn(s)]}),{...n,...t}})}const I2=_e({__name:"index",props:{components:{},xScale:{type:[Object,Function]},xDomain:{},xDomainMinConstraint:{},xDomainMaxConstraint:{},xRange:{},yScale:{type:[Object,Function]},yDomain:{},yDomainMinConstraint:{},yDomainMaxConstraint:{},yRange:{},yDirection:{},xAxis:{},yAxis:{},autoMargin:{type:Boolean},tooltip:{},crosshair:{},preventEmptyDomain:{type:[Boolean,null]},scaleByDomain:{type:Boolean},annotations:{},clipPathExtend:{},duration:{},margin:{},padding:{},sizing:{},width:{},height:{},svgDefs:{},ariaLabel:{},data:{}},setup(r,{expose:e}){const t=r,{data:n}=Rn(t),i=Vo(t),s=Ce(),o=Vs({components:[],annotations:void 0,crosshair:void 0,tooltip:void 0,xAxis:void 0,yAxis:void 0}),a=Ce();return jt(n,()=>{s.value&&s.value.setData(n.value,!0)}),An(()=>{var l;o.components.map(u=>u.config),(l=s.value)==null||l.updateContainer({...$t(i.value),...$t(o)})}),Lr(()=>{a.value&&(s.value=new IW(a.value,{...$t(o)},n.value))}),Nn(()=>{var l;return(l=s.value)==null?void 0:l.destroy()}),ts(fh,{data:n,update:l=>o.components=[...o.components,l],destroy:()=>{var l;return o.components=(l=o.components)==null?void 0:l.filter(u=>!u.isDestroyed())}}),ts(D3,{data:n,update:l=>o[`${l.config.type}Axis`]=l,destroy:l=>{o[`${l}Axis`]=void 0}}),ts(L3,{data:n,update:l=>o.crosshair=l,destroy:()=>{o.crosshair=void 0}}),ts(mb,{data:n,update:l=>o.tooltip=l,destroy:()=>{o.tooltip=void 0}}),ts(B3,{data:n,update:l=>o.annotations=l,destroy:()=>{o.annotations=void 0}}),e({component:s}),(l,u)=>(he(),ke("div",{"data-vis-xy-container":"",ref_key:"elRef",ref:a,class:"unovis-xy-container"},[Re(l.$slots,"default")],512))}}),U3=_e({__name:"index",props:{component:{},tooltip:{},annotations:{},duration:{},margin:{},padding:{},sizing:{},width:{},height:{},svgDefs:{},ariaLabel:{},data:{}},setup(r,{expose:e}){const t=r,{data:n}=Rn(t),i=Vo(t);let s;const o=Vs({component:void 0,tooltip:void 0,annotations:void 0}),a=Ce(),l=()=>{s||a.value&&o.component&&(s=new Dz(a.value,{...$t(o)},n.value))};return An(()=>{var u;l(),(u=o.component)==null||u.config,s?.updateContainer({...$t(i.value),...$t(o)})}),jt(n,()=>{s?s.setData(n.value,!0):l()}),Nn(()=>s?.destroy()),ts(fh,{data:n,update:u=>o.component=u,destroy:()=>o.component=void 0}),ts(mb,{data:n,update:u=>o.tooltip=u,destroy:()=>{o.tooltip=void 0}}),ts(B3,{data:n,update:u=>o.annotations=u,destroy:()=>{o.annotations=void 0}}),e({component:s}),(u,c)=>(he(),ke("div",{"data-vis-single-container":"",ref_key:"elRef",ref:a,class:"unovis-single-container"},[Re(u.$slots,"default")],512))}}),Hq={"data-vis-axis":""},od=_e({__name:"index",props:{position:{},type:{},fullSize:{type:Boolean},label:{},labelFontSize:{},labelMargin:{},labelTextFitMode:{},labelTextTrimType:{},labelColor:{},gridLine:{type:Boolean},tickLine:{type:Boolean},domainLine:{type:Boolean},minMaxTicksOnly:{type:Boolean},minMaxTicksOnlyShowGridLines:{type:Boolean},minMaxTicksOnlyWhenWidthIsLess:{},tickFormat:{type:Function},tickValues:{},numTicks:{},tickTextFitMode:{},tickTextWidth:{},tickTextSeparator:{},tickTextForceWordBreak:{type:Boolean},tickTextTrimType:{},tickTextFontSize:{},tickTextAlign:{},tickTextColor:{},tickTextAngle:{},tickTextHideOverlapping:{type:Boolean},tickPadding:{},x:{},y:{},id:{type:Function},color:{},xScale:{type:[Object,Function]},yScale:{type:[Object,Function]},excludeFromDomainCalculation:{type:Boolean},duration:{},events:{},attributes:{},data:{}},setup(r,{expose:e}){const t=Ui(D3),n=r,i=Te(()=>t.data.value??n.data),s=Vo(n),o=Ce();return Lr(()=>{br(()=>{var a;o.value=new x3(s.value),(a=o.value)==null||a.setData(i.value),t.update(o.value)})}),Nn(()=>{var a;(a=o.value)==null||a.destroy(),t.destroy(n.type)}),jt(s,(a,l)=>{var u;ml(a,l)||(u=o.value)==null||u.setConfig(s.value)}),jt(i,()=>{var a;(a=o.value)==null||a.setData(i.value)}),e({component:o}),(a,l)=>(he(),ke("div",Hq))}}),Wq={"data-vis-crosshair":""},k2=_e({__name:"index",props:{data:{}},setup(r,{expose:e}){const t=Ui(L3),n=r,i=Te(()=>t.data.value??n.data),s=Vo(n),o=Ce();return Lr(()=>{br(()=>{var a;o.value=new N3(s.value),(a=o.value)==null||a.setData(i.value),t.update(o.value)})}),Nn(()=>{var a;(a=o.value)==null||a.destroy(),t.destroy()}),jt(s,(a,l)=>{var u;ml(a,l)||(u=o.value)==null||u.setConfig(s.value)}),jt(i,()=>{var a;(a=o.value)==null||a.setData(i.value)}),e({component:o}),(a,l)=>(he(),ke("div",Wq))}}),Gq={"data-vis-component":""},qq=_e({__name:"index",props:{color:{},groupWidth:{},groupMaxWidth:{},dataStep:{},groupPadding:{},barPadding:{},roundedCorners:{type:[Number,Boolean]},barMinHeight:{},cursor:{},orientation:{},x:{},y:{},id:{type:Function},xScale:{type:[Object,Function]},yScale:{type:[Object,Function]},excludeFromDomainCalculation:{type:Boolean},duration:{},events:{},attributes:{},data:{}},setup(r,{expose:e}){const t=Ui(fh),n=r,i=Te(()=>t.data.value??n.data),s=Vo(n),o=Ce();return Lr(()=>{br(()=>{var a;o.value=new f3(s.value),(a=o.value)==null||a.setData(i.value),t.update(o.value)})}),Nn(()=>{var a;(a=o.value)==null||a.destroy(),t.destroy()}),jt(s,(a,l)=>{var u;ml(a,l)||(u=o.value)==null||u.setConfig(s.value)}),jt(i,()=>{var a;(a=o.value)==null||a.setData(i.value)}),e({component:o}),(a,l)=>(he(),ke("div",Gq))}}),Yq={"data-vis-component":""},Xq=_e({__name:"index",props:{color:{},curveType:{},lineWidth:{},lineDashArray:{},fallbackValue:{},highlightOnHover:{type:Boolean},cursor:{},interpolateMissingData:{type:Boolean},x:{},y:{},id:{type:Function},xScale:{type:[Object,Function]},yScale:{type:[Object,Function]},excludeFromDomainCalculation:{type:Boolean},duration:{},events:{},attributes:{},data:{}},setup(r,{expose:e}){const t=Ui(fh),n=r,i=Te(()=>t.data.value??n.data),s=Vo(n),o=Ce();return Lr(()=>{br(()=>{var a;o.value=new cm(s.value),(a=o.value)==null||a.setData(i.value),t.update(o.value)})}),Nn(()=>{var a;(a=o.value)==null||a.destroy(),t.destroy()}),jt(s,(a,l)=>{var u;ml(a,l)||(u=o.value)==null||u.setConfig(s.value)}),jt(i,()=>{var a;(a=o.value)==null||a.setData(i.value)}),e({component:o}),(a,l)=>(he(),ke("div",Yq))}}),Kq={"data-vis-component":""},V3=_e({__name:"index",props:{id:{type:Function},value:{},angleRange:{},padAngle:{},sortFunction:{type:Function},cornerRadius:{},color:{},radius:{},arcWidth:{},centralLabel:{},centralSubLabel:{},centralSubLabelWrap:{type:Boolean},showEmptySegments:{type:Boolean},emptySegmentAngle:{},showBackground:{type:Boolean},backgroundAngleRange:{},centralLabelOffsetX:{},centralLabelOffsetY:{},duration:{},events:{},attributes:{},data:{}},setup(r,{expose:e}){const t=Ui(fh),n=r,i=Te(()=>t.data.value??n.data),s=Vo(n),o=Ce();return Lr(()=>{br(()=>{var a;o.value=new dm(s.value),(a=o.value)==null||a.setData(i.value),t.update(o.value)})}),Nn(()=>{var a;(a=o.value)==null||a.destroy(),t.destroy()}),jt(s,(a,l)=>{var u;ml(a,l)||(u=o.value)==null||u.setConfig(s.value)}),jt(i,()=>{var a;(a=o.value)==null||a.setData(i.value)}),e({component:o}),(a,l)=>(he(),ke("div",Kq))}}),Zq={"data-vis-tooltip":""},Hd=_e({__name:"index",props:{components:{},container:{},followCursor:{type:Boolean},allowHover:{type:Boolean},horizontalPlacement:{},horizontalShift:{},verticalPlacement:{},verticalShift:{},triggers:{},attributes:{},className:{},hideDelay:{},showDelay:{},data:{}},setup(r,{expose:e}){const t=Ui(mb),n=Vo(r),i=Ce();return Lr(()=>{br(()=>{i.value=new GC(n.value),t.update(i.value)})}),Nn(()=>{var s;(s=i.value)==null||s.destroy(),t.destroy()}),jt(n,(s,o)=>{var a;ml(s,o)||(a=i.value)==null||a.setConfig(n.value)}),e({component:i}),(s,o)=>(he(),ke("div",Zq))}}),j3=_e({__name:"index",props:{items:{},labelClassName:{},onLegendItemClick:{type:Function},labelFontSize:{},labelMaxWidth:{},bulletSize:{},bulletSpacing:{},bulletShape:{},orientation:{},renderIntoProvidedDomNode:{type:Boolean},data:{}},setup(r,{expose:e}){const n=Vo(r),i=Ce(),s=Ce();return Lr(()=>{br(()=>{s.value&&(i.value=new R3(s.value,{...n.value,renderIntoProvidedDomNode:!0}))})}),Nn(()=>{var o;(o=i.value)==null||o.destroy()}),jt(n,(o,a)=>{var l;ml(o,a)||(l=i.value)==null||l.update(n.value)}),e({component:i}),(o,a)=>(he(),ke("div",{"data-vis-bullet-legend":"",ref_key:"elRef",ref:s},null,512))}});(function(){try{if(typeof document<"u"){var r=document.createElement("style");r.appendChild(document.createTextNode(".unovis-xy-container,.unovis-single-container{display:block;position:relative;width:100%}[data-vis-leaflet-map],[data-vis-leaflet-flow-map]{display:block;position:relative}[data-vis-bullet-legend],[data-vis-rolling-pin-legend]{display:block}")),document.head.appendChild(r)}}catch(e){console.error("vite-plugin-css-injected-by-js",e)}})();const Qq={light:"",dark:".dark"},[Jq,eY]=Mn("Chart"),tY={key:0,class:"p-4 border rounded-lg bg-white"},rY={class:"flex items-center justify-between mb-2"},nY={class:"flex items-center gap-2"},iY={class:"font-semibold text-gray-900"},sY={class:"flex items-center gap-2"},oY=_e({__name:"SectionChart",props:{section:{},sectionIndex:{},chart:{}},setup(r){const e=r,t=Te(()=>Qr.fromConfig(e.chart)),n=Te(()=>Ga.prepareChartData(e.section,t.value)),i=Te(()=>Ga.getChartValueLabel(e.section,t.value)),s=Te(()=>Ga.getLabelCandidateColumns(e.section)),o=Te(()=>s.value.find(m=>m.index===e.chart.labelColumnIndex)?.label||"Label"),a=Te(()=>({value:{label:i.value,color:"#bada55"}})),l={[dm.selectors.segment]:f=>{const m=f.data.percentage?.toFixed(1)||"0.0";return`
      <div style="display:flex; flex-direction:column; gap:4px">
        <strong>${f.data.name}</strong>
        <span>${f.data.value} (${m}%)</span>
      </div>
    `}},u=Te(()=>n.value.map(f=>({name:`${f.name} (${f.percentage?.toFixed(1)}%)`})));function c(f){xk(e.sectionIndex,e.chart.columnIndex,f)}function d(f){Ek(e.sectionIndex,e.chart.columnIndex,f)}function h(){eR(e.sectionIndex,e.chart.columnIndex)}return(f,m)=>r.chart.visible?(he(),ke("div",tY,[we("div",rY,[we("div",nY,[ge(q(Pc),{class:"w-5 h-5 text-blue-600"}),we("h4",iY,ot(i.value),1)]),we("div",sY,[ge(q(fA),null,{default:de(()=>[ge(q(wA),{"as-child":""},{default:de(()=>[ge(q(Un),{variant:"outline",size:"sm"},{default:de(()=>[ge(q(dc),{class:"w-4 h-4"})]),_:1})]),_:1}),ge(q(pA),{align:"end"},{default:de(()=>[ge(q(mA),null,{default:de(()=>[...m[3]||(m[3]=[ze("Chart type",-1)])]),_:1}),ge(q(ia),{onClick:m[0]||(m[0]=p=>c("bar"))},{default:de(()=>[ge(q(Pc),{class:"w-4 h-4 mr-2"}),m[4]||(m[4]=ze(" Bar ",-1))]),_:1}),ge(q(ia),{onClick:m[1]||(m[1]=p=>c("pie"))},{default:de(()=>[ge(q(rR),{class:"w-4 h-4 mr-2"}),m[5]||(m[5]=ze(" Pie ",-1))]),_:1}),ge(q(ia),{onClick:m[2]||(m[2]=p=>c("line"))},{default:de(()=>[ge(q(tR),{class:"w-4 h-4 mr-2"}),m[6]||(m[6]=ze(" Line ",-1))]),_:1}),ge(q(gA)),ge(q(yA),null,{default:de(()=>[ge(q(bA),null,{default:de(()=>[ge(q(sR),{class:"w-4 h-4 mr-2"}),ze(" Labels: "+ot(o.value),1)]),_:1}),ge(q(vA),null,{default:de(()=>[(he(!0),ke(Tt,null,Er(s.value,p=>(he(),Ee(q(ia),{key:p.index,onClick:g=>d(p.index),class:mt(p.index===r.chart.labelColumnIndex?"bg-accent":"")},{default:de(()=>[ze(ot(p.label),1)]),_:2},1032,["onClick","class"]))),128))]),_:1})]),_:1})]),_:1})]),_:1}),ge(q(Un),{variant:"ghost",size:"sm",onClick:h,title:"Hide chart"},{default:de(()=>[ge(q(tv),{class:"w-4 h-4"})]),_:1})])]),r.chart.type==="bar"?(he(),Ee(q(Rd),{config:a.value,class:"h-[150px] w-80",key:"bar-"+r.sectionIndex+"-"+r.chart.columnIndex},{default:de(()=>[ge(q(I2),{data:n.value},{default:de(()=>[ge(q(qq),{x:p=>p.index,y:p=>p.value,color:a.value.value.color,"rounded-corners":4,groupMaxWidth:150},null,8,["x","y","color"]),ge(q(od),{type:"x",x:p=>p.index,"tick-line":!1,"domain-line":!1,"tick-values":n.value.map(p=>p.index),"tick-format":p=>n.value[p]?.name||""},null,8,["x","tick-values","tick-format"]),ge(q(od),{type:"y","tick-line":!1,"domain-line":!1,"grid-line":!0}),ge(q(Hd)),ge(q(k2),{template:q(r_)(a.value,q(e_),{labelFormatter:p=>{const g=typeof p=="number"?p:p.getTime();return n.value[g]?.name||""}}),color:[a.value.value.color]},null,8,["template","color"])]),_:1},8,["data"])]),_:1},8,["config"])):r.chart.type==="pie"?(he(),Ee(q(Rd),{config:a.value,key:"pie-"+r.sectionIndex+"-"+r.chart.columnIndex,class:"h-[150px] w-80"},{default:de(()=>[ge(q(U3),{data:n.value,width:150,class:"flex! items-center gap-4"},{default:de(()=>[ge(q(Hd),{triggers:l}),ge(q(j3),{items:u.value,orientation:"vertical"},null,8,["items"]),ge(q(V3),{value:p=>p.value,"arc-width":50},null,8,["value"])]),_:1},8,["data"])]),_:1},8,["config"])):r.chart.type==="line"?(he(),Ee(q(Rd),{config:a.value,class:"h-[150px] w-80",key:"line-"+r.sectionIndex+"-"+r.chart.columnIndex},{default:de(()=>[ge(q(I2),{data:n.value},{default:de(()=>[ge(q(Xq),{x:p=>p.index,y:p=>p.value,color:a.value.value.color},null,8,["x","y","color"]),ge(q(od),{type:"x",x:p=>p.index,"tick-line":!1,"domain-line":!1,"tick-format":p=>n.value[p]?.name||""},null,8,["x","tick-format"]),ge(q(od),{type:"y","tick-line":!1,"domain-line":!1,"grid-line":!0}),ge(q(Hd)),ge(q(k2),{template:q(r_)(a.value,q(e_),{labelFormatter:p=>{const g=typeof p=="number"?p:p.getTime();return n.value[g]?.name||""}}),color:[a.value.value.color]},null,8,["template","color"])]),_:1},8,["data"])]),_:1},8,["config"])):zt("",!0)])):zt("",!0)}}),aY={key:0,class:"flex flex-col gap-4"},lY=_e({__name:"SectionChartList",props:{section:{},sectionIndex:{}},setup(r){return(e,t)=>r.section.charts&&r.section.charts.length>0?(he(),ke("div",aY,[(he(!0),ke(Tt,null,Er(r.section.charts.filter(n=>n.visible),n=>(he(),Ee(oY,{key:`chart-${r.sectionIndex}-${n.columnIndex}`,section:r.section,"section-index":r.sectionIndex,chart:n},null,8,["section","section-index","chart"]))),128))])):zt("",!0)}}),uY={class:"space-y-3"},cY=_e({__name:"SectionItem",props:{section:{},sectionIndex:{}},setup(r){const e=r,t=Te(()=>Nr.fromConfig(e.section)),n=Te(()=>Sd.applyFiltersAndSort(e.section));function i(u,c){Ew(e.sectionIndex,u,c)}function s(u){e.section.data.length>0||Ew(e.sectionIndex,0,u)}function o(u){eR(e.sectionIndex,u)}function a(u){Sk(e.sectionIndex,u)}function l(u){Tk(e.sectionIndex,u)}return(u,c)=>(he(),ke("div",uY,[ge(dB,{section:r.section,"section-index":r.sectionIndex,"filtered-count":n.value.length,"total-count":r.section.data.length},null,8,["section","section-index","filtered-count","total-count"]),we("div",{class:mt(["flex gap-4",q(lA)(t.value.style.chartPosition)])},[ge(EB,{section:r.section,"section-index":r.sectionIndex,"filtered-data":n.value,onCellClick:i,onHeaderClick:s,onChartIconClick:o,onToggleRowExclusion:a,onSortClick:l},null,8,["section","section-index","filtered-data"]),ge(lY,{section:r.section,"section-index":r.sectionIndex},null,8,["section","section-index"])],2)]))}}),hY={class:"space-y-8"},dY=_e({__name:"SheetSectionList",props:{sections:{}},setup(r){return(e,t)=>(he(),ke("div",hY,[(he(!0),ke(Tt,null,Er(r.sections,(n,i)=>(he(),Ee(cY,{key:i,section:n,"section-index":i},null,8,["section","section-index"]))),128))]))}}),ty=[{id:"slate",label:"Slate",bg:"bg-slate-50",border:"border-slate-200",text:"text-slate-900",accent:"bg-slate-600"},{id:"neutral",label:"Neutral",bg:"bg-neutral-50",border:"border-neutral-200",text:"text-neutral-900",accent:"bg-neutral-600"},{id:"red",label:"Red",bg:"bg-red-50",border:"border-red-200",text:"text-red-900",accent:"bg-red-600"},{id:"orange",label:"Orange",bg:"bg-orange-50",border:"border-orange-200",text:"text-orange-900",accent:"bg-orange-600"},{id:"amber",label:"Amber",bg:"bg-amber-50",border:"border-amber-200",text:"text-amber-900",accent:"bg-amber-600"},{id:"yellow",label:"Yellow",bg:"bg-yellow-50",border:"border-yellow-200",text:"text-yellow-900",accent:"bg-yellow-600"},{id:"lime",label:"Lime",bg:"bg-lime-50",border:"border-lime-200",text:"text-lime-900",accent:"bg-lime-600"},{id:"green",label:"Green",bg:"bg-green-50",border:"border-green-200",text:"text-green-900",accent:"bg-green-600"},{id:"emerald",label:"Emerald",bg:"bg-emerald-50",border:"border-emerald-200",text:"text-emerald-900",accent:"bg-emerald-600"},{id:"teal",label:"Teal",bg:"bg-teal-50",border:"border-teal-200",text:"text-teal-900",accent:"bg-teal-600"},{id:"cyan",label:"Cyan",bg:"bg-cyan-50",border:"border-cyan-200",text:"text-cyan-900",accent:"bg-cyan-600"},{id:"sky",label:"Sky",bg:"bg-sky-50",border:"border-sky-200",text:"text-sky-900",accent:"bg-sky-600"},{id:"blue",label:"Blue",bg:"bg-blue-50",border:"border-blue-200",text:"text-blue-900",accent:"bg-blue-600"},{id:"indigo",label:"Indigo",bg:"bg-indigo-50",border:"border-indigo-200",text:"text-indigo-900",accent:"bg-indigo-600"},{id:"violet",label:"Violet",bg:"bg-violet-50",border:"border-violet-200",text:"text-violet-900",accent:"bg-violet-600"},{id:"purple",label:"Purple",bg:"bg-purple-50",border:"border-purple-200",text:"text-purple-900",accent:"bg-purple-600"},{id:"fuchsia",label:"Fuchsia",bg:"bg-fuchsia-50",border:"border-fuchsia-200",text:"text-fuchsia-900",accent:"bg-fuchsia-600"},{id:"pink",label:"Pink",bg:"bg-pink-50",border:"border-pink-200",text:"text-pink-900",accent:"bg-pink-600"},{id:"rose",label:"Rose",bg:"bg-rose-50",border:"border-rose-200",text:"text-rose-900",accent:"bg-rose-600"}],fY=["small","medium","large"],pY=["top","left","right","none"],mY=["small","medium","large"],gY=["small","medium","large","xlarge"],yY=[{id:"number",label:"Number"},{id:"integer",label:"Integer"},{id:"percentage",label:"%"},{id:"currency",label:""}];function Yu(r){return ty.find(e=>e.id===r)||ty[12]}function $3(r){switch(r){case"small":return"p-3";case"large":return"p-6";default:return"p-4"}}function z3(r){switch(r){case"small":return"text-xs";case"large":return"text-base";default:return"text-sm"}}function H3(r){switch(r){case"small":return"text-xl";case"medium":return"text-2xl";case"large":return"text-3xl";case"xlarge":return"text-4xl";default:return"text-3xl"}}const vY={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-8"},bY={class:"flex items-center justify-between mb-3"},wY={class:"text-xs text-gray-500"},_Y={key:1,class:"mb-8 p-6 border-2 border-dashed border-gray-300 rounded-lg text-center text-gray-500"},xY=_e({__name:"RecapCards",setup(r){const e=Te(()=>ht.currentSheet.sections.filter(t=>t.cardRecap).map(t=>{const n=yi.fromConfig(t.cardRecap);return{title:t.title||t.cardRecap?.label,label:n.label||"Valeur",value:n.value,formattedValue:n.formatValue(),style:n.style}}));return(t,n)=>e.value.length>0?(he(),ke("div",vY,[(he(!0),ke(Tt,null,Er(e.value,(i,s)=>(he(),ke("div",{key:s,class:mt(["rounded-lg border-2 transition-all hover:shadow-md flex justify-between",q(Yu)(i.style.colorTheme).bg,q(Yu)(i.style.colorTheme).border,q($3)(i.style.size)])},[we("div",null,[we("div",bY,[we("div",{class:mt(["h-1 w-12 rounded",q(Yu)(i.style.colorTheme).accent])},null,2)]),we("div",{class:mt(["font-medium text-gray-600 mb-1",q(z3)(i.style.typography.titleSize)])},ot(i.title),3),we("div",wY,ot(i.label),1)]),we("div",null,[we("div",{class:mt(["font-bold mb-1",q(Yu)(i.style.colorTheme).text,q(H3)(i.style.typography.valueSize)])},ot(i.formattedValue),3)])],2))),128))])):(he(),ke("div",_Y,[...n[0]||(n[0]=[we("p",{class:"text-sm"}," Click on a cell to create a recap card",-1)])]))}}),EY={class:"w-full space-y-6"},SY={key:0,class:"text-center py-12 text-gray-500"},TY={key:2,class:"border rounded-lg overflow-hidden"},RY={class:"overflow-auto max-h-[600px]"},AY=_e({__name:"SheetViewer",setup(r){const e=Te(()=>ht.currentSheet.rawData.length>0),t=Te(()=>ht.currentSheet.sections.length>0);function n(s){JT(s)}function i(s){return s==null?"":typeof s=="number"?s.toLocaleString("fr-FR"):typeof s=="boolean"?s?"Yes":"No":s instanceof Date?s.toLocaleDateString("fr-FR"):String(s)}return(s,o)=>(he(),ke("div",EY,[ge(tB,{title:q(ht).currentSheet.title,"current-sheet-name":q(ht).currentSheet.name,"sheet-names":q(ht).sheetNames,"section-count":q(ht).currentSheet.sections.length,onSheetChange:n},null,8,["title","current-sheet-name","sheet-names","section-count"]),e.value?t.value?(he(),ke(Tt,{key:1},[ge(xY),ge(dY,{sections:q(ht).currentSheet.sections},null,8,["sections"])],64)):(he(),ke("div",TY,[we("div",RY,[ge(q(cA),null,{default:de(()=>[ge(q(dA),null,{default:de(()=>[ge(q(Pf),null,{default:de(()=>[ge(q(Ff),{class:"w-12 bg-gray-50 sticky left-0 z-10"},{default:de(()=>[...o[0]||(o[0]=[ze("#",-1)])]),_:1}),(he(!0),ke(Tt,null,Er(q(ht).currentSheet.rawData[0],(a,l)=>(he(),Ee(q(Ff),{key:l,class:"min-w-[150px]"},{default:de(()=>[ze(ot(i(a)||`Column ${l+1}`),1)]),_:2},1024))),128))]),_:1})]),_:1}),ge(q(hA),null,{default:de(()=>[(he(!0),ke(Tt,null,Er(q(ht).currentSheet.rawData.slice(1),(a,l)=>(he(),Ee(q(Pf),{key:l},{default:de(()=>[ge(q(kf),{class:"bg-gray-50 font-medium sticky left-0 z-10"},{default:de(()=>[ze(ot(l+2),1)]),_:2},1024),(he(!0),ke(Tt,null,Er(a,(u,c)=>(he(),Ee(q(kf),{key:c},{default:de(()=>[ze(ot(i(u)),1)]),_:2},1024))),128))]),_:2},1024))),128))]),_:1})]),_:1})])])):(he(),ke("div",SY," No data to display "))]))}}),Wd=_e({__name:"Separator",props:{orientation:{default:"horizontal"},decorative:{type:Boolean,default:!0},asChild:{type:Boolean},as:{},class:{}},setup(r){const e=r,t=Dr(e,"class");return(n,i)=>(he(),Ee(q(ML),et({"data-slot":"separator"},q(t),{class:q(Bt)("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",e.class)}),null,16,["class"]))}}),CY=_e({__name:"Tabs",props:{defaultValue:{},orientation:{},dir:{},activationMode:{},modelValue:{},unmountOnHide:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},emits:["update:modelValue"],setup(r,{emit:e}){const t=r,n=e,i=Dr(t,"class"),s=On(i,n);return(o,a)=>(he(),Ee(q(UL),et({"data-slot":"tabs"},q(s),{class:q(Bt)("flex flex-col gap-2",t.class)}),{default:de(l=>[Re(o.$slots,"default",en(un(l)))]),_:3},16,["class"]))}}),P2=_e({__name:"TabsContent",props:{value:{},forceMount:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(r){const e=r,t=Dr(e,"class");return(n,i)=>(he(),Ee(q(jL),et({"data-slot":"tabs-content",class:q(Bt)("flex-1 outline-none",e.class)},q(t)),{default:de(()=>[Re(n.$slots,"default")]),_:3},16,["class"]))}}),NY=_e({__name:"TabsList",props:{loop:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(r){const e=r,t=Dr(e,"class");return(n,i)=>(he(),Ee(q(zL),et({"data-slot":"tabs-list"},q(t),{class:q(Bt)("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",e.class)}),{default:de(()=>[Re(n.$slots,"default")]),_:3},16,["class"]))}}),F2=_e({__name:"TabsTrigger",props:{value:{},disabled:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(r){const e=r,t=Dr(e,"class"),n=pi(t);return(i,s)=>(he(),Ee(q(WL),et({"data-slot":"tabs-trigger",class:q(Bt)("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e.class)},q(n)),{default:de(()=>[Re(i.$slots,"default")]),_:3},16,["class"]))}}),W3=_e({__name:"Dialog",props:{open:{type:Boolean},defaultOpen:{type:Boolean},modal:{type:Boolean}},emits:["update:open"],setup(r,{emit:e}){const i=On(r,e);return(s,o)=>(he(),Ee(q(C9),et({"data-slot":"dialog"},q(i)),{default:de(a=>[Re(s.$slots,"default",en(un(a)))]),_:3},16))}}),MY=_e({__name:"DialogOverlay",props:{forceMount:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(r){const e=r,t=Dr(e,"class");return(n,i)=>(he(),Ee(q(l7),et({"data-slot":"dialog-overlay"},q(t),{class:q(Bt)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/80",e.class)}),{default:de(()=>[Re(n.$slots,"default")]),_:3},16,["class"]))}}),G3=_e({inheritAttrs:!1,__name:"DialogContent",props:{forceMount:{type:Boolean},disableOutsidePointerEvents:{type:Boolean},asChild:{type:Boolean},as:{},class:{},showCloseButton:{type:Boolean,default:!0}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(r,{emit:e}){const t=r,n=e,i=Dr(t,"class"),s=On(i,n);return(o,a)=>(he(),Ee(q(h7),null,{default:de(()=>[ge(MY),ge(q(r7),et({"data-slot":"dialog-content"},{...o.$attrs,...q(s)},{class:q(Bt)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t.class)}),{default:de(()=>[Re(o.$slots,"default"),r.showCloseButton?(he(),Ee(q(M9),{key:0,"data-slot":"dialog-close",class:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4"},{default:de(()=>[ge(q(oR)),a[0]||(a[0]=we("span",{class:"sr-only"},"Close",-1))]),_:1})):zt("",!0)]),_:3},16,["class"])]),_:3}))}}),q3=_e({__name:"DialogDescription",props:{asChild:{type:Boolean},as:{},class:{}},setup(r){const e=r,t=Dr(e,"class"),n=pi(t);return(i,s)=>(he(),Ee(q(i7),et({"data-slot":"dialog-description"},q(n),{class:q(Bt)("text-muted-foreground text-sm",e.class)}),{default:de(()=>[Re(i.$slots,"default")]),_:3},16,["class"]))}}),Y3=_e({__name:"DialogFooter",props:{class:{}},setup(r){const e=r;return(t,n)=>(he(),ke("div",{"data-slot":"dialog-footer",class:mt(q(Bt)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",e.class))},[Re(t.$slots,"default")],2))}}),X3=_e({__name:"DialogHeader",props:{class:{}},setup(r){const e=r;return(t,n)=>(he(),ke("div",{"data-slot":"dialog-header",class:mt(q(Bt)("flex flex-col gap-2 text-center sm:text-left",e.class))},[Re(t.$slots,"default")],2))}}),K3=_e({__name:"DialogTitle",props:{asChild:{type:Boolean},as:{},class:{}},setup(r){const e=r,t=Dr(e,"class"),n=pi(t);return(i,s)=>(he(),Ee(q(f7),et({"data-slot":"dialog-title"},q(n),{class:q(Bt)("text-lg leading-none font-semibold",e.class)}),{default:de(()=>[Re(i.$slots,"default")]),_:3},16,["class"]))}}),OY={class:"max-h-[80vh] overflow-y-auto"},IY={class:"space-y-6 py-4 overflow-y-auto overflow-x-hidden"},kY={class:"space-y-3"},PY={class:"grid grid-cols-12 gap-2"},FY=["onClick"],LY={class:"space-y-3"},DY={class:"grid grid-cols-2 gap-4"},BY={class:"space-y-2"},UY={class:"flex gap-2"},VY={class:"space-y-2"},jY={class:"flex gap-2"},$Y={class:"space-y-3"},zY={class:"grid grid-cols-2 gap-4"},HY={class:"space-y-2"},WY={class:"flex gap-2"},GY={class:"space-y-2"},qY={class:"flex gap-2"},YY={class:"space-y-3"},XY={class:"flex gap-2 flex-wrap"},KY={key:0,class:"pt-2"},ZY={class:"space-y-2"},QY={class:"text-xs text-gray-500"},JY=_e({__name:"CardCustomDialog",props:{sectionIndex:{}},emits:["close"],setup(r,{emit:e}){const t=r,n=e,i=Te(()=>ht.currentSheet.sections[t.sectionIndex]),s=Te(()=>i.value?.cardRecap?yi.fromConfig(i.value.cardRecap):null),o=Te(()=>i.value?.title||`Section ${t.sectionIndex+1}`),a=Ce(s.value?.style.colorTheme||"blue"),l=Ce(s.value?.style.size||"medium"),u=Ce(s.value?.style.iconPosition||"left"),c=Ce(s.value?.style.typography.titleSize||"medium"),d=Ce(s.value?.style.typography.valueSize||"large"),h=Ce(s.value?.style.valueFormat.type||"number"),f=Ce(s.value?.style.valueFormat.customUnit||""),m=Te(()=>Yu(a.value)),p=Te(()=>{if(!s.value)return"1,234";const y=s.value.value;if(typeof y.value!="number")return String(y);switch(h.value){case"integer":return Math.round(y.value).toLocaleString("fr-FR");case"percentage":return`${y.value.toLocaleString("fr-FR",{maximumFractionDigits:1})}%`;case"currency":return`${y.value.toLocaleString("fr-FR",{maximumFractionDigits:2})} ${f.value}`;default:return y.value.toLocaleString("fr-FR",{maximumFractionDigits:2})}});function g(){n("close")}function v(){if(!s.value)return;const y={colorTheme:a.value,size:l.value,iconPosition:u.value,typography:{titleSize:c.value,valueSize:d.value},valueFormat:{type:h.value,customUnit:h.value==="currency"?f.value:void 0}};bk(t.sectionIndex,y),console.log("New style:",y),n("close")}return(y,b)=>(he(),Ee(q(W3),{open:!0,"onUpdate:open":b[1]||(b[1]=E=>!E&&g())},{default:de(()=>[ge(q(G3),{class:"max-h-[90vh] max-w-5xl!"},{default:de(()=>[we("div",OY,[ge(q(X3),null,{default:de(()=>[ge(q(K3),null,{default:de(()=>[ze("Customize Card - "+ot(o.value),1)]),_:1}),ge(q(q3),null,{default:de(()=>[...b[2]||(b[2]=[ze(" Personalize the appearance of this recap card ",-1)])]),_:1})]),_:1}),we("div",IY,[we("div",kY,[ge(q(qr),null,{default:de(()=>[...b[3]||(b[3]=[ze("Color Theme",-1)])]),_:1}),we("div",PY,[(he(!0),ke(Tt,null,Er(q(ty),E=>(he(),ke("button",{key:E.id,onClick:A=>a.value=E.id,class:mt(["p-3 rounded-lg border-2 transition-all hover:scale-105",E.bg,a.value===E.id?E.border:"border-transparent"])},[we("div",{class:mt(["h-1 w-full rounded mb-2",E.accent])},null,2),we("div",{class:mt(["text-xs font-medium",E.text])},ot(E.label),3)],10,FY))),128))])]),we("div",LY,[ge(q(qr),null,{default:de(()=>[...b[4]||(b[4]=[ze("Layout",-1)])]),_:1}),we("div",DY,[we("div",BY,[ge(q(qr),{class:"text-xs text-gray-600"},{default:de(()=>[...b[5]||(b[5]=[ze("Size",-1)])]),_:1}),we("div",UY,[(he(!0),ke(Tt,null,Er(q(fY),E=>(he(),Ee(q(Un),{key:E,onClick:A=>l.value=E,variant:l.value===E?"default":"outline",size:"sm",class:"capitalize"},{default:de(()=>[ze(ot(E),1)]),_:2},1032,["onClick","variant"]))),128))])]),we("div",VY,[ge(q(qr),{class:"text-xs text-gray-600"},{default:de(()=>[...b[6]||(b[6]=[ze("Icon Position",-1)])]),_:1}),we("div",jY,[(he(!0),ke(Tt,null,Er(q(pY),E=>(he(),Ee(q(Un),{key:E,onClick:A=>u.value=E,variant:u.value===E?"default":"outline",size:"sm",class:"capitalize"},{default:de(()=>[ze(ot(E),1)]),_:2},1032,["onClick","variant"]))),128))])])])]),we("div",$Y,[ge(q(qr),null,{default:de(()=>[...b[7]||(b[7]=[ze("Typography",-1)])]),_:1}),we("div",zY,[we("div",HY,[ge(q(qr),{class:"text-xs text-gray-600"},{default:de(()=>[...b[8]||(b[8]=[ze("Title Size",-1)])]),_:1}),we("div",WY,[(he(!0),ke(Tt,null,Er(q(mY),E=>(he(),Ee(q(Un),{key:E,onClick:A=>c.value=E,variant:c.value===E?"default":"outline",size:"sm",class:"uppercase text-xs"},{default:de(()=>[ze(ot(E.charAt(0)),1)]),_:2},1032,["onClick","variant"]))),128))])]),we("div",GY,[ge(q(qr),{class:"text-xs text-gray-600"},{default:de(()=>[...b[9]||(b[9]=[ze("Value Size",-1)])]),_:1}),we("div",qY,[(he(!0),ke(Tt,null,Er(q(gY),E=>(he(),Ee(q(Un),{key:E,onClick:A=>d.value=E,variant:d.value===E?"default":"outline",size:"sm",class:"uppercase text-xs"},{default:de(()=>[ze(ot(E==="xlarge"?"XL":E.charAt(0)),1)]),_:2},1032,["onClick","variant"]))),128))])])])]),we("div",YY,[ge(q(qr),null,{default:de(()=>[...b[10]||(b[10]=[ze("Value Format",-1)])]),_:1}),we("div",XY,[(he(!0),ke(Tt,null,Er(q(yY),E=>(he(),Ee(q(Un),{key:E.id,onClick:A=>h.value=E.id,variant:h.value===E.id?"default":"outline",size:"sm"},{default:de(()=>[ze(ot(E.label),1)]),_:2},1032,["onClick","variant"]))),128))]),h.value==="currency"?(he(),ke("div",KY,[ge(q(qr),{for:"unit",class:"text-xs text-gray-600"},{default:de(()=>[...b[11]||(b[11]=[ze("Custom Unit",-1)])]),_:1}),ge(q(Av),{id:"unit",modelValue:f.value,"onUpdate:modelValue":b[0]||(b[0]=E=>f.value=E),placeholder:"",class:"mt-1 max-w-[200px]"},null,8,["modelValue"])])):zt("",!0)]),we("div",ZY,[ge(q(qr),null,{default:de(()=>[...b[12]||(b[12]=[ze("Preview",-1)])]),_:1}),we("div",{class:mt(["rounded-lg border-2 transition-all flex justify-between",m.value.bg,m.value.border,q($3)(l.value)])},[we("div",null,[we("div",{class:mt(["h-1 w-12 rounded mb-3",m.value.accent])},null,2),we("div",{class:mt(["font-medium mb-1",q(z3)(c.value)])},ot(i.value?.title||"Card Title"),3),we("div",QY,ot(i.value?.cardRecap?.label||"Label"),1)]),we("div",null,[we("div",{class:mt(["font-bold mb-1",m.value.text,q(H3)(d.value)])},ot(p.value),3)])],2)])]),ge(q(Y3),null,{default:de(()=>[ge(q(Un),{variant:"outline",onClick:g},{default:de(()=>[...b[13]||(b[13]=[ze("Cancel",-1)])]),_:1}),ge(q(Un),{onClick:v},{default:de(()=>[...b[14]||(b[14]=[ze("Apply",-1)])]),_:1})]),_:1})])]),_:1})]),_:1}))}}),eX={class:"max-h-[80vh] overflow-y-auto"},tX={class:"space-y-6 py-4 overflow-y-auto overflow-x-hidden"},rX={class:"space-y-3"},nX={class:"grid grid-cols-12 gap-2"},iX=["onClick"],sX={class:"space-y-3"},oX={class:"space-y-2"},aX={class:"flex gap-2"},lX={class:"space-y-3"},uX={class:"grid grid-cols-3 gap-4"},cX={class:"flex items-center gap-8"},hX={class:"flex items-center gap-8"},dX={class:"flex items-center gap-8"},fX={class:"space-y-3"},pX={class:"grid grid-cols-2 gap-4"},mX={class:"space-y-2"},gX={class:"flex gap-2"},yX={class:"space-y-2"},vX={class:"border rounded-lg p-4 bg-white"},bX={class:"flex items-center gap-3 mb-3"},wX={class:"w-full text-sm"},_X={class:"p-4 border rounded-lg bg-white"},xX={class:"flex items-center justify-between mb-2"},EX={class:"flex items-center gap-2"},SX={class:"flex items-center gap-2"},TX=_e({__name:"SectionCustomDialog",props:{sectionIndex:{}},emits:["close"],setup(r,{emit:e}){const t=r,n=e,i=Te(()=>ht.currentSheet.sections[t.sectionIndex]),s=Te(()=>i.value?Nr.fromConfig(i.value):null),o=Te(()=>i.value?.title||`Section ${t.sectionIndex+1}`),a=Ce(s.value?.style.colorTheme||"blue"),l=Ce(s.value?.style.titleSize||"xlarge"),u=Ce(s.value?.style.tableStyle.roundedBorders??!0),c=Ce(s.value?.style.tableStyle.showBorders??!0),d=Ce(s.value?.style.tableStyle.alternatingRows??!0),h=Ce(s.value?.style.chartPosition||"right"),f=Te(()=>Rv(a.value)),m=Te(()=>uA(c.value,u.value));function p(){n("close")}function g(){const A={colorTheme:a.value,titleSize:l.value,tableStyle:{showBorders:c.value,roundedBorders:u.value,alternatingRows:d.value},chartPosition:h.value};wk(t.sectionIndex,A),n("close")}const v=Ce([{index:1,name:"Item 1",value:100,percentage:33.3},{index:2,name:"Item 2",value:200,percentage:66.6}]),y={[dm.selectors.segment]:A=>{const M=A.data.percentage?.toFixed(1)||"0.0";return`
      <div style="display:flex; flex-direction:column; gap:4px">
        <strong>${A.data.name}</strong>
        <span>${A.data.value} (${M}%)</span>
      </div>
    `}},b=Te(()=>v.value.map(A=>({name:`${A.name} (${A.percentage?.toFixed(1)}%)`}))),E={value:{label:"Value",color:"#bada55"}};return(A,M)=>(he(),Ee(q(W3),{open:!0,"onUpdate:open":M[3]||(M[3]=L=>!L&&p())},{default:de(()=>[ge(q(G3),{class:"max-h-[90vh] max-w-5xl!"},{default:de(()=>[we("div",eX,[ge(q(X3),null,{default:de(()=>[ge(q(K3),null,{default:de(()=>[ze("Customize Section - "+ot(o.value),1)]),_:1}),ge(q(q3),null,{default:de(()=>[...M[4]||(M[4]=[ze(" Personalize the appearance of this section ",-1)])]),_:1})]),_:1}),we("div",tX,[we("div",rX,[ge(q(qr),null,{default:de(()=>[...M[5]||(M[5]=[ze("Color Theme",-1)])]),_:1}),we("div",nX,[(he(!0),ke(Tt,null,Er(q(b0),L=>(he(),ke("button",{key:L.id,onClick:k=>a.value=L.id,class:mt(["p-3 rounded-lg border-2 transition-all hover:scale-105",L.bg,a.value===L.id?L.border:"border-transparent"])},[we("div",{class:mt(["h-1 w-full rounded mb-2",L.accent])},null,2),we("div",{class:mt(["text-xs font-medium",L.text])},ot(L.label),3)],10,iX))),128))])]),we("div",sX,[ge(q(qr),{class:"text-base font-semibold"},{default:de(()=>[...M[6]||(M[6]=[ze("Table Style",-1)])]),_:1}),we("div",oX,[ge(q(qr),{class:"text-xs text-gray-600"},{default:de(()=>[...M[7]||(M[7]=[ze("Title Size",-1)])]),_:1}),we("div",aX,[(he(!0),ke(Tt,null,Er(q(rB),L=>(he(),Ee(q(Un),{key:L,onClick:k=>l.value=L,variant:l.value===L?"default":"outline",size:"sm",class:"uppercase text-xs"},{default:de(()=>[ze(ot(L==="2xlarge"?"2XL":L==="xlarge"?"XL":"L"),1)]),_:2},1032,["onClick","variant"]))),128))])]),we("div",lX,[we("div",uX,[we("div",cX,[ge(q(qr),{for:"rounded-borders",class:"text-sm font-normal"},{default:de(()=>[...M[8]||(M[8]=[ze("Rounded Borders",-1)])]),_:1}),ge(q(Td),{id:"rounded-borders",modelValue:u.value,"onUpdate:modelValue":M[0]||(M[0]=L=>u.value=L)},null,8,["modelValue"])]),we("div",hX,[ge(q(qr),{for:"table-border",class:"text-sm font-normal"},{default:de(()=>[...M[9]||(M[9]=[ze("Show Borders",-1)])]),_:1}),ge(q(Td),{id:"table-border",modelValue:c.value,"onUpdate:modelValue":M[1]||(M[1]=L=>c.value=L)},null,8,["modelValue"])]),we("div",dX,[ge(q(qr),{for:"alternating-rows",class:"text-sm font-normal"},{default:de(()=>[...M[10]||(M[10]=[ze("Alternating Rows",-1)])]),_:1}),ge(q(Td),{id:"alternating-rows",modelValue:d.value,"onUpdate:modelValue":M[2]||(M[2]=L=>d.value=L)},null,8,["modelValue"])])])])]),we("div",fX,[ge(q(qr),{class:"text-base font-semibold"},{default:de(()=>[...M[11]||(M[11]=[ze("Charts",-1)])]),_:1}),we("div",pX,[we("div",mX,[ge(q(qr),{class:"text-xs text-gray-600"},{default:de(()=>[...M[12]||(M[12]=[ze("Position",-1)])]),_:1}),we("div",gX,[(he(!0),ke(Tt,null,Er(q(nB),L=>(he(),Ee(q(Un),{key:L,onClick:k=>h.value=L,variant:h.value===L?"default":"outline",size:"sm",class:"capitalize"},{default:de(()=>[ze(ot(L),1)]),_:2},1032,["onClick","variant"]))),128))])])])]),we("div",yX,[ge(q(qr),null,{default:de(()=>[...M[13]||(M[13]=[ze("Preview",-1)])]),_:1}),we("div",vX,[we("div",bX,[we("div",{class:mt(["h-1 w-8 rounded",f.value.accent])},null,2),we("h3",{class:mt(["font-semibold",q(aA)(l.value)])},ot(o.value),3)]),we("div",{class:mt(["flex gap-4",[q(lA)(h.value)]])},[we("div",{class:mt(["overflow-hidden grow",m.value])},[we("table",wX,[we("thead",{class:mt([f.value.bg,f.value.text])},[...M[14]||(M[14]=[we("tr",null,[we("th",{class:"px-2 py-1.5 text-left font-medium"},"Name"),we("th",{class:"px-2 py-1.5 text-left font-medium"},"Value")],-1)])],2),we("tbody",null,[we("tr",{class:mt(d.value?"hover:bg-gray-50":"")},[...M[15]||(M[15]=[we("td",{class:"px-2 py-1.5"},"Item 1",-1),we("td",{class:"px-2 py-1.5"},"100",-1)])],2),we("tr",{class:mt(d.value?"bg-gray-50":"")},[...M[16]||(M[16]=[we("td",{class:"px-2 py-1.5"},"Item 2",-1),we("td",{class:"px-2 py-1.5"},"200",-1)])],2)])])],2),we("div",_X,[we("div",xX,[we("div",EX,[ge(q(Pc),{class:"w-5 h-5 text-blue-600"}),M[17]||(M[17]=we("h4",{class:"font-semibold text-gray-900"},"Chart title",-1))]),we("div",SX,[ge(q(fA),null,{default:de(()=>[ge(q(wA),{"as-child":""},{default:de(()=>[ge(q(Un),{variant:"outline",size:"sm"},{default:de(()=>[ge(q(dc),{class:"w-4 h-4"})]),_:1})]),_:1}),ge(q(pA),{align:"end"},{default:de(()=>[ge(q(mA),null,{default:de(()=>[...M[18]||(M[18]=[ze("Chart type",-1)])]),_:1}),ge(q(ia),null,{default:de(()=>[ge(q(Pc),{class:"w-4 h-4 mr-2"}),M[19]||(M[19]=ze(" Bar ",-1))]),_:1}),ge(q(ia),null,{default:de(()=>[ge(q(rR),{class:"w-4 h-4 mr-2"}),M[20]||(M[20]=ze(" Pie ",-1))]),_:1}),ge(q(ia),null,{default:de(()=>[ge(q(tR),{class:"w-4 h-4 mr-2"}),M[21]||(M[21]=ze(" Line ",-1))]),_:1}),ge(q(gA)),ge(q(yA),null,{default:de(()=>[ge(q(bA),null,{default:de(()=>[ge(q(sR),{class:"w-4 h-4 mr-2"}),M[22]||(M[22]=ze(" Labels: Some label ",-1))]),_:1}),ge(q(vA),null,{default:de(()=>[(he(),ke(Tt,null,Er(3,L=>ge(q(ia),{key:L},{default:de(()=>[ze(ot(L+" label"),1)]),_:2},1024)),64))]),_:1})]),_:1})]),_:1})]),_:1}),ge(q(Un),{variant:"ghost",size:"sm",title:"Hide chart"},{default:de(()=>[ge(q(tv),{class:"w-4 h-4"})]),_:1})])]),ge(q(Rd),{config:E,class:"h-[150px] w-80"},{default:de(()=>[ge(q(U3),{data:v.value,width:150,class:"flex! items-center gap-4"},{default:de(()=>[ge(q(Hd),{triggers:y}),ge(q(j3),{items:b.value,orientation:"vertical"},null,8,["items"]),ge(q(V3),{value:L=>L.value,"arc-width":50},null,8,["value"])]),_:1},8,["data"])]),_:1})])],2)])])]),ge(q(Y3),null,{default:de(()=>[ge(q(Un),{variant:"outline",onClick:p},{default:de(()=>[...M[23]||(M[23]=[ze("Cancel",-1)])]),_:1}),ge(q(Un),{onClick:g},{default:de(()=>[...M[24]||(M[24]=[ze("Apply",-1)])]),_:1})]),_:1})])]),_:1})]),_:1}))}}),RX={class:"flex-1 p-4 space-y-6 overflow-y-auto"},AX={class:"space-y-3"},CX={class:"font-medium text-sm flex items-center gap-2"},NX={class:"p-2 bg-blue-50 rounded text-sm font-medium text-blue-900"},MX={class:"space-y-3"},OX={class:"font-medium text-sm flex items-center gap-2"},IX={key:0,class:"space-y-2 mt-3"},kX=["onClick"],PX={class:"flex items-center justify-between"},FX={class:"flex-1"},LX={class:"text-xs font-medium text-gray-700 mb-1"},DX={key:0,class:"text-xs text-gray-600"},BX={key:1,class:"text-xs text-gray-500 italic p-2 bg-gray-50 rounded"},UX={class:"space-y-3"},VX={class:"font-medium text-sm flex items-center gap-2"},jX={key:0,class:"space-y-3 mt-4"},$X={class:"flex items-center gap-2 text-sm text-gray-600"},zX=["onClick"],HX={class:"flex items-start justify-between"},WX={class:"flex-1"},GX={class:"font-medium text-sm"},qX={class:"text-xs text-gray-500 mt-1"},YX={class:"space-y-1 mt-2"},XX={class:"flex flex-wrap gap-1"},KX={key:1,class:"p-3 border border-orange-200 rounded-lg bg-orange-50 text-sm text-orange-800"},ZX={class:"space-y-2 text-xs text-gray-600"},QX={class:"flex justify-between"},JX={class:"font-medium"},eK={class:"flex justify-between"},tK={class:"font-medium"},rK=_e({__name:"CustomTab",setup(r){const e=Ce(null),t=Ce(null);function n(u){return u==null||u===""?"(vide)":String(u).substring(0,30)}function i(u){return u==null?"-":typeof u=="number"?u.toLocaleString("fr-FR"):String(u)}function s(u){e.value=u}function o(){e.value=null}function a(u){t.value=u}function l(){t.value=null}return(u,c)=>(he(),ke(Tt,null,[we("div",RX,[we("div",AX,[we("h4",CX,[ge(q(iR),{class:"w-4 h-4"}),c[0]||(c[0]=ze(" Document ",-1))]),we("div",NX,ot(q(ht).currentSheet.title),1)]),ge(q(Wd)),we("div",MX,[we("h4",OX,[ge(q(dc),{class:"w-4 h-4"}),c[1]||(c[1]=ze(" Cards Recap ",-1))]),q(ht).currentSheet.sections.some(d=>d.cardRecap)?(he(),ke("div",IX,[(he(!0),ke(Tt,null,Er(q(ht).currentSheet.sections.filter(d=>d.cardRecap),(d,h)=>(he(),ke("div",{key:h,class:"p-3 border rounded-lg bg-gray-50 hover:bg-gray-100 cursor-pointer transition-colors",onClick:f=>s(h)},[we("div",PX,[we("div",FX,[we("div",LX,ot(d.title||`Section ${h+1}`),1),d.cardRecap?(he(),ke("div",DX,[we("div",null,[we("strong",null,ot(d.cardRecap.label||"Valeur")+" :",1),ze(" "+ot(i(d.cardRecap.value)),1)])])):zt("",!0)]),ge(q(dc),{class:"w-4 h-4 text-gray-400"})])],8,kX))),128))])):(he(),ke("div",BX," No recap cards configured "))]),ge(q(Wd)),we("div",UX,[we("h4",VX,[ge(q(Vk),{class:"w-4 h-4"}),c[2]||(c[2]=ze(" Sections ",-1))]),q(ht).currentSheet.sections.length>0?(he(),ke("div",jX,[we("div",$X,[ge(q(Dk),{class:"w-4 h-4 text-green-600"}),we("span",null,ot(q(ht).currentSheet.sections.length)+" section(s) detected",1)]),(he(!0),ke(Tt,null,Er(q(ht).currentSheet.sections,(d,h)=>(he(),ke("div",{key:h,class:"p-3 border rounded-lg bg-gray-50 hover:bg-gray-100 cursor-pointer transition-colors",onClick:f=>a(h)},[we("div",HX,[we("div",WX,[we("div",GX,ot(d.title||`Section ${h+1}`),1),we("div",qX,ot(d.data.length)+" row(s)  "+ot(d.header.length)+" column(s) ",1)]),ge(q(dc),{class:"w-4 h-4 text-gray-400"})]),we("div",YX,[we("div",XX,[(he(!0),ke(Tt,null,Er(d.header.slice(0,3),(f,m)=>(he(),Ee(q(lu),{key:m,variant:"outline",class:"text-xs"},{default:de(()=>[ze(ot(n(f)),1)]),_:2},1024))),128)),d.header.length>3?(he(),Ee(q(lu),{key:0,variant:"outline",class:"text-xs"},{default:de(()=>[ze(" +"+ot(d.header.length-3),1)]),_:2},1024)):zt("",!0)])])],8,zX))),128))])):(he(),ke("div",KX,"  No sections detected "))]),ge(q(Wd)),we("div",ZX,[we("div",QX,[c[3]||(c[3]=we("span",null,"Total rows:",-1)),we("span",JX,ot(q(ht).currentSheet.rawData.length),1)]),we("div",eK,[c[4]||(c[4]=we("span",null,"Columns:",-1)),we("span",tK,ot(q(ht).currentSheet.rawData[0]?.length||0),1)])])]),e.value!==null?(he(),Ee(JY,{key:0,"section-index":e.value,onClose:o},null,8,["section-index"])):zt("",!0),t.value!==null?(he(),Ee(TX,{key:1,"section-index":t.value,onClose:l},null,8,["section-index"])):zt("",!0)],64))}}),nK={class:"flex-1 p-4 space-y-6 overflow-y-auto"},iK={class:"p-3 bg-green-50 rounded-lg border border-green-200"},sK={class:"flex items-start gap-2"},oK={class:"space-y-3"},aK={key:0,class:"space-y-3"},lK={class:"space-y-2"},uK={class:"flex gap-2"},cK={key:1,class:"p-3 bg-gray-50 rounded-lg border border-gray-200"},hK=_e({__name:"EditionTab",setup(r){const e=Te(()=>PD(ht.currentSheet.currentCell)),t=Ce();function n(){const i=t.value??e.value;gk(ht.currentSheet.currentCell,i)}return(i,s)=>(he(),ke("div",nK,[we("div",iK,[we("div",sK,[ge(q(jk),{class:"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0"}),s[1]||(s[1]=we("div",{class:"flex-1"},[we("div",{class:"text-sm font-medium text-green-900"},"Edition Mode Active"),we("div",{class:"text-xs text-green-700 mt-1"}," Double-click any cell to edit ")],-1))])]),we("div",oK,[s[4]||(s[4]=we("h4",{class:"font-medium text-sm"},"Current Cell",-1)),q(ht).currentSheet.currentCell?(he(),ke("div",aK,[we("div",lK,[ge(q(qr),{for:"cell-value",class:"text-xs text-gray-600"},{default:de(()=>[...s[2]||(s[2]=[ze("Edit Value",-1)])]),_:1}),we("div",uK,[ge(q(Av),{id:"cell-value",placeholder:"Enter new value...",class:"font-mono text-sm","model-value":String(e.value),"onUpdate:modelValue":s[0]||(s[0]=o=>t.value=o)},null,8,["model-value"]),we("button",{class:"px-3 py-1.5 text-sm font-medium bg-green-100 text-green-900 border border-green-200 rounded hover:bg-green-200",onClick:n}," Save ")])])])):(he(),ke("div",cK,[...s[3]||(s[3]=[we("div",{class:"text-xs text-gray-500 text-center"}," No cell selected - double-click a cell to edit ",-1)])]))]),ge(q(Wd))]))}}),dK={class:"w-80 border-l bg-white flex flex-col h-full"},fK=_e({__name:"Panel",setup(r){const e=Ce("custom");return jt(e,t=>{t==="edition"?yk():vk()}),(t,n)=>(he(),ke("div",dK,[n[3]||(n[3]=we("div",{class:"p-4 border-b"},[we("div",{class:"flex items-center gap-2"},[we("h3",{class:"font-semibold text-lg"},"Configuration")])],-1)),ge(q(CY),{modelValue:e.value,"onUpdate:modelValue":n[0]||(n[0]=i=>e.value=i),class:"flex-1 flex flex-col"},{default:de(()=>[ge(q(NY),{class:"mx-4 mt-4 grid w-auto grid-cols-2"},{default:de(()=>[ge(q(F2),{value:"custom"},{default:de(()=>[...n[1]||(n[1]=[ze("Custom",-1)])]),_:1}),ge(q(F2),{value:"edition"},{default:de(()=>[...n[2]||(n[2]=[ze("Edition",-1)])]),_:1})]),_:1}),ge(q(P2),{value:"custom",class:"flex-1 overflow-hidden mt-0"},{default:de(()=>[ge(rK)]),_:1}),ge(q(P2),{value:"edition",class:"flex-1 overflow-hidden mt-0"},{default:de(()=>[ge(hK)]),_:1})]),_:1},8,["modelValue"])]))}}),pK={class:"min-h-screen bg-gray-50"},mK={class:"h-screen flex flex-col"},gK={class:"flex-1 flex"},yK={class:"flex-1 overflow-auto"},vK={class:"p-4 space-y-6"},bK={key:1,class:"bg-white rounded-lg shadow p-4"},wK=_e({__name:"ExcelManager",setup(r){return(e,t)=>(he(),ke("div",pK,[we("div",mK,[t[0]||(t[0]=we("div",{class:"bg-white border-b px-6 py-2"},[we("h1",{class:"text-2xl font-bold text-gray-900"},"Excel Sublim"),we("p",{class:"text-sm text-gray-600 mt-1"}," Transformez vos tableaux Excel en interface moderne ")],-1)),we("div",gK,[we("div",yK,[we("div",vK,[q(ht).workbook?(he(),ke("div",bK,[ge(AY)])):(he(),Ee(UD,{key:0}))])]),ge(fK)])])]))}}),_K={class:"min-h-screen bg-gray-50"},xK=_e({__name:"App",setup(r){return(e,t)=>(he(),ke("div",_K,[ge(wK)]))}});yN(xK).mount("#app");
